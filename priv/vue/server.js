var Fte=Object.defineProperty;var Ute=(r,e,t)=>e in r?Fte(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var H=(r,e,t)=>Ute(r,typeof e!="symbol"?e+"":e,t);import zte from"node:stream";import*as Vte from"worker_threads";import $te from"fs";import{resolve as jte,basename as Gte}from"path";var Xw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function R$(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var I={},dt={},kr={},Zt={};/**
* @vue/shared v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/Object.defineProperty(Zt,"__esModule",{value:!0});function Xa(r){const e=Object.create(null);for(const t of r.split(","))e[t]=1;return t=>t in e}const Hte={},Wte=[],Kte=()=>{},Xte=()=>!1,Jte=r=>r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&(r.charCodeAt(2)>122||r.charCodeAt(2)<97),qte=r=>r.startsWith("onUpdate:"),Yte=Object.assign,Zte=(r,e)=>{const t=r.indexOf(e);t>-1&&r.splice(t,1)},Qte=Object.prototype.hasOwnProperty,ere=(r,e)=>Qte.call(r,e),np=Array.isArray,k$=r=>yp(r)==="[object Map]",O$=r=>yp(r)==="[object Set]",d3=r=>yp(r)==="[object Date]",tre=r=>yp(r)==="[object RegExp]",U0=r=>typeof r=="function",Hc=r=>typeof r=="string",m_=r=>typeof r=="symbol",_d=r=>r!==null&&typeof r=="object",rre=r=>(_d(r)||U0(r))&&U0(r.then)&&U0(r.catch),dR=Object.prototype.toString,yp=r=>dR.call(r),nre=r=>yp(r).slice(8,-1),D$=r=>yp(r)==="[object Object]",ire=r=>Hc(r)&&r!=="NaN"&&r[0]!=="-"&&""+parseInt(r,10)===r,sre=Xa(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ore=Xa("bind,cloak,else-if,else,for,html,if,model,on,once,pre,show,slot,text,memo"),VT=r=>{const e=Object.create(null);return t=>e[t]||(e[t]=r(t))},are=/-\w/g,lre=VT(r=>r.replace(are,e=>e.slice(1).toUpperCase())),cre=/\B([A-Z])/g,L$=VT(r=>r.replace(cre,"-$1").toLowerCase()),N$=VT(r=>r.charAt(0).toUpperCase()+r.slice(1)),ure=VT(r=>r?`on${N$(r)}`:""),hre=(r,e)=>!Object.is(r,e),dre=(r,...e)=>{for(let t=0;t<r.length;t++)r[t](...e)},fre=(r,e,t,n=!1)=>{Object.defineProperty(r,e,{configurable:!0,enumerable:!1,writable:n,value:t})},pre=r=>{const e=parseFloat(r);return isNaN(e)?r:e},gre=r=>{const e=Hc(r)?Number(r):NaN;return isNaN(e)?r:e};let OF;const mre=()=>OF||(OF=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof Xw<"u"?Xw:{}),yre=/^[_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*$/;function bre(r){return yre.test(r)?`__props.${r}`:`__props[${JSON.stringify(r)}]`}function _re(r,e){return r+JSON.stringify(e,(t,n)=>typeof n=="function"?n.toString():n)}const vre={TEXT:1,1:"TEXT",CLASS:2,2:"CLASS",STYLE:4,4:"STYLE",PROPS:8,8:"PROPS",FULL_PROPS:16,16:"FULL_PROPS",NEED_HYDRATION:32,32:"NEED_HYDRATION",STABLE_FRAGMENT:64,64:"STABLE_FRAGMENT",KEYED_FRAGMENT:128,128:"KEYED_FRAGMENT",UNKEYED_FRAGMENT:256,256:"UNKEYED_FRAGMENT",NEED_PATCH:512,512:"NEED_PATCH",DYNAMIC_SLOTS:1024,1024:"DYNAMIC_SLOTS",DEV_ROOT_FRAGMENT:2048,2048:"DEV_ROOT_FRAGMENT",CACHED:-1,"-1":"CACHED",BAIL:-2,"-2":"BAIL"},Are={1:"TEXT",2:"CLASS",4:"STYLE",8:"PROPS",16:"FULL_PROPS",32:"NEED_HYDRATION",64:"STABLE_FRAGMENT",128:"KEYED_FRAGMENT",256:"UNKEYED_FRAGMENT",512:"NEED_PATCH",1024:"DYNAMIC_SLOTS",2048:"DEV_ROOT_FRAGMENT",[-1]:"CACHED",[-2]:"BAIL"},xre={ELEMENT:1,1:"ELEMENT",FUNCTIONAL_COMPONENT:2,2:"FUNCTIONAL_COMPONENT",STATEFUL_COMPONENT:4,4:"STATEFUL_COMPONENT",TEXT_CHILDREN:8,8:"TEXT_CHILDREN",ARRAY_CHILDREN:16,16:"ARRAY_CHILDREN",SLOTS_CHILDREN:32,32:"SLOTS_CHILDREN",TELEPORT:64,64:"TELEPORT",SUSPENSE:128,128:"SUSPENSE",COMPONENT_SHOULD_KEEP_ALIVE:256,256:"COMPONENT_SHOULD_KEEP_ALIVE",COMPONENT_KEPT_ALIVE:512,512:"COMPONENT_KEPT_ALIVE",COMPONENT:6,6:"COMPONENT"},wre={STABLE:1,1:"STABLE",DYNAMIC:2,2:"DYNAMIC",FORWARDED:3,3:"FORWARDED"},Cre={1:"STABLE",2:"DYNAMIC",3:"FORWARDED"},Tre="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error,Symbol",F$=Xa(Tre),Sre=F$,DF=2;function Ere(r,e=0,t=r.length){if(e=Math.max(0,Math.min(e,r.length)),t=Math.max(0,Math.min(t,r.length)),e>t)return"";let n=r.split(/(\r?\n)/);const i=n.filter((o,u)=>u%2===1);n=n.filter((o,u)=>u%2===0);let s=0;const a=[];for(let o=0;o<n.length;o++)if(s+=n[o].length+(i[o]&&i[o].length||0),s>=e){for(let u=o-DF;u<=o+DF||t>s;u++){if(u<0||u>=n.length)continue;const f=u+1;a.push(`${f}${" ".repeat(Math.max(3-String(f).length,0))}|  ${n[u]}`);const g=n[u].length,y=i[u]&&i[u].length||0;if(u===o){const A=e-(s-(g+y)),C=Math.max(1,t>s?g-A:t-e);a.push("   |  "+" ".repeat(A)+"^".repeat(C))}else if(u>o){if(t>s){const A=Math.max(Math.min(t-s,g),1);a.push("   |  "+"^".repeat(A))}s+=g+y}}break}return a.join(`
`)}function fR(r){if(np(r)){const e={};for(let t=0;t<r.length;t++){const n=r[t],i=Hc(n)?U$(n):fR(n);if(i)for(const s in i)e[s]=i[s]}return e}else if(Hc(r)||_d(r))return r}const Ire=/;(?![^(]*\))/g,Pre=/:([^]+)/,Bre=/\/\*[^]*?\*\//g;function U$(r){const e={};return r.replace(Bre,"").split(Ire).forEach(t=>{if(t){const n=t.split(Pre);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function Mre(r){if(!r)return"";if(Hc(r))return r;let e="";for(const t in r){const n=r[t];if(Hc(n)||typeof n=="number"){const i=t.startsWith("--")?t:L$(t);e+=`${i}:${n};`}}return e}function pR(r){let e="";if(Hc(r))e=r;else if(np(r))for(let t=0;t<r.length;t++){const n=pR(r[t]);n&&(e+=n+" ")}else if(_d(r))for(const t in r)r[t]&&(e+=t+" ");return e.trim()}function Rre(r){if(!r)return null;let{class:e,style:t}=r;return e&&!Hc(e)&&(r.class=pR(e)),t&&(r.style=fR(t)),r}const kre="html,body,base,head,link,meta,style,title,address,article,aside,footer,header,hgroup,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot",Ore="svg,animate,animateMotion,animateTransform,circle,clipPath,color-profile,defs,desc,discard,ellipse,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feDistantLight,feDropShadow,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,filter,foreignObject,g,hatch,hatchpath,image,line,linearGradient,marker,mask,mesh,meshgradient,meshpatch,meshrow,metadata,mpath,path,pattern,polygon,polyline,radialGradient,rect,set,solidcolor,stop,switch,symbol,text,textPath,title,tspan,unknown,use,view",Dre="annotation,annotation-xml,maction,maligngroup,malignmark,math,menclose,merror,mfenced,mfrac,mfraction,mglyph,mi,mlabeledtr,mlongdiv,mmultiscripts,mn,mo,mover,mpadded,mphantom,mprescripts,mroot,mrow,ms,mscarries,mscarry,msgroup,msline,mspace,msqrt,msrow,mstack,mstyle,msub,msubsup,msup,mtable,mtd,mtext,mtr,munder,munderover,none,semantics",Lre="area,base,br,col,embed,hr,img,input,link,meta,param,source,track,wbr",Nre=Xa(kre),Fre=Xa(Ore),Ure=Xa(Dre),zre=Xa(Lre),z$="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Vre=Xa(z$),$re=Xa(z$+",async,autofocus,autoplay,controls,default,defer,disabled,hidden,inert,loop,open,required,reversed,scoped,seamless,checked,muted,multiple,selected");function jre(r){return!!r||r===""}const Gre=/[>/="'\u0009\u000a\u000c\u0020]/,$E={};function Hre(r){if($E.hasOwnProperty(r))return $E[r];const e=Gre.test(r);return e&&console.error(`unsafe attribute name: ${r}`),$E[r]=!e}const Wre={acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv"},Kre=Xa("accept,accept-charset,accesskey,action,align,allow,alt,async,autocapitalize,autocomplete,autofocus,autoplay,background,bgcolor,border,buffered,capture,challenge,charset,checked,cite,class,code,codebase,color,cols,colspan,content,contenteditable,contextmenu,controls,coords,crossorigin,csp,data,datetime,decoding,default,defer,dir,dirname,disabled,download,draggable,dropzone,enctype,enterkeyhint,for,form,formaction,formenctype,formmethod,formnovalidate,formtarget,headers,height,hidden,high,href,hreflang,http-equiv,icon,id,importance,inert,integrity,ismap,itemprop,keytype,kind,label,lang,language,loading,list,loop,low,manifest,max,maxlength,minlength,media,min,multiple,muted,name,novalidate,open,optimum,pattern,ping,placeholder,poster,preload,radiogroup,readonly,referrerpolicy,rel,required,reversed,rows,rowspan,sandbox,scope,scoped,selected,shape,size,sizes,slot,span,spellcheck,src,srcdoc,srclang,srcset,start,step,style,summary,tabindex,target,title,translate,type,usemap,value,width,wrap"),Xre=Xa("xmlns,accent-height,accumulate,additive,alignment-baseline,alphabetic,amplitude,arabic-form,ascent,attributeName,attributeType,azimuth,baseFrequency,baseline-shift,baseProfile,bbox,begin,bias,by,calcMode,cap-height,class,clip,clipPathUnits,clip-path,clip-rule,color,color-interpolation,color-interpolation-filters,color-profile,color-rendering,contentScriptType,contentStyleType,crossorigin,cursor,cx,cy,d,decelerate,descent,diffuseConstant,direction,display,divisor,dominant-baseline,dur,dx,dy,edgeMode,elevation,enable-background,end,exponent,fill,fill-opacity,fill-rule,filter,filterRes,filterUnits,flood-color,flood-opacity,font-family,font-size,font-size-adjust,font-stretch,font-style,font-variant,font-weight,format,from,fr,fx,fy,g1,g2,glyph-name,glyph-orientation-horizontal,glyph-orientation-vertical,glyphRef,gradientTransform,gradientUnits,hanging,height,href,hreflang,horiz-adv-x,horiz-origin-x,id,ideographic,image-rendering,in,in2,intercept,k,k1,k2,k3,k4,kernelMatrix,kernelUnitLength,kerning,keyPoints,keySplines,keyTimes,lang,lengthAdjust,letter-spacing,lighting-color,limitingConeAngle,local,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mask,maskContentUnits,maskUnits,mathematical,max,media,method,min,mode,name,numOctaves,offset,opacity,operator,order,orient,orientation,origin,overflow,overline-position,overline-thickness,panose-1,paint-order,path,pathLength,patternContentUnits,patternTransform,patternUnits,ping,pointer-events,points,pointsAtX,pointsAtY,pointsAtZ,preserveAlpha,preserveAspectRatio,primitiveUnits,r,radius,referrerPolicy,refX,refY,rel,rendering-intent,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,result,rotate,rx,ry,scale,seed,shape-rendering,slope,spacing,specularConstant,specularExponent,speed,spreadMethod,startOffset,stdDeviation,stemh,stemv,stitchTiles,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,string,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,style,surfaceScale,systemLanguage,tabindex,tableValues,target,targetX,targetY,text-anchor,text-decoration,text-rendering,textLength,to,transform,transform-origin,type,u1,u2,underline-position,underline-thickness,unicode,unicode-bidi,unicode-range,units-per-em,v-alphabetic,v-hanging,v-ideographic,v-mathematical,values,vector-effect,version,vert-adv-y,vert-origin-x,vert-origin-y,viewBox,viewTarget,visibility,width,widths,word-spacing,writing-mode,x,x-height,x1,x2,xChannelSelector,xlink:actuate,xlink:arcrole,xlink:href,xlink:role,xlink:show,xlink:title,xlink:type,xmlns:xlink,xml:base,xml:lang,xml:space,y,y1,y2,yChannelSelector,z,zoomAndPan"),Jre=Xa("accent,accentunder,actiontype,align,alignmentscope,altimg,altimg-height,altimg-valign,altimg-width,alttext,bevelled,close,columnsalign,columnlines,columnspan,denomalign,depth,dir,display,displaystyle,encoding,equalcolumns,equalrows,fence,fontstyle,fontweight,form,frame,framespacing,groupalign,height,href,id,indentalign,indentalignfirst,indentalignlast,indentshift,indentshiftfirst,indentshiftlast,indextype,justify,largetop,largeop,lquote,lspace,mathbackground,mathcolor,mathsize,mathvariant,maxsize,minlabelspacing,mode,other,overflow,position,rowalign,rowlines,rowspan,rquote,rspace,scriptlevel,scriptminsize,scriptsizemultiplier,selection,separator,separators,shift,side,src,stackalign,stretchy,subscriptshift,superscriptshift,symmetric,voffset,width,widths,xlink:href,xlink:show,xlink:type,xmlns");function qre(r){if(r==null)return!1;const e=typeof r;return e==="string"||e==="number"||e==="boolean"}const Yre=/["'&<>]/;function Zre(r){const e=""+r,t=Yre.exec(e);if(!t)return e;let n="",i,s,a=0;for(s=t.index;s<e.length;s++){switch(e.charCodeAt(s)){case 34:i="&quot;";break;case 38:i="&amp;";break;case 39:i="&#39;";break;case 60:i="&lt;";break;case 62:i="&gt;";break;default:continue}a!==s&&(n+=e.slice(a,s)),a=s+1,n+=i}return a!==s?n+e.slice(a,s):n}const Qre=/^-?>|<!--|-->|--!>|<!-$/g;function ene(r){return r.replace(Qre,"")}const V$=/[ !"#$%&'()*+,./:;<=>?@[\\\]^`{|}~]/g;function tne(r,e){return r.replace(V$,t=>e?t==='"'?'\\\\\\"':`\\\\${t}`:`\\${t}`)}function rne(r,e){if(r.length!==e.length)return!1;let t=!0;for(let n=0;t&&n<r.length;n++)t=$T(r[n],e[n]);return t}function $T(r,e){if(r===e)return!0;let t=d3(r),n=d3(e);if(t||n)return t&&n?r.getTime()===e.getTime():!1;if(t=m_(r),n=m_(e),t||n)return r===e;if(t=np(r),n=np(e),t||n)return t&&n?rne(r,e):!1;if(t=_d(r),n=_d(e),t||n){if(!t||!n)return!1;const i=Object.keys(r).length,s=Object.keys(e).length;if(i!==s)return!1;for(const a in r){const o=r.hasOwnProperty(a),u=e.hasOwnProperty(a);if(o&&!u||!o&&u||!$T(r[a],e[a]))return!1}}return String(r)===String(e)}function nne(r,e){return r.findIndex(t=>$T(t,e))}const $$=r=>!!(r&&r.__v_isRef===!0),j$=r=>Hc(r)?r:r==null?"":np(r)||_d(r)&&(r.toString===dR||!U0(r.toString))?$$(r)?j$(r.value):JSON.stringify(r,G$,2):String(r),G$=(r,e)=>$$(e)?G$(r,e.value):k$(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[n,i],s)=>(t[jE(n,s)+" =>"]=i,t),{})}:O$(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>jE(t))}:m_(e)?jE(e):_d(e)&&!np(e)&&!D$(e)?String(e):e,jE=(r,e="")=>{var t;return m_(r)?`Symbol(${(t=r.description)!=null?t:e})`:r};function ine(r){return r==null?"initial":typeof r=="string"?r===""?" ":r:String(r)}Zt.EMPTY_ARR=Wte;Zt.EMPTY_OBJ=Hte;Zt.NO=Xte;Zt.NOOP=Kte;Zt.PatchFlagNames=Are;Zt.PatchFlags=vre;Zt.ShapeFlags=xre;Zt.SlotFlags=wre;Zt.camelize=lre;Zt.capitalize=N$;Zt.cssVarNameEscapeSymbolsRE=V$;Zt.def=fre;Zt.escapeHtml=Zre;Zt.escapeHtmlComment=ene;Zt.extend=Yte;Zt.genCacheKey=_re;Zt.genPropsAccessExp=bre;Zt.generateCodeFrame=Ere;Zt.getEscapedCssVarName=tne;Zt.getGlobalThis=mre;Zt.hasChanged=hre;Zt.hasOwn=ere;Zt.hyphenate=L$;Zt.includeBooleanAttr=jre;Zt.invokeArrayFns=dre;Zt.isArray=np;Zt.isBooleanAttr=$re;Zt.isBuiltInDirective=ore;Zt.isDate=d3;Zt.isFunction=U0;Zt.isGloballyAllowed=F$;Zt.isGloballyWhitelisted=Sre;Zt.isHTMLTag=Nre;Zt.isIntegerKey=ire;Zt.isKnownHtmlAttr=Kre;Zt.isKnownMathMLAttr=Jre;Zt.isKnownSvgAttr=Xre;Zt.isMap=k$;Zt.isMathMLTag=Ure;Zt.isModelListener=qte;Zt.isObject=_d;Zt.isOn=Jte;Zt.isPlainObject=D$;Zt.isPromise=rre;Zt.isRegExp=tre;Zt.isRenderableAttrValue=qre;Zt.isReservedProp=sre;Zt.isSSRSafeAttrName=Hre;Zt.isSVGTag=Fre;Zt.isSet=O$;Zt.isSpecialBooleanAttr=Vre;Zt.isString=Hc;Zt.isSymbol=m_;Zt.isVoidTag=zre;Zt.looseEqual=$T;Zt.looseIndexOf=nne;Zt.looseToNumber=pre;Zt.makeMap=Xa;Zt.normalizeClass=pR;Zt.normalizeCssVarValue=ine;Zt.normalizeProps=Rre;Zt.normalizeStyle=fR;Zt.objectToString=dR;Zt.parseStringStyle=U$;Zt.propsToAttrMap=Wre;Zt.remove=Zte;Zt.slotFlagsText=Cre;Zt.stringifyStyle=Mre;Zt.toDisplayString=j$;Zt.toHandlerKey=ure;Zt.toNumber=gre;Zt.toRawType=nre;Zt.toTypeString=yp;/**
* @vue/reactivity v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/Object.defineProperty(kr,"__esModule",{value:!0});var Tr=Zt;let go;class H${constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=go,!e&&go&&(this.index=(go.scopes||(go.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=go;try{return go=this,e()}finally{go=t}}}on(){++this._on===1&&(this.prevScope=go,go=this)}off(){this._on>0&&--this._on===0&&(go=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(this.effects.length=0,t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function sne(r){return new H$(r)}function W$(){return go}function one(r,e=!1){go&&go.cleanups.push(r)}let Qn;const ane={ACTIVE:1,1:"ACTIVE",RUNNING:2,2:"RUNNING",TRACKING:4,4:"TRACKING",NOTIFIED:8,8:"NOTIFIED",DIRTY:16,16:"DIRTY",ALLOW_RECURSE:32,32:"ALLOW_RECURSE",PAUSED:64,64:"PAUSED",EVALUATED:128,128:"EVALUATED"},GE=new WeakSet;class y_{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,go&&go.active&&go.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,GE.has(this)&&(GE.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||X$(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,LF(this),J$(this);const e=Qn,t=Ha;Qn=this,Ha=!0;try{return this.fn()}finally{q$(this),Qn=e,Ha=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)yR(e);this.deps=this.depsTail=void 0,LF(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?GE.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){f3(this)&&this.run()}get dirty(){return f3(this)}}let K$=0,z0,V0;function X$(r,e=!1){if(r.flags|=8,e){r.next=V0,V0=r;return}r.next=z0,z0=r}function gR(){K$++}function mR(){if(--K$>0)return;if(V0){let e=V0;for(V0=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let r;for(;z0;){let e=z0;for(z0=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(n){r||(r=n)}e=t}}if(r)throw r}function J$(r){for(let e=r.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function q$(r){let e,t=r.depsTail,n=t;for(;n;){const i=n.prevDep;n.version===-1?(n===t&&(t=i),yR(n),lne(n)):e=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=i}r.deps=e,r.depsTail=t}function f3(r){for(let e=r.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(Y$(e.dep.computed)||e.dep.version!==e.version))return!0;return!!r._dirty}function Y$(r){if(r.flags&4&&!(r.flags&16)||(r.flags&=-17,r.globalVersion===b_)||(r.globalVersion=b_,!r.isSSR&&r.flags&128&&(!r.deps&&!r._dirty||!f3(r))))return;r.flags|=2;const e=r.dep,t=Qn,n=Ha;Qn=r,Ha=!0;try{J$(r);const i=r.fn(r._value);(e.version===0||Tr.hasChanged(i,r._value))&&(r.flags|=128,r._value=i,e.version++)}catch(i){throw e.version++,i}finally{Qn=t,Ha=n,q$(r),r.flags&=-3}}function yR(r,e=!1){const{dep:t,prevSub:n,nextSub:i}=r;if(n&&(n.nextSub=i,r.prevSub=void 0),i&&(i.prevSub=n,r.nextSub=void 0),t.subs===r&&(t.subs=n,!n&&t.computed)){t.computed.flags&=-5;for(let s=t.computed.deps;s;s=s.nextDep)yR(s,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function lne(r){const{prevDep:e,nextDep:t}=r;e&&(e.nextDep=t,r.prevDep=void 0),t&&(t.prevDep=e,r.nextDep=void 0)}function cne(r,e){r.effect instanceof y_&&(r=r.effect.fn);const t=new y_(r);e&&Tr.extend(t,e);try{t.run()}catch(i){throw t.stop(),i}const n=t.run.bind(t);return n.effect=t,n}function une(r){r.effect.stop()}let Ha=!0;const bR=[];function _R(){bR.push(Ha),Ha=!1}function hne(){bR.push(Ha),Ha=!0}function vR(){const r=bR.pop();Ha=r===void 0?!0:r}function dne(r,e=!1){Qn instanceof y_&&(Qn.cleanup=r)}function LF(r){const{cleanup:e}=r;if(r.cleanup=void 0,e){const t=Qn;Qn=void 0;try{e()}finally{Qn=t}}}let b_=0;class fne{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class jT{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!Qn||!Ha||Qn===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==Qn)t=this.activeLink=new fne(Qn,this),Qn.deps?(t.prevDep=Qn.depsTail,Qn.depsTail.nextDep=t,Qn.depsTail=t):Qn.deps=Qn.depsTail=t,Z$(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const n=t.nextDep;n.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=n),t.prevDep=Qn.depsTail,t.nextDep=void 0,Qn.depsTail.nextDep=t,Qn.depsTail=t,Qn.deps===t&&(Qn.deps=n)}return t}trigger(e){this.version++,b_++,this.notify(e)}notify(e){gR();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{mR()}}}function Z$(r){if(r.dep.sc++,r.sub.flags&4){const e=r.dep.computed;if(e&&!r.dep.subs){e.flags|=20;for(let n=e.deps;n;n=n.nextDep)Z$(n)}const t=r.dep.subs;t!==r&&(r.prevSub=t,t&&(t.nextSub=r)),r.dep.subs=r}}const Jw=new WeakMap,dd=Symbol(""),qw=Symbol(""),Hm=Symbol("");function Uo(r,e,t){if(Ha&&Qn){let n=Jw.get(r);n||Jw.set(r,n=new Map);let i=n.get(t);i||(n.set(t,i=new jT),i.map=n,i.key=t),i.track()}}function Lu(r,e,t,n,i,s){const a=Jw.get(r);if(!a){b_++;return}const o=u=>{u&&u.trigger()};if(gR(),e==="clear")a.forEach(o);else{const u=Tr.isArray(r),f=u&&Tr.isIntegerKey(t);if(u&&t==="length"){const g=Number(n);a.forEach((y,A)=>{(A==="length"||A===Hm||!Tr.isSymbol(A)&&A>=g)&&o(y)})}else switch((t!==void 0||a.has(void 0))&&o(a.get(t)),f&&o(a.get(Hm)),e){case"add":u?f&&o(a.get("length")):(o(a.get(dd)),Tr.isMap(r)&&o(a.get(qw)));break;case"delete":u||(o(a.get(dd)),Tr.isMap(r)&&o(a.get(qw)));break;case"set":Tr.isMap(r)&&o(a.get(dd));break}}mR()}function pne(r,e){const t=Jw.get(r);return t&&t.get(e)}function If(r){const e=Kn(r);return e===r?e:(Uo(e,"iterate",Hm),Wa(r)?e:e.map(Wc))}function GT(r){return Uo(r=Kn(r),"iterate",Hm),r}function Xh(r,e){return Wu(r)?jf(r)?Wm(Wc(e)):Wm(e):Wc(e)}const gne={__proto__:null,[Symbol.iterator](){return HE(this,Symbol.iterator,r=>Xh(this,r))},concat(...r){return If(this).concat(...r.map(e=>Tr.isArray(e)?If(e):e))},entries(){return HE(this,"entries",r=>(r[1]=Xh(this,r[1]),r))},every(r,e){return Tu(this,"every",r,e,void 0,arguments)},filter(r,e){return Tu(this,"filter",r,e,t=>t.map(n=>Xh(this,n)),arguments)},find(r,e){return Tu(this,"find",r,e,t=>Xh(this,t),arguments)},findIndex(r,e){return Tu(this,"findIndex",r,e,void 0,arguments)},findLast(r,e){return Tu(this,"findLast",r,e,t=>Xh(this,t),arguments)},findLastIndex(r,e){return Tu(this,"findLastIndex",r,e,void 0,arguments)},forEach(r,e){return Tu(this,"forEach",r,e,void 0,arguments)},includes(...r){return WE(this,"includes",r)},indexOf(...r){return WE(this,"indexOf",r)},join(r){return If(this).join(r)},lastIndexOf(...r){return WE(this,"lastIndexOf",r)},map(r,e){return Tu(this,"map",r,e,void 0,arguments)},pop(){return Gb(this,"pop")},push(...r){return Gb(this,"push",r)},reduce(r,...e){return NF(this,"reduce",r,e)},reduceRight(r,...e){return NF(this,"reduceRight",r,e)},shift(){return Gb(this,"shift")},some(r,e){return Tu(this,"some",r,e,void 0,arguments)},splice(...r){return Gb(this,"splice",r)},toReversed(){return If(this).toReversed()},toSorted(r){return If(this).toSorted(r)},toSpliced(...r){return If(this).toSpliced(...r)},unshift(...r){return Gb(this,"unshift",r)},values(){return HE(this,"values",r=>Xh(this,r))}};function HE(r,e,t){const n=GT(r),i=n[e]();return n!==r&&!Wa(r)&&(i._next=i.next,i.next=()=>{const s=i._next();return s.done||(s.value=t(s.value)),s}),i}const mne=Array.prototype;function Tu(r,e,t,n,i,s){const a=GT(r),o=a!==r&&!Wa(r),u=a[e];if(u!==mne[e]){const y=u.apply(r,s);return o?Wc(y):y}let f=t;a!==r&&(o?f=function(y,A){return t.call(this,Xh(r,y),A,r)}:t.length>2&&(f=function(y,A){return t.call(this,y,A,r)}));const g=u.call(a,f,n);return o&&i?i(g):g}function NF(r,e,t,n){const i=GT(r);let s=t;return i!==r&&(Wa(r)?t.length>3&&(s=function(a,o,u){return t.call(this,a,o,u,r)}):s=function(a,o,u){return t.call(this,a,Xh(r,o),u,r)}),i[e](s,...n)}function WE(r,e,t){const n=Kn(r);Uo(n,"iterate",Hm);const i=n[e](...t);return(i===-1||i===!1)&&xR(t[0])?(t[0]=Kn(t[0]),n[e](...t)):i}function Gb(r,e,t=[]){_R(),gR();const n=Kn(r)[e].apply(r,t);return mR(),vR(),n}const yne=Tr.makeMap("__proto__,__v_isRef,__isVue"),Q$=new Set(Object.getOwnPropertyNames(Symbol).filter(r=>r!=="arguments"&&r!=="caller").map(r=>Symbol[r]).filter(Tr.isSymbol));function bne(r){Tr.isSymbol(r)||(r=String(r));const e=Kn(this);return Uo(e,"has",r),e.hasOwnProperty(r)}class ej{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,n){if(t==="__v_skip")return e.__v_skip;const i=this._isReadonly,s=this._isShallow;if(t==="__v_isReactive")return!i;if(t==="__v_isReadonly")return i;if(t==="__v_isShallow")return s;if(t==="__v_raw")return n===(i?s?oj:sj:s?ij:nj).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const a=Tr.isArray(e);if(!i){let u;if(a&&(u=gne[t]))return u;if(t==="hasOwnProperty")return bne}const o=Reflect.get(e,t,Co(e)?e:n);if((Tr.isSymbol(t)?Q$.has(t):yne(t))||(i||Uo(e,"get",t),s))return o;if(Co(o)){const u=a&&Tr.isIntegerKey(t)?o:o.value;return i&&Tr.isObject(u)?Yw(u):u}return Tr.isObject(o)?i?Yw(o):AR(o):o}}class tj extends ej{constructor(e=!1){super(!1,e)}set(e,t,n,i){let s=e[t];const a=Tr.isArray(e)&&Tr.isIntegerKey(t);if(!this._isShallow){const f=Wu(s);if(!Wa(n)&&!Wu(n)&&(s=Kn(s),n=Kn(n)),!a&&Co(s)&&!Co(n))return f||(s.value=n),!0}const o=a?Number(t)<e.length:Tr.hasOwn(e,t),u=Reflect.set(e,t,n,Co(e)?e:i);return e===Kn(i)&&(o?Tr.hasChanged(n,s)&&Lu(e,"set",t,n):Lu(e,"add",t,n)),u}deleteProperty(e,t){const n=Tr.hasOwn(e,t);e[t];const i=Reflect.deleteProperty(e,t);return i&&n&&Lu(e,"delete",t,void 0),i}has(e,t){const n=Reflect.has(e,t);return(!Tr.isSymbol(t)||!Q$.has(t))&&Uo(e,"has",t),n}ownKeys(e){return Uo(e,"iterate",Tr.isArray(e)?"length":dd),Reflect.ownKeys(e)}}class rj extends ej{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const _ne=new tj,vne=new rj,Ane=new tj(!0),xne=new rj(!0),p3=r=>r,M1=r=>Reflect.getPrototypeOf(r);function wne(r,e,t){return function(...n){const i=this.__v_raw,s=Kn(i),a=Tr.isMap(s),o=r==="entries"||r===Symbol.iterator&&a,u=r==="keys"&&a,f=i[r](...n),g=t?p3:e?Wm:Wc;return!e&&Uo(s,"iterate",u?qw:dd),{next(){const{value:y,done:A}=f.next();return A?{value:y,done:A}:{value:o?[g(y[0]),g(y[1])]:g(y),done:A}},[Symbol.iterator](){return this}}}}function R1(r){return function(...e){return r==="delete"?!1:r==="clear"?void 0:this}}function Cne(r,e){const t={get(i){const s=this.__v_raw,a=Kn(s),o=Kn(i);r||(Tr.hasChanged(i,o)&&Uo(a,"get",i),Uo(a,"get",o));const{has:u}=M1(a),f=e?p3:r?Wm:Wc;if(u.call(a,i))return f(s.get(i));if(u.call(a,o))return f(s.get(o));s!==a&&s.get(i)},get size(){const i=this.__v_raw;return!r&&Uo(Kn(i),"iterate",dd),i.size},has(i){const s=this.__v_raw,a=Kn(s),o=Kn(i);return r||(Tr.hasChanged(i,o)&&Uo(a,"has",i),Uo(a,"has",o)),i===o?s.has(i):s.has(i)||s.has(o)},forEach(i,s){const a=this,o=a.__v_raw,u=Kn(o),f=e?p3:r?Wm:Wc;return!r&&Uo(u,"iterate",dd),o.forEach((g,y)=>i.call(s,f(g),f(y),a))}};return Tr.extend(t,r?{add:R1("add"),set:R1("set"),delete:R1("delete"),clear:R1("clear")}:{add(i){!e&&!Wa(i)&&!Wu(i)&&(i=Kn(i));const s=Kn(this);return M1(s).has.call(s,i)||(s.add(i),Lu(s,"add",i,i)),this},set(i,s){!e&&!Wa(s)&&!Wu(s)&&(s=Kn(s));const a=Kn(this),{has:o,get:u}=M1(a);let f=o.call(a,i);f||(i=Kn(i),f=o.call(a,i));const g=u.call(a,i);return a.set(i,s),f?Tr.hasChanged(s,g)&&Lu(a,"set",i,s):Lu(a,"add",i,s),this},delete(i){const s=Kn(this),{has:a,get:o}=M1(s);let u=a.call(s,i);u||(i=Kn(i),u=a.call(s,i)),o&&o.call(s,i);const f=s.delete(i);return u&&Lu(s,"delete",i,void 0),f},clear(){const i=Kn(this),s=i.size!==0,a=i.clear();return s&&Lu(i,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=wne(i,r,e)}),t}function HT(r,e){const t=Cne(r,e);return(n,i,s)=>i==="__v_isReactive"?!r:i==="__v_isReadonly"?r:i==="__v_raw"?n:Reflect.get(Tr.hasOwn(t,i)&&i in n?t:n,i,s)}const Tne={get:HT(!1,!1)},Sne={get:HT(!1,!0)},Ene={get:HT(!0,!1)},Ine={get:HT(!0,!0)},nj=new WeakMap,ij=new WeakMap,sj=new WeakMap,oj=new WeakMap;function Pne(r){switch(r){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Bne(r){return r.__v_skip||!Object.isExtensible(r)?0:Pne(Tr.toRawType(r))}function AR(r){return Wu(r)?r:WT(r,!1,_ne,Tne,nj)}function Mne(r){return WT(r,!1,Ane,Sne,ij)}function Yw(r){return WT(r,!0,vne,Ene,sj)}function Rne(r){return WT(r,!0,xne,Ine,oj)}function WT(r,e,t,n,i){if(!Tr.isObject(r)||r.__v_raw&&!(e&&r.__v_isReactive))return r;const s=Bne(r);if(s===0)return r;const a=i.get(r);if(a)return a;const o=new Proxy(r,s===2?n:t);return i.set(r,o),o}function jf(r){return Wu(r)?jf(r.__v_raw):!!(r&&r.__v_isReactive)}function Wu(r){return!!(r&&r.__v_isReadonly)}function Wa(r){return!!(r&&r.__v_isShallow)}function xR(r){return r?!!r.__v_raw:!1}function Kn(r){const e=r&&r.__v_raw;return e?Kn(e):r}function kne(r){return!Tr.hasOwn(r,"__v_skip")&&Object.isExtensible(r)&&Tr.def(r,"__v_skip",!0),r}const Wc=r=>Tr.isObject(r)?AR(r):r,Wm=r=>Tr.isObject(r)?Yw(r):r;function Co(r){return r?r.__v_isRef===!0:!1}function aj(r){return lj(r,!1)}function One(r){return lj(r,!0)}function lj(r,e){return Co(r)?r:new Dne(r,e)}class Dne{constructor(e,t){this.dep=new jT,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:Kn(e),this._value=t?e:Wc(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,n=this.__v_isShallow||Wa(e)||Wu(e);e=n?e:Kn(e),Tr.hasChanged(e,t)&&(this._rawValue=e,this._value=n?e:Wc(e),this.dep.trigger())}}function Lne(r){r.dep&&r.dep.trigger()}function KT(r){return Co(r)?r.value:r}function Nne(r){return Tr.isFunction(r)?r():KT(r)}const Fne={get:(r,e,t)=>e==="__v_raw"?r:KT(Reflect.get(r,e,t)),set:(r,e,t,n)=>{const i=r[e];return Co(i)&&!Co(t)?(i.value=t,!0):Reflect.set(r,e,t,n)}};function Une(r){return jf(r)?r:new Proxy(r,Fne)}class zne{constructor(e){this.__v_isRef=!0,this._value=void 0;const t=this.dep=new jT,{get:n,set:i}=e(t.track.bind(t),t.trigger.bind(t));this._get=n,this._set=i}get value(){return this._value=this._get()}set value(e){this._set(e)}}function Vne(r){return new zne(r)}function $ne(r){const e=Tr.isArray(r)?new Array(r.length):{};for(const t in r)e[t]=cj(r,t);return e}class jne{constructor(e,t,n){this._object=e,this._key=t,this._defaultValue=n,this.__v_isRef=!0,this._value=void 0,this._raw=Kn(e);let i=!0,s=e;if(!Tr.isArray(e)||!Tr.isIntegerKey(String(t)))do i=!xR(s)||Wa(s);while(i&&(s=s.__v_raw));this._shallow=i}get value(){let e=this._object[this._key];return this._shallow&&(e=KT(e)),this._value=e===void 0?this._defaultValue:e}set value(e){if(this._shallow&&Co(this._raw[this._key])){const t=this._object[this._key];if(Co(t)){t.value=e;return}}this._object[this._key]=e}get dep(){return pne(this._raw,this._key)}}class Gne{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function Hne(r,e,t){return Co(r)?r:Tr.isFunction(r)?new Gne(r):Tr.isObject(r)&&arguments.length>1?cj(r,e,t):aj(r)}function cj(r,e,t){return new jne(r,e,t)}class Wne{constructor(e,t,n){this.fn=e,this.setter=t,this._value=void 0,this.dep=new jT(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=b_-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&Qn!==this)return X$(this,!0),!0}get value(){const e=this.dep.track();return Y$(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Kne(r,e,t=!1){let n,i;return Tr.isFunction(r)?n=r:(n=r.get,i=r.set),new Wne(n,i,t)}const Xne={GET:"get",HAS:"has",ITERATE:"iterate"},Jne={SET:"set",ADD:"add",DELETE:"delete",CLEAR:"clear"},qne={SKIP:"__v_skip",IS_REACTIVE:"__v_isReactive",IS_READONLY:"__v_isReadonly",IS_SHALLOW:"__v_isShallow",RAW:"__v_raw",IS_REF:"__v_isRef"},Yne={WATCH_GETTER:2,2:"WATCH_GETTER",WATCH_CALLBACK:3,3:"WATCH_CALLBACK",WATCH_CLEANUP:4,4:"WATCH_CLEANUP"},k1={},Zw=new WeakMap;let Jh;function Zne(){return Jh}function uj(r,e=!1,t=Jh){if(t){let n=Zw.get(t);n||Zw.set(t,n=[]),n.push(r)}}function Qne(r,e,t=Tr.EMPTY_OBJ){const{immediate:n,deep:i,once:s,scheduler:a,augmentJob:o,call:u}=t,f=$=>i?$:Wa($)||i===!1||i===0?Nu($,1):Nu($);let g,y,A,C,M=!1,k=!1;if(Co(r)?(y=()=>r.value,M=Wa(r)):jf(r)?(y=()=>f(r),M=!0):Tr.isArray(r)?(k=!0,M=r.some($=>jf($)||Wa($)),y=()=>r.map($=>{if(Co($))return $.value;if(jf($))return f($);if(Tr.isFunction($))return u?u($,2):$()})):Tr.isFunction(r)?e?y=u?()=>u(r,2):r:y=()=>{if(A){_R();try{A()}finally{vR()}}const $=Jh;Jh=g;try{return u?u(r,3,[C]):r(C)}finally{Jh=$}}:y=Tr.NOOP,e&&i){const $=y,te=i===!0?1/0:i;y=()=>Nu($(),te)}const D=W$(),V=()=>{g.stop(),D&&D.active&&Tr.remove(D.effects,g)};if(s&&e){const $=e;e=(...te)=>{$(...te),V()}}let W=k?new Array(r.length).fill(k1):k1;const z=$=>{if(!(!(g.flags&1)||!g.dirty&&!$))if(e){const te=g.run();if(i||M||(k?te.some((le,_e)=>Tr.hasChanged(le,W[_e])):Tr.hasChanged(te,W))){A&&A();const le=Jh;Jh=g;try{const _e=[te,W===k1?void 0:k&&W[0]===k1?[]:W,C];W=te,u?u(e,3,_e):e(..._e)}finally{Jh=le}}}else g.run()};return o&&o(z),g=new y_(y),g.scheduler=a?()=>a(z,!1):z,C=$=>uj($,!1,g),A=g.onStop=()=>{const $=Zw.get(g);if($){if(u)u($,4);else for(const te of $)te();Zw.delete(g)}},e?n?z(!0):W=g.run():a?a(z.bind(null,!0),!0):g.run(),V.pause=g.pause.bind(g),V.resume=g.resume.bind(g),V.stop=V,V}function Nu(r,e=1/0,t){if(e<=0||!Tr.isObject(r)||r.__v_skip||(t=t||new Map,(t.get(r)||0)>=e))return r;if(t.set(r,e),e--,Co(r))Nu(r.value,e,t);else if(Tr.isArray(r))for(let n=0;n<r.length;n++)Nu(r[n],e,t);else if(Tr.isSet(r)||Tr.isMap(r))r.forEach(n=>{Nu(n,e,t)});else if(Tr.isPlainObject(r)){for(const n in r)Nu(r[n],e,t);for(const n of Object.getOwnPropertySymbols(r))Object.prototype.propertyIsEnumerable.call(r,n)&&Nu(r[n],e,t)}return r}kr.ARRAY_ITERATE_KEY=Hm;kr.EffectFlags=ane;kr.EffectScope=H$;kr.ITERATE_KEY=dd;kr.MAP_KEY_ITERATE_KEY=qw;kr.ReactiveEffect=y_;kr.ReactiveFlags=qne;kr.TrackOpTypes=Xne;kr.TriggerOpTypes=Jne;kr.WatchErrorCodes=Yne;kr.computed=Kne;kr.customRef=Vne;kr.effect=cne;kr.effectScope=sne;kr.enableTracking=hne;kr.getCurrentScope=W$;kr.getCurrentWatcher=Zne;kr.isProxy=xR;kr.isReactive=jf;kr.isReadonly=Wu;kr.isRef=Co;kr.isShallow=Wa;kr.markRaw=kne;kr.onEffectCleanup=dne;kr.onScopeDispose=one;kr.onWatcherCleanup=uj;kr.pauseTracking=_R;kr.proxyRefs=Une;kr.reactive=AR;kr.reactiveReadArray=If;kr.readonly=Yw;kr.ref=aj;kr.resetTracking=vR;kr.shallowReactive=Mne;kr.shallowReadArray=GT;kr.shallowReadonly=Rne;kr.shallowRef=One;kr.stop=une;kr.toRaw=Kn;kr.toReactive=Wc;kr.toReadonly=Wm;kr.toRef=Hne;kr.toRefs=$ne;kr.toValue=Nne;kr.track=Uo;kr.traverse=Nu;kr.trigger=Lu;kr.triggerRef=Lne;kr.unref=KT;kr.watch=Qne;/**
* @vue/runtime-core v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/Object.defineProperty(dt,"__esModule",{value:!0});var rr=kr,Ce=Zt;function eie(r){}function tie(){}function rie(r,e){}const nie={SETUP_FUNCTION:0,0:"SETUP_FUNCTION",RENDER_FUNCTION:1,1:"RENDER_FUNCTION",NATIVE_EVENT_HANDLER:5,5:"NATIVE_EVENT_HANDLER",COMPONENT_EVENT_HANDLER:6,6:"COMPONENT_EVENT_HANDLER",VNODE_HOOK:7,7:"VNODE_HOOK",DIRECTIVE_HOOK:8,8:"DIRECTIVE_HOOK",TRANSITION_HOOK:9,9:"TRANSITION_HOOK",APP_ERROR_HANDLER:10,10:"APP_ERROR_HANDLER",APP_WARN_HANDLER:11,11:"APP_WARN_HANDLER",FUNCTION_REF:12,12:"FUNCTION_REF",ASYNC_COMPONENT_LOADER:13,13:"ASYNC_COMPONENT_LOADER",SCHEDULER:14,14:"SCHEDULER",COMPONENT_UPDATE:15,15:"COMPONENT_UPDATE",APP_UNMOUNT_CLEANUP:16,16:"APP_UNMOUNT_CLEANUP"},iie={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",0:"setup function",1:"render function",2:"watcher getter",3:"watcher callback",4:"watcher cleanup function",5:"native event handler",6:"component event handler",7:"vnode hook",8:"directive hook",9:"transition hook",10:"app errorHandler",11:"app warnHandler",12:"ref function",13:"async component loader",14:"scheduler flush",15:"component update",16:"app unmount cleanup function"};function _y(r,e,t,n){try{return n?r(...n):r()}catch(i){bp(i,e,t)}}function tc(r,e,t,n){if(Ce.isFunction(r)){const i=_y(r,e,t,n);return i&&Ce.isPromise(i)&&i.catch(s=>{bp(s,e,t)}),i}if(Ce.isArray(r)){const i=[];for(let s=0;s<r.length;s++)i.push(tc(r[s],e,t,n));return i}}function bp(r,e,t,n=!0){const i=e?e.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:a}=e&&e.appContext.config||Ce.EMPTY_OBJ;if(e){let o=e.parent;const u=e.proxy,f=`https://vuejs.org/error-reference/#runtime-${t}`;for(;o;){const g=o.ec;if(g){for(let y=0;y<g.length;y++)if(g[y](r,u,f)===!1)return}o=o.parent}if(s){rr.pauseTracking(),_y(s,null,10,[r,u,f]),rr.resetTracking();return}}sie(r,t,i,n,a)}function sie(r,e,t,n=!0,i=!1){if(i)throw r;console.error(r)}const zo=[];let Mc=-1;const Im=[];let qh=null,nm=0;const hj=Promise.resolve();let Qw=null;function dj(r){const e=Qw||hj;return r?e.then(this?r.bind(this):r):e}function oie(r){let e=Mc+1,t=zo.length;for(;e<t;){const n=e+t>>>1,i=zo[n],s=__(i);s<r||s===r&&i.flags&2?e=n+1:t=n}return e}function wR(r){if(!(r.flags&1)){const e=__(r),t=zo[zo.length-1];!t||!(r.flags&2)&&e>=__(t)?zo.push(r):zo.splice(oie(e),0,r),r.flags|=1,fj()}}function fj(){Qw||(Qw=hj.then(pj))}function eC(r){Ce.isArray(r)?Im.push(...r):qh&&r.id===-1?qh.splice(nm+1,0,r):r.flags&1||(Im.push(r),r.flags|=1),fj()}function FF(r,e,t=Mc+1){for(;t<zo.length;t++){const n=zo[t];if(n&&n.flags&2){if(r&&n.id!==r.uid)continue;zo.splice(t,1),t--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function tC(r){if(Im.length){const e=[...new Set(Im)].sort((t,n)=>__(t)-__(n));if(Im.length=0,qh){qh.push(...e);return}for(qh=e,nm=0;nm<qh.length;nm++){const t=qh[nm];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}qh=null,nm=0}}const __=r=>r.id==null?r.flags&2?-1:1/0:r.id;function pj(r){try{for(Mc=0;Mc<zo.length;Mc++){const e=zo[Mc];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),_y(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Mc<zo.length;Mc++){const e=zo[Mc];e&&(e.flags&=-2)}Mc=-1,zo.length=0,tC(),Qw=null,(zo.length||Im.length)&&pj()}}let io=null,XT=null;function v_(r){const e=io;return io=r,XT=r&&r.type.__scopeId||null,e}function aie(r){XT=r}function lie(){XT=null}const cie=r=>CR;function CR(r,e=io,t){if(!e||r._n)return r;const n=(...i)=>{n._d&&C_(-1);const s=v_(e);let a;try{a=r(...i)}finally{v_(s),n._d&&C_(1)}return a};return n._n=!0,n._c=!0,n._d=!0,n}function uie(r,e){if(io===null)return r;const t=jv(io),n=r.dirs||(r.dirs=[]);for(let i=0;i<e.length;i++){let[s,a,o,u=Ce.EMPTY_OBJ]=e[i];s&&(Ce.isFunction(s)&&(s={mounted:s,updated:s}),s.deep&&rr.traverse(a),n.push({dir:s,instance:t,value:a,oldValue:void 0,arg:o,modifiers:u}))}return r}function Rc(r,e,t,n){const i=r.dirs,s=e&&e.dirs;for(let a=0;a<i.length;a++){const o=i[a];s&&(o.oldValue=s[a].value);let u=o.dir[n];u&&(rr.pauseTracking(),tc(u,t,8,[r.el,o,r,e]),rr.resetTracking())}}function gj(r,e){if(no){let t=no.provides;const n=no.parent&&no.parent.provides;n===t&&(t=no.provides=Object.create(n)),t[r]=e}}function $0(r,e,t=!1){const n=qc();if(n||Gf){let i=Gf?Gf._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(i&&r in i)return i[r];if(arguments.length>1)return t&&Ce.isFunction(e)?e.call(n&&n.proxy):e}}function hie(){return!!(qc()||Gf)}const mj=Symbol.for("v-scx"),yj=()=>$0(mj);function die(r,e){return Vv(r,null,e)}function fie(r,e){return Vv(r,null,{flush:"post"})}function bj(r,e){return Vv(r,null,{flush:"sync"})}function j0(r,e,t){return Vv(r,e,t)}function Vv(r,e,t=Ce.EMPTY_OBJ){const{immediate:n,deep:i,flush:s,once:a}=t,o=Ce.extend({},t),u=e&&n||!e&&s!=="post";let f;if(Km){if(s==="sync"){const C=yj();f=C.__watcherHandles||(C.__watcherHandles=[])}else if(!u){const C=()=>{};return C.stop=Ce.NOOP,C.resume=Ce.NOOP,C.pause=Ce.NOOP,C}}const g=no;o.call=(C,M,k)=>tc(C,g,M,k);let y=!1;s==="post"?o.scheduler=C=>{gs(C,g&&g.suspense)}:s!=="sync"&&(y=!0,o.scheduler=(C,M)=>{M?C():wR(C)}),o.augmentJob=C=>{e&&(C.flags|=4),y&&(C.flags|=2,g&&(C.id=g.uid,C.i=g))};const A=rr.watch(r,e,o);return Km&&(f?f.push(A):u&&A()),A}function pie(r,e,t){const n=this.proxy,i=Ce.isString(r)?r.includes(".")?_j(n,r):()=>n[r]:r.bind(n,n);let s;Ce.isFunction(e)?s=e:(s=e.handler,t=e);const a=op(this),o=Vv(i,s.bind(n),t);return a(),o}function _j(r,e){const t=e.split(".");return()=>{let n=r;for(let i=0;i<t.length&&n;i++)n=n[t[i]];return n}}const vj=Symbol("_vte"),Aj=r=>r.__isTeleport,G0=r=>r&&(r.disabled||r.disabled===""),UF=r=>r&&(r.defer||r.defer===""),zF=r=>typeof SVGElement<"u"&&r instanceof SVGElement,VF=r=>typeof MathMLElement=="function"&&r instanceof MathMLElement,g3=(r,e)=>{const t=r&&r.to;return Ce.isString(t)?e?e(t):null:t},xj={name:"Teleport",__isTeleport:!0,process(r,e,t,n,i,s,a,o,u,f){const{mc:g,pc:y,pbc:A,o:{insert:C,querySelector:M,createText:k,createComment:D}}=f,V=G0(e.props);let{shapeFlag:W,children:z,dynamicChildren:$}=e;if(r==null){const te=e.el=k(""),le=e.anchor=k("");C(te,t,n),C(le,t,n);const _e=(Y,ce)=>{W&16&&g(z,Y,ce,i,s,a,o,u)},se=()=>{const Y=e.target=g3(e.props,M),ce=wj(Y,e,k,C);Y&&(a!=="svg"&&zF(Y)?a="svg":a!=="mathml"&&VF(Y)&&(a="mathml"),i&&i.isCE&&(i.ce._teleportTargets||(i.ce._teleportTargets=new Set)).add(Y),V||(_e(Y,ce),nw(e,!1)))};V&&(_e(t,le),nw(e,!0)),UF(e.props)?(e.el.__isMounted=!1,gs(()=>{se(),delete e.el.__isMounted},s)):se()}else{if(UF(e.props)&&r.el.__isMounted===!1){gs(()=>{xj.process(r,e,t,n,i,s,a,o,u,f)},s);return}e.el=r.el,e.targetStart=r.targetStart;const te=e.anchor=r.anchor,le=e.target=r.target,_e=e.targetAnchor=r.targetAnchor,se=G0(r.props),Y=se?t:le,ce=se?te:_e;if(a==="svg"||zF(le)?a="svg":(a==="mathml"||VF(le))&&(a="mathml"),$?(A(r.dynamicChildren,$,Y,i,s,a,o),DR(r,e,!0)):u||y(r,e,Y,ce,i,s,a,o,!1),V)se?e.props&&r.props&&e.props.to!==r.props.to&&(e.props.to=r.props.to):O1(e,t,te,f,1);else if((e.props&&e.props.to)!==(r.props&&r.props.to)){const oe=e.target=g3(e.props,M);oe&&O1(e,oe,null,f,0)}else se&&O1(e,le,_e,f,1);nw(e,V)}},remove(r,e,t,{um:n,o:{remove:i}},s){const{shapeFlag:a,children:o,anchor:u,targetStart:f,targetAnchor:g,target:y,props:A}=r;if(y&&(i(f),i(g)),s&&i(u),a&16){const C=s||!G0(A);for(let M=0;M<o.length;M++){const k=o[M];n(k,e,t,C,!!k.dynamicChildren)}}},move:O1,hydrate:gie};function O1(r,e,t,{o:{insert:n},m:i},s=2){s===0&&n(r.targetAnchor,e,t);const{el:a,anchor:o,shapeFlag:u,children:f,props:g}=r,y=s===2;if(y&&n(a,e,t),(!y||G0(g))&&u&16)for(let A=0;A<f.length;A++)i(f[A],e,t,2);y&&n(o,e,t)}function gie(r,e,t,n,i,s,{o:{nextSibling:a,parentNode:o,querySelector:u,insert:f,createText:g}},y){function A(k,D,V,W){D.anchor=y(a(k),D,o(k),t,n,i,s),D.targetStart=V,D.targetAnchor=W}const C=e.target=g3(e.props,u),M=G0(e.props);if(C){const k=C._lpa||C.firstChild;if(e.shapeFlag&16)if(M)A(r,e,k,k&&a(k));else{e.anchor=a(r);let D=k;for(;D;){if(D&&D.nodeType===8){if(D.data==="teleport start anchor")e.targetStart=D;else if(D.data==="teleport anchor"){e.targetAnchor=D,C._lpa=e.targetAnchor&&a(e.targetAnchor);break}}D=a(D)}e.targetAnchor||wj(C,e,g,f),y(k&&a(k),e,C,t,n,i,s)}nw(e,M)}else M&&e.shapeFlag&16&&A(r,e,r,a(r));return e.anchor&&a(e.anchor)}const mie=xj;function nw(r,e){const t=r.ctx;if(t&&t.ut){let n,i;for(e?(n=r.el,i=r.anchor):(n=r.targetStart,i=r.targetAnchor);n&&n!==i;)n.nodeType===1&&n.setAttribute("data-v-owner",t.uid),n=n.nextSibling;t.ut()}}function wj(r,e,t,n){const i=e.targetStart=t(""),s=e.targetAnchor=t("");return i[vj]=s,r&&(n(i,r),n(s,r)),s}const Ru=Symbol("_leaveCb"),D1=Symbol("_enterCb");function Cj(){const r={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return qT(()=>{r.isMounted=!0}),YT(()=>{r.isUnmounting=!0}),r}const il=[Function,Array],Tj={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:il,onEnter:il,onAfterEnter:il,onEnterCancelled:il,onBeforeLeave:il,onLeave:il,onAfterLeave:il,onLeaveCancelled:il,onBeforeAppear:il,onAppear:il,onAfterAppear:il,onAppearCancelled:il},Sj=r=>{const e=r.subTree;return e.component?Sj(e.component):e},yie={name:"BaseTransition",props:Tj,setup(r,{slots:e}){const t=qc(),n=Cj();return()=>{const i=e.default&&TR(e.default(),!0);if(!i||!i.length)return;const s=Ej(i),a=rr.toRaw(r),{mode:o}=a;if(n.isLeaving)return KE(s);const u=$F(s);if(!u)return KE(s);let f=rC(u,a,n,t,y=>f=y);u.type!==es&&ip(u,f);let g=t.subTree&&$F(t.subTree);if(g&&g.type!==es&&!jl(g,u)&&Sj(t).type!==es){let y=rC(g,a,n,t);if(ip(g,y),o==="out-in"&&u.type!==es)return n.isLeaving=!0,y.afterLeave=()=>{n.isLeaving=!1,t.job.flags&8||t.update(),delete y.afterLeave,g=void 0},KE(s);o==="in-out"&&u.type!==es?y.delayLeave=(A,C,M)=>{const k=Ij(n,g);k[String(g.key)]=g,A[Ru]=()=>{C(),A[Ru]=void 0,delete f.delayedLeave,g=void 0},f.delayedLeave=()=>{M(),delete f.delayedLeave,g=void 0}}:g=void 0}else g&&(g=void 0);return s}}};function Ej(r){let e=r[0];if(r.length>1){for(const t of r)if(t.type!==es){e=t;break}}return e}const bie=yie;function Ij(r,e){const{leavingVNodes:t}=r;let n=t.get(e.type);return n||(n=Object.create(null),t.set(e.type,n)),n}function rC(r,e,t,n,i){const{appear:s,mode:a,persisted:o=!1,onBeforeEnter:u,onEnter:f,onAfterEnter:g,onEnterCancelled:y,onBeforeLeave:A,onLeave:C,onAfterLeave:M,onLeaveCancelled:k,onBeforeAppear:D,onAppear:V,onAfterAppear:W,onAppearCancelled:z}=e,$=String(r.key),te=Ij(t,r),le=(Y,ce)=>{Y&&tc(Y,n,9,ce)},_e=(Y,ce)=>{const oe=ce[1];le(Y,ce),Ce.isArray(Y)?Y.every(Me=>Me.length<=1)&&oe():Y.length<=1&&oe()},se={mode:a,persisted:o,beforeEnter(Y){let ce=u;if(!t.isMounted)if(s)ce=D||u;else return;Y[Ru]&&Y[Ru](!0);const oe=te[$];oe&&jl(r,oe)&&oe.el[Ru]&&oe.el[Ru](),le(ce,[Y])},enter(Y){let ce=f,oe=g,Me=y;if(!t.isMounted)if(s)ce=V||f,oe=W||g,Me=z||y;else return;let ze=!1;const Ve=Y[D1]=lt=>{ze||(ze=!0,lt?le(Me,[Y]):le(oe,[Y]),se.delayedLeave&&se.delayedLeave(),Y[D1]=void 0)};ce?_e(ce,[Y,Ve]):Ve()},leave(Y,ce){const oe=String(r.key);if(Y[D1]&&Y[D1](!0),t.isUnmounting)return ce();le(A,[Y]);let Me=!1;const ze=Y[Ru]=Ve=>{Me||(Me=!0,ce(),Ve?le(k,[Y]):le(M,[Y]),Y[Ru]=void 0,te[oe]===r&&delete te[oe])};te[oe]=r,C?_e(C,[Y,ze]):ze()},clone(Y){const ce=rC(Y,e,t,n,i);return i&&i(ce),ce}};return se}function KE(r){if($v(r))return r=Kc(r),r.children=null,r}function $F(r){if(!$v(r))return Aj(r.type)&&r.children?Ej(r.children):r;if(r.component)return r.component.subTree;const{shapeFlag:e,children:t}=r;if(t){if(e&16)return t[0];if(e&32&&Ce.isFunction(t.default))return t.default()}}function ip(r,e){r.shapeFlag&6&&r.component?(r.transition=e,ip(r.component.subTree,e)):r.shapeFlag&128?(r.ssContent.transition=e.clone(r.ssContent),r.ssFallback.transition=e.clone(r.ssFallback)):r.transition=e}function TR(r,e=!1,t){let n=[],i=0;for(let s=0;s<r.length;s++){let a=r[s];const o=t==null?a.key:String(t)+String(a.key!=null?a.key:s);a.type===to?(a.patchFlag&128&&i++,n=n.concat(TR(a.children,e,o))):(e||a.type!==es)&&n.push(o!=null?Kc(a,{key:o}):a)}if(i>1)for(let s=0;s<n.length;s++)n[s].patchFlag=-2;return n}function Pj(r,e){return Ce.isFunction(r)?Ce.extend({name:r.name},e,{setup:r}):r}function _ie(){const r=qc();return r?(r.appContext.config.idPrefix||"v")+"-"+r.ids[0]+r.ids[1]++:""}function SR(r){r.ids=[r.ids[0]+r.ids[2]+++"-",0,0]}function vie(r){const e=qc(),t=rr.shallowRef(null);if(e){const i=e.refs===Ce.EMPTY_OBJ?e.refs={}:e.refs;Object.defineProperty(i,r,{enumerable:!0,get:()=>t.value,set:s=>t.value=s})}return t}const nC=new WeakMap;function Pm(r,e,t,n,i=!1){if(Ce.isArray(r)){r.forEach((M,k)=>Pm(M,e&&(Ce.isArray(e)?e[k]:e),t,n,i));return}if($u(n)&&!i){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&Pm(r,e,t,n.component.subTree);return}const s=n.shapeFlag&4?jv(n.component):n.el,a=i?null:s,{i:o,r:u}=r,f=e&&e.r,g=o.refs===Ce.EMPTY_OBJ?o.refs={}:o.refs,y=o.setupState,A=rr.toRaw(y),C=y===Ce.EMPTY_OBJ?Ce.NO:M=>Ce.hasOwn(A,M);if(f!=null&&f!==u){if(jF(e),Ce.isString(f))g[f]=null,C(f)&&(y[f]=null);else if(rr.isRef(f)){f.value=null;const M=e;M.k&&(g[M.k]=null)}}if(Ce.isFunction(u))_y(u,o,12,[a,g]);else{const M=Ce.isString(u),k=rr.isRef(u);if(M||k){const D=()=>{if(r.f){const V=M?C(u)?y[u]:g[u]:u.value;if(i)Ce.isArray(V)&&Ce.remove(V,s);else if(Ce.isArray(V))V.includes(s)||V.push(s);else if(M)g[u]=[s],C(u)&&(y[u]=g[u]);else{const W=[s];u.value=W,r.k&&(g[r.k]=W)}}else M?(g[u]=a,C(u)&&(y[u]=a)):k&&(u.value=a,r.k&&(g[r.k]=a))};if(a){const V=()=>{D(),nC.delete(r)};V.id=-1,nC.set(r,V),gs(V,t)}else jF(r),D()}}}function jF(r){const e=nC.get(r);e&&(e.flags|=8,nC.delete(r))}let GF=!1;const Bg=()=>{GF||(console.error("Hydration completed but contains mismatches."),GF=!0)},Aie=r=>r.namespaceURI.includes("svg")&&r.tagName!=="foreignObject",xie=r=>r.namespaceURI.includes("MathML"),L1=r=>{if(r.nodeType===1){if(Aie(r))return"svg";if(xie(r))return"mathml"}},dm=r=>r.nodeType===8;function wie(r){const{mt:e,p:t,o:{patchProp:n,createText:i,nextSibling:s,parentNode:a,remove:o,insert:u,createComment:f}}=r,g=(z,$)=>{if(!$.hasChildNodes()){t(null,z,$),tC(),$._vnode=z;return}y($.firstChild,z,null,null,null),tC(),$._vnode=z},y=(z,$,te,le,_e,se=!1)=>{se=se||!!$.dynamicChildren;const Y=dm(z)&&z.data==="[",ce=()=>k(z,$,te,le,_e,Y),{type:oe,ref:Me,shapeFlag:ze,patchFlag:Ve}=$;let lt=z.nodeType;$.el=z,Ve===-2&&(se=!1,$.dynamicChildren=null);let gt=null;switch(oe){case fd:lt!==3?$.children===""?(u($.el=i(""),a(z),z),gt=z):gt=ce():(z.data!==$.children&&(Bg(),z.data=$.children),gt=s(z));break;case es:W(z)?(gt=s(z),V($.el=z.content.firstChild,z,te)):lt!==8||Y?gt=ce():gt=s(z);break;case Mm:if(Y&&(z=s(z),lt=z.nodeType),lt===1||lt===3){gt=z;const At=!$.children.length;for(let Tt=0;Tt<$.staticCount;Tt++)At&&($.children+=gt.nodeType===1?gt.outerHTML:gt.data),Tt===$.staticCount-1&&($.anchor=gt),gt=s(gt);return Y?s(gt):gt}else ce();break;case to:Y?gt=M(z,$,te,le,_e,se):gt=ce();break;default:if(ze&1)(lt!==1||$.type.toLowerCase()!==z.tagName.toLowerCase())&&!W(z)?gt=ce():gt=A(z,$,te,le,_e,se);else if(ze&6){$.slotScopeIds=_e;const At=a(z);if(Y?gt=D(z):dm(z)&&z.data==="teleport start"?gt=D(z,z.data,"teleport end"):gt=s(z),e($,At,null,te,le,L1(At),se),$u($)&&!$.type.__asyncResolved){let Tt;Y?(Tt=Gi(to),Tt.anchor=gt?gt.previousSibling:At.lastChild):Tt=z.nodeType===3?NR(""):Gi("div"),Tt.el=z,$.component.subTree=Tt}}else ze&64?lt!==8?gt=ce():gt=$.type.hydrate(z,$,te,le,_e,se,r,C):ze&128&&(gt=$.type.hydrate(z,$,te,le,L1(a(z)),_e,se,r,y))}return Me!=null&&Pm(Me,null,le,$),gt},A=(z,$,te,le,_e,se)=>{se=se||!!$.dynamicChildren;const{type:Y,props:ce,patchFlag:oe,shapeFlag:Me,dirs:ze,transition:Ve}=$,lt=Y==="input"||Y==="option";if(lt||oe!==-1){ze&&Rc($,null,te,"created");let gt=!1;if(W(z)){gt=e7(null,Ve)&&te&&te.vnode.props&&te.vnode.props.appear;const Tt=z.content.firstChild;if(gt){const Ut=Tt.getAttribute("class");Ut&&(Tt.$cls=Ut),Ve.beforeEnter(Tt)}V(Tt,z,te),$.el=z=Tt}if(Me&16&&!(ce&&(ce.innerHTML||ce.textContent))){let Tt=C(z.firstChild,$,z,te,le,_e,se);for(;Tt;){N1(z,1)||Bg();const Ut=Tt;Tt=Tt.nextSibling,o(Ut)}}else if(Me&8){let Tt=$.children;Tt[0]===`
`&&(z.tagName==="PRE"||z.tagName==="TEXTAREA")&&(Tt=Tt.slice(1));const{textContent:Ut}=z;Ut!==Tt&&Ut!==Tt.replace(/\r\n|\r/g,`
`)&&(N1(z,0)||Bg(),z.textContent=$.children)}if(ce){if(lt||!se||oe&48){const Tt=z.tagName.includes("-");for(const Ut in ce)(lt&&(Ut.endsWith("value")||Ut==="indeterminate")||Ce.isOn(Ut)&&!Ce.isReservedProp(Ut)||Ut[0]==="."||Tt)&&n(z,Ut,null,ce[Ut],void 0,te)}else if(ce.onClick)n(z,"onClick",null,ce.onClick,void 0,te);else if(oe&4&&rr.isReactive(ce.style))for(const Tt in ce.style)ce.style[Tt]}let At;(At=ce&&ce.onVnodeBeforeMount)&&ra(At,te,$),ze&&Rc($,null,te,"beforeMount"),((At=ce&&ce.onVnodeMounted)||ze||gt)&&i7(()=>{At&&ra(At,te,$),gt&&Ve.enter(z),ze&&Rc($,null,te,"mounted")},le)}return z.nextSibling},C=(z,$,te,le,_e,se,Y)=>{Y=Y||!!$.dynamicChildren;const ce=$.children,oe=ce.length;for(let Me=0;Me<oe;Me++){const ze=Y?ce[Me]:ce[Me]=la(ce[Me]),Ve=ze.type===fd;z?(Ve&&!Y&&Me+1<oe&&la(ce[Me+1]).type===fd&&(u(i(z.data.slice(ze.children.length)),te,s(z)),z.data=ze.children),z=y(z,ze,le,_e,se,Y)):Ve&&!ze.children?u(ze.el=i(""),te):(N1(te,1)||Bg(),t(null,ze,te,null,le,_e,L1(te),se))}return z},M=(z,$,te,le,_e,se)=>{const{slotScopeIds:Y}=$;Y&&(_e=_e?_e.concat(Y):Y);const ce=a(z),oe=C(s(z),$,ce,te,le,_e,se);return oe&&dm(oe)&&oe.data==="]"?s($.anchor=oe):(Bg(),u($.anchor=f("]"),ce,oe),oe)},k=(z,$,te,le,_e,se)=>{if(N1(z.parentElement,1)||Bg(),$.el=null,se){const oe=D(z);for(;;){const Me=s(z);if(Me&&Me!==oe)o(Me);else break}}const Y=s(z),ce=a(z);return o(z),t(null,$,ce,Y,te,le,L1(ce),_e),te&&(te.vnode.el=$.el,QT(te,$.el)),Y},D=(z,$="[",te="]")=>{let le=0;for(;z;)if(z=s(z),z&&dm(z)&&(z.data===$&&le++,z.data===te)){if(le===0)return s(z);le--}return z},V=(z,$,te)=>{const le=$.parentNode;le&&le.replaceChild(z,$);let _e=te;for(;_e;)_e.vnode.el===$&&(_e.vnode.el=_e.subTree.el=z),_e=_e.parent},W=z=>z.nodeType===1&&z.tagName==="TEMPLATE";return[g,y]}const HF="data-allow-mismatch",Cie={0:"text",1:"children",2:"class",3:"style",4:"attribute"};function N1(r,e){if(e===0||e===1)for(;r&&!r.hasAttribute(HF);)r=r.parentElement;const t=r&&r.getAttribute(HF);if(t==null)return!1;if(t==="")return!0;{const n=t.split(",");return e===0&&n.includes("children")?!0:n.includes(Cie[e])}}const Tie=Ce.getGlobalThis().requestIdleCallback||(r=>setTimeout(r,1)),Sie=Ce.getGlobalThis().cancelIdleCallback||(r=>clearTimeout(r)),Eie=(r=1e4)=>e=>{const t=Tie(e,{timeout:r});return()=>Sie(t)};function Iie(r){const{top:e,left:t,bottom:n,right:i}=r.getBoundingClientRect(),{innerHeight:s,innerWidth:a}=window;return(e>0&&e<s||n>0&&n<s)&&(t>0&&t<a||i>0&&i<a)}const Pie=r=>(e,t)=>{const n=new IntersectionObserver(i=>{for(const s of i)if(s.isIntersecting){n.disconnect(),e();break}},r);return t(i=>{if(i instanceof Element){if(Iie(i))return e(),n.disconnect(),!1;n.observe(i)}}),()=>n.disconnect()},Bie=r=>e=>{if(r){const t=matchMedia(r);if(t.matches)e();else return t.addEventListener("change",e,{once:!0}),()=>t.removeEventListener("change",e)}},Mie=(r=[])=>(e,t)=>{Ce.isString(r)&&(r=[r]);let n=!1;const i=a=>{n||(n=!0,s(),e(),a.target.dispatchEvent(new a.constructor(a.type,a)))},s=()=>{t(a=>{for(const o of r)a.removeEventListener(o,i)})};return t(a=>{for(const o of r)a.addEventListener(o,i,{once:!0})}),s};function Rie(r,e){if(dm(r)&&r.data==="["){let t=1,n=r.nextSibling;for(;n;){if(n.nodeType===1){if(e(n)===!1)break}else if(dm(n))if(n.data==="]"){if(--t===0)break}else n.data==="["&&t++;n=n.nextSibling}}else e(r)}const $u=r=>!!r.type.__asyncLoader;function kie(r){Ce.isFunction(r)&&(r={loader:r});const{loader:e,loadingComponent:t,errorComponent:n,delay:i=200,hydrate:s,timeout:a,suspensible:o=!0,onError:u}=r;let f=null,g,y=0;const A=()=>(y++,f=null,C()),C=()=>{let M;return f||(M=f=e().catch(k=>{if(k=k instanceof Error?k:new Error(String(k)),u)return new Promise((D,V)=>{u(k,()=>D(A()),()=>V(k),y+1)});throw k}).then(k=>M!==f&&f?f:(k&&(k.__esModule||k[Symbol.toStringTag]==="Module")&&(k=k.default),g=k,k)))};return Pj({name:"AsyncComponentWrapper",__asyncLoader:C,__asyncHydrate(M,k,D){let V=!1;(k.bu||(k.bu=[])).push(()=>V=!0);const W=()=>{V||D()},z=s?()=>{const $=s(W,te=>Rie(M,te));$&&(k.bum||(k.bum=[])).push($)}:W;g?z():C().then(()=>!k.isUnmounted&&z())},get __asyncResolved(){return g},setup(){const M=no;if(SR(M),g)return()=>F1(g,M);const k=z=>{f=null,bp(z,M,13,!n)};if(o&&M.suspense||Km)return C().then(z=>()=>F1(z,M)).catch(z=>(k(z),()=>n?Gi(n,{error:z}):null));const D=rr.ref(!1),V=rr.ref(),W=rr.ref(!!i);return i&&setTimeout(()=>{W.value=!1},i),a!=null&&setTimeout(()=>{if(!D.value&&!V.value){const z=new Error(`Async component timed out after ${a}ms.`);k(z),V.value=z}},a),C().then(()=>{D.value=!0,M.parent&&$v(M.parent.vnode)&&M.parent.update()}).catch(z=>{k(z),V.value=z}),()=>{if(D.value&&g)return F1(g,M);if(V.value&&n)return Gi(n,{error:V.value});if(t&&!W.value)return F1(t,M)}}})}function F1(r,e){const{ref:t,props:n,children:i,ce:s}=e.vnode,a=Gi(r,n,i);return a.ref=t,a.ce=s,delete e.vnode.ce,a}const $v=r=>r.type.__isKeepAlive,Oie={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(r,{slots:e}){const t=qc(),n=t.ctx;if(!n.renderer)return()=>{const W=e.default&&e.default();return W&&W.length===1?W[0]:W};const i=new Map,s=new Set;let a=null;const o=t.suspense,{renderer:{p:u,m:f,um:g,o:{createElement:y}}}=n,A=y("div");n.activate=(W,z,$,te,le)=>{const _e=W.component;f(W,z,$,0,o),u(_e.vnode,W,z,$,_e,o,te,W.slotScopeIds,le),gs(()=>{_e.isDeactivated=!1,_e.a&&Ce.invokeArrayFns(_e.a);const se=W.props&&W.props.onVnodeMounted;se&&ra(se,_e.parent,W)},o)},n.deactivate=W=>{const z=W.component;sC(z.m),sC(z.a),f(W,A,null,1,o),gs(()=>{z.da&&Ce.invokeArrayFns(z.da);const $=W.props&&W.props.onVnodeUnmounted;$&&ra($,z.parent,W),z.isDeactivated=!0},o)};function C(W){XE(W),g(W,t,o,!0)}function M(W){i.forEach((z,$)=>{const te=S3($u(z)?z.type.__asyncResolved||{}:z.type);te&&!W(te)&&k($)})}function k(W){const z=i.get(W);z&&(!a||!jl(z,a))?C(z):a&&XE(a),i.delete(W),s.delete(W)}j0(()=>[r.include,r.exclude],([W,z])=>{W&&M($=>y0(W,$)),z&&M($=>!y0(z,$))},{flush:"post",deep:!0});let D=null;const V=()=>{D!=null&&(oC(t.subTree.type)?gs(()=>{i.set(D,U1(t.subTree))},t.subTree.suspense):i.set(D,U1(t.subTree)))};return qT(V),ER(V),YT(()=>{i.forEach(W=>{const{subTree:z,suspense:$}=t,te=U1(z);if(W.type===te.type&&W.key===te.key){XE(te);const le=te.component.da;le&&gs(le,$);return}C(W)})}),()=>{if(D=null,!e.default)return a=null;const W=e.default(),z=W[0];if(W.length>1)return a=null,W;if(!Ku(z)||!(z.shapeFlag&4)&&!(z.shapeFlag&128))return a=null,z;let $=U1(z);if($.type===es)return a=null,$;const te=$.type,le=S3($u($)?$.type.__asyncResolved||{}:te),{include:_e,exclude:se,max:Y}=r;if(_e&&(!le||!y0(_e,le))||se&&le&&y0(se,le))return $.shapeFlag&=-257,a=$,z;const ce=$.key==null?te:$.key,oe=i.get(ce);return $.el&&($=Kc($),z.shapeFlag&128&&(z.ssContent=$)),D=ce,oe?($.el=oe.el,$.component=oe.component,$.transition&&ip($,$.transition),$.shapeFlag|=512,s.delete(ce),s.add(ce)):(s.add(ce),Y&&s.size>parseInt(Y,10)&&k(s.values().next().value)),$.shapeFlag|=256,a=$,oC(z.type)?z:$}}},Die=Oie;function y0(r,e){return Ce.isArray(r)?r.some(t=>y0(t,e)):Ce.isString(r)?r.split(",").includes(e):Ce.isRegExp(r)?(r.lastIndex=0,r.test(e)):!1}function Bj(r,e){Rj(r,"a",e)}function Mj(r,e){Rj(r,"da",e)}function Rj(r,e,t=no){const n=r.__wdc||(r.__wdc=()=>{let i=t;for(;i;){if(i.isDeactivated)return;i=i.parent}return r()});if(JT(e,n,t),t){let i=t.parent;for(;i&&i.parent;)$v(i.parent.vnode)&&Lie(n,e,t,i),i=i.parent}}function Lie(r,e,t,n){const i=JT(e,r,n,!0);IR(()=>{Ce.remove(n[e],i)},t)}function XE(r){r.shapeFlag&=-257,r.shapeFlag&=-513}function U1(r){return r.shapeFlag&128?r.ssContent:r}function JT(r,e,t=no,n=!1){if(t){const i=t[r]||(t[r]=[]),s=e.__weh||(e.__weh=(...a)=>{rr.pauseTracking();const o=op(t),u=tc(e,t,r,a);return o(),rr.resetTracking(),u});return n?i.unshift(s):i.push(s),s}}const rh=r=>(e,t=no)=>{(!Km||r==="sp")&&JT(r,(...n)=>e(...n),t)},kj=rh("bm"),qT=rh("m"),Oj=rh("bu"),ER=rh("u"),YT=rh("bum"),IR=rh("um"),Dj=rh("sp"),Lj=rh("rtg"),Nj=rh("rtc");function Fj(r,e=no){JT("ec",r,e)}const PR="components",Nie="directives";function Fie(r,e){return BR(PR,r,!0,e)||r}const Uj=Symbol.for("v-ndc");function Uie(r){return Ce.isString(r)?BR(PR,r,!1)||r:r||Uj}function zie(r){return BR(Nie,r)}function BR(r,e,t=!0,n=!1){const i=io||no;if(i){const s=i.type;if(r===PR){const o=S3(s,!1);if(o&&(o===e||o===Ce.camelize(e)||o===Ce.capitalize(Ce.camelize(e))))return s}const a=WF(i[r]||s[r],e)||WF(i.appContext[r],e);return!a&&n?s:a}}function WF(r,e){return r&&(r[e]||r[Ce.camelize(e)]||r[Ce.capitalize(Ce.camelize(e))])}function Vie(r,e,t,n){let i;const s=t&&t[n],a=Ce.isArray(r);if(a||Ce.isString(r)){const o=a&&rr.isReactive(r);let u=!1,f=!1;o&&(u=!rr.isShallow(r),f=rr.isReadonly(r),r=rr.shallowReadArray(r)),i=new Array(r.length);for(let g=0,y=r.length;g<y;g++)i[g]=e(u?f?rr.toReadonly(rr.toReactive(r[g])):rr.toReactive(r[g]):r[g],g,void 0,s&&s[g])}else if(typeof r=="number"){i=new Array(r);for(let o=0;o<r;o++)i[o]=e(o+1,o,void 0,s&&s[o])}else if(Ce.isObject(r))if(r[Symbol.iterator])i=Array.from(r,(o,u)=>e(o,u,void 0,s&&s[u]));else{const o=Object.keys(r);i=new Array(o.length);for(let u=0,f=o.length;u<f;u++){const g=o[u];i[u]=e(r[g],g,u,s&&s[u])}}else i=[];return t&&(t[n]=i),i}function $ie(r,e){for(let t=0;t<e.length;t++){const n=e[t];if(Ce.isArray(n))for(let i=0;i<n.length;i++)r[n[i].name]=n[i].fn;else n&&(r[n.name]=n.key?(...i)=>{const s=n.fn(...i);return s&&(s.key=n.key),s}:n.fn)}return r}function jie(r,e,t={},n,i){if(io.ce||io.parent&&$u(io.parent)&&io.parent.ce){const f=Object.keys(t).length>0;return e!=="default"&&(t.name=e),w_(),aC(to,null,[Gi("slot",t,n&&n())],f?-2:64)}let s=r[e];s&&s._c&&(s._d=!1),w_();const a=s&&MR(s(t)),o=t.key||a&&a.key,u=aC(to,{key:(o&&!Ce.isSymbol(o)?o:`_${e}`)+(!a&&n?"_fb":"")},a||(n?n():[]),a&&r._===1?64:-2);return!i&&u.scopeId&&(u.slotScopeIds=[u.scopeId+"-s"]),s&&s._c&&(s._d=!0),u}function MR(r){return r.some(e=>Ku(e)?!(e.type===es||e.type===to&&!MR(e.children)):!0)?r:null}function Gie(r,e){const t={};for(const n in r)t[e&&/[A-Z]/.test(n)?`on:${n}`:Ce.toHandlerKey(n)]=r[n];return t}const m3=r=>r?h7(r)?jv(r):m3(r.parent):null,H0=Ce.extend(Object.create(null),{$:r=>r,$el:r=>r.vnode.el,$data:r=>r.data,$props:r=>r.props,$attrs:r=>r.attrs,$slots:r=>r.slots,$refs:r=>r.refs,$parent:r=>m3(r.parent),$root:r=>m3(r.root),$host:r=>r.ce,$emit:r=>r.emit,$options:r=>RR(r),$forceUpdate:r=>r.f||(r.f=()=>{wR(r.update)}),$nextTick:r=>r.n||(r.n=dj.bind(r.proxy)),$watch:r=>pie.bind(r)}),JE=(r,e)=>r!==Ce.EMPTY_OBJ&&!r.__isScriptSetup&&Ce.hasOwn(r,e),y3={get({_:r},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:n,data:i,props:s,accessCache:a,type:o,appContext:u}=r;if(e[0]!=="$"){const A=a[e];if(A!==void 0)switch(A){case 1:return n[e];case 2:return i[e];case 4:return t[e];case 3:return s[e]}else{if(JE(n,e))return a[e]=1,n[e];if(i!==Ce.EMPTY_OBJ&&Ce.hasOwn(i,e))return a[e]=2,i[e];if(Ce.hasOwn(s,e))return a[e]=3,s[e];if(t!==Ce.EMPTY_OBJ&&Ce.hasOwn(t,e))return a[e]=4,t[e];b3&&(a[e]=0)}}const f=H0[e];let g,y;if(f)return e==="$attrs"&&rr.track(r.attrs,"get",""),f(r);if((g=o.__cssModules)&&(g=g[e]))return g;if(t!==Ce.EMPTY_OBJ&&Ce.hasOwn(t,e))return a[e]=4,t[e];if(y=u.config.globalProperties,Ce.hasOwn(y,e))return y[e]},set({_:r},e,t){const{data:n,setupState:i,ctx:s}=r;return JE(i,e)?(i[e]=t,!0):n!==Ce.EMPTY_OBJ&&Ce.hasOwn(n,e)?(n[e]=t,!0):Ce.hasOwn(r.props,e)||e[0]==="$"&&e.slice(1)in r?!1:(s[e]=t,!0)},has({_:{data:r,setupState:e,accessCache:t,ctx:n,appContext:i,props:s,type:a}},o){let u;return!!(t[o]||r!==Ce.EMPTY_OBJ&&o[0]!=="$"&&Ce.hasOwn(r,o)||JE(e,o)||Ce.hasOwn(s,o)||Ce.hasOwn(n,o)||Ce.hasOwn(H0,o)||Ce.hasOwn(i.config.globalProperties,o)||(u=a.__cssModules)&&u[o])},defineProperty(r,e,t){return t.get!=null?r._.accessCache[e]=0:Ce.hasOwn(t,"value")&&this.set(r,e,t.value,null),Reflect.defineProperty(r,e,t)}},Hie=Ce.extend({},y3,{get(r,e){if(e!==Symbol.unscopables)return y3.get(r,e,r)},has(r,e){return e[0]!=="_"&&!Ce.isGloballyAllowed(e)}});function Wie(){return null}function Kie(){return null}function Xie(r){}function Jie(r){}function qie(){return null}function Yie(){}function Zie(r,e){return null}function Qie(){return zj().slots}function ese(){return zj().attrs}function zj(r){const e=qc();return e.setupContext||(e.setupContext=p7(e))}function A_(r){return Ce.isArray(r)?r.reduce((e,t)=>(e[t]=null,e),{}):r}function tse(r,e){const t=A_(r);for(const n in e){if(n.startsWith("__skip"))continue;let i=t[n];i?Ce.isArray(i)||Ce.isFunction(i)?i=t[n]={type:i,default:e[n]}:i.default=e[n]:i===null&&(i=t[n]={default:e[n]}),i&&e[`__skip_${n}`]&&(i.skipFactory=!0)}return t}function rse(r,e){return!r||!e?r||e:Ce.isArray(r)&&Ce.isArray(e)?r.concat(e):Ce.extend({},A_(r),A_(e))}function nse(r,e){const t={};for(const n in r)e.includes(n)||Object.defineProperty(t,n,{enumerable:!0,get:()=>r[n]});return t}function ise(r){const e=qc();let t=r();return w3(),Ce.isPromise(t)&&(t=t.catch(n=>{throw op(e),n})),[t,()=>op(e)]}let b3=!0;function sse(r){const e=RR(r),t=r.proxy,n=r.ctx;b3=!1,e.beforeCreate&&KF(e.beforeCreate,r,"bc");const{data:i,computed:s,methods:a,watch:o,provide:u,inject:f,created:g,beforeMount:y,mounted:A,beforeUpdate:C,updated:M,activated:k,deactivated:D,beforeDestroy:V,beforeUnmount:W,destroyed:z,unmounted:$,render:te,renderTracked:le,renderTriggered:_e,errorCaptured:se,serverPrefetch:Y,expose:ce,inheritAttrs:oe,components:Me,directives:ze,filters:Ve}=e;if(f&&ose(f,n,null),a)for(const At in a){const Tt=a[At];Ce.isFunction(Tt)&&(n[At]=Tt.bind(t))}if(i){const At=i.call(t,t);Ce.isObject(At)&&(r.data=rr.reactive(At))}if(b3=!0,s)for(const At in s){const Tt=s[At],Ut=Ce.isFunction(Tt)?Tt.bind(t,t):Ce.isFunction(Tt.get)?Tt.get.bind(t,t):Ce.NOOP,xr=!Ce.isFunction(Tt)&&Ce.isFunction(Tt.set)?Tt.set.bind(t):Ce.NOOP,Er=g7({get:Ut,set:xr});Object.defineProperty(n,At,{enumerable:!0,configurable:!0,get:()=>Er.value,set:Jr=>Er.value=Jr})}if(o)for(const At in o)Vj(o[At],n,t,At);if(u){const At=Ce.isFunction(u)?u.call(t):u;Reflect.ownKeys(At).forEach(Tt=>{gj(Tt,At[Tt])})}g&&KF(g,r,"c");function gt(At,Tt){Ce.isArray(Tt)?Tt.forEach(Ut=>At(Ut.bind(t))):Tt&&At(Tt.bind(t))}if(gt(kj,y),gt(qT,A),gt(Oj,C),gt(ER,M),gt(Bj,k),gt(Mj,D),gt(Fj,se),gt(Nj,le),gt(Lj,_e),gt(YT,W),gt(IR,$),gt(Dj,Y),Ce.isArray(ce))if(ce.length){const At=r.exposed||(r.exposed={});ce.forEach(Tt=>{Object.defineProperty(At,Tt,{get:()=>t[Tt],set:Ut=>t[Tt]=Ut,enumerable:!0})})}else r.exposed||(r.exposed={});te&&r.render===Ce.NOOP&&(r.render=te),oe!=null&&(r.inheritAttrs=oe),Me&&(r.components=Me),ze&&(r.directives=ze),Y&&SR(r)}function ose(r,e,t=Ce.NOOP){Ce.isArray(r)&&(r=_3(r));for(const n in r){const i=r[n];let s;Ce.isObject(i)?"default"in i?s=$0(i.from||n,i.default,!0):s=$0(i.from||n):s=$0(i),rr.isRef(s)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>s.value,set:a=>s.value=a}):e[n]=s}}function KF(r,e,t){tc(Ce.isArray(r)?r.map(n=>n.bind(e.proxy)):r.bind(e.proxy),e,t)}function Vj(r,e,t,n){let i=n.includes(".")?_j(t,n):()=>t[n];if(Ce.isString(r)){const s=e[r];Ce.isFunction(s)&&j0(i,s)}else if(Ce.isFunction(r))j0(i,r.bind(t));else if(Ce.isObject(r))if(Ce.isArray(r))r.forEach(s=>Vj(s,e,t,n));else{const s=Ce.isFunction(r.handler)?r.handler.bind(t):e[r.handler];Ce.isFunction(s)&&j0(i,s,r)}}function RR(r){const e=r.type,{mixins:t,extends:n}=e,{mixins:i,optionsCache:s,config:{optionMergeStrategies:a}}=r.appContext,o=s.get(e);let u;return o?u=o:!i.length&&!t&&!n?u=e:(u={},i.length&&i.forEach(f=>iC(u,f,a,!0)),iC(u,e,a)),Ce.isObject(e)&&s.set(e,u),u}function iC(r,e,t,n=!1){const{mixins:i,extends:s}=e;s&&iC(r,s,t,!0),i&&i.forEach(a=>iC(r,a,t,!0));for(const a in e)if(!(n&&a==="expose")){const o=ase[a]||t&&t[a];r[a]=o?o(r[a],e[a]):e[a]}return r}const ase={data:XF,props:JF,emits:JF,methods:b0,computed:b0,beforeCreate:Do,created:Do,beforeMount:Do,mounted:Do,beforeUpdate:Do,updated:Do,beforeDestroy:Do,beforeUnmount:Do,destroyed:Do,unmounted:Do,activated:Do,deactivated:Do,errorCaptured:Do,serverPrefetch:Do,components:b0,directives:b0,watch:cse,provide:XF,inject:lse};function XF(r,e){return e?r?function(){return Ce.extend(Ce.isFunction(r)?r.call(this,this):r,Ce.isFunction(e)?e.call(this,this):e)}:e:r}function lse(r,e){return b0(_3(r),_3(e))}function _3(r){if(Ce.isArray(r)){const e={};for(let t=0;t<r.length;t++)e[r[t]]=r[t];return e}return r}function Do(r,e){return r?[...new Set([].concat(r,e))]:e}function b0(r,e){return r?Ce.extend(Object.create(null),r,e):e}function JF(r,e){return r?Ce.isArray(r)&&Ce.isArray(e)?[...new Set([...r,...e])]:Ce.extend(Object.create(null),A_(r),A_(e??{})):e}function cse(r,e){if(!r)return e;if(!e)return r;const t=Ce.extend(Object.create(null),r);for(const n in e)t[n]=Do(r[n],e[n]);return t}function $j(){return{app:null,config:{isNativeTag:Ce.NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let use=0;function hse(r,e){return function(n,i=null){Ce.isFunction(n)||(n=Ce.extend({},n)),i!=null&&!Ce.isObject(i)&&(i=null);const s=$j(),a=new WeakSet,o=[];let u=!1;const f=s.app={_uid:use++,_component:n,_props:i,_container:null,_context:s,_instance:null,version:y7,get config(){return s.config},set config(g){},use(g,...y){return a.has(g)||(g&&Ce.isFunction(g.install)?(a.add(g),g.install(f,...y)):Ce.isFunction(g)&&(a.add(g),g(f,...y))),f},mixin(g){return s.mixins.includes(g)||s.mixins.push(g),f},component(g,y){return y?(s.components[g]=y,f):s.components[g]},directive(g,y){return y?(s.directives[g]=y,f):s.directives[g]},mount(g,y,A){if(!u){const C=f._ceVNode||Gi(n,i);return C.appContext=s,A===!0?A="svg":A===!1&&(A=void 0),y&&e?e(C,g):r(C,g,A),u=!0,f._container=g,g.__vue_app__=f,jv(C.component)}},onUnmount(g){o.push(g)},unmount(){u&&(tc(o,f._instance,16),r(null,f._container),delete f._container.__vue_app__)},provide(g,y){return s.provides[g]=y,f},runWithContext(g){const y=Gf;Gf=f;try{return g()}finally{Gf=y}}};return f}}let Gf=null;function dse(r,e,t=Ce.EMPTY_OBJ){const n=qc(),i=Ce.camelize(e),s=Ce.hyphenate(e),a=jj(r,i),o=rr.customRef((u,f)=>{let g,y=Ce.EMPTY_OBJ,A;return bj(()=>{const C=r[i];Ce.hasChanged(g,C)&&(g=C,f())}),{get(){return u(),t.get?t.get(g):g},set(C){const M=t.set?t.set(C):C;if(!Ce.hasChanged(M,g)&&!(y!==Ce.EMPTY_OBJ&&Ce.hasChanged(C,y)))return;const k=n.vnode.props;k&&(e in k||i in k||s in k)&&(`onUpdate:${e}`in k||`onUpdate:${i}`in k||`onUpdate:${s}`in k)||(g=C,f()),n.emit(`update:${e}`,M),Ce.hasChanged(C,M)&&Ce.hasChanged(C,y)&&!Ce.hasChanged(M,A)&&f(),y=C,A=M}}});return o[Symbol.iterator]=()=>{let u=0;return{next(){return u<2?{value:u++?a||Ce.EMPTY_OBJ:o,done:!1}:{done:!0}}}},o}const jj=(r,e)=>e==="modelValue"||e==="model-value"?r.modelModifiers:r[`${e}Modifiers`]||r[`${Ce.camelize(e)}Modifiers`]||r[`${Ce.hyphenate(e)}Modifiers`];function fse(r,e,...t){if(r.isUnmounted)return;const n=r.vnode.props||Ce.EMPTY_OBJ;let i=t;const s=e.startsWith("update:"),a=s&&jj(n,e.slice(7));a&&(a.trim&&(i=t.map(g=>Ce.isString(g)?g.trim():g)),a.number&&(i=t.map(Ce.looseToNumber)));let o,u=n[o=Ce.toHandlerKey(e)]||n[o=Ce.toHandlerKey(Ce.camelize(e))];!u&&s&&(u=n[o=Ce.toHandlerKey(Ce.hyphenate(e))]),u&&tc(u,r,6,i);const f=n[o+"Once"];if(f){if(!r.emitted)r.emitted={};else if(r.emitted[o])return;r.emitted[o]=!0,tc(f,r,6,i)}}const pse=new WeakMap;function Gj(r,e,t=!1){const n=t?pse:e.emitsCache,i=n.get(r);if(i!==void 0)return i;const s=r.emits;let a={},o=!1;if(!Ce.isFunction(r)){const u=f=>{const g=Gj(f,e,!0);g&&(o=!0,Ce.extend(a,g))};!t&&e.mixins.length&&e.mixins.forEach(u),r.extends&&u(r.extends),r.mixins&&r.mixins.forEach(u)}return!s&&!o?(Ce.isObject(r)&&n.set(r,null),null):(Ce.isArray(s)?s.forEach(u=>a[u]=null):Ce.extend(a,s),Ce.isObject(r)&&n.set(r,a),a)}function ZT(r,e){return!r||!Ce.isOn(e)?!1:(e=e.slice(2).replace(/Once$/,""),Ce.hasOwn(r,e[0].toLowerCase()+e.slice(1))||Ce.hasOwn(r,Ce.hyphenate(e))||Ce.hasOwn(r,e))}function iw(r){const{type:e,vnode:t,proxy:n,withProxy:i,propsOptions:[s],slots:a,attrs:o,emit:u,render:f,renderCache:g,props:y,data:A,setupState:C,ctx:M,inheritAttrs:k}=r,D=v_(r);let V,W;try{if(t.shapeFlag&4){const $=i||n,te=$;V=la(f.call(te,$,g,y,C,A,M)),W=o}else{const $=e;V=la($.length>1?$(y,{attrs:o,slots:a,emit:u}):$(y,null)),W=e.props?o:mse(o)}}catch($){W0.length=0,bp($,r,1),V=Gi(es)}let z=V;if(W&&k!==!1){const $=Object.keys(W),{shapeFlag:te}=z;$.length&&te&7&&(s&&$.some(Ce.isModelListener)&&(W=yse(W,s)),z=Kc(z,W,!1,!0))}return t.dirs&&(z=Kc(z,null,!1,!0),z.dirs=z.dirs?z.dirs.concat(t.dirs):t.dirs),t.transition&&ip(z,t.transition),V=z,v_(D),V}function gse(r,e=!0){let t;for(let n=0;n<r.length;n++){const i=r[n];if(Ku(i)){if(i.type!==es||i.children==="v-if"){if(t)return;t=i}}else return}return t}const mse=r=>{let e;for(const t in r)(t==="class"||t==="style"||Ce.isOn(t))&&((e||(e={}))[t]=r[t]);return e},yse=(r,e)=>{const t={};for(const n in r)(!Ce.isModelListener(n)||!(n.slice(9)in e))&&(t[n]=r[n]);return t};function bse(r,e,t){const{props:n,children:i,component:s}=r,{props:a,children:o,patchFlag:u}=e,f=s.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&u>=0){if(u&1024)return!0;if(u&16)return n?qF(n,a,f):!!a;if(u&8){const g=e.dynamicProps;for(let y=0;y<g.length;y++){const A=g[y];if(a[A]!==n[A]&&!ZT(f,A))return!0}}}else return(i||o)&&(!o||!o.$stable)?!0:n===a?!1:n?a?qF(n,a,f):!0:!!a;return!1}function qF(r,e,t){const n=Object.keys(e);if(n.length!==Object.keys(r).length)return!0;for(let i=0;i<n.length;i++){const s=n[i];if(e[s]!==r[s]&&!ZT(t,s))return!0}return!1}function QT({vnode:r,parent:e},t){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===r&&(n.el=r.el),n===r)(r=e.vnode).el=t,e=e.parent;else break}}const Hj={},Wj=()=>Object.create(Hj),Kj=r=>Object.getPrototypeOf(r)===Hj;function _se(r,e,t,n=!1){const i={},s=Wj();r.propsDefaults=Object.create(null),Xj(r,e,i,s);for(const a in r.propsOptions[0])a in i||(i[a]=void 0);t?r.props=n?i:rr.shallowReactive(i):r.type.props?r.props=i:r.props=s,r.attrs=s}function vse(r,e,t,n){const{props:i,attrs:s,vnode:{patchFlag:a}}=r,o=rr.toRaw(i),[u]=r.propsOptions;let f=!1;if((n||a>0)&&!(a&16)){if(a&8){const g=r.vnode.dynamicProps;for(let y=0;y<g.length;y++){let A=g[y];if(ZT(r.emitsOptions,A))continue;const C=e[A];if(u)if(Ce.hasOwn(s,A))C!==s[A]&&(s[A]=C,f=!0);else{const M=Ce.camelize(A);i[M]=v3(u,o,M,C,r,!1)}else C!==s[A]&&(s[A]=C,f=!0)}}}else{Xj(r,e,i,s)&&(f=!0);let g;for(const y in o)(!e||!Ce.hasOwn(e,y)&&((g=Ce.hyphenate(y))===y||!Ce.hasOwn(e,g)))&&(u?t&&(t[y]!==void 0||t[g]!==void 0)&&(i[y]=v3(u,o,y,void 0,r,!0)):delete i[y]);if(s!==o)for(const y in s)(!e||!Ce.hasOwn(e,y))&&(delete s[y],f=!0)}f&&rr.trigger(r.attrs,"set","")}function Xj(r,e,t,n){const[i,s]=r.propsOptions;let a=!1,o;if(e)for(let u in e){if(Ce.isReservedProp(u))continue;const f=e[u];let g;i&&Ce.hasOwn(i,g=Ce.camelize(u))?!s||!s.includes(g)?t[g]=f:(o||(o={}))[g]=f:ZT(r.emitsOptions,u)||(!(u in n)||f!==n[u])&&(n[u]=f,a=!0)}if(s){const u=rr.toRaw(t),f=o||Ce.EMPTY_OBJ;for(let g=0;g<s.length;g++){const y=s[g];t[y]=v3(i,u,y,f[y],r,!Ce.hasOwn(f,y))}}return a}function v3(r,e,t,n,i,s){const a=r[t];if(a!=null){const o=Ce.hasOwn(a,"default");if(o&&n===void 0){const u=a.default;if(a.type!==Function&&!a.skipFactory&&Ce.isFunction(u)){const{propsDefaults:f}=i;if(t in f)n=f[t];else{const g=op(i);n=f[t]=u.call(null,e),g()}}else n=u;i.ce&&i.ce._setProp(t,n)}a[0]&&(s&&!o?n=!1:a[1]&&(n===""||n===Ce.hyphenate(t))&&(n=!0))}return n}const Ase=new WeakMap;function Jj(r,e,t=!1){const n=t?Ase:e.propsCache,i=n.get(r);if(i)return i;const s=r.props,a={},o=[];let u=!1;if(!Ce.isFunction(r)){const g=y=>{u=!0;const[A,C]=Jj(y,e,!0);Ce.extend(a,A),C&&o.push(...C)};!t&&e.mixins.length&&e.mixins.forEach(g),r.extends&&g(r.extends),r.mixins&&r.mixins.forEach(g)}if(!s&&!u)return Ce.isObject(r)&&n.set(r,Ce.EMPTY_ARR),Ce.EMPTY_ARR;if(Ce.isArray(s))for(let g=0;g<s.length;g++){const y=Ce.camelize(s[g]);YF(y)&&(a[y]=Ce.EMPTY_OBJ)}else if(s)for(const g in s){const y=Ce.camelize(g);if(YF(y)){const A=s[g],C=a[y]=Ce.isArray(A)||Ce.isFunction(A)?{type:A}:Ce.extend({},A),M=C.type;let k=!1,D=!0;if(Ce.isArray(M))for(let V=0;V<M.length;++V){const W=M[V],z=Ce.isFunction(W)&&W.name;if(z==="Boolean"){k=!0;break}else z==="String"&&(D=!1)}else k=Ce.isFunction(M)&&M.name==="Boolean";C[0]=k,C[1]=D,(k||Ce.hasOwn(C,"default"))&&o.push(y)}}const f=[a,o];return Ce.isObject(r)&&n.set(r,f),f}function YF(r){return r[0]!=="$"&&!Ce.isReservedProp(r)}const kR=r=>r==="_"||r==="_ctx"||r==="$stable",OR=r=>Ce.isArray(r)?r.map(la):[la(r)],xse=(r,e,t)=>{if(e._n)return e;const n=CR((...i)=>OR(e(...i)),t);return n._c=!1,n},qj=(r,e,t)=>{const n=r._ctx;for(const i in r){if(kR(i))continue;const s=r[i];if(Ce.isFunction(s))e[i]=xse(i,s,n);else if(s!=null){const a=OR(s);e[i]=()=>a}}},Yj=(r,e)=>{const t=OR(e);r.slots.default=()=>t},Zj=(r,e,t)=>{for(const n in e)(t||!kR(n))&&(r[n]=e[n])},wse=(r,e,t)=>{const n=r.slots=Wj();if(r.vnode.shapeFlag&32){const i=e._;i?(Zj(n,e,t),t&&Ce.def(n,"_",i,!0)):qj(e,n)}else e&&Yj(r,e)},Cse=(r,e,t)=>{const{vnode:n,slots:i}=r;let s=!0,a=Ce.EMPTY_OBJ;if(n.shapeFlag&32){const o=e._;o?t&&o===1?s=!1:Zj(i,e,t):(s=!e.$stable,qj(e,i)),a=e}else e&&(Yj(r,e),a={default:1});if(s)for(const o in i)!kR(o)&&a[o]==null&&delete i[o]},gs=i7;function Tse(r){return Qj(r)}function Sse(r){return Qj(r,wie)}function Qj(r,e){const t=Ce.getGlobalThis();t.__VUE__=!0;const{insert:n,remove:i,patchProp:s,createElement:a,createText:o,createComment:u,setText:f,setElementText:g,parentNode:y,nextSibling:A,setScopeId:C=Ce.NOOP,insertStaticContent:M}=r,k=(ve,Ee,He,wt=null,Qe=null,mt=null,$t=void 0,Dt=null,Nt=!!Ee.dynamicChildren)=>{if(ve===Ee)return;ve&&!jl(ve,Ee)&&(wt=Jn(ve),Jr(ve,Qe,mt,!0),ve=null),Ee.patchFlag===-2&&(Nt=!1,Ee.dynamicChildren=null);const{type:It,ref:mr,shapeFlag:Qt}=Ee;switch(It){case fd:D(ve,Ee,He,wt);break;case es:V(ve,Ee,He,wt);break;case Mm:ve==null&&W(Ee,He,wt,$t);break;case to:Me(ve,Ee,He,wt,Qe,mt,$t,Dt,Nt);break;default:Qt&1?te(ve,Ee,He,wt,Qe,mt,$t,Dt,Nt):Qt&6?ze(ve,Ee,He,wt,Qe,mt,$t,Dt,Nt):(Qt&64||Qt&128)&&It.process(ve,Ee,He,wt,Qe,mt,$t,Dt,Nt,kt)}mr!=null&&Qe?Pm(mr,ve&&ve.ref,mt,Ee||ve,!Ee):mr==null&&ve&&ve.ref!=null&&Pm(ve.ref,null,mt,ve,!0)},D=(ve,Ee,He,wt)=>{if(ve==null)n(Ee.el=o(Ee.children),He,wt);else{const Qe=Ee.el=ve.el;Ee.children!==ve.children&&f(Qe,Ee.children)}},V=(ve,Ee,He,wt)=>{ve==null?n(Ee.el=u(Ee.children||""),He,wt):Ee.el=ve.el},W=(ve,Ee,He,wt)=>{[ve.el,ve.anchor]=M(ve.children,Ee,He,wt,ve.el,ve.anchor)},z=({el:ve,anchor:Ee},He,wt)=>{let Qe;for(;ve&&ve!==Ee;)Qe=A(ve),n(ve,He,wt),ve=Qe;n(Ee,He,wt)},$=({el:ve,anchor:Ee})=>{let He;for(;ve&&ve!==Ee;)He=A(ve),i(ve),ve=He;i(Ee)},te=(ve,Ee,He,wt,Qe,mt,$t,Dt,Nt)=>{if(Ee.type==="svg"?$t="svg":Ee.type==="math"&&($t="mathml"),ve==null)le(Ee,He,wt,Qe,mt,$t,Dt,Nt);else{const It=ve.el&&ve.el._isVueCE?ve.el:null;try{It&&It._beginPatch(),Y(ve,Ee,Qe,mt,$t,Dt,Nt)}finally{It&&It._endPatch()}}},le=(ve,Ee,He,wt,Qe,mt,$t,Dt)=>{let Nt,It;const{props:mr,shapeFlag:Qt,transition:cr,dirs:Fe}=ve;if(Nt=ve.el=a(ve.type,mt,mr&&mr.is,mr),Qt&8?g(Nt,ve.children):Qt&16&&se(ve.children,Nt,null,wt,Qe,qE(ve,mt),$t,Dt),Fe&&Rc(ve,null,wt,"created"),_e(Nt,ve,ve.scopeId,$t,wt),mr){for(const ne in mr)ne!=="value"&&!Ce.isReservedProp(ne)&&s(Nt,ne,null,mr[ne],mt,wt);"value"in mr&&s(Nt,"value",null,mr.value,mt),(It=mr.onVnodeBeforeMount)&&ra(It,wt,ve)}Fe&&Rc(ve,null,wt,"beforeMount");const re=e7(Qe,cr);re&&cr.beforeEnter(Nt),n(Nt,Ee,He),((It=mr&&mr.onVnodeMounted)||re||Fe)&&gs(()=>{It&&ra(It,wt,ve),re&&cr.enter(Nt),Fe&&Rc(ve,null,wt,"mounted")},Qe)},_e=(ve,Ee,He,wt,Qe)=>{if(He&&C(ve,He),wt)for(let mt=0;mt<wt.length;mt++)C(ve,wt[mt]);if(Qe){let mt=Qe.subTree;if(Ee===mt||oC(mt.type)&&(mt.ssContent===Ee||mt.ssFallback===Ee)){const $t=Qe.vnode;_e(ve,$t,$t.scopeId,$t.slotScopeIds,Qe.parent)}}},se=(ve,Ee,He,wt,Qe,mt,$t,Dt,Nt=0)=>{for(let It=Nt;It<ve.length;It++){const mr=ve[It]=Dt?Yh(ve[It]):la(ve[It]);k(null,mr,Ee,He,wt,Qe,mt,$t,Dt)}},Y=(ve,Ee,He,wt,Qe,mt,$t)=>{const Dt=Ee.el=ve.el;let{patchFlag:Nt,dynamicChildren:It,dirs:mr}=Ee;Nt|=ve.patchFlag&16;const Qt=ve.props||Ce.EMPTY_OBJ,cr=Ee.props||Ce.EMPTY_OBJ;let Fe;if(He&&vf(He,!1),(Fe=cr.onVnodeBeforeUpdate)&&ra(Fe,He,Ee,ve),mr&&Rc(Ee,ve,He,"beforeUpdate"),He&&vf(He,!0),(Qt.innerHTML&&cr.innerHTML==null||Qt.textContent&&cr.textContent==null)&&g(Dt,""),It?ce(ve.dynamicChildren,It,Dt,He,wt,qE(Ee,Qe),mt):$t||Tt(ve,Ee,Dt,null,He,wt,qE(Ee,Qe),mt,!1),Nt>0){if(Nt&16)oe(Dt,Qt,cr,He,Qe);else if(Nt&2&&Qt.class!==cr.class&&s(Dt,"class",null,cr.class,Qe),Nt&4&&s(Dt,"style",Qt.style,cr.style,Qe),Nt&8){const re=Ee.dynamicProps;for(let ne=0;ne<re.length;ne++){const he=re[ne],Be=Qt[he],ke=cr[he];(ke!==Be||he==="value")&&s(Dt,he,Be,ke,Qe,He)}}Nt&1&&ve.children!==Ee.children&&g(Dt,Ee.children)}else!$t&&It==null&&oe(Dt,Qt,cr,He,Qe);((Fe=cr.onVnodeUpdated)||mr)&&gs(()=>{Fe&&ra(Fe,He,Ee,ve),mr&&Rc(Ee,ve,He,"updated")},wt)},ce=(ve,Ee,He,wt,Qe,mt,$t)=>{for(let Dt=0;Dt<Ee.length;Dt++){const Nt=ve[Dt],It=Ee[Dt],mr=Nt.el&&(Nt.type===to||!jl(Nt,It)||Nt.shapeFlag&198)?y(Nt.el):He;k(Nt,It,mr,null,wt,Qe,mt,$t,!0)}},oe=(ve,Ee,He,wt,Qe)=>{if(Ee!==He){if(Ee!==Ce.EMPTY_OBJ)for(const mt in Ee)!Ce.isReservedProp(mt)&&!(mt in He)&&s(ve,mt,Ee[mt],null,Qe,wt);for(const mt in He){if(Ce.isReservedProp(mt))continue;const $t=He[mt],Dt=Ee[mt];$t!==Dt&&mt!=="value"&&s(ve,mt,Dt,$t,Qe,wt)}"value"in He&&s(ve,"value",Ee.value,He.value,Qe)}},Me=(ve,Ee,He,wt,Qe,mt,$t,Dt,Nt)=>{const It=Ee.el=ve?ve.el:o(""),mr=Ee.anchor=ve?ve.anchor:o("");let{patchFlag:Qt,dynamicChildren:cr,slotScopeIds:Fe}=Ee;Fe&&(Dt=Dt?Dt.concat(Fe):Fe),ve==null?(n(It,He,wt),n(mr,He,wt),se(Ee.children||[],He,mr,Qe,mt,$t,Dt,Nt)):Qt>0&&Qt&64&&cr&&ve.dynamicChildren&&ve.dynamicChildren.length===cr.length?(ce(ve.dynamicChildren,cr,He,Qe,mt,$t,Dt),(Ee.key!=null||Qe&&Ee===Qe.subTree)&&DR(ve,Ee,!0)):Tt(ve,Ee,He,mr,Qe,mt,$t,Dt,Nt)},ze=(ve,Ee,He,wt,Qe,mt,$t,Dt,Nt)=>{Ee.slotScopeIds=Dt,ve==null?Ee.shapeFlag&512?Qe.ctx.activate(Ee,He,wt,$t,Nt):Ve(Ee,He,wt,Qe,mt,$t,Nt):lt(ve,Ee,Nt)},Ve=(ve,Ee,He,wt,Qe,mt,$t)=>{const Dt=ve.component=u7(ve,wt,Qe);if($v(ve)&&(Dt.ctx.renderer=kt),d7(Dt,!1,$t),Dt.asyncDep){if(Qe&&Qe.registerDep(Dt,gt,$t),!ve.el){const Nt=Dt.subTree=Gi(es);V(null,Nt,Ee,He),ve.placeholder=Nt.el}}else gt(Dt,ve,Ee,He,Qe,mt,$t)},lt=(ve,Ee,He)=>{const wt=Ee.component=ve.component;if(bse(ve,Ee,He))if(wt.asyncDep&&!wt.asyncResolved){At(wt,Ee,He);return}else wt.next=Ee,wt.update();else Ee.el=ve.el,wt.vnode=Ee},gt=(ve,Ee,He,wt,Qe,mt,$t)=>{const Dt=()=>{if(ve.isMounted){let{next:Qt,bu:cr,u:Fe,parent:re,vnode:ne}=ve;{const Ge=t7(ve);if(Ge){Qt&&(Qt.el=ne.el,At(ve,Qt,$t)),Ge.asyncDep.then(()=>{ve.isUnmounted||Dt()});return}}let he=Qt,Be;vf(ve,!1),Qt?(Qt.el=ne.el,At(ve,Qt,$t)):Qt=ne,cr&&Ce.invokeArrayFns(cr),(Be=Qt.props&&Qt.props.onVnodeBeforeUpdate)&&ra(Be,re,Qt,ne),vf(ve,!0);const ke=iw(ve),Ke=ve.subTree;ve.subTree=ke,k(Ke,ke,y(Ke.el),Jn(Ke),ve,Qe,mt),Qt.el=ke.el,he===null&&QT(ve,ke.el),Fe&&gs(Fe,Qe),(Be=Qt.props&&Qt.props.onVnodeUpdated)&&gs(()=>ra(Be,re,Qt,ne),Qe)}else{let Qt;const{el:cr,props:Fe}=Ee,{bm:re,m:ne,parent:he,root:Be,type:ke}=ve,Ke=$u(Ee);if(vf(ve,!1),re&&Ce.invokeArrayFns(re),!Ke&&(Qt=Fe&&Fe.onVnodeBeforeMount)&&ra(Qt,he,Ee),vf(ve,!0),cr&&fr){const Ge=()=>{ve.subTree=iw(ve),fr(cr,ve.subTree,ve,Qe,null)};Ke&&ke.__asyncHydrate?ke.__asyncHydrate(cr,ve,Ge):Ge()}else{Be.ce&&Be.ce._def.shadowRoot!==!1&&Be.ce._injectChildStyle(ke);const Ge=ve.subTree=iw(ve);k(null,Ge,He,wt,ve,Qe,mt),Ee.el=Ge.el}if(ne&&gs(ne,Qe),!Ke&&(Qt=Fe&&Fe.onVnodeMounted)){const Ge=Ee;gs(()=>ra(Qt,he,Ge),Qe)}(Ee.shapeFlag&256||he&&$u(he.vnode)&&he.vnode.shapeFlag&256)&&ve.a&&gs(ve.a,Qe),ve.isMounted=!0,Ee=He=wt=null}};ve.scope.on();const Nt=ve.effect=new rr.ReactiveEffect(Dt);ve.scope.off();const It=ve.update=Nt.run.bind(Nt),mr=ve.job=Nt.runIfDirty.bind(Nt);mr.i=ve,mr.id=ve.uid,Nt.scheduler=()=>wR(mr),vf(ve,!0),It()},At=(ve,Ee,He)=>{Ee.component=ve;const wt=ve.vnode.props;ve.vnode=Ee,ve.next=null,vse(ve,Ee.props,wt,He),Cse(ve,Ee.children,He),rr.pauseTracking(),FF(ve),rr.resetTracking()},Tt=(ve,Ee,He,wt,Qe,mt,$t,Dt,Nt=!1)=>{const It=ve&&ve.children,mr=ve?ve.shapeFlag:0,Qt=Ee.children,{patchFlag:cr,shapeFlag:Fe}=Ee;if(cr>0){if(cr&128){xr(It,Qt,He,wt,Qe,mt,$t,Dt,Nt);return}else if(cr&256){Ut(It,Qt,He,wt,Qe,mt,$t,Dt,Nt);return}}Fe&8?(mr&16&&Bn(It,Qe,mt),Qt!==It&&g(He,Qt)):mr&16?Fe&16?xr(It,Qt,He,wt,Qe,mt,$t,Dt,Nt):Bn(It,Qe,mt,!0):(mr&8&&g(He,""),Fe&16&&se(Qt,He,wt,Qe,mt,$t,Dt,Nt))},Ut=(ve,Ee,He,wt,Qe,mt,$t,Dt,Nt)=>{ve=ve||Ce.EMPTY_ARR,Ee=Ee||Ce.EMPTY_ARR;const It=ve.length,mr=Ee.length,Qt=Math.min(It,mr);let cr;for(cr=0;cr<Qt;cr++){const Fe=Ee[cr]=Nt?Yh(Ee[cr]):la(Ee[cr]);k(ve[cr],Fe,He,null,Qe,mt,$t,Dt,Nt)}It>mr?Bn(ve,Qe,mt,!0,!1,Qt):se(Ee,He,wt,Qe,mt,$t,Dt,Nt,Qt)},xr=(ve,Ee,He,wt,Qe,mt,$t,Dt,Nt)=>{let It=0;const mr=Ee.length;let Qt=ve.length-1,cr=mr-1;for(;It<=Qt&&It<=cr;){const Fe=ve[It],re=Ee[It]=Nt?Yh(Ee[It]):la(Ee[It]);if(jl(Fe,re))k(Fe,re,He,null,Qe,mt,$t,Dt,Nt);else break;It++}for(;It<=Qt&&It<=cr;){const Fe=ve[Qt],re=Ee[cr]=Nt?Yh(Ee[cr]):la(Ee[cr]);if(jl(Fe,re))k(Fe,re,He,null,Qe,mt,$t,Dt,Nt);else break;Qt--,cr--}if(It>Qt){if(It<=cr){const Fe=cr+1,re=Fe<mr?Ee[Fe].el:wt;for(;It<=cr;)k(null,Ee[It]=Nt?Yh(Ee[It]):la(Ee[It]),He,re,Qe,mt,$t,Dt,Nt),It++}}else if(It>cr)for(;It<=Qt;)Jr(ve[It],Qe,mt,!0),It++;else{const Fe=It,re=It,ne=new Map;for(It=re;It<=cr;It++){const vt=Ee[It]=Nt?Yh(Ee[It]):la(Ee[It]);vt.key!=null&&ne.set(vt.key,It)}let he,Be=0;const ke=cr-re+1;let Ke=!1,Ge=0;const Ue=new Array(ke);for(It=0;It<ke;It++)Ue[It]=0;for(It=Fe;It<=Qt;It++){const vt=ve[It];if(Be>=ke){Jr(vt,Qe,mt,!0);continue}let pt;if(vt.key!=null)pt=ne.get(vt.key);else for(he=re;he<=cr;he++)if(Ue[he-re]===0&&jl(vt,Ee[he])){pt=he;break}pt===void 0?Jr(vt,Qe,mt,!0):(Ue[pt-re]=It+1,pt>=Ge?Ge=pt:Ke=!0,k(vt,Ee[pt],He,null,Qe,mt,$t,Dt,Nt),Be++)}const nt=Ke?Ese(Ue):Ce.EMPTY_ARR;for(he=nt.length-1,It=ke-1;It>=0;It--){const vt=re+It,pt=Ee[vt],Wt=Ee[vt+1],ar=vt+1<mr?Wt.el||r7(Wt):wt;Ue[It]===0?k(null,pt,He,ar,Qe,mt,$t,Dt,Nt):Ke&&(he<0||It!==nt[he]?Er(pt,He,ar,2):he--)}}},Er=(ve,Ee,He,wt,Qe=null)=>{const{el:mt,type:$t,transition:Dt,children:Nt,shapeFlag:It}=ve;if(It&6){Er(ve.component.subTree,Ee,He,wt);return}if(It&128){ve.suspense.move(Ee,He,wt);return}if(It&64){$t.move(ve,Ee,He,kt);return}if($t===to){n(mt,Ee,He);for(let Qt=0;Qt<Nt.length;Qt++)Er(Nt[Qt],Ee,He,wt);n(ve.anchor,Ee,He);return}if($t===Mm){z(ve,Ee,He);return}if(wt!==2&&It&1&&Dt)if(wt===0)Dt.beforeEnter(mt),n(mt,Ee,He),gs(()=>Dt.enter(mt),Qe);else{const{leave:Qt,delayLeave:cr,afterLeave:Fe}=Dt,re=()=>{ve.ctx.isUnmounted?i(mt):n(mt,Ee,He)},ne=()=>{mt._isLeaving&&mt[Ru](!0),Qt(mt,()=>{re(),Fe&&Fe()})};cr?cr(mt,re,ne):ne()}else n(mt,Ee,He)},Jr=(ve,Ee,He,wt=!1,Qe=!1)=>{const{type:mt,props:$t,ref:Dt,children:Nt,dynamicChildren:It,shapeFlag:mr,patchFlag:Qt,dirs:cr,cacheIndex:Fe}=ve;if(Qt===-2&&(Qe=!1),Dt!=null&&(rr.pauseTracking(),Pm(Dt,null,He,ve,!0),rr.resetTracking()),Fe!=null&&(Ee.renderCache[Fe]=void 0),mr&256){Ee.ctx.deactivate(ve);return}const re=mr&1&&cr,ne=!$u(ve);let he;if(ne&&(he=$t&&$t.onVnodeBeforeUnmount)&&ra(he,Ee,ve),mr&6)Pn(ve.component,He,wt);else{if(mr&128){ve.suspense.unmount(He,wt);return}re&&Rc(ve,null,Ee,"beforeUnmount"),mr&64?ve.type.remove(ve,Ee,He,kt,wt):It&&!It.hasOnce&&(mt!==to||Qt>0&&Qt&64)?Bn(It,Ee,He,!1,!0):(mt===to&&Qt&384||!Qe&&mr&16)&&Bn(Nt,Ee,He),wt&&Xn(ve)}(ne&&(he=$t&&$t.onVnodeUnmounted)||re)&&gs(()=>{he&&ra(he,Ee,ve),re&&Rc(ve,null,Ee,"unmounted")},He)},Xn=ve=>{const{type:Ee,el:He,anchor:wt,transition:Qe}=ve;if(Ee===to){mi(He,wt);return}if(Ee===Mm){$(ve);return}const mt=()=>{i(He),Qe&&!Qe.persisted&&Qe.afterLeave&&Qe.afterLeave()};if(ve.shapeFlag&1&&Qe&&!Qe.persisted){const{leave:$t,delayLeave:Dt}=Qe,Nt=()=>$t(He,mt);Dt?Dt(ve.el,mt,Nt):Nt()}else mt()},mi=(ve,Ee)=>{let He;for(;ve!==Ee;)He=A(ve),i(ve),ve=He;i(Ee)},Pn=(ve,Ee,He)=>{const{bum:wt,scope:Qe,job:mt,subTree:$t,um:Dt,m:Nt,a:It}=ve;sC(Nt),sC(It),wt&&Ce.invokeArrayFns(wt),Qe.stop(),mt&&(mt.flags|=8,Jr($t,ve,Ee,He)),Dt&&gs(Dt,Ee),gs(()=>{ve.isUnmounted=!0},Ee)},Bn=(ve,Ee,He,wt=!1,Qe=!1,mt=0)=>{for(let $t=mt;$t<ve.length;$t++)Jr(ve[$t],Ee,He,wt,Qe)},Jn=ve=>{if(ve.shapeFlag&6)return Jn(ve.component.subTree);if(ve.shapeFlag&128)return ve.suspense.next();const Ee=A(ve.anchor||ve.el),He=Ee&&Ee[vj];return He?A(He):Ee};let Mn=!1;const _t=(ve,Ee,He)=>{let wt;ve==null?Ee._vnode&&(Jr(Ee._vnode,null,null,!0),wt=Ee._vnode.component):k(Ee._vnode||null,ve,Ee,null,null,null,He),Ee._vnode=ve,Mn||(Mn=!0,FF(wt),tC(),Mn=!1)},kt={p:k,um:Jr,m:Er,r:Xn,mt:Ve,mc:se,pc:Tt,pbc:ce,n:Jn,o:r};let nr,fr;return e&&([nr,fr]=e(kt)),{render:_t,hydrate:nr,createApp:hse(_t,nr)}}function qE({type:r,props:e},t){return t==="svg"&&r==="foreignObject"||t==="mathml"&&r==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function vf({effect:r,job:e},t){t?(r.flags|=32,e.flags|=4):(r.flags&=-33,e.flags&=-5)}function e7(r,e){return(!r||r&&!r.pendingBranch)&&e&&!e.persisted}function DR(r,e,t=!1){const n=r.children,i=e.children;if(Ce.isArray(n)&&Ce.isArray(i))for(let s=0;s<n.length;s++){const a=n[s];let o=i[s];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=i[s]=Yh(i[s]),o.el=a.el),!t&&o.patchFlag!==-2&&DR(a,o)),o.type===fd&&(o.patchFlag!==-1?o.el=a.el:o.__elIndex=s+(r.type===to?1:0)),o.type===es&&!o.el&&(o.el=a.el)}}function Ese(r){const e=r.slice(),t=[0];let n,i,s,a,o;const u=r.length;for(n=0;n<u;n++){const f=r[n];if(f!==0){if(i=t[t.length-1],r[i]<f){e[n]=i,t.push(n);continue}for(s=0,a=t.length-1;s<a;)o=s+a>>1,r[t[o]]<f?s=o+1:a=o;f<r[t[s]]&&(s>0&&(e[n]=t[s-1]),t[s]=n)}}for(s=t.length,a=t[s-1];s-- >0;)t[s]=a,a=e[a];return t}function t7(r){const e=r.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:t7(e)}function sC(r){if(r)for(let e=0;e<r.length;e++)r[e].flags|=8}function r7(r){if(r.placeholder)return r.placeholder;const e=r.component;return e?r7(e.subTree):null}const oC=r=>r.__isSuspense;let A3=0;const Ise={name:"Suspense",__isSuspense:!0,process(r,e,t,n,i,s,a,o,u,f){if(r==null)Bse(e,t,n,i,s,a,o,u,f);else{if(s&&s.deps>0&&!r.suspense.isInFallback){e.suspense=r.suspense,e.suspense.vnode=e,e.el=r.el;return}Mse(r,e,t,n,i,a,o,u,f)}},hydrate:Rse,normalize:kse},Pse=Ise;function x_(r,e){const t=r.props&&r.props[e];Ce.isFunction(t)&&t()}function Bse(r,e,t,n,i,s,a,o,u){const{p:f,o:{createElement:g}}=u,y=g("div"),A=r.suspense=n7(r,i,n,e,y,t,s,a,o,u);f(null,A.pendingBranch=r.ssContent,y,null,n,A,s,a),A.deps>0?(x_(r,"onPending"),x_(r,"onFallback"),f(null,r.ssFallback,e,t,n,null,s,a),Bm(A,r.ssFallback)):A.resolve(!1,!0)}function Mse(r,e,t,n,i,s,a,o,{p:u,um:f,o:{createElement:g}}){const y=e.suspense=r.suspense;y.vnode=e,e.el=r.el;const A=e.ssContent,C=e.ssFallback,{activeBranch:M,pendingBranch:k,isInFallback:D,isHydrating:V}=y;if(k)y.pendingBranch=A,jl(k,A)?(u(k,A,y.hiddenContainer,null,i,y,s,a,o),y.deps<=0?y.resolve():D&&(V||(u(M,C,t,n,i,null,s,a,o),Bm(y,C)))):(y.pendingId=A3++,V?(y.isHydrating=!1,y.activeBranch=k):f(k,i,y),y.deps=0,y.effects.length=0,y.hiddenContainer=g("div"),D?(u(null,A,y.hiddenContainer,null,i,y,s,a,o),y.deps<=0?y.resolve():(u(M,C,t,n,i,null,s,a,o),Bm(y,C))):M&&jl(M,A)?(u(M,A,t,n,i,y,s,a,o),y.resolve(!0)):(u(null,A,y.hiddenContainer,null,i,y,s,a,o),y.deps<=0&&y.resolve()));else if(M&&jl(M,A))u(M,A,t,n,i,y,s,a,o),Bm(y,A);else if(x_(e,"onPending"),y.pendingBranch=A,A.shapeFlag&512?y.pendingId=A.component.suspenseId:y.pendingId=A3++,u(null,A,y.hiddenContainer,null,i,y,s,a,o),y.deps<=0)y.resolve();else{const{timeout:W,pendingId:z}=y;W>0?setTimeout(()=>{y.pendingId===z&&y.fallback(C)},W):W===0&&y.fallback(C)}}function n7(r,e,t,n,i,s,a,o,u,f,g=!1){const{p:y,m:A,um:C,n:M,o:{parentNode:k,remove:D}}=f;let V;const W=Ose(r);W&&e&&e.pendingBranch&&(V=e.pendingId,e.deps++);const z=r.props?Ce.toNumber(r.props.timeout):void 0,$=s,te={vnode:r,parent:e,parentComponent:t,namespace:a,container:n,hiddenContainer:i,deps:0,pendingId:A3++,timeout:typeof z=="number"?z:-1,activeBranch:null,pendingBranch:null,isInFallback:!g,isHydrating:g,isUnmounted:!1,effects:[],resolve(le=!1,_e=!1){const{vnode:se,activeBranch:Y,pendingBranch:ce,pendingId:oe,effects:Me,parentComponent:ze,container:Ve,isInFallback:lt}=te;let gt=!1;te.isHydrating?te.isHydrating=!1:le||(gt=Y&&ce.transition&&ce.transition.mode==="out-in",gt&&(Y.transition.afterLeave=()=>{oe===te.pendingId&&(A(ce,Ve,s===$?M(Y):s,0),eC(Me),lt&&se.ssFallback&&(se.ssFallback.el=null))}),Y&&(k(Y.el)===Ve&&(s=M(Y)),C(Y,ze,te,!0),!gt&&lt&&se.ssFallback&&gs(()=>se.ssFallback.el=null,te)),gt||A(ce,Ve,s,0)),Bm(te,ce),te.pendingBranch=null,te.isInFallback=!1;let At=te.parent,Tt=!1;for(;At;){if(At.pendingBranch){At.effects.push(...Me),Tt=!0;break}At=At.parent}!Tt&&!gt&&eC(Me),te.effects=[],W&&e&&e.pendingBranch&&V===e.pendingId&&(e.deps--,e.deps===0&&!_e&&e.resolve()),x_(se,"onResolve")},fallback(le){if(!te.pendingBranch)return;const{vnode:_e,activeBranch:se,parentComponent:Y,container:ce,namespace:oe}=te;x_(_e,"onFallback");const Me=M(se),ze=()=>{te.isInFallback&&(y(null,le,ce,Me,Y,null,oe,o,u),Bm(te,le))},Ve=le.transition&&le.transition.mode==="out-in";Ve&&(se.transition.afterLeave=ze),te.isInFallback=!0,C(se,Y,null,!0),Ve||ze()},move(le,_e,se){te.activeBranch&&A(te.activeBranch,le,_e,se),te.container=le},next(){return te.activeBranch&&M(te.activeBranch)},registerDep(le,_e,se){const Y=!!te.pendingBranch;Y&&te.deps++;const ce=le.vnode.el;le.asyncDep.catch(oe=>{bp(oe,le,0)}).then(oe=>{if(le.isUnmounted||te.isUnmounted||te.pendingId!==le.suspenseId)return;le.asyncResolved=!0;const{vnode:Me}=le;C3(le,oe,!1),ce&&(Me.el=ce);const ze=!ce&&le.subTree.el;_e(le,Me,k(ce||le.subTree.el),ce?null:M(le.subTree),te,a,se),ze&&(Me.placeholder=null,D(ze)),QT(le,Me.el),Y&&--te.deps===0&&te.resolve()})},unmount(le,_e){te.isUnmounted=!0,te.activeBranch&&C(te.activeBranch,t,le,_e),te.pendingBranch&&C(te.pendingBranch,t,le,_e)}};return te}function Rse(r,e,t,n,i,s,a,o,u){const f=e.suspense=n7(e,n,t,r.parentNode,document.createElement("div"),null,i,s,a,o,!0),g=u(r,f.pendingBranch=e.ssContent,t,f,s,a);return f.deps===0&&f.resolve(!1,!0),g}function kse(r){const{shapeFlag:e,children:t}=r,n=e&32;r.ssContent=ZF(n?t.default:t),r.ssFallback=n?ZF(t.fallback):Gi(es)}function ZF(r){let e;if(Ce.isFunction(r)){const t=sp&&r._c;t&&(r._d=!1,w_()),r=r(),t&&(r._d=!0,e=Ao,s7())}return Ce.isArray(r)&&(r=gse(r)),r=la(r),e&&!r.dynamicChildren&&(r.dynamicChildren=e.filter(t=>t!==r)),r}function i7(r,e){e&&e.pendingBranch?Ce.isArray(r)?e.effects.push(...r):e.effects.push(r):eC(r)}function Bm(r,e){r.activeBranch=e;const{vnode:t,parentComponent:n}=r;let i=e.el;for(;!i&&e.component;)e=e.component.subTree,i=e.el;t.el=i,n&&n.subTree===t&&(n.vnode.el=i,QT(n,i))}function Ose(r){const e=r.props&&r.props.suspensible;return e!=null&&e!==!1}const to=Symbol.for("v-fgt"),fd=Symbol.for("v-txt"),es=Symbol.for("v-cmt"),Mm=Symbol.for("v-stc"),W0=[];let Ao=null;function w_(r=!1){W0.push(Ao=r?null:[])}function s7(){W0.pop(),Ao=W0[W0.length-1]||null}let sp=1;function C_(r,e=!1){sp+=r,r<0&&Ao&&e&&(Ao.hasOnce=!0)}function o7(r){return r.dynamicChildren=sp>0?Ao||Ce.EMPTY_ARR:null,s7(),sp>0&&Ao&&Ao.push(r),r}function Dse(r,e,t,n,i,s){return o7(LR(r,e,t,n,i,s,!0))}function aC(r,e,t,n,i){return o7(Gi(r,e,t,n,i,!0))}function Ku(r){return r?r.__v_isVNode===!0:!1}function jl(r,e){return r.type===e.type&&r.key===e.key}function Lse(r){}const a7=({key:r})=>r??null,sw=({ref:r,ref_key:e,ref_for:t})=>(typeof r=="number"&&(r=""+r),r!=null?Ce.isString(r)||rr.isRef(r)||Ce.isFunction(r)?{i:io,r,k:e,f:!!t}:r:null);function LR(r,e=null,t=null,n=0,i=null,s=r===to?0:1,a=!1,o=!1){const u={__v_isVNode:!0,__v_skip:!0,type:r,props:e,key:e&&a7(e),ref:e&&sw(e),scopeId:XT,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:io};return o?(FR(u,t),s&128&&r.normalize(u)):t&&(u.shapeFlag|=Ce.isString(t)?8:16),sp>0&&!a&&Ao&&(u.patchFlag>0||s&6)&&u.patchFlag!==32&&Ao.push(u),u}const Gi=Nse;function Nse(r,e=null,t=null,n=0,i=null,s=!1){if((!r||r===Uj)&&(r=es),Ku(r)){const o=Kc(r,e,!0);return t&&FR(o,t),sp>0&&!s&&Ao&&(o.shapeFlag&6?Ao[Ao.indexOf(r)]=o:Ao.push(o)),o.patchFlag=-2,o}if(Wse(r)&&(r=r.__vccOpts),e){e=l7(e);let{class:o,style:u}=e;o&&!Ce.isString(o)&&(e.class=Ce.normalizeClass(o)),Ce.isObject(u)&&(rr.isProxy(u)&&!Ce.isArray(u)&&(u=Ce.extend({},u)),e.style=Ce.normalizeStyle(u))}const a=Ce.isString(r)?1:oC(r)?128:Aj(r)?64:Ce.isObject(r)?4:Ce.isFunction(r)?2:0;return LR(r,e,t,n,i,a,s,!0)}function l7(r){return r?rr.isProxy(r)||Kj(r)?Ce.extend({},r):r:null}function Kc(r,e,t=!1,n=!1){const{props:i,ref:s,patchFlag:a,children:o,transition:u}=r,f=e?c7(i||{},e):i,g={__v_isVNode:!0,__v_skip:!0,type:r.type,props:f,key:f&&a7(f),ref:e&&e.ref?t&&s?Ce.isArray(s)?s.concat(sw(e)):[s,sw(e)]:sw(e):s,scopeId:r.scopeId,slotScopeIds:r.slotScopeIds,children:o,target:r.target,targetStart:r.targetStart,targetAnchor:r.targetAnchor,staticCount:r.staticCount,shapeFlag:r.shapeFlag,patchFlag:e&&r.type!==to?a===-1?16:a|16:a,dynamicProps:r.dynamicProps,dynamicChildren:r.dynamicChildren,appContext:r.appContext,dirs:r.dirs,transition:u,component:r.component,suspense:r.suspense,ssContent:r.ssContent&&Kc(r.ssContent),ssFallback:r.ssFallback&&Kc(r.ssFallback),placeholder:r.placeholder,el:r.el,anchor:r.anchor,ctx:r.ctx,ce:r.ce};return u&&n&&ip(g,u.clone(g)),g}function NR(r=" ",e=0){return Gi(fd,null,r,e)}function Fse(r,e){const t=Gi(Mm,null,r);return t.staticCount=e,t}function Use(r="",e=!1){return e?(w_(),aC(es,null,r)):Gi(es,null,r)}function la(r){return r==null||typeof r=="boolean"?Gi(es):Ce.isArray(r)?Gi(to,null,r.slice()):Ku(r)?Yh(r):Gi(fd,null,String(r))}function Yh(r){return r.el===null&&r.patchFlag!==-1||r.memo?r:Kc(r)}function FR(r,e){let t=0;const{shapeFlag:n}=r;if(e==null)e=null;else if(Ce.isArray(e))t=16;else if(typeof e=="object")if(n&65){const i=e.default;i&&(i._c&&(i._d=!1),FR(r,i()),i._c&&(i._d=!0));return}else{t=32;const i=e._;!i&&!Kj(e)?e._ctx=io:i===3&&io&&(io.slots._===1?e._=1:(e._=2,r.patchFlag|=1024))}else Ce.isFunction(e)?(e={default:e,_ctx:io},t=32):(e=String(e),n&64?(t=16,e=[NR(e)]):t=8);r.children=e,r.shapeFlag|=t}function c7(...r){const e={};for(let t=0;t<r.length;t++){const n=r[t];for(const i in n)if(i==="class")e.class!==n.class&&(e.class=Ce.normalizeClass([e.class,n.class]));else if(i==="style")e.style=Ce.normalizeStyle([e.style,n.style]);else if(Ce.isOn(i)){const s=e[i],a=n[i];a&&s!==a&&!(Ce.isArray(s)&&s.includes(a))&&(e[i]=s?[].concat(s,a):a)}else i!==""&&(e[i]=n[i])}return e}function ra(r,e,t,n=null){tc(r,e,7,[t,n])}const zse=$j();let Vse=0;function u7(r,e,t){const n=r.type,i=(e?e.appContext:r.appContext)||zse,s={uid:Vse++,vnode:r,type:n,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new rr.EffectScope(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Jj(n,i),emitsOptions:Gj(n,i),emit:null,emitted:null,propsDefaults:Ce.EMPTY_OBJ,inheritAttrs:n.inheritAttrs,ctx:Ce.EMPTY_OBJ,data:Ce.EMPTY_OBJ,props:Ce.EMPTY_OBJ,attrs:Ce.EMPTY_OBJ,slots:Ce.EMPTY_OBJ,refs:Ce.EMPTY_OBJ,setupState:Ce.EMPTY_OBJ,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=fse.bind(null,s),r.ce&&r.ce(s),s}let no=null;const qc=()=>no||io;let lC,x3;{const r=Ce.getGlobalThis(),e=(t,n)=>{let i;return(i=r[t])||(i=r[t]=[]),i.push(n),s=>{i.length>1?i.forEach(a=>a(s)):i[0](s)}};lC=e("__VUE_INSTANCE_SETTERS__",t=>no=t),x3=e("__VUE_SSR_SETTERS__",t=>Km=t)}const op=r=>{const e=no;return lC(r),r.scope.on(),()=>{r.scope.off(),lC(e)}},w3=()=>{no&&no.scope.off(),lC(null)};function h7(r){return r.vnode.shapeFlag&4}let Km=!1;function d7(r,e=!1,t=!1){e&&x3(e);const{props:n,children:i}=r.vnode,s=h7(r);_se(r,n,s,e),wse(r,i,t||e);const a=s?$se(r,e):void 0;return e&&x3(!1),a}function $se(r,e){const t=r.type;r.accessCache=Object.create(null),r.proxy=new Proxy(r.ctx,y3);const{setup:n}=t;if(n){rr.pauseTracking();const i=r.setupContext=n.length>1?p7(r):null,s=op(r),a=_y(n,r,0,[r.props,i]),o=Ce.isPromise(a);if(rr.resetTracking(),s(),(o||r.sp)&&!$u(r)&&SR(r),o){if(a.then(w3,w3),e)return a.then(u=>{C3(r,u,e)}).catch(u=>{bp(u,r,0)});r.asyncDep=a}else C3(r,a,e)}else f7(r,e)}function C3(r,e,t){Ce.isFunction(e)?r.type.__ssrInlineRender?r.ssrRender=e:r.render=e:Ce.isObject(e)&&(r.setupState=rr.proxyRefs(e)),f7(r,t)}let cC,T3;function jse(r){cC=r,T3=e=>{e.render._rc&&(e.withProxy=new Proxy(e.ctx,Hie))}}const Gse=()=>!cC;function f7(r,e,t){const n=r.type;if(!r.render){if(!e&&cC&&!n.render){const i=n.template||RR(r).template;if(i){const{isCustomElement:s,compilerOptions:a}=r.appContext.config,{delimiters:o,compilerOptions:u}=n,f=Ce.extend(Ce.extend({isCustomElement:s,delimiters:o},a),u);n.render=cC(i,f)}}r.render=n.render||Ce.NOOP,T3&&T3(r)}{const i=op(r);rr.pauseTracking();try{sse(r)}finally{rr.resetTracking(),i()}}}const Hse={get(r,e){return rr.track(r,"get",""),r[e]}};function p7(r){const e=t=>{r.exposed=t||{}};return{attrs:new Proxy(r.attrs,Hse),slots:r.slots,emit:r.emit,expose:e}}function jv(r){return r.exposed?r.exposeProxy||(r.exposeProxy=new Proxy(rr.proxyRefs(rr.markRaw(r.exposed)),{get(e,t){if(t in e)return e[t];if(t in H0)return H0[t](r)},has(e,t){return t in e||t in H0}})):r.proxy}function S3(r,e=!0){return Ce.isFunction(r)?r.displayName||r.name:r.name||e&&r.__name}function Wse(r){return Ce.isFunction(r)&&"__vccOpts"in r}const g7=(r,e)=>rr.computed(r,e,Km);function Kse(r,e,t){try{C_(-1);const n=arguments.length;return n===2?Ce.isObject(e)&&!Ce.isArray(e)?Ku(e)?Gi(r,null,[e]):Gi(r,e):Gi(r,null,e):(n>3?t=Array.prototype.slice.call(arguments,2):n===3&&Ku(t)&&(t=[t]),Gi(r,e,t))}finally{C_(1)}}function Xse(){}function Jse(r,e,t,n){const i=t[n];if(i&&m7(i,r))return i;const s=e();return s.memo=r.slice(),s.cacheIndex=n,t[n]=s}function m7(r,e){const t=r.memo;if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(Ce.hasChanged(t[n],e[n]))return!1;return sp>0&&Ao&&Ao.push(r),!0}const y7="3.5.26",qse=Ce.NOOP,Yse=iie,Zse=void 0,Qse=Ce.NOOP,eoe={createComponentInstance:u7,setupComponent:d7,renderComponentRoot:iw,setCurrentRenderingInstance:v_,isVNode:Ku,normalizeVNode:la,getComponentPublicInstance:jv,ensureValidVNode:MR,pushWarningContext:eie,popWarningContext:tie},toe=eoe,roe=null,noe=null,ioe=null;dt.EffectScope=rr.EffectScope;dt.ReactiveEffect=rr.ReactiveEffect;dt.TrackOpTypes=rr.TrackOpTypes;dt.TriggerOpTypes=rr.TriggerOpTypes;dt.customRef=rr.customRef;dt.effect=rr.effect;dt.effectScope=rr.effectScope;dt.getCurrentScope=rr.getCurrentScope;dt.getCurrentWatcher=rr.getCurrentWatcher;dt.isProxy=rr.isProxy;dt.isReactive=rr.isReactive;dt.isReadonly=rr.isReadonly;dt.isRef=rr.isRef;dt.isShallow=rr.isShallow;dt.markRaw=rr.markRaw;dt.onScopeDispose=rr.onScopeDispose;dt.onWatcherCleanup=rr.onWatcherCleanup;dt.proxyRefs=rr.proxyRefs;dt.reactive=rr.reactive;dt.readonly=rr.readonly;dt.ref=rr.ref;dt.shallowReactive=rr.shallowReactive;var wit=dt.shallowReadonly=rr.shallowReadonly;dt.shallowRef=rr.shallowRef;dt.stop=rr.stop;dt.toRaw=rr.toRaw;dt.toRef=rr.toRef;dt.toRefs=rr.toRefs;dt.toValue=rr.toValue;dt.triggerRef=rr.triggerRef;dt.unref=rr.unref;dt.camelize=Ce.camelize;dt.capitalize=Ce.capitalize;dt.normalizeClass=Ce.normalizeClass;dt.normalizeProps=Ce.normalizeProps;dt.normalizeStyle=Ce.normalizeStyle;dt.toDisplayString=Ce.toDisplayString;dt.toHandlerKey=Ce.toHandlerKey;dt.BaseTransition=bie;dt.BaseTransitionPropsValidators=Tj;dt.Comment=es;dt.DeprecationTypes=ioe;dt.ErrorCodes=nie;dt.ErrorTypeStrings=Yse;dt.Fragment=to;dt.KeepAlive=Die;dt.Static=Mm;dt.Suspense=Pse;dt.Teleport=mie;dt.Text=fd;dt.assertNumber=rie;dt.callWithAsyncErrorHandling=tc;dt.callWithErrorHandling=_y;dt.cloneVNode=Kc;dt.compatUtils=noe;dt.computed=g7;dt.createBlock=aC;dt.createCommentVNode=Use;dt.createElementBlock=Dse;dt.createElementVNode=LR;dt.createHydrationRenderer=Sse;dt.createPropsRestProxy=nse;dt.createRenderer=Tse;dt.createSlots=$ie;dt.createStaticVNode=Fse;dt.createTextVNode=NR;dt.createVNode=Gi;dt.defineAsyncComponent=kie;dt.defineComponent=Pj;dt.defineEmits=Kie;dt.defineExpose=Xie;dt.defineModel=Yie;dt.defineOptions=Jie;dt.defineProps=Wie;dt.defineSlots=qie;dt.devtools=Zse;dt.getCurrentInstance=qc;dt.getTransitionRawChildren=TR;dt.guardReactiveProps=l7;dt.h=Kse;dt.handleError=bp;dt.hasInjectionContext=hie;dt.hydrateOnIdle=Eie;dt.hydrateOnInteraction=Mie;dt.hydrateOnMediaQuery=Bie;dt.hydrateOnVisible=Pie;dt.initCustomFormatter=Xse;dt.inject=$0;dt.isMemoSame=m7;dt.isRuntimeOnly=Gse;dt.isVNode=Ku;dt.mergeDefaults=tse;dt.mergeModels=rse;dt.mergeProps=c7;dt.nextTick=dj;dt.onActivated=Bj;dt.onBeforeMount=kj;dt.onBeforeUnmount=YT;dt.onBeforeUpdate=Oj;dt.onDeactivated=Mj;dt.onErrorCaptured=Fj;dt.onMounted=qT;dt.onRenderTracked=Nj;dt.onRenderTriggered=Lj;dt.onServerPrefetch=Dj;dt.onUnmounted=IR;dt.onUpdated=ER;dt.openBlock=w_;dt.popScopeId=lie;dt.provide=gj;dt.pushScopeId=aie;dt.queuePostFlushCb=eC;dt.registerRuntimeCompiler=jse;dt.renderList=Vie;dt.renderSlot=jie;dt.resolveComponent=Fie;dt.resolveDirective=zie;dt.resolveDynamicComponent=Uie;dt.resolveFilter=roe;dt.resolveTransitionHooks=rC;dt.setBlockTracking=C_;dt.setDevtoolsHook=Qse;dt.setTransitionHooks=ip;dt.ssrContextKey=mj;dt.ssrUtils=toe;dt.toHandlers=Gie;dt.transformVNodeArgs=Lse;dt.useAttrs=ese;dt.useId=_ie;dt.useModel=dse;dt.useSSRContext=yj;dt.useSlots=Qie;dt.useTemplateRef=vie;dt.useTransitionState=Cj;dt.version=y7;var Cit=dt.warn=qse;dt.watch=j0;dt.watchEffect=die;dt.watchPostEffect=fie;dt.watchSyncEffect=bj;dt.withAsyncContext=ise;dt.withCtx=CR;dt.withDefaults=Zie;dt.withDirectives=uie;dt.withMemo=Jse;dt.withScopeId=cie;/**
* @vue/runtime-dom v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=dt,t=Zt;let n;const i=typeof window<"u"&&window.trustedTypes;if(i)try{n=i.createPolicy("vue",{createHTML:ie=>ie})}catch{}const s=n?ie=>n.createHTML(ie):ie=>ie,a="http://www.w3.org/2000/svg",o="http://www.w3.org/1998/Math/MathML",u=typeof document<"u"?document:null,f=u&&u.createElement("template"),g={insert:(ie,de,Ie)=>{de.insertBefore(ie,Ie||null)},remove:ie=>{const de=ie.parentNode;de&&de.removeChild(ie)},createElement:(ie,de,Ie,je)=>{const yt=de==="svg"?u.createElementNS(a,ie):de==="mathml"?u.createElementNS(o,ie):Ie?u.createElement(ie,{is:Ie}):u.createElement(ie);return ie==="select"&&je&&je.multiple!=null&&yt.setAttribute("multiple",je.multiple),yt},createText:ie=>u.createTextNode(ie),createComment:ie=>u.createComment(ie),setText:(ie,de)=>{ie.nodeValue=de},setElementText:(ie,de)=>{ie.textContent=de},parentNode:ie=>ie.parentNode,nextSibling:ie=>ie.nextSibling,querySelector:ie=>u.querySelector(ie),setScopeId(ie,de){ie.setAttribute(de,"")},insertStaticContent(ie,de,Ie,je,yt,Pt){const Ft=Ie?Ie.previousSibling:de.lastChild;if(yt&&(yt===Pt||yt.nextSibling))for(;de.insertBefore(yt.cloneNode(!0),Ie),!(yt===Pt||!(yt=yt.nextSibling)););else{f.innerHTML=s(je==="svg"?`<svg>${ie}</svg>`:je==="mathml"?`<math>${ie}</math>`:ie);const yr=f.content;if(je==="svg"||je==="mathml"){const Mr=yr.firstChild;for(;Mr.firstChild;)yr.appendChild(Mr.firstChild);yr.removeChild(Mr)}de.insertBefore(yr,Ie)}return[Ft?Ft.nextSibling:de.firstChild,Ie?Ie.previousSibling:de.lastChild]}},y="transition",A="animation",C=Symbol("_vtc"),M={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},k=t.extend({},e.BaseTransitionPropsValidators,M),V=(ie=>(ie.displayName="Transition",ie.props=k,ie))((ie,{slots:de})=>e.h(e.BaseTransition,$(ie),de)),W=(ie,de=[])=>{t.isArray(ie)?ie.forEach(Ie=>Ie(...de)):ie&&ie(...de)},z=ie=>ie?t.isArray(ie)?ie.some(de=>de.length>1):ie.length>1:!1;function $(ie){const de={};for(const pr in ie)pr in M||(de[pr]=ie[pr]);if(ie.css===!1)return de;const{name:Ie="v",type:je,duration:yt,enterFromClass:Pt=`${Ie}-enter-from`,enterActiveClass:Ft=`${Ie}-enter-active`,enterToClass:yr=`${Ie}-enter-to`,appearFromClass:Mr=Pt,appearActiveClass:Fr=Ft,appearToClass:sn=yr,leaveFromClass:xi=`${Ie}-leave-from`,leaveActiveClass:Fi=`${Ie}-leave-active`,leaveToClass:Ya=`${Ie}-leave-to`}=ie,hc=te(yt),ru=hc&&hc[0],sh=hc&&hc[1],{onBeforeEnter:Bd,onEnter:Tl,onEnterCancelled:oh,onLeave:dc,onLeaveCancelled:Za,onBeforeAppear:fc=Bd,onAppear:Ur=Tl,onAppearCancelled:Md=oh}=de,Rd=(pr,Zr,_r,dn)=>{pr._enterCancelled=dn,se(pr,Zr?sn:yr),se(pr,Zr?Fr:Ft),_r&&_r()},ah=(pr,Zr)=>{pr._isLeaving=!1,se(pr,xi),se(pr,Ya),se(pr,Fi),Zr&&Zr()},Cs=pr=>(Zr,_r)=>{const dn=pr?Ur:Tl,ya=()=>Rd(Zr,pr,_r);W(dn,[Zr,ya]),Y(()=>{se(Zr,pr?Mr:Pt),_e(Zr,pr?sn:yr),z(dn)||oe(Zr,je,ru,ya)})};return t.extend(de,{onBeforeEnter(pr){W(Bd,[pr]),_e(pr,Pt),_e(pr,Ft)},onBeforeAppear(pr){W(fc,[pr]),_e(pr,Mr),_e(pr,Fr)},onEnter:Cs(!1),onAppear:Cs(!0),onLeave(pr,Zr){pr._isLeaving=!0;const _r=()=>ah(pr,Zr);_e(pr,xi),pr._enterCancelled?(_e(pr,Fi),lt(pr)):(lt(pr),_e(pr,Fi)),Y(()=>{pr._isLeaving&&(se(pr,xi),_e(pr,Ya),z(dc)||oe(pr,je,sh,_r))}),W(dc,[pr,_r])},onEnterCancelled(pr){Rd(pr,!1,void 0,!0),W(oh,[pr])},onAppearCancelled(pr){Rd(pr,!0,void 0,!0),W(Md,[pr])},onLeaveCancelled(pr){ah(pr),W(Za,[pr])}})}function te(ie){if(ie==null)return null;if(t.isObject(ie))return[le(ie.enter),le(ie.leave)];{const de=le(ie);return[de,de]}}function le(ie){return t.toNumber(ie)}function _e(ie,de){de.split(/\s+/).forEach(Ie=>Ie&&ie.classList.add(Ie)),(ie[C]||(ie[C]=new Set)).add(de)}function se(ie,de){de.split(/\s+/).forEach(je=>je&&ie.classList.remove(je));const Ie=ie[C];Ie&&(Ie.delete(de),Ie.size||(ie[C]=void 0))}function Y(ie){requestAnimationFrame(()=>{requestAnimationFrame(ie)})}let ce=0;function oe(ie,de,Ie,je){const yt=ie._endId=++ce,Pt=()=>{yt===ie._endId&&je()};if(Ie!=null)return setTimeout(Pt,Ie);const{type:Ft,timeout:yr,propCount:Mr}=Me(ie,de);if(!Ft)return je();const Fr=Ft+"end";let sn=0;const xi=()=>{ie.removeEventListener(Fr,Fi),Pt()},Fi=Ya=>{Ya.target===ie&&++sn>=Mr&&xi()};setTimeout(()=>{sn<Mr&&xi()},yr+1),ie.addEventListener(Fr,Fi)}function Me(ie,de){const Ie=window.getComputedStyle(ie),je=hc=>(Ie[hc]||"").split(", "),yt=je(`${y}Delay`),Pt=je(`${y}Duration`),Ft=ze(yt,Pt),yr=je(`${A}Delay`),Mr=je(`${A}Duration`),Fr=ze(yr,Mr);let sn=null,xi=0,Fi=0;de===y?Ft>0&&(sn=y,xi=Ft,Fi=Pt.length):de===A?Fr>0&&(sn=A,xi=Fr,Fi=Mr.length):(xi=Math.max(Ft,Fr),sn=xi>0?Ft>Fr?y:A:null,Fi=sn?sn===y?Pt.length:Mr.length:0);const Ya=sn===y&&/\b(?:transform|all)(?:,|$)/.test(je(`${y}Property`).toString());return{type:sn,timeout:xi,propCount:Fi,hasTransform:Ya}}function ze(ie,de){for(;ie.length<de.length;)ie=ie.concat(ie);return Math.max(...de.map((Ie,je)=>Ve(Ie)+Ve(ie[je])))}function Ve(ie){return ie==="auto"?0:Number(ie.slice(0,-1).replace(",","."))*1e3}function lt(ie){return(ie?ie.ownerDocument:document).body.offsetHeight}function gt(ie,de,Ie){const je=ie[C];je&&(de=(de?[de,...je]:[...je]).join(" ")),de==null?ie.removeAttribute("class"):Ie?ie.setAttribute("class",de):ie.className=de}const At=Symbol("_vod"),Tt=Symbol("_vsh"),Ut={name:"show",beforeMount(ie,{value:de},{transition:Ie}){ie[At]=ie.style.display==="none"?"":ie.style.display,Ie&&de?Ie.beforeEnter(ie):xr(ie,de)},mounted(ie,{value:de},{transition:Ie}){Ie&&de&&Ie.enter(ie)},updated(ie,{value:de,oldValue:Ie},{transition:je}){!de!=!Ie&&(je?de?(je.beforeEnter(ie),xr(ie,!0),je.enter(ie)):je.leave(ie,()=>{xr(ie,!1)}):xr(ie,de))},beforeUnmount(ie,{value:de}){xr(ie,de)}};function xr(ie,de){ie.style.display=de?ie[At]:"none",ie[Tt]=!de}function Er(){Ut.getSSRProps=({value:ie})=>{if(!ie)return{style:{display:"none"}}}}const Jr=Symbol("");function Xn(ie){}const mi=/(?:^|;)\s*display\s*:/;function Pn(ie,de,Ie){const je=ie.style,yt=t.isString(Ie);let Pt=!1;if(Ie&&!yt){if(de)if(t.isString(de))for(const Ft of de.split(";")){const yr=Ft.slice(0,Ft.indexOf(":")).trim();Ie[yr]==null&&Jn(je,yr,"")}else for(const Ft in de)Ie[Ft]==null&&Jn(je,Ft,"");for(const Ft in Ie)Ft==="display"&&(Pt=!0),Jn(je,Ft,Ie[Ft])}else if(yt){if(de!==Ie){const Ft=je[Jr];Ft&&(Ie+=";"+Ft),je.cssText=Ie,Pt=mi.test(Ie)}}else de&&ie.removeAttribute("style");At in ie&&(ie[At]=Pt?je.display:"",ie[Tt]&&(je.display="none"))}const Bn=/\s*!important$/;function Jn(ie,de,Ie){if(t.isArray(Ie))Ie.forEach(je=>Jn(ie,de,je));else if(Ie==null&&(Ie=""),de.startsWith("--"))ie.setProperty(de,Ie);else{const je=kt(ie,de);Bn.test(Ie)?ie.setProperty(t.hyphenate(je),Ie.replace(Bn,""),"important"):ie[je]=Ie}}const Mn=["Webkit","Moz","ms"],_t={};function kt(ie,de){const Ie=_t[de];if(Ie)return Ie;let je=e.camelize(de);if(je!=="filter"&&je in ie)return _t[de]=je;je=t.capitalize(je);for(let yt=0;yt<Mn.length;yt++){const Pt=Mn[yt]+je;if(Pt in ie)return _t[de]=Pt}return de}const nr="http://www.w3.org/1999/xlink";function fr(ie,de,Ie,je,yt,Pt=t.isSpecialBooleanAttr(de)){je&&de.startsWith("xlink:")?Ie==null?ie.removeAttributeNS(nr,de.slice(6,de.length)):ie.setAttributeNS(nr,de,Ie):Ie==null||Pt&&!t.includeBooleanAttr(Ie)?ie.removeAttribute(de):ie.setAttribute(de,Pt?"":t.isSymbol(Ie)?String(Ie):Ie)}function ve(ie,de,Ie,je,yt){if(de==="innerHTML"||de==="textContent"){Ie!=null&&(ie[de]=de==="innerHTML"?s(Ie):Ie);return}const Pt=ie.tagName;if(de==="value"&&Pt!=="PROGRESS"&&!Pt.includes("-")){const yr=Pt==="OPTION"?ie.getAttribute("value")||"":ie.value,Mr=Ie==null?ie.type==="checkbox"?"on":"":String(Ie);(yr!==Mr||!("_value"in ie))&&(ie.value=Mr),Ie==null&&ie.removeAttribute(de),ie._value=Ie;return}let Ft=!1;if(Ie===""||Ie==null){const yr=typeof ie[de];yr==="boolean"?Ie=t.includeBooleanAttr(Ie):Ie==null&&yr==="string"?(Ie="",Ft=!0):yr==="number"&&(Ie=0,Ft=!0)}try{ie[de]=Ie}catch{}Ft&&ie.removeAttribute(yt||de)}function Ee(ie,de,Ie,je){ie.addEventListener(de,Ie,je)}function He(ie,de,Ie,je){ie.removeEventListener(de,Ie,je)}const wt=Symbol("_vei");function Qe(ie,de,Ie,je,yt=null){const Pt=ie[wt]||(ie[wt]={}),Ft=Pt[de];if(je&&Ft)Ft.value=je;else{const[yr,Mr]=$t(de);if(je){const Fr=Pt[de]=mr(je,yt);Ee(ie,yr,Fr,Mr)}else Ft&&(He(ie,yr,Ft,Mr),Pt[de]=void 0)}}const mt=/(?:Once|Passive|Capture)$/;function $t(ie){let de;if(mt.test(ie)){de={};let je;for(;je=ie.match(mt);)ie=ie.slice(0,ie.length-je[0].length),de[je[0].toLowerCase()]=!0}return[ie[2]===":"?ie.slice(3):t.hyphenate(ie.slice(2)),de]}let Dt=0;const Nt=Promise.resolve(),It=()=>Dt||(Nt.then(()=>Dt=0),Dt=Date.now());function mr(ie,de){const Ie=je=>{if(!je._vts)je._vts=Date.now();else if(je._vts<=Ie.attached)return;e.callWithAsyncErrorHandling(Qt(je,Ie.value),de,5,[je])};return Ie.value=ie,Ie.attached=It(),Ie}function Qt(ie,de){if(t.isArray(de)){const Ie=ie.stopImmediatePropagation;return ie.stopImmediatePropagation=()=>{Ie.call(ie),ie._stopped=!0},de.map(je=>yt=>!yt._stopped&&je&&je(yt))}else return de}const cr=ie=>ie.charCodeAt(0)===111&&ie.charCodeAt(1)===110&&ie.charCodeAt(2)>96&&ie.charCodeAt(2)<123,Fe=(ie,de,Ie,je,yt,Pt)=>{const Ft=yt==="svg";de==="class"?gt(ie,je,Ft):de==="style"?Pn(ie,Ie,je):t.isOn(de)?t.isModelListener(de)||Qe(ie,de,Ie,je,Pt):(de[0]==="."?(de=de.slice(1),!0):de[0]==="^"?(de=de.slice(1),!1):re(ie,de,je,Ft))?(ve(ie,de,je),!ie.tagName.includes("-")&&(de==="value"||de==="checked"||de==="selected")&&fr(ie,de,je,Ft,Pt,de!=="value")):ie._isVueCE&&(/[A-Z]/.test(de)||!t.isString(je))?ve(ie,t.camelize(de),je,Pt,de):(de==="true-value"?ie._trueValue=je:de==="false-value"&&(ie._falseValue=je),fr(ie,de,je,Ft))};function re(ie,de,Ie,je){if(je)return!!(de==="innerHTML"||de==="textContent"||de in ie&&cr(de)&&t.isFunction(Ie));if(de==="spellcheck"||de==="draggable"||de==="translate"||de==="autocorrect"||de==="sandbox"&&ie.tagName==="IFRAME"||de==="form"||de==="list"&&ie.tagName==="INPUT"||de==="type"&&ie.tagName==="TEXTAREA")return!1;if(de==="width"||de==="height"){const yt=ie.tagName;if(yt==="IMG"||yt==="VIDEO"||yt==="CANVAS"||yt==="SOURCE")return!1}return cr(de)&&t.isString(Ie)?!1:de in ie}const ne={};function he(ie,de,Ie){let je=e.defineComponent(ie,de);t.isPlainObject(je)&&(je=t.extend({},je,de));class yt extends Ke{constructor(Ft){super(je,Ft,Ie)}}return yt.def=je,yt}const Be=(ie,de)=>he(ie,de,Cl),ke=typeof HTMLElement<"u"?HTMLElement:class{};class Ke extends ke{constructor(de,Ie={},je=cc){super(),this._def=de,this._props=Ie,this._createApp=je,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._patching=!1,this._dirty=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&je!==cc?this._root=this.shadowRoot:de.shadowRoot!==!1?(this.attachShadow(t.extend({},de.shadowRootOptions,{mode:"open"})),this._root=this.shadowRoot):this._root=this}connectedCallback(){if(!this.isConnected)return;!this.shadowRoot&&!this._resolved&&this._parseSlots(),this._connected=!0;let de=this;for(;de=de&&(de.parentNode||de.host);)if(de instanceof Ke){this._parent=de;break}this._instance||(this._resolved?this._mount(this._def):de&&de._pendingResolve?this._pendingResolve=de._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(de=this._parent){de&&(this._instance.parent=de._instance,this._inheritParentContext(de))}_inheritParentContext(de=this._parent){de&&this._app&&Object.setPrototypeOf(this._app._context.provides,de._instance.provides)}disconnectedCallback(){this._connected=!1,e.nextTick(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null,this._teleportTargets&&(this._teleportTargets.clear(),this._teleportTargets=void 0))})}_processMutations(de){for(const Ie of de)this._setAttr(Ie.attributeName)}_resolveDef(){if(this._pendingResolve)return;for(let je=0;je<this.attributes.length;je++)this._setAttr(this.attributes[je].name);this._ob=new MutationObserver(this._processMutations.bind(this)),this._ob.observe(this,{attributes:!0});const de=(je,yt=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:Pt,styles:Ft}=je;let yr;if(Pt&&!t.isArray(Pt))for(const Mr in Pt){const Fr=Pt[Mr];(Fr===Number||Fr&&Fr.type===Number)&&(Mr in this._props&&(this._props[Mr]=t.toNumber(this._props[Mr])),(yr||(yr=Object.create(null)))[t.camelize(Mr)]=!0)}this._numberProps=yr,this._resolveProps(je),this.shadowRoot&&this._applyStyles(Ft),this._mount(je)},Ie=this._def.__asyncLoader;Ie?this._pendingResolve=Ie().then(je=>{je.configureApp=this._def.configureApp,de(this._def=je,!0)}):de(this._def)}_mount(de){this._app=this._createApp(de),this._inheritParentContext(),de.configureApp&&de.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const Ie=this._instance&&this._instance.exposed;if(Ie)for(const je in Ie)t.hasOwn(this,je)||Object.defineProperty(this,je,{get:()=>e.unref(Ie[je])})}_resolveProps(de){const{props:Ie}=de,je=t.isArray(Ie)?Ie:Object.keys(Ie||{});for(const yt of Object.keys(this))yt[0]!=="_"&&je.includes(yt)&&this._setProp(yt,this[yt]);for(const yt of je.map(t.camelize))Object.defineProperty(this,yt,{get(){return this._getProp(yt)},set(Pt){this._setProp(yt,Pt,!0,!this._patching)}})}_setAttr(de){if(de.startsWith("data-v-"))return;const Ie=this.hasAttribute(de);let je=Ie?this.getAttribute(de):ne;const yt=t.camelize(de);Ie&&this._numberProps&&this._numberProps[yt]&&(je=t.toNumber(je)),this._setProp(yt,je,!1,!0)}_getProp(de){return this._props[de]}_setProp(de,Ie,je=!0,yt=!1){if(Ie!==this._props[de]&&(this._dirty=!0,Ie===ne?delete this._props[de]:(this._props[de]=Ie,de==="key"&&this._app&&(this._app._ceVNode.key=Ie)),yt&&this._instance&&this._update(),je)){const Pt=this._ob;Pt&&(this._processMutations(Pt.takeRecords()),Pt.disconnect()),Ie===!0?this.setAttribute(t.hyphenate(de),""):typeof Ie=="string"||typeof Ie=="number"?this.setAttribute(t.hyphenate(de),Ie+""):Ie||this.removeAttribute(t.hyphenate(de)),Pt&&Pt.observe(this,{attributes:!0})}}_update(){const de=this._createVNode();this._app&&(de.appContext=this._app._context),ss(de,this._root)}_createVNode(){const de={};this.shadowRoot||(de.onVnodeMounted=de.onVnodeUpdated=this._renderSlots.bind(this));const Ie=e.createVNode(this._def,t.extend(de,this._props));return this._instance||(Ie.ce=je=>{this._instance=je,je.ce=this,je.isCE=!0;const yt=(Pt,Ft)=>{this.dispatchEvent(new CustomEvent(Pt,t.isPlainObject(Ft[0])?t.extend({detail:Ft},Ft[0]):{detail:Ft}))};je.emit=(Pt,...Ft)=>{yt(Pt,Ft),t.hyphenate(Pt)!==Pt&&yt(t.hyphenate(Pt),Ft)},this._setParent()}),Ie}_applyStyles(de,Ie){if(!de)return;if(Ie){if(Ie===this._def||this._styleChildren.has(Ie))return;this._styleChildren.add(Ie)}const je=this._nonce;for(let yt=de.length-1;yt>=0;yt--){const Pt=document.createElement("style");je&&Pt.setAttribute("nonce",je),Pt.textContent=de[yt],this.shadowRoot.prepend(Pt)}}_parseSlots(){const de=this._slots={};let Ie;for(;Ie=this.firstChild;){const je=Ie.nodeType===1&&Ie.getAttribute("slot")||"default";(de[je]||(de[je]=[])).push(Ie),this.removeChild(Ie)}}_renderSlots(){const de=this._getSlots(),Ie=this._instance.type.__scopeId;for(let je=0;je<de.length;je++){const yt=de[je],Pt=yt.getAttribute("name")||"default",Ft=this._slots[Pt],yr=yt.parentNode;if(Ft)for(const Mr of Ft){if(Ie&&Mr.nodeType===1){const Fr=Ie+"-s",sn=document.createTreeWalker(Mr,1);Mr.setAttribute(Fr,"");let xi;for(;xi=sn.nextNode();)xi.setAttribute(Fr,"")}yr.insertBefore(Mr,yt)}else for(;yt.firstChild;)yr.insertBefore(yt.firstChild,yt);yr.removeChild(yt)}}_getSlots(){const de=[this];this._teleportTargets&&de.push(...this._teleportTargets);const Ie=new Set;for(const je of de){const yt=je.querySelectorAll("slot");for(let Pt=0;Pt<yt.length;Pt++)Ie.add(yt[Pt])}return Array.from(Ie)}_injectChildStyle(de){this._applyStyles(de.styles,de)}_beginPatch(){this._patching=!0,this._dirty=!1}_endPatch(){this._patching=!1,this._dirty&&this._instance&&this._update()}_removeChildStyle(de){}}function Ge(ie){const de=e.getCurrentInstance(),Ie=de&&de.ce;return Ie||null}function Ue(){const ie=Ge();return ie&&ie.shadowRoot}function nt(ie="$style"){{const de=e.getCurrentInstance();if(!de)return t.EMPTY_OBJ;const Ie=de.type.__cssModules;if(!Ie)return t.EMPTY_OBJ;const je=Ie[ie];return je||t.EMPTY_OBJ}}const vt=new WeakMap,pt=new WeakMap,Wt=Symbol("_moveCb"),ar=Symbol("_enterCb"),ln=(ie=>(delete ie.props.mode,ie))({name:"TransitionGroup",props:t.extend({},k,{tag:String,moveClass:String}),setup(ie,{slots:de}){const Ie=e.getCurrentInstance(),je=e.useTransitionState();let yt,Pt;return e.onUpdated(()=>{if(!yt.length)return;const Ft=ie.moveClass||`${ie.name||"v"}-move`;if(!Ir(yt[0].el,Ie.vnode.el,Ft)){yt=[];return}yt.forEach(et),yt.forEach(Tn);const yr=yt.filter(Xi);lt(Ie.vnode.el),yr.forEach(Mr=>{const Fr=Mr.el,sn=Fr.style;_e(Fr,Ft),sn.transform=sn.webkitTransform=sn.transitionDuration="";const xi=Fr[Wt]=Fi=>{Fi&&Fi.target!==Fr||(!Fi||Fi.propertyName.endsWith("transform"))&&(Fr.removeEventListener("transitionend",xi),Fr[Wt]=null,se(Fr,Ft))};Fr.addEventListener("transitionend",xi)}),yt=[]}),()=>{const Ft=e.toRaw(ie),yr=$(Ft);let Mr=Ft.tag||e.Fragment;if(yt=[],Pt)for(let Fr=0;Fr<Pt.length;Fr++){const sn=Pt[Fr];sn.el&&sn.el instanceof Element&&(yt.push(sn),e.setTransitionHooks(sn,e.resolveTransitionHooks(sn,yr,je,Ie)),vt.set(sn,{left:sn.el.offsetLeft,top:sn.el.offsetTop}))}Pt=de.default?e.getTransitionRawChildren(de.default()):[];for(let Fr=0;Fr<Pt.length;Fr++){const sn=Pt[Fr];sn.key!=null&&e.setTransitionHooks(sn,e.resolveTransitionHooks(sn,yr,je,Ie))}return e.createVNode(Mr,null,Pt)}}});function et(ie){const de=ie.el;de[Wt]&&de[Wt](),de[ar]&&de[ar]()}function Tn(ie){pt.set(ie,{left:ie.el.offsetLeft,top:ie.el.offsetTop})}function Xi(ie){const de=vt.get(ie),Ie=pt.get(ie),je=de.left-Ie.left,yt=de.top-Ie.top;if(je||yt){const Pt=ie.el.style;return Pt.transform=Pt.webkitTransform=`translate(${je}px,${yt}px)`,Pt.transitionDuration="0s",ie}}function Ir(ie,de,Ie){const je=ie.cloneNode(),yt=ie[C];yt&&yt.forEach(yr=>{yr.split(/\s+/).forEach(Mr=>Mr&&je.classList.remove(Mr))}),Ie.split(/\s+/).forEach(yr=>yr&&je.classList.add(yr)),je.style.display="none";const Pt=de.nodeType===1?de:de.parentNode;Pt.appendChild(je);const{hasTransform:Ft}=Me(je);return Pt.removeChild(je),Ft}const qr=ie=>{const de=ie.props["onUpdate:modelValue"]||!1;return t.isArray(de)?Ie=>t.invokeArrayFns(de,Ie):de};function Ji(ie){ie.target.composing=!0}function Rn(ie){const de=ie.target;de.composing&&(de.composing=!1,de.dispatchEvent(new Event("input")))}const nn=Symbol("_assign");function yn(ie,de,Ie){return de&&(ie=ie.trim()),Ie&&(ie=t.looseToNumber(ie)),ie}const ni={created(ie,{modifiers:{lazy:de,trim:Ie,number:je}},yt){ie[nn]=qr(yt);const Pt=je||yt.props&&yt.props.type==="number";Ee(ie,de?"change":"input",Ft=>{Ft.target.composing||ie[nn](yn(ie.value,Ie,Pt))}),(Ie||Pt)&&Ee(ie,"change",()=>{ie.value=yn(ie.value,Ie,Pt)}),de||(Ee(ie,"compositionstart",Ji),Ee(ie,"compositionend",Rn),Ee(ie,"change",Rn))},mounted(ie,{value:de}){ie.value=de??""},beforeUpdate(ie,{value:de,oldValue:Ie,modifiers:{lazy:je,trim:yt,number:Pt}},Ft){if(ie[nn]=qr(Ft),ie.composing)return;const yr=(Pt||ie.type==="number")&&!/^0\d/.test(ie.value)?t.looseToNumber(ie.value):ie.value,Mr=de??"";yr!==Mr&&(document.activeElement===ie&&ie.type!=="range"&&(je&&de===Ie||yt&&ie.value.trim()===Mr)||(ie.value=Mr))}},xl={deep:!0,created(ie,de,Ie){ie[nn]=qr(Ie),Ee(ie,"change",()=>{const je=ie._modelValue,yt=ga(ie),Pt=ie.checked,Ft=ie[nn];if(t.isArray(je)){const yr=t.looseIndexOf(je,yt),Mr=yr!==-1;if(Pt&&!Mr)Ft(je.concat(yt));else if(!Pt&&Mr){const Fr=[...je];Fr.splice(yr,1),Ft(Fr)}}else if(t.isSet(je)){const yr=new Set(je);Pt?yr.add(yt):yr.delete(yt),Ft(yr)}else Ft(Hs(ie,Pt))})},mounted:oc,beforeUpdate(ie,de,Ie){ie[nn]=qr(Ie),oc(ie,de,Ie)}};function oc(ie,{value:de,oldValue:Ie},je){ie._modelValue=de;let yt;if(t.isArray(de))yt=t.looseIndexOf(de,je.props.value)>-1;else if(t.isSet(de))yt=de.has(je.props.value);else{if(de===Ie)return;yt=t.looseEqual(de,Hs(ie,!0))}ie.checked!==yt&&(ie.checked=yt)}const Rt={created(ie,{value:de},Ie){ie.checked=t.looseEqual(de,Ie.props.value),ie[nn]=qr(Ie),Ee(ie,"change",()=>{ie[nn](ga(ie))})},beforeUpdate(ie,{value:de,oldValue:Ie},je){ie[nn]=qr(je),de!==Ie&&(ie.checked=t.looseEqual(de,je.props.value))}},ns={deep:!0,created(ie,{value:de,modifiers:{number:Ie}},je){const yt=t.isSet(de);Ee(ie,"change",()=>{const Pt=Array.prototype.filter.call(ie.options,Ft=>Ft.selected).map(Ft=>Ie?t.looseToNumber(ga(Ft)):ga(Ft));ie[nn](ie.multiple?yt?new Set(Pt):Pt:Pt[0]),ie._assigning=!0,e.nextTick(()=>{ie._assigning=!1})}),ie[nn]=qr(je)},mounted(ie,{value:de}){is(ie,de)},beforeUpdate(ie,de,Ie){ie[nn]=qr(Ie)},updated(ie,{value:de}){ie._assigning||is(ie,de)}};function is(ie,de){const Ie=ie.multiple,je=t.isArray(de);if(!(Ie&&!je&&!t.isSet(de))){for(let yt=0,Pt=ie.options.length;yt<Pt;yt++){const Ft=ie.options[yt],yr=ga(Ft);if(Ie)if(je){const Mr=typeof yr;Mr==="string"||Mr==="number"?Ft.selected=de.some(Fr=>String(Fr)===String(yr)):Ft.selected=t.looseIndexOf(de,yr)>-1}else Ft.selected=de.has(yr);else if(t.looseEqual(ga(Ft),de)){ie.selectedIndex!==yt&&(ie.selectedIndex=yt);return}}!Ie&&ie.selectedIndex!==-1&&(ie.selectedIndex=-1)}}function ga(ie){return"_value"in ie?ie._value:ie.value}function Hs(ie,de){const Ie=de?"_trueValue":"_falseValue";return Ie in ie?ie[Ie]:de}const Kt={created(ie,de,Ie){Dr(ie,de,Ie,null,"created")},mounted(ie,de,Ie){Dr(ie,de,Ie,null,"mounted")},beforeUpdate(ie,de,Ie,je){Dr(ie,de,Ie,je,"beforeUpdate")},updated(ie,de,Ie,je){Dr(ie,de,Ie,je,"updated")}};function Nr(ie,de){switch(ie){case"SELECT":return ns;case"TEXTAREA":return ni;default:switch(de){case"checkbox":return xl;case"radio":return Rt;default:return ni}}}function Dr(ie,de,Ie,je,yt){const Ft=Nr(ie.tagName,Ie.props&&Ie.props.type)[yt];Ft&&Ft(ie,de,Ie,je)}function Ws(){ni.getSSRProps=({value:ie})=>({value:ie}),Rt.getSSRProps=({value:ie},de)=>{if(de.props&&t.looseEqual(de.props.value,ie))return{checked:!0}},xl.getSSRProps=({value:ie},de)=>{if(t.isArray(ie)){if(de.props&&t.looseIndexOf(ie,de.props.value)>-1)return{checked:!0}}else if(t.isSet(ie)){if(de.props&&ie.has(de.props.value))return{checked:!0}}else if(ie)return{checked:!0}},Kt.getSSRProps=(ie,de)=>{if(typeof de.type!="string")return;const Ie=Nr(de.type.toUpperCase(),de.props&&de.props.type);if(Ie.getSSRProps)return Ie.getSSRProps(ie,de)}}const ih=["ctrl","shift","alt","meta"],ma={stop:ie=>ie.stopPropagation(),prevent:ie=>ie.preventDefault(),self:ie=>ie.target!==ie.currentTarget,ctrl:ie=>!ie.ctrlKey,shift:ie=>!ie.shiftKey,alt:ie=>!ie.altKey,meta:ie=>!ie.metaKey,left:ie=>"button"in ie&&ie.button!==0,middle:ie=>"button"in ie&&ie.button!==1,right:ie=>"button"in ie&&ie.button!==2,exact:(ie,de)=>ih.some(Ie=>ie[`${Ie}Key`]&&!de.includes(Ie))},Lr=(ie,de)=>{const Ie=ie._withMods||(ie._withMods={}),je=de.join(".");return Ie[je]||(Ie[je]=(yt,...Pt)=>{for(let Ft=0;Ft<de.length;Ft++){const yr=ma[de[Ft]];if(yr&&yr(yt,de))return}return ie(yt,...Pt)})},Qc={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},eu=(ie,de)=>{const Ie=ie._withKeys||(ie._withKeys={}),je=de.join(".");return Ie[je]||(Ie[je]=yt=>{if(!("key"in yt))return;const Pt=t.hyphenate(yt.key);if(de.some(Ft=>Ft===Pt||Qc[Ft]===Pt))return ie(yt)})},tu=t.extend({patchProp:Fe},g);let Ho,ac=!1;function wl(){return Ho||(Ho=e.createRenderer(tu))}function lc(){return Ho=ac?Ho:e.createHydrationRenderer(tu),ac=!0,Ho}const ss=(...ie)=>{wl().render(...ie)},gn=(...ie)=>{lc().hydrate(...ie)},cc=(...ie)=>{const de=wl().createApp(...ie),{mount:Ie}=de;return de.mount=je=>{const yt=qa(je);if(!yt)return;const Pt=de._component;!t.isFunction(Pt)&&!Pt.render&&!Pt.template&&(Pt.template=yt.innerHTML),yt.nodeType===1&&(yt.textContent="");const Ft=Ie(yt,!1,uc(yt));return yt instanceof Element&&(yt.removeAttribute("v-cloak"),yt.setAttribute("data-v-app","")),Ft},de},Cl=(...ie)=>{const de=lc().createApp(...ie),{mount:Ie}=de;return de.mount=je=>{const yt=qa(je);if(yt)return Ie(yt,!0,uc(yt))},de};function uc(ie){if(ie instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&ie instanceof MathMLElement)return"mathml"}function qa(ie){return t.isString(ie)?document.querySelector(ie):ie}let ao=!1;const Pp=()=>{ao||(ao=!0,Ws(),Er())};r.Transition=V,r.TransitionGroup=ln,r.VueElement=Ke,r.createApp=cc,r.createSSRApp=Cl,r.defineCustomElement=he,r.defineSSRCustomElement=Be,r.hydrate=gn,r.initDirectivesForSSR=Pp,r.nodeOps=g,r.patchProp=Fe,r.render=ss,r.useCssModule=nt,r.useCssVars=Xn,r.useHost=Ge,r.useShadowRoot=Ue,r.vModelCheckbox=xl,r.vModelDynamic=Kt,r.vModelRadio=Rt,r.vModelSelect=ns,r.vModelText=ni,r.vShow=Ut,r.withKeys=eu,r.withModifiers=Lr,Object.keys(e).forEach(function(ie){ie!=="default"&&!Object.prototype.hasOwnProperty.call(r,ie)&&(r[ie]=e[ie])})})(I);/**
* vue v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function soe(){I.initCustomFormatter()}process.env.NODE_ENV!=="production"&&soe();var hi={},E3={exports:{}},YE={},eS={},ft={},b7={},I3={};(function(r){var e;Object.defineProperty(r,"__esModule",{value:!0}),r.fromCodePoint=void 0,r.replaceCodePoint=n,r.decodeCodePoint=i;const t=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);r.fromCodePoint=(e=String.fromCodePoint)!==null&&e!==void 0?e:s=>{let a="";return s>65535&&(s-=65536,a+=String.fromCharCode(s>>>10&1023|55296),s=56320|s&1023),a+=String.fromCharCode(s),a};function n(s){var a;return s>=55296&&s<=57343||s>1114111?65533:(a=t.get(s))!==null&&a!==void 0?a:s}function i(s){return(0,r.fromCodePoint)(n(s))}})(I3);var T_={},tS={};Object.defineProperty(tS,"__esModule",{value:!0});tS.decodeBase64=ooe;function ooe(r){const e=typeof atob=="function"?atob(r):typeof Buffer.from=="function"?Buffer.from(r,"base64").toString("binary"):new Buffer(r,"base64").toString("binary"),t=e.length&-2,n=new Uint16Array(t/2);for(let i=0,s=0;i<t;i+=2){const a=e.charCodeAt(i),o=e.charCodeAt(i+1);n[s++]=a|o<<8}return n}Object.defineProperty(T_,"__esModule",{value:!0});T_.htmlDecodeTree=void 0;const aoe=tS;T_.htmlDecodeTree=(0,aoe.decodeBase64)("QR08ALkAAgH6AYsDNQR2BO0EPgXZBQEGLAbdBxMISQrvCmQLfQurDKQNLw4fD4YPpA+6D/IPAAAAAAAAAAAAAAAAKhBMEY8TmxUWF2EYLBkxGuAa3RsJHDscWR8YIC8jSCSIJcMl6ie3Ku8rEC0CLjoupS7kLgAIRU1hYmNmZ2xtbm9wcnN0dVQAWgBeAGUAaQBzAHcAfgCBAIQAhwCSAJoAoACsALMAbABpAGcAO4DGAMZAUAA7gCYAJkBjAHUAdABlADuAwQDBQHIiZXZlAAJhAAFpeW0AcgByAGMAO4DCAMJAEGRyAADgNdgE3XIAYQB2AGUAO4DAAMBA8CFoYZFj4SFjcgBhZAAAoFMqAAFncIsAjgBvAG4ABGFmAADgNdg43fAlbHlGdW5jdGlvbgCgYSBpAG4AZwA7gMUAxUAAAWNzpACoAHIAAOA12Jzc6SFnbgCgVCJpAGwAZABlADuAwwDDQG0AbAA7gMQAxEAABGFjZWZvcnN1xQDYANoA7QDxAPYA+QD8AAABY3LJAM8AayNzbGFzaAAAoBYidgHTANUAAKDnKmUAZAAAoAYjeQARZIABY3J0AOAA5QDrAGEidXNlAACgNSLuI291bGxpcwCgLCFhAJJjcgAA4DXYBd1wAGYAAOA12Dnd5SF2ZdhiYwDyAOoAbSJwZXEAAKBOIgAHSE9hY2RlZmhpbG9yc3UXARoBHwE6AVIBVQFiAWQBZgGCAakB6QHtAfIBYwB5ACdkUABZADuAqQCpQIABY3B5ACUBKAE1AfUhdGUGYWmg0iJ0KGFsRGlmZmVyZW50aWFsRAAAoEUhbCJleXMAAKAtIQACYWVpb0EBRAFKAU0B8iFvbgxhZABpAGwAO4DHAMdAcgBjAAhhbiJpbnQAAKAwIm8AdAAKYQABZG5ZAV0BaSJsbGEAuGB0I2VyRG90ALdg8gA5AWkAp2NyImNsZQAAAkRNUFRwAXQBeQF9AW8AdAAAoJkiaSJudXMAAKCWIuwhdXMAoJUiaSJtZXMAAKCXIm8AAAFjc4cBlAFrKndpc2VDb250b3VySW50ZWdyYWwAAKAyImUjQ3VybHkAAAFEUZwBpAFvJXVibGVRdW90ZQAAoB0gdSJvdGUAAKAZIAACbG5wdbABtgHNAdgBbwBuAGWgNyIAoHQqgAFnaXQAvAHBAcUB8iJ1ZW50AKBhIm4AdAAAoC8i7yV1ckludGVncmFsAKAuIgABZnLRAdMBAKACIe8iZHVjdACgECJuLnRlckNsb2Nrd2lzZUNvbnRvdXJJbnRlZ3JhbAAAoDMi7yFzcwCgLypjAHIAAOA12J7ccABDoNMiYQBwAACgTSKABURKU1phY2VmaW9zAAsCEgIVAhgCGwIsAjQCOQI9AnMCfwNvoEUh9CJyYWhkAKARKWMAeQACZGMAeQAFZGMAeQAPZIABZ3JzACECJQIoAuchZXIAoCEgcgAAoKEhaAB2AACg5CoAAWF5MAIzAvIhb24OYRRkbAB0oAciYQCUY3IAAOA12AfdAAFhZkECawIAAWNtRQJnAvIjaXRpY2FsAAJBREdUUAJUAl8CYwJjInV0ZQC0YG8AdAFZAloC2WJiJGxlQWN1dGUA3WJyImF2ZQBgYGkibGRlANxi7yFuZACgxCJmJWVyZW50aWFsRAAAoEYhcAR9AgAAAAAAAIECjgIAABoDZgAA4DXYO91EoagAhQKJAm8AdAAAoNwgcSJ1YWwAAKBQIuIhbGUAA0NETFJVVpkCqAK1Au8C/wIRA28AbgB0AG8AdQByAEkAbgB0AGUAZwByAGEA7ADEAW8AdAKvAgAAAACwAqhgbiNBcnJvdwAAoNMhAAFlb7kC0AJmAHQAgAFBUlQAwQLGAs0CciJyb3cAAKDQIekkZ2h0QXJyb3cAoNQhZQDlACsCbgBnAAABTFLWAugC5SFmdAABQVLcAuECciJyb3cAAKD4J+kkZ2h0QXJyb3cAoPon6SRnaHRBcnJvdwCg+SdpImdodAAAAUFU9gL7AnIicm93AACg0iFlAGUAAKCoInAAQQIGAwAAAAALA3Iicm93AACg0SFvJHduQXJyb3cAAKDVIWUlcnRpY2FsQmFyAACgJSJuAAADQUJMUlRhJAM2AzoDWgNxA3oDciJyb3cAAKGTIUJVLAMwA2EAcgAAoBMpcCNBcnJvdwAAoPUhciJldmUAEWPlIWZ00gJDAwAASwMAAFIDaSVnaHRWZWN0b3IAAKBQKWUkZVZlY3RvcgAAoF4p5SJjdG9yQqC9IWEAcgAAoFYpaSJnaHQA1AFiAwAAaQNlJGVWZWN0b3IAAKBfKeUiY3RvckKgwSFhAHIAAKBXKWUAZQBBoKQiciJyb3cAAKCnIXIAcgBvAPcAtAIAAWN0gwOHA3IAAOA12J/c8iFvaxBhAAhOVGFjZGZnbG1vcHFzdHV4owOlA6kDsAO/A8IDxgPNA9ID8gP9AwEEFAQeBCAEJQRHAEphSAA7gNAA0EBjAHUAdABlADuAyQDJQIABYWl5ALYDuQO+A/Ihb24aYXIAYwA7gMoAykAtZG8AdAAWYXIAAOA12AjdcgBhAHYAZQA7gMgAyEDlIm1lbnQAoAgiAAFhcNYD2QNjAHIAEmF0AHkAUwLhAwAAAADpA20lYWxsU3F1YXJlAACg+yVlJ3J5U21hbGxTcXVhcmUAAKCrJQABZ3D2A/kDbwBuABhhZgAA4DXYPN3zImlsb26VY3UAAAFhaQYEDgRsAFSgdSppImxkZQAAoEIi7CNpYnJpdW0AoMwhAAFjaRgEGwRyAACgMCFtAACgcyphAJdjbQBsADuAywDLQAABaXApBC0E8yF0cwCgAyLvJG5lbnRpYWxFAKBHIYACY2Zpb3MAPQQ/BEMEXQRyBHkAJGRyAADgNdgJ3WwibGVkAFMCTAQAAAAAVARtJWFsbFNxdWFyZQAAoPwlZSdyeVNtYWxsU3F1YXJlAACgqiVwA2UEAABpBAAAAABtBGYAAOA12D3dwSFsbACgACLyI2llcnRyZgCgMSFjAPIAcQQABkpUYWJjZGZnb3JzdIgEiwSOBJMElwSkBKcEqwStBLIE5QTqBGMAeQADZDuAPgA+QO0hbWFkoJMD3GNyImV2ZQAeYYABZWl5AJ0EoASjBOQhaWwiYXIAYwAcYRNkbwB0ACBhcgAA4DXYCt0AoNkicABmAADgNdg+3eUiYXRlcgADRUZHTFNUvwTIBM8E1QTZBOAEcSJ1YWwATKBlIuUhc3MAoNsidSRsbEVxdWFsAACgZyJyI2VhdGVyAACgoirlIXNzAKB3IuwkYW50RXF1YWwAoH4qaSJsZGUAAKBzImMAcgAA4DXYotwAoGsiAARBYWNmaW9zdfkE/QQFBQgFCwUTBSIFKwVSIkRjeQAqZAABY3QBBQQFZQBrAMdiXmDpIXJjJGFyAACgDCFsJWJlcnRTcGFjZQAAoAsh8AEYBQAAGwVmAACgDSHpJXpvbnRhbExpbmUAoAAlAAFjdCYFKAXyABIF8iFvayZhbQBwAEQBMQU5BW8AdwBuAEgAdQBtAPAAAAFxInVhbAAAoE8iAAdFSk9hY2RmZ21ub3N0dVMFVgVZBVwFYwVtBXAFcwV6BZAFtgXFBckFzQVjAHkAFWTsIWlnMmFjAHkAAWRjAHUAdABlADuAzQDNQAABaXlnBWwFcgBjADuAzgDOQBhkbwB0ADBhcgAAoBEhcgBhAHYAZQA7gMwAzEAAoREhYXB/BYsFAAFjZ4MFhQVyACphaSNuYXJ5SQAAoEghbABpAGUA8wD6AvQBlQUAAKUFZaAsIgABZ3KaBZ4F8iFhbACgKyLzI2VjdGlvbgCgwiJpI3NpYmxlAAABQ1SsBbEFbyJtbWEAAKBjIGkibWVzAACgYiCAAWdwdAC8Bb8FwwVvAG4ALmFmAADgNdhA3WEAmWNjAHIAAKAQIWkibGRlAChh6wHSBQAA1QVjAHkABmRsADuAzwDPQIACY2Zvc3UA4QXpBe0F8gX9BQABaXnlBegFcgBjADRhGWRyAADgNdgN3XAAZgAA4DXYQd3jAfcFAAD7BXIAAOA12KXc8iFjeQhk6yFjeQRkgANISmFjZm9zAAwGDwYSBhUGHQYhBiYGYwB5ACVkYwB5AAxk8CFwYZpjAAFleRkGHAbkIWlsNmEaZHIAAOA12A7dcABmAADgNdhC3WMAcgAA4DXYptyABUpUYWNlZmxtb3N0AD0GQAZDBl4GawZkB2gHcAd0B80H2gdjAHkACWQ7gDwAPECAAmNtbnByAEwGTwZSBlUGWwb1IXRlOWHiIWRhm2NnAACg6ifsI2FjZXRyZgCgEiFyAACgniGAAWFleQBkBmcGagbyIW9uPWHkIWlsO2EbZAABZnNvBjQHdAAABUFDREZSVFVWYXKABp4GpAbGBssG3AYDByEHwQIqBwABbnKEBowGZyVsZUJyYWNrZXQAAKDoJ/Ihb3cAoZAhQlKTBpcGYQByAACg5CHpJGdodEFycm93AKDGIWUjaWxpbmcAAKAII28A9QGqBgAAsgZiJWxlQnJhY2tldAAAoOYnbgDUAbcGAAC+BmUkZVZlY3RvcgAAoGEp5SJjdG9yQqDDIWEAcgAAoFkpbCJvb3IAAKAKI2kiZ2h0AAABQVbSBtcGciJyb3cAAKCUIeUiY3RvcgCgTikAAWVy4AbwBmUAAKGjIkFW5gbrBnIicm93AACgpCHlImN0b3IAoFopaSNhbmdsZQBCorIi+wYAAAAA/wZhAHIAAKDPKXEidWFsAACgtCJwAIABRFRWAAoHEQcYB+8kd25WZWN0b3IAoFEpZSRlVmVjdG9yAACgYCnlImN0b3JCoL8hYQByAACgWCnlImN0b3JCoLwhYQByAACgUilpAGcAaAB0AGEAcgByAG8A9wDMAnMAAANFRkdMU1Q/B0cHTgdUB1gHXwfxJXVhbEdyZWF0ZXIAoNoidSRsbEVxdWFsAACgZiJyI2VhdGVyAACgdiLlIXNzAKChKuwkYW50RXF1YWwAoH0qaSJsZGUAAKByInIAAOA12A/dZaDYIuYjdGFycm93AKDaIWkiZG90AD9hgAFucHcAege1B7kHZwAAAkxSbHKCB5QHmwerB+UhZnQAAUFSiAeNB3Iicm93AACg9SfpJGdodEFycm93AKD3J+kkZ2h0QXJyb3cAoPYn5SFmdAABYXLcAqEHaQBnAGgAdABhAHIAcgBvAPcA5wJpAGcAaAB0AGEAcgByAG8A9wDuAmYAAOA12EPdZQByAAABTFK/B8YHZSRmdEFycm93AACgmSHpJGdodEFycm93AKCYIYABY2h0ANMH1QfXB/IAWgYAoLAh8iFva0FhAKBqIgAEYWNlZmlvc3XpB+wH7gf/BwMICQgOCBEIcAAAoAUpeQAcZAABZGzyB/kHaSR1bVNwYWNlAACgXyBsI2ludHJmAACgMyFyAADgNdgQ3e4jdXNQbHVzAKATInAAZgAA4DXYRN1jAPIA/gecY4AESmFjZWZvc3R1ACEIJAgoCDUIgQiFCDsKQApHCmMAeQAKZGMidXRlAENhgAFhZXkALggxCDQI8iFvbkdh5CFpbEVhHWSAAWdzdwA7CGEIfQjhInRpdmWAAU1UVgBECEwIWQhlJWRpdW1TcGFjZQAAoAsgaABpAAABY25SCFMIawBTAHAAYQBjAOUASwhlAHIAeQBUAGgAaQDuAFQI9CFlZAABR0xnCHUIcgBlAGEAdABlAHIARwByAGUAYQB0AGUA8gDrBGUAcwBzAEwAZQBzAPMA2wdMImluZQAKYHIAAOA12BHdAAJCbnB0jAiRCJkInAhyImVhawAAoGAgwiZyZWFraW5nU3BhY2WgYGYAAKAVIUOq7CqzCMIIzQgAAOcIGwkAAAAAAAAtCQAAbwkAAIcJAACdCcAJGQoAADQKAAFvdbYIvAjuI2dydWVudACgYiJwIkNhcAAAoG0ibyh1YmxlVmVydGljYWxCYXIAAKAmIoABbHF4ANII1wjhCOUibWVudACgCSL1IWFsVKBgImkibGRlAADgQiI4A2kic3RzAACgBCJyI2VhdGVyAACjbyJFRkdMU1T1CPoIAgkJCQ0JFQlxInVhbAAAoHEidSRsbEVxdWFsAADgZyI4A3IjZWF0ZXIAAOBrIjgD5SFzcwCgeSLsJGFudEVxdWFsAOB+KjgDaSJsZGUAAKB1IvUhbXBEASAJJwnvI3duSHVtcADgTiI4A3EidWFsAADgTyI4A2UAAAFmczEJRgn0JFRyaWFuZ2xlQqLqIj0JAAAAAEIJYQByAADgzyk4A3EidWFsAACg7CJzAICibiJFR0xTVABRCVYJXAlhCWkJcSJ1YWwAAKBwInIjZWF0ZXIAAKB4IuUhc3MA4GoiOAPsJGFudEVxdWFsAOB9KjgDaSJsZGUAAKB0IuUic3RlZAABR0x1CX8J8iZlYXRlckdyZWF0ZXIA4KIqOAPlI3NzTGVzcwDgoSo4A/IjZWNlZGVzAKGAIkVTjwmVCXEidWFsAADgryo4A+wkYW50RXF1YWwAoOAiAAFlaaAJqQl2JmVyc2VFbGVtZW50AACgDCLnJWh0VHJpYW5nbGVCousitgkAAAAAuwlhAHIAAODQKTgDcSJ1YWwAAKDtIgABcXXDCeAJdSNhcmVTdQAAAWJwywnVCfMhZXRF4I8iOANxInVhbAAAoOIi5SJyc2V0ReCQIjgDcSJ1YWwAAKDjIoABYmNwAOYJ8AkNCvMhZXRF4IIi0iBxInVhbAAAoIgi4yJlZWRzgKGBIkVTVAD6CQAKBwpxInVhbAAA4LAqOAPsJGFudEVxdWFsAKDhImkibGRlAADgfyI4A+UicnNldEXggyLSIHEidWFsAACgiSJpImxkZQCAoUEiRUZUACIKJwouCnEidWFsAACgRCJ1JGxsRXF1YWwAAKBHImkibGRlAACgSSJlJXJ0aWNhbEJhcgAAoCQiYwByAADgNdip3GkAbABkAGUAO4DRANFAnWMAB0VhY2RmZ21vcHJzdHV2XgphCmgKcgp2CnoKgQqRCpYKqwqtCrsKyArNCuwhaWdSYWMAdQB0AGUAO4DTANNAAAFpeWwKcQpyAGMAO4DUANRAHmRiImxhYwBQYXIAAOA12BLdcgBhAHYAZQA7gNIA0kCAAWFlaQCHCooKjQpjAHIATGFnAGEAqWNjInJvbgCfY3AAZgAA4DXYRt3lI25DdXJseQABRFGeCqYKbyV1YmxlUXVvdGUAAKAcIHUib3RlAACgGCAAoFQqAAFjbLEKtQpyAADgNdiq3GEAcwBoADuA2ADYQGkAbAHACsUKZABlADuA1QDVQGUAcwAAoDcqbQBsADuA1gDWQGUAcgAAAUJQ0wrmCgABYXLXCtoKcgAAoD4gYQBjAAABZWvgCuIKAKDeI2UAdAAAoLQjYSVyZW50aGVzaXMAAKDcI4AEYWNmaGlsb3JzAP0KAwsFCwkLCwsMCxELIwtaC3IjdGlhbEQAAKACInkAH2RyAADgNdgT3WkApmOgY/Ujc01pbnVzsWAAAWlwFQsgC24AYwBhAHIAZQBwAGwAYQBuAOUACgVmAACgGSGAobsqZWlvACoLRQtJC+MiZWRlc4CheiJFU1QANAs5C0ALcSJ1YWwAAKCvKuwkYW50RXF1YWwAoHwiaSJsZGUAAKB+Im0AZQAAoDMgAAFkcE0LUQv1IWN0AKAPIm8jcnRpb24AYaA3ImwAAKAdIgABY2leC2ILcgAA4DXYq9yoYwACVWZvc2oLbwtzC3cLTwBUADuAIgAiQHIAAOA12BTdcABmAACgGiFjAHIAAOA12KzcAAZCRWFjZWZoaW9yc3WPC5MLlwupC7YL2AvbC90LhQyTDJoMowzhIXJyAKAQKUcAO4CuAK5AgAFjbnIAnQugC6ML9SF0ZVRhZwAAoOsncgB0oKAhbAAAoBYpgAFhZXkArwuyC7UL8iFvblhh5CFpbFZhIGR2oBwhZSJyc2UAAAFFVb8LzwsAAWxxwwvIC+UibWVudACgCyL1JGlsaWJyaXVtAKDLIXAmRXF1aWxpYnJpdW0AAKBvKXIAAKAcIW8AoWPnIWh0AARBQ0RGVFVWYewLCgwQDDIMNwxeDHwM9gIAAW5y8Av4C2clbGVCcmFja2V0AACg6SfyIW93AKGSIUJM/wsDDGEAcgAAoOUhZSRmdEFycm93AACgxCFlI2lsaW5nAACgCSNvAPUBFgwAAB4MYiVsZUJyYWNrZXQAAKDnJ24A1AEjDAAAKgxlJGVWZWN0b3IAAKBdKeUiY3RvckKgwiFhAHIAAKBVKWwib29yAACgCyMAAWVyOwxLDGUAAKGiIkFWQQxGDHIicm93AACgpiHlImN0b3IAoFspaSNhbmdsZQBCorMiVgwAAAAAWgxhAHIAAKDQKXEidWFsAACgtSJwAIABRFRWAGUMbAxzDO8kd25WZWN0b3IAoE8pZSRlVmVjdG9yAACgXCnlImN0b3JCoL4hYQByAACgVCnlImN0b3JCoMAhYQByAACgUykAAXB1iQyMDGYAAKAdIe4kZEltcGxpZXMAoHAp6SRnaHRhcnJvdwCg2yEAAWNongyhDHIAAKAbIQCgsSHsJGVEZWxheWVkAKD0KYAGSE9hY2ZoaW1vcXN0dQC/DMgMzAzQDOIM5gwKDQ0NFA0ZDU8NVA1YDQABQ2PDDMYMyCFjeSlkeQAoZEYiVGN5ACxkYyJ1dGUAWmEAorwqYWVpedgM2wzeDOEM8iFvbmBh5CFpbF5hcgBjAFxhIWRyAADgNdgW3e8hcnQAAkRMUlXvDPYM/QwEDW8kd25BcnJvdwAAoJMhZSRmdEFycm93AACgkCHpJGdodEFycm93AKCSIXAjQXJyb3cAAKCRIechbWGjY+EkbGxDaXJjbGUAoBgicABmAADgNdhK3XICHw0AAAAAIg10AACgGiLhIXJlgKGhJUlTVQAqDTINSg3uJXRlcnNlY3Rpb24AoJMidQAAAWJwNw1ADfMhZXRFoI8icSJ1YWwAAKCRIuUicnNldEWgkCJxInVhbAAAoJIibiJpb24AAKCUImMAcgAA4DXYrtxhAHIAAKDGIgACYmNtcF8Nag2ODZANc6DQImUAdABFoNAicSJ1YWwAAKCGIgABY2huDYkNZSJlZHMAgKF7IkVTVAB4DX0NhA1xInVhbAAAoLAq7CRhbnRFcXVhbACgfSJpImxkZQAAoH8iVABoAGEA9ADHCwCgESIAodEiZXOVDZ8NciJzZXQARaCDInEidWFsAACghyJlAHQAAKDRIoAFSFJTYWNmaGlvcnMAtQ27Db8NyA3ODdsN3w3+DRgOHQ4jDk8AUgBOADuA3gDeQMEhREUAoCIhAAFIY8MNxg1jAHkAC2R5ACZkAAFidcwNzQ0JYKRjgAFhZXkA1A3XDdoN8iFvbmRh5CFpbGJhImRyAADgNdgX3QABZWnjDe4N8gHoDQAA7Q3lImZvcmUAoDQiYQCYYwABY27yDfkNayNTcGFjZQAA4F8gCiDTInBhY2UAoAkg7CFkZYChPCJFRlQABw4MDhMOcSJ1YWwAAKBDInUkbGxFcXVhbAAAoEUiaSJsZGUAAKBIInAAZgAA4DXYS93pI3BsZURvdACg2yAAAWN0Jw4rDnIAAOA12K/c8iFva2Zh4QpFDlYOYA5qDgAAbg5yDgAAAAAAAAAAAAB5DnwOqA6zDgAADg8RDxYPGg8AAWNySA5ODnUAdABlADuA2gDaQHIAb6CfIeMhaXIAoEkpcgDjAVsOAABdDnkADmR2AGUAbGEAAWl5Yw5oDnIAYwA7gNsA20AjZGIibGFjAHBhcgAA4DXYGN1yAGEAdgBlADuA2QDZQOEhY3JqYQABZGl/Dp8OZQByAAABQlCFDpcOAAFhcokOiw5yAF9gYQBjAAABZWuRDpMOAKDfI2UAdAAAoLUjYSVyZW50aGVzaXMAAKDdI28AbgBQoMMi7CF1cwCgjiIAAWdwqw6uDm8AbgByYWYAAOA12EzdAARBREVUYWRwc78O0g7ZDuEOBQPqDvMOBw9yInJvdwDCoZEhyA4AAMwOYQByAACgEilvJHduQXJyb3cAAKDFIW8kd25BcnJvdwAAoJUhcSV1aWxpYnJpdW0AAKBuKWUAZQBBoKUiciJyb3cAAKClIW8AdwBuAGEAcgByAG8A9wAQA2UAcgAAAUxS+Q4AD2UkZnRBcnJvdwAAoJYh6SRnaHRBcnJvdwCglyFpAGyg0gNvAG4ApWPpIW5nbmFjAHIAAOA12LDcaSJsZGUAaGFtAGwAO4DcANxAgAREYmNkZWZvc3YALQ8xDzUPNw89D3IPdg97D4AP4SFzaACgqyJhAHIAAKDrKnkAEmThIXNobKCpIgCg5ioAAWVyQQ9DDwCgwSKAAWJ0eQBJD00Paw9hAHIAAKAWIGmgFiDjIWFsAAJCTFNUWA9cD18PZg9hAHIAAKAjIukhbmV8YGUkcGFyYXRvcgAAoFgnaSJsZGUAAKBAItQkaGluU3BhY2UAoAogcgAA4DXYGd1wAGYAAOA12E3dYwByAADgNdix3GQiYXNoAACgqiKAAmNlZm9zAI4PkQ+VD5kPng/pIXJjdGHkIWdlAKDAInIAAOA12BrdcABmAADgNdhO3WMAcgAA4DXYstwAAmZpb3OqD64Prw+0D3IAAOA12BvdnmNwAGYAAOA12E/dYwByAADgNdiz3IAEQUlVYWNmb3N1AMgPyw/OD9EP2A/gD+QP6Q/uD2MAeQAvZGMAeQAHZGMAeQAuZGMAdQB0AGUAO4DdAN1AAAFpedwP3w9yAGMAdmErZHIAAOA12BzdcABmAADgNdhQ3WMAcgAA4DXYtNxtAGwAeGEABEhhY2RlZm9z/g8BEAUQDRAQEB0QIBAkEGMAeQAWZGMidXRlAHlhAAFheQkQDBDyIW9ufWEXZG8AdAB7YfIBFRAAABwQbwBXAGkAZAB0AOgAVAhhAJZjcgAAoCghcABmAACgJCFjAHIAAOA12LXc4QtCEEkQTRAAAGcQbRByEAAAAAAAAAAAeRCKEJcQ8hD9EAAAGxEhETIROREAAD4RYwB1AHQAZQA7gOEA4UByImV2ZQADYYCiPiJFZGl1eQBWEFkQWxBgEGUQAOA+IjMDAKA/InIAYwA7gOIA4kB0AGUAO4C0ALRAMGRsAGkAZwA7gOYA5kByoGEgAOA12B7dcgBhAHYAZQA7gOAA4EAAAWVwfBCGEAABZnCAEIQQ8yF5bQCgNSHoAIMQaABhALFjAAFhcI0QWwAAAWNskRCTEHIAAWFnAACgPypkApwQAAAAALEQAKInImFkc3ajEKcQqRCuEG4AZAAAoFUqAKBcKmwib3BlAACgWCoAoFoqAKMgImVsbXJzersQvRDAEN0Q5RDtEACgpCllAACgICJzAGQAYaAhImEEzhDQENIQ1BDWENgQ2hDcEACgqCkAoKkpAKCqKQCgqykAoKwpAKCtKQCgrikAoK8pdAB2oB8iYgBkoL4iAKCdKQABcHTpEOwQaAAAoCIixWDhIXJyAKB8IwABZ3D1EPgQbwBuAAVhZgAA4DXYUt0Ao0giRWFlaW9wBxEJEQ0RDxESERQRAKBwKuMhaXIAoG8qAKBKImQAAKBLInMAJ2DyIW94ZaBIIvEADhFpAG4AZwA7gOUA5UCAAWN0eQAmESoRKxFyAADgNdi23CpgbQBwAGWgSCLxAPgBaQBsAGQAZQA7gOMA40BtAGwAO4DkAORAAAFjaUERRxFvAG4AaQBuAPQA6AFuAHQAAKARKgAITmFiY2RlZmlrbG5vcHJzdWQRaBGXEZ8RpxGrEdIR1hErEjASexKKEn0RThNbE3oTbwB0AACg7SoAAWNybBGJEWsAAAJjZXBzdBF4EX0RghHvIW5nAKBMInAjc2lsb24A9mNyImltZQAAoDUgaQBtAGWgPSJxAACgzSJ2AY0RkRFlAGUAAKC9ImUAZABnoAUjZQAAoAUjcgBrAHSgtSPiIXJrAKC2IwABb3mjEaYRbgDnAHcRMWTxIXVvAKAeIIACY21wcnQAtBG5Eb4RwRHFEeEhdXPloDUi5ABwInR5dgAAoLApcwDpAH0RbgBvAPUA6gCAAWFodwDLEcwRzhGyYwCgNiHlIWVuAKBsInIAAOA12B/dZwCAA2Nvc3R1dncA4xHyEQUSEhIhEiYSKRKAAWFpdQDpEesR7xHwAKMFcgBjAACg7yVwAACgwyKAAWRwdAD4EfwRABJvAHQAAKAAKuwhdXMAoAEqaSJtZXMAAKACKnECCxIAAAAADxLjIXVwAKAGKmEAcgAAoAUm8iNpYW5nbGUAAWR1GhIeEu8hd24AoL0lcAAAoLMlcCJsdXMAAKAEKmUA5QBCD+UAkg9hInJvdwAAoA0pgAFha28ANhJoEncSAAFjbjoSZRJrAIABbHN0AEESRxJNEm8jemVuZ2UAAKDrKXEAdQBhAHIA5QBcBPIjaWFuZ2xlgKG0JWRscgBYElwSYBLvIXduAKC+JeUhZnQAoMIlaSJnaHQAAKC4JWsAAKAjJLEBbRIAAHUSsgFxEgAAcxIAoJIlAKCRJTQAAKCTJWMAawAAoIglAAFlb38ShxJx4D0A5SD1IWl2AOBhIuUgdAAAoBAjAAJwdHd4kRKVEpsSnxJmAADgNdhT3XSgpSJvAG0AAKClIvQhaWUAoMgiAAZESFVWYmRobXB0dXayEsES0RLgEvcS+xIKExoTHxMjEygTNxMAAkxSbHK5ErsSvRK/EgCgVyUAoFQlAKBWJQCgUyUAolAlRFVkdckSyxLNEs8SAKBmJQCgaSUAoGQlAKBnJQACTFJsctgS2hLcEt4SAKBdJQCgWiUAoFwlAKBZJQCjUSVITFJobHLrEu0S7xLxEvMS9RIAoGwlAKBjJQCgYCUAoGslAKBiJQCgXyVvAHgAAKDJKQACTFJscgITBBMGEwgTAKBVJQCgUiUAoBAlAKAMJQCiACVEVWR1EhMUExYTGBMAoGUlAKBoJQCgLCUAoDQlaSJudXMAAKCfIuwhdXMAoJ4iaSJtZXMAAKCgIgACTFJsci8TMRMzEzUTAKBbJQCgWCUAoBglAKAUJQCjAiVITFJobHJCE0QTRhNIE0oTTBMAoGolAKBhJQCgXiUAoDwlAKAkJQCgHCUAAWV2UhNVE3YA5QD5AGIAYQByADuApgCmQAACY2Vpb2ITZhNqE24TcgAA4DXYt9xtAGkAAKBPIG0A5aA9IogRbAAAoVwAYmh0E3YTAKDFKfMhdWIAoMgnbAF+E4QTbABloCIgdAAAoCIgcAAAoU4iRWWJE4sTAKCuKvGgTyI8BeEMqRMAAN8TABQDFB8UAAAjFDQUAAAAAIUUAAAAAI0UAAAAANcU4xT3FPsUAACIFQAAlhWAAWNwcgCuE7ET1RP1IXRlB2GAoikiYWJjZHMAuxO/E8QTzhPSE24AZAAAoEQqciJjdXAAAKBJKgABYXXIE8sTcAAAoEsqcAAAoEcqbwB0AACgQCoA4CkiAP4AAWVv2RPcE3QAAKBBIO4ABAUAAmFlaXXlE+8T9RP4E/AB6hMAAO0TcwAAoE0qbwBuAA1hZABpAGwAO4DnAOdAcgBjAAlhcABzAHOgTCptAACgUCpvAHQAC2GAAWRtbgAIFA0UEhRpAGwAO4C4ALhAcCJ0eXYAAKCyKXQAAIGiADtlGBQZFKJAcgBkAG8A9ABiAXIAAOA12CDdgAFjZWkAKBQqFDIUeQBHZGMAawBtoBMn4SFyawCgEyfHY3IAAKPLJUVjZWZtcz8UQRRHFHcUfBSAFACgwykAocYCZWxGFEkUcQAAoFciZQBhAlAUAAAAAGAUciJyb3cAAAFsclYUWhTlIWZ0AKC6IWkiZ2h0AACguyGAAlJTYWNkAGgUaRRrFG8UcxSuYACgyCRzAHQAAKCbIukhcmMAoJoi4SFzaACgnSJuImludAAAoBAqaQBkAACg7yrjIWlyAKDCKfUhYnN1oGMmaQB0AACgYybsApMUmhS2FAAAwxRvAG4AZaA6APGgVCKrAG0CnxQAAAAAoxRhAHSgLABAYAChASJmbKcUqRTuABMNZQAAAW14rhSyFOUhbnQAoAEiZQDzANIB5wG6FAAAwBRkoEUibwB0AACgbSpuAPQAzAGAAWZyeQDIFMsUzhQA4DXYVN1vAOQA1wEAgakAO3MeAdMUcgAAoBchAAFhb9oU3hRyAHIAAKC1IXMAcwAAoBcnAAFjdeYU6hRyAADgNdi43AABYnDuFPIUZaDPKgCg0SploNAqAKDSKuQhb3QAoO8igANkZWxwcnZ3AAYVEBUbFSEVRBVlFYQV4SFycgABbHIMFQ4VAKA4KQCgNSlwAhYVAAAAABkVcgAAoN4iYwAAoN8i4SFycnCgtiEAoD0pgKIqImJjZG9zACsVMBU6FT4VQRVyImNhcAAAoEgqAAFhdTQVNxVwAACgRipwAACgSipvAHQAAKCNInIAAKBFKgDgKiIA/gACYWxydksVURVuFXMVcgByAG2gtyEAoDwpeQCAAWV2dwBYFWUVaRVxAHACXxUAAAAAYxVyAGUA4wAXFXUA4wAZFWUAZQAAoM4iZSJkZ2UAAKDPImUAbgA7gKQApEBlI2Fycm93AAABbHJ7FX8V5SFmdACgtiFpImdodAAAoLchZQDkAG0VAAFjaYsVkRVvAG4AaQBuAPQAkwFuAHQAAKAxImwiY3R5AACgLSOACUFIYWJjZGVmaGlqbG9yc3R1d3oAuBW7Fb8V1RXgFegV+RUKFhUWHxZUFlcWZRbFFtsW7xb7FgUXChdyAPIAtAJhAHIAAKBlKQACZ2xyc8YVyhXOFdAV5yFlcgCgICDlIXRoAKA4IfIA9QxoAHagECAAoKMiawHZFd4VYSJyb3cAAKAPKWEA4wBfAgABYXnkFecV8iFvbg9hNGQAoUYhYW/tFfQVAAFnciEC8RVyAACgyiF0InNlcQAAoHcqgAFnbG0A/xUCFgUWO4CwALBAdABhALRjcCJ0eXYAAKCxKQABaXIOFhIW8yFodACgfykA4DXYId1hAHIAAAFschsWHRYAoMMhAKDCIYACYWVnc3YAKBauAjYWOhY+Fm0AAKHEIm9zLhY0Fm4AZABzoMQi9SFpdACgZiZhIm1tYQDdY2kAbgAAoPIiAKH3AGlvQxZRFmQAZQAAgfcAO29KFksW90BuI3RpbWVzAACgxyJuAPgAUBZjAHkAUmRjAG8CXhYAAAAAYhZyAG4AAKAeI28AcAAAoA0jgAJscHR1dwBuFnEWdRaSFp4W7CFhciRgZgAA4DXYVd0AotkCZW1wc30WhBaJFo0WcQBkoFAibwB0AACgUSJpIm51cwAAoDgi7CF1cwCgFCLxInVhcmUAoKEiYgBsAGUAYgBhAHIAdwBlAGQAZwDlANcAbgCAAWFkaAClFqoWtBZyAHIAbwD3APUMbwB3AG4AYQByAHIAbwB3APMA8xVhI3Jwb29uAAABbHK8FsAWZQBmAPQAHBZpAGcAaAD0AB4WYgHJFs8WawBhAHIAbwD3AJILbwLUFgAAAADYFnIAbgAAoB8jbwBwAACgDCOAAWNvdADhFukW7BYAAXJ55RboFgDgNdi53FVkbAAAoPYp8iFvaxFhAAFkcvMW9xZvAHQAAKDxImkA5qC/JVsSAAFhaP8WAhdyAPIANQNhAPIA1wvhIm5nbGUAoKYpAAFjaQ4XEBd5AF9k5yJyYXJyAKD/JwAJRGFjZGVmZ2xtbm9wcXJzdHV4MRc4F0YXWxcyBF4XaRd5F40XrBe0F78X2RcVGCEYLRg1GEAYAAFEbzUXgRZvAPQA+BUAAWNzPBdCF3UAdABlADuA6QDpQPQhZXIAoG4qAAJhaW95TRdQF1YXWhfyIW9uG2FyAGOgViI7gOoA6kDsIW9uAKBVIk1kbwB0ABdhAAFEcmIXZhdvAHQAAKBSIgDgNdgi3XKhmipuF3QXYQB2AGUAO4DoAOhAZKCWKm8AdAAAoJgqgKGZKmlscwCAF4UXhxfuInRlcnMAoOcjAKATIWSglSpvAHQAAKCXKoABYXBzAJMXlheiF2MAcgATYXQAeQBzogUinxcAAAAAoRdlAHQAAKAFInAAMaADIDMBqRerFwCgBCAAoAUgAAFnc7AXsRdLYXAAAKACIAABZ3C4F7sXbwBuABlhZgAA4DXYVt2AAWFscwDFF8sXzxdyAHOg1SJsAACg4yl1AHMAAKBxKmkAAKG1A2x21RfYF28AbgC1Y/VjAAJjc3V24BfoF/0XEBgAAWlv5BdWF3IAYwAAoFYiaQLuFwAAAADwF+0ADQThIW50AAFnbPUX+Rd0AHIAAKCWKuUhc3MAoJUqgAFhZWkAAxgGGAoYbABzAD1gcwB0AACgXyJ2AESgYSJEAACgeCrwImFyc2wAoOUpAAFEYRkYHRhvAHQAAKBTInIAcgAAoHEpgAFjZGkAJxgqGO0XcgAAoC8hbwD0AIwCAAFhaDEYMhi3YzuA8ADwQAABbXI5GD0YbAA7gOsA60BvAACgrCCAAWNpcABGGEgYSxhsACFgcwD0ACwEAAFlb08YVxhjAHQAYQB0AGkAbwDuABoEbgBlAG4AdABpAGEAbADlADME4Ql1GAAAgRgAAIMYiBgAAAAAoRilGAAAqhgAALsYvhjRGAAA1xgnGWwAbABpAG4AZwBkAG8AdABzAGUA8QBlF3kARGRtImFsZQAAoEAmgAFpbHIAjRiRGJ0Y7CFpZwCgA/tpApcYAAAAAJoYZwAAoAD7aQBnAACgBPsA4DXYI93sIWlnAKAB++whaWcA4GYAagCAAWFsdACvGLIYthh0AACgbSZpAGcAAKAC+24AcwAAoLElbwBmAJJh8AHCGAAAxhhmAADgNdhX3QABYWvJGMwYbADsAGsEdqDUIgCg2SphI3J0aW50AACgDSoAAWFv2hgiGQABY3PeGB8ZsQPnGP0YBRkSGRUZAAAdGbID7xjyGPQY9xj5GAAA+xg7gL0AvUAAoFMhO4C8ALxAAKBVIQCgWSEAoFshswEBGQAAAxkAoFQhAKBWIbQCCxkOGQAAAAAQGTuAvgC+QACgVyEAoFwhNQAAoFghtgEZGQAAGxkAoFohAKBdITgAAKBeIWwAAKBEIHcAbgAAoCIjYwByAADgNdi73IAIRWFiY2RlZmdpamxub3JzdHYARhlKGVoZXhlmGWkZkhmWGZkZnRmgGa0ZxhnLGc8Z4BkjGmygZyIAoIwqgAFjbXAAUBlTGVgZ9SF0ZfVhbQBhAOSgswM6FgCghipyImV2ZQAfYQABaXliGWUZcgBjAB1hM2RvAHQAIWGAoWUibHFzAMYEcBl6GfGhZSLOBAAAdhlsAGEAbgD0AN8EgKF+KmNkbACBGYQZjBljAACgqSpvAHQAb6CAKmyggioAoIQqZeDbIgD+cwAAoJQqcgAA4DXYJN3noGsirATtIWVsAKA3IWMAeQBTZIChdyJFYWoApxmpGasZAKCSKgCgpSoAoKQqAAJFYWVztBm2Gb0ZwhkAoGkicABwoIoq8iFveACgiipxoIgq8aCIKrUZaQBtAACg5yJwAGYAAOA12FjdYQB2AOUAYwIAAWNp0xnWGXIAAKAKIW0AAKFzImVs3BneGQCgjioAoJAqAIM+ADtjZGxxco0E6xn0GfgZ/BkBGgABY2nvGfEZAKCnKnIAAKB6Km8AdAAAoNci0CFhcgCglSl1ImVzdAAAoHwqgAJhZGVscwAKGvQZFhrVBCAa8AEPGgAAFBpwAHIAbwD4AFkZcgAAoHgpcQAAAWxxxAQbGmwAZQBzAPMASRlpAO0A5AQAAWVuJxouGnIjdG5lcXEAAOBpIgD+xQAsGgAFQWFiY2Vma29zeUAaQxpmGmoabRqDGocalhrCGtMacgDyAMwCAAJpbG1yShpOGlAaVBpyAHMA8ABxD2YAvWBpAGwA9AASBQABZHJYGlsaYwB5AEpkAKGUIWN3YBpkGmkAcgAAoEgpAKCtIWEAcgAAoA8h6SFyYyVhgAFhbHIAcxp7Gn8a8iF0c3WgZSZpAHQAAKBlJuwhaXAAoCYg4yFvbgCguSJyAADgNdgl3XMAAAFld4wakRphInJvdwAAoCUpYSJyb3cAAKAmKYACYW1vcHIAnxqjGqcauhq+GnIAcgAAoP8h9CFodACgOyJrAAABbHKsGrMaZSRmdGFycm93AACgqSHpJGdodGFycm93AKCqIWYAAOA12Fnd4iFhcgCgFSCAAWNsdADIGswa0BpyAADgNdi93GEAcwDoAGka8iFvaydhAAFicNca2xr1IWxsAKBDIOghZW4AoBAg4Qr2GgAA/RoAAAgbExsaGwAAIRs7GwAAAAA+G2IbmRuVG6sbAACyG80b0htjAHUAdABlADuA7QDtQAChYyBpeQEbBhtyAGMAO4DuAO5AOGQAAWN4CxsNG3kANWRjAGwAO4ChAKFAAAFmcssCFhsA4DXYJt1yAGEAdgBlADuA7ADsQIChSCFpbm8AJxsyGzYbAAFpbisbLxtuAHQAAKAMKnQAAKAtIuYhaW4AoNwpdABhAACgKSHsIWlnM2GAAWFvcABDG1sbXhuAAWNndABJG0sbWRtyACthgAFlbHAAcQVRG1UbaQBuAOUAyAVhAHIA9AByBWgAMWFmAACgtyJlAGQAtWEAoggiY2ZvdGkbbRt1G3kb4SFyZQCgBSFpAG4AdKAeImkAZQAAoN0pZABvAPQAWxsAoisiY2VscIEbhRuPG5QbYQBsAACguiIAAWdyiRuNG2UAcgDzACMQ4wCCG2EicmhrAACgFyryIW9kAKA8KgACY2dwdJ8boRukG6gbeQBRZG8AbgAvYWYAAOA12FrdYQC5Y3UAZQBzAHQAO4C/AL9AAAFjabUbuRtyAADgNdi+3G4AAKIIIkVkc3bCG8QbyBvQAwCg+SJvAHQAAKD1Inag9CIAoPMiaaBiIOwhZGUpYesB1hsAANkbYwB5AFZkbAA7gO8A70AAA2NmbW9zdeYb7hvyG/Ub+hsFHAABaXnqG+0bcgBjADVhOWRyAADgNdgn3eEhdGg3YnAAZgAA4DXYW93jAf8bAAADHHIAAOA12L/c8iFjeVhk6yFjeVRkAARhY2ZnaGpvcxUcGhwiHCYcKhwtHDAcNRzwIXBhdqC6A/BjAAFleR4cIRzkIWlsN2E6ZHIAAOA12CjdciJlZW4AOGFjAHkARWRjAHkAXGRwAGYAAOA12FzdYwByAADgNdjA3IALQUJFSGFiY2RlZmdoamxtbm9wcnN0dXYAXhxtHHEcdRx5HN8cBx0dHTwd3B3tHfEdAR4EHh0eLB5FHrwewx7hHgkfPR9LH4ABYXJ0AGQcZxxpHHIA8gBvB/IAxQLhIWlsAKAbKeEhcnIAoA4pZ6BmIgCgiyphAHIAAKBiKWMJjRwAAJAcAACVHAAAAAAAAAAAAACZHJwcAACmHKgcrRwAANIc9SF0ZTph7SJwdHl2AKC0KXIAYQDuAFoG4iFkYbtjZwAAoegnZGyhHKMcAKCRKeUAiwYAoIUqdQBvADuAqwCrQHIAgKOQIWJmaGxwc3QAuhy/HMIcxBzHHMoczhxmoOQhcwAAoB8pcwAAoB0p6wCyGnAAAKCrIWwAAKA5KWkAbQAAoHMpbAAAoKIhAKGrKmFl1hzaHGkAbAAAoBkpc6CtKgDgrSoA/oABYWJyAOUc6RztHHIAcgAAoAwpcgBrAACgcicAAWFr8Rz4HGMAAAFla/Yc9xx7YFtgAAFlc/wc/hwAoIspbAAAAWR1Ax0FHQCgjykAoI0pAAJhZXV5Dh0RHRodHB3yIW9uPmEAAWRpFR0YHWkAbAA8YewAowbiAPccO2QAAmNxcnMkHScdLB05HWEAAKA2KXUAbwDyoBwgqhEAAWR1MB00HeghYXIAoGcpcyJoYXIAAKBLKWgAAKCyIQCiZCJmZ3FzRB1FB5Qdnh10AIACYWhscnQATh1WHWUdbB2NHXIicm93AHSgkCFhAOkAzxxhI3Jwb29uAAABZHVeHWId7yF3bgCgvSFwAACgvCHlJGZ0YXJyb3dzAKDHIWkiZ2h0AIABYWhzAHUdex2DHXIicm93APOglCGdBmEAcgBwAG8AbwBuAPMAzgtxAHUAaQBnAGEAcgByAG8A9wBlGugkcmVldGltZXMAoMsi8aFkIk0HAACaHWwAYQBuAPQAXgcAon0qY2Rnc6YdqR2xHbcdYwAAoKgqbwB0AG+gfypyoIEqAKCDKmXg2iIA/nMAAKCTKoACYWRlZ3MAwB3GHcod1h3ZHXAAcAByAG8A+ACmHG8AdAAAoNYicQAAAWdxzx3SHXQA8gBGB2cAdADyAHQcdADyAFMHaQDtAGMHgAFpbHIA4h3mHeod8yFodACgfClvAG8A8gDKBgDgNdgp3UWgdiIAoJEqYQH1Hf4dcgAAAWR1YB35HWygvCEAoGopbABrAACghCVjAHkAWWQAomoiYWNodAweDx4VHhkecgDyAGsdbwByAG4AZQDyAGAW4SFyZACgaylyAGkAAKD6JQABaW8hHiQe5CFvdEBh9SFzdGGgsCPjIWhlAKCwIwACRWFlczMeNR48HkEeAKBoInAAcKCJKvIhb3gAoIkqcaCHKvGghyo0HmkAbQAAoOYiAARhYm5vcHR3elIeXB5fHoUelh6mHqsetB4AAW5yVh5ZHmcAAKDsJ3IAAKD9IXIA6wCwBmcAgAFsbXIAZh52Hnse5SFmdAABYXKIB2weaQBnAGgAdABhAHIAcgBvAPcAkwfhInBzdG8AoPwnaQBnAGgAdABhAHIAcgBvAPcAmgdwI2Fycm93AAABbHKNHpEeZQBmAPQAxhxpImdodAAAoKwhgAFhZmwAnB6fHqIecgAAoIUpAOA12F3ddQBzAACgLSppIm1lcwAAoDQqYQGvHrMecwB0AACgFyLhAIoOZaHKJbkeRhLuIWdlAKDKJWEAcgBsoCgAdAAAoJMpgAJhY2htdADMHs8e1R7bHt0ecgDyAJ0GbwByAG4AZQDyANYWYQByAGSgyyEAoG0pAKAOIHIAaQAAoL8iAANhY2hpcXTrHu8e1QfzHv0eBh/xIXVvAKA5IHIAAOA12MHcbQDloXIi+h4AAPweAKCNKgCgjyoAAWJ19xwBH28AcqAYIACgGiDyIW9rQmEAhDwAO2NkaGlscXJCBhcfxh0gHyQfKB8sHzEfAAFjaRsfHR8AoKYqcgAAoHkqcgBlAOUAkx3tIWVzAKDJIuEhcnIAoHYpdSJlc3QAAKB7KgABUGk1HzkfYQByAACglillocMlAgdfEnIAAAFkdUIfRx9zImhhcgAAoEop6CFhcgCgZikAAWVuTx9WH3IjdG5lcXEAAOBoIgD+xQBUHwAHRGFjZGVmaGlsbm9wc3VuH3Ifoh+rH68ftx+7H74f5h/uH/MfBwj/HwsgxCFvdACgOiIAAmNscHJ5H30fiR+eH3IAO4CvAK9AAAFldIEfgx8AoEImZaAgJ3MAZQAAoCAnc6CmIXQAbwCAoaYhZGx1AJQfmB+cH28AdwDuAHkDZQBmAPQA6gbwAOkO6yFlcgCgriUAAW95ph+qH+0hbWEAoCkqPGThIXNoAKAUIOElc3VyZWRhbmdsZQCgISJyAADgNdgq3W8AAKAnIYABY2RuAMQfyR/bH3IAbwA7gLUAtUBhoiMi0B8AANMf1x9zAPQAKxFpAHIAAKDwKm8AdAA7gLcAt0B1AHMA4qESIh4TAADjH3WgOCIAoCoqYwHqH+0fcAAAoNsq8gB+GnAAbAB1APMACAgAAWRw9x/7H+UhbHMAoKciZgAA4DXYXt0AAWN0AyAHIHIAAOA12MLc8CFvcwCgPiJsobwDECAVIPQiaW1hcACguCJhAPAAEyAADEdMUlZhYmNkZWZnaGlqbG1vcHJzdHV2dzwgRyBmIG0geSCqILgg2iDeIBEhFSEyIUMhTSFQIZwhnyHSIQAiIyKLIrEivyIUIwABZ3RAIEMgAODZIjgD9uBrItIgBwmAAWVsdABNIF8gYiBmAHQAAAFhclMgWCByInJvdwAAoM0h6SRnaHRhcnJvdwCgziEA4NgiOAP24Goi0iBfCekkZ2h0YXJyb3cAoM8hAAFEZHEgdSDhIXNoAKCvIuEhc2gAoK4igAJiY25wdACCIIYgiSCNIKIgbABhAACgByL1IXRlRGFnAADgICLSIACiSSJFaW9wlSCYIJwgniAA4HAqOANkAADgSyI4A3MASWFyAG8A+AAyCnUAcgBhoG4mbADzoG4mmwjzAa8gAACzIHAAO4CgAKBAbQBwAOXgTiI4AyoJgAJhZW91eQDBIMogzSDWINkg8AHGIAAAyCAAoEMqbwBuAEhh5CFpbEZhbgBnAGSgRyJvAHQAAOBtKjgDcAAAoEIqPWThIXNoAKATIACjYCJBYWRxc3jpIO0g+SD+IAIhDCFyAHIAAKDXIXIAAAFocvIg9SBrAACgJClvoJch9wAGD28AdAAA4FAiOAN1AGkA9gC7CAABZWkGIQohYQByAACgKCntAN8I6SFzdPOgBCLlCHIAAOA12CvdAAJFZXN0/wgcISshLiHxoXEiIiEAABMJ8aFxIgAJAAAnIWwAYQBuAPQAEwlpAO0AGQlyoG8iAKBvIoABQWFwADghOyE/IXIA8gBeIHIAcgAAoK4hYQByAACg8ipzogsiSiEAAAAAxwtkoPwiAKD6ImMAeQBaZIADQUVhZGVzdABcIV8hYiFmIWkhkyGWIXIA8gBXIADgZiI4A3IAcgAAoJohcgAAoCUggKFwImZxcwBwIYQhjiF0AAABYXJ1IXohcgByAG8A9wBlIWkAZwBoAHQAYQByAHIAbwD3AD4h8aFwImAhAACKIWwAYQBuAPQAZwlz4H0qOAMAoG4iaQDtAG0JcqBuImkA5aDqIkUJaQDkADoKAAFwdKMhpyFmAADgNdhf3YCBrAA7aW4AriGvIcchrEBuAIChCSJFZHYAtyG6Ib8hAOD5IjgDbwB0AADg9SI4A+EB1gjEIcYhAKD3IgCg9iJpAHagDCLhAagJzyHRIQCg/iIAoP0igAFhb3IA2CHsIfEhcgCAoSYiYXN0AOAh5SHpIWwAbABlAOwAywhsAADg/SrlIADgAiI4A2wiaW50AACgFCrjoYAi9yEAAPohdQDlAJsJY+CvKjgDZaCAIvEAkwkAAkFhaXQHIgoiFyIeInIA8gBsIHIAcgAAoZshY3cRIhQiAOAzKTgDAOCdITgDZyRodGFycm93AACgmyFyAGkA5aDrIr4JgANjaGltcHF1AC8iPCJHIpwhTSJQIloigKGBImNlcgA2Iv0JOSJ1AOUABgoA4DXYw9zvIXJ0bQKdIQAAAABEImEAcgDhAOEhbQBloEEi8aBEIiYKYQDyAMsIcwB1AAABYnBWIlgi5QDUCeUA3wmAAWJjcABgInMieCKAoYQiRWVzAGci7glqIgDgxSo4A2UAdABl4IIi0iBxAPGgiCJoImMAZaCBIvEA/gmAoYUiRWVzAH8iFgqCIgDgxio4A2UAdABl4IMi0iBxAPGgiSKAIgACZ2lscpIilCKaIpwi7AAMCWwAZABlADuA8QDxQOcAWwlpI2FuZ2xlAAABbHKkIqoi5SFmdGWg6iLxAEUJaSJnaHQAZaDrIvEAvgltoL0DAKEjAGVzuCK8InIAbwAAoBYhcAAAoAcggARESGFkZ2lscnMAziLSItYi2iLeIugi7SICIw8j4SFzaACgrSLhIXJyAKAEKXAAAOBNItIg4SFzaACgrCIAAWV04iLlIgDgZSLSIADgPgDSIG4iZmluAACg3imAAUFldADzIvci+iJyAHIAAKACKQDgZCLSIHLgPADSIGkAZQAA4LQi0iAAAUF0BiMKI3IAcgAAoAMp8iFpZQDgtSLSIGkAbQAA4Dwi0iCAAUFhbgAaIx4jKiNyAHIAAKDWIXIAAAFociMjJiNrAACgIylvoJYh9wD/DuUhYXIAoCcpUxJqFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVCMAAF4jaSN/I4IjjSOeI8AUAAAAAKYjwCMAANoj3yMAAO8jHiQvJD8kRCQAAWNzVyNsFHUAdABlADuA8wDzQAABaXlhI2cjcgBjoJoiO4D0APRAPmSAAmFiaW9zAHEjdCN3I3EBeiNzAOgAdhTsIWFjUWF2AACgOCrvIWxkAKC8KewhaWdTYQABY3KFI4kjaQByAACgvykA4DXYLN1vA5QjAAAAAJYjAACcI24A22JhAHYAZQA7gPIA8kAAoMEpAAFibaEjjAphAHIAAKC1KQACYWNpdKwjryO6I70jcgDyAFkUAAFpcrMjtiNyAACgvinvIXNzAKC7KW4A5QDZCgCgwCmAAWFlaQDFI8gjyyNjAHIATWFnAGEAyWOAAWNkbgDRI9Qj1iPyIW9uv2MAoLYpdQDzAHgBcABmAADgNdhg3YABYWVsAOQj5yPrI3IAAKC3KXIAcAAAoLkpdQDzAHwBAKMoImFkaW9zdvkj/CMPJBMkFiQbJHIA8gBeFIChXSplZm0AAyQJJAwkcgBvoDQhZgAAoDQhO4CqAKpAO4C6ALpA5yFvZgCgtiJyAACgVipsIm9wZQAAoFcqAKBbKoABY2xvACMkJSQrJPIACCRhAHMAaAA7gPgA+EBsAACgmCJpAGwBMyQ4JGQAZQA7gPUA9UBlAHMAYaCXInMAAKA2Km0AbAA7gPYA9kDiIWFyAKA9I+EKXiQAAHokAAB8JJQkAACYJKkkAAAAALUkEQsAAPAkAAAAAAQleiUAAIMlcgCAoSUiYXN0AGUkbyQBCwCBtgA7bGokayS2QGwAZQDsABgDaQJ1JAAAAAB4JG0AAKDzKgCg/Sp5AD9kcgCAAmNpbXB0AIUkiCSLJJkSjyRuAHQAJWBvAGQALmBpAGwAAKAwIOUhbmsAoDEgcgAA4DXYLd2AAWltbwCdJKAkpCR2oMYD1WNtAGEA9AD+B24AZQAAoA4m9KHAA64kAAC0JGMjaGZvcmsAAKDUItZjAAFhdbgkxCRuAAABY2u9JMIkawBooA8hAKAOIfYAaRpzAACkKwBhYmNkZW1zdNMkIRPXJNsk4STjJOck6yTjIWlyAKAjKmkAcgAAoCIqAAFvdYsW3yQAoCUqAKByKm4AO4CxALFAaQBtAACgJip3AG8AAKAnKoABaXB1APUk+iT+JO4idGludACgFSpmAADgNdhh3W4AZAA7gKMAo0CApHoiRWFjZWlub3N1ABMlFSUYJRslTCVRJVklSSV1JQCgsypwAACgtyp1AOUAPwtjoK8qgKJ6ImFjZW5zACclLSU0JTYlSSVwAHAAcgBvAPgAFyV1AHIAbAB5AGUA8QA/C/EAOAuAAWFlcwA8JUElRSXwInByb3gAoLkqcQBxAACgtSppAG0AAKDoImkA7QBEC20AZQDzoDIgIguAAUVhcwBDJVclRSXwAEAlgAFkZnAATwtfJXElgAFhbHMAZSVpJW0l7CFhcgCgLiPpIW5lAKASI/UhcmYAoBMjdKAdIu8AWQvyIWVsAKCwIgABY2l9JYElcgAA4DXYxdzIY24iY3NwAACgCCAAA2Zpb3BzdZElKxuVJZolnyWkJXIAAOA12C7dcABmAADgNdhi3XIiaW1lAACgVyBjAHIAAOA12MbcgAFhZW8AqiW6JcAldAAAAWVpryW2JXIAbgBpAG8AbgDzABkFbgB0AACgFipzAHQAZaA/APEACRj0AG0LgApBQkhhYmNkZWZoaWxtbm9wcnN0dXgA4yXyJfYl+iVpJpAmpia9JtUm5ib4JlonaCdxJ3UnnietJ7EnyCfiJ+cngAFhcnQA6SXsJe4lcgDyAJkM8gD6AuEhaWwAoBwpYQByAPIA3BVhAHIAAKBkKYADY2RlbnFydAAGJhAmEyYYJiYmKyZaJgABZXUKJg0mAOA9IjEDdABlAFVhaQDjACAN7SJwdHl2AKCzKWcAgKHpJ2RlbAAgJiImJCYAoJIpAKClKeUA9wt1AG8AO4C7ALtAcgAApZIhYWJjZmhscHN0dz0mQCZFJkcmSiZMJk4mUSZVJlgmcAAAoHUpZqDlIXMAAKAgKQCgMylzAACgHinrALka8ACVHmwAAKBFKWkAbQAAoHQpbAAAoKMhAKCdIQABYWleJmImaQBsAACgGilvAG6gNiJhAGwA8wB2C4ABYWJyAG8mciZ2JnIA8gAvEnIAawAAoHMnAAFha3omgSZjAAABZWt/JoAmfWBdYAABZXOFJocmAKCMKWwAAAFkdYwmjiYAoI4pAKCQKQACYWV1eZcmmiajJqUm8iFvbllhAAFkaZ4moSZpAGwAV2HsAA8M4gCAJkBkAAJjbHFzrSawJrUmuiZhAACgNylkImhhcgAAoGkpdQBvAPKgHSCjAWgAAKCzIYABYWNnAMMm0iaUC2wAgKEcIWlwcwDLJs4migxuAOUAoAxhAHIA9ADaC3QAAKCtJYABaWxyANsm3ybjJvMhaHQAoH0pbwBvAPIANgwA4DXYL90AAWFv6ib1JnIAAAFkde8m8SYAoMEhbKDAIQCgbCl2oMED8WOAAWducwD+Jk4nUCdoAHQAAANhaGxyc3QKJxInISc1Jz0nRydyInJvdwB0oJIhYQDpAFYmYSNycG9vbgAAAWR1GiceJ28AdwDuAPAmcAAAoMAh5SFmdAABYWgnJy0ncgByAG8AdwDzAAkMYQByAHAAbwBvAG4A8wATBGklZ2h0YXJyb3dzAACgySFxAHUAaQBnAGEAcgByAG8A9wBZJugkcmVldGltZXMAoMwiZwDaYmkAbgBnAGQAbwB0AHMAZQDxABwYgAFhaG0AYCdjJ2YncgDyAAkMYQDyABMEAKAPIG8idXN0AGGgsSPjIWhlAKCxI+0haWQAoO4qAAJhYnB0fCeGJ4knmScAAW5ygCeDJ2cAAKDtJ3IAAKD+IXIA6wAcDIABYWZsAI8nkieVJ3IAAKCGKQDgNdhj3XUAcwAAoC4qaSJtZXMAAKA1KgABYXCiJ6gncgBnoCkAdAAAoJQp7yJsaW50AKASKmEAcgDyADwnAAJhY2hxuCe8J6EMwCfxIXVvAKA6IHIAAOA12MfcAAFidYAmxCdvAPKgGSCoAYABaGlyAM4n0ifWJ3IAZQDlAE0n7SFlcwCgyiJpAIChuSVlZmwAXAxjEt4n9CFyaQCgzinsInVoYXIAoGgpAKAeIWENBSgJKA0oSyhVKIYoAACLKLAoAAAAAOMo5ygAABApJCkxKW0pcSmHKaYpAACYKgAAAACxKmMidXRlAFthcQB1AO8ABR+ApHsiRWFjZWlucHN5ABwoHignKCooLygyKEEoRihJKACgtCrwASMoAAAlKACguCpvAG4AYWF1AOUAgw1koLAqaQBsAF9hcgBjAF1hgAFFYXMAOCg6KD0oAKC2KnAAAKC6KmkAbQAAoOki7yJsaW50AKATKmkA7QCIDUFkbwB0AGKixSKRFgAAAABTKACgZiqAA0FhY21zdHgAYChkKG8ocyh1KHkogihyAHIAAKDYIXIAAAFocmkoayjrAJAab6CYIfcAzAd0ADuApwCnQGkAO2D3IWFyAKApKW0AAAFpbn4ozQBuAHUA8wDOAHQAAKA2J3IA7+A12DDdIxkAAmFjb3mRKJUonSisKHIAcAAAoG8mAAFoeZkonChjAHkASWRIZHIAdABtAqUoAAAAAKgoaQDkAFsPYQByAGEA7ABsJDuArQCtQAABZ22zKLsobQBhAAChwwNmdroouijCY4CjPCJkZWdsbnByAMgozCjPKNMo1yjaKN4obwB0AACgairxoEMiCw5FoJ4qAKCgKkWgnSoAoJ8qZQAAoEYi7CF1cwCgJCrhIXJyAKByKWEAcgDyAPwMAAJhZWl07Sj8KAEpCCkAAWxz8Sj4KGwAcwBlAHQAbQDpAH8oaABwAACgMyrwImFyc2wAoOQpAAFkbFoPBSllAACgIyNloKoqc6CsKgDgrCoA/oABZmxwABUpGCkfKfQhY3lMZGKgLwBhoMQpcgAAoD8jZgAA4DXYZN1hAAABZHIoKRcDZQBzAHWgYCZpAHQAAKBgJoABY3N1ADYpRilhKQABYXU6KUApcABzoJMiAOCTIgD+cABzoJQiAOCUIgD+dQAAAWJwSylWKQChjyJlcz4NUCllAHQAZaCPIvEAPw0AoZAiZXNIDVspZQB0AGWgkCLxAEkNAKGhJWFmZilbBHIAZQFrKVwEAKChJWEAcgDyAAMNAAJjZW10dyl7KX8pgilyAADgNdjI3HQAbQDuAM4AaQDsAAYpYQByAOYAVw0AAWFyiimOKXIA5qAGJhESAAFhbpIpoylpImdodAAAAWVwmSmgKXAAcwBpAGwAbwDuANkXaADpAKAkcwCvYIACYmNtbnAArin8KY4NJSooKgCkgiJFZGVtbnByc7wpvinCKcgpzCnUKdgp3CkAoMUqbwB0AACgvSpkoIYibwB0AACgwyr1IWx0AKDBKgABRWXQKdIpAKDLKgCgiiLsIXVzAKC/KuEhcnIAoHkpgAFlaXUA4inxKfQpdAAAoYIiZW7oKewpcQDxoIYivSllAHEA8aCKItEpbQAAoMcqAAFicPgp+ikAoNUqAKDTKmMAgKJ7ImFjZW5zAAcqDSoUKhYqRihwAHAAcgBvAPgAIyh1AHIAbAB5AGUA8QCDDfEAfA2AAWFlcwAcKiIqPShwAHAAcgBvAPgAPChxAPEAOShnAACgaiYApoMiMTIzRWRlaGxtbnBzPCo/KkIqRSpHKlIqWCpjKmcqaypzKncqO4C5ALlAO4CyALJAO4CzALNAAKDGKgABb3NLKk4qdAAAoL4qdQBiAACg2CpkoIcibwB0AACgxCpzAAABb3VdKmAqbAAAoMknYgAAoNcq4SFycgCgeyn1IWx0AKDCKgABRWVvKnEqAKDMKgCgiyLsIXVzAKDAKoABZWl1AH0qjCqPKnQAAKGDImVugyqHKnEA8aCHIkYqZQBxAPGgiyJwKm0AAKDIKgABYnCTKpUqAKDUKgCg1iqAAUFhbgCdKqEqrCpyAHIAAKDZIXIAAAFocqYqqCrrAJUab6CZIfcAxQf3IWFyAKAqKWwAaQBnADuA3wDfQOELzyrZKtwq6SrsKvEqAAD1KjQrAAAAAAAAAAAAAEwrbCsAAHErvSsAAAAAAADRK3IC1CoAAAAA2CrnIWV0AKAWI8RjcgDrAOUKgAFhZXkA4SrkKucq8iFvbmVh5CFpbGNhQmRvAPQAIg5sInJlYwAAoBUjcgAA4DXYMd0AAmVpa2/7KhIrKCsuK/IBACsAAAkrZQAAATRm6g0EK28AcgDlAOsNYQBzorgDECsAAAAAEit5AG0A0WMAAWNuFislK2sAAAFhcxsrIStwAHAAcgBvAPgAFw5pAG0AAKA8InMA8AD9DQABYXMsKyEr8AAXDnIAbgA7gP4A/kDsATgrOyswG2QA5QBnAmUAcwCAgdcAO2JkAEMrRCtJK9dAYaCgInIAAKAxKgCgMCqAAWVwcwBRK1MraSvhAAkh4qKkIlsrXysAAAAAYytvAHQAAKA2I2kAcgAAoPEqb+A12GXdcgBrAACg2irhAHgociJpbWUAAKA0IIABYWlwAHYreSu3K2QA5QC+DYADYWRlbXBzdACFK6MrmiunK6wrsCuzK24iZ2xlAACitSVkbHFykCuUK5ornCvvIXduAKC/JeUhZnRloMMl8QACBwCgXCJpImdodABloLkl8QBdDG8AdAAAoOwlaSJudXMAAKA6KuwhdXMAoDkqYgAAoM0p6SFtZQCgOyrlInppdW0AoOIjgAFjaHQAwivKK80rAAFyecYrySsA4DXYydxGZGMAeQBbZPIhb2tnYQABaW/UK9creAD0ANERaCJlYWQAAAFsct4r5ytlAGYAdABhAHIAcgBvAPcAXQbpJGdodGFycm93AKCgIQAJQUhhYmNkZmdobG1vcHJzdHV3CiwNLBEsHSwnLDEsQCxLLFIsYix6LIQsjyzLLOgs7Sz/LAotcgDyAAkDYQByAACgYykAAWNyFSwbLHUAdABlADuA+gD6QPIACQ1yAOMBIywAACUseQBeZHYAZQBtYQABaXkrLDAscgBjADuA+wD7QENkgAFhYmgANyw6LD0scgDyANEO7CFhY3FhYQDyAOAOAAFpckQsSCzzIWh0AKB+KQDgNdgy3XIAYQB2AGUAO4D5APlAYQFWLF8scgAAAWxyWixcLACgvyEAoL4hbABrAACggCUAAWN0Zix2LG8CbCwAAAAAcyxyAG4AZaAcI3IAAKAcI28AcAAAoA8jcgBpAACg+CUAAWFsfiyBLGMAcgBrYTuAqACoQAABZ3CILIssbwBuAHNhZgAA4DXYZt0AA2FkaGxzdZksniynLLgsuyzFLHIAcgBvAPcACQ1vAHcAbgBhAHIAcgBvAPcA2A5hI3Jwb29uAAABbHKvLLMsZQBmAPQAWyxpAGcAaAD0AF0sdQDzAKYOaQAAocUDaGzBLMIs0mNvAG4AxWPwI2Fycm93cwCgyCGAAWNpdADRLOEs5CxvAtcsAAAAAN4scgBuAGWgHSNyAACgHSNvAHAAAKAOI24AZwBvYXIAaQAAoPklYwByAADgNdjK3IABZGlyAPMs9yz6LG8AdAAAoPAi7CFkZWlhaQBmoLUlAKC0JQABYW0DLQYtcgDyAMosbAA7gPwA/EDhIm5nbGUAoKcpgAdBQkRhY2RlZmxub3Byc3oAJy0qLTAtNC2bLZ0toS2/LcMtxy3TLdgt3C3gLfwtcgDyABADYQByAHag6CoAoOkqYQBzAOgA/gIAAW5yOC08LechcnQAoJwpgANla25wcnN0AJkpSC1NLVQtXi1iLYItYQBwAHAA4QAaHG8AdABoAGkAbgDnAKEXgAFoaXIAoSmzJFotbwBwAPQAdCVooJUh7wD4JgABaXVmLWotZwBtAOEAuygAAWJwbi14LXMjZXRuZXEAceCKIgD+AODLKgD+cyNldG5lcQBx4IsiAP4A4MwqAP4AAWhyhi2KLWUAdADhABIraSNhbmdsZQAAAWxyki2WLeUhZnQAoLIiaSJnaHQAAKCzInkAMmThIXNoAKCiIoABZWxyAKcttC24LWKiKCKuLQAAAACyLWEAcgAAoLsicQAAoFoi7CFpcACg7iIAAWJ0vC1eD2EA8gBfD3IAAOA12DPddAByAOkAlS1zAHUAAAFicM0t0C0A4IIi0iAA4IMi0iBwAGYAAOA12GfdcgBvAPAAWQt0AHIA6QCaLQABY3XkLegtcgAA4DXYy9wAAWJw7C30LW4AAAFFZXUt8S0A4IoiAP5uAAABRWV/LfktAOCLIgD+6SJnemFnAKCaKYADY2Vmb3BycwANLhAuJS4pLiMuLi40LukhcmN1YQABZGkULiEuAAFiZxguHC5hAHIAAKBfKmUAcaAnIgCgWSLlIXJwAKAYIXIAAOA12DTdcABmAADgNdho3WWgQCJhAHQA6ABqD2MAcgAA4DXYzNzjCuQRUC4AAFQuAABYLmIuAAAAAGMubS5wLnQuAAAAAIguki4AAJouJxIqEnQAcgDpAB0ScgAA4DXYNd0AAUFhWy5eLnIA8gDnAnIA8gCTB75jAAFBYWYuaS5yAPIA4AJyAPIAjAdhAPAAeh5pAHMAAKD7IoABZHB0APgReS6DLgABZmx9LoAuAOA12GnddQDzAP8RaQBtAOUABBIAAUFhiy6OLnIA8gDuAnIA8gCaBwABY3GVLgoScgAA4DXYzdwAAXB0nS6hLmwAdQDzACUScgDpACASAARhY2VmaW9zdbEuvC7ELsguzC7PLtQu2S5jAAABdXm2LrsudABlADuA/QD9QE9kAAFpecAuwy5yAGMAd2FLZG4AO4ClAKVAcgAA4DXYNt1jAHkAV2RwAGYAAOA12GrdYwByAADgNdjO3AABY23dLt8ueQBOZGwAO4D/AP9AAAVhY2RlZmhpb3N38y73Lv8uAi8MLxAvEy8YLx0vIi9jInV0ZQB6YQABYXn7Lv4u8iFvbn5hN2RvAHQAfGEAAWV0Bi8KL3QAcgDmAB8QYQC2Y3IAAOA12DfdYwB5ADZk5yJyYXJyAKDdIXAAZgAA4DXYa91jAHIAAOA12M/cAAFqbiYvKC8AoA0gagAAoAwg");var S_={};Object.defineProperty(S_,"__esModule",{value:!0});S_.xmlDecodeTree=void 0;const loe=tS;S_.xmlDecodeTree=(0,loe.decodeBase64)("AAJhZ2xxBwARABMAFQBtAg0AAAAAAA8AcAAmYG8AcwAnYHQAPmB0ADxg9SFvdCJg");var rS={};Object.defineProperty(rS,"__esModule",{value:!0});rS.BinTrieFlags=void 0;var QF;(function(r){r[r.VALUE_LENGTH=49152]="VALUE_LENGTH",r[r.FLAG13=8192]="FLAG13",r[r.BRANCH_LENGTH=8064]="BRANCH_LENGTH",r[r.JUMP_TABLE=127]="JUMP_TABLE"})(QF||(rS.BinTrieFlags=QF={}));(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.xmlDecodeTree=r.htmlDecodeTree=r.replaceCodePoint=r.fromCodePoint=r.decodeCodePoint=r.EntityDecoder=r.DecodingMode=void 0,r.determineBranch=k,r.decodeHTML=W,r.decodeHTMLAttribute=z,r.decodeHTMLStrict=$,r.decodeXML=te;const e=I3,t=T_,n=S_,i=rS;var s;(function(Y){Y[Y.NUM=35]="NUM",Y[Y.SEMI=59]="SEMI",Y[Y.EQUALS=61]="EQUALS",Y[Y.ZERO=48]="ZERO",Y[Y.NINE=57]="NINE",Y[Y.LOWER_A=97]="LOWER_A",Y[Y.LOWER_F=102]="LOWER_F",Y[Y.LOWER_X=120]="LOWER_X",Y[Y.LOWER_Z=122]="LOWER_Z",Y[Y.UPPER_A=65]="UPPER_A",Y[Y.UPPER_F=70]="UPPER_F",Y[Y.UPPER_Z=90]="UPPER_Z"})(s||(s={}));const a=32;function o(Y){return Y>=s.ZERO&&Y<=s.NINE}function u(Y){return Y>=s.UPPER_A&&Y<=s.UPPER_F||Y>=s.LOWER_A&&Y<=s.LOWER_F}function f(Y){return Y>=s.UPPER_A&&Y<=s.UPPER_Z||Y>=s.LOWER_A&&Y<=s.LOWER_Z||o(Y)}function g(Y){return Y===s.EQUALS||f(Y)}var y;(function(Y){Y[Y.EntityStart=0]="EntityStart",Y[Y.NumericStart=1]="NumericStart",Y[Y.NumericDecimal=2]="NumericDecimal",Y[Y.NumericHex=3]="NumericHex",Y[Y.NamedEntity=4]="NamedEntity"})(y||(y={}));var A;(function(Y){Y[Y.Legacy=0]="Legacy",Y[Y.Strict=1]="Strict",Y[Y.Attribute=2]="Attribute"})(A||(r.DecodingMode=A={}));class C{constructor(ce,oe,Me){this.decodeTree=ce,this.emitCodePoint=oe,this.errors=Me,this.state=y.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=A.Strict}startEntity(ce){this.decodeMode=ce,this.state=y.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(ce,oe){switch(this.state){case y.EntityStart:return ce.charCodeAt(oe)===s.NUM?(this.state=y.NumericStart,this.consumed+=1,this.stateNumericStart(ce,oe+1)):(this.state=y.NamedEntity,this.stateNamedEntity(ce,oe));case y.NumericStart:return this.stateNumericStart(ce,oe);case y.NumericDecimal:return this.stateNumericDecimal(ce,oe);case y.NumericHex:return this.stateNumericHex(ce,oe);case y.NamedEntity:return this.stateNamedEntity(ce,oe)}}stateNumericStart(ce,oe){return oe>=ce.length?-1:(ce.charCodeAt(oe)|a)===s.LOWER_X?(this.state=y.NumericHex,this.consumed+=1,this.stateNumericHex(ce,oe+1)):(this.state=y.NumericDecimal,this.stateNumericDecimal(ce,oe))}stateNumericHex(ce,oe){for(;oe<ce.length;){const Me=ce.charCodeAt(oe);if(o(Me)||u(Me)){const ze=Me<=s.NINE?Me-s.ZERO:(Me|a)-s.LOWER_A+10;this.result=this.result*16+ze,this.consumed++,oe++}else return this.emitNumericEntity(Me,3)}return-1}stateNumericDecimal(ce,oe){for(;oe<ce.length;){const Me=ce.charCodeAt(oe);if(o(Me))this.result=this.result*10+(Me-s.ZERO),this.consumed++,oe++;else return this.emitNumericEntity(Me,2)}return-1}emitNumericEntity(ce,oe){var Me;if(this.consumed<=oe)return(Me=this.errors)===null||Me===void 0||Me.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(ce===s.SEMI)this.consumed+=1;else if(this.decodeMode===A.Strict)return 0;return this.emitCodePoint((0,e.replaceCodePoint)(this.result),this.consumed),this.errors&&(ce!==s.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(ce,oe){const{decodeTree:Me}=this;let ze=Me[this.treeIndex],Ve=(ze&i.BinTrieFlags.VALUE_LENGTH)>>14;for(;oe<ce.length;){if(Ve===0&&ze&i.BinTrieFlags.FLAG13){const gt=(ze&i.BinTrieFlags.BRANCH_LENGTH)>>7,At=ze&i.BinTrieFlags.JUMP_TABLE;if(oe+gt>ce.length)return-1;if(ce.charCodeAt(oe)!==At)return this.result===0?0:this.emitNotTerminatedNamedEntity();oe++,this.excess++;const Tt=gt-1;for(let Ut=1;Ut<gt;Ut+=2){const xr=Me[this.treeIndex+1+(Ut-1>>1)],Er=xr&255;if(ce.charCodeAt(oe)!==Er)return this.result===0?0:this.emitNotTerminatedNamedEntity();oe++,this.excess++;const Jr=xr>>8&255;if(Ut+1<gt){if(ce.charCodeAt(oe)!==Jr)return this.result===0?0:this.emitNotTerminatedNamedEntity();oe++,this.excess++}}this.treeIndex+=1+(Tt+1>>1),ze=Me[this.treeIndex],Ve=(ze&i.BinTrieFlags.VALUE_LENGTH)>>14}if(oe>=ce.length)break;const lt=ce.charCodeAt(oe);if(lt===s.SEMI&&Ve!==0&&ze&i.BinTrieFlags.FLAG13)return this.emitNamedEntityData(this.treeIndex,Ve,this.consumed+this.excess);if(this.treeIndex=k(Me,ze,this.treeIndex+Math.max(1,Ve),lt),this.treeIndex<0)return this.result===0||this.decodeMode===A.Attribute&&(Ve===0||g(lt))?0:this.emitNotTerminatedNamedEntity();if(ze=Me[this.treeIndex],Ve=(ze&i.BinTrieFlags.VALUE_LENGTH)>>14,Ve!==0){if(lt===s.SEMI)return this.emitNamedEntityData(this.treeIndex,Ve,this.consumed+this.excess);this.decodeMode!==A.Strict&&!(ze&i.BinTrieFlags.FLAG13)&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}oe++,this.excess++}return-1}emitNotTerminatedNamedEntity(){var ce;const{result:oe,decodeTree:Me}=this,ze=(Me[oe]&i.BinTrieFlags.VALUE_LENGTH)>>14;return this.emitNamedEntityData(oe,ze,this.consumed),(ce=this.errors)===null||ce===void 0||ce.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(ce,oe,Me){const{decodeTree:ze}=this;return this.emitCodePoint(oe===1?ze[ce]&~(i.BinTrieFlags.VALUE_LENGTH|i.BinTrieFlags.FLAG13):ze[ce+1],Me),oe===3&&this.emitCodePoint(ze[ce+2],Me),Me}end(){var ce;switch(this.state){case y.NamedEntity:return this.result!==0&&(this.decodeMode!==A.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case y.NumericDecimal:return this.emitNumericEntity(0,2);case y.NumericHex:return this.emitNumericEntity(0,3);case y.NumericStart:return(ce=this.errors)===null||ce===void 0||ce.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case y.EntityStart:return 0}}}r.EntityDecoder=C;function M(Y){let ce="";const oe=new C(Y,Me=>ce+=(0,e.fromCodePoint)(Me));return function(ze,Ve){let lt=0,gt=0;for(;(gt=ze.indexOf("&",gt))>=0;){ce+=ze.slice(lt,gt),oe.startEntity(Ve);const Tt=oe.write(ze,gt+1);if(Tt<0){lt=gt+oe.end();break}lt=gt+Tt,gt=Tt===0?lt+1:lt}const At=ce+ze.slice(lt);return ce="",At}}function k(Y,ce,oe,Me){const ze=(ce&i.BinTrieFlags.BRANCH_LENGTH)>>7,Ve=ce&i.BinTrieFlags.JUMP_TABLE;if(ze===0)return Ve!==0&&Me===Ve?oe:-1;if(Ve){const Tt=Me-Ve;return Tt<0||Tt>=ze?-1:Y[oe+Tt]-1}const lt=ze+1>>1;let gt=0,At=ze-1;for(;gt<=At;){const Tt=gt+At>>>1,Ut=Tt>>1,Er=Y[oe+Ut]>>(Tt&1)*8&255;if(Er<Me)gt=Tt+1;else if(Er>Me)At=Tt-1;else return Y[oe+lt+Tt]}return-1}const D=M(t.htmlDecodeTree),V=M(n.xmlDecodeTree);function W(Y,ce=A.Legacy){return D(Y,ce)}function z(Y){return D(Y,A.Attribute)}function $(Y){return D(Y,A.Strict)}function te(Y){return V(Y,A.Strict)}var le=I3;Object.defineProperty(r,"decodeCodePoint",{enumerable:!0,get:function(){return le.decodeCodePoint}}),Object.defineProperty(r,"fromCodePoint",{enumerable:!0,get:function(){return le.fromCodePoint}}),Object.defineProperty(r,"replaceCodePoint",{enumerable:!0,get:function(){return le.replaceCodePoint}});var _e=T_;Object.defineProperty(r,"htmlDecodeTree",{enumerable:!0,get:function(){return _e.htmlDecodeTree}});var se=S_;Object.defineProperty(r,"xmlDecodeTree",{enumerable:!0,get:function(){return se.xmlDecodeTree}})})(b7);var Gv={};Object.defineProperty(Gv,"__esModule",{value:!0});function coe(r,e){if(r==null)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.indexOf(n)!==-1)continue;t[n]=r[n]}return t}class pd{constructor(e,t,n){this.line=void 0,this.column=void 0,this.index=void 0,this.line=e,this.column=t,this.index=n}}class uC{constructor(e,t){this.start=void 0,this.end=void 0,this.filename=void 0,this.identifierName=void 0,this.start=e,this.end=t}}function jo(r,e){const{line:t,column:n,index:i}=r;return new pd(t,n+e,i+e)}const e4="BABEL_PARSER_SOURCETYPE_MODULE_REQUIRED";var uoe={ImportMetaOutsideModule:{message:`import.meta may appear only with 'sourceType: "module"'`,code:e4},ImportOutsideModule:{message:`'import' and 'export' may appear only with 'sourceType: "module"'`,code:e4}};const t4={ArrayPattern:"array destructuring pattern",AssignmentExpression:"assignment expression",AssignmentPattern:"assignment expression",ArrowFunctionExpression:"arrow function expression",ConditionalExpression:"conditional expression",CatchClause:"catch clause",ForOfStatement:"for-of statement",ForInStatement:"for-in statement",ForStatement:"for-loop",FormalParameters:"function parameter list",Identifier:"identifier",ImportSpecifier:"import specifier",ImportDefaultSpecifier:"import default specifier",ImportNamespaceSpecifier:"import namespace specifier",ObjectPattern:"object destructuring pattern",ParenthesizedExpression:"parenthesized expression",RestElement:"rest element",UpdateExpression:{true:"prefix operation",false:"postfix operation"},VariableDeclarator:"variable declaration",YieldExpression:"yield expression"},ow=r=>r.type==="UpdateExpression"?t4.UpdateExpression[`${r.prefix}`]:t4[r.type];var hoe={AccessorIsGenerator:({kind:r})=>`A ${r}ter cannot be a generator.`,ArgumentsInClass:"'arguments' is only allowed in functions and class methods.",AsyncFunctionInSingleStatementContext:"Async functions can only be declared at the top level or inside a block.",AwaitBindingIdentifier:"Can not use 'await' as identifier inside an async function.",AwaitBindingIdentifierInStaticBlock:"Can not use 'await' as identifier inside a static block.",AwaitExpressionFormalParameter:"'await' is not allowed in async function parameters.",AwaitUsingNotInAsyncContext:"'await using' is only allowed within async functions and at the top levels of modules.",AwaitNotInAsyncContext:"'await' is only allowed within async functions and at the top levels of modules.",BadGetterArity:"A 'get' accessor must not have any formal parameters.",BadSetterArity:"A 'set' accessor must have exactly one formal parameter.",BadSetterRestParameter:"A 'set' accessor function argument must not be a rest parameter.",ConstructorClassField:"Classes may not have a field named 'constructor'.",ConstructorClassPrivateField:"Classes may not have a private field named '#constructor'.",ConstructorIsAccessor:"Class constructor may not be an accessor.",ConstructorIsAsync:"Constructor can't be an async function.",ConstructorIsGenerator:"Constructor can't be a generator.",DeclarationMissingInitializer:({kind:r})=>`Missing initializer in ${r} declaration.`,DecoratorArgumentsOutsideParentheses:"Decorator arguments must be moved inside parentheses: use '@(decorator(args))' instead of '@(decorator)(args)'.",DecoratorBeforeExport:"Decorators must be placed *before* the 'export' keyword. Remove the 'decoratorsBeforeExport: true' option to use the 'export @decorator class {}' syntax.",DecoratorsBeforeAfterExport:"Decorators can be placed *either* before or after the 'export' keyword, but not in both locations at the same time.",DecoratorConstructor:"Decorators can't be used with a constructor. Did you mean '@dec class { ... }'?",DecoratorExportClass:"Decorators must be placed *after* the 'export' keyword. Remove the 'decoratorsBeforeExport: false' option to use the '@decorator export class {}' syntax.",DecoratorSemicolon:"Decorators must not be followed by a semicolon.",DecoratorStaticBlock:"Decorators can't be used with a static block.",DeferImportRequiresNamespace:'Only `import defer * as x from "./module"` is valid.',DeletePrivateField:"Deleting a private field is not allowed.",DestructureNamedImport:"ES2015 named imports do not destructure. Use another statement for destructuring after the import.",DuplicateConstructor:"Duplicate constructor in the same class.",DuplicateDefaultExport:"Only one default export allowed per module.",DuplicateExport:({exportName:r})=>`\`${r}\` has already been exported. Exported identifiers must be unique.`,DuplicateProto:"Redefinition of __proto__ property.",DuplicateRegExpFlags:"Duplicate regular expression flag.",ElementAfterRest:"Rest element must be last element.",EscapedCharNotAnIdentifier:"Invalid Unicode escape.",ExportBindingIsString:({localName:r,exportName:e})=>`A string literal cannot be used as an exported binding without \`from\`.
- Did you mean \`export { '${r}' as '${e}' } from 'some-module'\`?`,ExportDefaultFromAsIdentifier:"'from' is not allowed as an identifier after 'export default'.",ForInOfLoopInitializer:({type:r})=>`'${r==="ForInStatement"?"for-in":"for-of"}' loop variable declaration may not have an initializer.`,ForInUsing:"For-in loop may not start with 'using' declaration.",ForOfAsync:"The left-hand side of a for-of loop may not be 'async'.",ForOfLet:"The left-hand side of a for-of loop may not start with 'let'.",GeneratorInSingleStatementContext:"Generators can only be declared at the top level or inside a block.",IllegalBreakContinue:({type:r})=>`Unsyntactic ${r==="BreakStatement"?"break":"continue"}.`,IllegalLanguageModeDirective:"Illegal 'use strict' directive in function with non-simple parameter list.",IllegalReturn:"'return' outside of function.",ImportAttributesUseAssert:"The `assert` keyword in import attributes is deprecated and it has been replaced by the `with` keyword. You can enable the `deprecatedImportAssert` parser plugin to suppress this error.",ImportBindingIsString:({importName:r})=>`A string literal cannot be used as an imported binding.
- Did you mean \`import { "${r}" as foo }\`?`,ImportCallArity:"`import()` requires exactly one or two arguments.",ImportCallNotNewExpression:"Cannot use new with import(...).",ImportCallSpreadArgument:"`...` is not allowed in `import()`.",ImportJSONBindingNotDefault:"A JSON module can only be imported with `default`.",ImportReflectionHasAssertion:"`import module x` cannot have assertions.",ImportReflectionNotBinding:'Only `import module x from "./module"` is valid.',IncompatibleRegExpUVFlags:"The 'u' and 'v' regular expression flags cannot be enabled at the same time.",InvalidBigIntLiteral:"Invalid BigIntLiteral.",InvalidCodePoint:"Code point out of bounds.",InvalidCoverDiscardElement:"'void' must be followed by an expression when not used in a binding position.",InvalidCoverInitializedName:"Invalid shorthand property initializer.",InvalidDecimal:"Invalid decimal.",InvalidDigit:({radix:r})=>`Expected number in radix ${r}.`,InvalidEscapeSequence:"Bad character escape sequence.",InvalidEscapeSequenceTemplate:"Invalid escape sequence in template.",InvalidEscapedReservedWord:({reservedWord:r})=>`Escape sequence in keyword ${r}.`,InvalidIdentifier:({identifierName:r})=>`Invalid identifier ${r}.`,InvalidLhs:({ancestor:r})=>`Invalid left-hand side in ${ow(r)}.`,InvalidLhsBinding:({ancestor:r})=>`Binding invalid left-hand side in ${ow(r)}.`,InvalidLhsOptionalChaining:({ancestor:r})=>`Invalid optional chaining in the left-hand side of ${ow(r)}.`,InvalidNumber:"Invalid number.",InvalidOrMissingExponent:"Floating-point numbers require a valid exponent after the 'e'.",InvalidOrUnexpectedToken:({unexpected:r})=>`Unexpected character '${r}'.`,InvalidParenthesizedAssignment:"Invalid parenthesized assignment pattern.",InvalidPrivateFieldResolution:({identifierName:r})=>`Private name #${r} is not defined.`,InvalidPropertyBindingPattern:"Binding member expression.",InvalidRecordProperty:"Only properties and spread elements are allowed in record definitions.",InvalidRestAssignmentPattern:"Invalid rest operator's argument.",LabelRedeclaration:({labelName:r})=>`Label '${r}' is already declared.`,LetInLexicalBinding:"'let' is disallowed as a lexically bound name.",LineTerminatorBeforeArrow:"No line break is allowed before '=>'.",MalformedRegExpFlags:"Invalid regular expression flag.",MissingClassName:"A class name is required.",MissingEqInAssignment:"Only '=' operator can be used for specifying default value.",MissingSemicolon:"Missing semicolon.",MissingPlugin:({missingPlugin:r})=>`This experimental syntax requires enabling the parser plugin: ${r.map(e=>JSON.stringify(e)).join(", ")}.`,MissingOneOfPlugins:({missingPlugin:r})=>`This experimental syntax requires enabling one of the following parser plugin(s): ${r.map(e=>JSON.stringify(e)).join(", ")}.`,MissingUnicodeEscape:"Expecting Unicode escape sequence \\uXXXX.",MixingCoalesceWithLogical:"Nullish coalescing operator(??) requires parens when mixing with logical operators.",ModuleAttributeDifferentFromType:"The only accepted module attribute is `type`.",ModuleAttributeInvalidValue:"Only string literals are allowed as module attribute values.",ModuleAttributesWithDuplicateKeys:({key:r})=>`Duplicate key "${r}" is not allowed in module attributes.`,ModuleExportNameHasLoneSurrogate:({surrogateCharCode:r})=>`An export name cannot include a lone surrogate, found '\\u${r.toString(16)}'.`,ModuleExportUndefined:({localName:r})=>`Export '${r}' is not defined.`,MultipleDefaultsInSwitch:"Multiple default clauses.",NewlineAfterThrow:"Illegal newline after throw.",NoCatchOrFinally:"Missing catch or finally clause.",NumberIdentifier:"Identifier directly after number.",NumericSeparatorInEscapeSequence:"Numeric separators are not allowed inside unicode escape sequences or hex escape sequences.",ObsoleteAwaitStar:"'await*' has been removed from the async functions proposal. Use Promise.all() instead.",OptionalChainingNoNew:"Constructors in/after an Optional Chain are not allowed.",OptionalChainingNoTemplate:"Tagged Template Literals are not allowed in optionalChain.",OverrideOnConstructor:"'override' modifier cannot appear on a constructor declaration.",ParamDupe:"Argument name clash.",PatternHasAccessor:"Object pattern can't contain getter or setter.",PatternHasMethod:"Object pattern can't contain methods.",PrivateInExpectedIn:({identifierName:r})=>`Private names are only allowed in property accesses (\`obj.#${r}\`) or in \`in\` expressions (\`#${r} in obj\`).`,PrivateNameRedeclaration:({identifierName:r})=>`Duplicate private name #${r}.`,RecordExpressionBarIncorrectEndSyntaxType:"Record expressions ending with '|}' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'bar'.",RecordExpressionBarIncorrectStartSyntaxType:"Record expressions starting with '{|' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'bar'.",RecordExpressionHashIncorrectStartSyntaxType:"Record expressions starting with '#{' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'hash'.",RecordNoProto:"'__proto__' is not allowed in Record expressions.",RestTrailingComma:"Unexpected trailing comma after rest element.",SloppyFunction:"In non-strict mode code, functions can only be declared at top level or inside a block.",SloppyFunctionAnnexB:"In non-strict mode code, functions can only be declared at top level, inside a block, or as the body of an if statement.",SourcePhaseImportRequiresDefault:'Only `import source x from "./module"` is valid.',StaticPrototype:"Classes may not have static property named prototype.",SuperNotAllowed:"`super()` is only valid inside a class constructor of a subclass. Maybe a typo in the method name ('constructor') or not extending another class?",SuperPrivateField:"Private fields can't be accessed on super.",TrailingDecorator:"Decorators must be attached to a class element.",TupleExpressionBarIncorrectEndSyntaxType:"Tuple expressions ending with '|]' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'bar'.",TupleExpressionBarIncorrectStartSyntaxType:"Tuple expressions starting with '[|' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'bar'.",TupleExpressionHashIncorrectStartSyntaxType:"Tuple expressions starting with '#[' are only allowed when the 'syntaxType' option of the 'recordAndTuple' plugin is set to 'hash'.",UnexpectedArgumentPlaceholder:"Unexpected argument placeholder.",UnexpectedAwaitAfterPipelineBody:'Unexpected "await" after pipeline body; await must have parentheses in minimal proposal.',UnexpectedDigitAfterHash:"Unexpected digit after hash token.",UnexpectedImportExport:"'import' and 'export' may only appear at the top level.",UnexpectedKeyword:({keyword:r})=>`Unexpected keyword '${r}'.`,UnexpectedLeadingDecorator:"Leading decorators must be attached to a class declaration.",UnexpectedLexicalDeclaration:"Lexical declaration cannot appear in a single-statement context.",UnexpectedNewTarget:"`new.target` can only be used in functions or class properties.",UnexpectedNumericSeparator:"A numeric separator is only allowed between two digits.",UnexpectedPrivateField:"Unexpected private name.",UnexpectedReservedWord:({reservedWord:r})=>`Unexpected reserved word '${r}'.`,UnexpectedSuper:"'super' is only allowed in object methods and classes.",UnexpectedToken:({expected:r,unexpected:e})=>`Unexpected token${e?` '${e}'.`:""}${r?`, expected "${r}"`:""}`,UnexpectedTokenUnaryExponentiation:"Illegal expression. Wrap left hand side or entire exponentiation in parentheses.",UnexpectedUsingDeclaration:"Using declaration cannot appear in the top level when source type is `script` or in the bare case statement.",UnexpectedVoidPattern:"Unexpected void binding.",UnsupportedBind:"Binding should be performed on object property.",UnsupportedDecoratorExport:"A decorated export must export a class declaration.",UnsupportedDefaultExport:"Only expressions, functions or classes are allowed as the `default` export.",UnsupportedImport:"`import` can only be used in `import()` or `import.meta`.",UnsupportedMetaProperty:({target:r,onlyValidPropertyName:e})=>`The only valid meta property for ${r} is ${r}.${e}.`,UnsupportedParameterDecorator:"Decorators cannot be used to decorate parameters.",UnsupportedPropertyDecorator:"Decorators cannot be used to decorate object literal properties.",UnsupportedSuper:"'super' can only be used with function calls (i.e. super()) or in property accesses (i.e. super.prop or super[prop]).",UnterminatedComment:"Unterminated comment.",UnterminatedRegExp:"Unterminated regular expression.",UnterminatedString:"Unterminated string constant.",UnterminatedTemplate:"Unterminated template.",UsingDeclarationExport:"Using declaration cannot be exported.",UsingDeclarationHasBindingPattern:"Using declaration cannot have destructuring patterns.",VarRedeclaration:({identifierName:r})=>`Identifier '${r}' has already been declared.`,VoidPatternCatchClauseParam:"A void binding can not be the catch clause parameter. Use `try { ... } catch { ... }` if you want to discard the caught error.",VoidPatternInitializer:"A void binding may not have an initializer.",YieldBindingIdentifier:"Can not use 'yield' as identifier inside a generator.",YieldInParameter:"Yield expression is not allowed in formal parameters.",YieldNotInGeneratorFunction:"'yield' is only allowed within generator functions.",ZeroDigitNumericSeparator:"Numeric separator can not be used after leading 0."},doe={StrictDelete:"Deleting local variable in strict mode.",StrictEvalArguments:({referenceName:r})=>`Assigning to '${r}' in strict mode.`,StrictEvalArgumentsBinding:({bindingName:r})=>`Binding '${r}' in strict mode.`,StrictFunction:"In strict mode code, functions can only be declared at top level or inside a block.",StrictNumericEscape:"The only valid numeric escape in strict mode is '\\0'.",StrictOctalLiteral:"Legacy octal literals are not allowed in strict mode.",StrictWith:"'with' in strict mode."},foe={ParseExpressionEmptyInput:"Unexpected parseExpression() input: The input is empty or contains only comments.",ParseExpressionExpectsEOF:({unexpected:r})=>`Unexpected parseExpression() input: The input should contain exactly one expression, but the first expression is followed by the unexpected character \`${String.fromCodePoint(r)}\`.`};const poe=new Set(["ArrowFunctionExpression","AssignmentExpression","ConditionalExpression","YieldExpression"]);var goe=Object.assign({PipeBodyIsTighter:"Unexpected yield after pipeline body; any yield expression acting as Hack-style pipe body must be parenthesized due to its loose operator precedence.",PipeTopicRequiresHackPipes:'Topic reference is used, but the pipelineOperator plugin was not passed a "proposal": "hack" or "smart" option.',PipeTopicUnbound:"Topic reference is unbound; it must be inside a pipe body.",PipeTopicUnconfiguredToken:({token:r})=>`Invalid topic token ${r}. In order to use ${r} as a topic reference, the pipelineOperator plugin must be configured with { "proposal": "hack", "topicToken": "${r}" }.`,PipeTopicUnused:"Hack-style pipe body does not contain a topic reference; Hack-style pipes must use topic at least once.",PipeUnparenthesizedBody:({type:r})=>`Hack-style pipe body cannot be an unparenthesized ${ow({type:r})}; please wrap it in parentheses.`},{PipelineBodyNoArrow:'Unexpected arrow "=>" after pipeline body; arrow function in pipeline body must be parenthesized.',PipelineBodySequenceExpression:"Pipeline body may not be a comma-separated sequence expression.",PipelineHeadSequenceExpression:"Pipeline head should not be a comma-separated sequence expression.",PipelineTopicUnused:"Pipeline is in topic style but does not use topic reference.",PrimaryTopicNotAllowed:"Topic reference was used in a lexical context without topic binding.",PrimaryTopicRequiresSmartPipeline:'Topic reference is used, but the pipelineOperator plugin was not passed a "proposal": "hack" or "smart" option.'});const moe=["message"];function r4(r,e,t){Object.defineProperty(r,e,{enumerable:!1,configurable:!0,value:t})}function yoe({toMessage:r,code:e,reasonCode:t,syntaxPlugin:n}){const i=t==="MissingPlugin"||t==="MissingOneOfPlugins";{const s={AccessorCannotDeclareThisParameter:"AccesorCannotDeclareThisParameter",AccessorCannotHaveTypeParameters:"AccesorCannotHaveTypeParameters",ConstInitializerMustBeStringOrNumericLiteralOrLiteralEnumReference:"ConstInitiailizerMustBeStringOrNumericLiteralOrLiteralEnumReference",SetAccessorCannotHaveOptionalParameter:"SetAccesorCannotHaveOptionalParameter",SetAccessorCannotHaveRestParameter:"SetAccesorCannotHaveRestParameter",SetAccessorCannotHaveReturnType:"SetAccesorCannotHaveReturnType"};s[t]&&(t=s[t])}return function s(a,o){const u=new SyntaxError;return u.code=e,u.reasonCode=t,u.loc=a,u.pos=a.index,u.syntaxPlugin=n,i&&(u.missingPlugin=o.missingPlugin),r4(u,"clone",function(g={}){var y;const{line:A,column:C,index:M}=(y=g.loc)!=null?y:a;return s(new pd(A,C,M),Object.assign({},o,g.details))}),r4(u,"details",o),Object.defineProperty(u,"message",{configurable:!0,get(){const f=`${r(o)} (${a.line}:${a.column})`;return this.message=f,f},set(f){Object.defineProperty(this,"message",{value:f,writable:!0})}}),u}}function Oc(r,e){if(Array.isArray(r))return n=>Oc(n,r[0]);const t={};for(const n of Object.keys(r)){const i=r[n],s=typeof i=="string"?{message:()=>i}:typeof i=="function"?{message:i}:i,{message:a}=s,o=coe(s,moe),u=typeof a=="string"?()=>a:a;t[n]=yoe(Object.assign({code:"BABEL_PARSER_SYNTAX_ERROR",reasonCode:n,toMessage:u},e?{syntaxPlugin:e}:{},o))}return t}const Ne=Object.assign({},Oc(uoe),Oc(hoe),Oc(doe),Oc(foe),Oc`pipelineOperator`(goe));function boe(){return{sourceType:"script",sourceFilename:void 0,startIndex:0,startColumn:0,startLine:1,allowAwaitOutsideFunction:!1,allowReturnOutsideFunction:!1,allowNewTargetOutsideFunction:!1,allowImportExportEverywhere:!1,allowSuperOutsideMethod:!1,allowUndeclaredExports:!1,allowYieldOutsideFunction:!1,plugins:[],strictMode:void 0,ranges:!1,tokens:!1,createImportExpressions:!1,createParenthesizedExpressions:!1,errorRecovery:!1,attachComment:!0,annexB:!0}}function _oe(r){const e=boe();if(r==null)return e;if(r.annexB!=null&&r.annexB!==!1)throw new Error("The `annexB` option can only be set to `false`.");for(const t of Object.keys(e))r[t]!=null&&(e[t]=r[t]);if(e.startLine===1)r.startIndex==null&&e.startColumn>0?e.startIndex=e.startColumn:r.startColumn==null&&e.startIndex>0&&(e.startColumn=e.startIndex);else if((r.startColumn==null||r.startIndex==null)&&r.startIndex!=null)throw new Error("With a `startLine > 1` you must also specify `startIndex` and `startColumn`.");if(e.sourceType==="commonjs"){if(r.allowAwaitOutsideFunction!=null)throw new Error("The `allowAwaitOutsideFunction` option cannot be used with `sourceType: 'commonjs'`.");if(r.allowReturnOutsideFunction!=null)throw new Error("`sourceType: 'commonjs'` implies `allowReturnOutsideFunction: true`, please remove the `allowReturnOutsideFunction` option or use `sourceType: 'script'`.");if(r.allowNewTargetOutsideFunction!=null)throw new Error("`sourceType: 'commonjs'` implies `allowNewTargetOutsideFunction: true`, please remove the `allowNewTargetOutsideFunction` option or use `sourceType: 'script'`.")}return e}const{defineProperty:voe}=Object,n4=(r,e)=>{r&&voe(r,e,{enumerable:!1,value:r[e]})};function Hb(r){return n4(r.loc.start,"index"),n4(r.loc.end,"index"),r}var Aoe=r=>class extends r{parse(){const t=Hb(super.parse());return this.optionFlags&256&&(t.tokens=t.tokens.map(Hb)),t}parseRegExpLiteral({pattern:t,flags:n}){let i=null;try{i=new RegExp(t,n)}catch{}const s=this.estreeParseLiteral(i);return s.regex={pattern:t,flags:n},s}parseBigIntLiteral(t){let n;try{n=BigInt(t)}catch{n=null}const i=this.estreeParseLiteral(n);return i.bigint=String(i.value||t),i}parseDecimalLiteral(t){const i=this.estreeParseLiteral(null);return i.decimal=String(i.value||t),i}estreeParseLiteral(t){return this.parseLiteral(t,"Literal")}parseStringLiteral(t){return this.estreeParseLiteral(t)}parseNumericLiteral(t){return this.estreeParseLiteral(t)}parseNullLiteral(){return this.estreeParseLiteral(null)}parseBooleanLiteral(t){return this.estreeParseLiteral(t)}estreeParseChainExpression(t,n){const i=this.startNodeAtNode(t);return i.expression=t,this.finishNodeAt(i,"ChainExpression",n)}directiveToStmt(t){const n=t.value;delete t.value,this.castNodeTo(n,"Literal"),n.raw=n.extra.raw,n.value=n.extra.expressionValue;const i=this.castNodeTo(t,"ExpressionStatement");return i.expression=n,i.directive=n.extra.rawValue,delete n.extra,i}fillOptionalPropertiesForTSESLint(t){}cloneEstreeStringLiteral(t){const{start:n,end:i,loc:s,range:a,raw:o,value:u}=t,f=Object.create(t.constructor.prototype);return f.type="Literal",f.start=n,f.end=i,f.loc=s,f.range=a,f.raw=o,f.value=u,f}initFunction(t,n){super.initFunction(t,n),t.expression=!1}checkDeclaration(t){t!=null&&this.isObjectProperty(t)?this.checkDeclaration(t.value):super.checkDeclaration(t)}getObjectOrClassMethodParams(t){return t.value.params}isValidDirective(t){var n;return t.type==="ExpressionStatement"&&t.expression.type==="Literal"&&typeof t.expression.value=="string"&&!((n=t.expression.extra)!=null&&n.parenthesized)}parseBlockBody(t,n,i,s,a){super.parseBlockBody(t,n,i,s,a);const o=t.directives.map(u=>this.directiveToStmt(u));t.body=o.concat(t.body),delete t.directives}parsePrivateName(){const t=super.parsePrivateName();return this.getPluginOption("estree","classFeatures")?this.convertPrivateNameToPrivateIdentifier(t):t}convertPrivateNameToPrivateIdentifier(t){const n=super.getPrivateNameSV(t);return delete t.id,t.name=n,this.castNodeTo(t,"PrivateIdentifier")}isPrivateName(t){return this.getPluginOption("estree","classFeatures")?t.type==="PrivateIdentifier":super.isPrivateName(t)}getPrivateNameSV(t){return this.getPluginOption("estree","classFeatures")?t.name:super.getPrivateNameSV(t)}parseLiteral(t,n){const i=super.parseLiteral(t,n);return i.raw=i.extra.raw,delete i.extra,i}parseFunctionBody(t,n,i=!1){super.parseFunctionBody(t,n,i),t.expression=t.body.type!=="BlockStatement"}parseMethod(t,n,i,s,a,o,u=!1){let f=this.startNode();f.kind=t.kind,f=super.parseMethod(f,n,i,s,a,o,u),delete f.kind;const{typeParameters:g}=t;g&&(delete t.typeParameters,f.typeParameters=g,this.resetStartLocationFromNode(f,g));const y=this.castNodeTo(f,"FunctionExpression");return t.value=y,o==="ClassPrivateMethod"&&(t.computed=!1),o==="ObjectMethod"?(t.kind==="method"&&(t.kind="init"),t.shorthand=!1,this.finishNode(t,"Property")):this.finishNode(t,"MethodDefinition")}nameIsConstructor(t){return t.type==="Literal"?t.value==="constructor":super.nameIsConstructor(t)}parseClassProperty(...t){const n=super.parseClassProperty(...t);return this.getPluginOption("estree","classFeatures")&&this.castNodeTo(n,"PropertyDefinition"),n}parseClassPrivateProperty(...t){const n=super.parseClassPrivateProperty(...t);return this.getPluginOption("estree","classFeatures")&&(this.castNodeTo(n,"PropertyDefinition"),n.computed=!1),n}parseClassAccessorProperty(t){const n=super.parseClassAccessorProperty(t);return this.getPluginOption("estree","classFeatures")&&(n.abstract&&this.hasPlugin("typescript")?(delete n.abstract,this.castNodeTo(n,"TSAbstractAccessorProperty")):this.castNodeTo(n,"AccessorProperty")),n}parseObjectProperty(t,n,i,s){const a=super.parseObjectProperty(t,n,i,s);return a&&(a.kind="init",this.castNodeTo(a,"Property")),a}finishObjectProperty(t){return t.kind="init",this.finishNode(t,"Property")}isValidLVal(t,n,i,s){return t==="Property"?"value":super.isValidLVal(t,n,i,s)}isAssignable(t,n){return t!=null&&this.isObjectProperty(t)?this.isAssignable(t.value,n):super.isAssignable(t,n)}toAssignable(t,n=!1){if(t!=null&&this.isObjectProperty(t)){const{key:i,value:s}=t;this.isPrivateName(i)&&this.classScope.usePrivateName(this.getPrivateNameSV(i),i.loc.start),this.toAssignable(s,n)}else super.toAssignable(t,n)}toAssignableObjectExpressionProp(t,n,i){t.type==="Property"&&(t.kind==="get"||t.kind==="set")?this.raise(Ne.PatternHasAccessor,t.key):t.type==="Property"&&t.method?this.raise(Ne.PatternHasMethod,t.key):super.toAssignableObjectExpressionProp(t,n,i)}finishCallExpression(t,n){const i=super.finishCallExpression(t,n);if(i.callee.type==="Import"){var s;this.castNodeTo(i,"ImportExpression"),i.source=i.arguments[0],i.options=(s=i.arguments[1])!=null?s:null;{var a;i.attributes=(a=i.arguments[1])!=null?a:null}delete i.arguments,delete i.callee}else i.type==="OptionalCallExpression"?this.castNodeTo(i,"CallExpression"):i.optional=!1;return i}toReferencedArguments(t){t.type!=="ImportExpression"&&super.toReferencedArguments(t)}parseExport(t,n){const i=this.state.lastTokStartLoc,s=super.parseExport(t,n);switch(s.type){case"ExportAllDeclaration":s.exported=null;break;case"ExportNamedDeclaration":s.specifiers.length===1&&s.specifiers[0].type==="ExportNamespaceSpecifier"&&(this.castNodeTo(s,"ExportAllDeclaration"),s.exported=s.specifiers[0].exported,delete s.specifiers);case"ExportDefaultDeclaration":{var a;const{declaration:o}=s;o?.type==="ClassDeclaration"&&((a=o.decorators)==null?void 0:a.length)>0&&o.start===s.start&&this.resetStartLocation(s,i)}break}return s}stopParseSubscript(t,n){const i=super.stopParseSubscript(t,n);return n.optionalChainMember?this.estreeParseChainExpression(i,t.loc.end):i}parseMember(t,n,i,s,a){const o=super.parseMember(t,n,i,s,a);return o.type==="OptionalMemberExpression"?this.castNodeTo(o,"MemberExpression"):o.optional=!1,o}isOptionalMemberExpression(t){return t.type==="ChainExpression"?t.expression.type==="MemberExpression":super.isOptionalMemberExpression(t)}hasPropertyAsPrivateName(t){return t.type==="ChainExpression"&&(t=t.expression),super.hasPropertyAsPrivateName(t)}isObjectProperty(t){return t.type==="Property"&&t.kind==="init"&&!t.method}isObjectMethod(t){return t.type==="Property"&&(t.method||t.kind==="get"||t.kind==="set")}castNodeTo(t,n){const i=super.castNodeTo(t,n);return this.fillOptionalPropertiesForTSESLint(i),i}cloneIdentifier(t){const n=super.cloneIdentifier(t);return this.fillOptionalPropertiesForTSESLint(n),n}cloneStringLiteral(t){return t.type==="Literal"?this.cloneEstreeStringLiteral(t):super.cloneStringLiteral(t)}finishNodeAt(t,n,i){return Hb(super.finishNodeAt(t,n,i))}finishNode(t,n){const i=super.finishNode(t,n);return this.fillOptionalPropertiesForTSESLint(i),i}resetStartLocation(t,n){super.resetStartLocation(t,n),Hb(t)}resetEndLocation(t,n=this.state.lastTokEndLoc){super.resetEndLocation(t,n),Hb(t)}};class _0{constructor(e,t){this.token=void 0,this.preserveSpace=void 0,this.token=e,this.preserveSpace=!!t}}const Sn={brace:new _0("{"),j_oTag:new _0("<tag"),j_cTag:new _0("</tag"),j_expr:new _0("<tag>...</tag>",!0)};Sn.template=new _0("`",!0);const Qr=!0,sr=!0,ZE=!0,Wb=!0,Dh=!0,xoe=!0;class _7{constructor(e,t={}){this.label=void 0,this.keyword=void 0,this.beforeExpr=void 0,this.startsExpr=void 0,this.rightAssociative=void 0,this.isLoop=void 0,this.isAssign=void 0,this.prefix=void 0,this.postfix=void 0,this.binop=void 0,this.label=e,this.keyword=t.keyword,this.beforeExpr=!!t.beforeExpr,this.startsExpr=!!t.startsExpr,this.rightAssociative=!!t.rightAssociative,this.isLoop=!!t.isLoop,this.isAssign=!!t.isAssign,this.prefix=!!t.prefix,this.postfix=!!t.postfix,this.binop=t.binop!=null?t.binop:null,this.updateContext=null}}const UR=new Map;function pn(r,e={}){e.keyword=r;const t=wr(r,e);return UR.set(r,t),t}function ko(r,e){return wr(r,{beforeExpr:Qr,binop:e})}let K0=-1;const ku=[],zR=[],VR=[],$R=[],jR=[],GR=[];function wr(r,e={}){var t,n,i,s;return++K0,zR.push(r),VR.push((t=e.binop)!=null?t:-1),$R.push((n=e.beforeExpr)!=null?n:!1),jR.push((i=e.startsExpr)!=null?i:!1),GR.push((s=e.prefix)!=null?s:!1),ku.push(new _7(r,e)),K0}function tn(r,e={}){var t,n,i,s;return++K0,UR.set(r,K0),zR.push(r),VR.push((t=e.binop)!=null?t:-1),$R.push((n=e.beforeExpr)!=null?n:!1),jR.push((i=e.startsExpr)!=null?i:!1),GR.push((s=e.prefix)!=null?s:!1),ku.push(new _7("name",e)),K0}const woe={bracketL:wr("[",{beforeExpr:Qr,startsExpr:sr}),bracketHashL:wr("#[",{beforeExpr:Qr,startsExpr:sr}),bracketBarL:wr("[|",{beforeExpr:Qr,startsExpr:sr}),bracketR:wr("]"),bracketBarR:wr("|]"),braceL:wr("{",{beforeExpr:Qr,startsExpr:sr}),braceBarL:wr("{|",{beforeExpr:Qr,startsExpr:sr}),braceHashL:wr("#{",{beforeExpr:Qr,startsExpr:sr}),braceR:wr("}"),braceBarR:wr("|}"),parenL:wr("(",{beforeExpr:Qr,startsExpr:sr}),parenR:wr(")"),comma:wr(",",{beforeExpr:Qr}),semi:wr(";",{beforeExpr:Qr}),colon:wr(":",{beforeExpr:Qr}),doubleColon:wr("::",{beforeExpr:Qr}),dot:wr("."),question:wr("?",{beforeExpr:Qr}),questionDot:wr("?."),arrow:wr("=>",{beforeExpr:Qr}),template:wr("template"),ellipsis:wr("...",{beforeExpr:Qr}),backQuote:wr("`",{startsExpr:sr}),dollarBraceL:wr("${",{beforeExpr:Qr,startsExpr:sr}),templateTail:wr("...`",{startsExpr:sr}),templateNonTail:wr("...${",{beforeExpr:Qr,startsExpr:sr}),at:wr("@"),hash:wr("#",{startsExpr:sr}),interpreterDirective:wr("#!..."),eq:wr("=",{beforeExpr:Qr,isAssign:Wb}),assign:wr("_=",{beforeExpr:Qr,isAssign:Wb}),slashAssign:wr("_=",{beforeExpr:Qr,isAssign:Wb}),xorAssign:wr("_=",{beforeExpr:Qr,isAssign:Wb}),moduloAssign:wr("_=",{beforeExpr:Qr,isAssign:Wb}),incDec:wr("++/--",{prefix:Dh,postfix:xoe,startsExpr:sr}),bang:wr("!",{beforeExpr:Qr,prefix:Dh,startsExpr:sr}),tilde:wr("~",{beforeExpr:Qr,prefix:Dh,startsExpr:sr}),doubleCaret:wr("^^",{startsExpr:sr}),doubleAt:wr("@@",{startsExpr:sr}),pipeline:ko("|>",0),nullishCoalescing:ko("??",1),logicalOR:ko("||",1),logicalAND:ko("&&",2),bitwiseOR:ko("|",3),bitwiseXOR:ko("^",4),bitwiseAND:ko("&",5),equality:ko("==/!=/===/!==",6),lt:ko("</>/<=/>=",7),gt:ko("</>/<=/>=",7),relational:ko("</>/<=/>=",7),bitShift:ko("<</>>/>>>",8),bitShiftL:ko("<</>>/>>>",8),bitShiftR:ko("<</>>/>>>",8),plusMin:wr("+/-",{beforeExpr:Qr,binop:9,prefix:Dh,startsExpr:sr}),modulo:wr("%",{binop:10,startsExpr:sr}),star:wr("*",{binop:10}),slash:ko("/",10),exponent:wr("**",{beforeExpr:Qr,binop:11,rightAssociative:!0}),_in:pn("in",{beforeExpr:Qr,binop:7}),_instanceof:pn("instanceof",{beforeExpr:Qr,binop:7}),_break:pn("break"),_case:pn("case",{beforeExpr:Qr}),_catch:pn("catch"),_continue:pn("continue"),_debugger:pn("debugger"),_default:pn("default",{beforeExpr:Qr}),_else:pn("else",{beforeExpr:Qr}),_finally:pn("finally"),_function:pn("function",{startsExpr:sr}),_if:pn("if"),_return:pn("return",{beforeExpr:Qr}),_switch:pn("switch"),_throw:pn("throw",{beforeExpr:Qr,prefix:Dh,startsExpr:sr}),_try:pn("try"),_var:pn("var"),_const:pn("const"),_with:pn("with"),_new:pn("new",{beforeExpr:Qr,startsExpr:sr}),_this:pn("this",{startsExpr:sr}),_super:pn("super",{startsExpr:sr}),_class:pn("class",{startsExpr:sr}),_extends:pn("extends",{beforeExpr:Qr}),_export:pn("export"),_import:pn("import",{startsExpr:sr}),_null:pn("null",{startsExpr:sr}),_true:pn("true",{startsExpr:sr}),_false:pn("false",{startsExpr:sr}),_typeof:pn("typeof",{beforeExpr:Qr,prefix:Dh,startsExpr:sr}),_void:pn("void",{beforeExpr:Qr,prefix:Dh,startsExpr:sr}),_delete:pn("delete",{beforeExpr:Qr,prefix:Dh,startsExpr:sr}),_do:pn("do",{isLoop:ZE,beforeExpr:Qr}),_for:pn("for",{isLoop:ZE}),_while:pn("while",{isLoop:ZE}),_as:tn("as",{startsExpr:sr}),_assert:tn("assert",{startsExpr:sr}),_async:tn("async",{startsExpr:sr}),_await:tn("await",{startsExpr:sr}),_defer:tn("defer",{startsExpr:sr}),_from:tn("from",{startsExpr:sr}),_get:tn("get",{startsExpr:sr}),_let:tn("let",{startsExpr:sr}),_meta:tn("meta",{startsExpr:sr}),_of:tn("of",{startsExpr:sr}),_sent:tn("sent",{startsExpr:sr}),_set:tn("set",{startsExpr:sr}),_source:tn("source",{startsExpr:sr}),_static:tn("static",{startsExpr:sr}),_using:tn("using",{startsExpr:sr}),_yield:tn("yield",{startsExpr:sr}),_asserts:tn("asserts",{startsExpr:sr}),_checks:tn("checks",{startsExpr:sr}),_exports:tn("exports",{startsExpr:sr}),_global:tn("global",{startsExpr:sr}),_implements:tn("implements",{startsExpr:sr}),_intrinsic:tn("intrinsic",{startsExpr:sr}),_infer:tn("infer",{startsExpr:sr}),_is:tn("is",{startsExpr:sr}),_mixins:tn("mixins",{startsExpr:sr}),_proto:tn("proto",{startsExpr:sr}),_require:tn("require",{startsExpr:sr}),_satisfies:tn("satisfies",{startsExpr:sr}),_keyof:tn("keyof",{startsExpr:sr}),_readonly:tn("readonly",{startsExpr:sr}),_unique:tn("unique",{startsExpr:sr}),_abstract:tn("abstract",{startsExpr:sr}),_declare:tn("declare",{startsExpr:sr}),_enum:tn("enum",{startsExpr:sr}),_module:tn("module",{startsExpr:sr}),_namespace:tn("namespace",{startsExpr:sr}),_interface:tn("interface",{startsExpr:sr}),_type:tn("type",{startsExpr:sr}),_opaque:tn("opaque",{startsExpr:sr}),name:wr("name",{startsExpr:sr}),placeholder:wr("%%",{startsExpr:sr}),string:wr("string",{startsExpr:sr}),num:wr("num",{startsExpr:sr}),bigint:wr("bigint",{startsExpr:sr}),decimal:wr("decimal",{startsExpr:sr}),regexp:wr("regexp",{startsExpr:sr}),privateName:wr("#name",{startsExpr:sr}),eof:wr("eof"),jsxName:wr("jsxName"),jsxText:wr("jsxText",{beforeExpr:Qr}),jsxTagStart:wr("jsxTagStart",{startsExpr:sr}),jsxTagEnd:wr("jsxTagEnd")};function Dn(r){return r>=93&&r<=133}function Coe(r){return r<=92}function Wl(r){return r>=58&&r<=133}function v7(r){return r>=58&&r<=137}function Toe(r){return $R[r]}function v0(r){return jR[r]}function Soe(r){return r>=29&&r<=33}function i4(r){return r>=129&&r<=131}function Eoe(r){return r>=90&&r<=92}function HR(r){return r>=58&&r<=92}function Ioe(r){return r>=39&&r<=59}function Poe(r){return r===34}function Boe(r){return GR[r]}function Moe(r){return r>=121&&r<=123}function Roe(r){return r>=124&&r<=130}function gd(r){return zR[r]}function aw(r){return VR[r]}function koe(r){return r===57}function hC(r){return r>=24&&r<=25}function Bu(r){return ku[r]}ku[8].updateContext=r=>{r.pop()},ku[5].updateContext=ku[7].updateContext=ku[23].updateContext=r=>{r.push(Sn.brace)},ku[22].updateContext=r=>{r[r.length-1]===Sn.template?r.pop():r.push(Sn.template)},ku[143].updateContext=r=>{r.push(Sn.j_expr,Sn.j_oTag)};let WR="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",A7="------------------------------------------------------------------------------------------------------------------------------------------------------";const Ooe=new RegExp("["+WR+"]"),Doe=new RegExp("["+WR+A7+"]");WR=A7=null;const x7=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,7,25,39,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,5,57,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,24,43,261,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,33,24,3,24,45,74,6,0,67,12,65,1,2,0,15,4,10,7381,42,31,98,114,8702,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,208,30,2,2,2,1,2,6,3,4,10,1,225,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4381,3,5773,3,7472,16,621,2467,541,1507,4938,6,8489],Loe=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,78,5,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,199,7,137,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,55,9,266,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,233,0,3,0,8,1,6,0,475,6,110,6,6,9,4759,9,787719,239];function P3(r,e){let t=65536;for(let n=0,i=e.length;n<i;n+=2){if(t+=e[n],t>r)return!1;if(t+=e[n+1],t>=r)return!0}return!1}function Dc(r){return r<65?r===36:r<=90?!0:r<97?r===95:r<=122?!0:r<=65535?r>=170&&Ooe.test(String.fromCharCode(r)):P3(r,x7)}function Hf(r){return r<48?r===36:r<58?!0:r<65?!1:r<=90?!0:r<97?r===95:r<=122?!0:r<=65535?r>=170&&Doe.test(String.fromCharCode(r)):P3(r,x7)||P3(r,Loe)}const KR={keyword:["break","case","catch","continue","debugger","default","do","else","finally","for","function","if","return","switch","throw","try","var","const","while","with","new","this","super","class","extends","export","import","null","true","false","in","instanceof","typeof","void","delete"],strict:["implements","interface","let","package","private","protected","public","static","yield"],strictBind:["eval","arguments"]},Noe=new Set(KR.keyword),Foe=new Set(KR.strict),Uoe=new Set(KR.strictBind);function w7(r,e){return e&&r==="await"||r==="enum"}function C7(r,e){return w7(r,e)||Foe.has(r)}function T7(r){return Uoe.has(r)}function S7(r,e){return C7(r,e)||T7(r)}function zoe(r){return Noe.has(r)}function Voe(r,e,t){return r===64&&e===64&&Dc(t)}const $oe=new Set(["break","case","catch","continue","debugger","default","do","else","finally","for","function","if","return","switch","throw","try","var","const","while","with","new","this","super","class","extends","export","import","null","true","false","in","instanceof","typeof","void","delete","implements","interface","let","package","private","protected","public","static","yield","eval","arguments","enum","await"]);function joe(r){return $oe.has(r)}class XR{constructor(e){this.flags=0,this.names=new Map,this.firstLexicalName="",this.flags=e}}class JR{constructor(e,t){this.parser=void 0,this.scopeStack=[],this.inModule=void 0,this.undefinedExports=new Map,this.parser=e,this.inModule=t}get inTopLevel(){return(this.currentScope().flags&1)>0}get inFunction(){return(this.currentVarScopeFlags()&2)>0}get allowSuper(){return(this.currentThisScopeFlags()&16)>0}get allowDirectSuper(){return(this.currentThisScopeFlags()&32)>0}get allowNewTarget(){return(this.currentThisScopeFlags()&512)>0}get inClass(){return(this.currentThisScopeFlags()&64)>0}get inClassAndNotInNonArrowFunction(){const e=this.currentThisScopeFlags();return(e&64)>0&&(e&2)===0}get inStaticBlock(){for(let e=this.scopeStack.length-1;;e--){const{flags:t}=this.scopeStack[e];if(t&128)return!0;if(t&1731)return!1}}get inNonArrowFunction(){return(this.currentThisScopeFlags()&2)>0}get inBareCaseStatement(){return(this.currentScope().flags&256)>0}get treatFunctionsAsVar(){return this.treatFunctionsAsVarInScope(this.currentScope())}createScope(e){return new XR(e)}enter(e){this.scopeStack.push(this.createScope(e))}exit(){return this.scopeStack.pop().flags}treatFunctionsAsVarInScope(e){return!!(e.flags&130||!this.parser.inModule&&e.flags&1)}declareName(e,t,n){let i=this.currentScope();if(t&8||t&16){this.checkRedeclarationInScope(i,e,t,n);let s=i.names.get(e)||0;t&16?s=s|4:(i.firstLexicalName||(i.firstLexicalName=e),s=s|2),i.names.set(e,s),t&8&&this.maybeExportDefined(i,e)}else if(t&4)for(let s=this.scopeStack.length-1;s>=0&&(i=this.scopeStack[s],this.checkRedeclarationInScope(i,e,t,n),i.names.set(e,(i.names.get(e)||0)|1),this.maybeExportDefined(i,e),!(i.flags&1667));--s);this.parser.inModule&&i.flags&1&&this.undefinedExports.delete(e)}maybeExportDefined(e,t){this.parser.inModule&&e.flags&1&&this.undefinedExports.delete(t)}checkRedeclarationInScope(e,t,n,i){this.isRedeclaredInScope(e,t,n)&&this.parser.raise(Ne.VarRedeclaration,i,{identifierName:t})}isRedeclaredInScope(e,t,n){if(!(n&1))return!1;if(n&8)return e.names.has(t);const i=e.names.get(t)||0;return n&16?(i&2)>0||!this.treatFunctionsAsVarInScope(e)&&(i&1)>0:(i&2)>0&&!(e.flags&8&&e.firstLexicalName===t)||!this.treatFunctionsAsVarInScope(e)&&(i&4)>0}checkLocalExport(e){const{name:t}=e;this.scopeStack[0].names.has(t)||this.undefinedExports.set(t,e.loc.start)}currentScope(){return this.scopeStack[this.scopeStack.length-1]}currentVarScopeFlags(){for(let e=this.scopeStack.length-1;;e--){const{flags:t}=this.scopeStack[e];if(t&1667)return t}}currentThisScopeFlags(){for(let e=this.scopeStack.length-1;;e--){const{flags:t}=this.scopeStack[e];if(t&1731&&!(t&4))return t}}}class Goe extends XR{constructor(...e){super(...e),this.declareFunctions=new Set}}class Hoe extends JR{createScope(e){return new Goe(e)}declareName(e,t,n){const i=this.currentScope();if(t&2048){this.checkRedeclarationInScope(i,e,t,n),this.maybeExportDefined(i,e),i.declareFunctions.add(e);return}super.declareName(e,t,n)}isRedeclaredInScope(e,t,n){if(super.isRedeclaredInScope(e,t,n))return!0;if(n&2048&&!e.declareFunctions.has(t)){const i=e.names.get(t);return(i&4)>0||(i&2)>0}return!1}checkLocalExport(e){this.scopeStack[0].declareFunctions.has(e.name)||super.checkLocalExport(e)}}const Woe=new Set(["_","any","bool","boolean","empty","extends","false","interface","mixed","null","number","static","string","true","typeof","void"]),Sr=Oc`flow`({AmbiguousConditionalArrow:"Ambiguous expression: wrap the arrow functions in parentheses to disambiguate.",AmbiguousDeclareModuleKind:"Found both `declare module.exports` and `declare export` in the same module. Modules can only have 1 since they are either an ES module or they are a CommonJS module.",AssignReservedType:({reservedType:r})=>`Cannot overwrite reserved type ${r}.`,DeclareClassElement:"The `declare` modifier can only appear on class fields.",DeclareClassFieldInitializer:"Initializers are not allowed in fields with the `declare` modifier.",DuplicateDeclareModuleExports:"Duplicate `declare module.exports` statement.",EnumBooleanMemberNotInitialized:({memberName:r,enumName:e})=>`Boolean enum members need to be initialized. Use either \`${r} = true,\` or \`${r} = false,\` in enum \`${e}\`.`,EnumDuplicateMemberName:({memberName:r,enumName:e})=>`Enum member names need to be unique, but the name \`${r}\` has already been used before in enum \`${e}\`.`,EnumInconsistentMemberValues:({enumName:r})=>`Enum \`${r}\` has inconsistent member initializers. Either use no initializers, or consistently use literals (either booleans, numbers, or strings) for all member initializers.`,EnumInvalidExplicitType:({invalidEnumType:r,enumName:e})=>`Enum type \`${r}\` is not valid. Use one of \`boolean\`, \`number\`, \`string\`, or \`symbol\` in enum \`${e}\`.`,EnumInvalidExplicitTypeUnknownSupplied:({enumName:r})=>`Supplied enum type is not valid. Use one of \`boolean\`, \`number\`, \`string\`, or \`symbol\` in enum \`${r}\`.`,EnumInvalidMemberInitializerPrimaryType:({enumName:r,memberName:e,explicitType:t})=>`Enum \`${r}\` has type \`${t}\`, so the initializer of \`${e}\` needs to be a ${t} literal.`,EnumInvalidMemberInitializerSymbolType:({enumName:r,memberName:e})=>`Symbol enum members cannot be initialized. Use \`${e},\` in enum \`${r}\`.`,EnumInvalidMemberInitializerUnknownType:({enumName:r,memberName:e})=>`The enum member initializer for \`${e}\` needs to be a literal (either a boolean, number, or string) in enum \`${r}\`.`,EnumInvalidMemberName:({enumName:r,memberName:e,suggestion:t})=>`Enum member names cannot start with lowercase 'a' through 'z'. Instead of using \`${e}\`, consider using \`${t}\`, in enum \`${r}\`.`,EnumNumberMemberNotInitialized:({enumName:r,memberName:e})=>`Number enum members need to be initialized, e.g. \`${e} = 1\` in enum \`${r}\`.`,EnumStringMemberInconsistentlyInitialized:({enumName:r})=>`String enum members need to consistently either all use initializers, or use no initializers, in enum \`${r}\`.`,GetterMayNotHaveThisParam:"A getter cannot have a `this` parameter.",ImportReflectionHasImportType:"An `import module` declaration can not use `type` or `typeof` keyword.",ImportTypeShorthandOnlyInPureImport:"The `type` and `typeof` keywords on named imports can only be used on regular `import` statements. It cannot be used with `import type` or `import typeof` statements.",InexactInsideExact:"Explicit inexact syntax cannot appear inside an explicit exact object type.",InexactInsideNonObject:"Explicit inexact syntax cannot appear in class or interface definitions.",InexactVariance:"Explicit inexact syntax cannot have variance.",InvalidNonTypeImportInDeclareModule:"Imports within a `declare module` body must always be `import type` or `import typeof`.",MissingTypeParamDefault:"Type parameter declaration needs a default, since a preceding type parameter declaration has a default.",NestedDeclareModule:"`declare module` cannot be used inside another `declare module`.",NestedFlowComment:"Cannot have a flow comment inside another flow comment.",PatternIsOptional:Object.assign({message:"A binding pattern parameter cannot be optional in an implementation signature."},{reasonCode:"OptionalBindingPattern"}),SetterMayNotHaveThisParam:"A setter cannot have a `this` parameter.",SpreadVariance:"Spread properties cannot have variance.",ThisParamAnnotationRequired:"A type annotation is required for the `this` parameter.",ThisParamBannedInConstructor:"Constructors cannot have a `this` parameter; constructors don't bind `this` like other functions.",ThisParamMayNotBeOptional:"The `this` parameter cannot be optional.",ThisParamMustBeFirst:"The `this` parameter must be the first function parameter.",ThisParamNoDefault:"The `this` parameter may not have a default value.",TypeBeforeInitializer:"Type annotations must come before default assignments, e.g. instead of `age = 25: number` use `age: number = 25`.",TypeCastInPattern:"The type cast expression is expected to be wrapped with parenthesis.",UnexpectedExplicitInexactInObject:"Explicit inexact syntax must appear at the end of an inexact object.",UnexpectedReservedType:({reservedType:r})=>`Unexpected reserved type ${r}.`,UnexpectedReservedUnderscore:"`_` is only allowed as a type argument to call or new.",UnexpectedSpaceBetweenModuloChecks:"Spaces between `%` and `checks` are not allowed here.",UnexpectedSpreadType:"Spread operator cannot appear in class or interface definitions.",UnexpectedSubtractionOperand:'Unexpected token, expected "number" or "bigint".',UnexpectedTokenAfterTypeParameter:"Expected an arrow function after this type parameter declaration.",UnexpectedTypeParameterBeforeAsyncArrowFunction:"Type parameters must come after the async keyword, e.g. instead of `<T> async () => {}`, use `async <T>() => {}`.",UnsupportedDeclareExportKind:({unsupportedExportKind:r,suggestion:e})=>`\`declare export ${r}\` is not supported. Use \`${e}\` instead.`,UnsupportedStatementInDeclareModule:"Only declares and type imports are allowed inside declare module.",UnterminatedFlowComment:"Unterminated flow-comment."});function Koe(r){return r.type==="DeclareExportAllDeclaration"||r.type==="DeclareExportDeclaration"&&(!r.declaration||r.declaration.type!=="TypeAlias"&&r.declaration.type!=="InterfaceDeclaration")}function s4(r){return r.importKind==="type"||r.importKind==="typeof"}const Xoe={const:"declare export var",let:"declare export var",type:"export type",interface:"export interface"};function Joe(r,e){const t=[],n=[];for(let i=0;i<r.length;i++)(e(r[i],i,r)?t:n).push(r[i]);return[t,n]}const qoe=/\*?\s*@((?:no)?flow)\b/;var Yoe=r=>class extends r{constructor(...t){super(...t),this.flowPragma=void 0}getScopeHandler(){return Hoe}shouldParseTypes(){return this.getPluginOption("flow","all")||this.flowPragma==="flow"}finishToken(t,n){t!==134&&t!==13&&t!==28&&this.flowPragma===void 0&&(this.flowPragma=null),super.finishToken(t,n)}addComment(t){if(this.flowPragma===void 0){const n=qoe.exec(t.value);if(n)if(n[1]==="flow")this.flowPragma="flow";else if(n[1]==="noflow")this.flowPragma="noflow";else throw new Error("Unexpected flow pragma")}super.addComment(t)}flowParseTypeInitialiser(t){const n=this.state.inType;this.state.inType=!0,this.expect(t||14);const i=this.flowParseType();return this.state.inType=n,i}flowParsePredicate(){const t=this.startNode(),n=this.state.startLoc;return this.next(),this.expectContextual(110),this.state.lastTokStartLoc.index>n.index+1&&this.raise(Sr.UnexpectedSpaceBetweenModuloChecks,n),this.eat(10)?(t.value=super.parseExpression(),this.expect(11),this.finishNode(t,"DeclaredPredicate")):this.finishNode(t,"InferredPredicate")}flowParseTypeAndPredicateInitialiser(){const t=this.state.inType;this.state.inType=!0,this.expect(14);let n=null,i=null;return this.match(54)?(this.state.inType=t,i=this.flowParsePredicate()):(n=this.flowParseType(),this.state.inType=t,this.match(54)&&(i=this.flowParsePredicate())),[n,i]}flowParseDeclareClass(t){return this.next(),this.flowParseInterfaceish(t,!0),this.finishNode(t,"DeclareClass")}flowParseDeclareFunction(t){this.next();const n=t.id=this.parseIdentifier(),i=this.startNode(),s=this.startNode();this.match(47)?i.typeParameters=this.flowParseTypeParameterDeclaration():i.typeParameters=null,this.expect(10);const a=this.flowParseFunctionTypeParams();return i.params=a.params,i.rest=a.rest,i.this=a._this,this.expect(11),[i.returnType,t.predicate]=this.flowParseTypeAndPredicateInitialiser(),s.typeAnnotation=this.finishNode(i,"FunctionTypeAnnotation"),n.typeAnnotation=this.finishNode(s,"TypeAnnotation"),this.resetEndLocation(n),this.semicolon(),this.scope.declareName(t.id.name,2048,t.id.loc.start),this.finishNode(t,"DeclareFunction")}flowParseDeclare(t,n){if(this.match(80))return this.flowParseDeclareClass(t);if(this.match(68))return this.flowParseDeclareFunction(t);if(this.match(74))return this.flowParseDeclareVariable(t);if(this.eatContextual(127))return this.match(16)?this.flowParseDeclareModuleExports(t):(n&&this.raise(Sr.NestedDeclareModule,this.state.lastTokStartLoc),this.flowParseDeclareModule(t));if(this.isContextual(130))return this.flowParseDeclareTypeAlias(t);if(this.isContextual(131))return this.flowParseDeclareOpaqueType(t);if(this.isContextual(129))return this.flowParseDeclareInterface(t);if(this.match(82))return this.flowParseDeclareExportDeclaration(t,n);throw this.unexpected()}flowParseDeclareVariable(t){return this.next(),t.id=this.flowParseTypeAnnotatableIdentifier(!0),this.scope.declareName(t.id.name,5,t.id.loc.start),this.semicolon(),this.finishNode(t,"DeclareVariable")}flowParseDeclareModule(t){this.scope.enter(0),this.match(134)?t.id=super.parseExprAtom():t.id=this.parseIdentifier();const n=t.body=this.startNode(),i=n.body=[];for(this.expect(5);!this.match(8);){const o=this.startNode();this.match(83)?(this.next(),!this.isContextual(130)&&!this.match(87)&&this.raise(Sr.InvalidNonTypeImportInDeclareModule,this.state.lastTokStartLoc),i.push(super.parseImport(o))):(this.expectContextual(125,Sr.UnsupportedStatementInDeclareModule),i.push(this.flowParseDeclare(o,!0)))}this.scope.exit(),this.expect(8),this.finishNode(n,"BlockStatement");let s=null,a=!1;return i.forEach(o=>{Koe(o)?(s==="CommonJS"&&this.raise(Sr.AmbiguousDeclareModuleKind,o),s="ES"):o.type==="DeclareModuleExports"&&(a&&this.raise(Sr.DuplicateDeclareModuleExports,o),s==="ES"&&this.raise(Sr.AmbiguousDeclareModuleKind,o),s="CommonJS",a=!0)}),t.kind=s||"CommonJS",this.finishNode(t,"DeclareModule")}flowParseDeclareExportDeclaration(t,n){if(this.expect(82),this.eat(65))return this.match(68)||this.match(80)?t.declaration=this.flowParseDeclare(this.startNode()):(t.declaration=this.flowParseType(),this.semicolon()),t.default=!0,this.finishNode(t,"DeclareExportDeclaration");if(this.match(75)||this.isLet()||(this.isContextual(130)||this.isContextual(129))&&!n){const i=this.state.value;throw this.raise(Sr.UnsupportedDeclareExportKind,this.state.startLoc,{unsupportedExportKind:i,suggestion:Xoe[i]})}if(this.match(74)||this.match(68)||this.match(80)||this.isContextual(131))return t.declaration=this.flowParseDeclare(this.startNode()),t.default=!1,this.finishNode(t,"DeclareExportDeclaration");if(this.match(55)||this.match(5)||this.isContextual(129)||this.isContextual(130)||this.isContextual(131))return t=this.parseExport(t,null),t.type==="ExportNamedDeclaration"?(t.default=!1,delete t.exportKind,this.castNodeTo(t,"DeclareExportDeclaration")):this.castNodeTo(t,"DeclareExportAllDeclaration");throw this.unexpected()}flowParseDeclareModuleExports(t){return this.next(),this.expectContextual(111),t.typeAnnotation=this.flowParseTypeAnnotation(),this.semicolon(),this.finishNode(t,"DeclareModuleExports")}flowParseDeclareTypeAlias(t){this.next();const n=this.flowParseTypeAlias(t);return this.castNodeTo(n,"DeclareTypeAlias"),n}flowParseDeclareOpaqueType(t){this.next();const n=this.flowParseOpaqueType(t,!0);return this.castNodeTo(n,"DeclareOpaqueType"),n}flowParseDeclareInterface(t){return this.next(),this.flowParseInterfaceish(t,!1),this.finishNode(t,"DeclareInterface")}flowParseInterfaceish(t,n){if(t.id=this.flowParseRestrictedIdentifier(!n,!0),this.scope.declareName(t.id.name,n?17:8201,t.id.loc.start),this.match(47)?t.typeParameters=this.flowParseTypeParameterDeclaration():t.typeParameters=null,t.extends=[],this.eat(81))do t.extends.push(this.flowParseInterfaceExtends());while(!n&&this.eat(12));if(n){if(t.implements=[],t.mixins=[],this.eatContextual(117))do t.mixins.push(this.flowParseInterfaceExtends());while(this.eat(12));if(this.eatContextual(113))do t.implements.push(this.flowParseInterfaceExtends());while(this.eat(12))}t.body=this.flowParseObjectType({allowStatic:n,allowExact:!1,allowSpread:!1,allowProto:n,allowInexact:!1})}flowParseInterfaceExtends(){const t=this.startNode();return t.id=this.flowParseQualifiedTypeIdentifier(),this.match(47)?t.typeParameters=this.flowParseTypeParameterInstantiation():t.typeParameters=null,this.finishNode(t,"InterfaceExtends")}flowParseInterface(t){return this.flowParseInterfaceish(t,!1),this.finishNode(t,"InterfaceDeclaration")}checkNotUnderscore(t){t==="_"&&this.raise(Sr.UnexpectedReservedUnderscore,this.state.startLoc)}checkReservedType(t,n,i){Woe.has(t)&&this.raise(i?Sr.AssignReservedType:Sr.UnexpectedReservedType,n,{reservedType:t})}flowParseRestrictedIdentifier(t,n){return this.checkReservedType(this.state.value,this.state.startLoc,n),this.parseIdentifier(t)}flowParseTypeAlias(t){return t.id=this.flowParseRestrictedIdentifier(!1,!0),this.scope.declareName(t.id.name,8201,t.id.loc.start),this.match(47)?t.typeParameters=this.flowParseTypeParameterDeclaration():t.typeParameters=null,t.right=this.flowParseTypeInitialiser(29),this.semicolon(),this.finishNode(t,"TypeAlias")}flowParseOpaqueType(t,n){return this.expectContextual(130),t.id=this.flowParseRestrictedIdentifier(!0,!0),this.scope.declareName(t.id.name,8201,t.id.loc.start),this.match(47)?t.typeParameters=this.flowParseTypeParameterDeclaration():t.typeParameters=null,t.supertype=null,this.match(14)&&(t.supertype=this.flowParseTypeInitialiser(14)),t.impltype=null,n||(t.impltype=this.flowParseTypeInitialiser(29)),this.semicolon(),this.finishNode(t,"OpaqueType")}flowParseTypeParameter(t=!1){const n=this.state.startLoc,i=this.startNode(),s=this.flowParseVariance(),a=this.flowParseTypeAnnotatableIdentifier();return i.name=a.name,i.variance=s,i.bound=a.typeAnnotation,this.match(29)?(this.eat(29),i.default=this.flowParseType()):t&&this.raise(Sr.MissingTypeParamDefault,n),this.finishNode(i,"TypeParameter")}flowParseTypeParameterDeclaration(){const t=this.state.inType,n=this.startNode();n.params=[],this.state.inType=!0,this.match(47)||this.match(143)?this.next():this.unexpected();let i=!1;do{const s=this.flowParseTypeParameter(i);n.params.push(s),s.default&&(i=!0),this.match(48)||this.expect(12)}while(!this.match(48));return this.expect(48),this.state.inType=t,this.finishNode(n,"TypeParameterDeclaration")}flowInTopLevelContext(t){if(this.curContext()!==Sn.brace){const n=this.state.context;this.state.context=[n[0]];try{return t()}finally{this.state.context=n}}else return t()}flowParseTypeParameterInstantiationInExpression(){if(this.reScan_lt()===47)return this.flowParseTypeParameterInstantiation()}flowParseTypeParameterInstantiation(){const t=this.startNode(),n=this.state.inType;return this.state.inType=!0,t.params=[],this.flowInTopLevelContext(()=>{this.expect(47);const i=this.state.noAnonFunctionType;for(this.state.noAnonFunctionType=!1;!this.match(48);)t.params.push(this.flowParseType()),this.match(48)||this.expect(12);this.state.noAnonFunctionType=i}),this.state.inType=n,!this.state.inType&&this.curContext()===Sn.brace&&this.reScan_lt_gt(),this.expect(48),this.finishNode(t,"TypeParameterInstantiation")}flowParseTypeParameterInstantiationCallOrNew(){if(this.reScan_lt()!==47)return null;const t=this.startNode(),n=this.state.inType;for(t.params=[],this.state.inType=!0,this.expect(47);!this.match(48);)t.params.push(this.flowParseTypeOrImplicitInstantiation()),this.match(48)||this.expect(12);return this.expect(48),this.state.inType=n,this.finishNode(t,"TypeParameterInstantiation")}flowParseInterfaceType(){const t=this.startNode();if(this.expectContextual(129),t.extends=[],this.eat(81))do t.extends.push(this.flowParseInterfaceExtends());while(this.eat(12));return t.body=this.flowParseObjectType({allowStatic:!1,allowExact:!1,allowSpread:!1,allowProto:!1,allowInexact:!1}),this.finishNode(t,"InterfaceTypeAnnotation")}flowParseObjectPropertyKey(){return this.match(135)||this.match(134)?super.parseExprAtom():this.parseIdentifier(!0)}flowParseObjectTypeIndexer(t,n,i){return t.static=n,this.lookahead().type===14?(t.id=this.flowParseObjectPropertyKey(),t.key=this.flowParseTypeInitialiser()):(t.id=null,t.key=this.flowParseType()),this.expect(3),t.value=this.flowParseTypeInitialiser(),t.variance=i,this.finishNode(t,"ObjectTypeIndexer")}flowParseObjectTypeInternalSlot(t,n){return t.static=n,t.id=this.flowParseObjectPropertyKey(),this.expect(3),this.expect(3),this.match(47)||this.match(10)?(t.method=!0,t.optional=!1,t.value=this.flowParseObjectTypeMethodish(this.startNodeAt(t.loc.start))):(t.method=!1,this.eat(17)&&(t.optional=!0),t.value=this.flowParseTypeInitialiser()),this.finishNode(t,"ObjectTypeInternalSlot")}flowParseObjectTypeMethodish(t){for(t.params=[],t.rest=null,t.typeParameters=null,t.this=null,this.match(47)&&(t.typeParameters=this.flowParseTypeParameterDeclaration()),this.expect(10),this.match(78)&&(t.this=this.flowParseFunctionTypeParam(!0),t.this.name=null,this.match(11)||this.expect(12));!this.match(11)&&!this.match(21);)t.params.push(this.flowParseFunctionTypeParam(!1)),this.match(11)||this.expect(12);return this.eat(21)&&(t.rest=this.flowParseFunctionTypeParam(!1)),this.expect(11),t.returnType=this.flowParseTypeInitialiser(),this.finishNode(t,"FunctionTypeAnnotation")}flowParseObjectTypeCallProperty(t,n){const i=this.startNode();return t.static=n,t.value=this.flowParseObjectTypeMethodish(i),this.finishNode(t,"ObjectTypeCallProperty")}flowParseObjectType({allowStatic:t,allowExact:n,allowSpread:i,allowProto:s,allowInexact:a}){const o=this.state.inType;this.state.inType=!0;const u=this.startNode();u.callProperties=[],u.properties=[],u.indexers=[],u.internalSlots=[];let f,g,y=!1;for(n&&this.match(6)?(this.expect(6),f=9,g=!0):(this.expect(5),f=8,g=!1),u.exact=g;!this.match(f);){let C=!1,M=null,k=null;const D=this.startNode();if(s&&this.isContextual(118)){const W=this.lookahead();W.type!==14&&W.type!==17&&(this.next(),M=this.state.startLoc,t=!1)}if(t&&this.isContextual(106)){const W=this.lookahead();W.type!==14&&W.type!==17&&(this.next(),C=!0)}const V=this.flowParseVariance();if(this.eat(0))M!=null&&this.unexpected(M),this.eat(0)?(V&&this.unexpected(V.loc.start),u.internalSlots.push(this.flowParseObjectTypeInternalSlot(D,C))):u.indexers.push(this.flowParseObjectTypeIndexer(D,C,V));else if(this.match(10)||this.match(47))M!=null&&this.unexpected(M),V&&this.unexpected(V.loc.start),u.callProperties.push(this.flowParseObjectTypeCallProperty(D,C));else{let W="init";if(this.isContextual(99)||this.isContextual(104)){const $=this.lookahead();v7($.type)&&(W=this.state.value,this.next())}const z=this.flowParseObjectTypeProperty(D,C,M,V,W,i,a??!g);z===null?(y=!0,k=this.state.lastTokStartLoc):u.properties.push(z)}this.flowObjectTypeSemicolon(),k&&!this.match(8)&&!this.match(9)&&this.raise(Sr.UnexpectedExplicitInexactInObject,k)}this.expect(f),i&&(u.inexact=y);const A=this.finishNode(u,"ObjectTypeAnnotation");return this.state.inType=o,A}flowParseObjectTypeProperty(t,n,i,s,a,o,u){if(this.eat(21))return this.match(12)||this.match(13)||this.match(8)||this.match(9)?(o?u||this.raise(Sr.InexactInsideExact,this.state.lastTokStartLoc):this.raise(Sr.InexactInsideNonObject,this.state.lastTokStartLoc),s&&this.raise(Sr.InexactVariance,s),null):(o||this.raise(Sr.UnexpectedSpreadType,this.state.lastTokStartLoc),i!=null&&this.unexpected(i),s&&this.raise(Sr.SpreadVariance,s),t.argument=this.flowParseType(),this.finishNode(t,"ObjectTypeSpreadProperty"));{t.key=this.flowParseObjectPropertyKey(),t.static=n,t.proto=i!=null,t.kind=a;let f=!1;return this.match(47)||this.match(10)?(t.method=!0,i!=null&&this.unexpected(i),s&&this.unexpected(s.loc.start),t.value=this.flowParseObjectTypeMethodish(this.startNodeAt(t.loc.start)),(a==="get"||a==="set")&&this.flowCheckGetterSetterParams(t),!o&&t.key.name==="constructor"&&t.value.this&&this.raise(Sr.ThisParamBannedInConstructor,t.value.this)):(a!=="init"&&this.unexpected(),t.method=!1,this.eat(17)&&(f=!0),t.value=this.flowParseTypeInitialiser(),t.variance=s),t.optional=f,this.finishNode(t,"ObjectTypeProperty")}}flowCheckGetterSetterParams(t){const n=t.kind==="get"?0:1,i=t.value.params.length+(t.value.rest?1:0);t.value.this&&this.raise(t.kind==="get"?Sr.GetterMayNotHaveThisParam:Sr.SetterMayNotHaveThisParam,t.value.this),i!==n&&this.raise(t.kind==="get"?Ne.BadGetterArity:Ne.BadSetterArity,t),t.kind==="set"&&t.value.rest&&this.raise(Ne.BadSetterRestParameter,t)}flowObjectTypeSemicolon(){!this.eat(13)&&!this.eat(12)&&!this.match(8)&&!this.match(9)&&this.unexpected()}flowParseQualifiedTypeIdentifier(t,n){t??(t=this.state.startLoc);let i=n||this.flowParseRestrictedIdentifier(!0);for(;this.eat(16);){const s=this.startNodeAt(t);s.qualification=i,s.id=this.flowParseRestrictedIdentifier(!0),i=this.finishNode(s,"QualifiedTypeIdentifier")}return i}flowParseGenericType(t,n){const i=this.startNodeAt(t);return i.typeParameters=null,i.id=this.flowParseQualifiedTypeIdentifier(t,n),this.match(47)&&(i.typeParameters=this.flowParseTypeParameterInstantiation()),this.finishNode(i,"GenericTypeAnnotation")}flowParseTypeofType(){const t=this.startNode();return this.expect(87),t.argument=this.flowParsePrimaryType(),this.finishNode(t,"TypeofTypeAnnotation")}flowParseTupleType(){const t=this.startNode();for(t.types=[],this.expect(0);this.state.pos<this.length&&!this.match(3)&&(t.types.push(this.flowParseType()),!this.match(3));)this.expect(12);return this.expect(3),this.finishNode(t,"TupleTypeAnnotation")}flowParseFunctionTypeParam(t){let n=null,i=!1,s=null;const a=this.startNode(),o=this.lookahead(),u=this.state.type===78;return o.type===14||o.type===17?(u&&!t&&this.raise(Sr.ThisParamMustBeFirst,a),n=this.parseIdentifier(u),this.eat(17)&&(i=!0,u&&this.raise(Sr.ThisParamMayNotBeOptional,a)),s=this.flowParseTypeInitialiser()):s=this.flowParseType(),a.name=n,a.optional=i,a.typeAnnotation=s,this.finishNode(a,"FunctionTypeParam")}reinterpretTypeAsFunctionTypeParam(t){const n=this.startNodeAt(t.loc.start);return n.name=null,n.optional=!1,n.typeAnnotation=t,this.finishNode(n,"FunctionTypeParam")}flowParseFunctionTypeParams(t=[]){let n=null,i=null;for(this.match(78)&&(i=this.flowParseFunctionTypeParam(!0),i.name=null,this.match(11)||this.expect(12));!this.match(11)&&!this.match(21);)t.push(this.flowParseFunctionTypeParam(!1)),this.match(11)||this.expect(12);return this.eat(21)&&(n=this.flowParseFunctionTypeParam(!1)),{params:t,rest:n,_this:i}}flowIdentToTypeAnnotation(t,n,i){switch(i.name){case"any":return this.finishNode(n,"AnyTypeAnnotation");case"bool":case"boolean":return this.finishNode(n,"BooleanTypeAnnotation");case"mixed":return this.finishNode(n,"MixedTypeAnnotation");case"empty":return this.finishNode(n,"EmptyTypeAnnotation");case"number":return this.finishNode(n,"NumberTypeAnnotation");case"string":return this.finishNode(n,"StringTypeAnnotation");case"symbol":return this.finishNode(n,"SymbolTypeAnnotation");default:return this.checkNotUnderscore(i.name),this.flowParseGenericType(t,i)}}flowParsePrimaryType(){const t=this.state.startLoc,n=this.startNode();let i,s,a=!1;const o=this.state.noAnonFunctionType;switch(this.state.type){case 5:return this.flowParseObjectType({allowStatic:!1,allowExact:!1,allowSpread:!0,allowProto:!1,allowInexact:!0});case 6:return this.flowParseObjectType({allowStatic:!1,allowExact:!0,allowSpread:!0,allowProto:!1,allowInexact:!1});case 0:return this.state.noAnonFunctionType=!1,s=this.flowParseTupleType(),this.state.noAnonFunctionType=o,s;case 47:{const u=this.startNode();return u.typeParameters=this.flowParseTypeParameterDeclaration(),this.expect(10),i=this.flowParseFunctionTypeParams(),u.params=i.params,u.rest=i.rest,u.this=i._this,this.expect(11),this.expect(19),u.returnType=this.flowParseType(),this.finishNode(u,"FunctionTypeAnnotation")}case 10:{const u=this.startNode();if(this.next(),!this.match(11)&&!this.match(21))if(Dn(this.state.type)||this.match(78)){const f=this.lookahead().type;a=f!==17&&f!==14}else a=!0;if(a){if(this.state.noAnonFunctionType=!1,s=this.flowParseType(),this.state.noAnonFunctionType=o,this.state.noAnonFunctionType||!(this.match(12)||this.match(11)&&this.lookahead().type===19))return this.expect(11),s;this.eat(12)}return s?i=this.flowParseFunctionTypeParams([this.reinterpretTypeAsFunctionTypeParam(s)]):i=this.flowParseFunctionTypeParams(),u.params=i.params,u.rest=i.rest,u.this=i._this,this.expect(11),this.expect(19),u.returnType=this.flowParseType(),u.typeParameters=null,this.finishNode(u,"FunctionTypeAnnotation")}case 134:return this.parseLiteral(this.state.value,"StringLiteralTypeAnnotation");case 85:case 86:return n.value=this.match(85),this.next(),this.finishNode(n,"BooleanLiteralTypeAnnotation");case 53:if(this.state.value==="-"){if(this.next(),this.match(135))return this.parseLiteralAtNode(-this.state.value,"NumberLiteralTypeAnnotation",n);if(this.match(136))return this.parseLiteralAtNode(-this.state.value,"BigIntLiteralTypeAnnotation",n);throw this.raise(Sr.UnexpectedSubtractionOperand,this.state.startLoc)}throw this.unexpected();case 135:return this.parseLiteral(this.state.value,"NumberLiteralTypeAnnotation");case 136:return this.parseLiteral(this.state.value,"BigIntLiteralTypeAnnotation");case 88:return this.next(),this.finishNode(n,"VoidTypeAnnotation");case 84:return this.next(),this.finishNode(n,"NullLiteralTypeAnnotation");case 78:return this.next(),this.finishNode(n,"ThisTypeAnnotation");case 55:return this.next(),this.finishNode(n,"ExistsTypeAnnotation");case 87:return this.flowParseTypeofType();default:if(HR(this.state.type)){const u=gd(this.state.type);return this.next(),super.createIdentifier(n,u)}else if(Dn(this.state.type))return this.isContextual(129)?this.flowParseInterfaceType():this.flowIdentToTypeAnnotation(t,n,this.parseIdentifier())}throw this.unexpected()}flowParsePostfixType(){const t=this.state.startLoc;let n=this.flowParsePrimaryType(),i=!1;for(;(this.match(0)||this.match(18))&&!this.canInsertSemicolon();){const s=this.startNodeAt(t),a=this.eat(18);i=i||a,this.expect(0),!a&&this.match(3)?(s.elementType=n,this.next(),n=this.finishNode(s,"ArrayTypeAnnotation")):(s.objectType=n,s.indexType=this.flowParseType(),this.expect(3),i?(s.optional=a,n=this.finishNode(s,"OptionalIndexedAccessType")):n=this.finishNode(s,"IndexedAccessType"))}return n}flowParsePrefixType(){const t=this.startNode();return this.eat(17)?(t.typeAnnotation=this.flowParsePrefixType(),this.finishNode(t,"NullableTypeAnnotation")):this.flowParsePostfixType()}flowParseAnonFunctionWithoutParens(){const t=this.flowParsePrefixType();if(!this.state.noAnonFunctionType&&this.eat(19)){const n=this.startNodeAt(t.loc.start);return n.params=[this.reinterpretTypeAsFunctionTypeParam(t)],n.rest=null,n.this=null,n.returnType=this.flowParseType(),n.typeParameters=null,this.finishNode(n,"FunctionTypeAnnotation")}return t}flowParseIntersectionType(){const t=this.startNode();this.eat(45);const n=this.flowParseAnonFunctionWithoutParens();for(t.types=[n];this.eat(45);)t.types.push(this.flowParseAnonFunctionWithoutParens());return t.types.length===1?n:this.finishNode(t,"IntersectionTypeAnnotation")}flowParseUnionType(){const t=this.startNode();this.eat(43);const n=this.flowParseIntersectionType();for(t.types=[n];this.eat(43);)t.types.push(this.flowParseIntersectionType());return t.types.length===1?n:this.finishNode(t,"UnionTypeAnnotation")}flowParseType(){const t=this.state.inType;this.state.inType=!0;const n=this.flowParseUnionType();return this.state.inType=t,n}flowParseTypeOrImplicitInstantiation(){if(this.state.type===132&&this.state.value==="_"){const t=this.state.startLoc,n=this.parseIdentifier();return this.flowParseGenericType(t,n)}else return this.flowParseType()}flowParseTypeAnnotation(){const t=this.startNode();return t.typeAnnotation=this.flowParseTypeInitialiser(),this.finishNode(t,"TypeAnnotation")}flowParseTypeAnnotatableIdentifier(t){const n=t?this.parseIdentifier():this.flowParseRestrictedIdentifier();return this.match(14)&&(n.typeAnnotation=this.flowParseTypeAnnotation(),this.resetEndLocation(n)),n}typeCastToParameter(t){return t.expression.typeAnnotation=t.typeAnnotation,this.resetEndLocation(t.expression,t.typeAnnotation.loc.end),t.expression}flowParseVariance(){let t=null;return this.match(53)?(t=this.startNode(),this.state.value==="+"?t.kind="plus":t.kind="minus",this.next(),this.finishNode(t,"Variance")):t}parseFunctionBody(t,n,i=!1){if(n){this.forwardNoArrowParamsConversionAt(t,()=>super.parseFunctionBody(t,!0,i));return}super.parseFunctionBody(t,!1,i)}parseFunctionBodyAndFinish(t,n,i=!1){if(this.match(14)){const s=this.startNode();[s.typeAnnotation,t.predicate]=this.flowParseTypeAndPredicateInitialiser(),t.returnType=s.typeAnnotation?this.finishNode(s,"TypeAnnotation"):null}return super.parseFunctionBodyAndFinish(t,n,i)}parseStatementLike(t){if(this.state.strict&&this.isContextual(129)){const i=this.lookahead();if(Wl(i.type)){const s=this.startNode();return this.next(),this.flowParseInterface(s)}}else if(this.isContextual(126)){const i=this.startNode();return this.next(),this.flowParseEnumDeclaration(i)}const n=super.parseStatementLike(t);return this.flowPragma===void 0&&!this.isValidDirective(n)&&(this.flowPragma=null),n}parseExpressionStatement(t,n,i){if(n.type==="Identifier"){if(n.name==="declare"){if(this.match(80)||Dn(this.state.type)||this.match(68)||this.match(74)||this.match(82))return this.flowParseDeclare(t)}else if(Dn(this.state.type)){if(n.name==="interface")return this.flowParseInterface(t);if(n.name==="type")return this.flowParseTypeAlias(t);if(n.name==="opaque")return this.flowParseOpaqueType(t,!1)}}return super.parseExpressionStatement(t,n,i)}shouldParseExportDeclaration(){const{type:t}=this.state;return t===126||i4(t)?!this.state.containsEsc:super.shouldParseExportDeclaration()}isExportDefaultSpecifier(){const{type:t}=this.state;return t===126||i4(t)?this.state.containsEsc:super.isExportDefaultSpecifier()}parseExportDefaultExpression(){if(this.isContextual(126)){const t=this.startNode();return this.next(),this.flowParseEnumDeclaration(t)}return super.parseExportDefaultExpression()}parseConditional(t,n,i){if(!this.match(17))return t;if(this.state.maybeInArrowParameters){const A=this.lookaheadCharCode();if(A===44||A===61||A===58||A===41)return this.setOptionalParametersError(i),t}this.expect(17);const s=this.state.clone(),a=this.state.noArrowAt,o=this.startNodeAt(n);let{consequent:u,failed:f}=this.tryParseConditionalConsequent(),[g,y]=this.getArrowLikeExpressions(u);if(f||y.length>0){const A=[...a];if(y.length>0){this.state=s,this.state.noArrowAt=A;for(let C=0;C<y.length;C++)A.push(y[C].start);({consequent:u,failed:f}=this.tryParseConditionalConsequent()),[g,y]=this.getArrowLikeExpressions(u)}f&&g.length>1&&this.raise(Sr.AmbiguousConditionalArrow,s.startLoc),f&&g.length===1&&(this.state=s,A.push(g[0].start),this.state.noArrowAt=A,{consequent:u,failed:f}=this.tryParseConditionalConsequent())}return this.getArrowLikeExpressions(u,!0),this.state.noArrowAt=a,this.expect(14),o.test=t,o.consequent=u,o.alternate=this.forwardNoArrowParamsConversionAt(o,()=>this.parseMaybeAssign(void 0,void 0)),this.finishNode(o,"ConditionalExpression")}tryParseConditionalConsequent(){this.state.noArrowParamsConversionAt.push(this.state.start);const t=this.parseMaybeAssignAllowIn(),n=!this.match(14);return this.state.noArrowParamsConversionAt.pop(),{consequent:t,failed:n}}getArrowLikeExpressions(t,n){const i=[t],s=[];for(;i.length!==0;){const a=i.pop();a.type==="ArrowFunctionExpression"&&a.body.type!=="BlockStatement"?(a.typeParameters||!a.returnType?this.finishArrowValidation(a):s.push(a),i.push(a.body)):a.type==="ConditionalExpression"&&(i.push(a.consequent),i.push(a.alternate))}return n?(s.forEach(a=>this.finishArrowValidation(a)),[s,[]]):Joe(s,a=>a.params.every(o=>this.isAssignable(o,!0)))}finishArrowValidation(t){var n;this.toAssignableList(t.params,(n=t.extra)==null?void 0:n.trailingCommaLoc,!1),this.scope.enter(518),super.checkParams(t,!1,!0),this.scope.exit()}forwardNoArrowParamsConversionAt(t,n){let i;return this.state.noArrowParamsConversionAt.includes(this.offsetToSourcePos(t.start))?(this.state.noArrowParamsConversionAt.push(this.state.start),i=n(),this.state.noArrowParamsConversionAt.pop()):i=n(),i}parseParenItem(t,n){const i=super.parseParenItem(t,n);if(this.eat(17)&&(i.optional=!0,this.resetEndLocation(t)),this.match(14)){const s=this.startNodeAt(n);return s.expression=i,s.typeAnnotation=this.flowParseTypeAnnotation(),this.finishNode(s,"TypeCastExpression")}return i}assertModuleNodeAllowed(t){t.type==="ImportDeclaration"&&(t.importKind==="type"||t.importKind==="typeof")||t.type==="ExportNamedDeclaration"&&t.exportKind==="type"||t.type==="ExportAllDeclaration"&&t.exportKind==="type"||super.assertModuleNodeAllowed(t)}parseExportDeclaration(t){if(this.isContextual(130)){t.exportKind="type";const n=this.startNode();return this.next(),this.match(5)?(t.specifiers=this.parseExportSpecifiers(!0),super.parseExportFrom(t),null):this.flowParseTypeAlias(n)}else if(this.isContextual(131)){t.exportKind="type";const n=this.startNode();return this.next(),this.flowParseOpaqueType(n,!1)}else if(this.isContextual(129)){t.exportKind="type";const n=this.startNode();return this.next(),this.flowParseInterface(n)}else if(this.isContextual(126)){t.exportKind="value";const n=this.startNode();return this.next(),this.flowParseEnumDeclaration(n)}else return super.parseExportDeclaration(t)}eatExportStar(t){return super.eatExportStar(t)?!0:this.isContextual(130)&&this.lookahead().type===55?(t.exportKind="type",this.next(),this.next(),!0):!1}maybeParseExportNamespaceSpecifier(t){const{startLoc:n}=this.state,i=super.maybeParseExportNamespaceSpecifier(t);return i&&t.exportKind==="type"&&this.unexpected(n),i}parseClassId(t,n,i){super.parseClassId(t,n,i),this.match(47)&&(t.typeParameters=this.flowParseTypeParameterDeclaration())}parseClassMember(t,n,i){const{startLoc:s}=this.state;if(this.isContextual(125)){if(super.parseClassMemberFromModifier(t,n))return;n.declare=!0}super.parseClassMember(t,n,i),n.declare&&(n.type!=="ClassProperty"&&n.type!=="ClassPrivateProperty"&&n.type!=="PropertyDefinition"?this.raise(Sr.DeclareClassElement,s):n.value&&this.raise(Sr.DeclareClassFieldInitializer,n.value))}isIterator(t){return t==="iterator"||t==="asyncIterator"}readIterator(){const t=super.readWord1(),n="@@"+t;(!this.isIterator(t)||!this.state.inType)&&this.raise(Ne.InvalidIdentifier,this.state.curPosition(),{identifierName:n}),this.finishToken(132,n)}getTokenFromCode(t){const n=this.input.charCodeAt(this.state.pos+1);t===123&&n===124?this.finishOp(6,2):this.state.inType&&(t===62||t===60)?this.finishOp(t===62?48:47,1):this.state.inType&&t===63?n===46?this.finishOp(18,2):this.finishOp(17,1):Voe(t,n,this.input.charCodeAt(this.state.pos+2))?(this.state.pos+=2,this.readIterator()):super.getTokenFromCode(t)}isAssignable(t,n){return t.type==="TypeCastExpression"?this.isAssignable(t.expression,n):super.isAssignable(t,n)}toAssignable(t,n=!1){!n&&t.type==="AssignmentExpression"&&t.left.type==="TypeCastExpression"&&(t.left=this.typeCastToParameter(t.left)),super.toAssignable(t,n)}toAssignableList(t,n,i){for(let s=0;s<t.length;s++){const a=t[s];a?.type==="TypeCastExpression"&&(t[s]=this.typeCastToParameter(a))}super.toAssignableList(t,n,i)}toReferencedList(t,n){for(let s=0;s<t.length;s++){var i;const a=t[s];a&&a.type==="TypeCastExpression"&&!((i=a.extra)!=null&&i.parenthesized)&&(t.length>1||!n)&&this.raise(Sr.TypeCastInPattern,a.typeAnnotation)}return t}parseArrayLike(t,n,i){const s=super.parseArrayLike(t,n,i);return i!=null&&!this.state.maybeInArrowParameters&&this.toReferencedList(s.elements),s}isValidLVal(t,n,i,s){return t==="TypeCastExpression"||super.isValidLVal(t,n,i,s)}parseClassProperty(t){return this.match(14)&&(t.typeAnnotation=this.flowParseTypeAnnotation()),super.parseClassProperty(t)}parseClassPrivateProperty(t){return this.match(14)&&(t.typeAnnotation=this.flowParseTypeAnnotation()),super.parseClassPrivateProperty(t)}isClassMethod(){return this.match(47)||super.isClassMethod()}isClassProperty(){return this.match(14)||super.isClassProperty()}isNonstaticConstructor(t){return!this.match(14)&&super.isNonstaticConstructor(t)}pushClassMethod(t,n,i,s,a,o){if(n.variance&&this.unexpected(n.variance.loc.start),delete n.variance,this.match(47)&&(n.typeParameters=this.flowParseTypeParameterDeclaration()),super.pushClassMethod(t,n,i,s,a,o),n.params&&a){const u=n.params;u.length>0&&this.isThisParam(u[0])&&this.raise(Sr.ThisParamBannedInConstructor,n)}else if(n.type==="MethodDefinition"&&a&&n.value.params){const u=n.value.params;u.length>0&&this.isThisParam(u[0])&&this.raise(Sr.ThisParamBannedInConstructor,n)}}pushClassPrivateMethod(t,n,i,s){n.variance&&this.unexpected(n.variance.loc.start),delete n.variance,this.match(47)&&(n.typeParameters=this.flowParseTypeParameterDeclaration()),super.pushClassPrivateMethod(t,n,i,s)}parseClassSuper(t){if(super.parseClassSuper(t),t.superClass&&(this.match(47)||this.match(51))&&(t.superTypeParameters=this.flowParseTypeParameterInstantiationInExpression()),this.isContextual(113)){this.next();const n=t.implements=[];do{const i=this.startNode();i.id=this.flowParseRestrictedIdentifier(!0),this.match(47)?i.typeParameters=this.flowParseTypeParameterInstantiation():i.typeParameters=null,n.push(this.finishNode(i,"ClassImplements"))}while(this.eat(12))}}checkGetterSetterParams(t){super.checkGetterSetterParams(t);const n=this.getObjectOrClassMethodParams(t);if(n.length>0){const i=n[0];this.isThisParam(i)&&t.kind==="get"?this.raise(Sr.GetterMayNotHaveThisParam,i):this.isThisParam(i)&&this.raise(Sr.SetterMayNotHaveThisParam,i)}}parsePropertyNamePrefixOperator(t){t.variance=this.flowParseVariance()}parseObjPropValue(t,n,i,s,a,o,u){t.variance&&this.unexpected(t.variance.loc.start),delete t.variance;let f;this.match(47)&&!o&&(f=this.flowParseTypeParameterDeclaration(),this.match(10)||this.unexpected());const g=super.parseObjPropValue(t,n,i,s,a,o,u);return f&&((g.value||g).typeParameters=f),g}parseFunctionParamType(t){return this.eat(17)&&(t.type!=="Identifier"&&this.raise(Sr.PatternIsOptional,t),this.isThisParam(t)&&this.raise(Sr.ThisParamMayNotBeOptional,t),t.optional=!0),this.match(14)?t.typeAnnotation=this.flowParseTypeAnnotation():this.isThisParam(t)&&this.raise(Sr.ThisParamAnnotationRequired,t),this.match(29)&&this.isThisParam(t)&&this.raise(Sr.ThisParamNoDefault,t),this.resetEndLocation(t),t}parseMaybeDefault(t,n){const i=super.parseMaybeDefault(t,n);return i.type==="AssignmentPattern"&&i.typeAnnotation&&i.right.start<i.typeAnnotation.start&&this.raise(Sr.TypeBeforeInitializer,i.typeAnnotation),i}checkImportReflection(t){super.checkImportReflection(t),t.module&&t.importKind!=="value"&&this.raise(Sr.ImportReflectionHasImportType,t.specifiers[0].loc.start)}parseImportSpecifierLocal(t,n,i){n.local=s4(t)?this.flowParseRestrictedIdentifier(!0,!0):this.parseIdentifier(),t.specifiers.push(this.finishImportSpecifier(n,i))}isPotentialImportPhase(t){if(super.isPotentialImportPhase(t))return!0;if(this.isContextual(130)){if(!t)return!0;const n=this.lookaheadCharCode();return n===123||n===42}return!t&&this.isContextual(87)}applyImportPhase(t,n,i,s){if(super.applyImportPhase(t,n,i,s),n){if(!i&&this.match(65))return;t.exportKind=i==="type"?i:"value"}else i==="type"&&this.match(55)&&this.unexpected(),t.importKind=i==="type"||i==="typeof"?i:"value"}parseImportSpecifier(t,n,i,s,a){const o=t.imported;let u=null;o.type==="Identifier"&&(o.name==="type"?u="type":o.name==="typeof"&&(u="typeof"));let f=!1;if(this.isContextual(93)&&!this.isLookaheadContextual("as")){const y=this.parseIdentifier(!0);u!==null&&!Wl(this.state.type)?(t.imported=y,t.importKind=u,t.local=this.cloneIdentifier(y)):(t.imported=o,t.importKind=null,t.local=this.parseIdentifier())}else{if(u!==null&&Wl(this.state.type))t.imported=this.parseIdentifier(!0),t.importKind=u;else{if(n)throw this.raise(Ne.ImportBindingIsString,t,{importName:o.value});t.imported=o,t.importKind=null}this.eatContextual(93)?t.local=this.parseIdentifier():(f=!0,t.local=this.cloneIdentifier(t.imported))}const g=s4(t);return i&&g&&this.raise(Sr.ImportTypeShorthandOnlyInPureImport,t),(i||g)&&this.checkReservedType(t.local.name,t.local.loc.start,!0),f&&!i&&!g&&this.checkReservedWord(t.local.name,t.loc.start,!0,!0),this.finishImportSpecifier(t,"ImportSpecifier")}parseBindingAtom(){switch(this.state.type){case 78:return this.parseIdentifier(!0);default:return super.parseBindingAtom()}}parseFunctionParams(t,n){const i=t.kind;i!=="get"&&i!=="set"&&this.match(47)&&(t.typeParameters=this.flowParseTypeParameterDeclaration()),super.parseFunctionParams(t,n)}parseVarId(t,n){super.parseVarId(t,n),this.match(14)&&(t.id.typeAnnotation=this.flowParseTypeAnnotation(),this.resetEndLocation(t.id))}parseAsyncArrowFromCallExpression(t,n){if(this.match(14)){const i=this.state.noAnonFunctionType;this.state.noAnonFunctionType=!0,t.returnType=this.flowParseTypeAnnotation(),this.state.noAnonFunctionType=i}return super.parseAsyncArrowFromCallExpression(t,n)}shouldParseAsyncArrow(){return this.match(14)||super.shouldParseAsyncArrow()}parseMaybeAssign(t,n){var i;let s=null,a;if(this.hasPlugin("jsx")&&(this.match(143)||this.match(47))){if(s=this.state.clone(),a=this.tryParse(()=>super.parseMaybeAssign(t,n),s),!a.error)return a.node;const{context:f}=this.state,g=f[f.length-1];(g===Sn.j_oTag||g===Sn.j_expr)&&f.pop()}if((i=a)!=null&&i.error||this.match(47)){var o,u;s=s||this.state.clone();let f;const g=this.tryParse(A=>{var C;f=this.flowParseTypeParameterDeclaration();const M=this.forwardNoArrowParamsConversionAt(f,()=>{const D=super.parseMaybeAssign(t,n);return this.resetStartLocationFromNode(D,f),D});(C=M.extra)!=null&&C.parenthesized&&A();const k=this.maybeUnwrapTypeCastExpression(M);return k.type!=="ArrowFunctionExpression"&&A(),k.typeParameters=f,this.resetStartLocationFromNode(k,f),M},s);let y=null;if(g.node&&this.maybeUnwrapTypeCastExpression(g.node).type==="ArrowFunctionExpression"){if(!g.error&&!g.aborted)return g.node.async&&this.raise(Sr.UnexpectedTypeParameterBeforeAsyncArrowFunction,f),g.node;y=g.node}if((o=a)!=null&&o.node)return this.state=a.failState,a.node;if(y)return this.state=g.failState,y;throw(u=a)!=null&&u.thrown?a.error:g.thrown?g.error:this.raise(Sr.UnexpectedTokenAfterTypeParameter,f)}return super.parseMaybeAssign(t,n)}parseArrow(t){if(this.match(14)){const n=this.tryParse(()=>{const i=this.state.noAnonFunctionType;this.state.noAnonFunctionType=!0;const s=this.startNode();return[s.typeAnnotation,t.predicate]=this.flowParseTypeAndPredicateInitialiser(),this.state.noAnonFunctionType=i,this.canInsertSemicolon()&&this.unexpected(),this.match(19)||this.unexpected(),s});if(n.thrown)return null;n.error&&(this.state=n.failState),t.returnType=n.node.typeAnnotation?this.finishNode(n.node,"TypeAnnotation"):null}return super.parseArrow(t)}shouldParseArrow(t){return this.match(14)||super.shouldParseArrow(t)}setArrowFunctionParameters(t,n){this.state.noArrowParamsConversionAt.includes(this.offsetToSourcePos(t.start))?t.params=n:super.setArrowFunctionParameters(t,n)}checkParams(t,n,i,s=!0){if(!(i&&this.state.noArrowParamsConversionAt.includes(this.offsetToSourcePos(t.start)))){for(let a=0;a<t.params.length;a++)this.isThisParam(t.params[a])&&a>0&&this.raise(Sr.ThisParamMustBeFirst,t.params[a]);super.checkParams(t,n,i,s)}}parseParenAndDistinguishExpression(t){return super.parseParenAndDistinguishExpression(t&&!this.state.noArrowAt.includes(this.sourceToOffsetPos(this.state.start)))}parseSubscripts(t,n,i){if(t.type==="Identifier"&&t.name==="async"&&this.state.noArrowAt.includes(n.index)){this.next();const s=this.startNodeAt(n);s.callee=t,s.arguments=super.parseCallExpressionArguments(),t=this.finishNode(s,"CallExpression")}else if(t.type==="Identifier"&&t.name==="async"&&this.match(47)){const s=this.state.clone(),a=this.tryParse(u=>this.parseAsyncArrowWithTypeParameters(n)||u(),s);if(!a.error&&!a.aborted)return a.node;const o=this.tryParse(()=>super.parseSubscripts(t,n,i),s);if(o.node&&!o.error)return o.node;if(a.node)return this.state=a.failState,a.node;if(o.node)return this.state=o.failState,o.node;throw a.error||o.error}return super.parseSubscripts(t,n,i)}parseSubscript(t,n,i,s){if(this.match(18)&&this.isLookaheadToken_lt()){if(s.optionalChainMember=!0,i)return s.stop=!0,t;this.next();const a=this.startNodeAt(n);return a.callee=t,a.typeArguments=this.flowParseTypeParameterInstantiationInExpression(),this.expect(10),a.arguments=this.parseCallExpressionArguments(),a.optional=!0,this.finishCallExpression(a,!0)}else if(!i&&this.shouldParseTypes()&&(this.match(47)||this.match(51))){const a=this.startNodeAt(n);a.callee=t;const o=this.tryParse(()=>(a.typeArguments=this.flowParseTypeParameterInstantiationCallOrNew(),this.expect(10),a.arguments=super.parseCallExpressionArguments(),s.optionalChainMember&&(a.optional=!1),this.finishCallExpression(a,s.optionalChainMember)));if(o.node)return o.error&&(this.state=o.failState),o.node}return super.parseSubscript(t,n,i,s)}parseNewCallee(t){super.parseNewCallee(t);let n=null;this.shouldParseTypes()&&this.match(47)&&(n=this.tryParse(()=>this.flowParseTypeParameterInstantiationCallOrNew()).node),t.typeArguments=n}parseAsyncArrowWithTypeParameters(t){const n=this.startNodeAt(t);if(this.parseFunctionParams(n,!1),!!this.parseArrow(n))return super.parseArrowExpression(n,void 0,!0)}readToken_mult_modulo(t){const n=this.input.charCodeAt(this.state.pos+1);if(t===42&&n===47&&this.state.hasFlowComment){this.state.hasFlowComment=!1,this.state.pos+=2,this.nextToken();return}super.readToken_mult_modulo(t)}readToken_pipe_amp(t){const n=this.input.charCodeAt(this.state.pos+1);if(t===124&&n===125){this.finishOp(9,2);return}super.readToken_pipe_amp(t)}parseTopLevel(t,n){const i=super.parseTopLevel(t,n);return this.state.hasFlowComment&&this.raise(Sr.UnterminatedFlowComment,this.state.curPosition()),i}skipBlockComment(){if(this.hasPlugin("flowComments")&&this.skipFlowComment()){if(this.state.hasFlowComment)throw this.raise(Sr.NestedFlowComment,this.state.startLoc);this.hasFlowCommentCompletion();const t=this.skipFlowComment();t&&(this.state.pos+=t,this.state.hasFlowComment=!0);return}return super.skipBlockComment(this.state.hasFlowComment?"*-/":"*/")}skipFlowComment(){const{pos:t}=this.state;let n=2;for(;[32,9].includes(this.input.charCodeAt(t+n));)n++;const i=this.input.charCodeAt(n+t),s=this.input.charCodeAt(n+t+1);return i===58&&s===58?n+2:this.input.slice(n+t,n+t+12)==="flow-include"?n+12:i===58&&s!==58?n:!1}hasFlowCommentCompletion(){if(this.input.indexOf("*/",this.state.pos)===-1)throw this.raise(Ne.UnterminatedComment,this.state.curPosition())}flowEnumErrorBooleanMemberNotInitialized(t,{enumName:n,memberName:i}){this.raise(Sr.EnumBooleanMemberNotInitialized,t,{memberName:i,enumName:n})}flowEnumErrorInvalidMemberInitializer(t,n){return this.raise(n.explicitType?n.explicitType==="symbol"?Sr.EnumInvalidMemberInitializerSymbolType:Sr.EnumInvalidMemberInitializerPrimaryType:Sr.EnumInvalidMemberInitializerUnknownType,t,n)}flowEnumErrorNumberMemberNotInitialized(t,n){this.raise(Sr.EnumNumberMemberNotInitialized,t,n)}flowEnumErrorStringMemberInconsistentlyInitialized(t,n){this.raise(Sr.EnumStringMemberInconsistentlyInitialized,t,n)}flowEnumMemberInit(){const t=this.state.startLoc,n=()=>this.match(12)||this.match(8);switch(this.state.type){case 135:{const i=this.parseNumericLiteral(this.state.value);return n()?{type:"number",loc:i.loc.start,value:i}:{type:"invalid",loc:t}}case 134:{const i=this.parseStringLiteral(this.state.value);return n()?{type:"string",loc:i.loc.start,value:i}:{type:"invalid",loc:t}}case 85:case 86:{const i=this.parseBooleanLiteral(this.match(85));return n()?{type:"boolean",loc:i.loc.start,value:i}:{type:"invalid",loc:t}}default:return{type:"invalid",loc:t}}}flowEnumMemberRaw(){const t=this.state.startLoc,n=this.parseIdentifier(!0),i=this.eat(29)?this.flowEnumMemberInit():{type:"none",loc:t};return{id:n,init:i}}flowEnumCheckExplicitTypeMismatch(t,n,i){const{explicitType:s}=n;s!==null&&s!==i&&this.flowEnumErrorInvalidMemberInitializer(t,n)}flowEnumMembers({enumName:t,explicitType:n}){const i=new Set,s={booleanMembers:[],numberMembers:[],stringMembers:[],defaultedMembers:[]};let a=!1;for(;!this.match(8);){if(this.eat(21)){a=!0;break}const o=this.startNode(),{id:u,init:f}=this.flowEnumMemberRaw(),g=u.name;if(g==="")continue;/^[a-z]/.test(g)&&this.raise(Sr.EnumInvalidMemberName,u,{memberName:g,suggestion:g[0].toUpperCase()+g.slice(1),enumName:t}),i.has(g)&&this.raise(Sr.EnumDuplicateMemberName,u,{memberName:g,enumName:t}),i.add(g);const y={enumName:t,explicitType:n,memberName:g};switch(o.id=u,f.type){case"boolean":{this.flowEnumCheckExplicitTypeMismatch(f.loc,y,"boolean"),o.init=f.value,s.booleanMembers.push(this.finishNode(o,"EnumBooleanMember"));break}case"number":{this.flowEnumCheckExplicitTypeMismatch(f.loc,y,"number"),o.init=f.value,s.numberMembers.push(this.finishNode(o,"EnumNumberMember"));break}case"string":{this.flowEnumCheckExplicitTypeMismatch(f.loc,y,"string"),o.init=f.value,s.stringMembers.push(this.finishNode(o,"EnumStringMember"));break}case"invalid":throw this.flowEnumErrorInvalidMemberInitializer(f.loc,y);case"none":switch(n){case"boolean":this.flowEnumErrorBooleanMemberNotInitialized(f.loc,y);break;case"number":this.flowEnumErrorNumberMemberNotInitialized(f.loc,y);break;default:s.defaultedMembers.push(this.finishNode(o,"EnumDefaultedMember"))}}this.match(8)||this.expect(12)}return{members:s,hasUnknownMembers:a}}flowEnumStringMembers(t,n,{enumName:i}){if(t.length===0)return n;if(n.length===0)return t;if(n.length>t.length){for(const s of t)this.flowEnumErrorStringMemberInconsistentlyInitialized(s,{enumName:i});return n}else{for(const s of n)this.flowEnumErrorStringMemberInconsistentlyInitialized(s,{enumName:i});return t}}flowEnumParseExplicitType({enumName:t}){if(!this.eatContextual(102))return null;if(!Dn(this.state.type))throw this.raise(Sr.EnumInvalidExplicitTypeUnknownSupplied,this.state.startLoc,{enumName:t});const{value:n}=this.state;return this.next(),n!=="boolean"&&n!=="number"&&n!=="string"&&n!=="symbol"&&this.raise(Sr.EnumInvalidExplicitType,this.state.startLoc,{enumName:t,invalidEnumType:n}),n}flowEnumBody(t,n){const i=n.name,s=n.loc.start,a=this.flowEnumParseExplicitType({enumName:i});this.expect(5);const{members:o,hasUnknownMembers:u}=this.flowEnumMembers({enumName:i,explicitType:a});switch(t.hasUnknownMembers=u,a){case"boolean":return t.explicitType=!0,t.members=o.booleanMembers,this.expect(8),this.finishNode(t,"EnumBooleanBody");case"number":return t.explicitType=!0,t.members=o.numberMembers,this.expect(8),this.finishNode(t,"EnumNumberBody");case"string":return t.explicitType=!0,t.members=this.flowEnumStringMembers(o.stringMembers,o.defaultedMembers,{enumName:i}),this.expect(8),this.finishNode(t,"EnumStringBody");case"symbol":return t.members=o.defaultedMembers,this.expect(8),this.finishNode(t,"EnumSymbolBody");default:{const f=()=>(t.members=[],this.expect(8),this.finishNode(t,"EnumStringBody"));t.explicitType=!1;const g=o.booleanMembers.length,y=o.numberMembers.length,A=o.stringMembers.length,C=o.defaultedMembers.length;if(!g&&!y&&!A&&!C)return f();if(!g&&!y)return t.members=this.flowEnumStringMembers(o.stringMembers,o.defaultedMembers,{enumName:i}),this.expect(8),this.finishNode(t,"EnumStringBody");if(!y&&!A&&g>=C){for(const M of o.defaultedMembers)this.flowEnumErrorBooleanMemberNotInitialized(M.loc.start,{enumName:i,memberName:M.id.name});return t.members=o.booleanMembers,this.expect(8),this.finishNode(t,"EnumBooleanBody")}else if(!g&&!A&&y>=C){for(const M of o.defaultedMembers)this.flowEnumErrorNumberMemberNotInitialized(M.loc.start,{enumName:i,memberName:M.id.name});return t.members=o.numberMembers,this.expect(8),this.finishNode(t,"EnumNumberBody")}else return this.raise(Sr.EnumInconsistentMemberValues,s,{enumName:i}),f()}}}flowParseEnumDeclaration(t){const n=this.parseIdentifier();return t.id=n,t.body=this.flowEnumBody(this.startNode(),n),this.finishNode(t,"EnumDeclaration")}jsxParseOpeningElementAfterName(t){return this.shouldParseTypes()&&(this.match(47)||this.match(51))&&(t.typeArguments=this.flowParseTypeParameterInstantiationInExpression()),super.jsxParseOpeningElementAfterName(t)}isLookaheadToken_lt(){const t=this.nextTokenStart();if(this.input.charCodeAt(t)===60){const n=this.input.charCodeAt(t+1);return n!==60&&n!==61}return!1}reScan_lt_gt(){const{type:t}=this.state;t===47?(this.state.pos-=1,this.readToken_lt()):t===48&&(this.state.pos-=1,this.readToken_gt())}reScan_lt(){const{type:t}=this.state;return t===51?(this.state.pos-=2,this.finishOp(47,1),47):t}maybeUnwrapTypeCastExpression(t){return t.type==="TypeCastExpression"?t.expression:t}};const Zoe={__proto__:null,quot:'"',amp:"&",apos:"'",lt:"<",gt:">",nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",fnof:"",circ:"",tilde:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",bull:"",hellip:"",permil:"",prime:"",Prime:"",lsaquo:"",rsaquo:"",oline:"",frasl:"",euro:"",image:"",weierp:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",lang:"",rang:"",loz:"",spades:"",clubs:"",hearts:"",diams:""},Qoe=/\r\n|[\r\n\u2028\u2029]/,z1=new RegExp(Qoe.source,"g");function Rm(r){switch(r){case 10:case 13:case 8232:case 8233:return!0;default:return!1}}function o4(r,e,t){for(let n=e;n<t;n++)if(Rm(r.charCodeAt(n)))return!0;return!1}const QE=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,eI=/(?:[^\S\n\r\u2028\u2029]|\/\/.*|\/\*.*?\*\/)*/g;function eae(r){switch(r){case 9:case 11:case 12:case 32:case 160:case 5760:case 8192:case 8193:case 8194:case 8195:case 8196:case 8197:case 8198:case 8199:case 8200:case 8201:case 8202:case 8239:case 8287:case 12288:case 65279:return!0;default:return!1}}const Af=Oc`jsx`({AttributeIsEmpty:"JSX attributes must only be assigned a non-empty expression.",MissingClosingTagElement:({openingTagName:r})=>`Expected corresponding JSX closing tag for <${r}>.`,MissingClosingTagFragment:"Expected corresponding JSX closing tag for <>.",UnexpectedSequenceExpression:"Sequence expressions cannot be directly nested inside JSX. Did you mean to wrap it in parentheses (...)?",UnexpectedToken:({unexpected:r,HTMLEntity:e})=>`Unexpected token \`${r}\`. Did you mean \`${e}\` or \`{'${r}'}\`?`,UnsupportedJsxValue:"JSX value should be either an expression or a quoted JSX text.",UnterminatedJsxContent:"Unterminated JSX contents.",UnwrappedAdjacentJSXElements:"Adjacent JSX elements must be wrapped in an enclosing tag. Did you want a JSX fragment <>...</>?"});function Lh(r){return r?r.type==="JSXOpeningFragment"||r.type==="JSXClosingFragment":!1}function fm(r){if(r.type==="JSXIdentifier")return r.name;if(r.type==="JSXNamespacedName")return r.namespace.name+":"+r.name.name;if(r.type==="JSXMemberExpression")return fm(r.object)+"."+fm(r.property);throw new Error("Node had unexpected type: "+r.type)}var tae=r=>class extends r{jsxReadToken(){let t="",n=this.state.pos;for(;;){if(this.state.pos>=this.length)throw this.raise(Af.UnterminatedJsxContent,this.state.startLoc);const i=this.input.charCodeAt(this.state.pos);switch(i){case 60:case 123:if(this.state.pos===this.state.start){i===60&&this.state.canStartJSXElement?(++this.state.pos,this.finishToken(143)):super.getTokenFromCode(i);return}t+=this.input.slice(n,this.state.pos),this.finishToken(142,t);return;case 38:t+=this.input.slice(n,this.state.pos),t+=this.jsxReadEntity(),n=this.state.pos;break;case 62:case 125:default:Rm(i)?(t+=this.input.slice(n,this.state.pos),t+=this.jsxReadNewLine(!0),n=this.state.pos):++this.state.pos}}}jsxReadNewLine(t){const n=this.input.charCodeAt(this.state.pos);let i;return++this.state.pos,n===13&&this.input.charCodeAt(this.state.pos)===10?(++this.state.pos,i=t?`
`:`\r
`):i=String.fromCharCode(n),++this.state.curLine,this.state.lineStart=this.state.pos,i}jsxReadString(t){let n="",i=++this.state.pos;for(;;){if(this.state.pos>=this.length)throw this.raise(Ne.UnterminatedString,this.state.startLoc);const s=this.input.charCodeAt(this.state.pos);if(s===t)break;s===38?(n+=this.input.slice(i,this.state.pos),n+=this.jsxReadEntity(),i=this.state.pos):Rm(s)?(n+=this.input.slice(i,this.state.pos),n+=this.jsxReadNewLine(!1),i=this.state.pos):++this.state.pos}n+=this.input.slice(i,this.state.pos++),this.finishToken(134,n)}jsxReadEntity(){const t=++this.state.pos;if(this.codePointAtPos(this.state.pos)===35){++this.state.pos;let n=10;this.codePointAtPos(this.state.pos)===120&&(n=16,++this.state.pos);const i=this.readInt(n,void 0,!1,"bail");if(i!==null&&this.codePointAtPos(this.state.pos)===59)return++this.state.pos,String.fromCodePoint(i)}else{let n=0,i=!1;for(;n++<10&&this.state.pos<this.length&&!(i=this.codePointAtPos(this.state.pos)===59);)++this.state.pos;if(i){const s=this.input.slice(t,this.state.pos),a=Zoe[s];if(++this.state.pos,a)return a}}return this.state.pos=t,"&"}jsxReadWord(){let t;const n=this.state.pos;do t=this.input.charCodeAt(++this.state.pos);while(Hf(t)||t===45);this.finishToken(141,this.input.slice(n,this.state.pos))}jsxParseIdentifier(){const t=this.startNode();return this.match(141)?t.name=this.state.value:HR(this.state.type)?t.name=gd(this.state.type):this.unexpected(),this.next(),this.finishNode(t,"JSXIdentifier")}jsxParseNamespacedName(){const t=this.state.startLoc,n=this.jsxParseIdentifier();if(!this.eat(14))return n;const i=this.startNodeAt(t);return i.namespace=n,i.name=this.jsxParseIdentifier(),this.finishNode(i,"JSXNamespacedName")}jsxParseElementName(){const t=this.state.startLoc;let n=this.jsxParseNamespacedName();if(n.type==="JSXNamespacedName")return n;for(;this.eat(16);){const i=this.startNodeAt(t);i.object=n,i.property=this.jsxParseIdentifier(),n=this.finishNode(i,"JSXMemberExpression")}return n}jsxParseAttributeValue(){let t;switch(this.state.type){case 5:return t=this.startNode(),this.setContext(Sn.brace),this.next(),t=this.jsxParseExpressionContainer(t,Sn.j_oTag),t.expression.type==="JSXEmptyExpression"&&this.raise(Af.AttributeIsEmpty,t),t;case 143:case 134:return this.parseExprAtom();default:throw this.raise(Af.UnsupportedJsxValue,this.state.startLoc)}}jsxParseEmptyExpression(){const t=this.startNodeAt(this.state.lastTokEndLoc);return this.finishNodeAt(t,"JSXEmptyExpression",this.state.startLoc)}jsxParseSpreadChild(t){return this.next(),t.expression=this.parseExpression(),this.setContext(Sn.j_expr),this.state.canStartJSXElement=!0,this.expect(8),this.finishNode(t,"JSXSpreadChild")}jsxParseExpressionContainer(t,n){if(this.match(8))t.expression=this.jsxParseEmptyExpression();else{const i=this.parseExpression();t.expression=i}return this.setContext(n),this.state.canStartJSXElement=!0,this.expect(8),this.finishNode(t,"JSXExpressionContainer")}jsxParseAttribute(){const t=this.startNode();return this.match(5)?(this.setContext(Sn.brace),this.next(),this.expect(21),t.argument=this.parseMaybeAssignAllowIn(),this.setContext(Sn.j_oTag),this.state.canStartJSXElement=!0,this.expect(8),this.finishNode(t,"JSXSpreadAttribute")):(t.name=this.jsxParseNamespacedName(),t.value=this.eat(29)?this.jsxParseAttributeValue():null,this.finishNode(t,"JSXAttribute"))}jsxParseOpeningElementAt(t){const n=this.startNodeAt(t);return this.eat(144)?this.finishNode(n,"JSXOpeningFragment"):(n.name=this.jsxParseElementName(),this.jsxParseOpeningElementAfterName(n))}jsxParseOpeningElementAfterName(t){const n=[];for(;!this.match(56)&&!this.match(144);)n.push(this.jsxParseAttribute());return t.attributes=n,t.selfClosing=this.eat(56),this.expect(144),this.finishNode(t,"JSXOpeningElement")}jsxParseClosingElementAt(t){const n=this.startNodeAt(t);return this.eat(144)?this.finishNode(n,"JSXClosingFragment"):(n.name=this.jsxParseElementName(),this.expect(144),this.finishNode(n,"JSXClosingElement"))}jsxParseElementAt(t){const n=this.startNodeAt(t),i=[],s=this.jsxParseOpeningElementAt(t);let a=null;if(!s.selfClosing){e:for(;;)switch(this.state.type){case 143:if(t=this.state.startLoc,this.next(),this.eat(56)){a=this.jsxParseClosingElementAt(t);break e}i.push(this.jsxParseElementAt(t));break;case 142:i.push(this.parseLiteral(this.state.value,"JSXText"));break;case 5:{const o=this.startNode();this.setContext(Sn.brace),this.next(),this.match(21)?i.push(this.jsxParseSpreadChild(o)):i.push(this.jsxParseExpressionContainer(o,Sn.j_expr));break}default:this.unexpected()}Lh(s)&&!Lh(a)&&a!==null?this.raise(Af.MissingClosingTagFragment,a):!Lh(s)&&Lh(a)?this.raise(Af.MissingClosingTagElement,a,{openingTagName:fm(s.name)}):!Lh(s)&&!Lh(a)&&fm(a.name)!==fm(s.name)&&this.raise(Af.MissingClosingTagElement,a,{openingTagName:fm(s.name)})}if(Lh(s)?(n.openingFragment=s,n.closingFragment=a):(n.openingElement=s,n.closingElement=a),n.children=i,this.match(47))throw this.raise(Af.UnwrappedAdjacentJSXElements,this.state.startLoc);return Lh(s)?this.finishNode(n,"JSXFragment"):this.finishNode(n,"JSXElement")}jsxParseElement(){const t=this.state.startLoc;return this.next(),this.jsxParseElementAt(t)}setContext(t){const{context:n}=this.state;n[n.length-1]=t}parseExprAtom(t){return this.match(143)?this.jsxParseElement():this.match(47)&&this.input.charCodeAt(this.state.pos)!==33?(this.replaceToken(143),this.jsxParseElement()):super.parseExprAtom(t)}skipSpace(){this.curContext().preserveSpace||super.skipSpace()}getTokenFromCode(t){const n=this.curContext();if(n===Sn.j_expr){this.jsxReadToken();return}if(n===Sn.j_oTag||n===Sn.j_cTag){if(Dc(t)){this.jsxReadWord();return}if(t===62){++this.state.pos,this.finishToken(144);return}if((t===34||t===39)&&n===Sn.j_oTag){this.jsxReadString(t);return}}if(t===60&&this.state.canStartJSXElement&&this.input.charCodeAt(this.state.pos+1)!==33){++this.state.pos,this.finishToken(143);return}super.getTokenFromCode(t)}updateContext(t){const{context:n,type:i}=this.state;if(i===56&&t===143)n.splice(-2,2,Sn.j_cTag),this.state.canStartJSXElement=!1;else if(i===143)n.push(Sn.j_oTag);else if(i===144){const s=n[n.length-1];s===Sn.j_oTag&&t===56||s===Sn.j_cTag?(n.pop(),this.state.canStartJSXElement=n[n.length-1]===Sn.j_expr):(this.setContext(Sn.j_expr),this.state.canStartJSXElement=!0)}else this.state.canStartJSXElement=Toe(i)}};class rae extends XR{constructor(...e){super(...e),this.tsNames=new Map}}class nae extends JR{constructor(...e){super(...e),this.importsStack=[]}createScope(e){return this.importsStack.push(new Set),new rae(e)}enter(e){e===1024&&this.importsStack.push(new Set),super.enter(e)}exit(){const e=super.exit();return e===1024&&this.importsStack.pop(),e}hasImport(e,t){const n=this.importsStack.length;if(this.importsStack[n-1].has(e))return!0;if(!t&&n>1){for(let i=0;i<n-1;i++)if(this.importsStack[i].has(e))return!0}return!1}declareName(e,t,n){if(t&4096){this.hasImport(e,!0)&&this.parser.raise(Ne.VarRedeclaration,n,{identifierName:e}),this.importsStack[this.importsStack.length-1].add(e);return}const i=this.currentScope();let s=i.tsNames.get(e)||0;if(t&1024){this.maybeExportDefined(i,e),i.tsNames.set(e,s|16);return}super.declareName(e,t,n),t&2&&(t&1||(this.checkRedeclarationInScope(i,e,t,n),this.maybeExportDefined(i,e)),s=s|1),t&256&&(s=s|2),t&512&&(s=s|4),t&128&&(s=s|8),s&&i.tsNames.set(e,s)}isRedeclaredInScope(e,t,n){const i=e.tsNames.get(t);if((i&2)>0){if(n&256){const s=!!(n&512),a=(i&4)>0;return s!==a}return!0}return n&128&&(i&8)>0?e.names.get(t)&2?!!(n&1):!1:n&2&&(i&1)>0?!0:super.isRedeclaredInScope(e,t,n)}checkLocalExport(e){const{name:t}=e;if(this.hasImport(t))return;const n=this.scopeStack.length;for(let i=n-1;i>=0;i--){const a=this.scopeStack[i].tsNames.get(t);if((a&1)>0||(a&16)>0)return}super.checkLocalExport(e)}}class iae{constructor(){this.stacks=[]}enter(e){this.stacks.push(e)}exit(){this.stacks.pop()}currentFlags(){return this.stacks[this.stacks.length-1]}get hasAwait(){return(this.currentFlags()&2)>0}get hasYield(){return(this.currentFlags()&1)>0}get hasReturn(){return(this.currentFlags()&4)>0}get hasIn(){return(this.currentFlags()&8)>0}}function lw(r,e){return(r?2:0)|(e?1:0)}class sae{constructor(){this.sawUnambiguousESM=!1,this.ambiguousScriptDifferentAst=!1}sourceToOffsetPos(e){return e+this.startIndex}offsetToSourcePos(e){return e-this.startIndex}hasPlugin(e){if(typeof e=="string")return this.plugins.has(e);{const[t,n]=e;if(!this.hasPlugin(t))return!1;const i=this.plugins.get(t);for(const s of Object.keys(n))if(i?.[s]!==n[s])return!1;return!0}}getPluginOption(e,t){var n;return(n=this.plugins.get(e))==null?void 0:n[t]}}function E7(r,e){r.trailingComments===void 0?r.trailingComments=e:r.trailingComments.unshift(...e)}function oae(r,e){r.leadingComments===void 0?r.leadingComments=e:r.leadingComments.unshift(...e)}function E_(r,e){r.innerComments===void 0?r.innerComments=e:r.innerComments.unshift(...e)}function Nh(r,e,t){let n=null,i=e.length;for(;n===null&&i>0;)n=e[--i];n===null||n.start>t.start?E_(r,t.comments):E7(n,t.comments)}class aae extends sae{addComment(e){this.filename&&(e.loc.filename=this.filename);const{commentsLen:t}=this.state;this.comments.length!==t&&(this.comments.length=t),this.comments.push(e),this.state.commentsLen++}processComment(e){const{commentStack:t}=this.state,n=t.length;if(n===0)return;let i=n-1;const s=t[i];s.start===e.end&&(s.leadingNode=e,i--);const{start:a}=e;for(;i>=0;i--){const o=t[i],u=o.end;if(u>a)o.containingNode=e,this.finalizeComment(o),t.splice(i,1);else{u===a&&(o.trailingNode=e);break}}}finalizeComment(e){var t;const{comments:n}=e;if(e.leadingNode!==null||e.trailingNode!==null)e.leadingNode!==null&&E7(e.leadingNode,n),e.trailingNode!==null&&oae(e.trailingNode,n);else{const i=e.containingNode,s=e.start;if(this.input.charCodeAt(this.offsetToSourcePos(s)-1)===44)switch(i.type){case"ObjectExpression":case"ObjectPattern":case"RecordExpression":Nh(i,i.properties,e);break;case"CallExpression":case"OptionalCallExpression":Nh(i,i.arguments,e);break;case"ImportExpression":Nh(i,[i.source,(t=i.options)!=null?t:null],e);break;case"FunctionDeclaration":case"FunctionExpression":case"ArrowFunctionExpression":case"ObjectMethod":case"ClassMethod":case"ClassPrivateMethod":Nh(i,i.params,e);break;case"ArrayExpression":case"ArrayPattern":case"TupleExpression":Nh(i,i.elements,e);break;case"ExportNamedDeclaration":case"ImportDeclaration":Nh(i,i.specifiers,e);break;case"TSEnumDeclaration":Nh(i,i.members,e);break;case"TSEnumBody":Nh(i,i.members,e);break;default:E_(i,n)}else E_(i,n)}}finalizeRemainingComments(){const{commentStack:e}=this.state;for(let t=e.length-1;t>=0;t--)this.finalizeComment(e[t]);this.state.commentStack=[]}resetPreviousNodeTrailingComments(e){const{commentStack:t}=this.state,{length:n}=t;if(n===0)return;const i=t[n-1];i.leadingNode===e&&(i.leadingNode=null)}takeSurroundingComments(e,t,n){const{commentStack:i}=this.state,s=i.length;if(s===0)return;let a=s-1;for(;a>=0;a--){const o=i[a],u=o.end;if(o.start===n)o.leadingNode=e;else if(u===t)o.trailingNode=e;else if(u<t)break}}}class qR{constructor(){this.flags=1024,this.startIndex=void 0,this.curLine=void 0,this.lineStart=void 0,this.startLoc=void 0,this.endLoc=void 0,this.errors=[],this.potentialArrowAt=-1,this.noArrowAt=[],this.noArrowParamsConversionAt=[],this.topicContext={maxNumOfResolvableTopics:0,maxTopicIndex:null},this.labels=[],this.commentsLen=0,this.commentStack=[],this.pos=0,this.type=140,this.value=null,this.start=0,this.end=0,this.lastTokEndLoc=null,this.lastTokStartLoc=null,this.context=[Sn.brace],this.firstInvalidTemplateEscapePos=null,this.strictErrors=new Map,this.tokensLength=0}get strict(){return(this.flags&1)>0}set strict(e){e?this.flags|=1:this.flags&=-2}init({strictMode:e,sourceType:t,startIndex:n,startLine:i,startColumn:s}){this.strict=e===!1?!1:e===!0?!0:t==="module",this.startIndex=n,this.curLine=i,this.lineStart=-s,this.startLoc=this.endLoc=new pd(i,s,n)}get maybeInArrowParameters(){return(this.flags&2)>0}set maybeInArrowParameters(e){e?this.flags|=2:this.flags&=-3}get inType(){return(this.flags&4)>0}set inType(e){e?this.flags|=4:this.flags&=-5}get noAnonFunctionType(){return(this.flags&8)>0}set noAnonFunctionType(e){e?this.flags|=8:this.flags&=-9}get hasFlowComment(){return(this.flags&16)>0}set hasFlowComment(e){e?this.flags|=16:this.flags&=-17}get isAmbientContext(){return(this.flags&32)>0}set isAmbientContext(e){e?this.flags|=32:this.flags&=-33}get inAbstractClass(){return(this.flags&64)>0}set inAbstractClass(e){e?this.flags|=64:this.flags&=-65}get inDisallowConditionalTypesContext(){return(this.flags&128)>0}set inDisallowConditionalTypesContext(e){e?this.flags|=128:this.flags&=-129}get soloAwait(){return(this.flags&256)>0}set soloAwait(e){e?this.flags|=256:this.flags&=-257}get inFSharpPipelineDirectBody(){return(this.flags&512)>0}set inFSharpPipelineDirectBody(e){e?this.flags|=512:this.flags&=-513}get canStartJSXElement(){return(this.flags&1024)>0}set canStartJSXElement(e){e?this.flags|=1024:this.flags&=-1025}get containsEsc(){return(this.flags&2048)>0}set containsEsc(e){e?this.flags|=2048:this.flags&=-2049}get hasTopLevelAwait(){return(this.flags&4096)>0}set hasTopLevelAwait(e){e?this.flags|=4096:this.flags&=-4097}curPosition(){return new pd(this.curLine,this.pos-this.lineStart,this.pos+this.startIndex)}clone(){const e=new qR;return e.flags=this.flags,e.startIndex=this.startIndex,e.curLine=this.curLine,e.lineStart=this.lineStart,e.startLoc=this.startLoc,e.endLoc=this.endLoc,e.errors=this.errors.slice(),e.potentialArrowAt=this.potentialArrowAt,e.noArrowAt=this.noArrowAt.slice(),e.noArrowParamsConversionAt=this.noArrowParamsConversionAt.slice(),e.topicContext=this.topicContext,e.labels=this.labels.slice(),e.commentsLen=this.commentsLen,e.commentStack=this.commentStack.slice(),e.pos=this.pos,e.type=this.type,e.value=this.value,e.start=this.start,e.end=this.end,e.lastTokEndLoc=this.lastTokEndLoc,e.lastTokStartLoc=this.lastTokStartLoc,e.context=this.context.slice(),e.firstInvalidTemplateEscapePos=this.firstInvalidTemplateEscapePos,e.strictErrors=this.strictErrors,e.tokensLength=this.tokensLength,e}}var lae=function(e){return e>=48&&e<=57};const a4={decBinOct:new Set([46,66,69,79,95,98,101,111]),hex:new Set([46,88,95,120])},V1={bin:r=>r===48||r===49,oct:r=>r>=48&&r<=55,dec:r=>r>=48&&r<=57,hex:r=>r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102};function l4(r,e,t,n,i,s){const a=t,o=n,u=i;let f="",g=null,y=t;const{length:A}=e;for(;;){if(t>=A){s.unterminated(a,o,u),f+=e.slice(y,t);break}const C=e.charCodeAt(t);if(cae(r,C,e,t)){f+=e.slice(y,t);break}if(C===92){f+=e.slice(y,t);const M=uae(e,t,n,i,r==="template",s);M.ch===null&&!g?g={pos:t,lineStart:n,curLine:i}:f+=M.ch,{pos:t,lineStart:n,curLine:i}=M,y=t}else C===8232||C===8233?(++t,++i,n=t):C===10||C===13?r==="template"?(f+=e.slice(y,t)+`
`,++t,C===13&&e.charCodeAt(t)===10&&++t,++i,y=n=t):s.unterminated(a,o,u):++t}return{pos:t,str:f,firstInvalidLoc:g,lineStart:n,curLine:i,containsInvalid:!!g}}function cae(r,e,t,n){return r==="template"?e===96||e===36&&t.charCodeAt(n+1)===123:e===(r==="double"?34:39)}function uae(r,e,t,n,i,s){const a=!i;e++;const o=f=>({pos:e,ch:f,lineStart:t,curLine:n}),u=r.charCodeAt(e++);switch(u){case 110:return o(`
`);case 114:return o("\r");case 120:{let f;return{code:f,pos:e}=B3(r,e,t,n,2,!1,a,s),o(f===null?null:String.fromCharCode(f))}case 117:{let f;return{code:f,pos:e}=P7(r,e,t,n,a,s),o(f===null?null:String.fromCodePoint(f))}case 116:return o("	");case 98:return o("\b");case 118:return o("\v");case 102:return o("\f");case 13:r.charCodeAt(e)===10&&++e;case 10:t=e,++n;case 8232:case 8233:return o("");case 56:case 57:if(i)return o(null);s.strictNumericEscape(e-1,t,n);default:if(u>=48&&u<=55){const f=e-1;let y=/^[0-7]+/.exec(r.slice(f,e+2))[0],A=parseInt(y,8);A>255&&(y=y.slice(0,-1),A=parseInt(y,8)),e+=y.length-1;const C=r.charCodeAt(e);if(y!=="0"||C===56||C===57){if(i)return o(null);s.strictNumericEscape(f,t,n)}return o(String.fromCharCode(A))}return o(String.fromCharCode(u))}}function B3(r,e,t,n,i,s,a,o){const u=e;let f;return{n:f,pos:e}=I7(r,e,t,n,16,i,s,!1,o,!a),f===null&&(a?o.invalidEscapeSequence(u,t,n):e=u-1),{code:f,pos:e}}function I7(r,e,t,n,i,s,a,o,u,f){const g=e,y=i===16?a4.hex:a4.decBinOct,A=i===16?V1.hex:i===10?V1.dec:i===8?V1.oct:V1.bin;let C=!1,M=0;for(let k=0,D=s??1/0;k<D;++k){const V=r.charCodeAt(e);let W;if(V===95&&o!=="bail"){const z=r.charCodeAt(e-1),$=r.charCodeAt(e+1);if(o){if(Number.isNaN($)||!A($)||y.has(z)||y.has($)){if(f)return{n:null,pos:e};u.unexpectedNumericSeparator(e,t,n)}}else{if(f)return{n:null,pos:e};u.numericSeparatorInEscapeSequence(e,t,n)}++e;continue}if(V>=97?W=V-97+10:V>=65?W=V-65+10:lae(V)?W=V-48:W=1/0,W>=i){if(W<=9&&f)return{n:null,pos:e};if(W<=9&&u.invalidDigit(e,t,n,i))W=0;else if(a)W=0,C=!0;else break}++e,M=M*i+W}return e===g||s!=null&&e-g!==s||C?{n:null,pos:e}:{n:M,pos:e}}function P7(r,e,t,n,i,s){const a=r.charCodeAt(e);let o;if(a===123){if(++e,{code:o,pos:e}=B3(r,e,t,n,r.indexOf("}",e)-e,!0,i,s),++e,o!==null&&o>1114111)if(i)s.invalidCodePoint(e,t,n);else return{code:null,pos:e}}else({code:o,pos:e}=B3(r,e,t,n,4,!1,i,s));return{code:o,pos:e}}function Kb(r,e,t){return new pd(t,r-e,r)}const hae=new Set([103,109,115,105,121,117,100,118]);class Kh{constructor(e){const t=e.startIndex||0;this.type=e.type,this.value=e.value,this.start=t+e.start,this.end=t+e.end,this.loc=new uC(e.startLoc,e.endLoc)}}let dae=class extends aae{constructor(e,t){super(),this.isLookahead=void 0,this.tokens=[],this.errorHandlers_readInt={invalidDigit:(n,i,s,a)=>this.optionFlags&2048?(this.raise(Ne.InvalidDigit,Kb(n,i,s),{radix:a}),!0):!1,numericSeparatorInEscapeSequence:this.errorBuilder(Ne.NumericSeparatorInEscapeSequence),unexpectedNumericSeparator:this.errorBuilder(Ne.UnexpectedNumericSeparator)},this.errorHandlers_readCodePoint=Object.assign({},this.errorHandlers_readInt,{invalidEscapeSequence:this.errorBuilder(Ne.InvalidEscapeSequence),invalidCodePoint:this.errorBuilder(Ne.InvalidCodePoint)}),this.errorHandlers_readStringContents_string=Object.assign({},this.errorHandlers_readCodePoint,{strictNumericEscape:(n,i,s)=>{this.recordStrictModeErrors(Ne.StrictNumericEscape,Kb(n,i,s))},unterminated:(n,i,s)=>{throw this.raise(Ne.UnterminatedString,Kb(n-1,i,s))}}),this.errorHandlers_readStringContents_template=Object.assign({},this.errorHandlers_readCodePoint,{strictNumericEscape:this.errorBuilder(Ne.StrictNumericEscape),unterminated:(n,i,s)=>{throw this.raise(Ne.UnterminatedTemplate,Kb(n,i,s))}}),this.state=new qR,this.state.init(e),this.input=t,this.length=t.length,this.comments=[],this.isLookahead=!1}pushToken(e){this.tokens.length=this.state.tokensLength,this.tokens.push(e),++this.state.tokensLength}next(){this.checkKeywordEscapes(),this.optionFlags&256&&this.pushToken(new Kh(this.state)),this.state.lastTokEndLoc=this.state.endLoc,this.state.lastTokStartLoc=this.state.startLoc,this.nextToken()}eat(e){return this.match(e)?(this.next(),!0):!1}match(e){return this.state.type===e}createLookaheadState(e){return{pos:e.pos,value:null,type:e.type,start:e.start,end:e.end,context:[this.curContext()],inType:e.inType,startLoc:e.startLoc,lastTokEndLoc:e.lastTokEndLoc,curLine:e.curLine,lineStart:e.lineStart,curPosition:e.curPosition}}lookahead(){const e=this.state;this.state=this.createLookaheadState(e),this.isLookahead=!0,this.nextToken(),this.isLookahead=!1;const t=this.state;return this.state=e,t}nextTokenStart(){return this.nextTokenStartSince(this.state.pos)}nextTokenStartSince(e){return QE.lastIndex=e,QE.test(this.input)?QE.lastIndex:e}lookaheadCharCode(){return this.lookaheadCharCodeSince(this.state.pos)}lookaheadCharCodeSince(e){return this.input.charCodeAt(this.nextTokenStartSince(e))}nextTokenInLineStart(){return this.nextTokenInLineStartSince(this.state.pos)}nextTokenInLineStartSince(e){return eI.lastIndex=e,eI.test(this.input)?eI.lastIndex:e}lookaheadInLineCharCode(){return this.input.charCodeAt(this.nextTokenInLineStart())}codePointAtPos(e){let t=this.input.charCodeAt(e);if((t&64512)===55296&&++e<this.input.length){const n=this.input.charCodeAt(e);(n&64512)===56320&&(t=65536+((t&1023)<<10)+(n&1023))}return t}setStrict(e){this.state.strict=e,e&&(this.state.strictErrors.forEach(([t,n])=>this.raise(t,n)),this.state.strictErrors.clear())}curContext(){return this.state.context[this.state.context.length-1]}nextToken(){if(this.skipSpace(),this.state.start=this.state.pos,this.isLookahead||(this.state.startLoc=this.state.curPosition()),this.state.pos>=this.length){this.finishToken(140);return}this.getTokenFromCode(this.codePointAtPos(this.state.pos))}skipBlockComment(e){let t;this.isLookahead||(t=this.state.curPosition());const n=this.state.pos,i=this.input.indexOf(e,n+2);if(i===-1)throw this.raise(Ne.UnterminatedComment,this.state.curPosition());for(this.state.pos=i+e.length,z1.lastIndex=n+2;z1.test(this.input)&&z1.lastIndex<=i;)++this.state.curLine,this.state.lineStart=z1.lastIndex;if(this.isLookahead)return;const s={type:"CommentBlock",value:this.input.slice(n+2,i),start:this.sourceToOffsetPos(n),end:this.sourceToOffsetPos(i+e.length),loc:new uC(t,this.state.curPosition())};return this.optionFlags&256&&this.pushToken(s),s}skipLineComment(e){const t=this.state.pos;let n;this.isLookahead||(n=this.state.curPosition());let i=this.input.charCodeAt(this.state.pos+=e);if(this.state.pos<this.length)for(;!Rm(i)&&++this.state.pos<this.length;)i=this.input.charCodeAt(this.state.pos);if(this.isLookahead)return;const s=this.state.pos,o={type:"CommentLine",value:this.input.slice(t+e,s),start:this.sourceToOffsetPos(t),end:this.sourceToOffsetPos(s),loc:new uC(n,this.state.curPosition())};return this.optionFlags&256&&this.pushToken(o),o}skipSpace(){const e=this.state.pos,t=this.optionFlags&4096?[]:null;e:for(;this.state.pos<this.length;){const n=this.input.charCodeAt(this.state.pos);switch(n){case 32:case 160:case 9:++this.state.pos;break;case 13:this.input.charCodeAt(this.state.pos+1)===10&&++this.state.pos;case 10:case 8232:case 8233:++this.state.pos,++this.state.curLine,this.state.lineStart=this.state.pos;break;case 47:switch(this.input.charCodeAt(this.state.pos+1)){case 42:{const i=this.skipBlockComment("*/");i!==void 0&&(this.addComment(i),t?.push(i));break}case 47:{const i=this.skipLineComment(2);i!==void 0&&(this.addComment(i),t?.push(i));break}default:break e}break;default:if(eae(n))++this.state.pos;else if(n===45&&!this.inModule&&this.optionFlags&8192){const i=this.state.pos;if(this.input.charCodeAt(i+1)===45&&this.input.charCodeAt(i+2)===62&&(e===0||this.state.lineStart>e)){const s=this.skipLineComment(3);s!==void 0&&(this.addComment(s),t?.push(s))}else break e}else if(n===60&&!this.inModule&&this.optionFlags&8192){const i=this.state.pos;if(this.input.charCodeAt(i+1)===33&&this.input.charCodeAt(i+2)===45&&this.input.charCodeAt(i+3)===45){const s=this.skipLineComment(4);s!==void 0&&(this.addComment(s),t?.push(s))}else break e}else break e}}if(t?.length>0){const n=this.state.pos,i={start:this.sourceToOffsetPos(e),end:this.sourceToOffsetPos(n),comments:t,leadingNode:null,trailingNode:null,containingNode:null};this.state.commentStack.push(i)}}finishToken(e,t){this.state.end=this.state.pos,this.state.endLoc=this.state.curPosition();const n=this.state.type;this.state.type=e,this.state.value=t,this.isLookahead||this.updateContext(n)}replaceToken(e){this.state.type=e,this.updateContext()}readToken_numberSign(){if(this.state.pos===0&&this.readToken_interpreter())return;const e=this.state.pos+1,t=this.codePointAtPos(e);if(t>=48&&t<=57)throw this.raise(Ne.UnexpectedDigitAfterHash,this.state.curPosition());if(t===123||t===91&&this.hasPlugin("recordAndTuple")){if(this.expectPlugin("recordAndTuple"),this.getPluginOption("recordAndTuple","syntaxType")==="bar")throw this.raise(t===123?Ne.RecordExpressionHashIncorrectStartSyntaxType:Ne.TupleExpressionHashIncorrectStartSyntaxType,this.state.curPosition());this.state.pos+=2,t===123?this.finishToken(7):this.finishToken(1)}else Dc(t)?(++this.state.pos,this.finishToken(139,this.readWord1(t))):t===92?(++this.state.pos,this.finishToken(139,this.readWord1())):this.finishOp(27,1)}readToken_dot(){const e=this.input.charCodeAt(this.state.pos+1);if(e>=48&&e<=57){this.readNumber(!0);return}e===46&&this.input.charCodeAt(this.state.pos+2)===46?(this.state.pos+=3,this.finishToken(21)):(++this.state.pos,this.finishToken(16))}readToken_slash(){this.input.charCodeAt(this.state.pos+1)===61?this.finishOp(31,2):this.finishOp(56,1)}readToken_interpreter(){if(this.state.pos!==0||this.length<2)return!1;let e=this.input.charCodeAt(this.state.pos+1);if(e!==33)return!1;const t=this.state.pos;for(this.state.pos+=1;!Rm(e)&&++this.state.pos<this.length;)e=this.input.charCodeAt(this.state.pos);const n=this.input.slice(t+2,this.state.pos);return this.finishToken(28,n),!0}readToken_mult_modulo(e){let t=e===42?55:54,n=1,i=this.input.charCodeAt(this.state.pos+1);e===42&&i===42&&(n++,i=this.input.charCodeAt(this.state.pos+2),t=57),i===61&&!this.state.inType&&(n++,t=e===37?33:30),this.finishOp(t,n)}readToken_pipe_amp(e){const t=this.input.charCodeAt(this.state.pos+1);if(t===e){this.input.charCodeAt(this.state.pos+2)===61?this.finishOp(30,3):this.finishOp(e===124?41:42,2);return}if(e===124){if(t===62){this.finishOp(39,2);return}if(this.hasPlugin("recordAndTuple")&&t===125){if(this.getPluginOption("recordAndTuple","syntaxType")!=="bar")throw this.raise(Ne.RecordExpressionBarIncorrectEndSyntaxType,this.state.curPosition());this.state.pos+=2,this.finishToken(9);return}if(this.hasPlugin("recordAndTuple")&&t===93){if(this.getPluginOption("recordAndTuple","syntaxType")!=="bar")throw this.raise(Ne.TupleExpressionBarIncorrectEndSyntaxType,this.state.curPosition());this.state.pos+=2,this.finishToken(4);return}}if(t===61){this.finishOp(30,2);return}this.finishOp(e===124?43:45,1)}readToken_caret(){const e=this.input.charCodeAt(this.state.pos+1);e===61&&!this.state.inType?this.finishOp(32,2):e===94&&this.hasPlugin(["pipelineOperator",{proposal:"hack",topicToken:"^^"}])?(this.finishOp(37,2),this.input.codePointAt(this.state.pos)===94&&this.unexpected()):this.finishOp(44,1)}readToken_atSign(){this.input.charCodeAt(this.state.pos+1)===64&&this.hasPlugin(["pipelineOperator",{proposal:"hack",topicToken:"@@"}])?this.finishOp(38,2):this.finishOp(26,1)}readToken_plus_min(e){const t=this.input.charCodeAt(this.state.pos+1);if(t===e){this.finishOp(34,2);return}t===61?this.finishOp(30,2):this.finishOp(53,1)}readToken_lt(){const{pos:e}=this.state,t=this.input.charCodeAt(e+1);if(t===60){if(this.input.charCodeAt(e+2)===61){this.finishOp(30,3);return}this.finishOp(51,2);return}if(t===61){this.finishOp(49,2);return}this.finishOp(47,1)}readToken_gt(){const{pos:e}=this.state,t=this.input.charCodeAt(e+1);if(t===62){const n=this.input.charCodeAt(e+2)===62?3:2;if(this.input.charCodeAt(e+n)===61){this.finishOp(30,n+1);return}this.finishOp(52,n);return}if(t===61){this.finishOp(49,2);return}this.finishOp(48,1)}readToken_eq_excl(e){const t=this.input.charCodeAt(this.state.pos+1);if(t===61){this.finishOp(46,this.input.charCodeAt(this.state.pos+2)===61?3:2);return}if(e===61&&t===62){this.state.pos+=2,this.finishToken(19);return}this.finishOp(e===61?29:35,1)}readToken_question(){const e=this.input.charCodeAt(this.state.pos+1),t=this.input.charCodeAt(this.state.pos+2);e===63?t===61?this.finishOp(30,3):this.finishOp(40,2):e===46&&!(t>=48&&t<=57)?(this.state.pos+=2,this.finishToken(18)):(++this.state.pos,this.finishToken(17))}getTokenFromCode(e){switch(e){case 46:this.readToken_dot();return;case 40:++this.state.pos,this.finishToken(10);return;case 41:++this.state.pos,this.finishToken(11);return;case 59:++this.state.pos,this.finishToken(13);return;case 44:++this.state.pos,this.finishToken(12);return;case 91:if(this.hasPlugin("recordAndTuple")&&this.input.charCodeAt(this.state.pos+1)===124){if(this.getPluginOption("recordAndTuple","syntaxType")!=="bar")throw this.raise(Ne.TupleExpressionBarIncorrectStartSyntaxType,this.state.curPosition());this.state.pos+=2,this.finishToken(2)}else++this.state.pos,this.finishToken(0);return;case 93:++this.state.pos,this.finishToken(3);return;case 123:if(this.hasPlugin("recordAndTuple")&&this.input.charCodeAt(this.state.pos+1)===124){if(this.getPluginOption("recordAndTuple","syntaxType")!=="bar")throw this.raise(Ne.RecordExpressionBarIncorrectStartSyntaxType,this.state.curPosition());this.state.pos+=2,this.finishToken(6)}else++this.state.pos,this.finishToken(5);return;case 125:++this.state.pos,this.finishToken(8);return;case 58:this.hasPlugin("functionBind")&&this.input.charCodeAt(this.state.pos+1)===58?this.finishOp(15,2):(++this.state.pos,this.finishToken(14));return;case 63:this.readToken_question();return;case 96:this.readTemplateToken();return;case 48:{const t=this.input.charCodeAt(this.state.pos+1);if(t===120||t===88){this.readRadixNumber(16);return}if(t===111||t===79){this.readRadixNumber(8);return}if(t===98||t===66){this.readRadixNumber(2);return}}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:this.readNumber(!1);return;case 34:case 39:this.readString(e);return;case 47:this.readToken_slash();return;case 37:case 42:this.readToken_mult_modulo(e);return;case 124:case 38:this.readToken_pipe_amp(e);return;case 94:this.readToken_caret();return;case 43:case 45:this.readToken_plus_min(e);return;case 60:this.readToken_lt();return;case 62:this.readToken_gt();return;case 61:case 33:this.readToken_eq_excl(e);return;case 126:this.finishOp(36,1);return;case 64:this.readToken_atSign();return;case 35:this.readToken_numberSign();return;case 92:this.readWord();return;default:if(Dc(e)){this.readWord(e);return}}throw this.raise(Ne.InvalidOrUnexpectedToken,this.state.curPosition(),{unexpected:String.fromCodePoint(e)})}finishOp(e,t){const n=this.input.slice(this.state.pos,this.state.pos+t);this.state.pos+=t,this.finishToken(e,n)}readRegexp(){const e=this.state.startLoc,t=this.state.start+1;let n,i,{pos:s}=this.state;for(;;++s){if(s>=this.length)throw this.raise(Ne.UnterminatedRegExp,jo(e,1));const f=this.input.charCodeAt(s);if(Rm(f))throw this.raise(Ne.UnterminatedRegExp,jo(e,1));if(n)n=!1;else{if(f===91)i=!0;else if(f===93&&i)i=!1;else if(f===47&&!i)break;n=f===92}}const a=this.input.slice(t,s);++s;let o="";const u=()=>jo(e,s+2-t);for(;s<this.length;){const f=this.codePointAtPos(s),g=String.fromCharCode(f);if(hae.has(f))f===118?o.includes("u")&&this.raise(Ne.IncompatibleRegExpUVFlags,u()):f===117&&o.includes("v")&&this.raise(Ne.IncompatibleRegExpUVFlags,u()),o.includes(g)&&this.raise(Ne.DuplicateRegExpFlags,u());else if(Hf(f)||f===92)this.raise(Ne.MalformedRegExpFlags,u());else break;++s,o+=g}this.state.pos=s,this.finishToken(138,{pattern:a,flags:o})}readInt(e,t,n=!1,i=!0){const{n:s,pos:a}=I7(this.input,this.state.pos,this.state.lineStart,this.state.curLine,e,t,n,i,this.errorHandlers_readInt,!1);return this.state.pos=a,s}readRadixNumber(e){const t=this.state.pos,n=this.state.curPosition();let i=!1;this.state.pos+=2;const s=this.readInt(e);s==null&&this.raise(Ne.InvalidDigit,jo(n,2),{radix:e});const a=this.input.charCodeAt(this.state.pos);if(a===110)++this.state.pos,i=!0;else if(a===109)throw this.raise(Ne.InvalidDecimal,n);if(Dc(this.codePointAtPos(this.state.pos)))throw this.raise(Ne.NumberIdentifier,this.state.curPosition());if(i){const o=this.input.slice(t,this.state.pos).replace(/[_n]/g,"");this.finishToken(136,o);return}this.finishToken(135,s)}readNumber(e){const t=this.state.pos,n=this.state.curPosition();let i=!1,s=!1,a=!1,o=!1;!e&&this.readInt(10)===null&&this.raise(Ne.InvalidNumber,this.state.curPosition());const u=this.state.pos-t>=2&&this.input.charCodeAt(t)===48;if(u){const C=this.input.slice(t,this.state.pos);if(this.recordStrictModeErrors(Ne.StrictOctalLiteral,n),!this.state.strict){const M=C.indexOf("_");M>0&&this.raise(Ne.ZeroDigitNumericSeparator,jo(n,M))}o=u&&!/[89]/.test(C)}let f=this.input.charCodeAt(this.state.pos);if(f===46&&!o&&(++this.state.pos,this.readInt(10),i=!0,f=this.input.charCodeAt(this.state.pos)),(f===69||f===101)&&!o&&(f=this.input.charCodeAt(++this.state.pos),(f===43||f===45)&&++this.state.pos,this.readInt(10)===null&&this.raise(Ne.InvalidOrMissingExponent,n),i=!0,a=!0,f=this.input.charCodeAt(this.state.pos)),f===110&&((i||u)&&this.raise(Ne.InvalidBigIntLiteral,n),++this.state.pos,s=!0),f===109){this.expectPlugin("decimal",this.state.curPosition()),(a||u)&&this.raise(Ne.InvalidDecimal,n),++this.state.pos;var g=!0}if(Dc(this.codePointAtPos(this.state.pos)))throw this.raise(Ne.NumberIdentifier,this.state.curPosition());const y=this.input.slice(t,this.state.pos).replace(/[_mn]/g,"");if(s){this.finishToken(136,y);return}if(g){this.finishToken(137,y);return}const A=o?parseInt(y,8):parseFloat(y);this.finishToken(135,A)}readCodePoint(e){const{code:t,pos:n}=P7(this.input,this.state.pos,this.state.lineStart,this.state.curLine,e,this.errorHandlers_readCodePoint);return this.state.pos=n,t}readString(e){const{str:t,pos:n,curLine:i,lineStart:s}=l4(e===34?"double":"single",this.input,this.state.pos+1,this.state.lineStart,this.state.curLine,this.errorHandlers_readStringContents_string);this.state.pos=n+1,this.state.lineStart=s,this.state.curLine=i,this.finishToken(134,t)}readTemplateContinuation(){this.match(8)||this.unexpected(null,8),this.state.pos--,this.readTemplateToken()}readTemplateToken(){const e=this.input[this.state.pos],{str:t,firstInvalidLoc:n,pos:i,curLine:s,lineStart:a}=l4("template",this.input,this.state.pos+1,this.state.lineStart,this.state.curLine,this.errorHandlers_readStringContents_template);this.state.pos=i+1,this.state.lineStart=a,this.state.curLine=s,n&&(this.state.firstInvalidTemplateEscapePos=new pd(n.curLine,n.pos-n.lineStart,this.sourceToOffsetPos(n.pos))),this.input.codePointAt(i)===96?this.finishToken(24,n?null:e+t+"`"):(this.state.pos++,this.finishToken(25,n?null:e+t+"${"))}recordStrictModeErrors(e,t){const n=t.index;this.state.strict&&!this.state.strictErrors.has(n)?this.raise(e,t):this.state.strictErrors.set(n,[e,t])}readWord1(e){this.state.containsEsc=!1;let t="";const n=this.state.pos;let i=this.state.pos;for(e!==void 0&&(this.state.pos+=e<=65535?1:2);this.state.pos<this.length;){const s=this.codePointAtPos(this.state.pos);if(Hf(s))this.state.pos+=s<=65535?1:2;else if(s===92){this.state.containsEsc=!0,t+=this.input.slice(i,this.state.pos);const a=this.state.curPosition(),o=this.state.pos===n?Dc:Hf;if(this.input.charCodeAt(++this.state.pos)!==117){this.raise(Ne.MissingUnicodeEscape,this.state.curPosition()),i=this.state.pos-1;continue}++this.state.pos;const u=this.readCodePoint(!0);u!==null&&(o(u)||this.raise(Ne.EscapedCharNotAnIdentifier,a),t+=String.fromCodePoint(u)),i=this.state.pos}else break}return t+this.input.slice(i,this.state.pos)}readWord(e){const t=this.readWord1(e),n=UR.get(t);n!==void 0?this.finishToken(n,gd(n)):this.finishToken(132,t)}checkKeywordEscapes(){const{type:e}=this.state;HR(e)&&this.state.containsEsc&&this.raise(Ne.InvalidEscapedReservedWord,this.state.startLoc,{reservedWord:gd(e)})}raise(e,t,n={}){const i=t instanceof pd?t:t.loc.start,s=e(i,n);if(!(this.optionFlags&2048))throw s;return this.isLookahead||this.state.errors.push(s),s}raiseOverwrite(e,t,n={}){const i=t instanceof pd?t:t.loc.start,s=i.index,a=this.state.errors;for(let o=a.length-1;o>=0;o--){const u=a[o];if(u.loc.index===s)return a[o]=e(i,n);if(u.loc.index<s)break}return this.raise(e,t,n)}updateContext(e){}unexpected(e,t){throw this.raise(Ne.UnexpectedToken,e??this.state.startLoc,{expected:t?gd(t):null})}expectPlugin(e,t){if(this.hasPlugin(e))return!0;throw this.raise(Ne.MissingPlugin,t??this.state.startLoc,{missingPlugin:[e]})}expectOnePlugin(e){if(!e.some(t=>this.hasPlugin(t)))throw this.raise(Ne.MissingOneOfPlugins,this.state.startLoc,{missingPlugin:e})}errorBuilder(e){return(t,n,i)=>{this.raise(e,Kb(t,n,i))}}};class fae{constructor(){this.privateNames=new Set,this.loneAccessors=new Map,this.undefinedPrivateNames=new Map}}class pae{constructor(e){this.parser=void 0,this.stack=[],this.undefinedPrivateNames=new Map,this.parser=e}current(){return this.stack[this.stack.length-1]}enter(){this.stack.push(new fae)}exit(){const e=this.stack.pop(),t=this.current();for(const[n,i]of Array.from(e.undefinedPrivateNames))t?t.undefinedPrivateNames.has(n)||t.undefinedPrivateNames.set(n,i):this.parser.raise(Ne.InvalidPrivateFieldResolution,i,{identifierName:n})}declarePrivateName(e,t,n){const{privateNames:i,loneAccessors:s,undefinedPrivateNames:a}=this.current();let o=i.has(e);if(t&3){const u=o&&s.get(e);if(u){const f=u&4,g=t&4,y=u&3,A=t&3;o=y===A||f!==g,o||s.delete(e)}else o||s.set(e,t)}o&&this.parser.raise(Ne.PrivateNameRedeclaration,n,{identifierName:e}),i.add(e),a.delete(e)}usePrivateName(e,t){let n;for(n of this.stack)if(n.privateNames.has(e))return;n?n.undefinedPrivateNames.set(e,t):this.parser.raise(Ne.InvalidPrivateFieldResolution,t,{identifierName:e})}}class nS{constructor(e=0){this.type=e}canBeArrowParameterDeclaration(){return this.type===2||this.type===1}isCertainlyParameterDeclaration(){return this.type===3}}class B7 extends nS{constructor(e){super(e),this.declarationErrors=new Map}recordDeclarationError(e,t){const n=t.index;this.declarationErrors.set(n,[e,t])}clearDeclarationError(e){this.declarationErrors.delete(e)}iterateErrors(e){this.declarationErrors.forEach(e)}}class gae{constructor(e){this.parser=void 0,this.stack=[new nS],this.parser=e}enter(e){this.stack.push(e)}exit(){this.stack.pop()}recordParameterInitializerError(e,t){const n=t.loc.start,{stack:i}=this;let s=i.length-1,a=i[s];for(;!a.isCertainlyParameterDeclaration();){if(a.canBeArrowParameterDeclaration())a.recordDeclarationError(e,n);else return;a=i[--s]}this.parser.raise(e,n)}recordArrowParameterBindingError(e,t){const{stack:n}=this,i=n[n.length-1],s=t.loc.start;if(i.isCertainlyParameterDeclaration())this.parser.raise(e,s);else if(i.canBeArrowParameterDeclaration())i.recordDeclarationError(e,s);else return}recordAsyncArrowParametersError(e){const{stack:t}=this;let n=t.length-1,i=t[n];for(;i.canBeArrowParameterDeclaration();)i.type===2&&i.recordDeclarationError(Ne.AwaitBindingIdentifier,e),i=t[--n]}validateAsPattern(){const{stack:e}=this,t=e[e.length-1];t.canBeArrowParameterDeclaration()&&t.iterateErrors(([n,i])=>{this.parser.raise(n,i);let s=e.length-2,a=e[s];for(;a.canBeArrowParameterDeclaration();)a.clearDeclarationError(i.index),a=e[--s]})}}function mae(){return new nS(3)}function yae(){return new B7(1)}function bae(){return new B7(2)}function M7(){return new nS}class _ae extends dae{addExtra(e,t,n,i=!0){if(!e)return;let{extra:s}=e;s==null&&(s={},e.extra=s),i?s[t]=n:Object.defineProperty(s,t,{enumerable:i,value:n})}isContextual(e){return this.state.type===e&&!this.state.containsEsc}isUnparsedContextual(e,t){if(this.input.startsWith(t,e)){const n=this.input.charCodeAt(e+t.length);return!(Hf(n)||(n&64512)===55296)}return!1}isLookaheadContextual(e){const t=this.nextTokenStart();return this.isUnparsedContextual(t,e)}eatContextual(e){return this.isContextual(e)?(this.next(),!0):!1}expectContextual(e,t){if(!this.eatContextual(e)){if(t!=null)throw this.raise(t,this.state.startLoc);this.unexpected(null,e)}}canInsertSemicolon(){return this.match(140)||this.match(8)||this.hasPrecedingLineBreak()}hasPrecedingLineBreak(){return o4(this.input,this.offsetToSourcePos(this.state.lastTokEndLoc.index),this.state.start)}hasFollowingLineBreak(){return o4(this.input,this.state.end,this.nextTokenStart())}isLineTerminator(){return this.eat(13)||this.canInsertSemicolon()}semicolon(e=!0){(e?this.isLineTerminator():this.eat(13))||this.raise(Ne.MissingSemicolon,this.state.lastTokEndLoc)}expect(e,t){this.eat(e)||this.unexpected(t,e)}tryParse(e,t=this.state.clone()){const n={node:null};try{const i=e((s=null)=>{throw n.node=s,n});if(this.state.errors.length>t.errors.length){const s=this.state;return this.state=t,this.state.tokensLength=s.tokensLength,{node:i,error:s.errors[t.errors.length],thrown:!1,aborted:!1,failState:s}}return{node:i,error:null,thrown:!1,aborted:!1,failState:null}}catch(i){const s=this.state;if(this.state=t,i instanceof SyntaxError)return{node:null,error:i,thrown:!0,aborted:!1,failState:s};if(i===n)return{node:n.node,error:null,thrown:!1,aborted:!0,failState:s};throw i}}checkExpressionErrors(e,t){if(!e)return!1;const{shorthandAssignLoc:n,doubleProtoLoc:i,privateKeyLoc:s,optionalParametersLoc:a,voidPatternLoc:o}=e,u=!!n||!!i||!!a||!!s||!!o;if(!t)return u;n!=null&&this.raise(Ne.InvalidCoverInitializedName,n),i!=null&&this.raise(Ne.DuplicateProto,i),s!=null&&this.raise(Ne.UnexpectedPrivateField,s),a!=null&&this.unexpected(a),o!=null&&this.raise(Ne.InvalidCoverDiscardElement,o)}isLiteralPropertyName(){return v7(this.state.type)}isPrivateName(e){return e.type==="PrivateName"}getPrivateNameSV(e){return e.id.name}hasPropertyAsPrivateName(e){return(e.type==="MemberExpression"||e.type==="OptionalMemberExpression")&&this.isPrivateName(e.property)}isObjectProperty(e){return e.type==="ObjectProperty"}isObjectMethod(e){return e.type==="ObjectMethod"}initializeScopes(e=this.options.sourceType==="module"){const t=this.state.labels;this.state.labels=[];const n=this.exportedIdentifiers;this.exportedIdentifiers=new Set;const i=this.inModule;this.inModule=e;const s=this.scope,a=this.getScopeHandler();this.scope=new a(this,e);const o=this.prodParam;this.prodParam=new iae;const u=this.classScope;this.classScope=new pae(this);const f=this.expressionScope;return this.expressionScope=new gae(this),()=>{this.state.labels=t,this.exportedIdentifiers=n,this.inModule=i,this.scope=s,this.prodParam=o,this.classScope=u,this.expressionScope=f}}enterInitialScopes(){let e=0;(this.inModule||this.optionFlags&1)&&(e|=2),this.optionFlags&32&&(e|=1);const t=!this.inModule&&this.options.sourceType==="commonjs";(t||this.optionFlags&2)&&(e|=4),this.prodParam.enter(e);let n=t?514:1;this.optionFlags&4&&(n|=512),this.scope.enter(n)}checkDestructuringPrivate(e){const{privateKeyLoc:t}=e;t!==null&&this.expectPlugin("destructuringPrivate",t)}}class cw{constructor(){this.shorthandAssignLoc=null,this.doubleProtoLoc=null,this.privateKeyLoc=null,this.optionalParametersLoc=null,this.voidPatternLoc=null}}let dC=class{constructor(e,t,n){this.type="",this.start=t,this.end=0,this.loc=new uC(n),e?.optionFlags&128&&(this.range=[t,0]),e!=null&&e.filename&&(this.loc.filename=e.filename)}};const M3=dC.prototype;M3.__clone=function(){const r=new dC(void 0,this.start,this.loc.start),e=Object.keys(this);for(let t=0,n=e.length;t<n;t++){const i=e[t];i!=="leadingComments"&&i!=="trailingComments"&&i!=="innerComments"&&(r[i]=this[i])}return r};class vae extends _ae{startNode(){const e=this.state.startLoc;return new dC(this,e.index,e)}startNodeAt(e){return new dC(this,e.index,e)}startNodeAtNode(e){return this.startNodeAt(e.loc.start)}finishNode(e,t){return this.finishNodeAt(e,t,this.state.lastTokEndLoc)}finishNodeAt(e,t,n){return e.type=t,e.end=n.index,e.loc.end=n,this.optionFlags&128&&(e.range[1]=n.index),this.optionFlags&4096&&this.processComment(e),e}resetStartLocation(e,t){e.start=t.index,e.loc.start=t,this.optionFlags&128&&(e.range[0]=t.index)}resetEndLocation(e,t=this.state.lastTokEndLoc){e.end=t.index,e.loc.end=t,this.optionFlags&128&&(e.range[1]=t.index)}resetStartLocationFromNode(e,t){this.resetStartLocation(e,t.loc.start)}castNodeTo(e,t){return e.type=t,e}cloneIdentifier(e){const{type:t,start:n,end:i,loc:s,range:a,name:o}=e,u=Object.create(M3);return u.type=t,u.start=n,u.end=i,u.loc=s,u.range=a,u.name=o,e.extra&&(u.extra=e.extra),u}cloneStringLiteral(e){const{type:t,start:n,end:i,loc:s,range:a,extra:o}=e,u=Object.create(M3);return u.type=t,u.start=n,u.end=i,u.loc=s,u.range=a,u.extra=o,u.value=e.value,u}}const R3=r=>r.type==="ParenthesizedExpression"?R3(r.expression):r;class Aae extends vae{toAssignable(e,t=!1){var n,i;let s;switch((e.type==="ParenthesizedExpression"||(n=e.extra)!=null&&n.parenthesized)&&(s=R3(e),t?s.type==="Identifier"?this.expressionScope.recordArrowParameterBindingError(Ne.InvalidParenthesizedAssignment,e):s.type!=="CallExpression"&&s.type!=="MemberExpression"&&!this.isOptionalMemberExpression(s)&&this.raise(Ne.InvalidParenthesizedAssignment,e):this.raise(Ne.InvalidParenthesizedAssignment,e)),e.type){case"Identifier":case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":case"VoidPattern":break;case"ObjectExpression":this.castNodeTo(e,"ObjectPattern");for(let o=0,u=e.properties.length,f=u-1;o<u;o++){var a;const g=e.properties[o],y=o===f;this.toAssignableObjectExpressionProp(g,y,t),y&&g.type==="RestElement"&&(a=e.extra)!=null&&a.trailingCommaLoc&&this.raise(Ne.RestTrailingComma,e.extra.trailingCommaLoc)}break;case"ObjectProperty":{const{key:o,value:u}=e;this.isPrivateName(o)&&this.classScope.usePrivateName(this.getPrivateNameSV(o),o.loc.start),this.toAssignable(u,t);break}case"SpreadElement":throw new Error("Internal @babel/parser error (this is a bug, please report it). SpreadElement should be converted by .toAssignable's caller.");case"ArrayExpression":this.castNodeTo(e,"ArrayPattern"),this.toAssignableList(e.elements,(i=e.extra)==null?void 0:i.trailingCommaLoc,t);break;case"AssignmentExpression":e.operator!=="="&&this.raise(Ne.MissingEqInAssignment,e.left.loc.end),this.castNodeTo(e,"AssignmentPattern"),delete e.operator,e.left.type==="VoidPattern"&&this.raise(Ne.VoidPatternInitializer,e.left),this.toAssignable(e.left,t);break;case"ParenthesizedExpression":this.toAssignable(s,t);break}}toAssignableObjectExpressionProp(e,t,n){if(e.type==="ObjectMethod")this.raise(e.kind==="get"||e.kind==="set"?Ne.PatternHasAccessor:Ne.PatternHasMethod,e.key);else if(e.type==="SpreadElement"){this.castNodeTo(e,"RestElement");const i=e.argument;this.checkToRestConversion(i,!1),this.toAssignable(i,n),t||this.raise(Ne.RestTrailingComma,e)}else this.toAssignable(e,n)}toAssignableList(e,t,n){const i=e.length-1;for(let s=0;s<=i;s++){const a=e[s];a&&(this.toAssignableListItem(e,s,n),a.type==="RestElement"&&(s<i?this.raise(Ne.RestTrailingComma,a):t&&this.raise(Ne.RestTrailingComma,t)))}}toAssignableListItem(e,t,n){const i=e[t];if(i.type==="SpreadElement"){this.castNodeTo(i,"RestElement");const s=i.argument;this.checkToRestConversion(s,!0),this.toAssignable(s,n)}else this.toAssignable(i,n)}isAssignable(e,t){switch(e.type){case"Identifier":case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":case"VoidPattern":return!0;case"ObjectExpression":{const n=e.properties.length-1;return e.properties.every((i,s)=>i.type!=="ObjectMethod"&&(s===n||i.type!=="SpreadElement")&&this.isAssignable(i))}case"ObjectProperty":return this.isAssignable(e.value);case"SpreadElement":return this.isAssignable(e.argument);case"ArrayExpression":return e.elements.every(n=>n===null||this.isAssignable(n));case"AssignmentExpression":return e.operator==="=";case"ParenthesizedExpression":return this.isAssignable(e.expression);case"MemberExpression":case"OptionalMemberExpression":return!t;default:return!1}}toReferencedList(e,t){return e}toReferencedListDeep(e,t){this.toReferencedList(e,t);for(const n of e)n?.type==="ArrayExpression"&&this.toReferencedListDeep(n.elements)}parseSpread(e){const t=this.startNode();return this.next(),t.argument=this.parseMaybeAssignAllowIn(e,void 0),this.finishNode(t,"SpreadElement")}parseRestBinding(){const e=this.startNode();this.next();const t=this.parseBindingAtom();return t.type==="VoidPattern"&&this.raise(Ne.UnexpectedVoidPattern,t),e.argument=t,this.finishNode(e,"RestElement")}parseBindingAtom(){switch(this.state.type){case 0:{const e=this.startNode();return this.next(),e.elements=this.parseBindingList(3,93,1),this.finishNode(e,"ArrayPattern")}case 5:return this.parseObjectLike(8,!0);case 88:return this.parseVoidPattern(null)}return this.parseIdentifier()}parseBindingList(e,t,n){const i=n&1,s=[];let a=!0;for(;!this.eat(e);)if(a?a=!1:this.expect(12),i&&this.match(12))s.push(null);else{if(this.eat(e))break;if(this.match(21)){let o=this.parseRestBinding();if((this.hasPlugin("flow")||n&2)&&(o=this.parseFunctionParamType(o)),s.push(o),!this.checkCommaAfterRest(t)){this.expect(e);break}}else{const o=[];if(n&2)for(this.match(26)&&this.hasPlugin("decorators")&&this.raise(Ne.UnsupportedParameterDecorator,this.state.startLoc);this.match(26);)o.push(this.parseDecorator());s.push(this.parseBindingElement(n,o))}}return s}parseBindingRestProperty(e){return this.next(),this.hasPlugin("discardBinding")&&this.match(88)?(e.argument=this.parseVoidPattern(null),this.raise(Ne.UnexpectedVoidPattern,e.argument)):e.argument=this.parseIdentifier(),this.checkCommaAfterRest(125),this.finishNode(e,"RestElement")}parseBindingProperty(){const{type:e,startLoc:t}=this.state;if(e===21)return this.parseBindingRestProperty(this.startNode());const n=this.startNode();return e===139?(this.expectPlugin("destructuringPrivate",t),this.classScope.usePrivateName(this.state.value,t),n.key=this.parsePrivateName()):this.parsePropertyName(n),n.method=!1,this.parseObjPropValue(n,t,!1,!1,!0,!1)}parseBindingElement(e,t){const n=this.parseMaybeDefault();return(this.hasPlugin("flow")||e&2)&&this.parseFunctionParamType(n),t.length&&(n.decorators=t,this.resetStartLocationFromNode(n,t[0])),this.parseMaybeDefault(n.loc.start,n)}parseFunctionParamType(e){return e}parseMaybeDefault(e,t){if(e??(e=this.state.startLoc),t=t??this.parseBindingAtom(),!this.eat(29))return t;const n=this.startNodeAt(e);return t.type==="VoidPattern"&&this.raise(Ne.VoidPatternInitializer,t),n.left=t,n.right=this.parseMaybeAssignAllowIn(),this.finishNode(n,"AssignmentPattern")}isValidLVal(e,t,n,i){switch(e){case"AssignmentPattern":return"left";case"RestElement":return"argument";case"ObjectProperty":return"value";case"ParenthesizedExpression":return"expression";case"ArrayPattern":return"elements";case"ObjectPattern":return"properties";case"VoidPattern":return!0;case"CallExpression":if(!t&&!this.state.strict&&this.optionFlags&8192)return!0}return!1}isOptionalMemberExpression(e){return e.type==="OptionalMemberExpression"}checkLVal(e,t,n=64,i=!1,s=!1,a=!1,o=!1){var u;const f=e.type;if(this.isObjectMethod(e))return;const g=this.isOptionalMemberExpression(e);if(g||f==="MemberExpression"){g&&(this.expectPlugin("optionalChainingAssign",e.loc.start),t.type!=="AssignmentExpression"&&this.raise(Ne.InvalidLhsOptionalChaining,e,{ancestor:t})),n!==64&&this.raise(Ne.InvalidPropertyBindingPattern,e);return}if(f==="Identifier"){this.checkIdentifier(e,n,s);const{name:V}=e;i&&(i.has(V)?this.raise(Ne.ParamDupe,e):i.add(V));return}else f==="VoidPattern"&&t.type==="CatchClause"&&this.raise(Ne.VoidPatternCatchClauseParam,e);const y=R3(e);o||(o=y.type==="CallExpression"&&(y.callee.type==="Import"||y.callee.type==="Super"));const A=this.isValidLVal(f,o,!(a||(u=e.extra)!=null&&u.parenthesized)&&t.type==="AssignmentExpression",n);if(A===!0)return;if(A===!1){const V=n===64?Ne.InvalidLhs:Ne.InvalidLhsBinding;this.raise(V,e,{ancestor:t});return}let C,M;typeof A=="string"?(C=A,M=f==="ParenthesizedExpression"):[C,M]=A;const k=f==="ArrayPattern"||f==="ObjectPattern"?{type:f}:t,D=e[C];if(Array.isArray(D))for(const V of D)V&&this.checkLVal(V,k,n,i,s,M,!0);else D&&this.checkLVal(D,k,n,i,s,M,o)}checkIdentifier(e,t,n=!1){this.state.strict&&(n?S7(e.name,this.inModule):T7(e.name))&&(t===64?this.raise(Ne.StrictEvalArguments,e,{referenceName:e.name}):this.raise(Ne.StrictEvalArgumentsBinding,e,{bindingName:e.name})),t&8192&&e.name==="let"&&this.raise(Ne.LetInLexicalBinding,e),t&64||this.declareNameFromIdentifier(e,t)}declareNameFromIdentifier(e,t){this.scope.declareName(e.name,t,e.loc.start)}checkToRestConversion(e,t){switch(e.type){case"ParenthesizedExpression":this.checkToRestConversion(e.expression,t);break;case"Identifier":case"MemberExpression":break;case"ArrayExpression":case"ObjectExpression":if(t)break;default:this.raise(Ne.InvalidRestAssignmentPattern,e)}}checkCommaAfterRest(e){return this.match(12)?(this.raise(this.lookaheadCharCode()===e?Ne.RestTrailingComma:Ne.ElementAfterRest,this.state.startLoc),!0):!1}}const tI=/in(?:stanceof)?|as|satisfies/y;function xae(r){if(r==null)throw new Error(`Unexpected ${r} value.`);return r}function c4(r){if(!r)throw new Error("Assert fail")}const gr=Oc`typescript`({AbstractMethodHasImplementation:({methodName:r})=>`Method '${r}' cannot have an implementation because it is marked abstract.`,AbstractPropertyHasInitializer:({propertyName:r})=>`Property '${r}' cannot have an initializer because it is marked abstract.`,AccessorCannotBeOptional:"An 'accessor' property cannot be declared optional.",AccessorCannotDeclareThisParameter:"'get' and 'set' accessors cannot declare 'this' parameters.",AccessorCannotHaveTypeParameters:"An accessor cannot have type parameters.",ClassMethodHasDeclare:"Class methods cannot have the 'declare' modifier.",ClassMethodHasReadonly:"Class methods cannot have the 'readonly' modifier.",ConstInitializerMustBeStringOrNumericLiteralOrLiteralEnumReference:"A 'const' initializer in an ambient context must be a string or numeric literal or literal enum reference.",ConstructorHasTypeParameters:"Type parameters cannot appear on a constructor declaration.",DeclareAccessor:({kind:r})=>`'declare' is not allowed in ${r}ters.`,DeclareClassFieldHasInitializer:"Initializers are not allowed in ambient contexts.",DeclareFunctionHasImplementation:"An implementation cannot be declared in ambient contexts.",DuplicateAccessibilityModifier:({modifier:r})=>`Accessibility modifier already seen: '${r}'.`,DuplicateModifier:({modifier:r})=>`Duplicate modifier: '${r}'.`,EmptyHeritageClauseType:({token:r})=>`'${r}' list cannot be empty.`,EmptyTypeArguments:"Type argument list cannot be empty.",EmptyTypeParameters:"Type parameter list cannot be empty.",ExpectedAmbientAfterExportDeclare:"'export declare' must be followed by an ambient declaration.",ImportAliasHasImportType:"An import alias can not use 'import type'.",ImportReflectionHasImportType:"An `import module` declaration can not use `type` modifier",IncompatibleModifiers:({modifiers:r})=>`'${r[0]}' modifier cannot be used with '${r[1]}' modifier.`,IndexSignatureHasAbstract:"Index signatures cannot have the 'abstract' modifier.",IndexSignatureHasAccessibility:({modifier:r})=>`Index signatures cannot have an accessibility modifier ('${r}').`,IndexSignatureHasDeclare:"Index signatures cannot have the 'declare' modifier.",IndexSignatureHasOverride:"'override' modifier cannot appear on an index signature.",IndexSignatureHasStatic:"Index signatures cannot have the 'static' modifier.",InitializerNotAllowedInAmbientContext:"Initializers are not allowed in ambient contexts.",InvalidHeritageClauseType:({token:r})=>`'${r}' list can only include identifiers or qualified-names with optional type arguments.`,InvalidModifierOnAwaitUsingDeclaration:r=>`'${r}' modifier cannot appear on an await using declaration.`,InvalidModifierOnTypeMember:({modifier:r})=>`'${r}' modifier cannot appear on a type member.`,InvalidModifierOnTypeParameter:({modifier:r})=>`'${r}' modifier cannot appear on a type parameter.`,InvalidModifierOnTypeParameterPositions:({modifier:r})=>`'${r}' modifier can only appear on a type parameter of a class, interface or type alias.`,InvalidModifierOnUsingDeclaration:r=>`'${r}' modifier cannot appear on a using declaration.`,InvalidModifiersOrder:({orderedModifiers:r})=>`'${r[0]}' modifier must precede '${r[1]}' modifier.`,InvalidPropertyAccessAfterInstantiationExpression:"Invalid property access after an instantiation expression. You can either wrap the instantiation expression in parentheses, or delete the type arguments.",InvalidTupleMemberLabel:"Tuple members must be labeled with a simple identifier.",MissingInterfaceName:"'interface' declarations must be followed by an identifier.",NonAbstractClassHasAbstractMethod:"Abstract methods can only appear within an abstract class.",NonClassMethodPropertyHasAbstractModifier:"'abstract' modifier can only appear on a class, method, or property declaration.",OptionalTypeBeforeRequired:"A required element cannot follow an optional element.",OverrideNotInSubClass:"This member cannot have an 'override' modifier because its containing class does not extend another class.",PatternIsOptional:"A binding pattern parameter cannot be optional in an implementation signature.",PrivateElementHasAbstract:"Private elements cannot have the 'abstract' modifier.",PrivateElementHasAccessibility:({modifier:r})=>`Private elements cannot have an accessibility modifier ('${r}').`,ReadonlyForMethodSignature:"'readonly' modifier can only appear on a property declaration or index signature.",ReservedArrowTypeParam:"This syntax is reserved in files with the .mts or .cts extension. Add a trailing comma, as in `<T,>() => ...`.",ReservedTypeAssertion:"This syntax is reserved in files with the .mts or .cts extension. Use an `as` expression instead.",SetAccessorCannotHaveOptionalParameter:"A 'set' accessor cannot have an optional parameter.",SetAccessorCannotHaveRestParameter:"A 'set' accessor cannot have rest parameter.",SetAccessorCannotHaveReturnType:"A 'set' accessor cannot have a return type annotation.",SingleTypeParameterWithoutTrailingComma:({typeParameterName:r})=>`Single type parameter ${r} should have a trailing comma. Example usage: <${r},>.`,StaticBlockCannotHaveModifier:"Static class blocks cannot have any modifier.",TupleOptionalAfterType:"A labeled tuple optional element must be declared using a question mark after the name and before the colon (`name?: type`), rather than after the type (`name: type?`).",TypeAnnotationAfterAssign:"Type annotations must come before default assignments, e.g. instead of `age = 25: number` use `age: number = 25`.",TypeImportCannotSpecifyDefaultAndNamed:"A type-only import can specify a default import or named bindings, but not both.",TypeModifierIsUsedInTypeExports:"The 'type' modifier cannot be used on a named export when 'export type' is used on its export statement.",TypeModifierIsUsedInTypeImports:"The 'type' modifier cannot be used on a named import when 'import type' is used on its import statement.",UnexpectedParameterModifier:"A parameter property is only allowed in a constructor implementation.",UnexpectedReadonly:"'readonly' type modifier is only permitted on array and tuple literal types.",UnexpectedTypeAnnotation:"Did not expect a type annotation here.",UnexpectedTypeCastInParameter:"Unexpected type cast in parameter position.",UnsupportedImportTypeArgument:"Argument in a type import must be a string literal.",UnsupportedParameterPropertyKind:"A parameter property may not be declared using a binding pattern.",UnsupportedSignatureParameterKind:({type:r})=>`Name in a signature must be an Identifier, ObjectPattern or ArrayPattern, instead got ${r}.`,UsingDeclarationInAmbientContext:r=>`'${r}' declarations are not allowed in ambient contexts.`});function wae(r){switch(r){case"any":return"TSAnyKeyword";case"boolean":return"TSBooleanKeyword";case"bigint":return"TSBigIntKeyword";case"never":return"TSNeverKeyword";case"number":return"TSNumberKeyword";case"object":return"TSObjectKeyword";case"string":return"TSStringKeyword";case"symbol":return"TSSymbolKeyword";case"undefined":return"TSUndefinedKeyword";case"unknown":return"TSUnknownKeyword";default:return}}function u4(r){return r==="private"||r==="public"||r==="protected"}function Cae(r){return r==="in"||r==="out"}var Tae=r=>class extends r{constructor(...t){super(...t),this.tsParseInOutModifiers=this.tsParseModifiers.bind(this,{allowedModifiers:["in","out"],disallowedModifiers:["const","public","private","protected","readonly","declare","abstract","override"],errorTemplate:gr.InvalidModifierOnTypeParameter}),this.tsParseConstModifier=this.tsParseModifiers.bind(this,{allowedModifiers:["const"],disallowedModifiers:["in","out"],errorTemplate:gr.InvalidModifierOnTypeParameterPositions}),this.tsParseInOutConstModifiers=this.tsParseModifiers.bind(this,{allowedModifiers:["in","out","const"],disallowedModifiers:["public","private","protected","readonly","declare","abstract","override"],errorTemplate:gr.InvalidModifierOnTypeParameter})}getScopeHandler(){return nae}tsIsIdentifier(){return Dn(this.state.type)}tsTokenCanFollowModifier(){return this.match(0)||this.match(5)||this.match(55)||this.match(21)||this.match(139)||this.isLiteralPropertyName()}tsNextTokenOnSameLineAndCanFollowModifier(){return this.next(),this.hasPrecedingLineBreak()?!1:this.tsTokenCanFollowModifier()}tsNextTokenCanFollowModifier(){return this.match(106)?(this.next(),this.tsTokenCanFollowModifier()):this.tsNextTokenOnSameLineAndCanFollowModifier()}tsParseModifier(t,n,i){if(!Dn(this.state.type)&&this.state.type!==58&&this.state.type!==75)return;const s=this.state.value;if(t.includes(s)){if(i&&this.match(106)||n&&this.tsIsStartOfStaticBlocks())return;if(this.tsTryParse(this.tsNextTokenCanFollowModifier.bind(this)))return s}}tsParseModifiers({allowedModifiers:t,disallowedModifiers:n,stopOnStartOfClassStaticBlock:i,errorTemplate:s=gr.InvalidModifierOnTypeMember},a){const o=(f,g,y,A)=>{g===y&&a[A]&&this.raise(gr.InvalidModifiersOrder,f,{orderedModifiers:[y,A]})},u=(f,g,y,A)=>{(a[y]&&g===A||a[A]&&g===y)&&this.raise(gr.IncompatibleModifiers,f,{modifiers:[y,A]})};for(;;){const{startLoc:f}=this.state,g=this.tsParseModifier(t.concat(n??[]),i,a.static);if(!g)break;u4(g)?a.accessibility?this.raise(gr.DuplicateAccessibilityModifier,f,{modifier:g}):(o(f,g,g,"override"),o(f,g,g,"static"),o(f,g,g,"readonly"),a.accessibility=g):Cae(g)?(a[g]&&this.raise(gr.DuplicateModifier,f,{modifier:g}),a[g]=!0,o(f,g,"in","out")):(hasOwnProperty.call(a,g)?this.raise(gr.DuplicateModifier,f,{modifier:g}):(o(f,g,"static","readonly"),o(f,g,"static","override"),o(f,g,"override","readonly"),o(f,g,"abstract","override"),u(f,g,"declare","override"),u(f,g,"static","abstract")),a[g]=!0),n!=null&&n.includes(g)&&this.raise(s,f,{modifier:g})}}tsIsListTerminator(t){switch(t){case"EnumMembers":case"TypeMembers":return this.match(8);case"HeritageClauseElement":return this.match(5);case"TupleElementTypes":return this.match(3);case"TypeParametersOrArguments":return this.match(48)}}tsParseList(t,n){const i=[];for(;!this.tsIsListTerminator(t);)i.push(n());return i}tsParseDelimitedList(t,n,i){return xae(this.tsParseDelimitedListWorker(t,n,!0,i))}tsParseDelimitedListWorker(t,n,i,s){const a=[];let o=-1;for(;!this.tsIsListTerminator(t);){o=-1;const u=n();if(u==null)return;if(a.push(u),this.eat(12)){o=this.state.lastTokStartLoc.index;continue}if(this.tsIsListTerminator(t))break;i&&this.expect(12);return}return s&&(s.value=o),a}tsParseBracketedList(t,n,i,s,a){s||(i?this.expect(0):this.expect(47));const o=this.tsParseDelimitedList(t,n,a);return i?this.expect(3):this.expect(48),o}tsParseImportType(){const t=this.startNode();return this.expect(83),this.expect(10),this.match(134)?t.argument=this.parseStringLiteral(this.state.value):(this.raise(gr.UnsupportedImportTypeArgument,this.state.startLoc),t.argument=super.parseExprAtom()),this.eat(12)?t.options=this.tsParseImportTypeOptions():t.options=null,this.expect(11),this.eat(16)&&(t.qualifier=this.tsParseEntityName(3)),this.match(47)&&(t.typeParameters=this.tsParseTypeArguments()),this.finishNode(t,"TSImportType")}tsParseImportTypeOptions(){const t=this.startNode();this.expect(5);const n=this.startNode();return this.isContextual(76)?(n.method=!1,n.key=this.parseIdentifier(!0),n.computed=!1,n.shorthand=!1):this.unexpected(null,76),this.expect(14),n.value=this.tsParseImportTypeWithPropertyValue(),t.properties=[this.finishObjectProperty(n)],this.eat(12),this.expect(8),this.finishNode(t,"ObjectExpression")}tsParseImportTypeWithPropertyValue(){const t=this.startNode(),n=[];for(this.expect(5);!this.match(8);){const i=this.state.type;Dn(i)||i===134?n.push(super.parsePropertyDefinition(null)):this.unexpected(),this.eat(12)}return t.properties=n,this.next(),this.finishNode(t,"ObjectExpression")}tsParseEntityName(t){let n;if(t&1&&this.match(78))if(t&2)n=this.parseIdentifier(!0);else{const i=this.startNode();this.next(),n=this.finishNode(i,"ThisExpression")}else n=this.parseIdentifier(!!(t&1));for(;this.eat(16);){const i=this.startNodeAtNode(n);i.left=n,i.right=this.parseIdentifier(!!(t&1)),n=this.finishNode(i,"TSQualifiedName")}return n}tsParseTypeReference(){const t=this.startNode();return t.typeName=this.tsParseEntityName(1),!this.hasPrecedingLineBreak()&&this.match(47)&&(t.typeParameters=this.tsParseTypeArguments()),this.finishNode(t,"TSTypeReference")}tsParseThisTypePredicate(t){this.next();const n=this.startNodeAtNode(t);return n.parameterName=t,n.typeAnnotation=this.tsParseTypeAnnotation(!1),n.asserts=!1,this.finishNode(n,"TSTypePredicate")}tsParseThisTypeNode(){const t=this.startNode();return this.next(),this.finishNode(t,"TSThisType")}tsParseTypeQuery(){const t=this.startNode();return this.expect(87),this.match(83)?t.exprName=this.tsParseImportType():t.exprName=this.tsParseEntityName(3),!this.hasPrecedingLineBreak()&&this.match(47)&&(t.typeParameters=this.tsParseTypeArguments()),this.finishNode(t,"TSTypeQuery")}tsParseTypeParameter(t){const n=this.startNode();return t(n),n.name=this.tsParseTypeParameterName(),n.constraint=this.tsEatThenParseType(81),n.default=this.tsEatThenParseType(29),this.finishNode(n,"TSTypeParameter")}tsTryParseTypeParameters(t){if(this.match(47))return this.tsParseTypeParameters(t)}tsParseTypeParameters(t){const n=this.startNode();this.match(47)||this.match(143)?this.next():this.unexpected();const i={value:-1};return n.params=this.tsParseBracketedList("TypeParametersOrArguments",this.tsParseTypeParameter.bind(this,t),!1,!0,i),n.params.length===0&&this.raise(gr.EmptyTypeParameters,n),i.value!==-1&&this.addExtra(n,"trailingComma",i.value),this.finishNode(n,"TSTypeParameterDeclaration")}tsFillSignature(t,n){const i=t===19,s="parameters",a="typeAnnotation";n.typeParameters=this.tsTryParseTypeParameters(this.tsParseConstModifier),this.expect(10),n[s]=this.tsParseBindingListForSignature(),i?n[a]=this.tsParseTypeOrTypePredicateAnnotation(t):this.match(t)&&(n[a]=this.tsParseTypeOrTypePredicateAnnotation(t))}tsParseBindingListForSignature(){const t=super.parseBindingList(11,41,2);for(const n of t){const{type:i}=n;(i==="AssignmentPattern"||i==="TSParameterProperty")&&this.raise(gr.UnsupportedSignatureParameterKind,n,{type:i})}return t}tsParseTypeMemberSemicolon(){!this.eat(12)&&!this.isLineTerminator()&&this.expect(13)}tsParseSignatureMember(t,n){return this.tsFillSignature(14,n),this.tsParseTypeMemberSemicolon(),this.finishNode(n,t)}tsIsUnambiguouslyIndexSignature(){return this.next(),Dn(this.state.type)?(this.next(),this.match(14)):!1}tsTryParseIndexSignature(t){if(!(this.match(0)&&this.tsLookAhead(this.tsIsUnambiguouslyIndexSignature.bind(this))))return;this.expect(0);const n=this.parseIdentifier();n.typeAnnotation=this.tsParseTypeAnnotation(),this.resetEndLocation(n),this.expect(3),t.parameters=[n];const i=this.tsTryParseTypeAnnotation();return i&&(t.typeAnnotation=i),this.tsParseTypeMemberSemicolon(),this.finishNode(t,"TSIndexSignature")}tsParsePropertyOrMethodSignature(t,n){if(this.eat(17)&&(t.optional=!0),this.match(10)||this.match(47)){n&&this.raise(gr.ReadonlyForMethodSignature,t);const i=t;i.kind&&this.match(47)&&this.raise(gr.AccessorCannotHaveTypeParameters,this.state.curPosition()),this.tsFillSignature(14,i),this.tsParseTypeMemberSemicolon();const s="parameters",a="typeAnnotation";if(i.kind==="get")i[s].length>0&&(this.raise(Ne.BadGetterArity,this.state.curPosition()),this.isThisParam(i[s][0])&&this.raise(gr.AccessorCannotDeclareThisParameter,this.state.curPosition()));else if(i.kind==="set"){if(i[s].length!==1)this.raise(Ne.BadSetterArity,this.state.curPosition());else{const o=i[s][0];this.isThisParam(o)&&this.raise(gr.AccessorCannotDeclareThisParameter,this.state.curPosition()),o.type==="Identifier"&&o.optional&&this.raise(gr.SetAccessorCannotHaveOptionalParameter,this.state.curPosition()),o.type==="RestElement"&&this.raise(gr.SetAccessorCannotHaveRestParameter,this.state.curPosition())}i[a]&&this.raise(gr.SetAccessorCannotHaveReturnType,i[a])}else i.kind="method";return this.finishNode(i,"TSMethodSignature")}else{const i=t;n&&(i.readonly=!0);const s=this.tsTryParseTypeAnnotation();return s&&(i.typeAnnotation=s),this.tsParseTypeMemberSemicolon(),this.finishNode(i,"TSPropertySignature")}}tsParseTypeMember(){const t=this.startNode();if(this.match(10)||this.match(47))return this.tsParseSignatureMember("TSCallSignatureDeclaration",t);if(this.match(77)){const i=this.startNode();return this.next(),this.match(10)||this.match(47)?this.tsParseSignatureMember("TSConstructSignatureDeclaration",t):(t.key=this.createIdentifier(i,"new"),this.tsParsePropertyOrMethodSignature(t,!1))}this.tsParseModifiers({allowedModifiers:["readonly"],disallowedModifiers:["declare","abstract","private","protected","public","static","override"]},t);const n=this.tsTryParseIndexSignature(t);return n||(super.parsePropertyName(t),!t.computed&&t.key.type==="Identifier"&&(t.key.name==="get"||t.key.name==="set")&&this.tsTokenCanFollowModifier()&&(t.kind=t.key.name,super.parsePropertyName(t),!this.match(10)&&!this.match(47)&&this.unexpected(null,10)),this.tsParsePropertyOrMethodSignature(t,!!t.readonly))}tsParseTypeLiteral(){const t=this.startNode();return t.members=this.tsParseObjectTypeMembers(),this.finishNode(t,"TSTypeLiteral")}tsParseObjectTypeMembers(){this.expect(5);const t=this.tsParseList("TypeMembers",this.tsParseTypeMember.bind(this));return this.expect(8),t}tsIsStartOfMappedType(){return this.next(),this.eat(53)?this.isContextual(122):(this.isContextual(122)&&this.next(),!this.match(0)||(this.next(),!this.tsIsIdentifier())?!1:(this.next(),this.match(58)))}tsParseMappedType(){const t=this.startNode();this.expect(5),this.match(53)?(t.readonly=this.state.value,this.next(),this.expectContextual(122)):this.eatContextual(122)&&(t.readonly=!0),this.expect(0);{const n=this.startNode();n.name=this.tsParseTypeParameterName(),n.constraint=this.tsExpectThenParseType(58),t.typeParameter=this.finishNode(n,"TSTypeParameter")}return t.nameType=this.eatContextual(93)?this.tsParseType():null,this.expect(3),this.match(53)?(t.optional=this.state.value,this.next(),this.expect(17)):this.eat(17)&&(t.optional=!0),t.typeAnnotation=this.tsTryParseType(),this.semicolon(),this.expect(8),this.finishNode(t,"TSMappedType")}tsParseTupleType(){const t=this.startNode();t.elementTypes=this.tsParseBracketedList("TupleElementTypes",this.tsParseTupleElementType.bind(this),!0,!1);let n=!1;return t.elementTypes.forEach(i=>{const{type:s}=i;n&&s!=="TSRestType"&&s!=="TSOptionalType"&&!(s==="TSNamedTupleMember"&&i.optional)&&this.raise(gr.OptionalTypeBeforeRequired,i),n||(n=s==="TSNamedTupleMember"&&i.optional||s==="TSOptionalType")}),this.finishNode(t,"TSTupleType")}tsParseTupleElementType(){const t=this.state.startLoc,n=this.eat(21),{startLoc:i}=this.state;let s,a,o,u;const g=Wl(this.state.type)?this.lookaheadCharCode():null;if(g===58)s=!0,o=!1,a=this.parseIdentifier(!0),this.expect(14),u=this.tsParseType();else if(g===63){o=!0;const y=this.state.value,A=this.tsParseNonArrayType();this.lookaheadCharCode()===58?(s=!0,a=this.createIdentifier(this.startNodeAt(i),y),this.expect(17),this.expect(14),u=this.tsParseType()):(s=!1,u=A,this.expect(17))}else u=this.tsParseType(),o=this.eat(17),s=this.eat(14);if(s){let y;a?(y=this.startNodeAt(i),y.optional=o,y.label=a,y.elementType=u,this.eat(17)&&(y.optional=!0,this.raise(gr.TupleOptionalAfterType,this.state.lastTokStartLoc))):(y=this.startNodeAt(i),y.optional=o,this.raise(gr.InvalidTupleMemberLabel,u),y.label=u,y.elementType=this.tsParseType()),u=this.finishNode(y,"TSNamedTupleMember")}else if(o){const y=this.startNodeAt(i);y.typeAnnotation=u,u=this.finishNode(y,"TSOptionalType")}if(n){const y=this.startNodeAt(t);y.typeAnnotation=u,u=this.finishNode(y,"TSRestType")}return u}tsParseParenthesizedType(){const t=this.startNode();return this.expect(10),t.typeAnnotation=this.tsParseType(),this.expect(11),this.finishNode(t,"TSParenthesizedType")}tsParseFunctionOrConstructorType(t,n){const i=this.startNode();return t==="TSConstructorType"&&(i.abstract=!!n,n&&this.next(),this.next()),this.tsInAllowConditionalTypesContext(()=>this.tsFillSignature(19,i)),this.finishNode(i,t)}tsParseLiteralTypeNode(){const t=this.startNode();switch(this.state.type){case 135:case 136:case 134:case 85:case 86:t.literal=super.parseExprAtom();break;default:this.unexpected()}return this.finishNode(t,"TSLiteralType")}tsParseTemplateLiteralType(){{const t=this.startNode();return t.literal=super.parseTemplate(!1),this.finishNode(t,"TSLiteralType")}}parseTemplateSubstitution(){return this.state.inType?this.tsParseType():super.parseTemplateSubstitution()}tsParseThisTypeOrThisTypePredicate(){const t=this.tsParseThisTypeNode();return this.isContextual(116)&&!this.hasPrecedingLineBreak()?this.tsParseThisTypePredicate(t):t}tsParseNonArrayType(){switch(this.state.type){case 134:case 135:case 136:case 85:case 86:return this.tsParseLiteralTypeNode();case 53:if(this.state.value==="-"){const t=this.startNode(),n=this.lookahead();return n.type!==135&&n.type!==136&&this.unexpected(),t.literal=this.parseMaybeUnary(),this.finishNode(t,"TSLiteralType")}break;case 78:return this.tsParseThisTypeOrThisTypePredicate();case 87:return this.tsParseTypeQuery();case 83:return this.tsParseImportType();case 5:return this.tsLookAhead(this.tsIsStartOfMappedType.bind(this))?this.tsParseMappedType():this.tsParseTypeLiteral();case 0:return this.tsParseTupleType();case 10:return this.tsParseParenthesizedType();case 25:case 24:return this.tsParseTemplateLiteralType();default:{const{type:t}=this.state;if(Dn(t)||t===88||t===84){const n=t===88?"TSVoidKeyword":t===84?"TSNullKeyword":wae(this.state.value);if(n!==void 0&&this.lookaheadCharCode()!==46){const i=this.startNode();return this.next(),this.finishNode(i,n)}return this.tsParseTypeReference()}}}throw this.unexpected()}tsParseArrayTypeOrHigher(){const{startLoc:t}=this.state;let n=this.tsParseNonArrayType();for(;!this.hasPrecedingLineBreak()&&this.eat(0);)if(this.match(3)){const i=this.startNodeAt(t);i.elementType=n,this.expect(3),n=this.finishNode(i,"TSArrayType")}else{const i=this.startNodeAt(t);i.objectType=n,i.indexType=this.tsParseType(),this.expect(3),n=this.finishNode(i,"TSIndexedAccessType")}return n}tsParseTypeOperator(){const t=this.startNode(),n=this.state.value;return this.next(),t.operator=n,t.typeAnnotation=this.tsParseTypeOperatorOrHigher(),n==="readonly"&&this.tsCheckTypeAnnotationForReadOnly(t),this.finishNode(t,"TSTypeOperator")}tsCheckTypeAnnotationForReadOnly(t){switch(t.typeAnnotation.type){case"TSTupleType":case"TSArrayType":return;default:this.raise(gr.UnexpectedReadonly,t)}}tsParseInferType(){const t=this.startNode();this.expectContextual(115);const n=this.startNode();return n.name=this.tsParseTypeParameterName(),n.constraint=this.tsTryParse(()=>this.tsParseConstraintForInferType()),t.typeParameter=this.finishNode(n,"TSTypeParameter"),this.finishNode(t,"TSInferType")}tsParseConstraintForInferType(){if(this.eat(81)){const t=this.tsInDisallowConditionalTypesContext(()=>this.tsParseType());if(this.state.inDisallowConditionalTypesContext||!this.match(17))return t}}tsParseTypeOperatorOrHigher(){return Moe(this.state.type)&&!this.state.containsEsc?this.tsParseTypeOperator():this.isContextual(115)?this.tsParseInferType():this.tsInAllowConditionalTypesContext(()=>this.tsParseArrayTypeOrHigher())}tsParseUnionOrIntersectionType(t,n,i){const s=this.startNode(),a=this.eat(i),o=[];do o.push(n());while(this.eat(i));return o.length===1&&!a?o[0]:(s.types=o,this.finishNode(s,t))}tsParseIntersectionTypeOrHigher(){return this.tsParseUnionOrIntersectionType("TSIntersectionType",this.tsParseTypeOperatorOrHigher.bind(this),45)}tsParseUnionTypeOrHigher(){return this.tsParseUnionOrIntersectionType("TSUnionType",this.tsParseIntersectionTypeOrHigher.bind(this),43)}tsIsStartOfFunctionType(){return this.match(47)?!0:this.match(10)&&this.tsLookAhead(this.tsIsUnambiguouslyStartOfFunctionType.bind(this))}tsSkipParameterStart(){if(Dn(this.state.type)||this.match(78))return this.next(),!0;if(this.match(5)){const{errors:t}=this.state,n=t.length;try{return this.parseObjectLike(8,!0),t.length===n}catch{return!1}}if(this.match(0)){this.next();const{errors:t}=this.state,n=t.length;try{return super.parseBindingList(3,93,1),t.length===n}catch{return!1}}return!1}tsIsUnambiguouslyStartOfFunctionType(){return this.next(),!!(this.match(11)||this.match(21)||this.tsSkipParameterStart()&&(this.match(14)||this.match(12)||this.match(17)||this.match(29)||this.match(11)&&(this.next(),this.match(19))))}tsParseTypeOrTypePredicateAnnotation(t){return this.tsInType(()=>{const n=this.startNode();this.expect(t);const i=this.startNode(),s=!!this.tsTryParse(this.tsParseTypePredicateAsserts.bind(this));if(s&&this.match(78)){let u=this.tsParseThisTypeOrThisTypePredicate();return u.type==="TSThisType"?(i.parameterName=u,i.asserts=!0,i.typeAnnotation=null,u=this.finishNode(i,"TSTypePredicate")):(this.resetStartLocationFromNode(u,i),u.asserts=!0),n.typeAnnotation=u,this.finishNode(n,"TSTypeAnnotation")}const a=this.tsIsIdentifier()&&this.tsTryParse(this.tsParseTypePredicatePrefix.bind(this));if(!a)return s?(i.parameterName=this.parseIdentifier(),i.asserts=s,i.typeAnnotation=null,n.typeAnnotation=this.finishNode(i,"TSTypePredicate"),this.finishNode(n,"TSTypeAnnotation")):this.tsParseTypeAnnotation(!1,n);const o=this.tsParseTypeAnnotation(!1);return i.parameterName=a,i.typeAnnotation=o,i.asserts=s,n.typeAnnotation=this.finishNode(i,"TSTypePredicate"),this.finishNode(n,"TSTypeAnnotation")})}tsTryParseTypeOrTypePredicateAnnotation(){if(this.match(14))return this.tsParseTypeOrTypePredicateAnnotation(14)}tsTryParseTypeAnnotation(){if(this.match(14))return this.tsParseTypeAnnotation()}tsTryParseType(){return this.tsEatThenParseType(14)}tsParseTypePredicatePrefix(){const t=this.parseIdentifier();if(this.isContextual(116)&&!this.hasPrecedingLineBreak())return this.next(),t}tsParseTypePredicateAsserts(){if(this.state.type!==109)return!1;const t=this.state.containsEsc;return this.next(),!Dn(this.state.type)&&!this.match(78)?!1:(t&&this.raise(Ne.InvalidEscapedReservedWord,this.state.lastTokStartLoc,{reservedWord:"asserts"}),!0)}tsParseTypeAnnotation(t=!0,n=this.startNode()){return this.tsInType(()=>{t&&this.expect(14),n.typeAnnotation=this.tsParseType()}),this.finishNode(n,"TSTypeAnnotation")}tsParseType(){c4(this.state.inType);const t=this.tsParseNonConditionalType();if(this.state.inDisallowConditionalTypesContext||this.hasPrecedingLineBreak()||!this.eat(81))return t;const n=this.startNodeAtNode(t);return n.checkType=t,n.extendsType=this.tsInDisallowConditionalTypesContext(()=>this.tsParseNonConditionalType()),this.expect(17),n.trueType=this.tsInAllowConditionalTypesContext(()=>this.tsParseType()),this.expect(14),n.falseType=this.tsInAllowConditionalTypesContext(()=>this.tsParseType()),this.finishNode(n,"TSConditionalType")}isAbstractConstructorSignature(){return this.isContextual(124)&&this.isLookaheadContextual("new")}tsParseNonConditionalType(){return this.tsIsStartOfFunctionType()?this.tsParseFunctionOrConstructorType("TSFunctionType"):this.match(77)?this.tsParseFunctionOrConstructorType("TSConstructorType"):this.isAbstractConstructorSignature()?this.tsParseFunctionOrConstructorType("TSConstructorType",!0):this.tsParseUnionTypeOrHigher()}tsParseTypeAssertion(){this.getPluginOption("typescript","disallowAmbiguousJSXLike")&&this.raise(gr.ReservedTypeAssertion,this.state.startLoc);const t=this.startNode();return t.typeAnnotation=this.tsInType(()=>(this.next(),this.match(75)?this.tsParseTypeReference():this.tsParseType())),this.expect(48),t.expression=this.parseMaybeUnary(),this.finishNode(t,"TSTypeAssertion")}tsParseHeritageClause(t){const n=this.state.startLoc,i=this.tsParseDelimitedList("HeritageClauseElement",()=>{{const s=this.startNode();return s.expression=this.tsParseEntityName(3),this.match(47)&&(s.typeParameters=this.tsParseTypeArguments()),this.finishNode(s,"TSExpressionWithTypeArguments")}});return i.length||this.raise(gr.EmptyHeritageClauseType,n,{token:t}),i}tsParseInterfaceDeclaration(t,n={}){if(this.hasFollowingLineBreak())return null;this.expectContextual(129),n.declare&&(t.declare=!0),Dn(this.state.type)?(t.id=this.parseIdentifier(),this.checkIdentifier(t.id,130)):(t.id=null,this.raise(gr.MissingInterfaceName,this.state.startLoc)),t.typeParameters=this.tsTryParseTypeParameters(this.tsParseInOutConstModifiers),this.eat(81)&&(t.extends=this.tsParseHeritageClause("extends"));const i=this.startNode();return i.body=this.tsInType(this.tsParseObjectTypeMembers.bind(this)),t.body=this.finishNode(i,"TSInterfaceBody"),this.finishNode(t,"TSInterfaceDeclaration")}tsParseTypeAliasDeclaration(t){return t.id=this.parseIdentifier(),this.checkIdentifier(t.id,2),t.typeAnnotation=this.tsInType(()=>{if(t.typeParameters=this.tsTryParseTypeParameters(this.tsParseInOutModifiers),this.expect(29),this.isContextual(114)&&this.lookaheadCharCode()!==46){const n=this.startNode();return this.next(),this.finishNode(n,"TSIntrinsicKeyword")}return this.tsParseType()}),this.semicolon(),this.finishNode(t,"TSTypeAliasDeclaration")}tsInTopLevelContext(t){if(this.curContext()!==Sn.brace){const n=this.state.context;this.state.context=[n[0]];try{return t()}finally{this.state.context=n}}else return t()}tsInType(t){const n=this.state.inType;this.state.inType=!0;try{return t()}finally{this.state.inType=n}}tsInDisallowConditionalTypesContext(t){const n=this.state.inDisallowConditionalTypesContext;this.state.inDisallowConditionalTypesContext=!0;try{return t()}finally{this.state.inDisallowConditionalTypesContext=n}}tsInAllowConditionalTypesContext(t){const n=this.state.inDisallowConditionalTypesContext;this.state.inDisallowConditionalTypesContext=!1;try{return t()}finally{this.state.inDisallowConditionalTypesContext=n}}tsEatThenParseType(t){if(this.match(t))return this.tsNextThenParseType()}tsExpectThenParseType(t){return this.tsInType(()=>(this.expect(t),this.tsParseType()))}tsNextThenParseType(){return this.tsInType(()=>(this.next(),this.tsParseType()))}tsParseEnumMember(){const t=this.startNode();return t.id=this.match(134)?super.parseStringLiteral(this.state.value):this.parseIdentifier(!0),this.eat(29)&&(t.initializer=super.parseMaybeAssignAllowIn()),this.finishNode(t,"TSEnumMember")}tsParseEnumDeclaration(t,n={}){return n.const&&(t.const=!0),n.declare&&(t.declare=!0),this.expectContextual(126),t.id=this.parseIdentifier(),this.checkIdentifier(t.id,t.const?8971:8459),this.expect(5),t.members=this.tsParseDelimitedList("EnumMembers",this.tsParseEnumMember.bind(this)),this.expect(8),this.finishNode(t,"TSEnumDeclaration")}tsParseEnumBody(){const t=this.startNode();return this.expect(5),t.members=this.tsParseDelimitedList("EnumMembers",this.tsParseEnumMember.bind(this)),this.expect(8),this.finishNode(t,"TSEnumBody")}tsParseModuleBlock(){const t=this.startNode();return this.scope.enter(0),this.expect(5),super.parseBlockOrModuleBlockBody(t.body=[],void 0,!0,8),this.scope.exit(),this.finishNode(t,"TSModuleBlock")}tsParseModuleOrNamespaceDeclaration(t,n=!1){if(t.id=this.parseIdentifier(),n||this.checkIdentifier(t.id,1024),this.eat(16)){const i=this.startNode();this.tsParseModuleOrNamespaceDeclaration(i,!0),t.body=i}else this.scope.enter(1024),this.prodParam.enter(0),t.body=this.tsParseModuleBlock(),this.prodParam.exit(),this.scope.exit();return this.finishNode(t,"TSModuleDeclaration")}tsParseAmbientExternalModuleDeclaration(t){return this.isContextual(112)?(t.kind="global",t.global=!0,t.id=this.parseIdentifier()):this.match(134)?(t.kind="module",t.id=super.parseStringLiteral(this.state.value)):this.unexpected(),this.match(5)?(this.scope.enter(1024),this.prodParam.enter(0),t.body=this.tsParseModuleBlock(),this.prodParam.exit(),this.scope.exit()):this.semicolon(),this.finishNode(t,"TSModuleDeclaration")}tsParseImportEqualsDeclaration(t,n,i){t.isExport=i||!1,t.id=n||this.parseIdentifier(),this.checkIdentifier(t.id,4096),this.expect(29);const s=this.tsParseModuleReference();return t.importKind==="type"&&s.type!=="TSExternalModuleReference"&&this.raise(gr.ImportAliasHasImportType,s),t.moduleReference=s,this.semicolon(),this.finishNode(t,"TSImportEqualsDeclaration")}tsIsExternalModuleReference(){return this.isContextual(119)&&this.lookaheadCharCode()===40}tsParseModuleReference(){return this.tsIsExternalModuleReference()?this.tsParseExternalModuleReference():this.tsParseEntityName(0)}tsParseExternalModuleReference(){const t=this.startNode();return this.expectContextual(119),this.expect(10),this.match(134)||this.unexpected(),t.expression=super.parseExprAtom(),this.expect(11),this.sawUnambiguousESM=!0,this.finishNode(t,"TSExternalModuleReference")}tsLookAhead(t){const n=this.state.clone(),i=t();return this.state=n,i}tsTryParseAndCatch(t){const n=this.tryParse(i=>t()||i());if(!(n.aborted||!n.node))return n.error&&(this.state=n.failState),n.node}tsTryParse(t){const n=this.state.clone(),i=t();if(i!==void 0&&i!==!1)return i;this.state=n}tsTryParseDeclare(t){if(this.isLineTerminator())return;const n=this.state.type;return this.tsInAmbientContext(()=>{switch(n){case 68:return t.declare=!0,super.parseFunctionStatement(t,!1,!1);case 80:return t.declare=!0,this.parseClass(t,!0,!1);case 126:return this.tsParseEnumDeclaration(t,{declare:!0});case 112:return this.tsParseAmbientExternalModuleDeclaration(t);case 100:if(this.state.containsEsc)return;case 75:case 74:return!this.match(75)||!this.isLookaheadContextual("enum")?(t.declare=!0,this.parseVarStatement(t,this.state.value,!0)):(this.expect(75),this.tsParseEnumDeclaration(t,{const:!0,declare:!0}));case 107:if(this.isUsing())return this.raise(gr.InvalidModifierOnUsingDeclaration,this.state.startLoc,"declare"),t.declare=!0,this.parseVarStatement(t,"using",!0);break;case 96:if(this.isAwaitUsing())return this.raise(gr.InvalidModifierOnAwaitUsingDeclaration,this.state.startLoc,"declare"),t.declare=!0,this.next(),this.parseVarStatement(t,"await using",!0);break;case 129:{const i=this.tsParseInterfaceDeclaration(t,{declare:!0});if(i)return i}default:if(Dn(n))return this.tsParseDeclaration(t,this.state.type,!0,null)}})}tsTryParseExportDeclaration(){return this.tsParseDeclaration(this.startNode(),this.state.type,!0,null)}tsParseDeclaration(t,n,i,s){switch(n){case 124:if(this.tsCheckLineTerminator(i)&&(this.match(80)||Dn(this.state.type)))return this.tsParseAbstractDeclaration(t,s);break;case 127:if(this.tsCheckLineTerminator(i)){if(this.match(134))return this.tsParseAmbientExternalModuleDeclaration(t);if(Dn(this.state.type))return t.kind="module",this.tsParseModuleOrNamespaceDeclaration(t)}break;case 128:if(this.tsCheckLineTerminator(i)&&Dn(this.state.type))return t.kind="namespace",this.tsParseModuleOrNamespaceDeclaration(t);break;case 130:if(this.tsCheckLineTerminator(i)&&Dn(this.state.type))return this.tsParseTypeAliasDeclaration(t);break}}tsCheckLineTerminator(t){return t?this.hasFollowingLineBreak()?!1:(this.next(),!0):!this.isLineTerminator()}tsTryParseGenericAsyncArrowFunction(t){if(!this.match(47))return;const n=this.state.maybeInArrowParameters;this.state.maybeInArrowParameters=!0;const i=this.tsTryParseAndCatch(()=>{const s=this.startNodeAt(t);return s.typeParameters=this.tsParseTypeParameters(this.tsParseConstModifier),super.parseFunctionParams(s),s.returnType=this.tsTryParseTypeOrTypePredicateAnnotation(),this.expect(19),s});if(this.state.maybeInArrowParameters=n,!!i)return super.parseArrowExpression(i,null,!0)}tsParseTypeArgumentsInExpression(){if(this.reScan_lt()===47)return this.tsParseTypeArguments()}tsParseTypeArguments(){const t=this.startNode();return t.params=this.tsInType(()=>this.tsInTopLevelContext(()=>(this.expect(47),this.tsParseDelimitedList("TypeParametersOrArguments",this.tsParseType.bind(this))))),t.params.length===0?this.raise(gr.EmptyTypeArguments,t):!this.state.inType&&this.curContext()===Sn.brace&&this.reScan_lt_gt(),this.expect(48),this.finishNode(t,"TSTypeParameterInstantiation")}tsIsDeclarationStart(){return Roe(this.state.type)}isExportDefaultSpecifier(){return this.tsIsDeclarationStart()?!1:super.isExportDefaultSpecifier()}parseBindingElement(t,n){const i=n.length?n[0].loc.start:this.state.startLoc,s={};this.tsParseModifiers({allowedModifiers:["public","private","protected","override","readonly"]},s);const a=s.accessibility,o=s.override,u=s.readonly;!(t&4)&&(a||u||o)&&this.raise(gr.UnexpectedParameterModifier,i);const f=this.parseMaybeDefault();t&2&&this.parseFunctionParamType(f);const g=this.parseMaybeDefault(f.loc.start,f);if(a||u||o){const y=this.startNodeAt(i);return n.length&&(y.decorators=n),a&&(y.accessibility=a),u&&(y.readonly=u),o&&(y.override=o),g.type!=="Identifier"&&g.type!=="AssignmentPattern"&&this.raise(gr.UnsupportedParameterPropertyKind,y),y.parameter=g,this.finishNode(y,"TSParameterProperty")}return n.length&&(f.decorators=n),g}isSimpleParameter(t){return t.type==="TSParameterProperty"&&super.isSimpleParameter(t.parameter)||super.isSimpleParameter(t)}tsDisallowOptionalPattern(t){for(const n of t.params)n.type!=="Identifier"&&n.optional&&!this.state.isAmbientContext&&this.raise(gr.PatternIsOptional,n)}setArrowFunctionParameters(t,n,i){super.setArrowFunctionParameters(t,n,i),this.tsDisallowOptionalPattern(t)}parseFunctionBodyAndFinish(t,n,i=!1){this.match(14)&&(t.returnType=this.tsParseTypeOrTypePredicateAnnotation(14));const s=n==="FunctionDeclaration"?"TSDeclareFunction":n==="ClassMethod"||n==="ClassPrivateMethod"?"TSDeclareMethod":void 0;return s&&!this.match(5)&&this.isLineTerminator()?this.finishNode(t,s):s==="TSDeclareFunction"&&this.state.isAmbientContext&&(this.raise(gr.DeclareFunctionHasImplementation,t),t.declare)?super.parseFunctionBodyAndFinish(t,s,i):(this.tsDisallowOptionalPattern(t),super.parseFunctionBodyAndFinish(t,n,i))}registerFunctionStatementId(t){!t.body&&t.id?this.checkIdentifier(t.id,1024):super.registerFunctionStatementId(t)}tsCheckForInvalidTypeCasts(t){t.forEach(n=>{n?.type==="TSTypeCastExpression"&&this.raise(gr.UnexpectedTypeAnnotation,n.typeAnnotation)})}toReferencedList(t,n){return this.tsCheckForInvalidTypeCasts(t),t}parseArrayLike(t,n,i){const s=super.parseArrayLike(t,n,i);return s.type==="ArrayExpression"&&this.tsCheckForInvalidTypeCasts(s.elements),s}parseSubscript(t,n,i,s){if(!this.hasPrecedingLineBreak()&&this.match(35)){this.state.canStartJSXElement=!1,this.next();const o=this.startNodeAt(n);return o.expression=t,this.finishNode(o,"TSNonNullExpression")}let a=!1;if(this.match(18)&&this.lookaheadCharCode()===60){if(i)return s.stop=!0,t;s.optionalChainMember=a=!0,this.next()}if(this.match(47)||this.match(51)){let o;const u=this.tsTryParseAndCatch(()=>{if(!i&&this.atPossibleAsyncArrow(t)){const A=this.tsTryParseGenericAsyncArrowFunction(n);if(A)return s.stop=!0,A}const f=this.tsParseTypeArgumentsInExpression();if(!f)return;if(a&&!this.match(10)){o=this.state.curPosition();return}if(hC(this.state.type)){const A=super.parseTaggedTemplateExpression(t,n,s);return A.typeParameters=f,A}if(!i&&this.eat(10)){const A=this.startNodeAt(n);return A.callee=t,A.arguments=this.parseCallExpressionArguments(),this.tsCheckForInvalidTypeCasts(A.arguments),A.typeParameters=f,s.optionalChainMember&&(A.optional=a),this.finishCallExpression(A,s.optionalChainMember)}const g=this.state.type;if(g===48||g===52||g!==10&&v0(g)&&!this.hasPrecedingLineBreak())return;const y=this.startNodeAt(n);return y.expression=t,y.typeParameters=f,this.finishNode(y,"TSInstantiationExpression")});if(o&&this.unexpected(o,10),u)return u.type==="TSInstantiationExpression"&&((this.match(16)||this.match(18)&&this.lookaheadCharCode()!==40)&&this.raise(gr.InvalidPropertyAccessAfterInstantiationExpression,this.state.startLoc),!this.match(16)&&!this.match(18)&&(u.expression=super.stopParseSubscript(t,s))),u}return super.parseSubscript(t,n,i,s)}parseNewCallee(t){var n;super.parseNewCallee(t);const{callee:i}=t;i.type==="TSInstantiationExpression"&&!((n=i.extra)!=null&&n.parenthesized)&&(t.typeParameters=i.typeParameters,t.callee=i.expression)}parseExprOp(t,n,i){let s;if(aw(58)>i&&!this.hasPrecedingLineBreak()&&(this.isContextual(93)||(s=this.isContextual(120)))){const a=this.startNodeAt(n);return a.expression=t,a.typeAnnotation=this.tsInType(()=>(this.next(),this.match(75)?(s&&this.raise(Ne.UnexpectedKeyword,this.state.startLoc,{keyword:"const"}),this.tsParseTypeReference()):this.tsParseType())),this.finishNode(a,s?"TSSatisfiesExpression":"TSAsExpression"),this.reScan_lt_gt(),this.parseExprOp(a,n,i)}return super.parseExprOp(t,n,i)}checkReservedWord(t,n,i,s){this.state.isAmbientContext||super.checkReservedWord(t,n,i,s)}checkImportReflection(t){super.checkImportReflection(t),t.module&&t.importKind!=="value"&&this.raise(gr.ImportReflectionHasImportType,t.specifiers[0].loc.start)}checkDuplicateExports(){}isPotentialImportPhase(t){if(super.isPotentialImportPhase(t))return!0;if(this.isContextual(130)){const n=this.lookaheadCharCode();return t?n===123||n===42:n!==61}return!t&&this.isContextual(87)}applyImportPhase(t,n,i,s){super.applyImportPhase(t,n,i,s),n?t.exportKind=i==="type"?"type":"value":t.importKind=i==="type"||i==="typeof"?i:"value"}parseImport(t){if(this.match(134))return t.importKind="value",super.parseImport(t);let n;if(Dn(this.state.type)&&this.lookaheadCharCode()===61)return t.importKind="value",this.tsParseImportEqualsDeclaration(t);if(this.isContextual(130)){const i=this.parseMaybeImportPhase(t,!1);if(this.lookaheadCharCode()===61)return this.tsParseImportEqualsDeclaration(t,i);n=super.parseImportSpecifiersAndAfter(t,i)}else n=super.parseImport(t);return n.importKind==="type"&&n.specifiers.length>1&&n.specifiers[0].type==="ImportDefaultSpecifier"&&this.raise(gr.TypeImportCannotSpecifyDefaultAndNamed,n),n}parseExport(t,n){if(this.match(83)){const i=t;this.next();let s=null;return this.isContextual(130)&&this.isPotentialImportPhase(!1)?s=this.parseMaybeImportPhase(i,!1):i.importKind="value",this.tsParseImportEqualsDeclaration(i,s,!0)}else if(this.eat(29)){const i=t;return i.expression=super.parseExpression(),this.semicolon(),this.sawUnambiguousESM=!0,this.finishNode(i,"TSExportAssignment")}else if(this.eatContextual(93)){const i=t;return this.expectContextual(128),i.id=this.parseIdentifier(),this.semicolon(),this.finishNode(i,"TSNamespaceExportDeclaration")}else return super.parseExport(t,n)}isAbstractClass(){return this.isContextual(124)&&this.isLookaheadContextual("class")}parseExportDefaultExpression(){if(this.isAbstractClass()){const t=this.startNode();return this.next(),t.abstract=!0,this.parseClass(t,!0,!0)}if(this.match(129)){const t=this.tsParseInterfaceDeclaration(this.startNode());if(t)return t}return super.parseExportDefaultExpression()}parseVarStatement(t,n,i=!1){const{isAmbientContext:s}=this.state,a=super.parseVarStatement(t,n,i||s);if(!s)return a;if(!t.declare&&(n==="using"||n==="await using"))return this.raiseOverwrite(gr.UsingDeclarationInAmbientContext,t,n),a;for(const{id:o,init:u}of a.declarations)u&&(n==="var"||n==="let"||o.typeAnnotation?this.raise(gr.InitializerNotAllowedInAmbientContext,u):Eae(u,this.hasPlugin("estree"))||this.raise(gr.ConstInitializerMustBeStringOrNumericLiteralOrLiteralEnumReference,u));return a}parseStatementContent(t,n){if(!this.state.containsEsc)switch(this.state.type){case 75:{if(this.isLookaheadContextual("enum")){const i=this.startNode();return this.expect(75),this.tsParseEnumDeclaration(i,{const:!0})}break}case 124:case 125:{if(this.nextTokenIsIdentifierAndNotTSRelationalOperatorOnSameLine()){const i=this.state.type,s=this.startNode();this.next();const a=i===125?this.tsTryParseDeclare(s):this.tsParseAbstractDeclaration(s,n);return a?(i===125&&(a.declare=!0),a):(s.expression=this.createIdentifier(this.startNodeAt(s.loc.start),i===125?"declare":"abstract"),this.semicolon(!1),this.finishNode(s,"ExpressionStatement"))}break}case 126:return this.tsParseEnumDeclaration(this.startNode());case 112:{if(this.lookaheadCharCode()===123){const s=this.startNode();return this.tsParseAmbientExternalModuleDeclaration(s)}break}case 129:{const i=this.tsParseInterfaceDeclaration(this.startNode());if(i)return i;break}case 127:{if(this.nextTokenIsIdentifierOrStringLiteralOnSameLine()){const i=this.startNode();return this.next(),this.tsParseDeclaration(i,127,!1,n)}break}case 128:{if(this.nextTokenIsIdentifierOnSameLine()){const i=this.startNode();return this.next(),this.tsParseDeclaration(i,128,!1,n)}break}case 130:{if(this.nextTokenIsIdentifierOnSameLine()){const i=this.startNode();return this.next(),this.tsParseTypeAliasDeclaration(i)}break}}return super.parseStatementContent(t,n)}parseAccessModifier(){return this.tsParseModifier(["public","protected","private"])}tsHasSomeModifiers(t,n){return n.some(i=>u4(i)?t.accessibility===i:!!t[i])}tsIsStartOfStaticBlocks(){return this.isContextual(106)&&this.lookaheadCharCode()===123}parseClassMember(t,n,i){const s=["declare","private","public","protected","override","abstract","readonly","static"];this.tsParseModifiers({allowedModifiers:s,disallowedModifiers:["in","out"],stopOnStartOfClassStaticBlock:!0,errorTemplate:gr.InvalidModifierOnTypeParameterPositions},n);const a=()=>{this.tsIsStartOfStaticBlocks()?(this.next(),this.next(),this.tsHasSomeModifiers(n,s)&&this.raise(gr.StaticBlockCannotHaveModifier,this.state.curPosition()),super.parseClassStaticBlock(t,n)):this.parseClassMemberWithIsStatic(t,n,i,!!n.static)};n.declare?this.tsInAmbientContext(a):a()}parseClassMemberWithIsStatic(t,n,i,s){const a=this.tsTryParseIndexSignature(n);if(a){t.body.push(a),n.abstract&&this.raise(gr.IndexSignatureHasAbstract,n),n.accessibility&&this.raise(gr.IndexSignatureHasAccessibility,n,{modifier:n.accessibility}),n.declare&&this.raise(gr.IndexSignatureHasDeclare,n),n.override&&this.raise(gr.IndexSignatureHasOverride,n);return}!this.state.inAbstractClass&&n.abstract&&this.raise(gr.NonAbstractClassHasAbstractMethod,n),n.override&&(i.hadSuperClass||this.raise(gr.OverrideNotInSubClass,n)),super.parseClassMemberWithIsStatic(t,n,i,s)}parsePostMemberNameModifiers(t){this.eat(17)&&(t.optional=!0),t.readonly&&this.match(10)&&this.raise(gr.ClassMethodHasReadonly,t),t.declare&&this.match(10)&&this.raise(gr.ClassMethodHasDeclare,t)}shouldParseExportDeclaration(){return this.tsIsDeclarationStart()?!0:super.shouldParseExportDeclaration()}parseConditional(t,n,i){if(!this.match(17))return t;if(this.state.maybeInArrowParameters){const s=this.lookaheadCharCode();if(s===44||s===61||s===58||s===41)return this.setOptionalParametersError(i),t}return super.parseConditional(t,n,i)}parseParenItem(t,n){const i=super.parseParenItem(t,n);if(this.eat(17)&&(i.optional=!0,this.resetEndLocation(t)),this.match(14)){const s=this.startNodeAt(n);return s.expression=t,s.typeAnnotation=this.tsParseTypeAnnotation(),this.finishNode(s,"TSTypeCastExpression")}return t}parseExportDeclaration(t){if(!this.state.isAmbientContext&&this.isContextual(125))return this.tsInAmbientContext(()=>this.parseExportDeclaration(t));const n=this.state.startLoc,i=this.eatContextual(125);if(i&&(this.isContextual(125)||!this.shouldParseExportDeclaration()))throw this.raise(gr.ExpectedAmbientAfterExportDeclare,this.state.startLoc);const a=Dn(this.state.type)&&this.tsTryParseExportDeclaration()||super.parseExportDeclaration(t);return a?((a.type==="TSInterfaceDeclaration"||a.type==="TSTypeAliasDeclaration"||i)&&(t.exportKind="type"),i&&a.type!=="TSImportEqualsDeclaration"&&(this.resetStartLocation(a,n),a.declare=!0),a):null}parseClassId(t,n,i,s){if((!n||i)&&this.isContextual(113))return;super.parseClassId(t,n,i,t.declare?1024:8331);const a=this.tsTryParseTypeParameters(this.tsParseInOutConstModifiers);a&&(t.typeParameters=a)}parseClassPropertyAnnotation(t){t.optional||(this.eat(35)?t.definite=!0:this.eat(17)&&(t.optional=!0));const n=this.tsTryParseTypeAnnotation();n&&(t.typeAnnotation=n)}parseClassProperty(t){if(this.parseClassPropertyAnnotation(t),this.state.isAmbientContext&&!(t.readonly&&!t.typeAnnotation)&&this.match(29)&&this.raise(gr.DeclareClassFieldHasInitializer,this.state.startLoc),t.abstract&&this.match(29)){const{key:n}=t;this.raise(gr.AbstractPropertyHasInitializer,this.state.startLoc,{propertyName:n.type==="Identifier"&&!t.computed?n.name:`[${this.input.slice(this.offsetToSourcePos(n.start),this.offsetToSourcePos(n.end))}]`})}return super.parseClassProperty(t)}parseClassPrivateProperty(t){return t.abstract&&this.raise(gr.PrivateElementHasAbstract,t),t.accessibility&&this.raise(gr.PrivateElementHasAccessibility,t,{modifier:t.accessibility}),this.parseClassPropertyAnnotation(t),super.parseClassPrivateProperty(t)}parseClassAccessorProperty(t){return this.parseClassPropertyAnnotation(t),t.optional&&this.raise(gr.AccessorCannotBeOptional,t),super.parseClassAccessorProperty(t)}pushClassMethod(t,n,i,s,a,o){const u=this.tsTryParseTypeParameters(this.tsParseConstModifier);u&&a&&this.raise(gr.ConstructorHasTypeParameters,u);const{declare:f=!1,kind:g}=n;f&&(g==="get"||g==="set")&&this.raise(gr.DeclareAccessor,n,{kind:g}),u&&(n.typeParameters=u),super.pushClassMethod(t,n,i,s,a,o)}pushClassPrivateMethod(t,n,i,s){const a=this.tsTryParseTypeParameters(this.tsParseConstModifier);a&&(n.typeParameters=a),super.pushClassPrivateMethod(t,n,i,s)}declareClassPrivateMethodInScope(t,n){t.type!=="TSDeclareMethod"&&(t.type==="MethodDefinition"&&t.value.body==null||super.declareClassPrivateMethodInScope(t,n))}parseClassSuper(t){super.parseClassSuper(t),t.superClass&&(this.match(47)||this.match(51))&&(t.superTypeParameters=this.tsParseTypeArgumentsInExpression()),this.eatContextual(113)&&(t.implements=this.tsParseHeritageClause("implements"))}parseObjPropValue(t,n,i,s,a,o,u){const f=this.tsTryParseTypeParameters(this.tsParseConstModifier);return f&&(t.typeParameters=f),super.parseObjPropValue(t,n,i,s,a,o,u)}parseFunctionParams(t,n){const i=this.tsTryParseTypeParameters(this.tsParseConstModifier);i&&(t.typeParameters=i),super.parseFunctionParams(t,n)}parseVarId(t,n){super.parseVarId(t,n),t.id.type==="Identifier"&&!this.hasPrecedingLineBreak()&&this.eat(35)&&(t.definite=!0);const i=this.tsTryParseTypeAnnotation();i&&(t.id.typeAnnotation=i,this.resetEndLocation(t.id))}parseAsyncArrowFromCallExpression(t,n){return this.match(14)&&(t.returnType=this.tsParseTypeAnnotation()),super.parseAsyncArrowFromCallExpression(t,n)}parseMaybeAssign(t,n){var i,s,a,o,u;let f,g,y;if(this.hasPlugin("jsx")&&(this.match(143)||this.match(47))){if(f=this.state.clone(),g=this.tryParse(()=>super.parseMaybeAssign(t,n),f),!g.error)return g.node;const{context:M}=this.state,k=M[M.length-1];(k===Sn.j_oTag||k===Sn.j_expr)&&M.pop()}if(!((i=g)!=null&&i.error)&&!this.match(47))return super.parseMaybeAssign(t,n);(!f||f===this.state)&&(f=this.state.clone());let A;const C=this.tryParse(M=>{var k,D;A=this.tsParseTypeParameters(this.tsParseConstModifier);const V=super.parseMaybeAssign(t,n);return(V.type!=="ArrowFunctionExpression"||(k=V.extra)!=null&&k.parenthesized)&&M(),((D=A)==null?void 0:D.params.length)!==0&&this.resetStartLocationFromNode(V,A),V.typeParameters=A,V},f);if(!C.error&&!C.aborted)return A&&this.reportReservedArrowTypeParam(A),C.node;if(!g&&(c4(!this.hasPlugin("jsx")),y=this.tryParse(()=>super.parseMaybeAssign(t,n),f),!y.error))return y.node;if((s=g)!=null&&s.node)return this.state=g.failState,g.node;if(C.node)return this.state=C.failState,A&&this.reportReservedArrowTypeParam(A),C.node;if((a=y)!=null&&a.node)return this.state=y.failState,y.node;throw((o=g)==null?void 0:o.error)||C.error||((u=y)==null?void 0:u.error)}reportReservedArrowTypeParam(t){var n;t.params.length===1&&!t.params[0].constraint&&!((n=t.extra)!=null&&n.trailingComma)&&this.getPluginOption("typescript","disallowAmbiguousJSXLike")&&this.raise(gr.ReservedArrowTypeParam,t)}parseMaybeUnary(t,n){return!this.hasPlugin("jsx")&&this.match(47)?this.tsParseTypeAssertion():super.parseMaybeUnary(t,n)}parseArrow(t){if(this.match(14)){const n=this.tryParse(i=>{const s=this.tsParseTypeOrTypePredicateAnnotation(14);return(this.canInsertSemicolon()||!this.match(19))&&i(),s});if(n.aborted)return;n.thrown||(n.error&&(this.state=n.failState),t.returnType=n.node)}return super.parseArrow(t)}parseFunctionParamType(t){this.eat(17)&&(t.optional=!0);const n=this.tsTryParseTypeAnnotation();return n&&(t.typeAnnotation=n),this.resetEndLocation(t),t}isAssignable(t,n){switch(t.type){case"TSTypeCastExpression":return this.isAssignable(t.expression,n);case"TSParameterProperty":return!0;default:return super.isAssignable(t,n)}}toAssignable(t,n=!1){switch(t.type){case"ParenthesizedExpression":this.toAssignableParenthesizedExpression(t,n);break;case"TSAsExpression":case"TSSatisfiesExpression":case"TSNonNullExpression":case"TSTypeAssertion":n?this.expressionScope.recordArrowParameterBindingError(gr.UnexpectedTypeCastInParameter,t):this.raise(gr.UnexpectedTypeCastInParameter,t),this.toAssignable(t.expression,n);break;case"AssignmentExpression":!n&&t.left.type==="TSTypeCastExpression"&&(t.left=this.typeCastToParameter(t.left));default:super.toAssignable(t,n)}}toAssignableParenthesizedExpression(t,n){switch(t.expression.type){case"TSAsExpression":case"TSSatisfiesExpression":case"TSNonNullExpression":case"TSTypeAssertion":case"ParenthesizedExpression":this.toAssignable(t.expression,n);break;default:super.toAssignable(t,n)}}checkToRestConversion(t,n){switch(t.type){case"TSAsExpression":case"TSSatisfiesExpression":case"TSTypeAssertion":case"TSNonNullExpression":this.checkToRestConversion(t.expression,!1);break;default:super.checkToRestConversion(t,n)}}isValidLVal(t,n,i,s){switch(t){case"TSTypeCastExpression":return!0;case"TSParameterProperty":return"parameter";case"TSNonNullExpression":return"expression";case"TSAsExpression":case"TSSatisfiesExpression":case"TSTypeAssertion":return(s!==64||!i)&&["expression",!0];default:return super.isValidLVal(t,n,i,s)}}parseBindingAtom(){return this.state.type===78?this.parseIdentifier(!0):super.parseBindingAtom()}parseMaybeDecoratorArguments(t,n){if(this.match(47)||this.match(51)){const i=this.tsParseTypeArgumentsInExpression();if(this.match(10)){const s=super.parseMaybeDecoratorArguments(t,n);return s.typeParameters=i,s}this.unexpected(null,10)}return super.parseMaybeDecoratorArguments(t,n)}checkCommaAfterRest(t){return this.state.isAmbientContext&&this.match(12)&&this.lookaheadCharCode()===t?(this.next(),!1):super.checkCommaAfterRest(t)}isClassMethod(){return this.match(47)||super.isClassMethod()}isClassProperty(){return this.match(35)||this.match(14)||super.isClassProperty()}parseMaybeDefault(t,n){const i=super.parseMaybeDefault(t,n);return i.type==="AssignmentPattern"&&i.typeAnnotation&&i.right.start<i.typeAnnotation.start&&this.raise(gr.TypeAnnotationAfterAssign,i.typeAnnotation),i}getTokenFromCode(t){if(this.state.inType){if(t===62){this.finishOp(48,1);return}if(t===60){this.finishOp(47,1);return}}super.getTokenFromCode(t)}reScan_lt_gt(){const{type:t}=this.state;t===47?(this.state.pos-=1,this.readToken_lt()):t===48&&(this.state.pos-=1,this.readToken_gt())}reScan_lt(){const{type:t}=this.state;return t===51?(this.state.pos-=2,this.finishOp(47,1),47):t}toAssignableListItem(t,n,i){const s=t[n];s.type==="TSTypeCastExpression"&&(t[n]=this.typeCastToParameter(s)),super.toAssignableListItem(t,n,i)}typeCastToParameter(t){return t.expression.typeAnnotation=t.typeAnnotation,this.resetEndLocation(t.expression,t.typeAnnotation.loc.end),t.expression}shouldParseArrow(t){return this.match(14)?t.every(n=>this.isAssignable(n,!0)):super.shouldParseArrow(t)}shouldParseAsyncArrow(){return this.match(14)||super.shouldParseAsyncArrow()}canHaveLeadingDecorator(){return super.canHaveLeadingDecorator()||this.isAbstractClass()}jsxParseOpeningElementAfterName(t){if(this.match(47)||this.match(51)){const n=this.tsTryParseAndCatch(()=>this.tsParseTypeArgumentsInExpression());n&&(t.typeParameters=n)}return super.jsxParseOpeningElementAfterName(t)}getGetterSetterExpectedParamCount(t){const n=super.getGetterSetterExpectedParamCount(t),s=this.getObjectOrClassMethodParams(t)[0];return s&&this.isThisParam(s)?n+1:n}parseCatchClauseParam(){const t=super.parseCatchClauseParam(),n=this.tsTryParseTypeAnnotation();return n&&(t.typeAnnotation=n,this.resetEndLocation(t)),t}tsInAmbientContext(t){const{isAmbientContext:n,strict:i}=this.state;this.state.isAmbientContext=!0,this.state.strict=!1;try{return t()}finally{this.state.isAmbientContext=n,this.state.strict=i}}parseClass(t,n,i){const s=this.state.inAbstractClass;this.state.inAbstractClass=!!t.abstract;try{return super.parseClass(t,n,i)}finally{this.state.inAbstractClass=s}}tsParseAbstractDeclaration(t,n){if(this.match(80))return t.abstract=!0,this.maybeTakeDecorators(n,this.parseClass(t,!0,!1));if(this.isContextual(129))return this.hasFollowingLineBreak()?null:(t.abstract=!0,this.raise(gr.NonClassMethodPropertyHasAbstractModifier,t),this.tsParseInterfaceDeclaration(t));throw this.unexpected(null,80)}parseMethod(t,n,i,s,a,o,u){const f=super.parseMethod(t,n,i,s,a,o,u);if((f.abstract||f.type==="TSAbstractMethodDefinition")&&(this.hasPlugin("estree")?f.value:f).body){const{key:A}=f;this.raise(gr.AbstractMethodHasImplementation,f,{methodName:A.type==="Identifier"&&!f.computed?A.name:`[${this.input.slice(this.offsetToSourcePos(A.start),this.offsetToSourcePos(A.end))}]`})}return f}tsParseTypeParameterName(){return this.parseIdentifier().name}shouldParseAsAmbientContext(){return!!this.getPluginOption("typescript","dts")}parse(){return this.shouldParseAsAmbientContext()&&(this.state.isAmbientContext=!0),super.parse()}getExpression(){return this.shouldParseAsAmbientContext()&&(this.state.isAmbientContext=!0),super.getExpression()}parseExportSpecifier(t,n,i,s){return!n&&s?(this.parseTypeOnlyImportExportSpecifier(t,!1,i),this.finishNode(t,"ExportSpecifier")):(t.exportKind="value",super.parseExportSpecifier(t,n,i,s))}parseImportSpecifier(t,n,i,s,a){return!n&&s?(this.parseTypeOnlyImportExportSpecifier(t,!0,i),this.finishNode(t,"ImportSpecifier")):(t.importKind="value",super.parseImportSpecifier(t,n,i,s,i?4098:4096))}parseTypeOnlyImportExportSpecifier(t,n,i){const s=n?"imported":"local",a=n?"local":"exported";let o=t[s],u,f=!1,g=!0;const y=o.loc.start;if(this.isContextual(93)){const C=this.parseIdentifier();if(this.isContextual(93)){const M=this.parseIdentifier();Wl(this.state.type)?(f=!0,o=C,u=n?this.parseIdentifier():this.parseModuleExportName(),g=!1):(u=M,g=!1)}else Wl(this.state.type)?(g=!1,u=n?this.parseIdentifier():this.parseModuleExportName()):(f=!0,o=C)}else Wl(this.state.type)&&(f=!0,n?(o=this.parseIdentifier(!0),this.isContextual(93)||this.checkReservedWord(o.name,o.loc.start,!0,!0)):o=this.parseModuleExportName());f&&i&&this.raise(n?gr.TypeModifierIsUsedInTypeImports:gr.TypeModifierIsUsedInTypeExports,y),t[s]=o,t[a]=u;const A=n?"importKind":"exportKind";t[A]=f?"type":"value",g&&this.eatContextual(93)&&(t[a]=n?this.parseIdentifier():this.parseModuleExportName()),t[a]||(t[a]=this.cloneIdentifier(t[s])),n&&this.checkIdentifier(t[a],f?4098:4096)}fillOptionalPropertiesForTSESLint(t){var n,i,s,a,o,u,f,g,y,A,C,M,k,D,V,W,z,$,te,le,_e,se,Y,ce,oe,Me,ze,Ve,lt,gt,At,Tt,Ut,xr,Er,Jr,Xn,mi,Pn,Bn,Jn,Mn,_t,kt,nr,fr,ve,Ee;switch(t.type){case"ExpressionStatement":(n=t.directive)!=null||(t.directive=void 0);return;case"RestElement":t.value=void 0;case"Identifier":case"ArrayPattern":case"AssignmentPattern":case"ObjectPattern":(i=t.decorators)!=null||(t.decorators=[]),(s=t.optional)!=null||(t.optional=!1),(a=t.typeAnnotation)!=null||(t.typeAnnotation=void 0);return;case"TSParameterProperty":(o=t.accessibility)!=null||(t.accessibility=void 0),(u=t.decorators)!=null||(t.decorators=[]),(f=t.override)!=null||(t.override=!1),(g=t.readonly)!=null||(t.readonly=!1),(y=t.static)!=null||(t.static=!1);return;case"TSEmptyBodyFunctionExpression":t.body=null;case"TSDeclareFunction":case"FunctionDeclaration":case"FunctionExpression":case"ClassMethod":case"ClassPrivateMethod":(A=t.declare)!=null||(t.declare=!1),(C=t.returnType)!=null||(t.returnType=void 0),(M=t.typeParameters)!=null||(t.typeParameters=void 0);return;case"Property":(k=t.optional)!=null||(t.optional=!1);return;case"TSMethodSignature":case"TSPropertySignature":(D=t.optional)!=null||(t.optional=!1);case"TSIndexSignature":(V=t.accessibility)!=null||(t.accessibility=void 0),(W=t.readonly)!=null||(t.readonly=!1),(z=t.static)!=null||(t.static=!1);return;case"TSAbstractPropertyDefinition":case"PropertyDefinition":case"TSAbstractAccessorProperty":case"AccessorProperty":($=t.declare)!=null||(t.declare=!1),(te=t.definite)!=null||(t.definite=!1),(le=t.readonly)!=null||(t.readonly=!1),(_e=t.typeAnnotation)!=null||(t.typeAnnotation=void 0);case"TSAbstractMethodDefinition":case"MethodDefinition":(se=t.accessibility)!=null||(t.accessibility=void 0),(Y=t.decorators)!=null||(t.decorators=[]),(ce=t.override)!=null||(t.override=!1),(oe=t.optional)!=null||(t.optional=!1);return;case"ClassExpression":(Me=t.id)!=null||(t.id=null);case"ClassDeclaration":(ze=t.abstract)!=null||(t.abstract=!1),(Ve=t.declare)!=null||(t.declare=!1),(lt=t.decorators)!=null||(t.decorators=[]),(gt=t.implements)!=null||(t.implements=[]),(At=t.superTypeArguments)!=null||(t.superTypeArguments=void 0),(Tt=t.typeParameters)!=null||(t.typeParameters=void 0);return;case"TSTypeAliasDeclaration":case"VariableDeclaration":(Ut=t.declare)!=null||(t.declare=!1);return;case"VariableDeclarator":(xr=t.definite)!=null||(t.definite=!1);return;case"TSEnumDeclaration":(Er=t.const)!=null||(t.const=!1),(Jr=t.declare)!=null||(t.declare=!1);return;case"TSEnumMember":(Xn=t.computed)!=null||(t.computed=!1);return;case"TSImportType":(mi=t.qualifier)!=null||(t.qualifier=null),(Pn=t.options)!=null||(t.options=null);return;case"TSInterfaceDeclaration":(Bn=t.declare)!=null||(t.declare=!1),(Jn=t.extends)!=null||(t.extends=[]);return;case"TSMappedType":(Mn=t.optional)!=null||(t.optional=!1),(_t=t.readonly)!=null||(t.readonly=void 0);return;case"TSModuleDeclaration":(kt=t.declare)!=null||(t.declare=!1),(nr=t.global)!=null||(t.global=t.kind==="global");return;case"TSTypeParameter":(fr=t.const)!=null||(t.const=!1),(ve=t.in)!=null||(t.in=!1),(Ee=t.out)!=null||(t.out=!1);return}}chStartsBindingIdentifierAndNotRelationalOperator(t,n){if(Dc(t)){if(tI.lastIndex=n,tI.test(this.input)){const i=this.codePointAtPos(tI.lastIndex);if(!Hf(i)&&i!==92)return!1}return!0}else return t===92}nextTokenIsIdentifierAndNotTSRelationalOperatorOnSameLine(){const t=this.nextTokenInLineStart(),n=this.codePointAtPos(t);return this.chStartsBindingIdentifierAndNotRelationalOperator(n,t)}nextTokenIsIdentifierOrStringLiteralOnSameLine(){const t=this.nextTokenInLineStart(),n=this.codePointAtPos(t);return this.chStartsBindingIdentifier(n,t)||n===34||n===39}};function Sae(r){if(r.type!=="MemberExpression")return!1;const{computed:e,property:t}=r;return e&&t.type!=="StringLiteral"&&(t.type!=="TemplateLiteral"||t.expressions.length>0)?!1:k7(r.object)}function Eae(r,e){var t;const{type:n}=r;if((t=r.extra)!=null&&t.parenthesized)return!1;if(e){if(n==="Literal"){const{value:i}=r;if(typeof i=="string"||typeof i=="boolean")return!0}}else if(n==="StringLiteral"||n==="BooleanLiteral")return!0;return!!(R7(r,e)||Iae(r,e)||n==="TemplateLiteral"&&r.expressions.length===0||Sae(r))}function R7(r,e){return e?r.type==="Literal"&&(typeof r.value=="number"||"bigint"in r):r.type==="NumericLiteral"||r.type==="BigIntLiteral"}function Iae(r,e){if(r.type==="UnaryExpression"){const{operator:t,argument:n}=r;if(t==="-"&&R7(n,e))return!0}return!1}function k7(r){return r.type==="Identifier"?!0:r.type!=="MemberExpression"||r.computed?!1:k7(r.object)}const h4=Oc`placeholders`({ClassNameIsRequired:"A class name is required.",UnexpectedSpace:"Unexpected space in placeholder."});var Pae=r=>class extends r{parsePlaceholder(t){if(this.match(133)){const n=this.startNode();return this.next(),this.assertNoSpace(),n.name=super.parseIdentifier(!0),this.assertNoSpace(),this.expect(133),this.finishPlaceholder(n,t)}}finishPlaceholder(t,n){let i=t;return(!i.expectedNode||!i.type)&&(i=this.finishNode(i,"Placeholder")),i.expectedNode=n,i}getTokenFromCode(t){t===37&&this.input.charCodeAt(this.state.pos+1)===37?this.finishOp(133,2):super.getTokenFromCode(t)}parseExprAtom(t){return this.parsePlaceholder("Expression")||super.parseExprAtom(t)}parseIdentifier(t){return this.parsePlaceholder("Identifier")||super.parseIdentifier(t)}checkReservedWord(t,n,i,s){t!==void 0&&super.checkReservedWord(t,n,i,s)}cloneIdentifier(t){const n=super.cloneIdentifier(t);return n.type==="Placeholder"&&(n.expectedNode=t.expectedNode),n}cloneStringLiteral(t){return t.type==="Placeholder"?this.cloneIdentifier(t):super.cloneStringLiteral(t)}parseBindingAtom(){return this.parsePlaceholder("Pattern")||super.parseBindingAtom()}isValidLVal(t,n,i,s){return t==="Placeholder"||super.isValidLVal(t,n,i,s)}toAssignable(t,n){t&&t.type==="Placeholder"&&t.expectedNode==="Expression"?t.expectedNode="Pattern":super.toAssignable(t,n)}chStartsBindingIdentifier(t,n){if(super.chStartsBindingIdentifier(t,n))return!0;const i=this.nextTokenStart();return this.input.charCodeAt(i)===37&&this.input.charCodeAt(i+1)===37}verifyBreakContinue(t,n){t.label&&t.label.type==="Placeholder"||super.verifyBreakContinue(t,n)}parseExpressionStatement(t,n){var i;if(n.type!=="Placeholder"||(i=n.extra)!=null&&i.parenthesized)return super.parseExpressionStatement(t,n);if(this.match(14)){const a=t;return a.label=this.finishPlaceholder(n,"Identifier"),this.next(),a.body=super.parseStatementOrSloppyAnnexBFunctionDeclaration(),this.finishNode(a,"LabeledStatement")}this.semicolon();const s=t;return s.name=n.name,this.finishPlaceholder(s,"Statement")}parseBlock(t,n,i){return this.parsePlaceholder("BlockStatement")||super.parseBlock(t,n,i)}parseFunctionId(t){return this.parsePlaceholder("Identifier")||super.parseFunctionId(t)}parseClass(t,n,i){const s=n?"ClassDeclaration":"ClassExpression";this.next();const a=this.state.strict,o=this.parsePlaceholder("Identifier");if(o)if(this.match(81)||this.match(133)||this.match(5))t.id=o;else{if(i||!n)return t.id=null,t.body=this.finishPlaceholder(o,"ClassBody"),this.finishNode(t,s);throw this.raise(h4.ClassNameIsRequired,this.state.startLoc)}else this.parseClassId(t,n,i);return super.parseClassSuper(t),t.body=this.parsePlaceholder("ClassBody")||super.parseClassBody(!!t.superClass,a),this.finishNode(t,s)}parseExport(t,n){const i=this.parsePlaceholder("Identifier");if(!i)return super.parseExport(t,n);const s=t;if(!this.isContextual(98)&&!this.match(12))return s.specifiers=[],s.source=null,s.declaration=this.finishPlaceholder(i,"Declaration"),this.finishNode(s,"ExportNamedDeclaration");this.expectPlugin("exportDefaultFrom");const a=this.startNode();return a.exported=i,s.specifiers=[this.finishNode(a,"ExportDefaultSpecifier")],super.parseExport(s,n)}isExportDefaultSpecifier(){if(this.match(65)){const t=this.nextTokenStart();if(this.isUnparsedContextual(t,"from")&&this.input.startsWith(gd(133),this.nextTokenStartSince(t+4)))return!0}return super.isExportDefaultSpecifier()}maybeParseExportDefaultSpecifier(t,n){var i;return(i=t.specifiers)!=null&&i.length?!0:super.maybeParseExportDefaultSpecifier(t,n)}checkExport(t){const{specifiers:n}=t;n!=null&&n.length&&(t.specifiers=n.filter(i=>i.exported.type==="Placeholder")),super.checkExport(t),t.specifiers=n}parseImport(t){const n=this.parsePlaceholder("Identifier");if(!n)return super.parseImport(t);if(t.specifiers=[],!this.isContextual(98)&&!this.match(12))return t.source=this.finishPlaceholder(n,"StringLiteral"),this.semicolon(),this.finishNode(t,"ImportDeclaration");const i=this.startNodeAtNode(n);return i.local=n,t.specifiers.push(this.finishNode(i,"ImportDefaultSpecifier")),this.eat(12)&&(this.maybeParseStarImportSpecifier(t)||this.parseNamedImportSpecifiers(t)),this.expectContextual(98),t.source=this.parseImportSource(),this.semicolon(),this.finishNode(t,"ImportDeclaration")}parseImportSource(){return this.parsePlaceholder("StringLiteral")||super.parseImportSource()}assertNoSpace(){this.state.start>this.offsetToSourcePos(this.state.lastTokEndLoc.index)&&this.raise(h4.UnexpectedSpace,this.state.lastTokEndLoc)}},Bae=r=>class extends r{parseV8Intrinsic(){if(this.match(54)){const t=this.state.startLoc,n=this.startNode();if(this.next(),Dn(this.state.type)){const i=this.parseIdentifierName(),s=this.createIdentifier(n,i);if(this.castNodeTo(s,"V8IntrinsicIdentifier"),this.match(10))return s}this.unexpected(t)}}parseExprAtom(t){return this.parseV8Intrinsic()||super.parseExprAtom(t)}};const d4=["minimal","fsharp","hack","smart"],f4=["^^","@@","^","%","#"];function Mae(r){if(r.has("decorators")){if(r.has("decorators-legacy"))throw new Error("Cannot use the decorators and decorators-legacy plugin together");const n=r.get("decorators").decoratorsBeforeExport;if(n!=null&&typeof n!="boolean")throw new Error("'decoratorsBeforeExport' must be a boolean, if specified.");const i=r.get("decorators").allowCallParenthesized;if(i!=null&&typeof i!="boolean")throw new Error("'allowCallParenthesized' must be a boolean.")}if(r.has("flow")&&r.has("typescript"))throw new Error("Cannot combine flow and typescript plugins.");if(r.has("placeholders")&&r.has("v8intrinsic"))throw new Error("Cannot combine placeholders and v8intrinsic plugins.");if(r.has("pipelineOperator")){var e;const n=r.get("pipelineOperator").proposal;if(!d4.includes(n)){const i=d4.map(s=>`"${s}"`).join(", ");throw new Error(`"pipelineOperator" requires "proposal" option whose value must be one of: ${i}.`)}if(n==="hack"){if(r.has("placeholders"))throw new Error("Cannot combine placeholders plugin and Hack-style pipes.");if(r.has("v8intrinsic"))throw new Error("Cannot combine v8intrinsic plugin and Hack-style pipes.");const i=r.get("pipelineOperator").topicToken;if(!f4.includes(i)){const s=f4.map(a=>`"${a}"`).join(", ");throw new Error(`"pipelineOperator" in "proposal": "hack" mode also requires a "topicToken" option whose value must be one of: ${s}.`)}{var t;if(i==="#"&&((t=r.get("recordAndTuple"))==null?void 0:t.syntaxType)==="hash")throw new Error(`Plugin conflict between \`["pipelineOperator", { proposal: "hack", topicToken: "#" }]\` and \`${JSON.stringify(["recordAndTuple",r.get("recordAndTuple")])}\`.`)}}else if(n==="smart"&&((e=r.get("recordAndTuple"))==null?void 0:e.syntaxType)==="hash")throw new Error(`Plugin conflict between \`["pipelineOperator", { proposal: "smart" }]\` and \`${JSON.stringify(["recordAndTuple",r.get("recordAndTuple")])}\`.`)}if(r.has("moduleAttributes")){if(r.has("deprecatedImportAssert")||r.has("importAssertions"))throw new Error("Cannot combine importAssertions, deprecatedImportAssert and moduleAttributes plugins.");if(r.get("moduleAttributes").version!=="may-2020")throw new Error("The 'moduleAttributes' plugin requires a 'version' option, representing the last proposal update. Currently, the only supported value is 'may-2020'.")}if(r.has("importAssertions")&&r.has("deprecatedImportAssert"))throw new Error("Cannot combine importAssertions and deprecatedImportAssert plugins.");if(!r.has("deprecatedImportAssert")&&r.has("importAttributes")&&r.get("importAttributes").deprecatedAssertSyntax&&r.set("deprecatedImportAssert",{}),r.has("recordAndTuple")){const n=r.get("recordAndTuple").syntaxType;if(n!=null){const i=["hash","bar"];if(!i.includes(n))throw new Error("The 'syntaxType' option of the 'recordAndTuple' plugin must be one of: "+i.map(s=>`'${s}'`).join(", "))}}if(r.has("asyncDoExpressions")&&!r.has("doExpressions")){const n=new Error("'asyncDoExpressions' requires 'doExpressions', please add 'doExpressions' to parser plugins.");throw n.missingPlugins="doExpressions",n}if(r.has("optionalChainingAssign")&&r.get("optionalChainingAssign").version!=="2023-07")throw new Error("The 'optionalChainingAssign' plugin requires a 'version' option, representing the last proposal update. Currently, the only supported value is '2023-07'.");if(r.has("discardBinding")&&r.get("discardBinding").syntaxType!=="void")throw new Error("The 'discardBinding' plugin requires a 'syntaxType' option. Currently the only supported value is 'void'.")}const O7={estree:Aoe,jsx:tae,flow:Yoe,typescript:Tae,v8intrinsic:Bae,placeholders:Pae},Rae=Object.keys(O7);class kae extends Aae{checkProto(e,t,n,i){if(e.type==="SpreadElement"||this.isObjectMethod(e)||e.computed||e.shorthand)return n;const s=e.key;return(s.type==="Identifier"?s.name:s.value)==="__proto__"?t?(this.raise(Ne.RecordNoProto,s),!0):(n&&(i?i.doubleProtoLoc===null&&(i.doubleProtoLoc=s.loc.start):this.raise(Ne.DuplicateProto,s)),!0):n}shouldExitDescending(e,t){return e.type==="ArrowFunctionExpression"&&this.offsetToSourcePos(e.start)===t}getExpression(){if(this.enterInitialScopes(),this.nextToken(),this.match(140))throw this.raise(Ne.ParseExpressionEmptyInput,this.state.startLoc);const e=this.parseExpression();if(!this.match(140))throw this.raise(Ne.ParseExpressionExpectsEOF,this.state.startLoc,{unexpected:this.input.codePointAt(this.state.start)});return this.finalizeRemainingComments(),e.comments=this.comments,e.errors=this.state.errors,this.optionFlags&256&&(e.tokens=this.tokens),e}parseExpression(e,t){return e?this.disallowInAnd(()=>this.parseExpressionBase(t)):this.allowInAnd(()=>this.parseExpressionBase(t))}parseExpressionBase(e){const t=this.state.startLoc,n=this.parseMaybeAssign(e);if(this.match(12)){const i=this.startNodeAt(t);for(i.expressions=[n];this.eat(12);)i.expressions.push(this.parseMaybeAssign(e));return this.toReferencedList(i.expressions),this.finishNode(i,"SequenceExpression")}return n}parseMaybeAssignDisallowIn(e,t){return this.disallowInAnd(()=>this.parseMaybeAssign(e,t))}parseMaybeAssignAllowIn(e,t){return this.allowInAnd(()=>this.parseMaybeAssign(e,t))}setOptionalParametersError(e){e.optionalParametersLoc=this.state.startLoc}parseMaybeAssign(e,t){const n=this.state.startLoc,i=this.isContextual(108);if(i&&this.prodParam.hasYield){this.next();let u=this.parseYield(n);return t&&(u=t.call(this,u,n)),u}let s;e?s=!1:(e=new cw,s=!0);const{type:a}=this.state;(a===10||Dn(a))&&(this.state.potentialArrowAt=this.state.start);let o=this.parseMaybeConditional(e);if(t&&(o=t.call(this,o,n)),Soe(this.state.type)){const u=this.startNodeAt(n),f=this.state.value;if(u.operator=f,this.match(29)){this.toAssignable(o,!0),u.left=o;const g=n.index;e.doubleProtoLoc!=null&&e.doubleProtoLoc.index>=g&&(e.doubleProtoLoc=null),e.shorthandAssignLoc!=null&&e.shorthandAssignLoc.index>=g&&(e.shorthandAssignLoc=null),e.privateKeyLoc!=null&&e.privateKeyLoc.index>=g&&(this.checkDestructuringPrivate(e),e.privateKeyLoc=null),e.voidPatternLoc!=null&&e.voidPatternLoc.index>=g&&(e.voidPatternLoc=null)}else u.left=o;return this.next(),u.right=this.parseMaybeAssign(),this.checkLVal(o,this.finishNode(u,"AssignmentExpression"),void 0,void 0,void 0,void 0,f==="||="||f==="&&="||f==="??="),u}else s&&this.checkExpressionErrors(e,!0);if(i){const{type:u}=this.state;if((this.hasPlugin("v8intrinsic")?v0(u):v0(u)&&!this.match(54))&&!this.isAmbiguousPrefixOrIdentifier())return this.raiseOverwrite(Ne.YieldNotInGeneratorFunction,n),this.parseYield(n)}return o}parseMaybeConditional(e){const t=this.state.startLoc,n=this.state.potentialArrowAt,i=this.parseExprOps(e);return this.shouldExitDescending(i,n)?i:this.parseConditional(i,t,e)}parseConditional(e,t,n){if(this.eat(17)){const i=this.startNodeAt(t);return i.test=e,i.consequent=this.parseMaybeAssignAllowIn(),this.expect(14),i.alternate=this.parseMaybeAssign(),this.finishNode(i,"ConditionalExpression")}return e}parseMaybeUnaryOrPrivate(e){return this.match(139)?this.parsePrivateName():this.parseMaybeUnary(e)}parseExprOps(e){const t=this.state.startLoc,n=this.state.potentialArrowAt,i=this.parseMaybeUnaryOrPrivate(e);return this.shouldExitDescending(i,n)?i:this.parseExprOp(i,t,-1)}parseExprOp(e,t,n){if(this.isPrivateName(e)){const s=this.getPrivateNameSV(e);(n>=aw(58)||!this.prodParam.hasIn||!this.match(58))&&this.raise(Ne.PrivateInExpectedIn,e,{identifierName:s}),this.classScope.usePrivateName(s,e.loc.start)}const i=this.state.type;if(Ioe(i)&&(this.prodParam.hasIn||!this.match(58))){let s=aw(i);if(s>n){if(i===39){if(this.expectPlugin("pipelineOperator"),this.state.inFSharpPipelineDirectBody)return e;this.checkPipelineAtInfixOperator(e,t)}const a=this.startNodeAt(t);a.left=e,a.operator=this.state.value;const o=i===41||i===42,u=i===40;if(u&&(s=aw(42)),this.next(),i===39&&this.hasPlugin(["pipelineOperator",{proposal:"minimal"}])&&this.state.type===96&&this.prodParam.hasAwait)throw this.raise(Ne.UnexpectedAwaitAfterPipelineBody,this.state.startLoc);a.right=this.parseExprOpRightExpr(i,s);const f=this.finishNode(a,o||u?"LogicalExpression":"BinaryExpression"),g=this.state.type;if(u&&(g===41||g===42)||o&&g===40)throw this.raise(Ne.MixingCoalesceWithLogical,this.state.startLoc);return this.parseExprOp(f,t,n)}}return e}parseExprOpRightExpr(e,t){const n=this.state.startLoc;switch(e){case 39:switch(this.getPluginOption("pipelineOperator","proposal")){case"hack":return this.withTopicBindingContext(()=>this.parseHackPipeBody());case"fsharp":return this.withSoloAwaitPermittingContext(()=>this.parseFSharpPipelineBody(t))}if(this.getPluginOption("pipelineOperator","proposal")==="smart")return this.withTopicBindingContext(()=>{if(this.prodParam.hasYield&&this.isContextual(108))throw this.raise(Ne.PipeBodyIsTighter,this.state.startLoc);return this.parseSmartPipelineBodyInStyle(this.parseExprOpBaseRightExpr(e,t),n)});default:return this.parseExprOpBaseRightExpr(e,t)}}parseExprOpBaseRightExpr(e,t){const n=this.state.startLoc;return this.parseExprOp(this.parseMaybeUnaryOrPrivate(),n,koe(e)?t-1:t)}parseHackPipeBody(){var e;const{startLoc:t}=this.state,n=this.parseMaybeAssign();return poe.has(n.type)&&!((e=n.extra)!=null&&e.parenthesized)&&this.raise(Ne.PipeUnparenthesizedBody,t,{type:n.type}),this.topicReferenceWasUsedInCurrentContext()||this.raise(Ne.PipeTopicUnused,t),n}checkExponentialAfterUnary(e){this.match(57)&&this.raise(Ne.UnexpectedTokenUnaryExponentiation,e.argument)}parseMaybeUnary(e,t){const n=this.state.startLoc,i=this.isContextual(96);if(i&&this.recordAwaitIfAllowed()){this.next();const u=this.parseAwait(n);return t||this.checkExponentialAfterUnary(u),u}const s=this.match(34),a=this.startNode();if(Boe(this.state.type)){a.operator=this.state.value,a.prefix=!0,this.match(72)&&this.expectPlugin("throwExpressions");const u=this.match(89);if(this.next(),a.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(e,!0),this.state.strict&&u){const f=a.argument;f.type==="Identifier"?this.raise(Ne.StrictDelete,a):this.hasPropertyAsPrivateName(f)&&this.raise(Ne.DeletePrivateField,a)}if(!s)return t||this.checkExponentialAfterUnary(a),this.finishNode(a,"UnaryExpression")}const o=this.parseUpdate(a,s,e);if(i){const{type:u}=this.state;if((this.hasPlugin("v8intrinsic")?v0(u):v0(u)&&!this.match(54))&&!this.isAmbiguousPrefixOrIdentifier())return this.raiseOverwrite(Ne.AwaitNotInAsyncContext,n),this.parseAwait(n)}return o}parseUpdate(e,t,n){if(t){const a=e;return this.checkLVal(a.argument,this.finishNode(a,"UpdateExpression")),e}const i=this.state.startLoc;let s=this.parseExprSubscripts(n);if(this.checkExpressionErrors(n,!1))return s;for(;Poe(this.state.type)&&!this.canInsertSemicolon();){const a=this.startNodeAt(i);a.operator=this.state.value,a.prefix=!1,a.argument=s,this.next(),this.checkLVal(s,s=this.finishNode(a,"UpdateExpression"))}return s}parseExprSubscripts(e){const t=this.state.startLoc,n=this.state.potentialArrowAt,i=this.parseExprAtom(e);return this.shouldExitDescending(i,n)?i:this.parseSubscripts(i,t)}parseSubscripts(e,t,n){const i={optionalChainMember:!1,maybeAsyncArrow:this.atPossibleAsyncArrow(e),stop:!1};do e=this.parseSubscript(e,t,n,i),i.maybeAsyncArrow=!1;while(!i.stop);return e}parseSubscript(e,t,n,i){const{type:s}=this.state;if(!n&&s===15)return this.parseBind(e,t,n,i);if(hC(s))return this.parseTaggedTemplateExpression(e,t,i);let a=!1;if(s===18){if(n&&(this.raise(Ne.OptionalChainingNoNew,this.state.startLoc),this.lookaheadCharCode()===40))return this.stopParseSubscript(e,i);i.optionalChainMember=a=!0,this.next()}if(!n&&this.match(10))return this.parseCoverCallAndAsyncArrowHead(e,t,i,a);{const o=this.eat(0);return o||a||this.eat(16)?this.parseMember(e,t,i,o,a):this.stopParseSubscript(e,i)}}stopParseSubscript(e,t){return t.stop=!0,e}parseMember(e,t,n,i,s){const a=this.startNodeAt(t);return a.object=e,a.computed=i,i?(a.property=this.parseExpression(),this.expect(3)):this.match(139)?(e.type==="Super"&&this.raise(Ne.SuperPrivateField,t),this.classScope.usePrivateName(this.state.value,this.state.startLoc),a.property=this.parsePrivateName()):a.property=this.parseIdentifier(!0),n.optionalChainMember?(a.optional=s,this.finishNode(a,"OptionalMemberExpression")):this.finishNode(a,"MemberExpression")}parseBind(e,t,n,i){const s=this.startNodeAt(t);return s.object=e,this.next(),s.callee=this.parseNoCallExpr(),i.stop=!0,this.parseSubscripts(this.finishNode(s,"BindExpression"),t,n)}parseCoverCallAndAsyncArrowHead(e,t,n,i){const s=this.state.maybeInArrowParameters;let a=null;this.state.maybeInArrowParameters=!0,this.next();const o=this.startNodeAt(t);o.callee=e;const{maybeAsyncArrow:u,optionalChainMember:f}=n;u&&(this.expressionScope.enter(bae()),a=new cw),f&&(o.optional=i),i?o.arguments=this.parseCallExpressionArguments():o.arguments=this.parseCallExpressionArguments(e.type!=="Super",o,a);let g=this.finishCallExpression(o,f);return u&&this.shouldParseAsyncArrow()&&!i?(n.stop=!0,this.checkDestructuringPrivate(a),this.expressionScope.validateAsPattern(),this.expressionScope.exit(),g=this.parseAsyncArrowFromCallExpression(this.startNodeAt(t),g)):(u&&(this.checkExpressionErrors(a,!0),this.expressionScope.exit()),this.toReferencedArguments(g)),this.state.maybeInArrowParameters=s,g}toReferencedArguments(e,t){this.toReferencedListDeep(e.arguments,t)}parseTaggedTemplateExpression(e,t,n){const i=this.startNodeAt(t);return i.tag=e,i.quasi=this.parseTemplate(!0),n.optionalChainMember&&this.raise(Ne.OptionalChainingNoTemplate,t),this.finishNode(i,"TaggedTemplateExpression")}atPossibleAsyncArrow(e){return e.type==="Identifier"&&e.name==="async"&&this.state.lastTokEndLoc.index===e.end&&!this.canInsertSemicolon()&&e.end-e.start===5&&this.offsetToSourcePos(e.start)===this.state.potentialArrowAt}finishCallExpression(e,t){if(e.callee.type==="Import")if(e.arguments.length===0||e.arguments.length>2)this.raise(Ne.ImportCallArity,e);else for(const n of e.arguments)n.type==="SpreadElement"&&this.raise(Ne.ImportCallSpreadArgument,n);return this.finishNode(e,t?"OptionalCallExpression":"CallExpression")}parseCallExpressionArguments(e,t,n){const i=[];let s=!0;const a=this.state.inFSharpPipelineDirectBody;for(this.state.inFSharpPipelineDirectBody=!1;!this.eat(11);){if(s)s=!1;else if(this.expect(12),this.match(11)){t&&this.addTrailingCommaExtraToNode(t),this.next();break}i.push(this.parseExprListItem(11,!1,n,e))}return this.state.inFSharpPipelineDirectBody=a,i}shouldParseAsyncArrow(){return this.match(19)&&!this.canInsertSemicolon()}parseAsyncArrowFromCallExpression(e,t){var n;return this.resetPreviousNodeTrailingComments(t),this.expect(19),this.parseArrowExpression(e,t.arguments,!0,(n=t.extra)==null?void 0:n.trailingCommaLoc),t.innerComments&&E_(e,t.innerComments),t.callee.trailingComments&&E_(e,t.callee.trailingComments),e}parseNoCallExpr(){const e=this.state.startLoc;return this.parseSubscripts(this.parseExprAtom(),e,!0)}parseExprAtom(e){let t,n=null;const{type:i}=this.state;switch(i){case 79:return this.parseSuper();case 83:return t=this.startNode(),this.next(),this.match(16)?this.parseImportMetaPropertyOrPhaseCall(t):this.match(10)?this.optionFlags&512?this.parseImportCall(t):this.finishNode(t,"Import"):(this.raise(Ne.UnsupportedImport,this.state.lastTokStartLoc),this.finishNode(t,"Import"));case 78:return t=this.startNode(),this.next(),this.finishNode(t,"ThisExpression");case 90:return this.parseDo(this.startNode(),!1);case 56:case 31:return this.readRegexp(),this.parseRegExpLiteral(this.state.value);case 135:return this.parseNumericLiteral(this.state.value);case 136:return this.parseBigIntLiteral(this.state.value);case 134:return this.parseStringLiteral(this.state.value);case 84:return this.parseNullLiteral();case 85:return this.parseBooleanLiteral(!0);case 86:return this.parseBooleanLiteral(!1);case 10:{const s=this.state.potentialArrowAt===this.state.start;return this.parseParenAndDistinguishExpression(s)}case 0:return this.parseArrayLike(3,!1,e);case 5:return this.parseObjectLike(8,!1,!1,e);case 68:return this.parseFunctionOrFunctionSent();case 26:n=this.parseDecorators();case 80:return this.parseClass(this.maybeTakeDecorators(n,this.startNode()),!1);case 77:return this.parseNewOrNewTarget();case 25:case 24:return this.parseTemplate(!1);case 15:{t=this.startNode(),this.next(),t.object=null;const s=t.callee=this.parseNoCallExpr();if(s.type==="MemberExpression")return this.finishNode(t,"BindExpression");throw this.raise(Ne.UnsupportedBind,s)}case 139:return this.raise(Ne.PrivateInExpectedIn,this.state.startLoc,{identifierName:this.state.value}),this.parsePrivateName();case 33:return this.parseTopicReferenceThenEqualsSign(54,"%");case 32:return this.parseTopicReferenceThenEqualsSign(44,"^");case 37:case 38:return this.parseTopicReference("hack");case 44:case 54:case 27:{const s=this.getPluginOption("pipelineOperator","proposal");if(s)return this.parseTopicReference(s);throw this.unexpected()}case 47:{const s=this.input.codePointAt(this.nextTokenStart());throw Dc(s)||s===62?this.expectOnePlugin(["jsx","flow","typescript"]):this.unexpected()}default:{if(i===137)return this.parseDecimalLiteral(this.state.value);if(i===2||i===1)return this.parseArrayLike(this.state.type===2?4:3,!0);if(i===6||i===7)return this.parseObjectLike(this.state.type===6?9:8,!1,!0)}if(Dn(i)){if(this.isContextual(127)&&this.lookaheadInLineCharCode()===123)return this.parseModuleExpression();const s=this.state.potentialArrowAt===this.state.start,a=this.state.containsEsc,o=this.parseIdentifier();if(!a&&o.name==="async"&&!this.canInsertSemicolon()){const{type:u}=this.state;if(u===68)return this.resetPreviousNodeTrailingComments(o),this.next(),this.parseAsyncFunctionExpression(this.startNodeAtNode(o));if(Dn(u))return this.lookaheadCharCode()===61?this.parseAsyncArrowUnaryFunction(this.startNodeAtNode(o)):o;if(u===90)return this.resetPreviousNodeTrailingComments(o),this.parseDo(this.startNodeAtNode(o),!0)}return s&&this.match(19)&&!this.canInsertSemicolon()?(this.next(),this.parseArrowExpression(this.startNodeAtNode(o),[o],!1)):o}else throw this.unexpected()}}parseTopicReferenceThenEqualsSign(e,t){const n=this.getPluginOption("pipelineOperator","proposal");if(n)return this.state.type=e,this.state.value=t,this.state.pos--,this.state.end--,this.state.endLoc=jo(this.state.endLoc,-1),this.parseTopicReference(n);throw this.unexpected()}parseTopicReference(e){const t=this.startNode(),n=this.state.startLoc,i=this.state.type;return this.next(),this.finishTopicReference(t,n,e,i)}finishTopicReference(e,t,n,i){if(this.testTopicReferenceConfiguration(n,t,i))return n==="hack"?(this.topicReferenceIsAllowedInCurrentContext()||this.raise(Ne.PipeTopicUnbound,t),this.registerTopicReference(),this.finishNode(e,"TopicReference")):(this.topicReferenceIsAllowedInCurrentContext()||this.raise(Ne.PrimaryTopicNotAllowed,t),this.registerTopicReference(),this.finishNode(e,"PipelinePrimaryTopicReference"));throw this.raise(Ne.PipeTopicUnconfiguredToken,t,{token:gd(i)})}testTopicReferenceConfiguration(e,t,n){switch(e){case"hack":return this.hasPlugin(["pipelineOperator",{topicToken:gd(n)}]);case"smart":return n===27;default:throw this.raise(Ne.PipeTopicRequiresHackPipes,t)}}parseAsyncArrowUnaryFunction(e){this.prodParam.enter(lw(!0,this.prodParam.hasYield));const t=[this.parseIdentifier()];return this.prodParam.exit(),this.hasPrecedingLineBreak()&&this.raise(Ne.LineTerminatorBeforeArrow,this.state.curPosition()),this.expect(19),this.parseArrowExpression(e,t,!0)}parseDo(e,t){this.expectPlugin("doExpressions"),t&&this.expectPlugin("asyncDoExpressions"),e.async=t,this.next();const n=this.state.labels;return this.state.labels=[],t?(this.prodParam.enter(2),e.body=this.parseBlock(),this.prodParam.exit()):e.body=this.parseBlock(),this.state.labels=n,this.finishNode(e,"DoExpression")}parseSuper(){const e=this.startNode();return this.next(),this.match(10)&&!this.scope.allowDirectSuper?this.optionFlags&16||this.raise(Ne.SuperNotAllowed,e):this.scope.allowSuper||this.optionFlags&16||this.raise(Ne.UnexpectedSuper,e),!this.match(10)&&!this.match(0)&&!this.match(16)&&this.raise(Ne.UnsupportedSuper,e),this.finishNode(e,"Super")}parsePrivateName(){const e=this.startNode(),t=this.startNodeAt(jo(this.state.startLoc,1)),n=this.state.value;return this.next(),e.id=this.createIdentifier(t,n),this.finishNode(e,"PrivateName")}parseFunctionOrFunctionSent(){const e=this.startNode();if(this.next(),this.prodParam.hasYield&&this.match(16)){const t=this.createIdentifier(this.startNodeAtNode(e),"function");return this.next(),this.match(103)?this.expectPlugin("functionSent"):this.hasPlugin("functionSent")||this.unexpected(),this.parseMetaProperty(e,t,"sent")}return this.parseFunction(e)}parseMetaProperty(e,t,n){e.meta=t;const i=this.state.containsEsc;return e.property=this.parseIdentifier(!0),(e.property.name!==n||i)&&this.raise(Ne.UnsupportedMetaProperty,e.property,{target:t.name,onlyValidPropertyName:n}),this.finishNode(e,"MetaProperty")}parseImportMetaPropertyOrPhaseCall(e){if(this.next(),this.isContextual(105)||this.isContextual(97)){const t=this.isContextual(105);return this.expectPlugin(t?"sourcePhaseImports":"deferredImportEvaluation"),this.next(),e.phase=t?"source":"defer",this.parseImportCall(e)}else{const t=this.createIdentifierAt(this.startNodeAtNode(e),"import",this.state.lastTokStartLoc);return this.isContextual(101)&&(this.inModule||this.raise(Ne.ImportMetaOutsideModule,t),this.sawUnambiguousESM=!0),this.parseMetaProperty(e,t,"meta")}}parseLiteralAtNode(e,t,n){return this.addExtra(n,"rawValue",e),this.addExtra(n,"raw",this.input.slice(this.offsetToSourcePos(n.start),this.state.end)),n.value=e,this.next(),this.finishNode(n,t)}parseLiteral(e,t){const n=this.startNode();return this.parseLiteralAtNode(e,t,n)}parseStringLiteral(e){return this.parseLiteral(e,"StringLiteral")}parseNumericLiteral(e){return this.parseLiteral(e,"NumericLiteral")}parseBigIntLiteral(e){return this.parseLiteral(e,"BigIntLiteral")}parseDecimalLiteral(e){return this.parseLiteral(e,"DecimalLiteral")}parseRegExpLiteral(e){const t=this.startNode();return this.addExtra(t,"raw",this.input.slice(this.offsetToSourcePos(t.start),this.state.end)),t.pattern=e.pattern,t.flags=e.flags,this.next(),this.finishNode(t,"RegExpLiteral")}parseBooleanLiteral(e){const t=this.startNode();return t.value=e,this.next(),this.finishNode(t,"BooleanLiteral")}parseNullLiteral(){const e=this.startNode();return this.next(),this.finishNode(e,"NullLiteral")}parseParenAndDistinguishExpression(e){const t=this.state.startLoc;let n;this.next(),this.expressionScope.enter(yae());const i=this.state.maybeInArrowParameters,s=this.state.inFSharpPipelineDirectBody;this.state.maybeInArrowParameters=!0,this.state.inFSharpPipelineDirectBody=!1;const a=this.state.startLoc,o=[],u=new cw;let f=!0,g,y;for(;!this.match(11);){if(f)f=!1;else if(this.expect(12,u.optionalParametersLoc===null?null:u.optionalParametersLoc),this.match(11)){y=this.state.startLoc;break}if(this.match(21)){const M=this.state.startLoc;if(g=this.state.startLoc,o.push(this.parseParenItem(this.parseRestBinding(),M)),!this.checkCommaAfterRest(41))break}else o.push(this.parseMaybeAssignAllowInOrVoidPattern(11,u,this.parseParenItem))}const A=this.state.lastTokEndLoc;this.expect(11),this.state.maybeInArrowParameters=i,this.state.inFSharpPipelineDirectBody=s;let C=this.startNodeAt(t);return e&&this.shouldParseArrow(o)&&(C=this.parseArrow(C))?(this.checkDestructuringPrivate(u),this.expressionScope.validateAsPattern(),this.expressionScope.exit(),this.parseArrowExpression(C,o,!1),C):(this.expressionScope.exit(),o.length||this.unexpected(this.state.lastTokStartLoc),y&&this.unexpected(y),g&&this.unexpected(g),this.checkExpressionErrors(u,!0),this.toReferencedListDeep(o,!0),o.length>1?(n=this.startNodeAt(a),n.expressions=o,this.finishNode(n,"SequenceExpression"),this.resetEndLocation(n,A)):n=o[0],this.wrapParenthesis(t,n))}wrapParenthesis(e,t){if(!(this.optionFlags&1024))return this.addExtra(t,"parenthesized",!0),this.addExtra(t,"parenStart",e.index),this.takeSurroundingComments(t,e.index,this.state.lastTokEndLoc.index),t;const n=this.startNodeAt(e);return n.expression=t,this.finishNode(n,"ParenthesizedExpression")}shouldParseArrow(e){return!this.canInsertSemicolon()}parseArrow(e){if(this.eat(19))return e}parseParenItem(e,t){return e}parseNewOrNewTarget(){const e=this.startNode();if(this.next(),this.match(16)){const t=this.createIdentifier(this.startNodeAtNode(e),"new");this.next();const n=this.parseMetaProperty(e,t,"target");return this.scope.allowNewTarget||this.raise(Ne.UnexpectedNewTarget,n),n}return this.parseNew(e)}parseNew(e){if(this.parseNewCallee(e),this.eat(10)){const t=this.parseExprList(11);this.toReferencedList(t),e.arguments=t}else e.arguments=[];return this.finishNode(e,"NewExpression")}parseNewCallee(e){const t=this.match(83),n=this.parseNoCallExpr();e.callee=n,t&&(n.type==="Import"||n.type==="ImportExpression")&&this.raise(Ne.ImportCallNotNewExpression,n)}parseTemplateElement(e){const{start:t,startLoc:n,end:i,value:s}=this.state,a=t+1,o=this.startNodeAt(jo(n,1));s===null&&(e||this.raise(Ne.InvalidEscapeSequenceTemplate,jo(this.state.firstInvalidTemplateEscapePos,1)));const u=this.match(24),f=u?-1:-2,g=i+f;o.value={raw:this.input.slice(a,g).replace(/\r\n?/g,`
`),cooked:s===null?null:s.slice(1,f)},o.tail=u,this.next();const y=this.finishNode(o,"TemplateElement");return this.resetEndLocation(y,jo(this.state.lastTokEndLoc,f)),y}parseTemplate(e){const t=this.startNode();let n=this.parseTemplateElement(e);const i=[n],s=[];for(;!n.tail;)s.push(this.parseTemplateSubstitution()),this.readTemplateContinuation(),i.push(n=this.parseTemplateElement(e));return t.expressions=s,t.quasis=i,this.finishNode(t,"TemplateLiteral")}parseTemplateSubstitution(){return this.parseExpression()}parseObjectLike(e,t,n,i){n&&this.expectPlugin("recordAndTuple");const s=this.state.inFSharpPipelineDirectBody;this.state.inFSharpPipelineDirectBody=!1;let a=!1,o=!0;const u=this.startNode();for(u.properties=[],this.next();!this.match(e);){if(o)o=!1;else if(this.expect(12),this.match(e)){this.addTrailingCommaExtraToNode(u);break}let g;t?g=this.parseBindingProperty():(g=this.parsePropertyDefinition(i),a=this.checkProto(g,n,a,i)),n&&!this.isObjectProperty(g)&&g.type!=="SpreadElement"&&this.raise(Ne.InvalidRecordProperty,g),g.shorthand&&this.addExtra(g,"shorthand",!0),u.properties.push(g)}this.next(),this.state.inFSharpPipelineDirectBody=s;let f="ObjectExpression";return t?f="ObjectPattern":n&&(f="RecordExpression"),this.finishNode(u,f)}addTrailingCommaExtraToNode(e){this.addExtra(e,"trailingComma",this.state.lastTokStartLoc.index),this.addExtra(e,"trailingCommaLoc",this.state.lastTokStartLoc,!1)}maybeAsyncOrAccessorProp(e){return!e.computed&&e.key.type==="Identifier"&&(this.isLiteralPropertyName()||this.match(0)||this.match(55))}parsePropertyDefinition(e){let t=[];if(this.match(26))for(this.hasPlugin("decorators")&&this.raise(Ne.UnsupportedPropertyDecorator,this.state.startLoc);this.match(26);)t.push(this.parseDecorator());const n=this.startNode();let i=!1,s=!1,a;if(this.match(21))return t.length&&this.unexpected(),this.parseSpread();t.length&&(n.decorators=t,t=[]),n.method=!1,e&&(a=this.state.startLoc);let o=this.eat(55);this.parsePropertyNamePrefixOperator(n);const u=this.state.containsEsc;if(this.parsePropertyName(n,e),!o&&!u&&this.maybeAsyncOrAccessorProp(n)){const{key:f}=n,g=f.name;g==="async"&&!this.hasPrecedingLineBreak()&&(i=!0,this.resetPreviousNodeTrailingComments(f),o=this.eat(55),this.parsePropertyName(n)),(g==="get"||g==="set")&&(s=!0,this.resetPreviousNodeTrailingComments(f),n.kind=g,this.match(55)&&(o=!0,this.raise(Ne.AccessorIsGenerator,this.state.curPosition(),{kind:g}),this.next()),this.parsePropertyName(n))}return this.parseObjPropValue(n,a,o,i,!1,s,e)}getGetterSetterExpectedParamCount(e){return e.kind==="get"?0:1}getObjectOrClassMethodParams(e){return e.params}checkGetterSetterParams(e){var t;const n=this.getGetterSetterExpectedParamCount(e),i=this.getObjectOrClassMethodParams(e);i.length!==n&&this.raise(e.kind==="get"?Ne.BadGetterArity:Ne.BadSetterArity,e),e.kind==="set"&&((t=i[i.length-1])==null?void 0:t.type)==="RestElement"&&this.raise(Ne.BadSetterRestParameter,e)}parseObjectMethod(e,t,n,i,s){if(s){const a=this.parseMethod(e,t,!1,!1,!1,"ObjectMethod");return this.checkGetterSetterParams(a),a}if(n||t||this.match(10))return i&&this.unexpected(),e.kind="method",e.method=!0,this.parseMethod(e,t,n,!1,!1,"ObjectMethod")}parseObjectProperty(e,t,n,i){if(e.shorthand=!1,this.eat(14))return e.value=n?this.parseMaybeDefault(this.state.startLoc):this.parseMaybeAssignAllowInOrVoidPattern(8,i),this.finishObjectProperty(e);if(!e.computed&&e.key.type==="Identifier"){if(this.checkReservedWord(e.key.name,e.key.loc.start,!0,!1),n)e.value=this.parseMaybeDefault(t,this.cloneIdentifier(e.key));else if(this.match(29)){const s=this.state.startLoc;i!=null?i.shorthandAssignLoc===null&&(i.shorthandAssignLoc=s):this.raise(Ne.InvalidCoverInitializedName,s),e.value=this.parseMaybeDefault(t,this.cloneIdentifier(e.key))}else e.value=this.cloneIdentifier(e.key);return e.shorthand=!0,this.finishObjectProperty(e)}}finishObjectProperty(e){return this.finishNode(e,"ObjectProperty")}parseObjPropValue(e,t,n,i,s,a,o){const u=this.parseObjectMethod(e,n,i,s,a)||this.parseObjectProperty(e,t,s,o);return u||this.unexpected(),u}parsePropertyName(e,t){if(this.eat(0))e.computed=!0,e.key=this.parseMaybeAssignAllowIn(),this.expect(3);else{const{type:n,value:i}=this.state;let s;if(Wl(n))s=this.parseIdentifier(!0);else switch(n){case 135:s=this.parseNumericLiteral(i);break;case 134:s=this.parseStringLiteral(i);break;case 136:s=this.parseBigIntLiteral(i);break;case 139:{const a=this.state.startLoc;t!=null?t.privateKeyLoc===null&&(t.privateKeyLoc=a):this.raise(Ne.UnexpectedPrivateField,a),s=this.parsePrivateName();break}default:if(n===137){s=this.parseDecimalLiteral(i);break}this.unexpected()}e.key=s,n!==139&&(e.computed=!1)}}initFunction(e,t){e.id=null,e.generator=!1,e.async=t}parseMethod(e,t,n,i,s,a,o=!1){this.initFunction(e,n),e.generator=t,this.scope.enter(530|(o?576:0)|(s?32:0)),this.prodParam.enter(lw(n,e.generator)),this.parseFunctionParams(e,i);const u=this.parseFunctionBodyAndFinish(e,a,!0);return this.prodParam.exit(),this.scope.exit(),u}parseArrayLike(e,t,n){t&&this.expectPlugin("recordAndTuple");const i=this.state.inFSharpPipelineDirectBody;this.state.inFSharpPipelineDirectBody=!1;const s=this.startNode();return this.next(),s.elements=this.parseExprList(e,!t,n,s),this.state.inFSharpPipelineDirectBody=i,this.finishNode(s,t?"TupleExpression":"ArrayExpression")}parseArrowExpression(e,t,n,i){this.scope.enter(518);let s=lw(n,!1);!this.match(5)&&this.prodParam.hasIn&&(s|=8),this.prodParam.enter(s),this.initFunction(e,n);const a=this.state.maybeInArrowParameters;return t&&(this.state.maybeInArrowParameters=!0,this.setArrowFunctionParameters(e,t,i)),this.state.maybeInArrowParameters=!1,this.parseFunctionBody(e,!0),this.prodParam.exit(),this.scope.exit(),this.state.maybeInArrowParameters=a,this.finishNode(e,"ArrowFunctionExpression")}setArrowFunctionParameters(e,t,n){this.toAssignableList(t,n,!1),e.params=t}parseFunctionBodyAndFinish(e,t,n=!1){return this.parseFunctionBody(e,!1,n),this.finishNode(e,t)}parseFunctionBody(e,t,n=!1){const i=t&&!this.match(5);if(this.expressionScope.enter(M7()),i)e.body=this.parseMaybeAssign(),this.checkParams(e,!1,t,!1);else{const s=this.state.strict,a=this.state.labels;this.state.labels=[],this.prodParam.enter(this.prodParam.currentFlags()|4),e.body=this.parseBlock(!0,!1,o=>{const u=!this.isSimpleParamList(e.params);o&&u&&this.raise(Ne.IllegalLanguageModeDirective,(e.kind==="method"||e.kind==="constructor")&&e.key?e.key.loc.end:e);const f=!s&&this.state.strict;this.checkParams(e,!this.state.strict&&!t&&!n&&!u,t,f),this.state.strict&&e.id&&this.checkIdentifier(e.id,65,f)}),this.prodParam.exit(),this.state.labels=a}this.expressionScope.exit()}isSimpleParameter(e){return e.type==="Identifier"}isSimpleParamList(e){for(let t=0,n=e.length;t<n;t++)if(!this.isSimpleParameter(e[t]))return!1;return!0}checkParams(e,t,n,i=!0){const s=!t&&new Set,a={type:"FormalParameters"};for(const o of e.params)this.checkLVal(o,a,5,s,i)}parseExprList(e,t,n,i){const s=[];let a=!0;for(;!this.eat(e);){if(a)a=!1;else if(this.expect(12),this.match(e)){i&&this.addTrailingCommaExtraToNode(i),this.next();break}s.push(this.parseExprListItem(e,t,n))}return s}parseExprListItem(e,t,n,i){let s;if(this.match(12))t||this.raise(Ne.UnexpectedToken,this.state.curPosition(),{unexpected:","}),s=null;else if(this.match(21)){const a=this.state.startLoc;s=this.parseParenItem(this.parseSpread(n),a)}else if(this.match(17)){this.expectPlugin("partialApplication"),i||this.raise(Ne.UnexpectedArgumentPlaceholder,this.state.startLoc);const a=this.startNode();this.next(),s=this.finishNode(a,"ArgumentPlaceholder")}else s=this.parseMaybeAssignAllowInOrVoidPattern(e,n,this.parseParenItem);return s}parseIdentifier(e){const t=this.startNode(),n=this.parseIdentifierName(e);return this.createIdentifier(t,n)}createIdentifier(e,t){return e.name=t,e.loc.identifierName=t,this.finishNode(e,"Identifier")}createIdentifierAt(e,t,n){return e.name=t,e.loc.identifierName=t,this.finishNodeAt(e,"Identifier",n)}parseIdentifierName(e){let t;const{startLoc:n,type:i}=this.state;Wl(i)?t=this.state.value:this.unexpected();const s=Coe(i);return e?s&&this.replaceToken(132):this.checkReservedWord(t,n,s,!1),this.next(),t}checkReservedWord(e,t,n,i){if(e.length>10||!joe(e))return;if(n&&zoe(e)){this.raise(Ne.UnexpectedKeyword,t,{keyword:e});return}if((this.state.strict?i?S7:C7:w7)(e,this.inModule)){this.raise(Ne.UnexpectedReservedWord,t,{reservedWord:e});return}else if(e==="yield"){if(this.prodParam.hasYield){this.raise(Ne.YieldBindingIdentifier,t);return}}else if(e==="await"){if(this.prodParam.hasAwait){this.raise(Ne.AwaitBindingIdentifier,t);return}if(this.scope.inStaticBlock){this.raise(Ne.AwaitBindingIdentifierInStaticBlock,t);return}this.expressionScope.recordAsyncArrowParametersError(t)}else if(e==="arguments"&&this.scope.inClassAndNotInNonArrowFunction){this.raise(Ne.ArgumentsInClass,t);return}}recordAwaitIfAllowed(){const e=this.prodParam.hasAwait;return e&&!this.scope.inFunction&&(this.state.hasTopLevelAwait=!0),e}parseAwait(e){const t=this.startNodeAt(e);return this.expressionScope.recordParameterInitializerError(Ne.AwaitExpressionFormalParameter,t),this.eat(55)&&this.raise(Ne.ObsoleteAwaitStar,t),!this.scope.inFunction&&!(this.optionFlags&1)&&(this.isAmbiguousPrefixOrIdentifier()?this.ambiguousScriptDifferentAst=!0:this.sawUnambiguousESM=!0),this.state.soloAwait||(t.argument=this.parseMaybeUnary(null,!0)),this.finishNode(t,"AwaitExpression")}isAmbiguousPrefixOrIdentifier(){if(this.hasPrecedingLineBreak())return!0;const{type:e}=this.state;return e===53||e===10||e===0||hC(e)||e===102&&!this.state.containsEsc||e===138||e===56||this.hasPlugin("v8intrinsic")&&e===54}parseYield(e){const t=this.startNodeAt(e);this.expressionScope.recordParameterInitializerError(Ne.YieldInParameter,t);let n=!1,i=null;if(!this.hasPrecedingLineBreak())switch(n=this.eat(55),this.state.type){case 13:case 140:case 8:case 11:case 3:case 9:case 14:case 12:if(!n)break;default:i=this.parseMaybeAssign()}return t.delegate=n,t.argument=i,this.finishNode(t,"YieldExpression")}parseImportCall(e){if(this.next(),e.source=this.parseMaybeAssignAllowIn(),e.options=null,this.eat(12)){if(this.match(11))this.addTrailingCommaExtraToNode(e.source);else if(e.options=this.parseMaybeAssignAllowIn(),this.eat(12)&&(this.addTrailingCommaExtraToNode(e.options),!this.match(11))){do this.parseMaybeAssignAllowIn();while(this.eat(12)&&!this.match(11));this.raise(Ne.ImportCallArity,e)}}return this.expect(11),this.finishNode(e,"ImportExpression")}checkPipelineAtInfixOperator(e,t){this.hasPlugin(["pipelineOperator",{proposal:"smart"}])&&e.type==="SequenceExpression"&&this.raise(Ne.PipelineHeadSequenceExpression,t)}parseSmartPipelineBodyInStyle(e,t){if(this.isSimpleReference(e)){const n=this.startNodeAt(t);return n.callee=e,this.finishNode(n,"PipelineBareFunction")}else{const n=this.startNodeAt(t);return this.checkSmartPipeTopicBodyEarlyErrors(t),n.expression=e,this.finishNode(n,"PipelineTopicExpression")}}isSimpleReference(e){switch(e.type){case"MemberExpression":return!e.computed&&this.isSimpleReference(e.object);case"Identifier":return!0;default:return!1}}checkSmartPipeTopicBodyEarlyErrors(e){if(this.match(19))throw this.raise(Ne.PipelineBodyNoArrow,this.state.startLoc);this.topicReferenceWasUsedInCurrentContext()||this.raise(Ne.PipelineTopicUnused,e)}withTopicBindingContext(e){const t=this.state.topicContext;this.state.topicContext={maxNumOfResolvableTopics:1,maxTopicIndex:null};try{return e()}finally{this.state.topicContext=t}}withSmartMixTopicForbiddingContext(e){if(this.hasPlugin(["pipelineOperator",{proposal:"smart"}])){const t=this.state.topicContext;this.state.topicContext={maxNumOfResolvableTopics:0,maxTopicIndex:null};try{return e()}finally{this.state.topicContext=t}}else return e()}withSoloAwaitPermittingContext(e){const t=this.state.soloAwait;this.state.soloAwait=!0;try{return e()}finally{this.state.soloAwait=t}}allowInAnd(e){const t=this.prodParam.currentFlags();if(8&~t){this.prodParam.enter(t|8);try{return e()}finally{this.prodParam.exit()}}return e()}disallowInAnd(e){const t=this.prodParam.currentFlags();if(8&t){this.prodParam.enter(t&-9);try{return e()}finally{this.prodParam.exit()}}return e()}registerTopicReference(){this.state.topicContext.maxTopicIndex=0}topicReferenceIsAllowedInCurrentContext(){return this.state.topicContext.maxNumOfResolvableTopics>=1}topicReferenceWasUsedInCurrentContext(){return this.state.topicContext.maxTopicIndex!=null&&this.state.topicContext.maxTopicIndex>=0}parseFSharpPipelineBody(e){const t=this.state.startLoc;this.state.potentialArrowAt=this.state.start;const n=this.state.inFSharpPipelineDirectBody;this.state.inFSharpPipelineDirectBody=!0;const i=this.parseExprOp(this.parseMaybeUnaryOrPrivate(),t,e);return this.state.inFSharpPipelineDirectBody=n,i}parseModuleExpression(){this.expectPlugin("moduleBlocks");const e=this.startNode();this.next(),this.match(5)||this.unexpected(null,5);const t=this.startNodeAt(this.state.endLoc);this.next();const n=this.initializeScopes(!0);this.enterInitialScopes();try{e.body=this.parseProgram(t,8,"module")}finally{n()}return this.finishNode(e,"ModuleExpression")}parseVoidPattern(e){this.expectPlugin("discardBinding");const t=this.startNode();return e!=null&&(e.voidPatternLoc=this.state.startLoc),this.next(),this.finishNode(t,"VoidPattern")}parseMaybeAssignAllowInOrVoidPattern(e,t,n){if(t!=null&&this.match(88)){const i=this.lookaheadCharCode();if(i===44||i===(e===3?93:e===8?125:41)||i===61)return this.parseMaybeDefault(this.state.startLoc,this.parseVoidPattern(t))}return this.parseMaybeAssignAllowIn(t,n)}parsePropertyNamePrefixOperator(e){}}const rI={kind:1},Oae={kind:2},Dae=/[\uD800-\uDFFF]/u,nI=/in(?:stanceof)?/y;function Lae(r,e,t){for(let n=0;n<r.length;n++){const i=r[n],{type:s}=i;if(typeof s=="number"){{if(s===139){const{loc:a,start:o,value:u,end:f}=i,g=o+1,y=jo(a.start,1);r.splice(n,1,new Kh({type:Bu(27),value:"#",start:o,end:g,startLoc:a.start,endLoc:y}),new Kh({type:Bu(132),value:u,start:g,end:f,startLoc:y,endLoc:a.end})),n++;continue}if(hC(s)){const{loc:a,start:o,value:u,end:f}=i,g=o+1,y=jo(a.start,1);let A;e.charCodeAt(o-t)===96?A=new Kh({type:Bu(22),value:"`",start:o,end:g,startLoc:a.start,endLoc:y}):A=new Kh({type:Bu(8),value:"}",start:o,end:g,startLoc:a.start,endLoc:y});let C,M,k,D;s===24?(M=f-1,k=jo(a.end,-1),C=u===null?null:u.slice(1,-1),D=new Kh({type:Bu(22),value:"`",start:M,end:f,startLoc:k,endLoc:a.end})):(M=f-2,k=jo(a.end,-2),C=u===null?null:u.slice(1,-2),D=new Kh({type:Bu(23),value:"${",start:M,end:f,startLoc:k,endLoc:a.end})),r.splice(n,1,A,new Kh({type:Bu(20),value:C,start:g,end:M,startLoc:y,endLoc:k}),D),n+=2;continue}}i.type=Bu(s)}}return r}class Nae extends kae{parseTopLevel(e,t){return e.program=this.parseProgram(t,140,this.options.sourceType==="module"?"module":"script"),e.comments=this.comments,this.optionFlags&256&&(e.tokens=Lae(this.tokens,this.input,this.startIndex)),this.finishNode(e,"File")}parseProgram(e,t,n){if(e.sourceType=n,e.interpreter=this.parseInterpreterDirective(),this.parseBlockBody(e,!0,!0,t),this.inModule){if(!(this.optionFlags&64)&&this.scope.undefinedExports.size>0)for(const[s,a]of Array.from(this.scope.undefinedExports))this.raise(Ne.ModuleExportUndefined,a,{localName:s});this.addExtra(e,"topLevelAwait",this.state.hasTopLevelAwait)}let i;return t===140?i=this.finishNode(e,"Program"):i=this.finishNodeAt(e,"Program",jo(this.state.startLoc,-1)),i}stmtToDirective(e){const t=this.castNodeTo(e,"Directive"),n=this.castNodeTo(e.expression,"DirectiveLiteral"),i=n.value,s=this.input.slice(this.offsetToSourcePos(n.start),this.offsetToSourcePos(n.end)),a=n.value=s.slice(1,-1);return this.addExtra(n,"raw",s),this.addExtra(n,"rawValue",a),this.addExtra(n,"expressionValue",i),t.value=n,delete e.expression,t}parseInterpreterDirective(){if(!this.match(28))return null;const e=this.startNode();return e.value=this.state.value,this.next(),this.finishNode(e,"InterpreterDirective")}isLet(){return this.isContextual(100)?this.hasFollowingBindingAtom():!1}isUsing(){return this.isContextual(107)?this.nextTokenIsIdentifierOnSameLine():!1}isForUsing(){if(!this.isContextual(107))return!1;const e=this.nextTokenInLineStart(),t=this.codePointAtPos(e);if(this.isUnparsedContextual(e,"of")){const n=this.lookaheadCharCodeSince(e+2);if(n!==61&&n!==58&&n!==59)return!1}return!!(this.chStartsBindingIdentifier(t,e)||this.isUnparsedContextual(e,"void"))}nextTokenIsIdentifierOnSameLine(){const e=this.nextTokenInLineStart(),t=this.codePointAtPos(e);return this.chStartsBindingIdentifier(t,e)}isAwaitUsing(){if(!this.isContextual(96))return!1;let e=this.nextTokenInLineStart();if(this.isUnparsedContextual(e,"using")){e=this.nextTokenInLineStartSince(e+5);const t=this.codePointAtPos(e);if(this.chStartsBindingIdentifier(t,e))return!0}return!1}chStartsBindingIdentifier(e,t){if(Dc(e)){if(nI.lastIndex=t,nI.test(this.input)){const n=this.codePointAtPos(nI.lastIndex);if(!Hf(n)&&n!==92)return!1}return!0}else return e===92}chStartsBindingPattern(e){return e===91||e===123}hasFollowingBindingAtom(){const e=this.nextTokenStart(),t=this.codePointAtPos(e);return this.chStartsBindingPattern(t)||this.chStartsBindingIdentifier(t,e)}hasInLineFollowingBindingIdentifierOrBrace(){const e=this.nextTokenInLineStart(),t=this.codePointAtPos(e);return t===123||this.chStartsBindingIdentifier(t,e)}allowsUsing(){return(this.scope.inModule||!this.scope.inTopLevel)&&!this.scope.inBareCaseStatement}parseModuleItem(){return this.parseStatementLike(15)}parseStatementListItem(){return this.parseStatementLike(6|(!this.options.annexB||this.state.strict?0:8))}parseStatementOrSloppyAnnexBFunctionDeclaration(e=!1){let t=0;return this.options.annexB&&!this.state.strict&&(t|=4,e&&(t|=8)),this.parseStatementLike(t)}parseStatement(){return this.parseStatementLike(0)}parseStatementLike(e){let t=null;return this.match(26)&&(t=this.parseDecorators(!0)),this.parseStatementContent(e,t)}parseStatementContent(e,t){const n=this.state.type,i=this.startNode(),s=!!(e&2),a=!!(e&4),o=e&1;switch(n){case 60:return this.parseBreakContinueStatement(i,!0);case 63:return this.parseBreakContinueStatement(i,!1);case 64:return this.parseDebuggerStatement(i);case 90:return this.parseDoWhileStatement(i);case 91:return this.parseForStatement(i);case 68:if(this.lookaheadCharCode()===46)break;return a||this.raise(this.state.strict?Ne.StrictFunction:this.options.annexB?Ne.SloppyFunctionAnnexB:Ne.SloppyFunction,this.state.startLoc),this.parseFunctionStatement(i,!1,!s&&a);case 80:return s||this.unexpected(),this.parseClass(this.maybeTakeDecorators(t,i),!0);case 69:return this.parseIfStatement(i);case 70:return this.parseReturnStatement(i);case 71:return this.parseSwitchStatement(i);case 72:return this.parseThrowStatement(i);case 73:return this.parseTryStatement(i);case 96:if(this.isAwaitUsing())return this.allowsUsing()?s?this.recordAwaitIfAllowed()||this.raise(Ne.AwaitUsingNotInAsyncContext,i):this.raise(Ne.UnexpectedLexicalDeclaration,i):this.raise(Ne.UnexpectedUsingDeclaration,i),this.next(),this.parseVarStatement(i,"await using");break;case 107:if(this.state.containsEsc||!this.hasInLineFollowingBindingIdentifierOrBrace())break;return this.allowsUsing()?s||this.raise(Ne.UnexpectedLexicalDeclaration,this.state.startLoc):this.raise(Ne.UnexpectedUsingDeclaration,this.state.startLoc),this.parseVarStatement(i,"using");case 100:{if(this.state.containsEsc)break;const g=this.nextTokenStart(),y=this.codePointAtPos(g);if(y!==91&&(!s&&this.hasFollowingLineBreak()||!this.chStartsBindingIdentifier(y,g)&&y!==123))break}case 75:s||this.raise(Ne.UnexpectedLexicalDeclaration,this.state.startLoc);case 74:{const g=this.state.value;return this.parseVarStatement(i,g)}case 92:return this.parseWhileStatement(i);case 76:return this.parseWithStatement(i);case 5:return this.parseBlock();case 13:return this.parseEmptyStatement(i);case 83:{const g=this.lookaheadCharCode();if(g===40||g===46)break}case 82:{!(this.optionFlags&8)&&!o&&this.raise(Ne.UnexpectedImportExport,this.state.startLoc),this.next();let g;return n===83?g=this.parseImport(i):g=this.parseExport(i,t),this.assertModuleNodeAllowed(g),g}default:if(this.isAsyncFunction())return s||this.raise(Ne.AsyncFunctionInSingleStatementContext,this.state.startLoc),this.next(),this.parseFunctionStatement(i,!0,!s&&a)}const u=this.state.value,f=this.parseExpression();return Dn(n)&&f.type==="Identifier"&&this.eat(14)?this.parseLabeledStatement(i,u,f,e):this.parseExpressionStatement(i,f,t)}assertModuleNodeAllowed(e){!(this.optionFlags&8)&&!this.inModule&&this.raise(Ne.ImportOutsideModule,e)}decoratorsEnabledBeforeExport(){return this.hasPlugin("decorators-legacy")?!0:this.hasPlugin("decorators")&&this.getPluginOption("decorators","decoratorsBeforeExport")!==!1}maybeTakeDecorators(e,t,n){if(e){var i;(i=t.decorators)!=null&&i.length?(typeof this.getPluginOption("decorators","decoratorsBeforeExport")!="boolean"&&this.raise(Ne.DecoratorsBeforeAfterExport,t.decorators[0]),t.decorators.unshift(...e)):t.decorators=e,this.resetStartLocationFromNode(t,e[0]),n&&this.resetStartLocationFromNode(n,t)}return t}canHaveLeadingDecorator(){return this.match(80)}parseDecorators(e){const t=[];do t.push(this.parseDecorator());while(this.match(26));if(this.match(82))e||this.unexpected(),this.decoratorsEnabledBeforeExport()||this.raise(Ne.DecoratorExportClass,this.state.startLoc);else if(!this.canHaveLeadingDecorator())throw this.raise(Ne.UnexpectedLeadingDecorator,this.state.startLoc);return t}parseDecorator(){this.expectOnePlugin(["decorators","decorators-legacy"]);const e=this.startNode();if(this.next(),this.hasPlugin("decorators")){const t=this.state.startLoc;let n;if(this.match(10)){const i=this.state.startLoc;this.next(),n=this.parseExpression(),this.expect(11),n=this.wrapParenthesis(i,n);const s=this.state.startLoc;e.expression=this.parseMaybeDecoratorArguments(n,i),this.getPluginOption("decorators","allowCallParenthesized")===!1&&e.expression!==n&&this.raise(Ne.DecoratorArgumentsOutsideParentheses,s)}else{for(n=this.parseIdentifier(!1);this.eat(16);){const i=this.startNodeAt(t);i.object=n,this.match(139)?(this.classScope.usePrivateName(this.state.value,this.state.startLoc),i.property=this.parsePrivateName()):i.property=this.parseIdentifier(!0),i.computed=!1,n=this.finishNode(i,"MemberExpression")}e.expression=this.parseMaybeDecoratorArguments(n,t)}}else e.expression=this.parseExprSubscripts();return this.finishNode(e,"Decorator")}parseMaybeDecoratorArguments(e,t){if(this.eat(10)){const n=this.startNodeAt(t);return n.callee=e,n.arguments=this.parseCallExpressionArguments(),this.toReferencedList(n.arguments),this.finishNode(n,"CallExpression")}return e}parseBreakContinueStatement(e,t){return this.next(),this.isLineTerminator()?e.label=null:(e.label=this.parseIdentifier(),this.semicolon()),this.verifyBreakContinue(e,t),this.finishNode(e,t?"BreakStatement":"ContinueStatement")}verifyBreakContinue(e,t){let n;for(n=0;n<this.state.labels.length;++n){const i=this.state.labels[n];if((e.label==null||i.name===e.label.name)&&(i.kind!=null&&(t||i.kind===1)||e.label&&t))break}if(n===this.state.labels.length){const i=t?"BreakStatement":"ContinueStatement";this.raise(Ne.IllegalBreakContinue,e,{type:i})}}parseDebuggerStatement(e){return this.next(),this.semicolon(),this.finishNode(e,"DebuggerStatement")}parseHeaderExpression(){this.expect(10);const e=this.parseExpression();return this.expect(11),e}parseDoWhileStatement(e){return this.next(),this.state.labels.push(rI),e.body=this.withSmartMixTopicForbiddingContext(()=>this.parseStatement()),this.state.labels.pop(),this.expect(92),e.test=this.parseHeaderExpression(),this.eat(13),this.finishNode(e,"DoWhileStatement")}parseForStatement(e){this.next(),this.state.labels.push(rI);let t=null;if(this.isContextual(96)&&this.recordAwaitIfAllowed()&&(t=this.state.startLoc,this.next()),this.scope.enter(0),this.expect(10),this.match(13))return t!==null&&this.unexpected(t),this.parseFor(e,null);const n=this.isContextual(100);{const u=this.isAwaitUsing(),f=u||this.isForUsing(),g=n&&this.hasFollowingBindingAtom()||f;if(this.match(74)||this.match(75)||g){const y=this.startNode();let A;u?(A="await using",this.recordAwaitIfAllowed()||this.raise(Ne.AwaitUsingNotInAsyncContext,this.state.startLoc),this.next()):A=this.state.value,this.next(),this.parseVar(y,!0,A);const C=this.finishNode(y,"VariableDeclaration"),M=this.match(58);return M&&f&&this.raise(Ne.ForInUsing,C),(M||this.isContextual(102))&&C.declarations.length===1?this.parseForIn(e,C,t):(t!==null&&this.unexpected(t),this.parseFor(e,C))}}const i=this.isContextual(95),s=new cw,a=this.parseExpression(!0,s),o=this.isContextual(102);if(o&&(n&&this.raise(Ne.ForOfLet,a),t===null&&i&&a.type==="Identifier"&&this.raise(Ne.ForOfAsync,a)),o||this.match(58)){this.checkDestructuringPrivate(s),this.toAssignable(a,!0);const u=o?"ForOfStatement":"ForInStatement";return this.checkLVal(a,{type:u}),this.parseForIn(e,a,t)}else this.checkExpressionErrors(s,!0);return t!==null&&this.unexpected(t),this.parseFor(e,a)}parseFunctionStatement(e,t,n){return this.next(),this.parseFunction(e,1|(n?2:0)|(t?8:0))}parseIfStatement(e){return this.next(),e.test=this.parseHeaderExpression(),e.consequent=this.parseStatementOrSloppyAnnexBFunctionDeclaration(),e.alternate=this.eat(66)?this.parseStatementOrSloppyAnnexBFunctionDeclaration():null,this.finishNode(e,"IfStatement")}parseReturnStatement(e){return this.prodParam.hasReturn||this.raise(Ne.IllegalReturn,this.state.startLoc),this.next(),this.isLineTerminator()?e.argument=null:(e.argument=this.parseExpression(),this.semicolon()),this.finishNode(e,"ReturnStatement")}parseSwitchStatement(e){this.next(),e.discriminant=this.parseHeaderExpression();const t=e.cases=[];this.expect(5),this.state.labels.push(Oae),this.scope.enter(256);let n;for(let i;!this.match(8);)if(this.match(61)||this.match(65)){const s=this.match(61);n&&this.finishNode(n,"SwitchCase"),t.push(n=this.startNode()),n.consequent=[],this.next(),s?n.test=this.parseExpression():(i&&this.raise(Ne.MultipleDefaultsInSwitch,this.state.lastTokStartLoc),i=!0,n.test=null),this.expect(14)}else n?n.consequent.push(this.parseStatementListItem()):this.unexpected();return this.scope.exit(),n&&this.finishNode(n,"SwitchCase"),this.next(),this.state.labels.pop(),this.finishNode(e,"SwitchStatement")}parseThrowStatement(e){return this.next(),this.hasPrecedingLineBreak()&&this.raise(Ne.NewlineAfterThrow,this.state.lastTokEndLoc),e.argument=this.parseExpression(),this.semicolon(),this.finishNode(e,"ThrowStatement")}parseCatchClauseParam(){const e=this.parseBindingAtom();return this.scope.enter(this.options.annexB&&e.type==="Identifier"?8:0),this.checkLVal(e,{type:"CatchClause"},9),e}parseTryStatement(e){if(this.next(),e.block=this.parseBlock(),e.handler=null,this.match(62)){const t=this.startNode();this.next(),this.match(10)?(this.expect(10),t.param=this.parseCatchClauseParam(),this.expect(11)):(t.param=null,this.scope.enter(0)),t.body=this.withSmartMixTopicForbiddingContext(()=>this.parseBlock(!1,!1)),this.scope.exit(),e.handler=this.finishNode(t,"CatchClause")}return e.finalizer=this.eat(67)?this.parseBlock():null,!e.handler&&!e.finalizer&&this.raise(Ne.NoCatchOrFinally,e),this.finishNode(e,"TryStatement")}parseVarStatement(e,t,n=!1){return this.next(),this.parseVar(e,!1,t,n),this.semicolon(),this.finishNode(e,"VariableDeclaration")}parseWhileStatement(e){return this.next(),e.test=this.parseHeaderExpression(),this.state.labels.push(rI),e.body=this.withSmartMixTopicForbiddingContext(()=>this.parseStatement()),this.state.labels.pop(),this.finishNode(e,"WhileStatement")}parseWithStatement(e){return this.state.strict&&this.raise(Ne.StrictWith,this.state.startLoc),this.next(),e.object=this.parseHeaderExpression(),e.body=this.withSmartMixTopicForbiddingContext(()=>this.parseStatement()),this.finishNode(e,"WithStatement")}parseEmptyStatement(e){return this.next(),this.finishNode(e,"EmptyStatement")}parseLabeledStatement(e,t,n,i){for(const a of this.state.labels)a.name===t&&this.raise(Ne.LabelRedeclaration,n,{labelName:t});const s=Eoe(this.state.type)?1:this.match(71)?2:null;for(let a=this.state.labels.length-1;a>=0;a--){const o=this.state.labels[a];if(o.statementStart===e.start)o.statementStart=this.sourceToOffsetPos(this.state.start),o.kind=s;else break}return this.state.labels.push({name:t,kind:s,statementStart:this.sourceToOffsetPos(this.state.start)}),e.body=i&8?this.parseStatementOrSloppyAnnexBFunctionDeclaration(!0):this.parseStatement(),this.state.labels.pop(),e.label=n,this.finishNode(e,"LabeledStatement")}parseExpressionStatement(e,t,n){return e.expression=t,this.semicolon(),this.finishNode(e,"ExpressionStatement")}parseBlock(e=!1,t=!0,n){const i=this.startNode();return e&&this.state.strictErrors.clear(),this.expect(5),t&&this.scope.enter(0),this.parseBlockBody(i,e,!1,8,n),t&&this.scope.exit(),this.finishNode(i,"BlockStatement")}isValidDirective(e){return e.type==="ExpressionStatement"&&e.expression.type==="StringLiteral"&&!e.expression.extra.parenthesized}parseBlockBody(e,t,n,i,s){const a=e.body=[],o=e.directives=[];this.parseBlockOrModuleBlockBody(a,t?o:void 0,n,i,s)}parseBlockOrModuleBlockBody(e,t,n,i,s){const a=this.state.strict;let o=!1,u=!1;for(;!this.match(i);){const f=n?this.parseModuleItem():this.parseStatementListItem();if(t&&!u){if(this.isValidDirective(f)){const g=this.stmtToDirective(f);t.push(g),!o&&g.value.value==="use strict"&&(o=!0,this.setStrict(!0));continue}u=!0,this.state.strictErrors.clear()}e.push(f)}s?.call(this,o),a||this.setStrict(!1),this.next()}parseFor(e,t){return e.init=t,this.semicolon(!1),e.test=this.match(13)?null:this.parseExpression(),this.semicolon(!1),e.update=this.match(11)?null:this.parseExpression(),this.expect(11),e.body=this.withSmartMixTopicForbiddingContext(()=>this.parseStatement()),this.scope.exit(),this.state.labels.pop(),this.finishNode(e,"ForStatement")}parseForIn(e,t,n){const i=this.match(58);return this.next(),i?n!==null&&this.unexpected(n):e.await=n!==null,t.type==="VariableDeclaration"&&t.declarations[0].init!=null&&(!i||!this.options.annexB||this.state.strict||t.kind!=="var"||t.declarations[0].id.type!=="Identifier")&&this.raise(Ne.ForInOfLoopInitializer,t,{type:i?"ForInStatement":"ForOfStatement"}),t.type==="AssignmentPattern"&&this.raise(Ne.InvalidLhs,t,{ancestor:{type:"ForStatement"}}),e.left=t,e.right=i?this.parseExpression():this.parseMaybeAssignAllowIn(),this.expect(11),e.body=this.withSmartMixTopicForbiddingContext(()=>this.parseStatement()),this.scope.exit(),this.state.labels.pop(),this.finishNode(e,i?"ForInStatement":"ForOfStatement")}parseVar(e,t,n,i=!1){const s=e.declarations=[];for(e.kind=n;;){const a=this.startNode();if(this.parseVarId(a,n),a.init=this.eat(29)?t?this.parseMaybeAssignDisallowIn():this.parseMaybeAssignAllowIn():null,a.init===null&&!i&&(a.id.type!=="Identifier"&&!(t&&(this.match(58)||this.isContextual(102)))?this.raise(Ne.DeclarationMissingInitializer,this.state.lastTokEndLoc,{kind:"destructuring"}):(n==="const"||n==="using"||n==="await using")&&!(this.match(58)||this.isContextual(102))&&this.raise(Ne.DeclarationMissingInitializer,this.state.lastTokEndLoc,{kind:n})),s.push(this.finishNode(a,"VariableDeclarator")),!this.eat(12))break}return e}parseVarId(e,t){const n=this.parseBindingAtom();t==="using"||t==="await using"?(n.type==="ArrayPattern"||n.type==="ObjectPattern")&&this.raise(Ne.UsingDeclarationHasBindingPattern,n.loc.start):n.type==="VoidPattern"&&this.raise(Ne.UnexpectedVoidPattern,n.loc.start),this.checkLVal(n,{type:"VariableDeclarator"},t==="var"?5:8201),e.id=n}parseAsyncFunctionExpression(e){return this.parseFunction(e,8)}parseFunction(e,t=0){const n=t&2,i=!!(t&1),s=i&&!(t&4),a=!!(t&8);this.initFunction(e,a),this.match(55)&&(n&&this.raise(Ne.GeneratorInSingleStatementContext,this.state.startLoc),this.next(),e.generator=!0),i&&(e.id=this.parseFunctionId(s));const o=this.state.maybeInArrowParameters;return this.state.maybeInArrowParameters=!1,this.scope.enter(514),this.prodParam.enter(lw(a,e.generator)),i||(e.id=this.parseFunctionId()),this.parseFunctionParams(e,!1),this.withSmartMixTopicForbiddingContext(()=>{this.parseFunctionBodyAndFinish(e,i?"FunctionDeclaration":"FunctionExpression")}),this.prodParam.exit(),this.scope.exit(),i&&!n&&this.registerFunctionStatementId(e),this.state.maybeInArrowParameters=o,e}parseFunctionId(e){return e||Dn(this.state.type)?this.parseIdentifier():null}parseFunctionParams(e,t){this.expect(10),this.expressionScope.enter(mae()),e.params=this.parseBindingList(11,41,2|(t?4:0)),this.expressionScope.exit()}registerFunctionStatementId(e){e.id&&this.scope.declareName(e.id.name,!this.options.annexB||this.state.strict||e.generator||e.async?this.scope.treatFunctionsAsVar?5:8201:17,e.id.loc.start)}parseClass(e,t,n){this.next();const i=this.state.strict;return this.state.strict=!0,this.parseClassId(e,t,n),this.parseClassSuper(e),e.body=this.parseClassBody(!!e.superClass,i),this.finishNode(e,t?"ClassDeclaration":"ClassExpression")}isClassProperty(){return this.match(29)||this.match(13)||this.match(8)}isClassMethod(){return this.match(10)}nameIsConstructor(e){return e.type==="Identifier"&&e.name==="constructor"||e.type==="StringLiteral"&&e.value==="constructor"}isNonstaticConstructor(e){return!e.computed&&!e.static&&this.nameIsConstructor(e.key)}parseClassBody(e,t){this.classScope.enter();const n={hadConstructor:!1,hadSuperClass:e};let i=[];const s=this.startNode();if(s.body=[],this.expect(5),this.withSmartMixTopicForbiddingContext(()=>{for(;!this.match(8);){if(this.eat(13)){if(i.length>0)throw this.raise(Ne.DecoratorSemicolon,this.state.lastTokEndLoc);continue}if(this.match(26)){i.push(this.parseDecorator());continue}const a=this.startNode();i.length&&(a.decorators=i,this.resetStartLocationFromNode(a,i[0]),i=[]),this.parseClassMember(s,a,n),a.kind==="constructor"&&a.decorators&&a.decorators.length>0&&this.raise(Ne.DecoratorConstructor,a)}}),this.state.strict=t,this.next(),i.length)throw this.raise(Ne.TrailingDecorator,this.state.startLoc);return this.classScope.exit(),this.finishNode(s,"ClassBody")}parseClassMemberFromModifier(e,t){const n=this.parseIdentifier(!0);if(this.isClassMethod()){const i=t;return i.kind="method",i.computed=!1,i.key=n,i.static=!1,this.pushClassMethod(e,i,!1,!1,!1,!1),!0}else if(this.isClassProperty()){const i=t;return i.computed=!1,i.key=n,i.static=!1,e.body.push(this.parseClassProperty(i)),!0}return this.resetPreviousNodeTrailingComments(n),!1}parseClassMember(e,t,n){const i=this.isContextual(106);if(i){if(this.parseClassMemberFromModifier(e,t))return;if(this.eat(5)){this.parseClassStaticBlock(e,t);return}}this.parseClassMemberWithIsStatic(e,t,n,i)}parseClassMemberWithIsStatic(e,t,n,i){const s=t,a=t,o=t,u=t,f=t,g=s,y=s;if(t.static=i,this.parsePropertyNamePrefixOperator(t),this.eat(55)){g.kind="method";const V=this.match(139);if(this.parseClassElementName(g),this.parsePostMemberNameModifiers(g),V){this.pushClassPrivateMethod(e,a,!0,!1);return}this.isNonstaticConstructor(s)&&this.raise(Ne.ConstructorIsGenerator,s.key),this.pushClassMethod(e,s,!0,!1,!1,!1);return}const A=!this.state.containsEsc&&Dn(this.state.type),C=this.parseClassElementName(t),M=A?C.name:null,k=this.isPrivateName(C),D=this.state.startLoc;if(this.parsePostMemberNameModifiers(y),this.isClassMethod()){if(g.kind="method",k){this.pushClassPrivateMethod(e,a,!1,!1);return}const V=this.isNonstaticConstructor(s);let W=!1;V&&(s.kind="constructor",n.hadConstructor&&!this.hasPlugin("typescript")&&this.raise(Ne.DuplicateConstructor,C),V&&this.hasPlugin("typescript")&&t.override&&this.raise(Ne.OverrideOnConstructor,C),n.hadConstructor=!0,W=n.hadSuperClass),this.pushClassMethod(e,s,!1,!1,V,W)}else if(this.isClassProperty())k?this.pushClassPrivateProperty(e,u):this.pushClassProperty(e,o);else if(M==="async"&&!this.isLineTerminator()){this.resetPreviousNodeTrailingComments(C);const V=this.eat(55);y.optional&&this.unexpected(D),g.kind="method";const W=this.match(139);this.parseClassElementName(g),this.parsePostMemberNameModifiers(y),W?this.pushClassPrivateMethod(e,a,V,!0):(this.isNonstaticConstructor(s)&&this.raise(Ne.ConstructorIsAsync,s.key),this.pushClassMethod(e,s,V,!0,!1,!1))}else if((M==="get"||M==="set")&&!(this.match(55)&&this.isLineTerminator())){this.resetPreviousNodeTrailingComments(C),g.kind=M;const V=this.match(139);this.parseClassElementName(s),V?this.pushClassPrivateMethod(e,a,!1,!1):(this.isNonstaticConstructor(s)&&this.raise(Ne.ConstructorIsAccessor,s.key),this.pushClassMethod(e,s,!1,!1,!1,!1)),this.checkGetterSetterParams(s)}else if(M==="accessor"&&!this.isLineTerminator()){this.expectPlugin("decoratorAutoAccessors"),this.resetPreviousNodeTrailingComments(C);const V=this.match(139);this.parseClassElementName(o),this.pushClassAccessorProperty(e,f,V)}else this.isLineTerminator()?k?this.pushClassPrivateProperty(e,u):this.pushClassProperty(e,o):this.unexpected()}parseClassElementName(e){const{type:t,value:n}=this.state;if((t===132||t===134)&&e.static&&n==="prototype"&&this.raise(Ne.StaticPrototype,this.state.startLoc),t===139){n==="constructor"&&this.raise(Ne.ConstructorClassPrivateField,this.state.startLoc);const i=this.parsePrivateName();return e.key=i,i}return this.parsePropertyName(e),e.key}parseClassStaticBlock(e,t){var n;this.scope.enter(720);const i=this.state.labels;this.state.labels=[],this.prodParam.enter(0);const s=t.body=[];this.parseBlockOrModuleBlockBody(s,void 0,!1,8),this.prodParam.exit(),this.scope.exit(),this.state.labels=i,e.body.push(this.finishNode(t,"StaticBlock")),(n=t.decorators)!=null&&n.length&&this.raise(Ne.DecoratorStaticBlock,t)}pushClassProperty(e,t){!t.computed&&this.nameIsConstructor(t.key)&&this.raise(Ne.ConstructorClassField,t.key),e.body.push(this.parseClassProperty(t))}pushClassPrivateProperty(e,t){const n=this.parseClassPrivateProperty(t);e.body.push(n),this.classScope.declarePrivateName(this.getPrivateNameSV(n.key),0,n.key.loc.start)}pushClassAccessorProperty(e,t,n){!n&&!t.computed&&this.nameIsConstructor(t.key)&&this.raise(Ne.ConstructorClassField,t.key);const i=this.parseClassAccessorProperty(t);e.body.push(i),n&&this.classScope.declarePrivateName(this.getPrivateNameSV(i.key),0,i.key.loc.start)}pushClassMethod(e,t,n,i,s,a){e.body.push(this.parseMethod(t,n,i,s,a,"ClassMethod",!0))}pushClassPrivateMethod(e,t,n,i){const s=this.parseMethod(t,n,i,!1,!1,"ClassPrivateMethod",!0);e.body.push(s);const a=s.kind==="get"?s.static?6:2:s.kind==="set"?s.static?5:1:0;this.declareClassPrivateMethodInScope(s,a)}declareClassPrivateMethodInScope(e,t){this.classScope.declarePrivateName(this.getPrivateNameSV(e.key),t,e.key.loc.start)}parsePostMemberNameModifiers(e){}parseClassPrivateProperty(e){return this.parseInitializer(e),this.semicolon(),this.finishNode(e,"ClassPrivateProperty")}parseClassProperty(e){return this.parseInitializer(e),this.semicolon(),this.finishNode(e,"ClassProperty")}parseClassAccessorProperty(e){return this.parseInitializer(e),this.semicolon(),this.finishNode(e,"ClassAccessorProperty")}parseInitializer(e){this.scope.enter(592),this.expressionScope.enter(M7()),this.prodParam.enter(0),e.value=this.eat(29)?this.parseMaybeAssignAllowIn():null,this.expressionScope.exit(),this.prodParam.exit(),this.scope.exit()}parseClassId(e,t,n,i=8331){if(Dn(this.state.type))e.id=this.parseIdentifier(),t&&this.declareNameFromIdentifier(e.id,i);else if(n||!t)e.id=null;else throw this.raise(Ne.MissingClassName,this.state.startLoc)}parseClassSuper(e){e.superClass=this.eat(81)?this.parseExprSubscripts():null}parseExport(e,t){const n=this.parseMaybeImportPhase(e,!0),i=this.maybeParseExportDefaultSpecifier(e,n),s=!i||this.eat(12),a=s&&this.eatExportStar(e),o=a&&this.maybeParseExportNamespaceSpecifier(e),u=s&&(!o||this.eat(12)),f=i||a;if(a&&!o){if(i&&this.unexpected(),t)throw this.raise(Ne.UnsupportedDecoratorExport,e);return this.parseExportFrom(e,!0),this.sawUnambiguousESM=!0,this.finishNode(e,"ExportAllDeclaration")}const g=this.maybeParseExportNamedSpecifiers(e);i&&s&&!a&&!g&&this.unexpected(null,5),o&&u&&this.unexpected(null,98);let y;if(f||g){if(y=!1,t)throw this.raise(Ne.UnsupportedDecoratorExport,e);this.parseExportFrom(e,f)}else y=this.maybeParseExportDeclaration(e);if(f||g||y){var A;const C=e;if(this.checkExport(C,!0,!1,!!C.source),((A=C.declaration)==null?void 0:A.type)==="ClassDeclaration")this.maybeTakeDecorators(t,C.declaration,C);else if(t)throw this.raise(Ne.UnsupportedDecoratorExport,e);return this.sawUnambiguousESM=!0,this.finishNode(C,"ExportNamedDeclaration")}if(this.eat(65)){const C=e,M=this.parseExportDefaultExpression();if(C.declaration=M,M.type==="ClassDeclaration")this.maybeTakeDecorators(t,M,C);else if(t)throw this.raise(Ne.UnsupportedDecoratorExport,e);return this.checkExport(C,!0,!0),this.sawUnambiguousESM=!0,this.finishNode(C,"ExportDefaultDeclaration")}throw this.unexpected(null,5)}eatExportStar(e){return this.eat(55)}maybeParseExportDefaultSpecifier(e,t){if(t||this.isExportDefaultSpecifier()){this.expectPlugin("exportDefaultFrom",t?.loc.start);const n=t||this.parseIdentifier(!0),i=this.startNodeAtNode(n);return i.exported=n,e.specifiers=[this.finishNode(i,"ExportDefaultSpecifier")],!0}return!1}maybeParseExportNamespaceSpecifier(e){if(this.isContextual(93)){var t,n;(n=(t=e).specifiers)!=null||(t.specifiers=[]);const i=this.startNodeAt(this.state.lastTokStartLoc);return this.next(),i.exported=this.parseModuleExportName(),e.specifiers.push(this.finishNode(i,"ExportNamespaceSpecifier")),!0}return!1}maybeParseExportNamedSpecifiers(e){if(this.match(5)){const t=e;t.specifiers||(t.specifiers=[]);const n=t.exportKind==="type";return t.specifiers.push(...this.parseExportSpecifiers(n)),t.source=null,this.hasPlugin("importAssertions")?t.assertions=[]:t.attributes=[],t.declaration=null,!0}return!1}maybeParseExportDeclaration(e){return this.shouldParseExportDeclaration()?(e.specifiers=[],e.source=null,this.hasPlugin("importAssertions")?e.assertions=[]:e.attributes=[],e.declaration=this.parseExportDeclaration(e),!0):!1}isAsyncFunction(){if(!this.isContextual(95))return!1;const e=this.nextTokenInLineStart();return this.isUnparsedContextual(e,"function")}parseExportDefaultExpression(){const e=this.startNode();if(this.match(68))return this.next(),this.parseFunction(e,5);if(this.isAsyncFunction())return this.next(),this.next(),this.parseFunction(e,13);if(this.match(80))return this.parseClass(e,!0,!0);if(this.match(26))return this.hasPlugin("decorators")&&this.getPluginOption("decorators","decoratorsBeforeExport")===!0&&this.raise(Ne.DecoratorBeforeExport,this.state.startLoc),this.parseClass(this.maybeTakeDecorators(this.parseDecorators(!1),this.startNode()),!0,!0);if(this.match(75)||this.match(74)||this.isLet()||this.isUsing()||this.isAwaitUsing())throw this.raise(Ne.UnsupportedDefaultExport,this.state.startLoc);const t=this.parseMaybeAssignAllowIn();return this.semicolon(),t}parseExportDeclaration(e){return this.match(80)?this.parseClass(this.startNode(),!0,!1):this.parseStatementListItem()}isExportDefaultSpecifier(){const{type:e}=this.state;if(Dn(e)){if(e===95&&!this.state.containsEsc||e===100)return!1;if((e===130||e===129)&&!this.state.containsEsc){const i=this.nextTokenStart(),s=this.input.charCodeAt(i);if(s===123||this.chStartsBindingIdentifier(s,i)&&!this.input.startsWith("from",i))return this.expectOnePlugin(["flow","typescript"]),!1}}else if(!this.match(65))return!1;const t=this.nextTokenStart(),n=this.isUnparsedContextual(t,"from");if(this.input.charCodeAt(t)===44||Dn(this.state.type)&&n)return!0;if(this.match(65)&&n){const i=this.input.charCodeAt(this.nextTokenStartSince(t+4));return i===34||i===39}return!1}parseExportFrom(e,t){this.eatContextual(98)?(e.source=this.parseImportSource(),this.checkExport(e),this.maybeParseImportAttributes(e),this.checkJSONModuleImport(e)):t&&this.unexpected(),this.semicolon()}shouldParseExportDeclaration(){const{type:e}=this.state;return e===26&&(this.expectOnePlugin(["decorators","decorators-legacy"]),this.hasPlugin("decorators"))?(this.getPluginOption("decorators","decoratorsBeforeExport")===!0&&this.raise(Ne.DecoratorBeforeExport,this.state.startLoc),!0):this.isUsing()?(this.raise(Ne.UsingDeclarationExport,this.state.startLoc),!0):this.isAwaitUsing()?(this.raise(Ne.UsingDeclarationExport,this.state.startLoc),!0):e===74||e===75||e===68||e===80||this.isLet()||this.isAsyncFunction()}checkExport(e,t,n,i){if(t){var s;if(n){if(this.checkDuplicateExports(e,"default"),this.hasPlugin("exportDefaultFrom")){var a;const o=e.declaration;o.type==="Identifier"&&o.name==="from"&&o.end-o.start===4&&!((a=o.extra)!=null&&a.parenthesized)&&this.raise(Ne.ExportDefaultFromAsIdentifier,o)}}else if((s=e.specifiers)!=null&&s.length)for(const o of e.specifiers){const{exported:u}=o,f=u.type==="Identifier"?u.name:u.value;if(this.checkDuplicateExports(o,f),!i&&o.local){const{local:g}=o;g.type!=="Identifier"?this.raise(Ne.ExportBindingIsString,o,{localName:g.value,exportName:f}):(this.checkReservedWord(g.name,g.loc.start,!0,!1),this.scope.checkLocalExport(g))}}else if(e.declaration){const o=e.declaration;if(o.type==="FunctionDeclaration"||o.type==="ClassDeclaration"){const{id:u}=o;if(!u)throw new Error("Assertion failure");this.checkDuplicateExports(e,u.name)}else if(o.type==="VariableDeclaration")for(const u of o.declarations)this.checkDeclaration(u.id)}}}checkDeclaration(e){if(e.type==="Identifier")this.checkDuplicateExports(e,e.name);else if(e.type==="ObjectPattern")for(const t of e.properties)this.checkDeclaration(t);else if(e.type==="ArrayPattern")for(const t of e.elements)t&&this.checkDeclaration(t);else e.type==="ObjectProperty"?this.checkDeclaration(e.value):e.type==="RestElement"?this.checkDeclaration(e.argument):e.type==="AssignmentPattern"&&this.checkDeclaration(e.left)}checkDuplicateExports(e,t){this.exportedIdentifiers.has(t)&&(t==="default"?this.raise(Ne.DuplicateDefaultExport,e):this.raise(Ne.DuplicateExport,e,{exportName:t})),this.exportedIdentifiers.add(t)}parseExportSpecifiers(e){const t=[];let n=!0;for(this.expect(5);!this.eat(8);){if(n)n=!1;else if(this.expect(12),this.eat(8))break;const i=this.isContextual(130),s=this.match(134),a=this.startNode();a.local=this.parseModuleExportName(),t.push(this.parseExportSpecifier(a,s,e,i))}return t}parseExportSpecifier(e,t,n,i){return this.eatContextual(93)?e.exported=this.parseModuleExportName():t?e.exported=this.cloneStringLiteral(e.local):e.exported||(e.exported=this.cloneIdentifier(e.local)),this.finishNode(e,"ExportSpecifier")}parseModuleExportName(){if(this.match(134)){const e=this.parseStringLiteral(this.state.value),t=Dae.exec(e.value);return t&&this.raise(Ne.ModuleExportNameHasLoneSurrogate,e,{surrogateCharCode:t[0].charCodeAt(0)}),e}return this.parseIdentifier(!0)}isJSONModuleImport(e){return e.assertions!=null?e.assertions.some(({key:t,value:n})=>n.value==="json"&&(t.type==="Identifier"?t.name==="type":t.value==="type")):!1}checkImportReflection(e){const{specifiers:t}=e,n=t.length===1?t[0].type:null;if(e.phase==="source")n!=="ImportDefaultSpecifier"&&this.raise(Ne.SourcePhaseImportRequiresDefault,t[0].loc.start);else if(e.phase==="defer")n!=="ImportNamespaceSpecifier"&&this.raise(Ne.DeferImportRequiresNamespace,t[0].loc.start);else if(e.module){var i;n!=="ImportDefaultSpecifier"&&this.raise(Ne.ImportReflectionNotBinding,t[0].loc.start),((i=e.assertions)==null?void 0:i.length)>0&&this.raise(Ne.ImportReflectionHasAssertion,t[0].loc.start)}}checkJSONModuleImport(e){if(this.isJSONModuleImport(e)&&e.type!=="ExportAllDeclaration"){const{specifiers:t}=e;if(t!=null){const n=t.find(i=>{let s;if(i.type==="ExportSpecifier"?s=i.local:i.type==="ImportSpecifier"&&(s=i.imported),s!==void 0)return s.type==="Identifier"?s.name!=="default":s.value!=="default"});n!==void 0&&this.raise(Ne.ImportJSONBindingNotDefault,n.loc.start)}}}isPotentialImportPhase(e){return e?!1:this.isContextual(105)||this.isContextual(97)||this.isContextual(127)}applyImportPhase(e,t,n,i){t||(n==="module"?(this.expectPlugin("importReflection",i),e.module=!0):this.hasPlugin("importReflection")&&(e.module=!1),n==="source"?(this.expectPlugin("sourcePhaseImports",i),e.phase="source"):n==="defer"?(this.expectPlugin("deferredImportEvaluation",i),e.phase="defer"):this.hasPlugin("sourcePhaseImports")&&(e.phase=null))}parseMaybeImportPhase(e,t){if(!this.isPotentialImportPhase(t))return this.applyImportPhase(e,t,null),null;const n=this.startNode(),i=this.parseIdentifierName(!0),{type:s}=this.state;return(Wl(s)?s!==98||this.lookaheadCharCode()===102:s!==12)?(this.applyImportPhase(e,t,i,n.loc.start),null):(this.applyImportPhase(e,t,null),this.createIdentifier(n,i))}isPrecedingIdImportPhase(e){const{type:t}=this.state;return Dn(t)?t!==98||this.lookaheadCharCode()===102:t!==12}parseImport(e){return this.match(134)?this.parseImportSourceAndAttributes(e):this.parseImportSpecifiersAndAfter(e,this.parseMaybeImportPhase(e,!1))}parseImportSpecifiersAndAfter(e,t){e.specifiers=[];const i=!this.maybeParseDefaultImportSpecifier(e,t)||this.eat(12),s=i&&this.maybeParseStarImportSpecifier(e);return i&&!s&&this.parseNamedImportSpecifiers(e),this.expectContextual(98),this.parseImportSourceAndAttributes(e)}parseImportSourceAndAttributes(e){var t;return(t=e.specifiers)!=null||(e.specifiers=[]),e.source=this.parseImportSource(),this.maybeParseImportAttributes(e),this.checkImportReflection(e),this.checkJSONModuleImport(e),this.semicolon(),this.sawUnambiguousESM=!0,this.finishNode(e,"ImportDeclaration")}parseImportSource(){return this.match(134)||this.unexpected(),this.parseExprAtom()}parseImportSpecifierLocal(e,t,n){t.local=this.parseIdentifier(),e.specifiers.push(this.finishImportSpecifier(t,n))}finishImportSpecifier(e,t,n=8201){return this.checkLVal(e.local,{type:t},n),this.finishNode(e,t)}parseImportAttributes(){this.expect(5);const e=[],t=new Set;do{if(this.match(8))break;const n=this.startNode(),i=this.state.value;if(t.has(i)&&this.raise(Ne.ModuleAttributesWithDuplicateKeys,this.state.startLoc,{key:i}),t.add(i),this.match(134)?n.key=this.parseStringLiteral(i):n.key=this.parseIdentifier(!0),this.expect(14),!this.match(134))throw this.raise(Ne.ModuleAttributeInvalidValue,this.state.startLoc);n.value=this.parseStringLiteral(this.state.value),e.push(this.finishNode(n,"ImportAttribute"))}while(this.eat(12));return this.expect(8),e}parseModuleAttributes(){const e=[],t=new Set;do{const n=this.startNode();if(n.key=this.parseIdentifier(!0),n.key.name!=="type"&&this.raise(Ne.ModuleAttributeDifferentFromType,n.key),t.has(n.key.name)&&this.raise(Ne.ModuleAttributesWithDuplicateKeys,n.key,{key:n.key.name}),t.add(n.key.name),this.expect(14),!this.match(134))throw this.raise(Ne.ModuleAttributeInvalidValue,this.state.startLoc);n.value=this.parseStringLiteral(this.state.value),e.push(this.finishNode(n,"ImportAttribute"))}while(this.eat(12));return e}maybeParseImportAttributes(e){let t;var n=!1;if(this.match(76)){if(this.hasPrecedingLineBreak()&&this.lookaheadCharCode()===40)return;this.next(),this.hasPlugin("moduleAttributes")?(t=this.parseModuleAttributes(),this.addExtra(e,"deprecatedWithLegacySyntax",!0)):t=this.parseImportAttributes(),n=!0}else this.isContextual(94)&&!this.hasPrecedingLineBreak()?(!this.hasPlugin("deprecatedImportAssert")&&!this.hasPlugin("importAssertions")&&this.raise(Ne.ImportAttributesUseAssert,this.state.startLoc),this.hasPlugin("importAssertions")||this.addExtra(e,"deprecatedAssertSyntax",!0),this.next(),t=this.parseImportAttributes()):t=[];!n&&this.hasPlugin("importAssertions")?e.assertions=t:e.attributes=t}maybeParseDefaultImportSpecifier(e,t){if(t){const n=this.startNodeAtNode(t);return n.local=t,e.specifiers.push(this.finishImportSpecifier(n,"ImportDefaultSpecifier")),!0}else if(Wl(this.state.type))return this.parseImportSpecifierLocal(e,this.startNode(),"ImportDefaultSpecifier"),!0;return!1}maybeParseStarImportSpecifier(e){if(this.match(55)){const t=this.startNode();return this.next(),this.expectContextual(93),this.parseImportSpecifierLocal(e,t,"ImportNamespaceSpecifier"),!0}return!1}parseNamedImportSpecifiers(e){let t=!0;for(this.expect(5);!this.eat(8);){if(t)t=!1;else{if(this.eat(14))throw this.raise(Ne.DestructureNamedImport,this.state.startLoc);if(this.expect(12),this.eat(8))break}const n=this.startNode(),i=this.match(134),s=this.isContextual(130);n.imported=this.parseModuleExportName();const a=this.parseImportSpecifier(n,i,e.importKind==="type"||e.importKind==="typeof",s,void 0);e.specifiers.push(a)}}parseImportSpecifier(e,t,n,i,s){if(this.eatContextual(93))e.local=this.parseIdentifier();else{const{imported:a}=e;if(t)throw this.raise(Ne.ImportBindingIsString,e,{importName:a.value});this.checkReservedWord(a.name,e.loc.start,!0,!0),e.local||(e.local=this.cloneIdentifier(a))}return this.finishImportSpecifier(e,"ImportSpecifier",s)}isThisParam(e){return e.type==="Identifier"&&e.name==="this"}}class D7 extends Nae{constructor(e,t,n){const i=_oe(e);super(i,t),this.options=i,this.initializeScopes(),this.plugins=n,this.filename=i.sourceFilename,this.startIndex=i.startIndex;let s=0;i.allowAwaitOutsideFunction&&(s|=1),i.allowReturnOutsideFunction&&(s|=2),i.allowImportExportEverywhere&&(s|=8),i.allowSuperOutsideMethod&&(s|=16),i.allowUndeclaredExports&&(s|=64),i.allowNewTargetOutsideFunction&&(s|=4),i.allowYieldOutsideFunction&&(s|=32),i.ranges&&(s|=128),i.tokens&&(s|=256),i.createImportExpressions&&(s|=512),i.createParenthesizedExpressions&&(s|=1024),i.errorRecovery&&(s|=2048),i.attachComment&&(s|=4096),i.annexB&&(s|=8192),this.optionFlags=s}getScopeHandler(){return JR}parse(){this.enterInitialScopes();const e=this.startNode(),t=this.startNode();this.nextToken(),e.errors=null;const n=this.parseTopLevel(e,t);return n.errors=this.state.errors,n.comments.length=this.state.commentsLen,n}}function Fae(r,e){var t;if(((t=e)==null?void 0:t.sourceType)==="unambiguous"){e=Object.assign({},e);try{e.sourceType="module";const n=A0(e,r),i=n.parse();if(n.sawUnambiguousESM)return i;if(n.ambiguousScriptDifferentAst)try{return e.sourceType="script",A0(e,r).parse()}catch{}else i.program.sourceType="script";return i}catch(n){try{return e.sourceType="script",A0(e,r).parse()}catch{}throw n}}else return A0(e,r).parse()}function Uae(r,e){const t=A0(e,r);return t.options.strictMode&&(t.state.strict=!0),t.getExpression()}function zae(r){const e={};for(const t of Object.keys(r))e[t]=Bu(r[t]);return e}const Vae=zae(woe);function A0(r,e){let t=D7;const n=new Map;if(r!=null&&r.plugins){for(const i of r.plugins){let s,a;typeof i=="string"?s=i:[s,a]=i,n.has(s)||n.set(s,a||{})}Mae(n),t=$ae(n)}return new t(r,e,n)}const p4=new Map;function $ae(r){const e=[];for(const i of Rae)r.has(i)&&e.push(i);const t=e.join("|");let n=p4.get(t);if(!n){n=D7;for(const i of e)n=O7[i](n);p4.set(t,n)}return n}Gv.parse=Fae;Gv.parseExpression=Uae;Gv.tokTypes=Vae;var k3={exports:{}};(function(r,e){(function(t,n){n(e)})(Xw,function(t){class n{constructor(){this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.context={skip:()=>this.should_skip=!0,remove:()=>this.should_remove=!0,replace:f=>this.replacement=f}}replace(f,g,y,A){f&&(y!==null?f[g][y]=A:f[g]=A)}remove(f,g,y){f&&(y!==null?f[g].splice(y,1):delete f[g])}}class i extends n{constructor(f,g){super(),this.enter=f,this.leave=g}visit(f,g,y,A){if(f){if(this.enter){const C=this.should_skip,M=this.should_remove,k=this.replacement;this.should_skip=!1,this.should_remove=!1,this.replacement=null,this.enter.call(this.context,f,g,y,A),this.replacement&&(f=this.replacement,this.replace(g,y,A,f)),this.should_remove&&this.remove(g,y,A);const D=this.should_skip,V=this.should_remove;if(this.should_skip=C,this.should_remove=M,this.replacement=k,D)return f;if(V)return null}for(const C in f){const M=f[C];if(typeof M=="object")if(Array.isArray(M))for(let k=0;k<M.length;k+=1)M[k]!==null&&typeof M[k].type=="string"&&(this.visit(M[k],f,C,k)||k--);else M!==null&&typeof M.type=="string"&&this.visit(M,f,C,null)}if(this.leave){const C=this.replacement,M=this.should_remove;this.replacement=null,this.should_remove=!1,this.leave.call(this.context,f,g,y,A),this.replacement&&(f=this.replacement,this.replace(g,y,A,f)),this.should_remove&&this.remove(g,y,A);const k=this.should_remove;if(this.replacement=C,this.should_remove=M,k)return null}}return f}}class s extends n{constructor(f,g){super(),this.enter=f,this.leave=g}async visit(f,g,y,A){if(f){if(this.enter){const C=this.should_skip,M=this.should_remove,k=this.replacement;this.should_skip=!1,this.should_remove=!1,this.replacement=null,await this.enter.call(this.context,f,g,y,A),this.replacement&&(f=this.replacement,this.replace(g,y,A,f)),this.should_remove&&this.remove(g,y,A);const D=this.should_skip,V=this.should_remove;if(this.should_skip=C,this.should_remove=M,this.replacement=k,D)return f;if(V)return null}for(const C in f){const M=f[C];if(typeof M=="object")if(Array.isArray(M))for(let k=0;k<M.length;k+=1)M[k]!==null&&typeof M[k].type=="string"&&(await this.visit(M[k],f,C,k)||k--);else M!==null&&typeof M.type=="string"&&await this.visit(M,f,C,null)}if(this.leave){const C=this.replacement,M=this.should_remove;this.replacement=null,this.should_remove=!1,await this.leave.call(this.context,f,g,y,A),this.replacement&&(f=this.replacement,this.replace(g,y,A,f)),this.should_remove&&this.remove(g,y,A);const k=this.should_remove;if(this.replacement=C,this.should_remove=M,k)return null}}return f}}function a(u,{enter:f,leave:g}){return new i(f,g).visit(u,null)}async function o(u,{enter:f,leave:g}){return await new s(f,g).visit(u,null)}t.asyncWalk=o,t.walk=a,Object.defineProperty(t,"__esModule",{value:!0})})})(k3,k3.exports);var jae=k3.exports,iS={},YR={},sS={},ZR={},g4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");ZR.encode=function(r){if(0<=r&&r<g4.length)return g4[r];throw new TypeError("Must be between 0 and 63: "+r)};ZR.decode=function(r){var e=65,t=90,n=97,i=122,s=48,a=57,o=43,u=47,f=26,g=52;return e<=r&&r<=t?r-e:n<=r&&r<=i?r-n+f:s<=r&&r<=a?r-s+g:r==o?62:r==u?63:-1};var L7=ZR,QR=5,N7=1<<QR,F7=N7-1,U7=N7;function Gae(r){return r<0?(-r<<1)+1:(r<<1)+0}function Hae(r){var e=(r&1)===1,t=r>>1;return e?-t:t}sS.encode=function(e){var t="",n,i=Gae(e);do n=i&F7,i>>>=QR,i>0&&(n|=U7),t+=L7.encode(n);while(i>0);return t};sS.decode=function(e,t,n){var i=e.length,s=0,a=0,o,u;do{if(t>=i)throw new Error("Expected more digits in base 64 VLQ value.");if(u=L7.decode(e.charCodeAt(t++)),u===-1)throw new Error("Invalid base64 digit: "+e.charAt(t-1));o=!!(u&U7),u&=F7,s=s+(u<<a),a+=QR}while(o);n.value=Hae(s),n.rest=t};var vy={};(function(r){function e(se,Y,ce){if(Y in se)return se[Y];if(arguments.length===3)return ce;throw new Error('"'+Y+'" is a required argument.')}r.getArg=e;var t=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,n=/^data:.+\,.+$/;function i(se){var Y=se.match(t);return Y?{scheme:Y[1],auth:Y[2],host:Y[3],port:Y[4],path:Y[5]}:null}r.urlParse=i;function s(se){var Y="";return se.scheme&&(Y+=se.scheme+":"),Y+="//",se.auth&&(Y+=se.auth+"@"),se.host&&(Y+=se.host),se.port&&(Y+=":"+se.port),se.path&&(Y+=se.path),Y}r.urlGenerate=s;var a=32;function o(se){var Y=[];return function(ce){for(var oe=0;oe<Y.length;oe++)if(Y[oe].input===ce){var Me=Y[0];return Y[0]=Y[oe],Y[oe]=Me,Y[0].result}var ze=se(ce);return Y.unshift({input:ce,result:ze}),Y.length>a&&Y.pop(),ze}}var u=o(function(Y){var ce=Y,oe=i(Y);if(oe){if(!oe.path)return Y;ce=oe.path}for(var Me=r.isAbsolute(ce),ze=[],Ve=0,lt=0;;)if(Ve=lt,lt=ce.indexOf("/",Ve),lt===-1){ze.push(ce.slice(Ve));break}else for(ze.push(ce.slice(Ve,lt));lt<ce.length&&ce[lt]==="/";)lt++;for(var gt,At=0,lt=ze.length-1;lt>=0;lt--)gt=ze[lt],gt==="."?ze.splice(lt,1):gt===".."?At++:At>0&&(gt===""?(ze.splice(lt+1,At),At=0):(ze.splice(lt,2),At--));return ce=ze.join("/"),ce===""&&(ce=Me?"/":"."),oe?(oe.path=ce,s(oe)):ce});r.normalize=u;function f(se,Y){se===""&&(se="."),Y===""&&(Y=".");var ce=i(Y),oe=i(se);if(oe&&(se=oe.path||"/"),ce&&!ce.scheme)return oe&&(ce.scheme=oe.scheme),s(ce);if(ce||Y.match(n))return Y;if(oe&&!oe.host&&!oe.path)return oe.host=Y,s(oe);var Me=Y.charAt(0)==="/"?Y:u(se.replace(/\/+$/,"")+"/"+Y);return oe?(oe.path=Me,s(oe)):Me}r.join=f,r.isAbsolute=function(se){return se.charAt(0)==="/"||t.test(se)};function g(se,Y){se===""&&(se="."),se=se.replace(/\/$/,"");for(var ce=0;Y.indexOf(se+"/")!==0;){var oe=se.lastIndexOf("/");if(oe<0||(se=se.slice(0,oe),se.match(/^([^\/]+:\/)?\/*$/)))return Y;++ce}return Array(ce+1).join("../")+Y.substr(se.length+1)}r.relative=g;var y=function(){var se=Object.create(null);return!("__proto__"in se)}();function A(se){return se}function C(se){return k(se)?"$"+se:se}r.toSetString=y?A:C;function M(se){return k(se)?se.slice(1):se}r.fromSetString=y?A:M;function k(se){if(!se)return!1;var Y=se.length;if(Y<9||se.charCodeAt(Y-1)!==95||se.charCodeAt(Y-2)!==95||se.charCodeAt(Y-3)!==111||se.charCodeAt(Y-4)!==116||se.charCodeAt(Y-5)!==111||se.charCodeAt(Y-6)!==114||se.charCodeAt(Y-7)!==112||se.charCodeAt(Y-8)!==95||se.charCodeAt(Y-9)!==95)return!1;for(var ce=Y-10;ce>=0;ce--)if(se.charCodeAt(ce)!==36)return!1;return!0}function D(se,Y,ce){var oe=$(se.source,Y.source);return oe!==0||(oe=se.originalLine-Y.originalLine,oe!==0)||(oe=se.originalColumn-Y.originalColumn,oe!==0||ce)||(oe=se.generatedColumn-Y.generatedColumn,oe!==0)||(oe=se.generatedLine-Y.generatedLine,oe!==0)?oe:$(se.name,Y.name)}r.compareByOriginalPositions=D;function V(se,Y,ce){var oe;return oe=se.originalLine-Y.originalLine,oe!==0||(oe=se.originalColumn-Y.originalColumn,oe!==0||ce)||(oe=se.generatedColumn-Y.generatedColumn,oe!==0)||(oe=se.generatedLine-Y.generatedLine,oe!==0)?oe:$(se.name,Y.name)}r.compareByOriginalPositionsNoSource=V;function W(se,Y,ce){var oe=se.generatedLine-Y.generatedLine;return oe!==0||(oe=se.generatedColumn-Y.generatedColumn,oe!==0||ce)||(oe=$(se.source,Y.source),oe!==0)||(oe=se.originalLine-Y.originalLine,oe!==0)||(oe=se.originalColumn-Y.originalColumn,oe!==0)?oe:$(se.name,Y.name)}r.compareByGeneratedPositionsDeflated=W;function z(se,Y,ce){var oe=se.generatedColumn-Y.generatedColumn;return oe!==0||ce||(oe=$(se.source,Y.source),oe!==0)||(oe=se.originalLine-Y.originalLine,oe!==0)||(oe=se.originalColumn-Y.originalColumn,oe!==0)?oe:$(se.name,Y.name)}r.compareByGeneratedPositionsDeflatedNoLine=z;function $(se,Y){return se===Y?0:se===null?1:Y===null?-1:se>Y?1:-1}function te(se,Y){var ce=se.generatedLine-Y.generatedLine;return ce!==0||(ce=se.generatedColumn-Y.generatedColumn,ce!==0)||(ce=$(se.source,Y.source),ce!==0)||(ce=se.originalLine-Y.originalLine,ce!==0)||(ce=se.originalColumn-Y.originalColumn,ce!==0)?ce:$(se.name,Y.name)}r.compareByGeneratedPositionsInflated=te;function le(se){return JSON.parse(se.replace(/^\)]}'[^\n]*\n/,""))}r.parseSourceMapInput=le;function _e(se,Y,ce){if(Y=Y||"",se&&(se[se.length-1]!=="/"&&Y[0]!=="/"&&(se+="/"),Y=se+Y),ce){var oe=i(ce);if(!oe)throw new Error("sourceMapURL could not be parsed");if(oe.path){var Me=oe.path.lastIndexOf("/");Me>=0&&(oe.path=oe.path.substring(0,Me+1))}Y=f(s(oe),Y)}return u(Y)}r.computeSourceURL=_e})(vy);var ek={},tk=vy,rk=Object.prototype.hasOwnProperty,Wf=typeof Map<"u";function Xu(){this._array=[],this._set=Wf?new Map:Object.create(null)}Xu.fromArray=function(e,t){for(var n=new Xu,i=0,s=e.length;i<s;i++)n.add(e[i],t);return n};Xu.prototype.size=function(){return Wf?this._set.size:Object.getOwnPropertyNames(this._set).length};Xu.prototype.add=function(e,t){var n=Wf?e:tk.toSetString(e),i=Wf?this.has(e):rk.call(this._set,n),s=this._array.length;(!i||t)&&this._array.push(e),i||(Wf?this._set.set(e,s):this._set[n]=s)};Xu.prototype.has=function(e){if(Wf)return this._set.has(e);var t=tk.toSetString(e);return rk.call(this._set,t)};Xu.prototype.indexOf=function(e){if(Wf){var t=this._set.get(e);if(t>=0)return t}else{var n=tk.toSetString(e);if(rk.call(this._set,n))return this._set[n]}throw new Error('"'+e+'" is not in the set.')};Xu.prototype.at=function(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)};Xu.prototype.toArray=function(){return this._array.slice()};ek.ArraySet=Xu;var z7={},V7=vy;function Wae(r,e){var t=r.generatedLine,n=e.generatedLine,i=r.generatedColumn,s=e.generatedColumn;return n>t||n==t&&s>=i||V7.compareByGeneratedPositionsInflated(r,e)<=0}function oS(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}oS.prototype.unsortedForEach=function(e,t){this._array.forEach(e,t)};oS.prototype.add=function(e){Wae(this._last,e)?(this._last=e,this._array.push(e)):(this._sorted=!1,this._array.push(e))};oS.prototype.toArray=function(){return this._sorted||(this._array.sort(V7.compareByGeneratedPositionsInflated),this._sorted=!0),this._array};z7.MappingList=oS;var Xb=sS,ts=vy,fC=ek.ArraySet,Kae=z7.MappingList;function _l(r){r||(r={}),this._file=ts.getArg(r,"file",null),this._sourceRoot=ts.getArg(r,"sourceRoot",null),this._skipValidation=ts.getArg(r,"skipValidation",!1),this._ignoreInvalidMapping=ts.getArg(r,"ignoreInvalidMapping",!1),this._sources=new fC,this._names=new fC,this._mappings=new Kae,this._sourcesContents=null}_l.prototype._version=3;_l.fromSourceMap=function(e,t){var n=e.sourceRoot,i=new _l(Object.assign(t||{},{file:e.file,sourceRoot:n}));return e.eachMapping(function(s){var a={generated:{line:s.generatedLine,column:s.generatedColumn}};s.source!=null&&(a.source=s.source,n!=null&&(a.source=ts.relative(n,a.source)),a.original={line:s.originalLine,column:s.originalColumn},s.name!=null&&(a.name=s.name)),i.addMapping(a)}),e.sources.forEach(function(s){var a=s;n!==null&&(a=ts.relative(n,s)),i._sources.has(a)||i._sources.add(a);var o=e.sourceContentFor(s);o!=null&&i.setSourceContent(s,o)}),i};_l.prototype.addMapping=function(e){var t=ts.getArg(e,"generated"),n=ts.getArg(e,"original",null),i=ts.getArg(e,"source",null),s=ts.getArg(e,"name",null);!this._skipValidation&&this._validateMapping(t,n,i,s)===!1||(i!=null&&(i=String(i),this._sources.has(i)||this._sources.add(i)),s!=null&&(s=String(s),this._names.has(s)||this._names.add(s)),this._mappings.add({generatedLine:t.line,generatedColumn:t.column,originalLine:n!=null&&n.line,originalColumn:n!=null&&n.column,source:i,name:s}))};_l.prototype.setSourceContent=function(e,t){var n=e;this._sourceRoot!=null&&(n=ts.relative(this._sourceRoot,n)),t!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[ts.toSetString(n)]=t):this._sourcesContents&&(delete this._sourcesContents[ts.toSetString(n)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))};_l.prototype.applySourceMap=function(e,t,n){var i=t;if(t==null){if(e.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);i=e.file}var s=this._sourceRoot;s!=null&&(i=ts.relative(s,i));var a=new fC,o=new fC;this._mappings.unsortedForEach(function(u){if(u.source===i&&u.originalLine!=null){var f=e.originalPositionFor({line:u.originalLine,column:u.originalColumn});f.source!=null&&(u.source=f.source,n!=null&&(u.source=ts.join(n,u.source)),s!=null&&(u.source=ts.relative(s,u.source)),u.originalLine=f.line,u.originalColumn=f.column,f.name!=null&&(u.name=f.name))}var g=u.source;g!=null&&!a.has(g)&&a.add(g);var y=u.name;y!=null&&!o.has(y)&&o.add(y)},this),this._sources=a,this._names=o,e.sources.forEach(function(u){var f=e.sourceContentFor(u);f!=null&&(n!=null&&(u=ts.join(n,u)),s!=null&&(u=ts.relative(s,u)),this.setSourceContent(u,f))},this)};_l.prototype._validateMapping=function(e,t,n,i){if(t&&typeof t.line!="number"&&typeof t.column!="number"){var s="original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.";if(this._ignoreInvalidMapping)return typeof console<"u"&&console.warn&&console.warn(s),!1;throw new Error(s)}if(!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0&&!t&&!n&&!i)){if(e&&"line"in e&&"column"in e&&t&&"line"in t&&"column"in t&&e.line>0&&e.column>=0&&t.line>0&&t.column>=0&&n)return;var s="Invalid mapping: "+JSON.stringify({generated:e,source:n,original:t,name:i});if(this._ignoreInvalidMapping)return typeof console<"u"&&console.warn&&console.warn(s),!1;throw new Error(s)}};_l.prototype._serializeMappings=function(){for(var e=0,t=1,n=0,i=0,s=0,a=0,o="",u,f,g,y,A=this._mappings.toArray(),C=0,M=A.length;C<M;C++){if(f=A[C],u="",f.generatedLine!==t)for(e=0;f.generatedLine!==t;)u+=";",t++;else if(C>0){if(!ts.compareByGeneratedPositionsInflated(f,A[C-1]))continue;u+=","}u+=Xb.encode(f.generatedColumn-e),e=f.generatedColumn,f.source!=null&&(y=this._sources.indexOf(f.source),u+=Xb.encode(y-a),a=y,u+=Xb.encode(f.originalLine-1-i),i=f.originalLine-1,u+=Xb.encode(f.originalColumn-n),n=f.originalColumn,f.name!=null&&(g=this._names.indexOf(f.name),u+=Xb.encode(g-s),s=g)),o+=u}return o};_l.prototype._generateSourcesContent=function(e,t){return e.map(function(n){if(!this._sourcesContents)return null;t!=null&&(n=ts.relative(t,n));var i=ts.toSetString(n);return Object.prototype.hasOwnProperty.call(this._sourcesContents,i)?this._sourcesContents[i]:null},this)};_l.prototype.toJSON=function(){var e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(e.file=this._file),this._sourceRoot!=null&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e};_l.prototype.toString=function(){return JSON.stringify(this.toJSON())};YR.SourceMapGenerator=_l;var aS={},$7={};(function(r){r.GREATEST_LOWER_BOUND=1,r.LEAST_UPPER_BOUND=2;function e(t,n,i,s,a,o){var u=Math.floor((n-t)/2)+t,f=a(i,s[u],!0);return f===0?u:f>0?n-u>1?e(u,n,i,s,a,o):o==r.LEAST_UPPER_BOUND?n<s.length?n:-1:u:u-t>1?e(t,u,i,s,a,o):o==r.LEAST_UPPER_BOUND?u:t<0?-1:t}r.search=function(n,i,s,a){if(i.length===0)return-1;var o=e(-1,i.length,n,i,s,a||r.GREATEST_LOWER_BOUND);if(o<0)return-1;for(;o-1>=0&&s(i[o],i[o-1],!0)===0;)--o;return o}})($7);var j7={};function Xae(r){function e(i,s,a){var o=i[s];i[s]=i[a],i[a]=o}function t(i,s){return Math.round(i+Math.random()*(s-i))}function n(i,s,a,o){if(a<o){var u=t(a,o),f=a-1;e(i,u,o);for(var g=i[o],y=a;y<o;y++)s(i[y],g,!1)<=0&&(f+=1,e(i,f,y));e(i,f+1,y);var A=f+1;n(i,s,a,A-1),n(i,s,A+1,o)}}return n}function Jae(r){let e=Xae.toString();return new Function(`return ${e}`)()(r)}let m4=new WeakMap;j7.quickSort=function(r,e,t=0){let n=m4.get(e);n===void 0&&(n=Jae(e),m4.set(e,n)),n(r,e,t,r.length-1)};var vr=vy,nk=$7,Xm=ek.ArraySet,qae=sS,I_=j7.quickSort;function Ai(r,e){var t=r;return typeof r=="string"&&(t=vr.parseSourceMapInput(r)),t.sections!=null?new ic(t,e):new so(t,e)}Ai.fromSourceMap=function(r,e){return so.fromSourceMap(r,e)};Ai.prototype._version=3;Ai.prototype.__generatedMappings=null;Object.defineProperty(Ai.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}});Ai.prototype.__originalMappings=null;Object.defineProperty(Ai.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}});Ai.prototype._charIsMappingSeparator=function(e,t){var n=e.charAt(t);return n===";"||n===","};Ai.prototype._parseMappings=function(e,t){throw new Error("Subclasses must implement _parseMappings")};Ai.GENERATED_ORDER=1;Ai.ORIGINAL_ORDER=2;Ai.GREATEST_LOWER_BOUND=1;Ai.LEAST_UPPER_BOUND=2;Ai.prototype.eachMapping=function(e,t,n){var i=t||null,s=n||Ai.GENERATED_ORDER,a;switch(s){case Ai.GENERATED_ORDER:a=this._generatedMappings;break;case Ai.ORIGINAL_ORDER:a=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}for(var o=this.sourceRoot,u=e.bind(i),f=this._names,g=this._sources,y=this._sourceMapURL,A=0,C=a.length;A<C;A++){var M=a[A],k=M.source===null?null:g.at(M.source);k!==null&&(k=vr.computeSourceURL(o,k,y)),u({source:k,generatedLine:M.generatedLine,generatedColumn:M.generatedColumn,originalLine:M.originalLine,originalColumn:M.originalColumn,name:M.name===null?null:f.at(M.name)})}};Ai.prototype.allGeneratedPositionsFor=function(e){var t=vr.getArg(e,"line"),n={source:vr.getArg(e,"source"),originalLine:t,originalColumn:vr.getArg(e,"column",0)};if(n.source=this._findSourceIndex(n.source),n.source<0)return[];var i=[],s=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",vr.compareByOriginalPositions,nk.LEAST_UPPER_BOUND);if(s>=0){var a=this._originalMappings[s];if(e.column===void 0)for(var o=a.originalLine;a&&a.originalLine===o;)i.push({line:vr.getArg(a,"generatedLine",null),column:vr.getArg(a,"generatedColumn",null),lastColumn:vr.getArg(a,"lastGeneratedColumn",null)}),a=this._originalMappings[++s];else for(var u=a.originalColumn;a&&a.originalLine===t&&a.originalColumn==u;)i.push({line:vr.getArg(a,"generatedLine",null),column:vr.getArg(a,"generatedColumn",null),lastColumn:vr.getArg(a,"lastGeneratedColumn",null)}),a=this._originalMappings[++s]}return i};aS.SourceMapConsumer=Ai;function so(r,e){var t=r;typeof r=="string"&&(t=vr.parseSourceMapInput(r));var n=vr.getArg(t,"version"),i=vr.getArg(t,"sources"),s=vr.getArg(t,"names",[]),a=vr.getArg(t,"sourceRoot",null),o=vr.getArg(t,"sourcesContent",null),u=vr.getArg(t,"mappings"),f=vr.getArg(t,"file",null);if(n!=this._version)throw new Error("Unsupported version: "+n);a&&(a=vr.normalize(a)),i=i.map(String).map(vr.normalize).map(function(g){return a&&vr.isAbsolute(a)&&vr.isAbsolute(g)?vr.relative(a,g):g}),this._names=Xm.fromArray(s.map(String),!0),this._sources=Xm.fromArray(i,!0),this._absoluteSources=this._sources.toArray().map(function(g){return vr.computeSourceURL(a,g,e)}),this.sourceRoot=a,this.sourcesContent=o,this._mappings=u,this._sourceMapURL=e,this.file=f}so.prototype=Object.create(Ai.prototype);so.prototype.consumer=Ai;so.prototype._findSourceIndex=function(r){var e=r;if(this.sourceRoot!=null&&(e=vr.relative(this.sourceRoot,e)),this._sources.has(e))return this._sources.indexOf(e);var t;for(t=0;t<this._absoluteSources.length;++t)if(this._absoluteSources[t]==r)return t;return-1};so.fromSourceMap=function(e,t){var n=Object.create(so.prototype),i=n._names=Xm.fromArray(e._names.toArray(),!0),s=n._sources=Xm.fromArray(e._sources.toArray(),!0);n.sourceRoot=e._sourceRoot,n.sourcesContent=e._generateSourcesContent(n._sources.toArray(),n.sourceRoot),n.file=e._file,n._sourceMapURL=t,n._absoluteSources=n._sources.toArray().map(function(C){return vr.computeSourceURL(n.sourceRoot,C,t)});for(var a=e._mappings.toArray().slice(),o=n.__generatedMappings=[],u=n.__originalMappings=[],f=0,g=a.length;f<g;f++){var y=a[f],A=new G7;A.generatedLine=y.generatedLine,A.generatedColumn=y.generatedColumn,y.source&&(A.source=s.indexOf(y.source),A.originalLine=y.originalLine,A.originalColumn=y.originalColumn,y.name&&(A.name=i.indexOf(y.name)),u.push(A)),o.push(A)}return I_(n.__originalMappings,vr.compareByOriginalPositions),n};so.prototype._version=3;Object.defineProperty(so.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function G7(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}const iI=vr.compareByGeneratedPositionsDeflatedNoLine;function y4(r,e){let t=r.length,n=r.length-e;if(!(n<=1))if(n==2){let i=r[e],s=r[e+1];iI(i,s)>0&&(r[e]=s,r[e+1]=i)}else if(n<20)for(let i=e;i<t;i++)for(let s=i;s>e;s--){let a=r[s-1],o=r[s];if(iI(a,o)<=0)break;r[s-1]=o,r[s]=a}else I_(r,iI,e)}so.prototype._parseMappings=function(e,t){var n=1,i=0,s=0,a=0,o=0,u=0,f=e.length,g=0,y={},A=[],C=[],M,k,D,V;let W=0;for(;g<f;)if(e.charAt(g)===";")n++,g++,i=0,y4(C,W),W=C.length;else if(e.charAt(g)===",")g++;else{for(M=new G7,M.generatedLine=n,D=g;D<f&&!this._charIsMappingSeparator(e,D);D++);for(e.slice(g,D),k=[];g<D;)qae.decode(e,g,y),V=y.value,g=y.rest,k.push(V);if(k.length===2)throw new Error("Found a source, but no line and column");if(k.length===3)throw new Error("Found a source and line, but no column");if(M.generatedColumn=i+k[0],i=M.generatedColumn,k.length>1&&(M.source=o+k[1],o+=k[1],M.originalLine=s+k[2],s=M.originalLine,M.originalLine+=1,M.originalColumn=a+k[3],a=M.originalColumn,k.length>4&&(M.name=u+k[4],u+=k[4])),C.push(M),typeof M.originalLine=="number"){let $=M.source;for(;A.length<=$;)A.push(null);A[$]===null&&(A[$]=[]),A[$].push(M)}}y4(C,W),this.__generatedMappings=C;for(var z=0;z<A.length;z++)A[z]!=null&&I_(A[z],vr.compareByOriginalPositionsNoSource);this.__originalMappings=[].concat(...A)};so.prototype._findMapping=function(e,t,n,i,s,a){if(e[n]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[n]);if(e[i]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[i]);return nk.search(e,t,s,a)};so.prototype.computeColumnSpans=function(){for(var e=0;e<this._generatedMappings.length;++e){var t=this._generatedMappings[e];if(e+1<this._generatedMappings.length){var n=this._generatedMappings[e+1];if(t.generatedLine===n.generatedLine){t.lastGeneratedColumn=n.generatedColumn-1;continue}}t.lastGeneratedColumn=1/0}};so.prototype.originalPositionFor=function(e){var t={generatedLine:vr.getArg(e,"line"),generatedColumn:vr.getArg(e,"column")},n=this._findMapping(t,this._generatedMappings,"generatedLine","generatedColumn",vr.compareByGeneratedPositionsDeflated,vr.getArg(e,"bias",Ai.GREATEST_LOWER_BOUND));if(n>=0){var i=this._generatedMappings[n];if(i.generatedLine===t.generatedLine){var s=vr.getArg(i,"source",null);s!==null&&(s=this._sources.at(s),s=vr.computeSourceURL(this.sourceRoot,s,this._sourceMapURL));var a=vr.getArg(i,"name",null);return a!==null&&(a=this._names.at(a)),{source:s,line:vr.getArg(i,"originalLine",null),column:vr.getArg(i,"originalColumn",null),name:a}}}return{source:null,line:null,column:null,name:null}};so.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(e){return e==null}):!1};so.prototype.sourceContentFor=function(e,t){if(!this.sourcesContent)return null;var n=this._findSourceIndex(e);if(n>=0)return this.sourcesContent[n];var i=e;this.sourceRoot!=null&&(i=vr.relative(this.sourceRoot,i));var s;if(this.sourceRoot!=null&&(s=vr.urlParse(this.sourceRoot))){var a=i.replace(/^file:\/\//,"");if(s.scheme=="file"&&this._sources.has(a))return this.sourcesContent[this._sources.indexOf(a)];if((!s.path||s.path=="/")&&this._sources.has("/"+i))return this.sourcesContent[this._sources.indexOf("/"+i)]}if(t)return null;throw new Error('"'+i+'" is not in the SourceMap.')};so.prototype.generatedPositionFor=function(e){var t=vr.getArg(e,"source");if(t=this._findSourceIndex(t),t<0)return{line:null,column:null,lastColumn:null};var n={source:t,originalLine:vr.getArg(e,"line"),originalColumn:vr.getArg(e,"column")},i=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",vr.compareByOriginalPositions,vr.getArg(e,"bias",Ai.GREATEST_LOWER_BOUND));if(i>=0){var s=this._originalMappings[i];if(s.source===n.source)return{line:vr.getArg(s,"generatedLine",null),column:vr.getArg(s,"generatedColumn",null),lastColumn:vr.getArg(s,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}};aS.BasicSourceMapConsumer=so;function ic(r,e){var t=r;typeof r=="string"&&(t=vr.parseSourceMapInput(r));var n=vr.getArg(t,"version"),i=vr.getArg(t,"sections");if(n!=this._version)throw new Error("Unsupported version: "+n);this._sources=new Xm,this._names=new Xm;var s={line:-1,column:0};this._sections=i.map(function(a){if(a.url)throw new Error("Support for url field in sections not implemented.");var o=vr.getArg(a,"offset"),u=vr.getArg(o,"line"),f=vr.getArg(o,"column");if(u<s.line||u===s.line&&f<s.column)throw new Error("Section offsets must be ordered and non-overlapping.");return s=o,{generatedOffset:{generatedLine:u+1,generatedColumn:f+1},consumer:new Ai(vr.getArg(a,"map"),e)}})}ic.prototype=Object.create(Ai.prototype);ic.prototype.constructor=Ai;ic.prototype._version=3;Object.defineProperty(ic.prototype,"sources",{get:function(){for(var r=[],e=0;e<this._sections.length;e++)for(var t=0;t<this._sections[e].consumer.sources.length;t++)r.push(this._sections[e].consumer.sources[t]);return r}});ic.prototype.originalPositionFor=function(e){var t={generatedLine:vr.getArg(e,"line"),generatedColumn:vr.getArg(e,"column")},n=nk.search(t,this._sections,function(s,a){var o=s.generatedLine-a.generatedOffset.generatedLine;return o||s.generatedColumn-a.generatedOffset.generatedColumn}),i=this._sections[n];return i?i.consumer.originalPositionFor({line:t.generatedLine-(i.generatedOffset.generatedLine-1),column:t.generatedColumn-(i.generatedOffset.generatedLine===t.generatedLine?i.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}};ic.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(e){return e.consumer.hasContentsOfAllSources()})};ic.prototype.sourceContentFor=function(e,t){for(var n=0;n<this._sections.length;n++){var i=this._sections[n],s=i.consumer.sourceContentFor(e,!0);if(s||s==="")return s}if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')};ic.prototype.generatedPositionFor=function(e){for(var t=0;t<this._sections.length;t++){var n=this._sections[t];if(n.consumer._findSourceIndex(vr.getArg(e,"source"))!==-1){var i=n.consumer.generatedPositionFor(e);if(i){var s={line:i.line+(n.generatedOffset.generatedLine-1),column:i.column+(n.generatedOffset.generatedLine===i.line?n.generatedOffset.generatedColumn-1:0)};return s}}}return{line:null,column:null}};ic.prototype._parseMappings=function(e,t){this.__generatedMappings=[],this.__originalMappings=[];for(var n=0;n<this._sections.length;n++)for(var i=this._sections[n],s=i.consumer._generatedMappings,a=0;a<s.length;a++){var o=s[a],u=i.consumer._sources.at(o.source);u!==null&&(u=vr.computeSourceURL(i.consumer.sourceRoot,u,this._sourceMapURL)),this._sources.add(u),u=this._sources.indexOf(u);var f=null;o.name&&(f=i.consumer._names.at(o.name),this._names.add(f),f=this._names.indexOf(f));var g={source:u,generatedLine:o.generatedLine+(i.generatedOffset.generatedLine-1),generatedColumn:o.generatedColumn+(i.generatedOffset.generatedLine===o.generatedLine?i.generatedOffset.generatedColumn-1:0),originalLine:o.originalLine,originalColumn:o.originalColumn,name:f};this.__generatedMappings.push(g),typeof g.originalLine=="number"&&this.__originalMappings.push(g)}I_(this.__generatedMappings,vr.compareByGeneratedPositionsDeflated),I_(this.__originalMappings,vr.compareByOriginalPositions)};aS.IndexedSourceMapConsumer=ic;var H7={},Yae=YR.SourceMapGenerator,pC=vy,Zae=/(\r?\n)/,Qae=10,Ay="$$$isSourceNode$$$";function Ka(r,e,t,n,i){this.children=[],this.sourceContents={},this.line=r??null,this.column=e??null,this.source=t??null,this.name=i??null,this[Ay]=!0,n!=null&&this.add(n)}Ka.fromStringWithSourceMap=function(e,t,n){var i=new Ka,s=e.split(Zae),a=0,o=function(){var A=M(),C=M()||"";return A+C;function M(){return a<s.length?s[a++]:void 0}},u=1,f=0,g=null;return t.eachMapping(function(A){if(g!==null)if(u<A.generatedLine)y(g,o()),u++,f=0;else{var C=s[a]||"",M=C.substr(0,A.generatedColumn-f);s[a]=C.substr(A.generatedColumn-f),f=A.generatedColumn,y(g,M),g=A;return}for(;u<A.generatedLine;)i.add(o()),u++;if(f<A.generatedColumn){var C=s[a]||"";i.add(C.substr(0,A.generatedColumn)),s[a]=C.substr(A.generatedColumn),f=A.generatedColumn}g=A},this),a<s.length&&(g&&y(g,o()),i.add(s.splice(a).join(""))),t.sources.forEach(function(A){var C=t.sourceContentFor(A);C!=null&&(n!=null&&(A=pC.join(n,A)),i.setSourceContent(A,C))}),i;function y(A,C){if(A===null||A.source===void 0)i.add(C);else{var M=n?pC.join(n,A.source):A.source;i.add(new Ka(A.originalLine,A.originalColumn,M,C,A.name))}}};Ka.prototype.add=function(e){if(Array.isArray(e))e.forEach(function(t){this.add(t)},this);else if(e[Ay]||typeof e=="string")e&&this.children.push(e);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);return this};Ka.prototype.prepend=function(e){if(Array.isArray(e))for(var t=e.length-1;t>=0;t--)this.prepend(e[t]);else if(e[Ay]||typeof e=="string")this.children.unshift(e);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);return this};Ka.prototype.walk=function(e){for(var t,n=0,i=this.children.length;n<i;n++)t=this.children[n],t[Ay]?t.walk(e):t!==""&&e(t,{source:this.source,line:this.line,column:this.column,name:this.name})};Ka.prototype.join=function(e){var t,n,i=this.children.length;if(i>0){for(t=[],n=0;n<i-1;n++)t.push(this.children[n]),t.push(e);t.push(this.children[n]),this.children=t}return this};Ka.prototype.replaceRight=function(e,t){var n=this.children[this.children.length-1];return n[Ay]?n.replaceRight(e,t):typeof n=="string"?this.children[this.children.length-1]=n.replace(e,t):this.children.push("".replace(e,t)),this};Ka.prototype.setSourceContent=function(e,t){this.sourceContents[pC.toSetString(e)]=t};Ka.prototype.walkSourceContents=function(e){for(var t=0,n=this.children.length;t<n;t++)this.children[t][Ay]&&this.children[t].walkSourceContents(e);for(var i=Object.keys(this.sourceContents),t=0,n=i.length;t<n;t++)e(pC.fromSetString(i[t]),this.sourceContents[i[t]])};Ka.prototype.toString=function(){var e="";return this.walk(function(t){e+=t}),e};Ka.prototype.toStringWithSourceMap=function(e){var t={code:"",line:1,column:0},n=new Yae(e),i=!1,s=null,a=null,o=null,u=null;return this.walk(function(f,g){t.code+=f,g.source!==null&&g.line!==null&&g.column!==null?((s!==g.source||a!==g.line||o!==g.column||u!==g.name)&&n.addMapping({source:g.source,original:{line:g.line,column:g.column},generated:{line:t.line,column:t.column},name:g.name}),s=g.source,a=g.line,o=g.column,u=g.name,i=!0):i&&(n.addMapping({generated:{line:t.line,column:t.column}}),s=null,i=!1);for(var y=0,A=f.length;y<A;y++)f.charCodeAt(y)===Qae?(t.line++,t.column=0,y+1===A?(s=null,i=!1):i&&n.addMapping({source:g.source,original:{line:g.line,column:g.column},generated:{line:t.line,column:t.column},name:g.name})):t.column++}),this.walkSourceContents(function(f,g){n.setSourceContent(f,g)}),{code:t.code,map:n}};H7.SourceNode=Ka;iS.SourceMapGenerator=YR.SourceMapGenerator;iS.SourceMapConsumer=aS.SourceMapConsumer;iS.SourceNode=H7.SourceNode;/**
* @vue/compiler-core v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/Object.defineProperty(ft,"__esModule",{value:!0});var or=Zt,Pf=b7,km=Gv,ele=jae,tle=iS;const Jm=Symbol(""),Om=Symbol(""),lS=Symbol(""),P_=Symbol(""),ik=Symbol(""),vd=Symbol(""),sk=Symbol(""),ok=Symbol(""),cS=Symbol(""),uS=Symbol(""),xy=Symbol(""),hS=Symbol(""),ak=Symbol(""),B_=Symbol(""),dS=Symbol(""),fS=Symbol(""),pS=Symbol(""),gS=Symbol(""),mS=Symbol(""),lk=Symbol(""),ck=Symbol(""),yS=Symbol(""),M_=Symbol(""),bS=Symbol(""),_S=Symbol(""),qm=Symbol(""),wy=Symbol(""),vS=Symbol(""),gC=Symbol(""),W7=Symbol(""),mC=Symbol(""),R_=Symbol(""),K7=Symbol(""),X7=Symbol(""),AS=Symbol(""),k_=Symbol(""),O_=Symbol(""),xS=Symbol(""),uk=Symbol(""),aa={[Jm]:"Fragment",[Om]:"Teleport",[lS]:"Suspense",[P_]:"KeepAlive",[ik]:"BaseTransition",[vd]:"openBlock",[sk]:"createBlock",[ok]:"createElementBlock",[cS]:"createVNode",[uS]:"createElementVNode",[xy]:"createCommentVNode",[hS]:"createTextVNode",[ak]:"createStaticVNode",[B_]:"resolveComponent",[dS]:"resolveDynamicComponent",[fS]:"resolveDirective",[pS]:"resolveFilter",[gS]:"withDirectives",[mS]:"renderList",[lk]:"renderSlot",[ck]:"createSlots",[yS]:"toDisplayString",[M_]:"mergeProps",[bS]:"normalizeClass",[_S]:"normalizeStyle",[qm]:"normalizeProps",[wy]:"guardReactiveProps",[vS]:"toHandlers",[gC]:"camelize",[W7]:"capitalize",[mC]:"toHandlerKey",[R_]:"setBlockTracking",[K7]:"pushScopeId",[X7]:"popScopeId",[AS]:"withCtx",[k_]:"unref",[O_]:"isRef",[xS]:"withMemo",[uk]:"isMemoSame"};function rle(r){Object.getOwnPropertySymbols(r).forEach(e=>{aa[e]=r[e]})}const nle={HTML:0,0:"HTML",SVG:1,1:"SVG",MATH_ML:2,2:"MATH_ML"},ile={ROOT:0,0:"ROOT",ELEMENT:1,1:"ELEMENT",TEXT:2,2:"TEXT",COMMENT:3,3:"COMMENT",SIMPLE_EXPRESSION:4,4:"SIMPLE_EXPRESSION",INTERPOLATION:5,5:"INTERPOLATION",ATTRIBUTE:6,6:"ATTRIBUTE",DIRECTIVE:7,7:"DIRECTIVE",COMPOUND_EXPRESSION:8,8:"COMPOUND_EXPRESSION",IF:9,9:"IF",IF_BRANCH:10,10:"IF_BRANCH",FOR:11,11:"FOR",TEXT_CALL:12,12:"TEXT_CALL",VNODE_CALL:13,13:"VNODE_CALL",JS_CALL_EXPRESSION:14,14:"JS_CALL_EXPRESSION",JS_OBJECT_EXPRESSION:15,15:"JS_OBJECT_EXPRESSION",JS_PROPERTY:16,16:"JS_PROPERTY",JS_ARRAY_EXPRESSION:17,17:"JS_ARRAY_EXPRESSION",JS_FUNCTION_EXPRESSION:18,18:"JS_FUNCTION_EXPRESSION",JS_CONDITIONAL_EXPRESSION:19,19:"JS_CONDITIONAL_EXPRESSION",JS_CACHE_EXPRESSION:20,20:"JS_CACHE_EXPRESSION",JS_BLOCK_STATEMENT:21,21:"JS_BLOCK_STATEMENT",JS_TEMPLATE_LITERAL:22,22:"JS_TEMPLATE_LITERAL",JS_IF_STATEMENT:23,23:"JS_IF_STATEMENT",JS_ASSIGNMENT_EXPRESSION:24,24:"JS_ASSIGNMENT_EXPRESSION",JS_SEQUENCE_EXPRESSION:25,25:"JS_SEQUENCE_EXPRESSION",JS_RETURN_STATEMENT:26,26:"JS_RETURN_STATEMENT"},sle={ELEMENT:0,0:"ELEMENT",COMPONENT:1,1:"COMPONENT",SLOT:2,2:"SLOT",TEMPLATE:3,3:"TEMPLATE"},ole={NOT_CONSTANT:0,0:"NOT_CONSTANT",CAN_SKIP_PATCH:1,1:"CAN_SKIP_PATCH",CAN_CACHE:2,2:"CAN_CACHE",CAN_STRINGIFY:3,3:"CAN_STRINGIFY"},ws={start:{line:1,column:1,offset:0},end:{line:1,column:1,offset:0},source:""};function J7(r,e=""){return{type:0,source:e,children:r,helpers:new Set,components:[],directives:[],hoists:[],imports:[],cached:[],temps:0,codegenNode:void 0,loc:ws}}function Ym(r,e,t,n,i,s,a,o=!1,u=!1,f=!1,g=ws){return r&&(o?(r.helper(vd),r.helper(cp(r.inSSR,f))):r.helper(lp(r.inSSR,f)),a&&r.helper(gS)),{type:13,tag:e,props:t,children:n,patchFlag:i,dynamicProps:s,directives:a,isBlock:o,disableTracking:u,isComponent:f,loc:g}}function md(r,e=ws){return{type:17,loc:e,elements:r}}function Fa(r,e=ws){return{type:15,loc:e,properties:r}}function xs(r,e){return{type:16,loc:ws,key:or.isString(r)?Wr(r,!0):r,value:e}}function Wr(r,e=!1,t=ws,n=0){return{type:4,loc:t,content:r,isStatic:e,constType:e?3:n}}function ale(r,e){return{type:5,loc:e,content:or.isString(r)?Wr(r,!1,e):r}}function Na(r,e=ws){return{type:8,loc:e,children:r}}function ro(r,e=[],t=ws){return{type:14,loc:t,callee:r,arguments:e}}function ap(r,e=void 0,t=!1,n=!1,i=ws){return{type:18,params:r,returns:e,newline:t,isSlot:n,loc:i}}function yC(r,e,t,n=!0){return{type:19,test:r,consequent:e,alternate:t,newline:n,loc:ws}}function q7(r,e,t=!1,n=!1){return{type:20,index:r,value:e,needPauseTracking:t,inVOnce:n,needArraySpread:!1,loc:ws}}function Y7(r){return{type:21,body:r,loc:ws}}function lle(r){return{type:22,elements:r,loc:ws}}function cle(r,e,t){return{type:23,test:r,consequent:e,alternate:t,loc:ws}}function ule(r,e){return{type:24,left:r,right:e,loc:ws}}function hle(r){return{type:25,expressions:r,loc:ws}}function dle(r){return{type:26,returns:r,loc:ws}}function lp(r,e){return r||e?cS:uS}function cp(r,e){return r||e?sk:ok}function wS(r,{helper:e,removeHelper:t,inSSR:n}){r.isBlock||(r.isBlock=!0,t(lp(n,r.isComponent)),e(vd),e(cp(n,r.isComponent)))}const b4=new Uint8Array([123,123]),_4=new Uint8Array([125,125]);function v4(r){return r>=97&&r<=122||r>=65&&r<=90}function Da(r){return r===32||r===10||r===9||r===12||r===13}function Fh(r){return r===47||r===62||Da(r)}function bC(r){const e=new Uint8Array(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}const Zs={Cdata:new Uint8Array([67,68,65,84,65,91]),CdataEnd:new Uint8Array([93,93,62]),CommentEnd:new Uint8Array([45,45,62]),ScriptEnd:new Uint8Array([60,47,115,99,114,105,112,116]),StyleEnd:new Uint8Array([60,47,115,116,121,108,101]),TitleEnd:new Uint8Array([60,47,116,105,116,108,101]),TextareaEnd:new Uint8Array([60,47,116,101,120,116,97,114,101,97])};class fle{constructor(e,t){this.stack=e,this.cbs=t,this.state=1,this.buffer="",this.sectionStart=0,this.index=0,this.entityStart=0,this.baseState=1,this.inRCDATA=!1,this.inXML=!1,this.inVPre=!1,this.newlines=[],this.mode=0,this.delimiterOpen=b4,this.delimiterClose=_4,this.delimiterIndex=-1,this.currentSequence=void 0,this.sequenceIndex=0,this.entityDecoder=new Pf.EntityDecoder(Pf.htmlDecodeTree,(n,i)=>this.emitCodePoint(n,i))}get inSFCRoot(){return this.mode===2&&this.stack.length===0}reset(){this.state=1,this.mode=0,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=1,this.inRCDATA=!1,this.currentSequence=void 0,this.newlines.length=0,this.delimiterOpen=b4,this.delimiterClose=_4}getPos(e){let t=1,n=e+1;const i=this.newlines.length;let s=-1;if(i>100){let a=-1,o=i;for(;a+1<o;){const u=a+o>>>1;this.newlines[u]<e?a=u:o=u}s=a}else for(let a=i-1;a>=0;a--)if(e>this.newlines[a]){s=a;break}return s>=0&&(t=s+2,n=e-this.newlines[s]),{column:n,line:t,offset:e}}peek(){return this.buffer.charCodeAt(this.index+1)}stateText(e){e===60?(this.index>this.sectionStart&&this.cbs.ontext(this.sectionStart,this.index),this.state=5,this.sectionStart=this.index):e===38?this.startEntity():!this.inVPre&&e===this.delimiterOpen[0]&&(this.state=2,this.delimiterIndex=0,this.stateInterpolationOpen(e))}stateInterpolationOpen(e){if(e===this.delimiterOpen[this.delimiterIndex])if(this.delimiterIndex===this.delimiterOpen.length-1){const t=this.index+1-this.delimiterOpen.length;t>this.sectionStart&&this.cbs.ontext(this.sectionStart,t),this.state=3,this.sectionStart=t}else this.delimiterIndex++;else this.inRCDATA?(this.state=32,this.stateInRCDATA(e)):(this.state=1,this.stateText(e))}stateInterpolation(e){e===this.delimiterClose[0]&&(this.state=4,this.delimiterIndex=0,this.stateInterpolationClose(e))}stateInterpolationClose(e){e===this.delimiterClose[this.delimiterIndex]?this.delimiterIndex===this.delimiterClose.length-1?(this.cbs.oninterpolation(this.sectionStart,this.index+1),this.inRCDATA?this.state=32:this.state=1,this.sectionStart=this.index+1):this.delimiterIndex++:(this.state=3,this.stateInterpolation(e))}stateSpecialStartSequence(e){const t=this.sequenceIndex===this.currentSequence.length;if(!(t?Fh(e):(e|32)===this.currentSequence[this.sequenceIndex]))this.inRCDATA=!1;else if(!t){this.sequenceIndex++;return}this.sequenceIndex=0,this.state=6,this.stateInTagName(e)}stateInRCDATA(e){if(this.sequenceIndex===this.currentSequence.length){if(e===62||Da(e)){const t=this.index-this.currentSequence.length;if(this.sectionStart<t){const n=this.index;this.index=t,this.cbs.ontext(this.sectionStart,t),this.index=n}this.sectionStart=t+2,this.stateInClosingTagName(e),this.inRCDATA=!1;return}this.sequenceIndex=0}(e|32)===this.currentSequence[this.sequenceIndex]?this.sequenceIndex+=1:this.sequenceIndex===0?this.currentSequence===Zs.TitleEnd||this.currentSequence===Zs.TextareaEnd&&!this.inSFCRoot?e===38?this.startEntity():!this.inVPre&&e===this.delimiterOpen[0]&&(this.state=2,this.delimiterIndex=0,this.stateInterpolationOpen(e)):this.fastForwardTo(60)&&(this.sequenceIndex=1):this.sequenceIndex=+(e===60)}stateCDATASequence(e){e===Zs.Cdata[this.sequenceIndex]?++this.sequenceIndex===Zs.Cdata.length&&(this.state=28,this.currentSequence=Zs.CdataEnd,this.sequenceIndex=0,this.sectionStart=this.index+1):(this.sequenceIndex=0,this.state=23,this.stateInDeclaration(e))}fastForwardTo(e){for(;++this.index<this.buffer.length;){const t=this.buffer.charCodeAt(this.index);if(t===10&&this.newlines.push(this.index),t===e)return!0}return this.index=this.buffer.length-1,!1}stateInCommentLike(e){e===this.currentSequence[this.sequenceIndex]?++this.sequenceIndex===this.currentSequence.length&&(this.currentSequence===Zs.CdataEnd?this.cbs.oncdata(this.sectionStart,this.index-2):this.cbs.oncomment(this.sectionStart,this.index-2),this.sequenceIndex=0,this.sectionStart=this.index+1,this.state=1):this.sequenceIndex===0?this.fastForwardTo(this.currentSequence[0])&&(this.sequenceIndex=1):e!==this.currentSequence[this.sequenceIndex-1]&&(this.sequenceIndex=0)}startSpecial(e,t){this.enterRCDATA(e,t),this.state=31}enterRCDATA(e,t){this.inRCDATA=!0,this.currentSequence=e,this.sequenceIndex=t}stateBeforeTagName(e){e===33?(this.state=22,this.sectionStart=this.index+1):e===63?(this.state=24,this.sectionStart=this.index+1):v4(e)?(this.sectionStart=this.index,this.mode===0?this.state=6:this.inSFCRoot?this.state=34:this.inXML?this.state=6:e===116?this.state=30:this.state=e===115?29:6):e===47?this.state=8:(this.state=1,this.stateText(e))}stateInTagName(e){Fh(e)&&this.handleTagName(e)}stateInSFCRootTagName(e){if(Fh(e)){const t=this.buffer.slice(this.sectionStart,this.index);t!=="template"&&this.enterRCDATA(bC("</"+t),0),this.handleTagName(e)}}handleTagName(e){this.cbs.onopentagname(this.sectionStart,this.index),this.sectionStart=-1,this.state=11,this.stateBeforeAttrName(e)}stateBeforeClosingTagName(e){Da(e)||(e===62?(this.cbs.onerr(14,this.index),this.state=1,this.sectionStart=this.index+1):(this.state=v4(e)?9:27,this.sectionStart=this.index))}stateInClosingTagName(e){(e===62||Da(e))&&(this.cbs.onclosetag(this.sectionStart,this.index),this.sectionStart=-1,this.state=10,this.stateAfterClosingTagName(e))}stateAfterClosingTagName(e){e===62&&(this.state=1,this.sectionStart=this.index+1)}stateBeforeAttrName(e){e===62?(this.cbs.onopentagend(this.index),this.inRCDATA?this.state=32:this.state=1,this.sectionStart=this.index+1):e===47?(this.state=7,this.peek()!==62&&this.cbs.onerr(22,this.index)):e===60&&this.peek()===47?(this.cbs.onopentagend(this.index),this.state=5,this.sectionStart=this.index):Da(e)||(e===61&&this.cbs.onerr(19,this.index),this.handleAttrStart(e))}handleAttrStart(e){e===118&&this.peek()===45?(this.state=13,this.sectionStart=this.index):e===46||e===58||e===64||e===35?(this.cbs.ondirname(this.index,this.index+1),this.state=14,this.sectionStart=this.index+1):(this.state=12,this.sectionStart=this.index)}stateInSelfClosingTag(e){e===62?(this.cbs.onselfclosingtag(this.index),this.state=1,this.sectionStart=this.index+1,this.inRCDATA=!1):Da(e)||(this.state=11,this.stateBeforeAttrName(e))}stateInAttrName(e){e===61||Fh(e)?(this.cbs.onattribname(this.sectionStart,this.index),this.handleAttrNameEnd(e)):(e===34||e===39||e===60)&&this.cbs.onerr(17,this.index)}stateInDirName(e){e===61||Fh(e)?(this.cbs.ondirname(this.sectionStart,this.index),this.handleAttrNameEnd(e)):e===58?(this.cbs.ondirname(this.sectionStart,this.index),this.state=14,this.sectionStart=this.index+1):e===46&&(this.cbs.ondirname(this.sectionStart,this.index),this.state=16,this.sectionStart=this.index+1)}stateInDirArg(e){e===61||Fh(e)?(this.cbs.ondirarg(this.sectionStart,this.index),this.handleAttrNameEnd(e)):e===91?this.state=15:e===46&&(this.cbs.ondirarg(this.sectionStart,this.index),this.state=16,this.sectionStart=this.index+1)}stateInDynamicDirArg(e){e===93?this.state=14:(e===61||Fh(e))&&(this.cbs.ondirarg(this.sectionStart,this.index+1),this.handleAttrNameEnd(e),this.cbs.onerr(27,this.index))}stateInDirModifier(e){e===61||Fh(e)?(this.cbs.ondirmodifier(this.sectionStart,this.index),this.handleAttrNameEnd(e)):e===46&&(this.cbs.ondirmodifier(this.sectionStart,this.index),this.sectionStart=this.index+1)}handleAttrNameEnd(e){this.sectionStart=this.index,this.state=17,this.cbs.onattribnameend(this.index),this.stateAfterAttrName(e)}stateAfterAttrName(e){e===61?this.state=18:e===47||e===62?(this.cbs.onattribend(0,this.sectionStart),this.sectionStart=-1,this.state=11,this.stateBeforeAttrName(e)):Da(e)||(this.cbs.onattribend(0,this.sectionStart),this.handleAttrStart(e))}stateBeforeAttrValue(e){e===34?(this.state=19,this.sectionStart=this.index+1):e===39?(this.state=20,this.sectionStart=this.index+1):Da(e)||(this.sectionStart=this.index,this.state=21,this.stateInAttrValueNoQuotes(e))}handleInAttrValue(e,t){e===t?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(t===34?3:2,this.index+1),this.state=11):e===38&&this.startEntity()}stateInAttrValueDoubleQuotes(e){this.handleInAttrValue(e,34)}stateInAttrValueSingleQuotes(e){this.handleInAttrValue(e,39)}stateInAttrValueNoQuotes(e){Da(e)||e===62?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(1,this.index),this.state=11,this.stateBeforeAttrName(e)):e===34||e===39||e===60||e===61||e===96?this.cbs.onerr(18,this.index):e===38&&this.startEntity()}stateBeforeDeclaration(e){e===91?(this.state=26,this.sequenceIndex=0):this.state=e===45?25:23}stateInDeclaration(e){(e===62||this.fastForwardTo(62))&&(this.state=1,this.sectionStart=this.index+1)}stateInProcessingInstruction(e){(e===62||this.fastForwardTo(62))&&(this.cbs.onprocessinginstruction(this.sectionStart,this.index),this.state=1,this.sectionStart=this.index+1)}stateBeforeComment(e){e===45?(this.state=28,this.currentSequence=Zs.CommentEnd,this.sequenceIndex=2,this.sectionStart=this.index+1):this.state=23}stateInSpecialComment(e){(e===62||this.fastForwardTo(62))&&(this.cbs.oncomment(this.sectionStart,this.index),this.state=1,this.sectionStart=this.index+1)}stateBeforeSpecialS(e){e===Zs.ScriptEnd[3]?this.startSpecial(Zs.ScriptEnd,4):e===Zs.StyleEnd[3]?this.startSpecial(Zs.StyleEnd,4):(this.state=6,this.stateInTagName(e))}stateBeforeSpecialT(e){e===Zs.TitleEnd[3]?this.startSpecial(Zs.TitleEnd,4):e===Zs.TextareaEnd[3]?this.startSpecial(Zs.TextareaEnd,4):(this.state=6,this.stateInTagName(e))}startEntity(){this.baseState=this.state,this.state=33,this.entityStart=this.index,this.entityDecoder.startEntity(this.baseState===1||this.baseState===32?Pf.DecodingMode.Legacy:Pf.DecodingMode.Attribute)}stateInEntity(){{const e=this.entityDecoder.write(this.buffer,this.index);e>=0?(this.state=this.baseState,e===0&&(this.index=this.entityStart)):this.index=this.buffer.length-1}}parse(e){for(this.buffer=e;this.index<this.buffer.length;){const t=this.buffer.charCodeAt(this.index);switch(t===10&&this.state!==33&&this.newlines.push(this.index),this.state){case 1:{this.stateText(t);break}case 2:{this.stateInterpolationOpen(t);break}case 3:{this.stateInterpolation(t);break}case 4:{this.stateInterpolationClose(t);break}case 31:{this.stateSpecialStartSequence(t);break}case 32:{this.stateInRCDATA(t);break}case 26:{this.stateCDATASequence(t);break}case 19:{this.stateInAttrValueDoubleQuotes(t);break}case 12:{this.stateInAttrName(t);break}case 13:{this.stateInDirName(t);break}case 14:{this.stateInDirArg(t);break}case 15:{this.stateInDynamicDirArg(t);break}case 16:{this.stateInDirModifier(t);break}case 28:{this.stateInCommentLike(t);break}case 27:{this.stateInSpecialComment(t);break}case 11:{this.stateBeforeAttrName(t);break}case 6:{this.stateInTagName(t);break}case 34:{this.stateInSFCRootTagName(t);break}case 9:{this.stateInClosingTagName(t);break}case 5:{this.stateBeforeTagName(t);break}case 17:{this.stateAfterAttrName(t);break}case 20:{this.stateInAttrValueSingleQuotes(t);break}case 18:{this.stateBeforeAttrValue(t);break}case 8:{this.stateBeforeClosingTagName(t);break}case 10:{this.stateAfterClosingTagName(t);break}case 29:{this.stateBeforeSpecialS(t);break}case 30:{this.stateBeforeSpecialT(t);break}case 21:{this.stateInAttrValueNoQuotes(t);break}case 7:{this.stateInSelfClosingTag(t);break}case 23:{this.stateInDeclaration(t);break}case 22:{this.stateBeforeDeclaration(t);break}case 25:{this.stateBeforeComment(t);break}case 24:{this.stateInProcessingInstruction(t);break}case 33:{this.stateInEntity();break}}this.index++}this.cleanup(),this.finish()}cleanup(){this.sectionStart!==this.index&&(this.state===1||this.state===32&&this.sequenceIndex===0?(this.cbs.ontext(this.sectionStart,this.index),this.sectionStart=this.index):(this.state===19||this.state===20||this.state===21)&&(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=this.index))}finish(){this.state===33&&(this.entityDecoder.end(),this.state=this.baseState),this.handleTrailingData(),this.cbs.onend()}handleTrailingData(){const e=this.buffer.length;this.sectionStart>=e||(this.state===28?this.currentSequence===Zs.CdataEnd?this.cbs.oncdata(this.sectionStart,e):this.cbs.oncomment(this.sectionStart,e):this.state===6||this.state===11||this.state===18||this.state===17||this.state===12||this.state===13||this.state===14||this.state===15||this.state===16||this.state===20||this.state===19||this.state===21||this.state===9||this.cbs.ontext(this.sectionStart,e))}emitCodePoint(e,t){this.baseState!==1&&this.baseState!==32?(this.sectionStart<this.entityStart&&this.cbs.onattribdata(this.sectionStart,this.entityStart),this.sectionStart=this.entityStart+t,this.index=this.sectionStart-1,this.cbs.onattribentity(Pf.fromCodePoint(e),this.entityStart,this.sectionStart)):(this.sectionStart<this.entityStart&&this.cbs.ontext(this.sectionStart,this.entityStart),this.sectionStart=this.entityStart+t,this.index=this.sectionStart-1,this.cbs.ontextentity(Pf.fromCodePoint(e),this.entityStart,this.sectionStart))}}const ple={COMPILER_IS_ON_ELEMENT:"COMPILER_IS_ON_ELEMENT",COMPILER_V_BIND_SYNC:"COMPILER_V_BIND_SYNC",COMPILER_V_BIND_OBJECT_ORDER:"COMPILER_V_BIND_OBJECT_ORDER",COMPILER_V_ON_NATIVE:"COMPILER_V_ON_NATIVE",COMPILER_V_IF_V_FOR_PRECEDENCE:"COMPILER_V_IF_V_FOR_PRECEDENCE",COMPILER_NATIVE_TEMPLATE:"COMPILER_NATIVE_TEMPLATE",COMPILER_INLINE_TEMPLATE:"COMPILER_INLINE_TEMPLATE",COMPILER_FILTERS:"COMPILER_FILTERS"},gle={COMPILER_IS_ON_ELEMENT:{message:'Platform-native elements with "is" prop will no longer be treated as components in Vue 3 unless the "is" value is explicitly prefixed with "vue:".',link:"https://v3-migration.vuejs.org/breaking-changes/custom-elements-interop.html"},COMPILER_V_BIND_SYNC:{message:r=>`.sync modifier for v-bind has been removed. Use v-model with argument instead. \`v-bind:${r}.sync\` should be changed to \`v-model:${r}\`.`,link:"https://v3-migration.vuejs.org/breaking-changes/v-model.html"},COMPILER_V_BIND_OBJECT_ORDER:{message:'v-bind="obj" usage is now order sensitive and behaves like JavaScript object spread: it will now overwrite an existing non-mergeable attribute that appears before v-bind in the case of conflict. To retain 2.x behavior, move v-bind to make it the first attribute. You can also suppress this warning if the usage is intended.',link:"https://v3-migration.vuejs.org/breaking-changes/v-bind.html"},COMPILER_V_ON_NATIVE:{message:".native modifier for v-on has been removed as is no longer necessary.",link:"https://v3-migration.vuejs.org/breaking-changes/v-on-native-modifier-removed.html"},COMPILER_V_IF_V_FOR_PRECEDENCE:{message:"v-if / v-for precedence when used on the same element has changed in Vue 3: v-if now takes higher precedence and will no longer have access to v-for scope variables. It is best to avoid the ambiguity with <template> tags or use a computed property that filters v-for data source.",link:"https://v3-migration.vuejs.org/breaking-changes/v-if-v-for.html"},COMPILER_NATIVE_TEMPLATE:{message:"<template> with no special directives will render as a native template element instead of its inner content in Vue 3."},COMPILER_INLINE_TEMPLATE:{message:'"inline-template" has been removed in Vue 3.',link:"https://v3-migration.vuejs.org/breaking-changes/inline-template-attribute.html"},COMPILER_FILTERS:{message:'filters have been removed in Vue 3. The "|" symbol will be treated as native JavaScript bitwise OR operator. Use method calls or computed properties instead.',link:"https://v3-migration.vuejs.org/breaking-changes/filters.html"}};function O3(r,{compatConfig:e}){const t=e&&e[r];return r==="MODE"?t||3:t}function Kf(r,e){const t=O3("MODE",e),n=O3(r,e);return t===3?n===!0:n!==!1}function D_(r,e,t,...n){return Kf(r,e)}function mle(r,e,t,...n){if(O3(r,e)==="suppress-warning")return;const{message:s,link:a}=gle[r],o=`(deprecation ${r}) ${typeof s=="function"?s(...n):s}${a?`
  Details: ${a}`:""}`,u=new SyntaxError(o);u.code=r,t&&(u.loc=t),e.onWarn(u)}function hk(r){throw r}function Z7(r){}function ti(r,e,t,n){const i=(t||Q7)[r]+(n||""),s=new SyntaxError(String(i));return s.code=r,s.loc=e,s}const yle={ABRUPT_CLOSING_OF_EMPTY_COMMENT:0,0:"ABRUPT_CLOSING_OF_EMPTY_COMMENT",CDATA_IN_HTML_CONTENT:1,1:"CDATA_IN_HTML_CONTENT",DUPLICATE_ATTRIBUTE:2,2:"DUPLICATE_ATTRIBUTE",END_TAG_WITH_ATTRIBUTES:3,3:"END_TAG_WITH_ATTRIBUTES",END_TAG_WITH_TRAILING_SOLIDUS:4,4:"END_TAG_WITH_TRAILING_SOLIDUS",EOF_BEFORE_TAG_NAME:5,5:"EOF_BEFORE_TAG_NAME",EOF_IN_CDATA:6,6:"EOF_IN_CDATA",EOF_IN_COMMENT:7,7:"EOF_IN_COMMENT",EOF_IN_SCRIPT_HTML_COMMENT_LIKE_TEXT:8,8:"EOF_IN_SCRIPT_HTML_COMMENT_LIKE_TEXT",EOF_IN_TAG:9,9:"EOF_IN_TAG",INCORRECTLY_CLOSED_COMMENT:10,10:"INCORRECTLY_CLOSED_COMMENT",INCORRECTLY_OPENED_COMMENT:11,11:"INCORRECTLY_OPENED_COMMENT",INVALID_FIRST_CHARACTER_OF_TAG_NAME:12,12:"INVALID_FIRST_CHARACTER_OF_TAG_NAME",MISSING_ATTRIBUTE_VALUE:13,13:"MISSING_ATTRIBUTE_VALUE",MISSING_END_TAG_NAME:14,14:"MISSING_END_TAG_NAME",MISSING_WHITESPACE_BETWEEN_ATTRIBUTES:15,15:"MISSING_WHITESPACE_BETWEEN_ATTRIBUTES",NESTED_COMMENT:16,16:"NESTED_COMMENT",UNEXPECTED_CHARACTER_IN_ATTRIBUTE_NAME:17,17:"UNEXPECTED_CHARACTER_IN_ATTRIBUTE_NAME",UNEXPECTED_CHARACTER_IN_UNQUOTED_ATTRIBUTE_VALUE:18,18:"UNEXPECTED_CHARACTER_IN_UNQUOTED_ATTRIBUTE_VALUE",UNEXPECTED_EQUALS_SIGN_BEFORE_ATTRIBUTE_NAME:19,19:"UNEXPECTED_EQUALS_SIGN_BEFORE_ATTRIBUTE_NAME",UNEXPECTED_NULL_CHARACTER:20,20:"UNEXPECTED_NULL_CHARACTER",UNEXPECTED_QUESTION_MARK_INSTEAD_OF_TAG_NAME:21,21:"UNEXPECTED_QUESTION_MARK_INSTEAD_OF_TAG_NAME",UNEXPECTED_SOLIDUS_IN_TAG:22,22:"UNEXPECTED_SOLIDUS_IN_TAG",X_INVALID_END_TAG:23,23:"X_INVALID_END_TAG",X_MISSING_END_TAG:24,24:"X_MISSING_END_TAG",X_MISSING_INTERPOLATION_END:25,25:"X_MISSING_INTERPOLATION_END",X_MISSING_DIRECTIVE_NAME:26,26:"X_MISSING_DIRECTIVE_NAME",X_MISSING_DYNAMIC_DIRECTIVE_ARGUMENT_END:27,27:"X_MISSING_DYNAMIC_DIRECTIVE_ARGUMENT_END",X_V_IF_NO_EXPRESSION:28,28:"X_V_IF_NO_EXPRESSION",X_V_IF_SAME_KEY:29,29:"X_V_IF_SAME_KEY",X_V_ELSE_NO_ADJACENT_IF:30,30:"X_V_ELSE_NO_ADJACENT_IF",X_V_FOR_NO_EXPRESSION:31,31:"X_V_FOR_NO_EXPRESSION",X_V_FOR_MALFORMED_EXPRESSION:32,32:"X_V_FOR_MALFORMED_EXPRESSION",X_V_FOR_TEMPLATE_KEY_PLACEMENT:33,33:"X_V_FOR_TEMPLATE_KEY_PLACEMENT",X_V_BIND_NO_EXPRESSION:34,34:"X_V_BIND_NO_EXPRESSION",X_V_ON_NO_EXPRESSION:35,35:"X_V_ON_NO_EXPRESSION",X_V_SLOT_UNEXPECTED_DIRECTIVE_ON_SLOT_OUTLET:36,36:"X_V_SLOT_UNEXPECTED_DIRECTIVE_ON_SLOT_OUTLET",X_V_SLOT_MIXED_SLOT_USAGE:37,37:"X_V_SLOT_MIXED_SLOT_USAGE",X_V_SLOT_DUPLICATE_SLOT_NAMES:38,38:"X_V_SLOT_DUPLICATE_SLOT_NAMES",X_V_SLOT_EXTRANEOUS_DEFAULT_SLOT_CHILDREN:39,39:"X_V_SLOT_EXTRANEOUS_DEFAULT_SLOT_CHILDREN",X_V_SLOT_MISPLACED:40,40:"X_V_SLOT_MISPLACED",X_V_MODEL_NO_EXPRESSION:41,41:"X_V_MODEL_NO_EXPRESSION",X_V_MODEL_MALFORMED_EXPRESSION:42,42:"X_V_MODEL_MALFORMED_EXPRESSION",X_V_MODEL_ON_SCOPE_VARIABLE:43,43:"X_V_MODEL_ON_SCOPE_VARIABLE",X_V_MODEL_ON_PROPS:44,44:"X_V_MODEL_ON_PROPS",X_V_MODEL_ON_CONST:45,45:"X_V_MODEL_ON_CONST",X_INVALID_EXPRESSION:46,46:"X_INVALID_EXPRESSION",X_KEEP_ALIVE_INVALID_CHILDREN:47,47:"X_KEEP_ALIVE_INVALID_CHILDREN",X_PREFIX_ID_NOT_SUPPORTED:48,48:"X_PREFIX_ID_NOT_SUPPORTED",X_MODULE_MODE_NOT_SUPPORTED:49,49:"X_MODULE_MODE_NOT_SUPPORTED",X_CACHE_HANDLER_NOT_SUPPORTED:50,50:"X_CACHE_HANDLER_NOT_SUPPORTED",X_SCOPE_ID_NOT_SUPPORTED:51,51:"X_SCOPE_ID_NOT_SUPPORTED",X_VNODE_HOOKS:52,52:"X_VNODE_HOOKS",X_V_BIND_INVALID_SAME_NAME_ARGUMENT:53,53:"X_V_BIND_INVALID_SAME_NAME_ARGUMENT",__EXTEND_POINT__:54,54:"__EXTEND_POINT__"},Q7={0:"Illegal comment.",1:"CDATA section is allowed only in XML context.",2:"Duplicate attribute.",3:"End tag cannot have attributes.",4:"Illegal '/' in tags.",5:"Unexpected EOF in tag.",6:"Unexpected EOF in CDATA section.",7:"Unexpected EOF in comment.",8:"Unexpected EOF in script.",9:"Unexpected EOF in tag.",10:"Incorrectly closed comment.",11:"Incorrectly opened comment.",12:"Illegal tag name. Use '&lt;' to print '<'.",13:"Attribute value was expected.",14:"End tag name was expected.",15:"Whitespace was expected.",16:"Unexpected '<!--' in comment.",17:`Attribute name cannot contain U+0022 ("), U+0027 ('), and U+003C (<).`,18:"Unquoted attribute value cannot contain U+0022 (\"), U+0027 ('), U+003C (<), U+003D (=), and U+0060 (`).",19:"Attribute name cannot start with '='.",21:"'<?' is allowed only in XML context.",20:"Unexpected null character.",22:"Illegal '/' in tags.",23:"Invalid end tag.",24:"Element is missing end tag.",25:"Interpolation end sign was not found.",27:"End bracket for dynamic directive argument was not found. Note that dynamic directive argument cannot contain spaces.",26:"Legal directive name was expected.",28:"v-if/v-else-if is missing expression.",29:"v-if/else branches must use unique keys.",30:"v-else/v-else-if has no adjacent v-if or v-else-if.",31:"v-for is missing expression.",32:"v-for has invalid expression.",33:"<template v-for> key should be placed on the <template> tag.",34:"v-bind is missing expression.",53:"v-bind with same-name shorthand only allows static argument.",35:"v-on is missing expression.",36:"Unexpected custom directive on <slot> outlet.",37:"Mixed v-slot usage on both the component and nested <template>. When there are multiple named slots, all slots should use <template> syntax to avoid scope ambiguity.",38:"Duplicate slot names found. ",39:"Extraneous children found when component already has explicitly named default slot. These children will be ignored.",40:"v-slot can only be used on components or <template> tags.",41:"v-model is missing expression.",42:"v-model value must be a valid JavaScript member expression.",43:"v-model cannot be used on v-for or v-slot scope variables because they are not writable.",44:`v-model cannot be used on a prop, because local prop bindings are not writable.
Use a v-bind binding combined with a v-on listener that emits update:x event instead.`,45:"v-model cannot be used on a const binding because it is not writable.",46:"Error parsing JavaScript expression: ",47:"<KeepAlive> expects exactly one child component.",52:"@vnode-* hooks in templates are no longer supported. Use the vue: prefix instead. For example, @vnode-mounted should be changed to @vue:mounted. @vnode-* hooks support has been removed in 3.4.",48:'"prefixIdentifiers" option is not supported in this build of compiler.',49:"ES module mode is not supported in this build of compiler.",50:'"cacheHandlers" option is only supported when the "prefixIdentifiers" option is enabled.',51:'"scopeId" option is only supported in module mode.',54:""};function eG(r,e,t=!1,n=[],i=Object.create(null)){const s=r.type==="Program"?r.body[0].type==="ExpressionStatement"&&r.body[0].expression:r;ele.walk(r,{enter(a,o){if(o&&n.push(o),o&&o.type.startsWith("TS")&&!pk.includes(o.type))return this.skip();if(a.type==="Identifier"){const u=!!i[a.name],f=tG(a,o,n);(t||f&&!u)&&e(a,o,n,f,u)}else if(a.type==="ObjectProperty"&&o?.type==="ObjectPattern")a.inPattern=!0;else if(aG(a))a.scopeIds?a.scopeIds.forEach(u=>im(u,i)):nG(a,u=>Jb(a,u,i));else if(a.type==="BlockStatement")a.scopeIds?a.scopeIds.forEach(u=>im(u,i)):dk(a,u=>Jb(a,u,i));else if(a.type==="SwitchStatement")a.scopeIds?a.scopeIds.forEach(u=>im(u,i)):oG(a,!1,u=>Jb(a,u,i));else if(a.type==="CatchClause"&&a.param)if(a.scopeIds)a.scopeIds.forEach(u=>im(u,i));else for(const u of Gl(a.param))Jb(a,u,i);else iG(a)&&(a.scopeIds?a.scopeIds.forEach(u=>im(u,i)):sG(a,!1,u=>Jb(a,u,i)))},leave(a,o){if(o&&n.pop(),a!==s&&a.scopeIds)for(const u of a.scopeIds)i[u]--,i[u]===0&&delete i[u]}})}function tG(r,e,t){if(!e)return!0;if(r.name==="arguments")return!1;if(ble(r,e,t[t.length-2]))return!0;switch(e.type){case"AssignmentExpression":case"AssignmentPattern":return!0;case"ObjectProperty":return e.key!==r&&_C(e,t);case"ArrayPattern":return _C(e,t)}return!1}function _C(r,e){if(r&&(r.type==="ObjectProperty"||r.type==="ArrayPattern")){let t=e.length;for(;t--;){const n=e[t];if(n.type==="AssignmentExpression")return!0;if(n.type!=="ObjectProperty"&&!n.type.endsWith("Pattern"))break}}return!1}function rG(r){let e=r.length;for(;e--;){const t=r[e];if(t.type==="NewExpression")return!0;if(t.type!=="MemberExpression")break}return!1}function nG(r,e){for(const t of r.params)for(const n of Gl(t))e(n)}function dk(r,e){const t=r.type==="SwitchCase"?r.consequent:r.body;for(const n of t)if(n.type==="VariableDeclaration"){if(n.declare)continue;for(const i of n.declarations)for(const s of Gl(i.id))e(s)}else if(n.type==="FunctionDeclaration"||n.type==="ClassDeclaration"){if(n.declare||!n.id)continue;e(n.id)}else iG(n)?sG(n,!0,e):n.type==="SwitchStatement"&&oG(n,!0,e)}function iG(r){return r.type==="ForOfStatement"||r.type==="ForInStatement"||r.type==="ForStatement"}function sG(r,e,t){const n=r.type==="ForStatement"?r.init:r.left;if(n&&n.type==="VariableDeclaration"&&(n.kind==="var"?e:!e))for(const i of n.declarations)for(const s of Gl(i.id))t(s)}function oG(r,e,t){for(const n of r.cases){for(const i of n.consequent)if(i.type==="VariableDeclaration"&&(i.kind==="var"?e:!e))for(const s of i.declarations)for(const a of Gl(s.id))t(a);dk(n,t)}}function Gl(r,e=[]){switch(r.type){case"Identifier":e.push(r);break;case"MemberExpression":let t=r;for(;t.type==="MemberExpression";)t=t.object;e.push(t);break;case"ObjectPattern":for(const n of r.properties)n.type==="RestElement"?Gl(n.argument,e):Gl(n.value,e);break;case"ArrayPattern":r.elements.forEach(n=>{n&&Gl(n,e)});break;case"RestElement":Gl(r.argument,e);break;case"AssignmentPattern":Gl(r.left,e);break}return e}function im(r,e){r in e?e[r]++:e[r]=1}function Jb(r,e,t){const{name:n}=e;r.scopeIds&&r.scopeIds.has(n)||(im(n,t),(r.scopeIds||(r.scopeIds=new Set)).add(n))}const aG=r=>/Function(?:Expression|Declaration)$|Method$/.test(r.type),fk=r=>r&&(r.type==="ObjectProperty"||r.type==="ObjectMethod")&&!r.computed,lG=(r,e)=>fk(e)&&e.key===r;function ble(r,e,t){switch(e.type){case"MemberExpression":case"OptionalMemberExpression":return e.property===r?!!e.computed:e.object===r;case"JSXMemberExpression":return e.object===r;case"VariableDeclarator":return e.init===r;case"ArrowFunctionExpression":return e.body===r;case"PrivateName":return!1;case"ClassMethod":case"ClassPrivateMethod":case"ObjectMethod":return e.key===r?!!e.computed:!1;case"ObjectProperty":return e.key===r?!!e.computed:!t||t.type!=="ObjectPattern";case"ClassProperty":return e.key===r?!!e.computed:!0;case"ClassPrivateProperty":return e.key!==r;case"ClassDeclaration":case"ClassExpression":return e.superClass===r;case"AssignmentExpression":return e.right===r;case"AssignmentPattern":return e.right===r;case"LabeledStatement":return!1;case"CatchClause":return!1;case"RestElement":return!1;case"BreakStatement":case"ContinueStatement":return!1;case"FunctionDeclaration":case"FunctionExpression":return!1;case"ExportNamespaceSpecifier":case"ExportDefaultSpecifier":return!1;case"ExportSpecifier":return t?.source?!1:e.local===r;case"ImportDefaultSpecifier":case"ImportNamespaceSpecifier":case"ImportSpecifier":return!1;case"ImportAttribute":return!1;case"JSXAttribute":return!1;case"ObjectPattern":case"ArrayPattern":return!1;case"MetaProperty":return!1;case"ObjectTypeProperty":return e.key!==r;case"TSEnumMember":return e.id!==r;case"TSPropertySignature":return e.key===r?!!e.computed:!0}return!0}const pk=["TSAsExpression","TSTypeAssertion","TSNonNullExpression","TSInstantiationExpression","TSSatisfiesExpression"];function CS(r){return pk.includes(r.type)?CS(r.expression):r}const Kl=r=>r.type===4&&r.isStatic;function gk(r){switch(r){case"Teleport":case"teleport":return Om;case"Suspense":case"suspense":return lS;case"KeepAlive":case"keep-alive":return P_;case"BaseTransition":case"base-transition":return ik}}const _le=/^$|^\d|[^\$\w\xA0-\uFFFF]/,Ju=r=>!_le.test(r),mk=/[A-Za-z_$\xA0-\uFFFF]/,vle=/[\.\?\w$\xA0-\uFFFF]/,Ale=/\s+[.[]\s*|\s*[.[]\s+/g,TS=r=>r.type===4?r.content:r.loc.source,xle=r=>{const e=TS(r).trim().replace(Ale,o=>o.trim());let t=0,n=[],i=0,s=0,a=null;for(let o=0;o<e.length;o++){const u=e.charAt(o);switch(t){case 0:if(u==="[")n.push(t),t=1,i++;else if(u==="(")n.push(t),t=2,s++;else if(!(o===0?mk:vle).test(u))return!1;break;case 1:u==="'"||u==='"'||u==="`"?(n.push(t),t=3,a=u):u==="["?i++:u==="]"&&(--i||(t=n.pop()));break;case 2:if(u==="'"||u==='"'||u==="`")n.push(t),t=3,a=u;else if(u==="(")s++;else if(u===")"){if(o===e.length-1)return!1;--s||(t=n.pop())}break;case 3:u===a&&(t=n.pop(),a=null);break}}return!i&&!s},cG=(r,e)=>{try{let t=r.ast||km.parseExpression(TS(r),{plugins:e.expressionPlugins?[...e.expressionPlugins,"typescript"]:["typescript"]});return t=CS(t),t.type==="MemberExpression"||t.type==="OptionalMemberExpression"||t.type==="Identifier"&&t.name!=="undefined"}catch{return!1}},yk=cG,wle=/^\s*(?:async\s*)?(?:\([^)]*?\)|[\w$_]+)\s*(?::[^=]+)?=>|^\s*(?:async\s+)?function(?:\s+[\w$]+)?\s*\(/,Cle=r=>wle.test(TS(r)),uG=(r,e)=>{try{let t=r.ast||km.parseExpression(TS(r),{plugins:e.expressionPlugins?[...e.expressionPlugins,"typescript"]:["typescript"]});return t.type==="Program"&&(t=t.body[0],t.type==="ExpressionStatement"&&(t=t.expression)),t=CS(t),t.type==="FunctionExpression"||t.type==="ArrowFunctionExpression"}catch{return!1}},hG=uG;function D3(r,e,t=e.length){return bk({offset:r.offset,line:r.line,column:r.column},e,t)}function bk(r,e,t=e.length){let n=0,i=-1;for(let s=0;s<t;s++)e.charCodeAt(s)===10&&(n++,i=s);return r.offset+=t,r.line+=n,r.column=i===-1?r.column+t:t-i,r}function Tle(r,e){if(!r)throw new Error(e||"unexpected compiler condition")}function Vo(r,e,t=!1){for(let n=0;n<r.props.length;n++){const i=r.props[n];if(i.type===7&&(t||i.exp)&&(or.isString(e)?i.name===e:e.test(i.name)))return i}}function L_(r,e,t=!1,n=!1){for(let i=0;i<r.props.length;i++){const s=r.props[i];if(s.type===6){if(t)continue;if(s.name===e&&(s.value||n))return s}else if(s.name==="bind"&&(s.exp||n)&&id(s.arg,e))return s}}function id(r,e){return!!(r&&Kl(r)&&r.content===e)}function Sle(r){return r.props.some(e=>e.type===7&&e.name==="bind"&&(!e.arg||e.arg.type!==4||!e.arg.isStatic))}function uw(r){return r.type===5||r.type===2}function L3(r){return r.type===7&&r.name==="pre"}function SS(r){return r.type===7&&r.name==="slot"}function Zm(r){return r.type===1&&r.tagType===3}function N_(r){return r.type===1&&r.tagType===2}const Ele=new Set([qm,wy]);function dG(r,e=[]){if(r&&!or.isString(r)&&r.type===14){const t=r.callee;if(!or.isString(t)&&Ele.has(t))return dG(r.arguments[0],e.concat(r))}return[r,e]}function F_(r,e,t){let n,i=r.type===13?r.props:r.arguments[2],s=[],a;if(i&&!or.isString(i)&&i.type===14){const o=dG(i);i=o[0],s=o[1],a=s[s.length-1]}if(i==null||or.isString(i))n=Fa([e]);else if(i.type===14){const o=i.arguments[0];!or.isString(o)&&o.type===15?A4(e,o)||o.properties.unshift(e):i.callee===vS?n=ro(t.helper(M_),[Fa([e]),i]):i.arguments.unshift(Fa([e])),!n&&(n=i)}else i.type===15?(A4(e,i)||i.properties.unshift(e),n=i):(n=ro(t.helper(M_),[Fa([e]),i]),a&&a.callee===wy&&(a=s[s.length-2]));r.type===13?a?a.arguments[0]=n:r.props=n:a?a.arguments[0]=n:r.arguments[2]=n}function A4(r,e){let t=!1;if(r.key.type===4){const n=r.key.content;t=e.properties.some(i=>i.key.type===4&&i.key.content===n)}return t}function up(r,e){return`_${e}_${r.replace(/[^\w]/g,(t,n)=>t==="-"?"_":r.charCodeAt(n).toString())}`}function mo(r,e){if(!r||Object.keys(e).length===0)return!1;switch(r.type){case 1:for(let t=0;t<r.props.length;t++){const n=r.props[t];if(n.type===7&&(mo(n.arg,e)||mo(n.exp,e)))return!0}return r.children.some(t=>mo(t,e));case 11:return mo(r.source,e)?!0:r.children.some(t=>mo(t,e));case 9:return r.branches.some(t=>mo(t,e));case 10:return mo(r.condition,e)?!0:r.children.some(t=>mo(t,e));case 4:return!r.isStatic&&Ju(r.content)&&!!e[r.content];case 8:return r.children.some(t=>or.isObject(t)&&mo(t,e));case 5:case 12:return mo(r.content,e);case 2:case 3:case 20:return!1;default:return!1}}function fG(r){return r.type===14&&r.callee===xS?r.arguments[1].returns:r}const pG=/([\s\S]*?)\s+(?:in|of)\s+(\S[\s\S]*)/;function _k(r){for(let e=0;e<r.length;e++)if(!Da(r.charCodeAt(e)))return!1;return!0}function ES(r){return r.type===2&&_k(r.content)||r.type===12&&ES(r.content)}function vk(r){return r.type===3||ES(r)}const gG={parseMode:"base",ns:0,delimiters:["{{","}}"],getNamespace:()=>0,isVoidTag:or.NO,isPreTag:or.NO,isIgnoreNewlineTag:or.NO,isCustomElement:or.NO,onError:hk,onWarn:Z7,comments:!1,prefixIdentifiers:!1};let Gn=gG,U_=null,ju="",yo=null,rn=null,ol="",Mu=-1,Bf=-1,Ak=0,Zh=!1,N3=null;const ji=[],pi=new fle(ji,{onerr:Lo,ontext(r,e){$1(Qs(r,e),r,e)},ontextentity(r,e,t){$1(r,e,t)},oninterpolation(r,e){if(Zh)return $1(Qs(r,e),r,e);let t=r+pi.delimiterOpen.length,n=e-pi.delimiterClose.length;for(;Da(ju.charCodeAt(t));)t++;for(;Da(ju.charCodeAt(n-1));)n--;let i=Qs(t,n);i.includes("&")&&(i=Pf.decodeHTML(i)),F3({type:5,content:dw(i,!1,Qi(t,n)),loc:Qi(r,e)})},onopentagname(r,e){const t=Qs(r,e);yo={type:1,tag:t,ns:Gn.getNamespace(t,ji[0],Gn.ns),tagType:0,props:[],children:[],loc:Qi(r-1,e),codegenNode:void 0}},onopentagend(r){w4(r)},onclosetag(r,e){const t=Qs(r,e);if(!Gn.isVoidTag(t)){let n=!1;for(let i=0;i<ji.length;i++)if(ji[i].tag.toLowerCase()===t.toLowerCase()){n=!0,i>0&&Lo(24,ji[0].loc.start.offset);for(let a=0;a<=i;a++){const o=ji.shift();hw(o,e,a<i)}break}n||Lo(23,mG(r,60))}},onselfclosingtag(r){const e=yo.tag;yo.isSelfClosing=!0,w4(r),ji[0]&&ji[0].tag===e&&hw(ji.shift(),r)},onattribname(r,e){rn={type:6,name:Qs(r,e),nameLoc:Qi(r,e),value:void 0,loc:Qi(r)}},ondirname(r,e){const t=Qs(r,e),n=t==="."||t===":"?"bind":t==="@"?"on":t==="#"?"slot":t.slice(2);if(!Zh&&n===""&&Lo(26,r),Zh||n==="")rn={type:6,name:t,nameLoc:Qi(r,e),value:void 0,loc:Qi(r)};else if(rn={type:7,name:n,rawName:t,exp:void 0,arg:void 0,modifiers:t==="."?[Wr("prop")]:[],loc:Qi(r)},n==="pre"){Zh=pi.inVPre=!0,N3=yo;const i=yo.props;for(let s=0;s<i.length;s++)i[s].type===7&&(i[s]=Nle(i[s]))}},ondirarg(r,e){if(r===e)return;const t=Qs(r,e);if(Zh&&!L3(rn))rn.name+=t,Ff(rn.nameLoc,e);else{const n=t[0]!=="[";rn.arg=dw(n?t:t.slice(1,-1),n,Qi(r,e),n?3:0)}},ondirmodifier(r,e){const t=Qs(r,e);if(Zh&&!L3(rn))rn.name+="."+t,Ff(rn.nameLoc,e);else if(rn.name==="slot"){const n=rn.arg;n&&(n.content+="."+t,Ff(n.loc,e))}else{const n=Wr(t,!0,Qi(r,e));rn.modifiers.push(n)}},onattribdata(r,e){ol+=Qs(r,e),Mu<0&&(Mu=r),Bf=e},onattribentity(r,e,t){ol+=r,Mu<0&&(Mu=e),Bf=t},onattribnameend(r){const e=rn.loc.start.offset,t=Qs(e,r);rn.type===7&&(rn.rawName=t),yo.props.some(n=>(n.type===7?n.rawName:n.name)===t)&&Lo(2,e)},onattribend(r,e){if(yo&&rn){if(Ff(rn.loc,e),r!==0)if(rn.type===6)rn.name==="class"&&(ol=bG(ol).trim()),r===1&&!ol&&Lo(13,e),rn.value={type:2,content:ol,loc:r===1?Qi(Mu,Bf):Qi(Mu-1,Bf+1)},pi.inSFCRoot&&yo.tag==="template"&&rn.name==="lang"&&ol&&ol!=="html"&&pi.enterRCDATA(bC("</template"),0);else{let t=0;rn.name==="for"?t=3:rn.name==="slot"?t=1:rn.name==="on"&&ol.includes(";")&&(t=2),rn.exp=dw(ol,!1,Qi(Mu,Bf),0,t),rn.name==="for"&&(rn.forParseResult=Ple(rn.exp));let n=-1;rn.name==="bind"&&(n=rn.modifiers.findIndex(i=>i.content==="sync"))>-1&&D_("COMPILER_V_BIND_SYNC",Gn,rn.loc,rn.arg.loc.source)&&(rn.name="model",rn.modifiers.splice(n,1))}(rn.type!==7||rn.name!=="pre")&&yo.props.push(rn)}ol="",Mu=Bf=-1},oncomment(r,e){Gn.comments&&F3({type:3,content:Qs(r,e),loc:Qi(r-4,e+3)})},onend(){const r=ju.length;if(pi.state!==1)switch(pi.state){case 5:case 8:Lo(5,r);break;case 3:case 4:Lo(25,pi.sectionStart);break;case 28:pi.currentSequence===Zs.CdataEnd?Lo(6,r):Lo(7,r);break;case 6:case 7:case 9:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:Lo(9,r);break}for(let e=0;e<ji.length;e++)hw(ji[e],r-1),Lo(24,ji[e].loc.start.offset)},oncdata(r,e){ji[0].ns!==0?$1(Qs(r,e),r,e):Lo(1,r-9)},onprocessinginstruction(r){(ji[0]?ji[0].ns:Gn.ns)===0&&Lo(21,r-1)}}),x4=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,Ile=/^\(|\)$/g;function Ple(r){const e=r.loc,t=r.content,n=t.match(pG);if(!n)return;const[,i,s]=n,a=(y,A,C=!1)=>{const M=e.start.offset+A,k=M+y.length;return dw(y,!1,Qi(M,k),0,C?1:0)},o={source:a(s.trim(),t.indexOf(s,i.length)),value:void 0,key:void 0,index:void 0,finalized:!1};let u=i.trim().replace(Ile,"").trim();const f=i.indexOf(u),g=u.match(x4);if(g){u=u.replace(x4,"").trim();const y=g[1].trim();let A;if(y&&(A=t.indexOf(y,f+u.length),o.key=a(y,A,!0)),g[2]){const C=g[2].trim();C&&(o.index=a(C,t.indexOf(C,o.key?A+y.length:f+u.length),!0))}}return u&&(o.value=a(u,f,!0)),o}function Qs(r,e){return ju.slice(r,e)}function w4(r){pi.inSFCRoot&&(yo.innerLoc=Qi(r+1,r+1)),F3(yo);const{tag:e,ns:t}=yo;t===0&&Gn.isPreTag(e)&&Ak++,Gn.isVoidTag(e)?hw(yo,r):(ji.unshift(yo),(t===1||t===2)&&(pi.inXML=!0)),yo=null}function $1(r,e,t){const n=ji[0]||U_,i=n.children[n.children.length-1];i&&i.type===2?(i.content+=r,Ff(i.loc,t)):n.children.push({type:2,content:r,loc:Qi(e,t)})}function hw(r,e,t=!1){t?Ff(r.loc,mG(e,60)):Ff(r.loc,Ble(e,62)+1),pi.inSFCRoot&&(r.children.length?r.innerLoc.end=or.extend({},r.children[r.children.length-1].loc.end):r.innerLoc.end=or.extend({},r.innerLoc.start),r.innerLoc.source=Qs(r.innerLoc.start.offset,r.innerLoc.end.offset));const{tag:n,ns:i,children:s}=r;if(Zh||(n==="slot"?r.tagType=2:C4(r)?r.tagType=3:Rle(r)&&(r.tagType=1)),pi.inRCDATA||(r.children=yG(s)),i===0&&Gn.isIgnoreNewlineTag(n)){const a=s[0];a&&a.type===2&&(a.content=a.content.replace(/^\r?\n/,""))}i===0&&Gn.isPreTag(n)&&Ak--,N3===r&&(Zh=pi.inVPre=!1,N3=null),pi.inXML&&(ji[0]?ji[0].ns:Gn.ns)===0&&(pi.inXML=!1);{const a=r.props;if(!pi.inSFCRoot&&Kf("COMPILER_NATIVE_TEMPLATE",Gn)&&r.tag==="template"&&!C4(r)){const u=ji[0]||U_,f=u.children.indexOf(r);u.children.splice(f,1,...r.children)}const o=a.find(u=>u.type===6&&u.name==="inline-template");o&&D_("COMPILER_INLINE_TEMPLATE",Gn,o.loc)&&r.children.length&&(o.value={type:2,content:Qs(r.children[0].loc.start.offset,r.children[r.children.length-1].loc.end.offset),loc:o.loc})}}function Ble(r,e){let t=r;for(;ju.charCodeAt(t)!==e&&t<ju.length-1;)t++;return t}function mG(r,e){let t=r;for(;ju.charCodeAt(t)!==e&&t>=0;)t--;return t}const Mle=new Set(["if","else","else-if","for","slot"]);function C4({tag:r,props:e}){if(r==="template"){for(let t=0;t<e.length;t++)if(e[t].type===7&&Mle.has(e[t].name))return!0}return!1}function Rle({tag:r,props:e}){if(Gn.isCustomElement(r))return!1;if(r==="component"||kle(r.charCodeAt(0))||gk(r)||Gn.isBuiltInComponent&&Gn.isBuiltInComponent(r)||Gn.isNativeTag&&!Gn.isNativeTag(r))return!0;for(let t=0;t<e.length;t++){const n=e[t];if(n.type===6){if(n.name==="is"&&n.value){if(n.value.content.startsWith("vue:"))return!0;if(D_("COMPILER_IS_ON_ELEMENT",Gn,n.loc))return!0}}else if(n.name==="bind"&&id(n.arg,"is")&&D_("COMPILER_IS_ON_ELEMENT",Gn,n.loc))return!0}return!1}function kle(r){return r>64&&r<91}const Ole=/\r\n/g;function yG(r){const e=Gn.whitespace!=="preserve";let t=!1;for(let n=0;n<r.length;n++){const i=r[n];if(i.type===2)if(Ak)i.content=i.content.replace(Ole,`
`);else if(_k(i.content)){const s=r[n-1]&&r[n-1].type,a=r[n+1]&&r[n+1].type;!s||!a||e&&(s===3&&(a===3||a===1)||s===1&&(a===3||a===1&&Dle(i.content)))?(t=!0,r[n]=null):i.content=" "}else e&&(i.content=bG(i.content))}return t?r.filter(Boolean):r}function Dle(r){for(let e=0;e<r.length;e++){const t=r.charCodeAt(e);if(t===10||t===13)return!0}return!1}function bG(r){let e="",t=!1;for(let n=0;n<r.length;n++)Da(r.charCodeAt(n))?t||(e+=" ",t=!0):(e+=r[n],t=!1);return e}function F3(r){(ji[0]||U_).children.push(r)}function Qi(r,e){return{start:pi.getPos(r),end:e==null?e:pi.getPos(e),source:e==null?e:Qs(r,e)}}function Lle(r){return Qi(r.start.offset,r.end.offset)}function Ff(r,e){r.end=pi.getPos(e),r.source=Qs(r.start.offset,e)}function Nle(r){const e={type:6,name:r.rawName,nameLoc:Qi(r.loc.start.offset,r.loc.start.offset+r.rawName.length),value:void 0,loc:r.loc};if(r.exp){const t=r.exp.loc;t.end.offset<r.loc.end.offset&&(t.start.offset--,t.start.column--,t.end.offset++,t.end.column++),e.value={type:2,content:r.exp.content,loc:t}}return e}function dw(r,e=!1,t,n=0,i=0){const s=Wr(r,e,t,n);if(!e&&Gn.prefixIdentifiers&&i!==3&&r.trim()){if(Ju(r))return s.ast=null,s;try{const a=Gn.expressionPlugins,o={plugins:a?[...a,"typescript"]:["typescript"]};i===2?s.ast=km.parse(` ${r} `,o).program:i===1?s.ast=km.parseExpression(`(${r})=>{}`,o):s.ast=km.parseExpression(`(${r})`,o)}catch(a){s.ast=!1,Lo(46,t.start.offset,a.message)}}return s}function Lo(r,e,t){Gn.onError(ti(r,Qi(e,e),void 0,t))}function Fle(){pi.reset(),yo=null,rn=null,ol="",Mu=-1,Bf=-1,ji.length=0}function _G(r,e){if(Fle(),ju=r,Gn=or.extend({},gG),e){let i;for(i in e)e[i]!=null&&(Gn[i]=e[i])}pi.mode=Gn.parseMode==="html"?1:Gn.parseMode==="sfc"?2:0,pi.inXML=Gn.ns===1||Gn.ns===2;const t=e&&e.delimiters;t&&(pi.delimiterOpen=bC(t[0]),pi.delimiterClose=bC(t[1]));const n=U_=J7([],r);return pi.parse(ju),n.loc=Qi(0,r.length),n.children=yG(n.children),U_=null,n}function Ule(r,e){fw(r,void 0,e,!!vG(r))}function vG(r){const e=r.children.filter(t=>t.type!==3);return e.length===1&&e[0].type===1&&!N_(e[0])?e[0]:null}function fw(r,e,t,n=!1,i=!1){const{children:s}=r,a=[];for(let g=0;g<s.length;g++){const y=s[g];if(y.type===1&&y.tagType===0){const A=n?0:Ua(y,t);if(A>0){if(A>=2){y.codegenNode.patchFlag=-1,a.push(y);continue}}else{const C=y.codegenNode;if(C.type===13){const M=C.patchFlag;if((M===void 0||M===512||M===1)&&xG(y,t)>=2){const k=wG(y);k&&(C.props=t.hoist(k))}C.dynamicProps&&(C.dynamicProps=t.hoist(C.dynamicProps))}}}else if(y.type===12&&(n?0:Ua(y,t))>=2){y.codegenNode.type===14&&y.codegenNode.arguments.length>0&&y.codegenNode.arguments.push("-1"),a.push(y);continue}if(y.type===1){const A=y.tagType===1;A&&t.scopes.vSlot++,fw(y,r,t,!1,i),A&&t.scopes.vSlot--}else if(y.type===11)fw(y,r,t,y.children.length===1,!0);else if(y.type===9)for(let A=0;A<y.branches.length;A++)fw(y.branches[A],r,t,y.branches[A].children.length===1,i)}let o=!1;if(a.length===s.length&&r.type===1){if(r.tagType===0&&r.codegenNode&&r.codegenNode.type===13&&or.isArray(r.codegenNode.children))r.codegenNode.children=u(md(r.codegenNode.children)),o=!0;else if(r.tagType===1&&r.codegenNode&&r.codegenNode.type===13&&r.codegenNode.children&&!or.isArray(r.codegenNode.children)&&r.codegenNode.children.type===15){const g=f(r.codegenNode,"default");g&&(g.returns=u(md(g.returns)),o=!0)}else if(r.tagType===3&&e&&e.type===1&&e.tagType===1&&e.codegenNode&&e.codegenNode.type===13&&e.codegenNode.children&&!or.isArray(e.codegenNode.children)&&e.codegenNode.children.type===15){const g=Vo(r,"slot",!0),y=g&&g.arg&&f(e.codegenNode,g.arg);y&&(y.returns=u(md(y.returns)),o=!0)}}if(!o)for(const g of a)g.codegenNode=t.cache(g.codegenNode);function u(g){const y=t.cache(g);return y.needArraySpread=!0,y}function f(g,y){if(g.children&&!or.isArray(g.children)&&g.children.type===15){const A=g.children.properties.find(C=>C.key===y||C.key.content===y);return A&&A.value}}a.length&&t.transformHoist&&t.transformHoist(s,t,r)}function Ua(r,e){const{constantCache:t}=e;switch(r.type){case 1:if(r.tagType!==0)return 0;const n=t.get(r);if(n!==void 0)return n;const i=r.codegenNode;if(i.type!==13||i.isBlock&&r.tag!=="svg"&&r.tag!=="foreignObject"&&r.tag!=="math")return 0;if(i.patchFlag===void 0){let a=3;const o=xG(r,e);if(o===0)return t.set(r,0),0;o<a&&(a=o);for(let u=0;u<r.children.length;u++){const f=Ua(r.children[u],e);if(f===0)return t.set(r,0),0;f<a&&(a=f)}if(a>1)for(let u=0;u<r.props.length;u++){const f=r.props[u];if(f.type===7&&f.name==="bind"&&f.exp){const g=Ua(f.exp,e);if(g===0)return t.set(r,0),0;g<a&&(a=g)}}if(i.isBlock){for(let u=0;u<r.props.length;u++)if(r.props[u].type===7)return t.set(r,0),0;e.removeHelper(vd),e.removeHelper(cp(e.inSSR,i.isComponent)),i.isBlock=!1,e.helper(lp(e.inSSR,i.isComponent))}return t.set(r,a),a}else return t.set(r,0),0;case 2:case 3:return 3;case 9:case 11:case 10:return 0;case 5:case 12:return Ua(r.content,e);case 4:return r.constType;case 8:let s=3;for(let a=0;a<r.children.length;a++){const o=r.children[a];if(or.isString(o)||or.isSymbol(o))continue;const u=Ua(o,e);if(u===0)return 0;u<s&&(s=u)}return s;case 20:return 2;default:return 0}}const zle=new Set([bS,_S,qm,wy]);function AG(r,e){if(r.type===14&&!or.isString(r.callee)&&zle.has(r.callee)){const t=r.arguments[0];if(t.type===4)return Ua(t,e);if(t.type===14)return AG(t,e)}return 0}function xG(r,e){let t=3;const n=wG(r);if(n&&n.type===15){const{properties:i}=n;for(let s=0;s<i.length;s++){const{key:a,value:o}=i[s],u=Ua(a,e);if(u===0)return u;u<t&&(t=u);let f;if(o.type===4?f=Ua(o,e):o.type===14?f=AG(o,e):f=0,f===0)return f;f<t&&(t=f)}}return t}function wG(r){const e=r.codegenNode;if(e.type===13)return e.props}function CG(r,{filename:e="",prefixIdentifiers:t=!1,hoistStatic:n=!1,hmr:i=!1,cacheHandlers:s=!1,nodeTransforms:a=[],directiveTransforms:o={},transformHoist:u=null,isBuiltInComponent:f=or.NOOP,isCustomElement:g=or.NOOP,expressionPlugins:y=[],scopeId:A=null,slotted:C=!0,ssr:M=!1,inSSR:k=!1,ssrCssVars:D="",bindingMetadata:V=or.EMPTY_OBJ,inline:W=!1,isTS:z=!1,onError:$=hk,onWarn:te=Z7,compatConfig:le}){const _e=e.replace(/\?.*$/,"").match(/([^/\\]+)\.\w+$/),se={filename:e,selfName:_e&&or.capitalize(or.camelize(_e[1])),prefixIdentifiers:t,hoistStatic:n,hmr:i,cacheHandlers:s,nodeTransforms:a,directiveTransforms:o,transformHoist:u,isBuiltInComponent:f,isCustomElement:g,expressionPlugins:y,scopeId:A,slotted:C,ssr:M,inSSR:k,ssrCssVars:D,bindingMetadata:V,inline:W,isTS:z,onError:$,onWarn:te,compatConfig:le,root:r,helpers:new Map,components:new Set,directives:new Set,hoists:[],imports:[],cached:[],constantCache:new WeakMap,temps:0,identifiers:Object.create(null),scopes:{vFor:0,vSlot:0,vPre:0,vOnce:0},parent:null,grandParent:null,currentNode:r,childIndex:0,inVOnce:!1,helper(oe){const Me=se.helpers.get(oe)||0;return se.helpers.set(oe,Me+1),oe},removeHelper(oe){const Me=se.helpers.get(oe);if(Me){const ze=Me-1;ze?se.helpers.set(oe,ze):se.helpers.delete(oe)}},helperString(oe){return`_${aa[se.helper(oe)]}`},replaceNode(oe){se.parent.children[se.childIndex]=se.currentNode=oe},removeNode(oe){const Me=se.parent.children,ze=oe?Me.indexOf(oe):se.currentNode?se.childIndex:-1;!oe||oe===se.currentNode?(se.currentNode=null,se.onNodeRemoved()):se.childIndex>ze&&(se.childIndex--,se.onNodeRemoved()),se.parent.children.splice(ze,1)},onNodeRemoved:or.NOOP,addIdentifiers(oe){or.isString(oe)?Y(oe):oe.identifiers?oe.identifiers.forEach(Y):oe.type===4&&Y(oe.content)},removeIdentifiers(oe){or.isString(oe)?ce(oe):oe.identifiers?oe.identifiers.forEach(ce):oe.type===4&&ce(oe.content)},hoist(oe){or.isString(oe)&&(oe=Wr(oe)),se.hoists.push(oe);const Me=Wr(`_hoisted_${se.hoists.length}`,!1,oe.loc,2);return Me.hoisted=oe,Me},cache(oe,Me=!1,ze=!1){const Ve=q7(se.cached.length,oe,Me,ze);return se.cached.push(Ve),Ve}};se.filters=new Set;function Y(oe){const{identifiers:Me}=se;Me[oe]===void 0&&(Me[oe]=0),Me[oe]++}function ce(oe){se.identifiers[oe]--}return se}function TG(r,e){const t=CG(r,e);Hv(r,t),e.hoistStatic&&Ule(r,t),e.ssr||Vle(r,t),r.helpers=new Set([...t.helpers.keys()]),r.components=[...t.components],r.directives=[...t.directives],r.imports=t.imports,r.hoists=t.hoists,r.temps=t.temps,r.cached=t.cached,r.transformed=!0,r.filters=[...t.filters]}function Vle(r,e){const{helper:t}=e,{children:n}=r;if(n.length===1){const i=vG(r);if(i&&i.codegenNode){const s=i.codegenNode;s.type===13&&wS(s,e),r.codegenNode=s}else r.codegenNode=n[0]}else if(n.length>1){let i=64;r.codegenNode=Ym(e,t(Jm),void 0,r.children,i,void 0,void 0,!0,void 0,!1)}}function $le(r,e){let t=0;const n=()=>{t--};for(;t<r.children.length;t++){const i=r.children[t];or.isString(i)||(e.grandParent=e.parent,e.parent=r,e.childIndex=t,e.onNodeRemoved=n,Hv(i,e))}}function Hv(r,e){e.currentNode=r;const{nodeTransforms:t}=e,n=[];for(let s=0;s<t.length;s++){const a=t[s](r,e);if(a&&(or.isArray(a)?n.push(...a):n.push(a)),e.currentNode)r=e.currentNode;else return}switch(r.type){case 3:e.ssr||e.helper(xy);break;case 5:e.ssr||e.helper(yS);break;case 9:for(let s=0;s<r.branches.length;s++)Hv(r.branches[s],e);break;case 10:case 11:case 1:case 0:$le(r,e);break}e.currentNode=r;let i=n.length;for(;i--;)n[i]()}function xk(r,e){const t=or.isString(r)?n=>n===r:n=>r.test(n);return(n,i)=>{if(n.type===1){const{props:s}=n;if(n.tagType===3&&s.some(SS))return;const a=[];for(let o=0;o<s.length;o++){const u=s[o];if(u.type===7&&t(u.name)){s.splice(o,1),o--;const f=e(n,u,i);f&&a.push(f)}}return a}}}const IS="/*@__PURE__*/",pw=r=>`${aa[r]}: _${aa[r]}`;function T4(r,{mode:e="function",prefixIdentifiers:t=e==="module",sourceMap:n=!1,filename:i="template.vue.html",scopeId:s=null,optimizeImports:a=!1,runtimeGlobalName:o="Vue",runtimeModuleName:u="vue",ssrRuntimeModuleName:f="vue/server-renderer",ssr:g=!1,isTS:y=!1,inSSR:A=!1}){const C={mode:e,prefixIdentifiers:t,sourceMap:n,filename:i,scopeId:s,optimizeImports:a,runtimeGlobalName:o,runtimeModuleName:u,ssrRuntimeModuleName:f,ssr:g,isTS:y,inSSR:A,source:r.source,code:"",column:1,line:1,offset:0,indentLevel:0,pure:!1,map:void 0,helper(D){return`_${aa[D]}`},push(D,V=-2,W){if(C.code+=D,C.map){if(W){let z;if(W.type===4&&!W.isStatic){const $=W.content.replace(/^_ctx\./,"");$!==W.content&&Ju($)&&(z=$)}W.loc.source&&k(W.loc.start,z)}V===-3?bk(C,D):(C.offset+=D.length,V===-2?C.column+=D.length:(V===-1&&(V=D.length-1),C.line++,C.column=D.length-V)),W&&W.loc!==ws&&W.loc.source&&k(W.loc.end)}},indent(){M(++C.indentLevel)},deindent(D=!1){D?--C.indentLevel:M(--C.indentLevel)},newline(){M(C.indentLevel)}};function M(D){C.push(`
`+"  ".repeat(D),0)}function k(D,V=null){const{_names:W,_mappings:z}=C.map;V!==null&&!W.has(V)&&W.add(V),z.add({originalLine:D.line,originalColumn:D.column-1,generatedLine:C.line,generatedColumn:C.column-1,source:i,name:V})}return n&&(C.map=new tle.SourceMapGenerator,C.map.setSourceContent(i,C.source),C.map._sources.add(i)),C}function SG(r,e={}){const t=T4(r,e);e.onContextCreated&&e.onContextCreated(t);const{mode:n,push:i,prefixIdentifiers:s,indent:a,deindent:o,newline:u,scopeId:f,ssr:g}=t,y=Array.from(r.helpers),A=y.length>0,C=!s&&n!=="module",M=f!=null&&n==="module",k=!!e.inline,D=k?T4(r,e):t;n==="module"?Gle(r,D,M,k):jle(r,D);const V=g?"ssrRender":"render",W=g?["_ctx","_push","_parent","_attrs"]:["_ctx","_cache"];e.bindingMetadata&&!e.inline&&W.push("$props","$setup","$data","$options");const z=e.isTS?W.map($=>`${$}: any`).join(","):W.join(", ");if(i(k?`(${z}) => {`:`function ${V}(${z}) {`),a(),C&&(i("with (_ctx) {"),a(),A&&(i(`const { ${y.map(pw).join(", ")} } = _Vue
`,-1),u())),r.components.length&&(sI(r.components,"component",t),(r.directives.length||r.temps>0)&&u()),r.directives.length&&(sI(r.directives,"directive",t),r.temps>0&&u()),r.filters&&r.filters.length&&(u(),sI(r.filters,"filter",t),u()),r.temps>0){i("let ");for(let $=0;$<r.temps;$++)i(`${$>0?", ":""}_temp${$}`)}return(r.components.length||r.directives.length||r.temps)&&(i(`
`,0),u()),g||i("return "),r.codegenNode?Bi(r.codegenNode,t):i("null"),C&&(o(),i("}")),o(),i("}"),{ast:r,code:t.code,preamble:k?D.code:"",map:t.map?t.map.toJSON():void 0}}function jle(r,e){const{ssr:t,prefixIdentifiers:n,push:i,newline:s,runtimeModuleName:a,runtimeGlobalName:o,ssrRuntimeModuleName:u}=e,f=t?`require(${JSON.stringify(a)})`:o,g=Array.from(r.helpers);if(g.length>0){if(n)i(`const { ${g.map(pw).join(", ")} } = ${f}
`,-1);else if(i(`const _Vue = ${f}
`,-1),r.hoists.length){const y=[cS,uS,xy,hS,ak].filter(A=>g.includes(A)).map(pw).join(", ");i(`const { ${y} } = _Vue
`,-1)}}r.ssrHelpers&&r.ssrHelpers.length&&i(`const { ${r.ssrHelpers.map(pw).join(", ")} } = require("${u}")
`,-1),EG(r.hoists,e),s(),i("return ")}function Gle(r,e,t,n){const{push:i,newline:s,optimizeImports:a,runtimeModuleName:o,ssrRuntimeModuleName:u}=e;if(r.helpers.size){const f=Array.from(r.helpers);a?(i(`import { ${f.map(g=>aa[g]).join(", ")} } from ${JSON.stringify(o)}
`,-1),i(`
// Binding optimization for webpack code-split
const ${f.map(g=>`_${aa[g]} = ${aa[g]}`).join(", ")}
`,-1)):i(`import { ${f.map(g=>`${aa[g]} as _${aa[g]}`).join(", ")} } from ${JSON.stringify(o)}
`,-1)}r.ssrHelpers&&r.ssrHelpers.length&&i(`import { ${r.ssrHelpers.map(f=>`${aa[f]} as _${aa[f]}`).join(", ")} } from "${u}"
`,-1),r.imports.length&&(Hle(r.imports,e),s()),EG(r.hoists,e),s(),n||i("export ")}function sI(r,e,{helper:t,push:n,newline:i,isTS:s}){const a=t(e==="filter"?pS:e==="component"?B_:fS);for(let o=0;o<r.length;o++){let u=r[o];const f=u.endsWith("__self");f&&(u=u.slice(0,-6)),n(`const ${up(u,e)} = ${a}(${JSON.stringify(u)}${f?", true":""})${s?"!":""}`),o<r.length-1&&i()}}function EG(r,e){if(!r.length)return;e.pure=!0;const{push:t,newline:n}=e;n();for(let i=0;i<r.length;i++){const s=r[i];s&&(t(`const _hoisted_${i+1} = `),Bi(s,e),n())}e.pure=!1}function Hle(r,e){r.length&&r.forEach(t=>{e.push("import "),Bi(t.exp,e),e.push(` from '${t.path}'`),e.newline()})}function Wle(r){return or.isString(r)||r.type===4||r.type===2||r.type===5||r.type===8}function PS(r,e){const t=r.length>3||r.some(n=>or.isArray(n)||!Wle(n));e.push("["),t&&e.indent(),Cy(r,e,t),t&&e.deindent(),e.push("]")}function Cy(r,e,t=!1,n=!0){const{push:i,newline:s}=e;for(let a=0;a<r.length;a++){const o=r[a];or.isString(o)?i(o,-3):or.isArray(o)?PS(o,e):Bi(o,e),a<r.length-1&&(t?(n&&i(","),s()):n&&i(", "))}}function Bi(r,e){if(or.isString(r)){e.push(r,-3);return}if(or.isSymbol(r)){e.push(e.helper(r));return}switch(r.type){case 1:case 9:case 11:Bi(r.codegenNode,e);break;case 2:Kle(r,e);break;case 4:IG(r,e);break;case 5:Xle(r,e);break;case 12:Bi(r.codegenNode,e);break;case 8:PG(r,e);break;case 3:qle(r,e);break;case 13:Yle(r,e);break;case 14:Qle(r,e);break;case 15:ece(r,e);break;case 17:tce(r,e);break;case 18:rce(r,e);break;case 19:nce(r,e);break;case 20:ice(r,e);break;case 21:Cy(r.body,e,!0,!1);break;case 22:sce(r,e);break;case 23:BG(r,e);break;case 24:oce(r,e);break;case 25:ace(r,e);break;case 26:lce(r,e);break}}function Kle(r,e){e.push(JSON.stringify(r.content),-3,r)}function IG(r,e){const{content:t,isStatic:n}=r;e.push(n?JSON.stringify(t):t,-3,r)}function Xle(r,e){const{push:t,helper:n,pure:i}=e;i&&t(IS),t(`${n(yS)}(`),Bi(r.content,e),t(")")}function PG(r,e){for(let t=0;t<r.children.length;t++){const n=r.children[t];or.isString(n)?e.push(n,-3):Bi(n,e)}}function Jle(r,e){const{push:t}=e;if(r.type===8)t("["),PG(r,e),t("]");else if(r.isStatic){const n=Ju(r.content)?r.content:JSON.stringify(r.content);t(n,-2,r)}else t(`[${r.content}]`,-3,r)}function qle(r,e){const{push:t,helper:n,pure:i}=e;i&&t(IS),t(`${n(xy)}(${JSON.stringify(r.content)})`,-3,r)}function Yle(r,e){const{push:t,helper:n,pure:i}=e,{tag:s,props:a,children:o,patchFlag:u,dynamicProps:f,directives:g,isBlock:y,disableTracking:A,isComponent:C}=r;let M;u&&(M=String(u)),g&&t(n(gS)+"("),y&&t(`(${n(vd)}(${A?"true":""}), `),i&&t(IS);const k=y?cp(e.inSSR,C):lp(e.inSSR,C);t(n(k)+"(",-2,r),Cy(Zle([s,a,o,M,f]),e),t(")"),y&&t(")"),g&&(t(", "),Bi(g,e),t(")"))}function Zle(r){let e=r.length;for(;e--&&r[e]==null;);return r.slice(0,e+1).map(t=>t||"null")}function Qle(r,e){const{push:t,helper:n,pure:i}=e,s=or.isString(r.callee)?r.callee:n(r.callee);i&&t(IS),t(s+"(",-2,r),Cy(r.arguments,e),t(")")}function ece(r,e){const{push:t,indent:n,deindent:i,newline:s}=e,{properties:a}=r;if(!a.length){t("{}",-2,r);return}const o=a.length>1||a.some(u=>u.value.type!==4);t(o?"{":"{ "),o&&n();for(let u=0;u<a.length;u++){const{key:f,value:g}=a[u];Jle(f,e),t(": "),Bi(g,e),u<a.length-1&&(t(","),s())}o&&i(),t(o?"}":" }")}function tce(r,e){PS(r.elements,e)}function rce(r,e){const{push:t,indent:n,deindent:i}=e,{params:s,returns:a,body:o,newline:u,isSlot:f}=r;f&&t(`_${aa[AS]}(`),t("(",-2,r),or.isArray(s)?Cy(s,e):s&&Bi(s,e),t(") => "),(u||o)&&(t("{"),n()),a?(u&&t("return "),or.isArray(a)?PS(a,e):Bi(a,e)):o&&Bi(o,e),(u||o)&&(i(),t("}")),f&&(r.isNonScopedSlot&&t(", undefined, true"),t(")"))}function nce(r,e){const{test:t,consequent:n,alternate:i,newline:s}=r,{push:a,indent:o,deindent:u,newline:f}=e;if(t.type===4){const y=!Ju(t.content);y&&a("("),IG(t,e),y&&a(")")}else a("("),Bi(t,e),a(")");s&&o(),e.indentLevel++,s||a(" "),a("? "),Bi(n,e),e.indentLevel--,s&&f(),s||a(" "),a(": ");const g=i.type===19;g||e.indentLevel++,Bi(i,e),g||e.indentLevel--,s&&u(!0)}function ice(r,e){const{push:t,helper:n,indent:i,deindent:s,newline:a}=e,{needPauseTracking:o,needArraySpread:u}=r;u&&t("[...("),t(`_cache[${r.index}] || (`),o&&(i(),t(`${n(R_)}(-1`),r.inVOnce&&t(", true"),t("),"),a(),t("(")),t(`_cache[${r.index}] = `),Bi(r.value,e),o&&(t(`).cacheIndex = ${r.index},`),a(),t(`${n(R_)}(1),`),a(),t(`_cache[${r.index}]`),s()),t(")"),u&&t(")]")}function sce(r,e){const{push:t,indent:n,deindent:i}=e;t("`");const s=r.elements.length,a=s>3;for(let o=0;o<s;o++){const u=r.elements[o];or.isString(u)?t(u.replace(/(`|\$|\\)/g,"\\$1"),-3):(t("${"),a&&n(),Bi(u,e),a&&i(),t("}"))}t("`")}function BG(r,e){const{push:t,indent:n,deindent:i}=e,{test:s,consequent:a,alternate:o}=r;t("if ("),Bi(s,e),t(") {"),n(),Bi(a,e),i(),t("}"),o&&(t(" else "),o.type===23?BG(o,e):(t("{"),n(),Bi(o,e),i(),t("}")))}function oce(r,e){Bi(r.left,e),e.push(" = "),Bi(r.right,e)}function ace(r,e){e.push("("),Cy(r.expressions,e),e.push(")")}function lce({returns:r},e){e.push("return "),or.isArray(r)?PS(r,e):Bi(r,e)}const cce=or.makeMap("true,false,null,this"),MG=(r,e)=>{if(r.type===5)r.content=xo(r.content,e);else if(r.type===1){const t=Vo(r,"memo");for(let n=0;n<r.props.length;n++){const i=r.props[n];if(i.type===7&&i.name!=="for"){const s=i.exp,a=i.arg;s&&s.type===4&&!(i.name==="on"&&a)&&!(t&&a&&a.type===4&&a.content==="key")&&(i.exp=xo(s,e,i.name==="slot")),a&&a.type===4&&!a.isStatic&&(i.arg=xo(a,e))}}}};function xo(r,e,t=!1,n=!1,i=Object.create(e.identifiers)){if(!e.prefixIdentifiers||!r.content.trim())return r;const{inline:s,bindingMetadata:a}=e,o=(k,D,V)=>{const W=or.hasOwn(a,k)&&a[k];if(s){const z=D&&D.type==="AssignmentExpression"&&D.left===V,$=D&&D.type==="UpdateExpression"&&D.argument===V,te=D&&_C(D,y),le=D&&rG(y),_e=se=>{const Y=`${e.helperString(k_)}(${se})`;return le?`(${Y})`:Y};if(S4(W)||W==="setup-reactive-const"||i[k])return k;if(W==="setup-ref")return`${k}.value`;if(W==="setup-maybe-ref")return z||$||te?`${k}.value`:_e(k);if(W==="setup-let")if(z){const{right:se,operator:Y}=D,ce=u.slice(se.start-1,se.end-1),oe=wk(xo(Wr(ce,!1),e,!1,!1,A));return`${e.helperString(O_)}(${k})${e.isTS?` //@ts-ignore
`:""} ? ${k}.value ${Y} ${oe} : ${k}`}else if($){V.start=D.start,V.end=D.end;const{prefix:se,operator:Y}=D,ce=se?Y:"",oe=se?"":Y;return`${e.helperString(O_)}(${k})${e.isTS?` //@ts-ignore
`:""} ? ${ce}${k}.value${oe} : ${ce}${k}${oe}`}else return te?k:_e(k);else{if(W==="props")return or.genPropsAccessExp(k);if(W==="props-aliased")return or.genPropsAccessExp(a.__propsAliases[k])}}else{if(W&&W.startsWith("setup")||W==="literal-const")return`$setup.${k}`;if(W==="props-aliased")return`$props['${a.__propsAliases[k]}']`;if(W)return`$${W}.${k}`}return`_ctx.${k}`},u=r.content;let f=r.ast;if(f===!1)return r;if(f===null||!f&&Ju(u)){const k=e.identifiers[u],D=or.isGloballyAllowed(u),V=cce(u);return!t&&!k&&!V&&(!D||a[u])?(S4(a[u])&&(r.constType=1),r.content=o(u)):k||(V?r.constType=3:r.constType=2),r}if(!f){const k=n?` ${u} `:`(${u})${t?"=>{}":""}`;try{f=km.parseExpression(k,{sourceType:"module",plugins:e.expressionPlugins})}catch(D){return e.onError(ti(46,r.loc,void 0,D.message)),r}}const g=[],y=[],A=Object.create(e.identifiers);eG(f,(k,D,V,W,z)=>{if(lG(k,D)||k.name.startsWith("_filter_"))return;const $=W&&uce(k);$&&!z?(fk(D)&&D.shorthand&&(k.prefix=`${k.name}: `),k.name=o(k.name,D,k),g.push(k)):(!($&&z)&&(!D||D.type!=="CallExpression"&&D.type!=="NewExpression"&&D.type!=="MemberExpression")&&(k.isConstant=!0),g.push(k))},!0,y,A);const C=[];g.sort((k,D)=>k.start-D.start),g.forEach((k,D)=>{const V=k.start-1,W=k.end-1,z=g[D-1],$=u.slice(z?z.end-1:0,V);($.length||k.prefix)&&C.push($+(k.prefix||""));const te=u.slice(V,W);C.push(Wr(k.name,!1,{start:D3(r.loc.start,te,V),end:D3(r.loc.start,te,W),source:te},k.isConstant?3:0)),D===g.length-1&&W<u.length&&C.push(u.slice(W))});let M;return C.length?(M=Na(C,r.loc),M.ast=f):(M=r,M.constType=3),M.identifiers=Object.keys(A),M}function uce(r){return!(or.isGloballyAllowed(r.name)||r.name==="require")}function wk(r){return or.isString(r)?r:r.type===4?r.content:r.children.map(wk).join("")}function S4(r){return r==="setup-const"||r==="literal-const"}const hce=xk(/^(?:if|else|else-if)$/,(r,e,t)=>RG(r,e,t,(n,i,s)=>{const a=t.parent.children;let o=a.indexOf(n),u=0;for(;o-->=0;){const f=a[o];f&&f.type===9&&(u+=f.branches.length)}return()=>{if(s)n.codegenNode=I4(i,u,t);else{const f=fce(n.codegenNode);f.alternate=I4(i,u+n.branches.length-1,t)}}}));function RG(r,e,t,n){if(e.name!=="else"&&(!e.exp||!e.exp.content.trim())){const i=e.exp?e.exp.loc:r.loc;t.onError(ti(28,e.loc)),e.exp=Wr("true",!1,i)}if(t.prefixIdentifiers&&e.exp&&(e.exp=xo(e.exp,t)),e.name==="if"){const i=E4(r,e),s={type:9,loc:Lle(r.loc),branches:[i]};if(t.replaceNode(s),n)return n(s,i,!0)}else{const i=t.parent.children;let s=i.indexOf(r);for(;s-->=-1;){const a=i[s];if(a&&vk(a)){t.removeNode(a);continue}if(a&&a.type===9){(e.name==="else-if"||e.name==="else")&&a.branches[a.branches.length-1].condition===void 0&&t.onError(ti(30,r.loc)),t.removeNode();const o=E4(r,e);{const f=o.userKey;f&&a.branches.forEach(({userKey:g})=>{dce(g,f)&&t.onError(ti(29,o.userKey.loc))})}a.branches.push(o);const u=n&&n(a,o,!1);Hv(o,t),u&&u(),t.currentNode=null}else t.onError(ti(30,r.loc));break}}}function E4(r,e){const t=r.tagType===3;return{type:10,loc:r.loc,condition:e.name==="else"?void 0:e.exp,children:t&&!Vo(r,"for")?r.children:[r],userKey:L_(r,"key"),isTemplateIf:t}}function I4(r,e,t){return r.condition?yC(r.condition,P4(r,e,t),ro(t.helper(xy),['""',"true"])):P4(r,e,t)}function P4(r,e,t){const{helper:n}=t,i=xs("key",Wr(`${e}`,!1,ws,2)),{children:s}=r,a=s[0];if(s.length!==1||a.type!==1)if(s.length===1&&a.type===11){const u=a.codegenNode;return F_(u,i,t),u}else return Ym(t,n(Jm),Fa([i]),s,64,void 0,void 0,!0,!1,!1,r.loc);else{const u=a.codegenNode,f=fG(u);return f.type===13&&wS(f,t),F_(f,i,t),u}}function dce(r,e){if(!r||r.type!==e.type)return!1;if(r.type===6){if(r.value.content!==e.value.content)return!1}else{const t=r.exp,n=e.exp;if(t.type!==n.type||t.type!==4||t.isStatic!==n.isStatic||t.content!==n.content)return!1}return!0}function fce(r){for(;;)if(r.type===19)if(r.alternate.type===19)r=r.alternate;else return r;else r.type===20&&(r=r.value)}const pce=xk("for",(r,e,t)=>{const{helper:n,removeHelper:i}=t;return kG(r,e,t,s=>{const a=ro(n(mS),[s.source]),o=Zm(r),u=Vo(r,"memo"),f=L_(r,"key",!1,!0),g=f&&f.type===7;let y=f&&(f.type===6?f.value?Wr(f.value.content,!0):void 0:f.exp);u&&y&&g&&(f.exp=y=xo(y,t));const A=f&&y?xs("key",y):null;o&&(u&&(u.exp=xo(u.exp,t)),A&&f.type!==6&&(A.value=xo(A.value,t)));const C=s.source.type===4&&s.source.constType>0,M=C?64:f?128:256;return s.codegenNode=Ym(t,n(Jm),void 0,a,M,void 0,void 0,!0,!C,!1,r.loc),()=>{let k;const{children:D}=s;o&&r.children.some(z=>{if(z.type===1){const $=L_(z,"key");if($)return t.onError(ti(33,$.loc)),!0}});const V=D.length!==1||D[0].type!==1,W=N_(r)?r:o&&r.children.length===1&&N_(r.children[0])?r.children[0]:null;if(W?(k=W.codegenNode,o&&A&&F_(k,A,t)):V?k=Ym(t,n(Jm),A?Fa([A]):void 0,r.children,64,void 0,void 0,!0,void 0,!1):(k=D[0].codegenNode,o&&A&&F_(k,A,t),k.isBlock!==!C&&(k.isBlock?(i(vd),i(cp(t.inSSR,k.isComponent))):i(lp(t.inSSR,k.isComponent))),k.isBlock=!C,k.isBlock?(n(vd),n(cp(t.inSSR,k.isComponent))):n(lp(t.inSSR,k.isComponent))),u){const z=ap(vC(s.parseResult,[Wr("_cached")]));z.body=Y7([Na(["const _memo = (",u.exp,")"]),Na(["if (_cached",...y?[" && _cached.key === ",y]:[],` && ${t.helperString(uk)}(_cached, _memo)) return _cached`]),Na(["const _item = ",k]),Wr("_item.memo = _memo"),Wr("return _item")]),a.arguments.push(z,Wr("_cache"),Wr(String(t.cached.length))),t.cached.push(null)}else a.arguments.push(ap(vC(s.parseResult),k,!0))}})});function kG(r,e,t,n){if(!e.exp){t.onError(ti(31,e.loc));return}const i=e.forParseResult;if(!i){t.onError(ti(32,e.loc));return}Ck(i,t);const{addIdentifiers:s,removeIdentifiers:a,scopes:o}=t,{source:u,value:f,key:g,index:y}=i,A={type:11,loc:e.loc,source:u,valueAlias:f,keyAlias:g,objectIndexAlias:y,parseResult:i,children:Zm(r)?r.children:[r]};t.replaceNode(A),o.vFor++,t.prefixIdentifiers&&(f&&s(f),g&&s(g),y&&s(y));const C=n&&n(A);return()=>{o.vFor--,t.prefixIdentifiers&&(f&&a(f),g&&a(g),y&&a(y)),C&&C()}}function Ck(r,e){r.finalized||(e.prefixIdentifiers&&(r.source=xo(r.source,e),r.key&&(r.key=xo(r.key,e,!0)),r.index&&(r.index=xo(r.index,e,!0)),r.value&&(r.value=xo(r.value,e,!0))),r.finalized=!0)}function vC({value:r,key:e,index:t},n=[]){return gce([r,e,t,...n])}function gce(r){let e=r.length;for(;e--&&!r[e];);return r.slice(0,e+1).map((t,n)=>t||Wr("_".repeat(n+1),!1))}const B4=Wr("undefined",!1),OG=(r,e)=>{if(r.type===1&&(r.tagType===1||r.tagType===3)){const t=Vo(r,"slot");if(t){const n=t.exp;return e.prefixIdentifiers&&n&&e.addIdentifiers(n),e.scopes.vSlot++,()=>{e.prefixIdentifiers&&n&&e.removeIdentifiers(n),e.scopes.vSlot--}}}},DG=(r,e)=>{let t;if(Zm(r)&&r.props.some(SS)&&(t=Vo(r,"for"))){const n=t.forParseResult;if(n){Ck(n,e);const{value:i,key:s,index:a}=n,{addIdentifiers:o,removeIdentifiers:u}=e;return i&&o(i),s&&o(s),a&&o(a),()=>{i&&u(i),s&&u(s),a&&u(a)}}}},mce=(r,e,t,n)=>ap(r,t,!1,!0,t.length?t[0].loc:n);function LG(r,e,t=mce){e.helper(AS);const{children:n,loc:i}=r,s=[],a=[];let o=e.scopes.vSlot>0||e.scopes.vFor>0;!e.ssr&&e.prefixIdentifiers&&(o=r.props.some(D=>SS(D)&&(mo(D.arg,e.identifiers)||mo(D.exp,e.identifiers)))||n.some(D=>mo(D,e.identifiers)));const u=Vo(r,"slot",!0);if(u){const{arg:D,exp:V}=u;D&&!Kl(D)&&(o=!0),s.push(xs(D||Wr("default",!0),t(V,void 0,n,i)))}let f=!1,g=!1;const y=[],A=new Set;let C=0;for(let D=0;D<n.length;D++){const V=n[D];let W;if(!Zm(V)||!(W=Vo(V,"slot",!0))){V.type!==3&&y.push(V);continue}if(u){e.onError(ti(37,W.loc));break}f=!0;const{children:z,loc:$}=V,{arg:te=Wr("default",!0),exp:le,loc:_e}=W;let se;Kl(te)?se=te?te.content:"default":o=!0;const Y=Vo(V,"for"),ce=t(le,Y,z,$);let oe,Me;if(oe=Vo(V,"if"))o=!0,a.push(yC(oe.exp,j1(te,ce,C++),B4));else if(Me=Vo(V,/^else(?:-if)?$/,!0)){let ze=D,Ve;for(;ze--&&(Ve=n[ze],!!vk(Ve)););if(Ve&&Zm(Ve)&&Vo(Ve,/^(?:else-)?if$/)){let lt=a[a.length-1];for(;lt.alternate.type===19;)lt=lt.alternate;lt.alternate=Me.exp?yC(Me.exp,j1(te,ce,C++),B4):j1(te,ce,C++)}else e.onError(ti(30,Me.loc))}else if(Y){o=!0;const ze=Y.forParseResult;ze?(Ck(ze,e),a.push(ro(e.helper(mS),[ze.source,ap(vC(ze),j1(te,ce),!0)]))):e.onError(ti(32,Y.loc))}else{if(se){if(A.has(se)){e.onError(ti(38,_e));continue}A.add(se),se==="default"&&(g=!0)}s.push(xs(te,ce))}}if(!u){const D=(V,W)=>{const z=t(V,void 0,W,i);return e.compatConfig&&(z.isNonScopedSlot=!0),xs("default",z)};f?y.length&&!y.every(ES)&&(g?e.onError(ti(39,y[0].loc)):s.push(D(void 0,y))):s.push(D(void 0,n))}const M=o?2:gw(r.children)?3:1;let k=Fa(s.concat(xs("_",Wr(M+"",!1))),i);return a.length&&(k=ro(e.helper(ck),[k,md(a)])),{slots:k,hasDynamicSlots:o}}function j1(r,e,t){const n=[xs("name",r),xs("fn",e)];return t!=null&&n.push(xs("key",Wr(String(t),!0))),Fa(n)}function gw(r){for(let e=0;e<r.length;e++){const t=r[e];switch(t.type){case 1:if(t.tagType===2||gw(t.children))return!0;break;case 9:if(gw(t.branches))return!0;break;case 10:case 11:if(gw(t.children))return!0;break}}return!1}const NG=new WeakMap,FG=(r,e)=>function(){if(r=e.currentNode,!(r.type===1&&(r.tagType===0||r.tagType===1)))return;const{tag:n,props:i}=r,s=r.tagType===1;let a=s?UG(r,e):`"${n}"`;const o=or.isObject(a)&&a.callee===dS;let u,f,g=0,y,A,C,M=o||a===Om||a===lS||!s&&(n==="svg"||n==="foreignObject"||n==="math");if(i.length>0){const k=Tk(r,e,void 0,s,o);u=k.props,g=k.patchFlag,A=k.dynamicPropNames;const D=k.directives;C=D&&D.length?md(D.map(V=>zG(V,e))):void 0,k.shouldUseBlock&&(M=!0)}if(r.children.length>0)if(a===P_&&(M=!0,g|=1024),s&&a!==Om&&a!==P_){const{slots:D,hasDynamicSlots:V}=LG(r,e);f=D,V&&(g|=1024)}else if(r.children.length===1&&a!==Om){const D=r.children[0],V=D.type,W=V===5||V===8;W&&Ua(D,e)===0&&(g|=1),W||V===2?f=D:f=r.children}else f=r.children;A&&A.length&&(y=bce(A)),r.codegenNode=Ym(e,a,u,f,g===0?void 0:g,y,C,!!M,!1,s,r.loc)};function UG(r,e,t=!1){let{tag:n}=r;const i=z3(n),s=L_(r,"is",!1,!0);if(s)if(i||Kf("COMPILER_IS_ON_ELEMENT",e)){let o;if(s.type===6?o=s.value&&Wr(s.value.content,!0):(o=s.exp,o||(o=Wr("is",!1,s.arg.loc),o=s.exp=xo(o,e))),o)return ro(e.helper(dS),[o])}else s.type===6&&s.value.content.startsWith("vue:")&&(n=s.value.content.slice(4));const a=gk(n)||e.isBuiltInComponent(n);if(a)return t||e.helper(a),a;{const o=U3(n,e);if(o)return o;const u=n.indexOf(".");if(u>0){const f=U3(n.slice(0,u),e);if(f)return f+n.slice(u)}}return e.selfName&&or.capitalize(or.camelize(n))===e.selfName?(e.helper(B_),e.components.add(n+"__self"),up(n,"component")):(e.helper(B_),e.components.add(n),up(n,"component"))}function U3(r,e){const t=e.bindingMetadata;if(!t||t.__isScriptSetup===!1)return;const n=or.camelize(r),i=or.capitalize(n),s=f=>{if(t[r]===f)return r;if(t[n]===f)return n;if(t[i]===f)return i},a=s("setup-const")||s("setup-reactive-const")||s("literal-const");if(a)return e.inline?a:`$setup[${JSON.stringify(a)}]`;const o=s("setup-let")||s("setup-ref")||s("setup-maybe-ref");if(o)return e.inline?`${e.helperString(k_)}(${o})`:`$setup[${JSON.stringify(o)}]`;const u=s("props");if(u)return`${e.helperString(k_)}(${e.inline?"__props":"$props"}[${JSON.stringify(u)}])`}function Tk(r,e,t=r.props,n,i,s=!1){const{tag:a,loc:o,children:u}=r;let f=[];const g=[],y=[],A=u.length>0;let C=!1,M=0,k=!1,D=!1,V=!1,W=!1,z=!1,$=!1;const te=[],le=ce=>{f.length&&(g.push(Fa(M4(f),o)),f=[]),ce&&g.push(ce)},_e=()=>{e.scopes.vFor>0&&f.push(xs(Wr("ref_for",!0),Wr("true")))},se=({key:ce,value:oe})=>{if(Kl(ce)){const Me=ce.content,ze=or.isOn(Me);if(ze&&(!n||i)&&Me.toLowerCase()!=="onclick"&&Me!=="onUpdate:modelValue"&&!or.isReservedProp(Me)&&(W=!0),ze&&or.isReservedProp(Me)&&($=!0),ze&&oe.type===14&&(oe=oe.arguments[0]),oe.type===20||(oe.type===4||oe.type===8)&&Ua(oe,e)>0)return;Me==="ref"?k=!0:Me==="class"?D=!0:Me==="style"?V=!0:Me!=="key"&&!te.includes(Me)&&te.push(Me),n&&(Me==="class"||Me==="style")&&!te.includes(Me)&&te.push(Me)}else z=!0};for(let ce=0;ce<t.length;ce++){const oe=t[ce];if(oe.type===6){const{loc:Me,name:ze,nameLoc:Ve,value:lt}=oe;let gt=!0;if(ze==="ref"&&(k=!0,_e(),lt&&e.inline)){const At=e.bindingMetadata[lt.content];(At==="setup-let"||At==="setup-ref"||At==="setup-maybe-ref")&&(gt=!1,f.push(xs(Wr("ref_key",!0),Wr(lt.content,!0,lt.loc))))}if(ze==="is"&&(z3(a)||lt&&lt.content.startsWith("vue:")||Kf("COMPILER_IS_ON_ELEMENT",e)))continue;f.push(xs(Wr(ze,!0,Ve),Wr(lt?lt.content:"",gt,lt?lt.loc:Me)))}else{const{name:Me,arg:ze,exp:Ve,loc:lt,modifiers:gt}=oe,At=Me==="bind",Tt=Me==="on";if(Me==="slot"){n||e.onError(ti(40,lt));continue}if(Me==="once"||Me==="memo"||Me==="is"||At&&id(ze,"is")&&(z3(a)||Kf("COMPILER_IS_ON_ELEMENT",e))||Tt&&s)continue;if((At&&id(ze,"key")||Tt&&A&&id(ze,"vue:before-update"))&&(C=!0),At&&id(ze,"ref")&&_e(),!ze&&(At||Tt)){if(z=!0,Ve)if(At){if(le(),Kf("COMPILER_V_BIND_OBJECT_ORDER",e)){g.unshift(Ve);continue}_e(),le(),g.push(Ve)}else le({type:14,loc:lt,callee:e.helper(vS),arguments:n?[Ve]:[Ve,"true"]});else e.onError(ti(At?34:35,lt));continue}At&&gt.some(xr=>xr.content==="prop")&&(M|=32);const Ut=e.directiveTransforms[Me];if(Ut){const{props:xr,needRuntime:Er}=Ut(oe,r,e);!s&&xr.forEach(se),Tt&&ze&&!Kl(ze)?le(Fa(xr,o)):f.push(...xr),Er&&(y.push(oe),or.isSymbol(Er)&&NG.set(oe,Er))}else or.isBuiltInDirective(Me)||(y.push(oe),A&&(C=!0))}}let Y;if(g.length?(le(),g.length>1?Y=ro(e.helper(M_),g,o):Y=g[0]):f.length&&(Y=Fa(M4(f),o)),z?M|=16:(D&&!n&&(M|=2),V&&!n&&(M|=4),te.length&&(M|=8),W&&(M|=32)),!C&&(M===0||M===32)&&(k||$||y.length>0)&&(M|=512),!e.inSSR&&Y)switch(Y.type){case 15:let ce=-1,oe=-1,Me=!1;for(let lt=0;lt<Y.properties.length;lt++){const gt=Y.properties[lt].key;Kl(gt)?gt.content==="class"?ce=lt:gt.content==="style"&&(oe=lt):gt.isHandlerKey||(Me=!0)}const ze=Y.properties[ce],Ve=Y.properties[oe];Me?Y=ro(e.helper(qm),[Y]):(ze&&!Kl(ze.value)&&(ze.value=ro(e.helper(bS),[ze.value])),Ve&&(V||Ve.value.type===4&&Ve.value.content.trim()[0]==="["||Ve.value.type===17)&&(Ve.value=ro(e.helper(_S),[Ve.value])));break;case 14:break;default:Y=ro(e.helper(qm),[ro(e.helper(wy),[Y])]);break}return{props:Y,directives:y,patchFlag:M,dynamicPropNames:te,shouldUseBlock:C}}function M4(r){const e=new Map,t=[];for(let n=0;n<r.length;n++){const i=r[n];if(i.key.type===8||!i.key.isStatic){t.push(i);continue}const s=i.key.content,a=e.get(s);a?(s==="style"||s==="class"||or.isOn(s))&&yce(a,i):(e.set(s,i),t.push(i))}return t}function yce(r,e){r.value.type===17?r.value.elements.push(e.value):r.value=md([r.value,e.value],r.loc)}function zG(r,e){const t=[],n=NG.get(r);if(n)t.push(e.helperString(n));else{const s=U3("v-"+r.name,e);s?t.push(s):(e.helper(fS),e.directives.add(r.name),t.push(up(r.name,"directive")))}const{loc:i}=r;if(r.exp&&t.push(r.exp),r.arg&&(r.exp||t.push("void 0"),t.push(r.arg)),Object.keys(r.modifiers).length){r.arg||(r.exp||t.push("void 0"),t.push("void 0"));const s=Wr("true",!1,i);t.push(Fa(r.modifiers.map(a=>xs(a,s)),i))}return md(t,r.loc)}function bce(r){let e="[";for(let t=0,n=r.length;t<n;t++)e+=JSON.stringify(r[t]),t<n-1&&(e+=", ");return e+"]"}function z3(r){return r==="component"||r==="Component"}const _ce=(r,e)=>{if(N_(r)){const{children:t,loc:n}=r,{slotName:i,slotProps:s}=VG(r,e),a=[e.prefixIdentifiers?"_ctx.$slots":"$slots",i,"{}","undefined","true"];let o=2;s&&(a[2]=s,o=3),t.length&&(a[3]=ap([],t,!1,!1,n),o=4),e.scopeId&&!e.slotted&&(o=5),a.splice(o),r.codegenNode=ro(e.helper(lk),a,n)}};function VG(r,e){let t='"default"',n;const i=[];for(let s=0;s<r.props.length;s++){const a=r.props[s];if(a.type===6)a.value&&(a.name==="name"?t=JSON.stringify(a.value.content):(a.name=or.camelize(a.name),i.push(a)));else if(a.name==="bind"&&id(a.arg,"name")){if(a.exp)t=a.exp;else if(a.arg&&a.arg.type===4){const o=or.camelize(a.arg.content);t=a.exp=Wr(o,!1,a.arg.loc),t=a.exp=xo(a.exp,e)}}else a.name==="bind"&&a.arg&&Kl(a.arg)&&(a.arg.content=or.camelize(a.arg.content)),i.push(a)}if(i.length>0){const{props:s,directives:a}=Tk(r,e,i,!1,!1);n=s,a.length&&e.onError(ti(36,a[0].loc))}return{slotName:t,slotProps:n}}const $G=(r,e,t,n)=>{const{loc:i,modifiers:s,arg:a}=r;!r.exp&&!s.length&&t.onError(ti(35,i));let o;if(a.type===4)if(a.isStatic){let y=a.content;y.startsWith("vue:")&&(y=`vnode-${y.slice(4)}`);const A=e.tagType!==0||y.startsWith("vnode")||!/[A-Z]/.test(y)?or.toHandlerKey(or.camelize(y)):`on:${y}`;o=Wr(A,!0,a.loc)}else o=Na([`${t.helperString(mC)}(`,a,")"]);else o=a,o.children.unshift(`${t.helperString(mC)}(`),o.children.push(")");let u=r.exp;u&&!u.content.trim()&&(u=void 0);let f=t.cacheHandlers&&!u&&!t.inVOnce;if(u){const y=yk(u,t),A=!(y||hG(u,t)),C=u.content.includes(";");t.prefixIdentifiers&&(A&&t.addIdentifiers("$event"),u=r.exp=xo(u,t,!1,C),A&&t.removeIdentifiers("$event"),f=t.cacheHandlers&&!t.inVOnce&&!(u.type===4&&u.constType>0)&&!(y&&e.tagType===1)&&!mo(u,t.identifiers),f&&y&&(u.type===4?u.content=`${u.content} && ${u.content}(...args)`:u.children=[...u.children," && ",...u.children,"(...args)"])),(A||f&&y)&&(u=Na([`${A?t.isTS?"($event: any)":"$event":`${t.isTS?`
//@ts-ignore
`:""}(...args)`} => ${C?"{":"("}`,u,C?"}":")"]))}let g={props:[xs(o,u||Wr("() => {}",!1,i))]};return n&&(g=n(g)),f&&(g.props[0].value=t.cache(g.props[0].value)),g.props.forEach(y=>y.key.isHandlerKey=!0),g},jG=(r,e,t)=>{const{modifiers:n,loc:i}=r,s=r.arg;let{exp:a}=r;return a&&a.type===4&&!a.content.trim()?(t.onError(ti(34,i)),{props:[xs(s,Wr("",!0,i))]}):(s.type!==4?(s.children.unshift("("),s.children.push(') || ""')):s.isStatic||(s.content=s.content?`${s.content} || ""`:'""'),n.some(o=>o.content==="camel")&&(s.type===4?s.isStatic?s.content=or.camelize(s.content):s.content=`${t.helperString(gC)}(${s.content})`:(s.children.unshift(`${t.helperString(gC)}(`),s.children.push(")"))),t.inSSR||(n.some(o=>o.content==="prop")&&R4(s,"."),n.some(o=>o.content==="attr")&&R4(s,"^")),{props:[xs(s,a)]})},R4=(r,e)=>{r.type===4?r.isStatic?r.content=e+r.content:r.content=`\`${e}\${${r.content}}\``:(r.children.unshift(`'${e}' + (`),r.children.push(")"))},vce=(r,e)=>{if(r.type===0||r.type===1||r.type===11||r.type===10)return()=>{const t=r.children;let n,i=!1;for(let s=0;s<t.length;s++){const a=t[s];if(uw(a)){i=!0;for(let o=s+1;o<t.length;o++){const u=t[o];if(uw(u))n||(n=t[s]=Na([a],a.loc)),n.children.push(" + ",u),t.splice(o,1),o--;else{n=void 0;break}}}}if(!(!i||t.length===1&&(r.type===0||r.type===1&&r.tagType===0&&!r.props.find(s=>s.type===7&&!e.directiveTransforms[s.name])&&r.tag!=="template")))for(let s=0;s<t.length;s++){const a=t[s];if(uw(a)||a.type===8){const o=[];(a.type!==2||a.content!==" ")&&o.push(a),!e.ssr&&Ua(a,e)===0&&o.push("1"),t[s]={type:12,content:a,loc:a.loc,codegenNode:ro(e.helper(hS),o)}}}}},k4=new WeakSet,Ace=(r,e)=>{if(r.type===1&&Vo(r,"once",!0))return k4.has(r)||e.inVOnce||e.inSSR?void 0:(k4.add(r),e.inVOnce=!0,e.helper(R_),()=>{e.inVOnce=!1;const t=e.currentNode;t.codegenNode&&(t.codegenNode=e.cache(t.codegenNode,!0,!0))})},GG=(r,e,t)=>{const{exp:n,arg:i}=r;if(!n)return t.onError(ti(41,r.loc)),Mg();const s=n.loc.source.trim(),a=n.type===4?n.content:s,o=t.bindingMetadata[s];if(o==="props"||o==="props-aliased")return t.onError(ti(44,n.loc)),Mg();if(o==="literal-const"||o==="setup-const")return t.onError(ti(45,n.loc)),Mg();const u=t.inline&&(o==="setup-let"||o==="setup-ref"||o==="setup-maybe-ref");if(!a.trim()||!yk(n,t)&&!u)return t.onError(ti(42,n.loc)),Mg();if(t.prefixIdentifiers&&Ju(a)&&t.identifiers[a])return t.onError(ti(43,n.loc)),Mg();const f=i||Wr("modelValue",!0),g=i?Kl(i)?`onUpdate:${or.camelize(i.content)}`:Na(['"onUpdate:" + ',i]):"onUpdate:modelValue";let y;const A=t.isTS?"($event: any)":"$event";if(u)if(o==="setup-ref")y=Na([`${A} => ((`,Wr(s,!1,n.loc),").value = $event)"]);else{const M=o==="setup-let"?`${s} = $event`:"null";y=Na([`${A} => (${t.helperString(O_)}(${s}) ? (`,Wr(s,!1,n.loc),`).value = $event : ${M})`])}else y=Na([`${A} => ((`,n,") = $event)"]);const C=[xs(f,r.exp),xs(g,y)];if(t.prefixIdentifiers&&!t.inVOnce&&t.cacheHandlers&&!mo(n,t.identifiers)&&(C[1].value=t.cache(C[1].value)),r.modifiers.length&&e.tagType===1){const M=r.modifiers.map(D=>D.content).map(D=>(Ju(D)?D:JSON.stringify(D))+": true").join(", "),k=i?Kl(i)?`${i.content}Modifiers`:Na([i,' + "Modifiers"']):"modelModifiers";C.push(xs(k,Wr(`{ ${M} }`,!1,r.loc,2)))}return Mg(C)};function Mg(r=[]){return{props:r}}const xce=/[\w).+\-_$\]]/,wce=(r,e)=>{Kf("COMPILER_FILTERS",e)&&(r.type===5?AC(r.content,e):r.type===1&&r.props.forEach(t=>{t.type===7&&t.name!=="for"&&t.exp&&AC(t.exp,e)}))};function AC(r,e){if(r.type===4)O4(r,e);else for(let t=0;t<r.children.length;t++){const n=r.children[t];typeof n=="object"&&(n.type===4?O4(n,e):n.type===8?AC(r,e):n.type===5&&AC(n.content,e))}}function O4(r,e){const t=r.content;let n=!1,i=!1,s=!1,a=!1,o=0,u=0,f=0,g=0,y,A,C,M,k=[];for(C=0;C<t.length;C++)if(A=y,y=t.charCodeAt(C),n)y===39&&A!==92&&(n=!1);else if(i)y===34&&A!==92&&(i=!1);else if(s)y===96&&A!==92&&(s=!1);else if(a)y===47&&A!==92&&(a=!1);else if(y===124&&t.charCodeAt(C+1)!==124&&t.charCodeAt(C-1)!==124&&!o&&!u&&!f)M===void 0?(g=C+1,M=t.slice(0,C).trim()):D();else{switch(y){case 34:i=!0;break;case 39:n=!0;break;case 96:s=!0;break;case 40:f++;break;case 41:f--;break;case 91:u++;break;case 93:u--;break;case 123:o++;break;case 125:o--;break}if(y===47){let V=C-1,W;for(;V>=0&&(W=t.charAt(V),W===" ");V--);(!W||!xce.test(W))&&(a=!0)}}M===void 0?M=t.slice(0,C).trim():g!==0&&D();function D(){k.push(t.slice(g,C).trim()),g=C+1}if(k.length){for(C=0;C<k.length;C++)M=Cce(M,k[C],e);r.content=M,r.ast=void 0}}function Cce(r,e,t){t.helper(pS);const n=e.indexOf("(");if(n<0)return t.filters.add(e),`${up(e,"filter")}(${r})`;{const i=e.slice(0,n),s=e.slice(n+1);return t.filters.add(i),`${up(i,"filter")}(${r}${s!==")"?","+s:s}`}}const D4=new WeakSet,Tce=(r,e)=>{if(r.type===1){const t=Vo(r,"memo");return!t||D4.has(r)||e.inSSR?void 0:(D4.add(r),()=>{const n=r.codegenNode||e.currentNode.codegenNode;n&&n.type===13&&(r.tagType!==1&&wS(n,e),r.codegenNode=ro(e.helper(xS),[t.exp,ap(void 0,n),"_cache",String(e.cached.length)]),e.cached.push(null))})}},HG=(r,e)=>{if(r.type===1){for(const t of r.props)if(t.type===7&&t.name==="bind"&&!t.exp&&t.arg){const n=t.arg;if(n.type!==4||!n.isStatic)e.onError(ti(53,n.loc)),t.exp=Wr("",!0,n.loc);else{const i=or.camelize(n.content);(mk.test(i[0])||i[0]==="-")&&(t.exp=Wr(i,!1,n.loc))}}}};function WG(r){return[[HG,Ace,hce,Tce,pce,wce,...r?[DG,MG]:[],_ce,FG,OG,vce],{on:$G,bind:jG,model:GG}]}function Sce(r,e={}){const t=e.onError||hk,n=e.mode==="module",i=e.prefixIdentifiers===!0||n;!i&&e.cacheHandlers&&t(ti(50)),e.scopeId&&!n&&t(ti(51));const s=or.extend({},e,{prefixIdentifiers:i}),a=or.isString(r)?_G(r,s):r,[o,u]=WG(i);if(e.isTS){const{expressionPlugins:f}=e;(!f||!f.includes("typescript"))&&(e.expressionPlugins=[...f||[],"typescript"])}return TG(a,or.extend({},s,{nodeTransforms:[...o,...e.nodeTransforms||[]],directiveTransforms:or.extend({},u,e.directiveTransforms||{})})),SG(a,s)}const Ece={DATA:"data",PROPS:"props",PROPS_ALIASED:"props-aliased",SETUP_LET:"setup-let",SETUP_CONST:"setup-const",SETUP_REACTIVE_CONST:"setup-reactive-const",SETUP_MAYBE_REF:"setup-maybe-ref",SETUP_REF:"setup-ref",OPTIONS:"options",LITERAL_CONST:"literal-const"},Ice=()=>({props:[]});ft.generateCodeFrame=or.generateCodeFrame;ft.BASE_TRANSITION=ik;ft.BindingTypes=Ece;ft.CAMELIZE=gC;ft.CAPITALIZE=W7;ft.CREATE_BLOCK=sk;ft.CREATE_COMMENT=xy;ft.CREATE_ELEMENT_BLOCK=ok;ft.CREATE_ELEMENT_VNODE=uS;ft.CREATE_SLOTS=ck;ft.CREATE_STATIC=ak;ft.CREATE_TEXT=hS;ft.CREATE_VNODE=cS;ft.CompilerDeprecationTypes=ple;ft.ConstantTypes=ole;ft.ElementTypes=sle;ft.ErrorCodes=yle;ft.FRAGMENT=Jm;ft.GUARD_REACTIVE_PROPS=wy;ft.IS_MEMO_SAME=uk;ft.IS_REF=O_;ft.KEEP_ALIVE=P_;ft.MERGE_PROPS=M_;ft.NORMALIZE_CLASS=bS;ft.NORMALIZE_PROPS=qm;ft.NORMALIZE_STYLE=_S;ft.Namespaces=nle;ft.NodeTypes=ile;ft.OPEN_BLOCK=vd;ft.POP_SCOPE_ID=X7;ft.PUSH_SCOPE_ID=K7;ft.RENDER_LIST=mS;ft.RENDER_SLOT=lk;ft.RESOLVE_COMPONENT=B_;ft.RESOLVE_DIRECTIVE=fS;ft.RESOLVE_DYNAMIC_COMPONENT=dS;ft.RESOLVE_FILTER=pS;ft.SET_BLOCK_TRACKING=R_;ft.SUSPENSE=lS;ft.TELEPORT=Om;ft.TO_DISPLAY_STRING=yS;ft.TO_HANDLERS=vS;ft.TO_HANDLER_KEY=mC;ft.TS_NODE_TYPES=pk;ft.UNREF=k_;ft.WITH_CTX=AS;ft.WITH_DIRECTIVES=gS;ft.WITH_MEMO=xS;ft.advancePositionWithClone=D3;ft.advancePositionWithMutation=bk;ft.assert=Tle;ft.baseCompile=Sce;ft.baseParse=_G;ft.buildDirectiveArgs=zG;ft.buildProps=Tk;ft.buildSlots=LG;ft.checkCompatEnabled=D_;ft.convertToBlock=wS;ft.createArrayExpression=md;ft.createAssignmentExpression=ule;ft.createBlockStatement=Y7;ft.createCacheExpression=q7;ft.createCallExpression=ro;ft.createCompilerError=ti;ft.createCompoundExpression=Na;ft.createConditionalExpression=yC;ft.createForLoopParams=vC;ft.createFunctionExpression=ap;ft.createIfStatement=cle;ft.createInterpolation=ale;ft.createObjectExpression=Fa;ft.createObjectProperty=xs;ft.createReturnStatement=dle;ft.createRoot=J7;ft.createSequenceExpression=hle;ft.createSimpleExpression=Wr;ft.createStructuralDirectiveTransform=xk;ft.createTemplateLiteral=lle;ft.createTransformContext=CG;ft.createVNodeCall=Ym;ft.errorMessages=Q7;ft.extractIdentifiers=Gl;ft.findDir=Vo;ft.findProp=L_;ft.forAliasRE=pG;ft.generate=SG;ft.getBaseTransformPreset=WG;ft.getConstantType=Ua;ft.getMemoedVNodeCall=fG;ft.getVNodeBlockHelper=cp;ft.getVNodeHelper=lp;ft.hasDynamicKeyVBind=Sle;ft.hasScopeRef=mo;ft.helperNameMap=aa;ft.injectProp=F_;ft.isAllWhitespace=_k;ft.isCommentOrWhitespace=vk;ft.isCoreComponent=gk;ft.isFnExpression=hG;ft.isFnExpressionBrowser=Cle;ft.isFnExpressionNode=uG;ft.isFunctionType=aG;ft.isInDestructureAssignment=_C;ft.isInNewExpression=rG;ft.isMemberExpression=yk;ft.isMemberExpressionBrowser=xle;ft.isMemberExpressionNode=cG;ft.isReferencedIdentifier=tG;ft.isSimpleIdentifier=Ju;ft.isSlotOutlet=N_;ft.isStaticArgOf=id;ft.isStaticExp=Kl;ft.isStaticProperty=fk;ft.isStaticPropertyKey=lG;ft.isTemplateNode=Zm;ft.isText=uw;ft.isVPre=L3;ft.isVSlot=SS;ft.isWhitespaceText=ES;ft.locStub=ws;ft.noopDirectiveTransform=Ice;ft.processExpression=xo;ft.processFor=kG;ft.processIf=RG;ft.processSlotOutlet=VG;ft.registerRuntimeHelpers=rle;ft.resolveComponentType=UG;ft.stringifyExpression=wk;ft.toValidAssetId=up;ft.trackSlotScopes=OG;ft.trackVForSlotScopes=DG;ft.transform=TG;ft.transformBind=jG;ft.transformElement=FG;ft.transformExpression=MG;ft.transformModel=GG;ft.transformOn=$G;ft.transformVBindShorthand=HG;ft.traverseNode=Hv;ft.unwrapTSNode=CS;ft.validFirstIdentCharRE=mk;ft.walkBlockDeclarations=dk;ft.walkFunctionParams=nG;ft.walkIdentifiers=eG;ft.warnDeprecation=mle;/**
* @vue/compiler-dom v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=ft,t=Zt;const n=Symbol(""),i=Symbol(""),s=Symbol(""),a=Symbol(""),o=Symbol(""),u=Symbol(""),f=Symbol(""),g=Symbol(""),y=Symbol(""),A=Symbol("");e.registerRuntimeHelpers({[n]:"vModelRadio",[i]:"vModelCheckbox",[s]:"vModelText",[a]:"vModelSelect",[o]:"vModelDynamic",[u]:"withModifiers",[f]:"withKeys",[g]:"vShow",[y]:"Transition",[A]:"TransitionGroup"});const C={parseMode:"html",isVoidTag:t.isVoidTag,isNativeTag:_t=>t.isHTMLTag(_t)||t.isSVGTag(_t)||t.isMathMLTag(_t),isPreTag:_t=>_t==="pre",isIgnoreNewlineTag:_t=>_t==="pre"||_t==="textarea",decodeEntities:void 0,isBuiltInComponent:_t=>{if(_t==="Transition"||_t==="transition")return y;if(_t==="TransitionGroup"||_t==="transition-group")return A},getNamespace(_t,kt,nr){let fr=kt?kt.ns:nr;if(kt&&fr===2)if(kt.tag==="annotation-xml"){if(_t==="svg")return 1;kt.props.some(ve=>ve.type===6&&ve.name==="encoding"&&ve.value!=null&&(ve.value.content==="text/html"||ve.value.content==="application/xhtml+xml"))&&(fr=0)}else/^m(?:[ions]|text)$/.test(kt.tag)&&_t!=="mglyph"&&_t!=="malignmark"&&(fr=0);else kt&&fr===1&&(kt.tag==="foreignObject"||kt.tag==="desc"||kt.tag==="title")&&(fr=0);if(fr===0){if(_t==="svg")return 1;if(_t==="math")return 2}return fr}},M=_t=>{_t.type===1&&_t.props.forEach((kt,nr)=>{kt.type===6&&kt.name==="style"&&kt.value&&(_t.props[nr]={type:7,name:"bind",arg:e.createSimpleExpression("style",!0,kt.loc),exp:k(kt.value.content,kt.loc),modifiers:[],loc:kt.loc})})},k=(_t,kt)=>{const nr=t.parseStringStyle(_t);return e.createSimpleExpression(JSON.stringify(nr),!1,kt,3)};function D(_t,kt){return e.createCompilerError(_t,kt,W)}const V={X_V_HTML_NO_EXPRESSION:54,54:"X_V_HTML_NO_EXPRESSION",X_V_HTML_WITH_CHILDREN:55,55:"X_V_HTML_WITH_CHILDREN",X_V_TEXT_NO_EXPRESSION:56,56:"X_V_TEXT_NO_EXPRESSION",X_V_TEXT_WITH_CHILDREN:57,57:"X_V_TEXT_WITH_CHILDREN",X_V_MODEL_ON_INVALID_ELEMENT:58,58:"X_V_MODEL_ON_INVALID_ELEMENT",X_V_MODEL_ARG_ON_ELEMENT:59,59:"X_V_MODEL_ARG_ON_ELEMENT",X_V_MODEL_ON_FILE_INPUT_ELEMENT:60,60:"X_V_MODEL_ON_FILE_INPUT_ELEMENT",X_V_MODEL_UNNECESSARY_VALUE:61,61:"X_V_MODEL_UNNECESSARY_VALUE",X_V_SHOW_NO_EXPRESSION:62,62:"X_V_SHOW_NO_EXPRESSION",X_TRANSITION_INVALID_CHILDREN:63,63:"X_TRANSITION_INVALID_CHILDREN",X_IGNORED_SIDE_EFFECT_TAG:64,64:"X_IGNORED_SIDE_EFFECT_TAG",__EXTEND_POINT__:65,65:"__EXTEND_POINT__"},W={54:"v-html is missing expression.",55:"v-html will override element children.",56:"v-text is missing expression.",57:"v-text will override element children.",58:"v-model can only be used on <input>, <textarea> and <select> elements.",59:"v-model argument is not supported on plain elements.",60:"v-model cannot be used on file inputs since they are read-only. Use a v-on:change listener instead.",61:"Unnecessary value binding used alongside v-model. It will interfere with v-model's behavior.",62:"v-show is missing expression.",63:"<Transition> expects exactly one child element or component.",64:"Tags with side effect (<script> and <style>) are ignored in client component templates."},z=(_t,kt,nr)=>{const{exp:fr,loc:ve}=_t;return fr||nr.onError(D(54,ve)),kt.children.length&&(nr.onError(D(55,ve)),kt.children.length=0),{props:[e.createObjectProperty(e.createSimpleExpression("innerHTML",!0,ve),fr||e.createSimpleExpression("",!0))]}},$=(_t,kt,nr)=>{const{exp:fr,loc:ve}=_t;return fr||nr.onError(D(56,ve)),kt.children.length&&(nr.onError(D(57,ve)),kt.children.length=0),{props:[e.createObjectProperty(e.createSimpleExpression("textContent",!0),fr?e.getConstantType(fr,nr)>0?fr:e.createCallExpression(nr.helperString(e.TO_DISPLAY_STRING),[fr],ve):e.createSimpleExpression("",!0))]}},te=(_t,kt,nr)=>{const fr=e.transformModel(_t,kt,nr);if(!fr.props.length||kt.tagType===1)return fr;_t.arg&&nr.onError(D(59,_t.arg.loc));const{tag:ve}=kt,Ee=nr.isCustomElement(ve);if(ve==="input"||ve==="textarea"||ve==="select"||Ee){let He=s,wt=!1;if(ve==="input"||Ee){const Qe=e.findProp(kt,"type");if(Qe){if(Qe.type===7)He=o;else if(Qe.value)switch(Qe.value.content){case"radio":He=n;break;case"checkbox":He=i;break;case"file":wt=!0,nr.onError(D(60,_t.loc));break}}else e.hasDynamicKeyVBind(kt)&&(He=o)}else ve==="select"&&(He=a);wt||(fr.needRuntime=nr.helper(He))}else nr.onError(D(58,_t.loc));return fr.props=fr.props.filter(He=>!(He.key.type===4&&He.key.content==="modelValue")),fr},le=t.makeMap("passive,once,capture"),_e=t.makeMap("stop,prevent,self,ctrl,shift,alt,meta,exact,middle"),se=t.makeMap("left,right"),Y=t.makeMap("onkeyup,onkeydown,onkeypress"),ce=(_t,kt,nr,fr)=>{const ve=[],Ee=[],He=[];for(let wt=0;wt<kt.length;wt++){const Qe=kt[wt].content;Qe==="native"&&e.checkCompatEnabled("COMPILER_V_ON_NATIVE",nr,fr)||le(Qe)?He.push(Qe):se(Qe)?e.isStaticExp(_t)?Y(_t.content.toLowerCase())?ve.push(Qe):Ee.push(Qe):(ve.push(Qe),Ee.push(Qe)):_e(Qe)?Ee.push(Qe):ve.push(Qe)}return{keyModifiers:ve,nonKeyModifiers:Ee,eventOptionModifiers:He}},oe=(_t,kt)=>e.isStaticExp(_t)&&_t.content.toLowerCase()==="onclick"?e.createSimpleExpression(kt,!0):_t.type!==4?e.createCompoundExpression(["(",_t,`) === "onClick" ? "${kt}" : (`,_t,")"]):_t,Me=(_t,kt,nr)=>e.transformOn(_t,kt,nr,fr=>{const{modifiers:ve}=_t;if(!ve.length)return fr;let{key:Ee,value:He}=fr.props[0];const{keyModifiers:wt,nonKeyModifiers:Qe,eventOptionModifiers:mt}=ce(Ee,ve,nr,_t.loc);if(Qe.includes("right")&&(Ee=oe(Ee,"onContextmenu")),Qe.includes("middle")&&(Ee=oe(Ee,"onMouseup")),Qe.length&&(He=e.createCallExpression(nr.helper(u),[He,JSON.stringify(Qe)])),wt.length&&(!e.isStaticExp(Ee)||Y(Ee.content.toLowerCase()))&&(He=e.createCallExpression(nr.helper(f),[He,JSON.stringify(wt)])),mt.length){const $t=mt.map(t.capitalize).join("");Ee=e.isStaticExp(Ee)?e.createSimpleExpression(`${Ee.content}${$t}`,!0):e.createCompoundExpression(["(",Ee,`) + "${$t}"`])}return{props:[e.createObjectProperty(Ee,He)]}}),ze=(_t,kt,nr)=>{const{exp:fr,loc:ve}=_t;return fr||nr.onError(D(62,ve)),{props:[],needRuntime:nr.helper(g)}},Ve=/__VUE_EXP_START__(.*?)__VUE_EXP_END__/g,lt=(_t,kt,nr)=>{if(kt.scopes.vSlot>0)return;const fr=nr.type===1&&nr.codegenNode&&nr.codegenNode.type===13&&nr.codegenNode.children&&!t.isArray(nr.codegenNode.children)&&nr.codegenNode.children.type===20;let ve=0,Ee=0;const He=[],wt=mt=>{if(ve>=20||Ee>=5){const $t=e.createCallExpression(kt.helper(e.CREATE_STATIC),[JSON.stringify(He.map(Nt=>Er(Nt,kt)).join("")).replace(Ve,'" + $1 + "'),String(He.length)]),Dt=He.length-1;if(fr)_t.splice(mt-He.length,He.length,$t);else if(He[0].codegenNode.value=$t,He.length>1){_t.splice(mt-He.length+1,Dt);const Nt=kt.cached.indexOf(He[He.length-1].codegenNode);if(Nt>-1){for(let It=Nt;It<kt.cached.length;It++){const mr=kt.cached[It];mr&&(mr.index-=Dt)}kt.cached.splice(Nt-Dt+1,Dt)}}return Dt}return 0};let Qe=0;for(;Qe<_t.length;Qe++){const mt=_t[Qe];if(fr||gt(mt)){const Dt=xr(mt);if(Dt){ve+=Dt[0],Ee+=Dt[1],He.push(mt);continue}}Qe-=wt(Qe),ve=0,Ee=0,He.length=0}wt(Qe)},gt=_t=>{if((_t.type===1&&_t.tagType===0||_t.type===12)&&_t.codegenNode&&_t.codegenNode.type===20)return _t.codegenNode},At=/^(?:data|aria)-/,Tt=(_t,kt)=>(kt===0?t.isKnownHtmlAttr(_t):kt===1?t.isKnownSvgAttr(_t):kt===2?t.isKnownMathMLAttr(_t):!1)||At.test(_t),Ut=t.makeMap("caption,thead,tr,th,tbody,td,tfoot,colgroup,col");function xr(_t){if(_t.type===1&&Ut(_t.tag)||_t.type===1&&e.findDir(_t,"once",!0))return!1;if(_t.type===12)return[1,0];let kt=1,nr=_t.props.length>0?1:0,fr=!1;const ve=()=>(fr=!0,!1);function Ee(He){const wt=He.tag==="option"&&He.ns===0;for(let Qe=0;Qe<He.props.length;Qe++){const mt=He.props[Qe];if(mt.type===6&&!Tt(mt.name,He.ns)||mt.type===7&&mt.name==="bind"&&(mt.arg&&(mt.arg.type===8||mt.arg.isStatic&&!Tt(mt.arg.content,He.ns))||mt.exp&&(mt.exp.type===8||mt.exp.constType<3)||wt&&e.isStaticArgOf(mt.arg,"value")&&mt.exp&&!mt.exp.isStatic))return ve()}for(let Qe=0;Qe<He.children.length;Qe++){kt++;const mt=He.children[Qe];if(mt.type===1&&(mt.props.length>0&&nr++,Ee(mt),fr))return!1}return!0}return Ee(_t)?[kt,nr]:!1}function Er(_t,kt){if(t.isString(_t))return _t;if(t.isSymbol(_t))return"";switch(_t.type){case 1:return Jr(_t,kt);case 2:return t.escapeHtml(_t.content);case 3:return`<!--${t.escapeHtml(_t.content)}-->`;case 5:return t.escapeHtml(t.toDisplayString(Xn(_t.content)));case 8:return t.escapeHtml(Xn(_t));case 12:return Er(_t.content,kt);default:return""}}function Jr(_t,kt){let nr=`<${_t.tag}`,fr="";for(let ve=0;ve<_t.props.length;ve++){const Ee=_t.props[ve];if(Ee.type===6)nr+=` ${Ee.name}`,Ee.value&&(nr+=`="${t.escapeHtml(Ee.value.content)}"`);else if(Ee.type===7)if(Ee.name==="bind"){const He=Ee.exp;if(He.content[0]==="_"){nr+=` ${Ee.arg.content}="__VUE_EXP_START__${He.content}__VUE_EXP_END__"`;continue}if(t.isBooleanAttr(Ee.arg.content)&&He.content==="false")continue;let wt=Xn(He);if(wt!=null){const Qe=Ee.arg&&Ee.arg.content;Qe==="class"?wt=t.normalizeClass(wt):Qe==="style"&&(wt=t.stringifyStyle(t.normalizeStyle(wt))),nr+=` ${Ee.arg.content}="${t.escapeHtml(wt)}"`}}else Ee.name==="html"?fr=Xn(Ee.exp):Ee.name==="text"&&(fr=t.escapeHtml(t.toDisplayString(Xn(Ee.exp))))}if(kt.scopeId&&(nr+=` ${kt.scopeId}`),nr+=">",fr)nr+=fr;else for(let ve=0;ve<_t.children.length;ve++)nr+=Er(_t.children[ve],kt);return t.isVoidTag(_t.tag)||(nr+=`</${_t.tag}>`),nr}function Xn(_t){if(_t.type===4)return new Function(`return (${_t.content})`)();{let kt="";return _t.children.forEach(nr=>{t.isString(nr)||t.isSymbol(nr)||(nr.type===2?kt+=nr.content:nr.type===5?kt+=t.toDisplayString(Xn(nr.content)):kt+=Xn(nr))}),kt}}const mi=(_t,kt)=>{_t.type===1&&_t.tagType===0&&(_t.tag==="script"||_t.tag==="style")&&kt.removeNode()},Pn=[M],Bn={cloak:e.noopDirectiveTransform,html:z,text:$,model:te,on:Me,show:ze};function Jn(_t,kt={}){return e.baseCompile(_t,t.extend({},C,kt,{nodeTransforms:[mi,...Pn,...kt.nodeTransforms||[]],directiveTransforms:t.extend({},Bn,kt.directiveTransforms||{}),transformHoist:lt}))}function Mn(_t,kt={}){return e.baseParse(_t,t.extend({},C,kt))}r.DOMDirectiveTransforms=Bn,r.DOMErrorCodes=V,r.DOMErrorMessages=W,r.DOMNodeTransforms=Pn,r.TRANSITION=y,r.TRANSITION_GROUP=A,r.V_MODEL_CHECKBOX=i,r.V_MODEL_DYNAMIC=o,r.V_MODEL_RADIO=n,r.V_MODEL_SELECT=a,r.V_MODEL_TEXT=s,r.V_ON_WITH_KEYS=f,r.V_ON_WITH_MODIFIERS=u,r.V_SHOW=g,r.compile=Jn,r.createDOMCompilerError=D,r.parse=Mn,r.parserOptions=C,r.transformStyle=M,Object.keys(e).forEach(function(_t){_t!=="default"&&!Object.prototype.hasOwnProperty.call(r,_t)&&(r[_t]=e[_t])})})(eS);/**
* vue v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/var L4;function Pce(){return L4||(L4=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=eS,t=I,n=Zt;function i(u){var f=Object.create(null);if(u)for(var g in u)f[g]=u[g];return f.default=u,Object.freeze(f)}var s=i(t);const a=Object.create(null);function o(u,f){if(!n.isString(u))if(u.nodeType)u=u.innerHTML;else return n.NOOP;const g=n.genCacheKey(u,f),y=a[g];if(y)return y;if(u[0]==="#"){const k=document.querySelector(u);u=k?k.innerHTML:""}const A=n.extend({hoistStatic:!0,onError:void 0,onWarn:n.NOOP},f);!A.isCustomElement&&typeof customElements<"u"&&(A.isCustomElement=k=>!!customElements.get(k));const{code:C}=e.compile(u,A),M=new Function("Vue",C)(s);return M._rc=!0,a[g]=M}t.registerRuntimeCompiler(o),r.compile=o,Object.keys(t).forEach(function(u){u!=="default"&&!Object.prototype.hasOwnProperty.call(r,u)&&(r[u]=t[u])})}(YE)),YE}var oI={};/**
* vue v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/var N4;function Bce(){return N4||(N4=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=eS,t=I,n=Zt;function i(u){var f=Object.create(null);if(u)for(var g in u)f[g]=u[g];return f.default=u,Object.freeze(f)}var s=i(t);const a=Object.create(null);function o(u,f){if(!n.isString(u))if(u.nodeType)u=u.innerHTML;else return t.warn("invalid template option: ",u),n.NOOP;const g=n.genCacheKey(u,f),y=a[g];if(y)return y;if(u[0]==="#"){const D=document.querySelector(u);D||t.warn(`Template element not found or is empty: ${u}`),u=D?D.innerHTML:""}const A=n.extend({hoistStatic:!0,onError:M,onWarn:D=>M(D,!0)},f);!A.isCustomElement&&typeof customElements<"u"&&(A.isCustomElement=D=>!!customElements.get(D));const{code:C}=e.compile(u,A);function M(D,V=!1){const W=V?D.message:`Template compilation error: ${D.message}`,z=D.loc&&n.generateCodeFrame(u,D.loc.start.offset,D.loc.end.offset);t.warn(z?`${W}
${z}`:W)}const k=new Function("Vue",C)(s);return k._rc=!0,a[g]=k}t.registerRuntimeCompiler(o),r.compile=o,Object.keys(t).forEach(function(u){u!=="default"&&!Object.prototype.hasOwnProperty.call(r,u)&&(r[u]=t[u])})}(oI)),oI}process.env.NODE_ENV==="production"?E3.exports=Pce():E3.exports=Bce();var Mce=E3.exports,Sk={};/**
* @vue/compiler-ssr v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/Object.defineProperty(Sk,"__esModule",{value:!0});var qe=eS,$o=Zt;const xC=Symbol("ssrInterpolate"),KG=Symbol("ssrRenderVNode"),XG=Symbol("ssrRenderComponent"),JG=Symbol("ssrRenderSlot"),qG=Symbol("ssrRenderSlotInner"),YG=Symbol("ssrRenderClass"),ZG=Symbol("ssrRenderStyle"),Ek=Symbol("ssrRenderAttrs"),QG=Symbol("ssrRenderAttr"),eH=Symbol("ssrRenderDynamicAttr"),tH=Symbol("ssrRenderList"),Ik=Symbol("ssrIncludeBooleanAttr"),mw=Symbol("ssrLooseEqual"),V3=Symbol("ssrLooseContain"),rH=Symbol("ssrRenderDynamicModel"),nH=Symbol("ssrGetDynamicModelProps"),iH=Symbol("ssrRenderTeleport"),sH=Symbol("ssrRenderSuspense"),oH=Symbol("ssrGetDirectiveProps"),$3={[xC]:"ssrInterpolate",[KG]:"ssrRenderVNode",[XG]:"ssrRenderComponent",[JG]:"ssrRenderSlot",[qG]:"ssrRenderSlotInner",[YG]:"ssrRenderClass",[ZG]:"ssrRenderStyle",[Ek]:"ssrRenderAttrs",[QG]:"ssrRenderAttr",[eH]:"ssrRenderDynamicAttr",[tH]:"ssrRenderList",[Ik]:"ssrIncludeBooleanAttr",[mw]:"ssrLooseEqual",[V3]:"ssrLooseContain",[rH]:"ssrRenderDynamicModel",[nH]:"ssrGetDynamicModelProps",[iH]:"ssrRenderTeleport",[sH]:"ssrRenderSuspense",[oH]:"ssrGetDirectiveProps"};qe.registerRuntimeHelpers($3);const Rce=qe.createStructuralDirectiveTransform(/^(?:if|else|else-if)$/,qe.processIf);function kce(r,e,t=!1,n=!1){const[i]=r.branches,s=qe.createIfStatement(i.condition,F4(i,e,t));e.pushStatement(s);let a=s;for(let o=1;o<r.branches.length;o++){const u=r.branches[o],f=F4(u,e,t);u.condition?a=a.alternate=qe.createIfStatement(u.condition,f):a.alternate=f}!a.alternate&&!n&&(a.alternate=qe.createBlockStatement([qe.createCallExpression("_push",["`<!---->`"])]))}function F4(r,e,t=!1){const{children:n}=r,i=!t&&(n.length!==1||n[0].type!==1)&&!(n.length===1&&n[0].type===11);return Ty(r,e,i)}const Oce=qe.createStructuralDirectiveTransform("for",qe.processFor);function Dce(r,e,t=!1){const n=!t&&(r.children.length!==1||r.children[0].type!==1),i=qe.createFunctionExpression(qe.createForLoopParams(r.parseResult));i.body=Ty(r,e,n),t||e.pushStringPart("<!--[-->"),e.pushStatement(qe.createCallExpression(e.helper(tH),[r.source,i])),t||e.pushStringPart("<!--]-->")}const Lce=(r,e)=>{if(qe.isSlotOutlet(r)){const{slotName:t,slotProps:n}=qe.processSlotOutlet(r,e),i=["_ctx.$slots",t,n||"{}","null","_push","_parent"];e.scopeId&&e.slotted!==!1&&i.push(`"${e.scopeId}-s"`);let s=JG,a=e.parent;if(a){const o=a.children;a.type===10&&(a=e.grandParent);let u;a.type===1&&a.tagType===1&&((u=qe.resolveComponentType(a,e,!0))===qe.TRANSITION||u===qe.TRANSITION_GROUP)&&o.filter(f=>f.type===1).length===1&&(s=qG,e.scopeId&&e.slotted!==!1||i.push("null"),i.push("true"))}r.ssrCodegenNode=qe.createCallExpression(e.helper(s),i)}};function Nce(r,e){const t=r.ssrCodegenNode;if(r.children.length){const n=qe.createFunctionExpression([]);n.body=Ty(r,e),t.arguments[3]=n}if(e.withSlotScopeId){const n=t.arguments[6];t.arguments[6]=n?`${n} + _scopeId`:"_scopeId"}e.pushStatement(r.ssrCodegenNode)}function z_(r,e){return qe.createCompilerError(r,e,Fce)}const Fce={65:"Unsafe attribute name for SSR.",66:"Missing the 'to' prop on teleport element.",67:"Invalid AST node during SSR transform."};function Uce(r,e){const t=qe.findProp(r,"to");if(!t){e.onError(z_(66,r.loc));return}let n;if(t.type===6?n=t.value&&qe.createSimpleExpression(t.value.content,!0):n=t.exp,!n){e.onError(z_(66,t.loc));return}const i=qe.findProp(r,"disabled",!1,!0),s=i?i.type===6?"true":i.exp||"false":"false",a=qe.createFunctionExpression(["_push"],void 0,!0,!1,r.loc);a.body=Ty(r,e),e.pushStatement(qe.createCallExpression(e.helper(iH),["_push",a,n,s,"_parent"]))}const aH=new WeakMap;function zce(r,e){return()=>{if(r.children.length){const t={slotsExp:null,wipSlots:[]};aH.set(r,t),t.slotsExp=qe.buildSlots(r,e,(n,i,s,a)=>{const o=qe.createFunctionExpression([],void 0,!0,!1,a);return t.wipSlots.push({fn:o,children:s}),o}).slots}}}function Vce(r,e){const t=aH.get(r);if(!t)return;const{slotsExp:n,wipSlots:i}=t;for(let s=0;s<i.length;s++){const a=i[s];a.fn.body=Ty(a,e)}e.pushStatement(qe.createCallExpression(e.helper(sH),["_push",n]))}const x0=new WeakMap,$ce=(r,e)=>{if(!(r.type!==1||r.tagType!==0))return function(){const n=[`<${r.tag}`],i=r.tag==="textarea"||r.tag.indexOf("-")>0,s=qe.hasDynamicKeyVBind(r),a=r.props.some(A=>A.type===7&&!$o.isBuiltInDirective(A.name)),o=r.props.findIndex(A=>A.type===7&&A.name==="show");if(o!==-1){const A=r.props[o];r.props.splice(o,1),r.props.push(A)}const u=s||a;if(u){const{props:A,directives:C}=qe.buildProps(r,e,r.props,!1,!1,!0);if(A||C.length){const M=Pk(A,C,e),k=qe.createCallExpression(e.helper(Ek),[M]);if(r.tag==="textarea"){const D=r.children[0];if(!z4(r)&&(!D||D.type!==5)){const V=`_temp${e.temps++}`;k.arguments=[qe.createAssignmentExpression(qe.createSimpleExpression(V,!1),M)],x0.set(r,qe.createCallExpression(e.helper(xC),[qe.createConditionalExpression(qe.createSimpleExpression(`"value" in ${V}`,!1),qe.createSimpleExpression(`${V}.value`,!1),qe.createSimpleExpression(D?D.content:"",!0),!1)]))}}else if(r.tag==="input"){const D=Wce(r);if(D){const V=`_temp${e.temps++}`,W=qe.createSimpleExpression(V,!1);k.arguments=[qe.createSequenceExpression([qe.createAssignmentExpression(W,M),qe.createCallExpression(e.helper(qe.MERGE_PROPS),[W,qe.createCallExpression(e.helper(nH),[W,D.exp])])])]}}else if(C.length&&!r.children.length&&!z4(r)){const D=`_temp${e.temps++}`;k.arguments=[qe.createAssignmentExpression(qe.createSimpleExpression(D,!1),M)],x0.set(r,qe.createConditionalExpression(qe.createSimpleExpression(`"textContent" in ${D}`,!1),qe.createCallExpression(e.helper(xC),[qe.createSimpleExpression(`${D}.textContent`,!1)]),qe.createSimpleExpression(`${D}.innerHTML ?? ''`,!1),!1))}i&&k.arguments.push(`"${r.tag}"`),n.push(k)}}let f,g,y;for(let A=0;A<r.props.length;A++){const C=r.props[A];if(!(r.tag==="input"&&jce(C)))if(C.type===7){if(C.name==="html"&&C.exp)x0.set(r,qe.createCompoundExpression(["(",C.exp,") ?? ''"]));else if(C.name==="text"&&C.exp)r.children=[qe.createInterpolation(C.exp,C.loc)];else if(C.name==="slot")e.onError(qe.createCompilerError(40,C.loc));else if(Gce(r,C)&&C.exp)u||(r.children=[qe.createInterpolation(C.exp,C.loc)]);else if(!u&&C.name!=="on"){const M=e.directiveTransforms[C.name];if(M){const{props:k,ssrTagParts:D}=M(C,r,e);D&&n.push(...D);for(let V=0;V<k.length;V++){const{key:W,value:z}=k[V];if(qe.isStaticExp(W)){let $=W.content;if($==="key"||$==="ref")continue;$==="class"?n.push(' class="',f=qe.createCallExpression(e.helper(YG),[z]),'"'):$==="style"?y?U4(y,z):n.push(' style="',y=qe.createCallExpression(e.helper(ZG),[z]),'"'):($=r.tag.indexOf("-")>0?$:$o.propsToAttrMap[$]||$.toLowerCase(),$o.isBooleanAttr($)?n.push(qe.createConditionalExpression(qe.createCallExpression(e.helper(Ik),[z]),qe.createSimpleExpression(" "+$,!0),qe.createSimpleExpression("",!0),!1)):$o.isSSRSafeAttrName($)?n.push(qe.createCallExpression(e.helper(QG),[W,z])):e.onError(z_(65,W.loc)))}else{const $=[W,z];i&&$.push(`"${r.tag}"`),n.push(qe.createCallExpression(e.helper(eH),$))}}}}}else{const M=C.name;if(r.tag==="textarea"&&M==="value"&&C.value)x0.set(r,$o.escapeHtml(C.value.content));else if(!u){if(M==="key"||M==="ref")continue;M==="class"&&C.value&&(g=JSON.stringify(C.value.content)),n.push(` ${C.name}`+(C.value?`="${$o.escapeHtml(C.value.content)}"`:""))}}}f&&g&&(U4(f,g),Hce(n,"class")),e.scopeId&&n.push(` ${e.scopeId}`),r.ssrCodegenNode=qe.createTemplateLiteral(n)}};function Pk(r,e,t){let n=[];if(r&&(r.type===14?n=r.arguments:n.push(r)),e.length)for(const i of e)n.push(qe.createCallExpression(t.helper(oH),["_ctx",...qe.buildDirectiveArgs(i,t).elements]));return n.length>1?qe.createCallExpression(t.helper(qe.MERGE_PROPS),n):n[0]}function jce(r){return r.type===7?r.name==="bind"&&r.arg&&qe.isStaticExp(r.arg)&&(r.arg.content==="true-value"||r.arg.content==="false-value"):r.name==="true-value"||r.name==="false-value"}function Gce(r,e){return!!(r.tag==="textarea"&&e.name==="bind"&&qe.isStaticArgOf(e.arg,"value"))}function U4(r,e){const t=r.arguments[0];t.type===17?t.elements.push(e):r.arguments[0]=qe.createArrayExpression([t,e])}function Hce(r,e){const t=new RegExp(`^ ${e}=".+"$`),n=r.findIndex(i=>typeof i=="string"&&t.test(i));n>-1&&r.splice(n,1)}function Wce(r){return r.props.find(e=>e.type===7&&e.name==="model"&&e.exp)}function z4(r){return!!qe.findDir(r,"text")||!!qe.findDir(r,"html")}function Kce(r,e){const t=e.options.isVoidTag||$o.NO,n=r.ssrCodegenNode.elements;for(let s=0;s<n.length;s++)e.pushStringPart(n[s]);e.withSlotScopeId&&e.pushStringPart(qe.createSimpleExpression("_scopeId",!1)),e.pushStringPart(">");const i=x0.get(r);i?e.pushStringPart(i):r.children.length&&Gu(r,e),t(r.tag)||e.pushStringPart(`</${r.tag}>`)}const lH=new WeakMap;function Xce(r,e){return()=>{const t=qe.findProp(r,"tag");if(t){const n=r.props.filter(o=>o!==t),{props:i,directives:s}=qe.buildProps(r,e,n,!0,!1,!0);let a=null;(i||s.length)&&(a=qe.createCallExpression(e.helper(Ek),[Pk(i,s,e)])),lH.set(r,{tag:t,propsExp:a,scopeId:e.scopeId||null})}}}function Jce(r,e){const t=lH.get(r);if(t){const{tag:n,propsExp:i,scopeId:s}=t;n.type===7?(e.pushStringPart("<"),e.pushStringPart(n.exp),i&&e.pushStringPart(i),s&&e.pushStringPart(` ${s}`),e.pushStringPart(">"),Gu(r,e,!1,!0,!0),e.pushStringPart("</"),e.pushStringPart(n.exp),e.pushStringPart(">")):(e.pushStringPart(`<${n.value.content}`),i&&e.pushStringPart(i),s&&e.pushStringPart(` ${s}`),e.pushStringPart(">"),Gu(r,e,!1,!0,!0),e.pushStringPart(`</${n.value.content}>`))}else Gu(r,e,!0,!0,!0)}const cH=new WeakMap;function qce(r,e){return()=>{const t=qe.findProp(r,"appear",!1,!0);cH.set(r,!!t)}}function Yce(r,e){r.children=r.children.filter(n=>n.type!==3),cH.get(r)?(e.pushStringPart("<template>"),Gu(r,e,!1,!0),e.pushStringPart("</template>")):Gu(r,e,!1,!0)}const uH=new WeakMap,hH=Symbol(),dH=new WeakMap,Zce=(r,e)=>{if(r.type!==1||r.tagType!==1)return;const t=qe.resolveComponentType(r,e,!0),n=$o.isObject(t)&&t.callee===qe.RESOLVE_DYNAMIC_COMPONENT;if(dH.set(r,t),$o.isSymbol(t))return t===qe.SUSPENSE?zce(r,e):t===qe.TRANSITION_GROUP?Xce(r,e):t===qe.TRANSITION?qce(r):void 0;const i=[],s=j3(r);return function(){s.children.length&&qe.buildSlots(s,e,(y,A,C)=>(i.push(iue(y,A,C,e)),qe.createFunctionExpression(void 0)));let o="null";if(r.props.length){const{props:y,directives:A}=qe.buildProps(r,e,void 0,!0,n);(y||A.length)&&(o=Pk(y,A,e))}const u=[];uH.set(r,u);const f=(y,A,C,M)=>{const k=y&&qe.stringifyExpression(y)||"_",D=qe.createFunctionExpression([k,"_push","_parent","_scopeId"],void 0,!0,!0,M);return u.push({type:hH,fn:D,children:C,vnodeBranch:i[u.length]}),D},g=r.children.length?qe.buildSlots(r,e,f).slots:"null";typeof t!="string"?r.ssrCodegenNode=qe.createCallExpression(e.helper(KG),["_push",qe.createCallExpression(e.helper(qe.CREATE_VNODE),[t,o,g]),"_parent"]):r.ssrCodegenNode=qe.createCallExpression(e.helper(XG),[t,o,g,"_parent"])}};function Qce(r,e,t){const n=dH.get(r);if(r.ssrCodegenNode){const i=uH.get(r)||[];for(let s=0;s<i.length;s++){const{fn:a,vnodeBranch:o}=i[s];a.body=qe.createIfStatement(qe.createSimpleExpression("_push",!1),Ty(i[s],e,!1,!0),o)}e.withSlotScopeId&&r.ssrCodegenNode.arguments.push("_scopeId"),typeof n=="string"?e.pushStatement(qe.createCallExpression("_push",[r.ssrCodegenNode])):e.pushStatement(r.ssrCodegenNode)}else{if(n===qe.TELEPORT)return Uce(r,e);if(n===qe.SUSPENSE)return Vce(r,e);if(n===qe.TRANSITION_GROUP)return Jce(r,e);if(t.type===hH&&e.pushStringPart(""),n===qe.TRANSITION)return Yce(r,e);Gu(r,e)}}const fH=new WeakMap,[eue,tue]=qe.getBaseTransformPreset(!0),rue=[...eue,...qe.DOMNodeTransforms],nue={...tue,...qe.DOMDirectiveTransforms};function iue(r,e,t,n){const i=fH.get(n.root),s={...i,nodeTransforms:[...rue,...i.nodeTransforms||[]],directiveTransforms:{...nue,...i.directiveTransforms||{}}},a=[];r&&a.push({type:7,name:"slot",exp:r,arg:void 0,modifiers:[],loc:qe.locStub}),e&&a.push($o.extend({},e));const o={type:1,ns:0,tag:"template",tagType:3,props:a,children:t,loc:qe.locStub,codegenNode:void 0};return sue(o,s,n),qe.createReturnStatement(t)}function sue(r,e,t){const n=qe.createRoot([r]),i=qe.createTransformContext(n,e);i.ssr=!1,i.scopes={...t.scopes},i.identifiers={...t.identifiers},i.imports=t.imports,qe.traverseNode(n,i),["helpers","components","directives"].forEach(s=>{i[s].forEach((a,o)=>{if(s==="helpers"){const u=t.helpers.get(o);u===void 0?t.helpers.set(o,a):t.helpers.set(o,a+u)}else t[s].add(a)})})}function j3(r){if($o.isArray(r))return r.map(j3);if($o.isPlainObject(r)){const e={};for(const t in r)e[t]=j3(r[t]);return e}else return r}function oue(r,e){const t=pH(r,e);if(e.ssrCssVars){const i=qe.createTransformContext(qe.createRoot([]),e),s=qe.processExpression(qe.createSimpleExpression(e.ssrCssVars,!1),i);t.body.push(qe.createCompoundExpression(["const _cssVars = { style: ",s,"}"])),Array.from(i.helpers.keys()).forEach(a=>{r.helpers.add(a)})}const n=r.children.length>1&&r.children.some(i=>!qe.isText(i));Gu(r,t,n),r.codegenNode=qe.createBlockStatement(t.body),r.ssrHelpers=Array.from(new Set([...Array.from(r.helpers).filter(i=>i in $3),...t.helpers])),r.helpers=new Set(Array.from(r.helpers).filter(i=>!(i in $3)))}function pH(r,e,t=new Set,n=!1){const i=[];let s=null;return{root:r,options:e,body:i,helpers:t,withSlotScopeId:n,onError:e.onError||(a=>{throw a}),helper(a){return t.add(a),a},pushStringPart(a){if(!s){const f=qe.createCallExpression("_push");i.push(f),s=qe.createTemplateLiteral([]),f.arguments.push(s)}const o=s.elements,u=o[o.length-1];$o.isString(a)&&$o.isString(u)?o[o.length-1]+=a:o.push(a)},pushStatement(a){s=null,i.push(a)}}}function aue(r,e=r.withSlotScopeId){return pH(r.root,r.options,r.helpers,e)}function Gu(r,e,t=!1,n=!1,i=!1){t&&e.pushStringPart("<!--[-->");const{children:s}=r;for(let a=0;a<s.length;a++){const o=s[a];switch(o.type){case 1:switch(o.tagType){case 0:Kce(o,e);break;case 1:Qce(o,e,r);break;case 2:Nce(o,e);break;case 3:break;default:return e.onError(z_(67,o.loc)),o}break;case 2:e.pushStringPart($o.escapeHtml(o.content));break;case 3:i||e.pushStringPart(`<!--${o.content}-->`);break;case 5:e.pushStringPart(qe.createCallExpression(e.helper(xC),[o.content]));break;case 9:kce(o,e,n,i);break;case 11:Dce(o,e,n);break;case 10:break;case 12:case 8:break;default:return e.onError(z_(67,o.loc)),o}}t&&e.pushStringPart("<!--]-->")}function Ty(r,e,t=!1,n=e.withSlotScopeId){const i=aue(e,n);return Gu(r,i,t),qe.createBlockStatement(i.body)}const lue=(r,e,t)=>{const n=r.exp;function i(){const o=qe.findProp(e,"value");o&&t.onError(qe.createDOMCompilerError(61,o.loc))}const s=o=>{o.forEach(u=>{u.type===1?a(u):u.type===11?s(u.children):u.type===9&&u.branches.forEach(f=>s(f.children))})};function a(o){if(o.tag==="option"){if(o.props.findIndex(u=>u.name==="selected")===-1){const u=V4(o);o.ssrCodegenNode.elements.push(qe.createConditionalExpression(qe.createCallExpression(t.helper(Ik),[qe.createConditionalExpression(qe.createCallExpression("Array.isArray",[n]),qe.createCallExpression(t.helper(V3),[n,u]),qe.createCallExpression(t.helper(mw),[n,u]))]),qe.createSimpleExpression(" selected",!0),qe.createSimpleExpression("",!0),!1))}}else o.tag==="optgroup"&&s(o.children)}if(e.tagType===0){const o={props:[]};if(e.tag==="input"){const u=[qe.createObjectProperty("value",n)],f=qe.findProp(e,"type");if(f){const g=V4(e);if(f.type===7)o.ssrTagParts=[qe.createCallExpression(t.helper(rH),[f.exp,n,g])];else if(f.value)switch(f.value.content){case"radio":o.props=[qe.createObjectProperty("checked",qe.createCallExpression(t.helper(mw),[n,g]))];break;case"checkbox":const y=qe.findProp(e,"true-value");if(y){const A=y.type===6?JSON.stringify(y.value.content):y.exp;o.props=[qe.createObjectProperty("checked",qe.createCallExpression(t.helper(mw),[n,A]))]}else o.props=[qe.createObjectProperty("checked",qe.createConditionalExpression(qe.createCallExpression("Array.isArray",[n]),qe.createCallExpression(t.helper(V3),[n,g]),n))];break;case"file":t.onError(qe.createDOMCompilerError(60,r.loc));break;default:i(),o.props=u;break}}else qe.hasDynamicKeyVBind(e)||(i(),o.props=u)}else e.tag==="textarea"?(i(),e.children=[qe.createInterpolation(n,n.loc)]):e.tag==="select"?s(e.children):t.onError(qe.createDOMCompilerError(58,r.loc));return o}else return qe.transformModel(r,e,t)};function V4(r){const e=qe.findProp(r,"value");return e?e.type===7?e.exp:qe.createSimpleExpression(e.value.content,!0):qe.createSimpleExpression("null",!1)}const cue=(r,e,t)=>(r.exp||t.onError(qe.createDOMCompilerError(62)),{props:[qe.createObjectProperty("style",qe.createConditionalExpression(r.exp,qe.createSimpleExpression("null",!1),qe.createObjectExpression([qe.createObjectProperty("display",qe.createSimpleExpression("none",!0))]),!1))]}),G3=r=>r.children.filter(e=>!qe.isCommentOrWhitespace(e)),aI=r=>G3(r).length===1,uue=(r,e)=>{if(r.type===0&&(e.identifiers._attrs=1),r.type===1&&r.tagType===1&&(r.tag==="transition"||r.tag==="Transition"||r.tag==="KeepAlive"||r.tag==="keep-alive")){const n=G3(e.root);if(n.length===1&&n[0]===r){aI(r)&&lI(r.children[0]);return}}const t=e.parent;if(!(!t||t.type!==0))if(r.type===10&&aI(r)){let n=!1;for(const i of G3(t))if(i.type===9||i.type===1&&qe.findDir(i,"if")){if(n)return;n=!0}else if(!n||!(i.type===1&&qe.findDir(i,/else/,!0)))return;lI(r.children[0])}else aI(t)&&lI(r)};function lI(r){r.type===1&&(r.tagType===0||r.tagType===1)&&!qe.findDir(r,"for")&&r.props.push({type:7,name:"bind",arg:void 0,exp:qe.createSimpleExpression("_attrs",!1),modifiers:[],loc:qe.locStub})}const hue=(r,e)=>{if(!e.ssrCssVars)return;r.type===0&&(e.identifiers._cssVars=1);const t=e.parent;if(!(!t||t.type!==0))if(r.type===10)for(const n of r.children)wC(n);else wC(r)};function wC(r){if(r.type===1&&(r.tagType===0||r.tagType===1)&&!qe.findDir(r,"for"))if(r.tag==="suspense"||r.tag==="Suspense")for(const e of r.children)e.type===1&&e.tagType===3?e.children.forEach(wC):wC(e);else r.props.push({type:7,name:"bind",arg:void 0,exp:qe.createSimpleExpression("_cssVars",!1),modifiers:[],loc:qe.locStub})}function due(r,e={}){e={...e,...qe.parserOptions,ssr:!0,inSSR:!0,scopeId:e.mode==="function"?null:e.scopeId,prefixIdentifiers:!0,cacheHandlers:!1,hoistStatic:!1};const t=typeof r=="string"?qe.baseParse(r,e):r;return fH.set(t,e),qe.transform(t,{...e,hoistStatic:!1,nodeTransforms:[qe.transformVBindShorthand,Rce,Oce,qe.trackVForSlotScopes,qe.transformExpression,Lce,uue,hue,$ce,Zce,qe.trackSlotScopes,qe.transformStyle,...e.nodeTransforms||[]],directiveTransforms:{bind:qe.transformBind,on:qe.transformOn,model:lue,show:cue,cloak:qe.noopDirectiveTransform,once:qe.noopDirectiveTransform,memo:qe.noopDirectiveTransform,...e.directiveTransforms||{}}}),oue(t,e),qe.generate(t,e)}Sk.compile=due;/**
* @vue/server-renderer v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/Object.defineProperty(hi,"__esModule",{value:!0});var Pi=Mce,br=Zt,fue=Sk;function pue(r){var e=Object.create(null);if(r)for(var t in r)e[t]=r[t];return e.default=r,Object.freeze(e)}var gue=pue(Pi);const mue=br.makeMap(",key,ref,innerHTML,textContent,ref_key,ref_for");function Bk(r,e){let t="";for(const n in r){if(mue(n)||br.isOn(n)||e==="textarea"&&n==="value")continue;const i=r[n];n==="class"?t+=` class="${kk(i)}"`:n==="style"?t+=` style="${Ok(i)}"`:n==="className"?t+=` class="${String(i)}"`:t+=Mk(n,i,e)}return t}function Mk(r,e,t){if(!br.isRenderableAttrValue(e))return"";const n=t&&(t.indexOf("-")>0||br.isSVGTag(t))?r:br.propsToAttrMap[r]||r.toLowerCase();return br.isBooleanAttr(n)?br.includeBooleanAttr(e)?` ${n}`:"":br.isSSRSafeAttrName(n)?e===""?` ${n}`:` ${n}="${br.escapeHtml(e)}"`:(console.warn(`[@vue/server-renderer] Skipped rendering unsafe attribute name: ${n}`),"")}function Rk(r,e){return br.isRenderableAttrValue(e)?` ${r}="${br.escapeHtml(e)}"`:""}function kk(r){return br.escapeHtml(br.normalizeClass(r))}function Ok(r){if(!r)return"";if(br.isString(r))return br.escapeHtml(r);const e=br.normalizeStyle(yue(r));return br.escapeHtml(br.stringifyStyle(e))}function yue(r){if(!br.isArray(r)&&br.isObject(r)){const e={};for(const t in r)t.startsWith(":--")?e[t.slice(1)]=br.normalizeCssVarValue(r[t]):e[t]=r[t];return e}return r}function gH(r,e=null,t=null,n=null,i){return MS(Pi.createVNode(r,e,t),n,i)}const{ensureValidVNode:bue}=Pi.ssrUtils;function mH(r,e,t,n,i,s,a){i("<!--[-->"),Dk(r,e,t,n,i,s,a),i("<!--]-->")}function Dk(r,e,t,n,i,s,a,o){const u=r[e];if(u){const f=[],y=u(t,A=>{f.push(A)},s,a?" "+a:"");if(br.isArray(y)){const A=bue(y);A?RS(i,A,s,a):n?n():o&&i("<!---->")}else{let A=!0;if(o)A=!1;else for(let C=0;C<f.length;C++)if(!Aue(f[C])){A=!1;break}if(A)n&&n();else{let C=0,M=f.length;if(o&&f[0]==="<!--[-->"&&f[M-1]==="<!--]-->"&&(C++,M--),C<M)for(let k=C;k<M;k++)i(f[k]);else o&&i("<!---->")}}}else n?n():o&&i("<!---->")}const _ue=/^<!--[\s\S]*-->$/,vue=/<!--[^]*?-->/gm;function Aue(r){return typeof r!="string"||!_ue.test(r)?!1:r.length<=8?!0:!r.replace(vue,"").trim()}function Lk(r,e,t,n,i){r("<!--teleport start-->");const s=i.appContext.provides[Pi.ssrContextKey],a=s.__teleportBuffers||(s.__teleportBuffers={}),o=a[t]||(a[t]=[]),u=o.length;let f;if(n)e(r),f="<!--teleport start anchor--><!--teleport anchor-->";else{const{getBuffer:g,push:y}=CH();y("<!--teleport start anchor-->"),e(y),y("<!--teleport anchor-->"),f=g()}o.splice(u,0,f),r("<!--teleport end-->")}function yH(r){return br.escapeHtml(br.toDisplayString(r))}function bH(r,e){if(br.isArray(r)||br.isString(r))for(let t=0,n=r.length;t<n;t++)e(r[t],t);else if(typeof r=="number")for(let t=0;t<r;t++)e(t+1,t);else if(br.isObject(r))if(r[Symbol.iterator]){const t=Array.from(r);for(let n=0,i=t.length;n<i;n++)e(t[n],n)}else{const t=Object.keys(r);for(let n=0,i=t.length;n<i;n++){const s=t[n];e(r[s],s,n)}}}async function _H(r,{default:e}){e?e():r("<!---->")}function vH(r,e,t,n,i={}){return typeof e!="function"&&e.getSSRProps?e.getSSRProps({dir:e,instance:Pi.ssrUtils.getComponentPublicInstance(r.$),value:t,oldValue:void 0,arg:n,modifiers:i},null)||{}:{}}const AH=br.looseEqual;function BS(r,e){return br.looseIndexOf(r,e)>-1}function xH(r,e,t){switch(r){case"radio":return br.looseEqual(e,t)?" checked":"";case"checkbox":return(br.isArray(e)?BS(e,t):e)?" checked":"";default:return Rk("value",e)}}function wH(r={},e){const{type:t,value:n}=r;switch(t){case"radio":return br.looseEqual(e,n)?{checked:!0}:null;case"checkbox":return(br.isArray(e)?BS(e,n):e)?{checked:!0}:null;default:return{value:e}}}var xue=Object.freeze({__proto__:null,ssrGetDirectiveProps:vH,ssrGetDynamicModelProps:wH,ssrIncludeBooleanAttr:br.includeBooleanAttr,ssrInterpolate:yH,ssrLooseContain:BS,ssrLooseEqual:AH,ssrRenderAttr:Rk,ssrRenderAttrs:Bk,ssrRenderClass:kk,ssrRenderComponent:gH,ssrRenderDynamicAttr:Mk,ssrRenderDynamicModel:xH,ssrRenderList:bH,ssrRenderSlot:mH,ssrRenderSlotInner:Dk,ssrRenderStyle:Ok,ssrRenderSuspense:_H,ssrRenderTeleport:Lk,ssrRenderVNode:Qm});const $4=Object.create(null);function wue(r,e){const t=e.type,{isCustomElement:n,compilerOptions:i}=e.appContext.config,{delimiters:s,compilerOptions:a}=t,o=br.extend(br.extend({isCustomElement:n,delimiters:s},i),a);o.isCustomElement=o.isCustomElement||br.NO,o.isNativeTag=o.isNativeTag||br.NO;const u=JSON.stringify({template:r,compilerOptions:o},(C,M)=>br.isFunction(M)?M.toString():M),f=$4[u];if(f)return f;o.onError=C=>{throw C};const{code:g}=fue.compile(r,o),y={vue:gue,"vue/server-renderer":xue},A=C=>y[C];return $4[u]=Function("require",g)(A)}const{createComponentInstance:Cue,setCurrentRenderingInstance:j4,setupComponent:Tue,renderComponentRoot:G4,normalizeVNode:Sue,pushWarningContext:kit,popWarningContext:Oit}=Pi.ssrUtils;function CH(){let r=!1;const e=[];return{getBuffer(){return e},push(t){const n=br.isString(t);if(r&&n){e[e.length-1]+=t;return}e.push(t),r=n,(br.isPromise(t)||br.isArray(t)&&t.hasAsync)&&(e.hasAsync=!0)}}}function MS(r,e=null,t){const n=r.component=Cue(r,e,null),i=Tue(n,!0),s=br.isPromise(i);let a=n.sp;return s||a?Promise.resolve(i).then(()=>{if(s&&(a=n.sp),a)return Promise.all(a.map(u=>u.call(n.proxy)))}).catch(br.NOOP).then(()=>H4(n,t)):H4(n,t)}function H4(r,e){const t=r.type,{getBuffer:n,push:i}=CH();if(br.isFunction(t)){let s=G4(r);if(!t.props)for(const a in r.attrs)a.startsWith("data-v-")&&((s.props||(s.props={}))[a]="");Qm(i,r.subTree=s,r,e)}else{(!r.render||r.render===br.NOOP)&&!r.ssrRender&&!t.ssrRender&&br.isString(t.template)&&(t.ssrRender=wue(t.template,r));const s=r.ssrRender||t.ssrRender;if(s){let a=r.inheritAttrs!==!1?r.attrs:void 0,o=!1,u=r;for(;;){const g=u.vnode.scopeId;g&&(o||(a={...a},o=!0),a[g]="");const y=u.parent;if(y&&y.subTree&&y.subTree===u.vnode)u=y;else break}if(e){o||(a={...a});const g=e.trim().split(" ");for(let y=0;y<g.length;y++)a[g[y]]=""}const f=j4(r);try{s(r.proxy,i,r,a,r.props,r.setupState,r.data,r.ctx)}finally{j4(f)}}else if(r.render&&r.render!==br.NOOP)Qm(i,r.subTree=G4(r),r,e);else{const a=t.name||t.__file||"<Anonymous>";Pi.warn(`Component ${a} is missing template or render function.`),i("<!---->")}}return n()}function Qm(r,e,t,n){const{type:i,shapeFlag:s,children:a,dirs:o,props:u}=e;switch(o&&(e.props=Iue(e,u,o)),i){case Pi.Text:r(br.escapeHtml(a));break;case Pi.Comment:r(a?`<!--${br.escapeHtmlComment(a)}-->`:"<!---->");break;case Pi.Static:r(a);break;case Pi.Fragment:e.slotScopeIds&&(n=(n?n+" ":"")+e.slotScopeIds.join(" ")),r("<!--[-->"),RS(r,a,t,n),r("<!--]-->");break;default:s&1?Eue(r,e,t,n):s&6?r(MS(e,t,n)):s&64?Pue(r,e,t,n):s&128?Qm(r,e.ssContent,t,n):Pi.warn("[@vue/server-renderer] Invalid VNode type:",i,`(${typeof i})`)}}function RS(r,e,t,n){for(let i=0;i<e.length;i++)Qm(r,Sue(e[i]),t,n)}function Eue(r,e,t,n){const i=e.type;let{props:s,children:a,shapeFlag:o,scopeId:u}=e,f=`<${i}`;s&&(f+=Bk(s,i)),u&&(f+=` ${u}`);let g=t,y=e;for(;g&&y===g.subTree;)y=g.vnode,y.scopeId&&(f+=` ${y.scopeId}`),g=g.parent;if(n&&(f+=` ${n}`),r(f+">"),!br.isVoidTag(i)){let A=!1;s&&(s.innerHTML?(A=!0,r(s.innerHTML)):s.textContent?(A=!0,r(br.escapeHtml(s.textContent))):i==="textarea"&&s.value&&(A=!0,r(br.escapeHtml(s.value)))),A||(o&8?r(br.escapeHtml(a)):o&16&&RS(r,a,t,n)),r(`</${i}>`)}}function Iue(r,e,t){const n=[];for(let i=0;i<t.length;i++){const s=t[i],{dir:{getSSRProps:a}}=s;if(a){const o=a(s,r);o&&n.push(o)}}return Pi.mergeProps(e||{},...n)}function Pue(r,e,t,n){const i=e.props&&e.props.to,s=e.props&&e.props.disabled;if(!i)return s||Pi.warn("[@vue/server-renderer] Teleport is missing target prop."),[];if(!br.isString(i))return Pi.warn("[@vue/server-renderer] Teleport target must be a query selector string."),[];Lk(r,a=>{RS(a,e.children,t,n)},i,s||s==="",t)}const{isVNode:Bue}=Pi.ssrUtils;function yw(r,e,t){if(!r.hasAsync)return e+SH(r);let n=e;for(let i=t;i<r.length;i+=1){const s=r[i];if(br.isString(s)){n+=s;continue}if(br.isPromise(s))return s.then(o=>(r[i]=o,yw(r,n,i)));const a=yw(s,n,0);if(br.isPromise(a))return a.then(o=>(r[i]=o,yw(r,"",i)));n=a}return n}function TH(r){return yw(r,"",0)}function SH(r){let e="";for(let t=0;t<r.length;t++){let n=r[t];br.isString(n)?e+=n:e+=SH(n)}return e}async function EH(r,e={}){if(Bue(r))return EH(Pi.createApp({render:()=>r}),e);const t=Pi.createVNode(r._component,r._props);t.appContext=r._context,r.provide(Pi.ssrContextKey,e);const n=await MS(t),i=await TH(n);if(await IH(e),e.__watcherHandles)for(const s of e.__watcherHandles)s();return i}async function IH(r){if(r.__teleportBuffers){r.teleports=r.teleports||{};for(const e in r.__teleportBuffers)r.teleports[e]=await TH(await Promise.all([r.__teleportBuffers[e]]))}}const{isVNode:Mue}=Pi.ssrUtils;async function PH(r,e){if(r.hasAsync)for(let t=0;t<r.length;t++){let n=r[t];br.isPromise(n)&&(n=await n),br.isString(n)?e.push(n):await PH(n,e)}else BH(r,e)}function BH(r,e){for(let t=0;t<r.length;t++){let n=r[t];br.isString(n)?e.push(n):BH(n,e)}}function Sy(r,e,t){if(Mue(r))return Sy(Pi.createApp({render:()=>r}),e,t);const n=Pi.createVNode(r._component,r._props);return n.appContext=r._context,r.provide(Pi.ssrContextKey,e),Promise.resolve(MS(n)).then(i=>PH(i,t)).then(()=>IH(e)).then(()=>{if(e.__watcherHandles)for(const i of e.__watcherHandles)i()}).then(()=>t.push(null)).catch(i=>{t.destroy(i)}),t}function Rue(r,e={}){return console.warn("[@vue/server-renderer] renderToStream is deprecated - use renderToNodeStream instead."),MH(r,e)}function MH(r,e={}){const t=new zte.Readable({read(){}});if(!t)throw new Error("ESM build of renderToStream() does not support renderToNodeStream(). Use pipeToNodeWritable() with an existing Node.js Writable stream instance instead.");return Sy(r,e,t)}function kue(r,e={},t){Sy(r,e,{push(n){n!=null?t.write(n):t.end()},destroy(n){t.destroy(n)}})}function Oue(r,e={}){if(typeof ReadableStream!="function")throw new Error("ReadableStream constructor is not available in the global scope. If the target environment does support web streams, consider using pipeToWebWritable() with an existing WritableStream instance instead.");const t=new TextEncoder;let n=!1;return new ReadableStream({start(i){Sy(r,e,{push(s){n||(s!=null?i.enqueue(t.encode(s)):i.close())},destroy(s){i.error(s)}})},cancel(){n=!0}})}function Due(r,e={},t){const n=t.getWriter(),i=new TextEncoder;let s=!1;try{s=br.isPromise(n.ready)}catch{}Sy(r,e,{async push(a){return s&&await n.ready,a!=null?n.write(i.encode(a)):n.close()},destroy(a){console.log(a),n.close()}})}Pi.initDirectivesForSSR();hi.ssrIncludeBooleanAttr=br.includeBooleanAttr;hi.pipeToNodeWritable=kue;hi.pipeToWebWritable=Due;hi.renderToNodeStream=MH;hi.renderToSimpleStream=Sy;hi.renderToStream=Rue;var Lue=hi.renderToString=EH;hi.renderToWebStream=Oue;hi.ssrGetDirectiveProps=vH;hi.ssrGetDynamicModelProps=wH;var W4=hi.ssrInterpolate=yH;hi.ssrLooseContain=BS;hi.ssrLooseEqual=AH;hi.ssrRenderAttr=Rk;var Nue=hi.ssrRenderAttrs=Bk;hi.ssrRenderClass=kk;var Fo=hi.ssrRenderComponent=gH;hi.ssrRenderDynamicAttr=Mk;hi.ssrRenderDynamicModel=xH;hi.ssrRenderList=bH;hi.ssrRenderSlot=mH;hi.ssrRenderSlotInner=Dk;hi.ssrRenderStyle=Ok;hi.ssrRenderSuspense=_H;hi.ssrRenderTeleport=Lk;hi.ssrRenderVNode=Qm;var RH={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.15.0/LICENSE.txt
 */(function(r,e){(function(t,n){r.exports=n()})(Xw,function(){var t={},n={};function i(a,o,u){if(n[a]=u,a==="index"){var f="var sharedModule = {}; ("+n.shared+")(sharedModule); ("+n.worker+")(sharedModule);",g={};return n.shared(g),n.index(t,g),typeof window<"u"&&t.setWorkerUrl(window.URL.createObjectURL(new Blob([f],{type:"text/javascript"}))),t}}i("shared",["exports"],function(a){function o(d,l,h,m){return new(h||(h=Promise))(function(_,x){function w(O){try{B(m.next(O))}catch(N){x(N)}}function E(O){try{B(m.throw(O))}catch(N){x(N)}}function B(O){var N;O.done?_(O.value):(N=O.value,N instanceof h?N:new h(function(U){U(N)})).then(w,E)}B((m=m.apply(d,l||[])).next())})}function u(d,l){this.x=d,this.y=l}function f(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var g,y;typeof SuppressedError=="function"&&SuppressedError,u.prototype={clone(){return new u(this.x,this.y)},add(d){return this.clone()._add(d)},sub(d){return this.clone()._sub(d)},multByPoint(d){return this.clone()._multByPoint(d)},divByPoint(d){return this.clone()._divByPoint(d)},mult(d){return this.clone()._mult(d)},div(d){return this.clone()._div(d)},rotate(d){return this.clone()._rotate(d)},rotateAround(d,l){return this.clone()._rotateAround(d,l)},matMult(d){return this.clone()._matMult(d)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(d){return this.x===d.x&&this.y===d.y},dist(d){return Math.sqrt(this.distSqr(d))},distSqr(d){const l=d.x-this.x,h=d.y-this.y;return l*l+h*h},angle(){return Math.atan2(this.y,this.x)},angleTo(d){return Math.atan2(this.y-d.y,this.x-d.x)},angleWith(d){return this.angleWithSep(d.x,d.y)},angleWithSep(d,l){return Math.atan2(this.x*l-this.y*d,this.x*d+this.y*l)},_matMult(d){const l=d[2]*this.x+d[3]*this.y;return this.x=d[0]*this.x+d[1]*this.y,this.y=l,this},_add(d){return this.x+=d.x,this.y+=d.y,this},_sub(d){return this.x-=d.x,this.y-=d.y,this},_mult(d){return this.x*=d,this.y*=d,this},_div(d){return this.x/=d,this.y/=d,this},_multByPoint(d){return this.x*=d.x,this.y*=d.y,this},_divByPoint(d){return this.x/=d.x,this.y/=d.y,this},_unit(){return this._div(this.mag()),this},_perp(){const d=this.y;return this.y=this.x,this.x=-d,this},_rotate(d){const l=Math.cos(d),h=Math.sin(d),m=h*this.x+l*this.y;return this.x=l*this.x-h*this.y,this.y=m,this},_rotateAround(d,l){const h=Math.cos(d),m=Math.sin(d),_=l.y+m*(this.x-l.x)+h*(this.y-l.y);return this.x=l.x+h*(this.x-l.x)-m*(this.y-l.y),this.y=_,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:u},u.convert=function(d){if(d instanceof u)return d;if(Array.isArray(d))return new u(+d[0],+d[1]);if(d.x!==void 0&&d.y!==void 0)return new u(+d.x,+d.y);throw new Error("Expected [x, y] or {x, y} point format")};var A=function(){if(y)return g;function d(l,h,m,_){this.cx=3*l,this.bx=3*(m-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(_-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=h,this.p2x=m,this.p2y=_}return y=1,g=d,d.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,h){if(h===void 0&&(h=1e-6),l<0)return 0;if(l>1)return 1;for(var m=l,_=0;_<8;_++){var x=this.sampleCurveX(m)-l;if(Math.abs(x)<h)return m;var w=this.sampleCurveDerivativeX(m);if(Math.abs(w)<1e-6)break;m-=x/w}var E=0,B=1;for(m=l,_=0;_<20&&(x=this.sampleCurveX(m),!(Math.abs(x-l)<h));_++)l>x?E=m:B=m,m=.5*(B-E)+E;return m},solve:function(l,h){return this.sampleCurveY(this.solveCurveX(l,h))}},g}(),C=f(A);let M,k;function D(){return M==null&&(M=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),M}function V(){if(k==null&&(k=!1,D())){const l=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(l){for(let m=0;m<5*5;m++){const _=4*m;l.fillStyle=`rgb(${_},${_+1},${_+2})`,l.fillRect(m%5,Math.floor(m/5),1,1)}const h=l.getImageData(0,0,5,5).data;for(let m=0;m<5*5*4;m++)if(m%4!=3&&h[m]!==m){k=!0;break}}}return k||!1}var W=1e-6,z=typeof Float32Array<"u"?Float32Array:Array;function $(){var d=new z(9);return z!=Float32Array&&(d[1]=0,d[2]=0,d[3]=0,d[5]=0,d[6]=0,d[7]=0),d[0]=1,d[4]=1,d[8]=1,d}function te(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=1,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=1,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d}function le(){var d=new z(3);return z!=Float32Array&&(d[0]=0,d[1]=0,d[2]=0),d}function _e(d){var l=d[0],h=d[1],m=d[2];return Math.sqrt(l*l+h*h+m*m)}function se(d,l,h){var m=new z(3);return m[0]=d,m[1]=l,m[2]=h,m}function Y(d,l,h){return d[0]=l[0]+h[0],d[1]=l[1]+h[1],d[2]=l[2]+h[2],d}function ce(d,l,h){return d[0]=l[0]*h,d[1]=l[1]*h,d[2]=l[2]*h,d}function oe(d,l,h){var m=l[0],_=l[1],x=l[2],w=h[0],E=h[1],B=h[2];return d[0]=_*B-x*E,d[1]=x*w-m*B,d[2]=m*E-_*w,d}var Me,ze=_e;function Ve(d,l,h){var m=l[0],_=l[1],x=l[2],w=l[3];return d[0]=h[0]*m+h[4]*_+h[8]*x+h[12]*w,d[1]=h[1]*m+h[5]*_+h[9]*x+h[13]*w,d[2]=h[2]*m+h[6]*_+h[10]*x+h[14]*w,d[3]=h[3]*m+h[7]*_+h[11]*x+h[15]*w,d}function lt(){var d=new z(4);return z!=Float32Array&&(d[0]=0,d[1]=0,d[2]=0),d[3]=1,d}function gt(d,l,h,m){var _=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",x=Math.PI/360;l*=x,m*=x,h*=x;var w=Math.sin(l),E=Math.cos(l),B=Math.sin(h),O=Math.cos(h),N=Math.sin(m),U=Math.cos(m);switch(_){case"xyz":d[0]=w*O*U+E*B*N,d[1]=E*B*U-w*O*N,d[2]=E*O*N+w*B*U,d[3]=E*O*U-w*B*N;break;case"xzy":d[0]=w*O*U-E*B*N,d[1]=E*B*U-w*O*N,d[2]=E*O*N+w*B*U,d[3]=E*O*U+w*B*N;break;case"yxz":d[0]=w*O*U+E*B*N,d[1]=E*B*U-w*O*N,d[2]=E*O*N-w*B*U,d[3]=E*O*U+w*B*N;break;case"yzx":d[0]=w*O*U+E*B*N,d[1]=E*B*U+w*O*N,d[2]=E*O*N-w*B*U,d[3]=E*O*U-w*B*N;break;case"zxy":d[0]=w*O*U-E*B*N,d[1]=E*B*U+w*O*N,d[2]=E*O*N+w*B*U,d[3]=E*O*U-w*B*N;break;case"zyx":d[0]=w*O*U-E*B*N,d[1]=E*B*U+w*O*N,d[2]=E*O*N-w*B*U,d[3]=E*O*U+w*B*N;break;default:throw new Error("Unknown angle order "+_)}return d}function At(){var d=new z(2);return z!=Float32Array&&(d[0]=0,d[1]=0),d}function Tt(d,l){var h=new z(2);return h[0]=d,h[1]=l,h}le(),Me=new z(4),z!=Float32Array&&(Me[0]=0,Me[1]=0,Me[2]=0,Me[3]=0),le(),se(1,0,0),se(0,1,0),lt(),lt(),$(),At();const Ut=8192;function xr(d,l,h){return l*(Ut/(d.tileSize*Math.pow(2,h-d.tileID.overscaledZ)))}function Er(d,l){return(d%l+l)%l}function Jr(d,l,h){return d*(1-h)+l*h}function Xn(d){if(d<=0)return 0;if(d>=1)return 1;const l=d*d,h=l*d;return 4*(d<.5?h:3*(d-l)+h-.75)}function mi(d,l,h,m){const _=new C(d,l,h,m);return x=>_.solve(x)}const Pn=mi(.25,.1,.25,1);function Bn(d,l,h){return Math.min(h,Math.max(l,d))}function Jn(d,l,h){const m=h-l,_=((d-l)%m+m)%m+l;return _===l?h:_}function Mn(d,...l){for(const h of l)for(const m in h)d[m]=h[m];return d}let _t=1;function kt(d,l,h){const m={};for(const _ in d)m[_]=l.call(this,d[_],_,d);return m}function nr(d,l,h){const m={};for(const _ in d)l.call(this,d[_],_,d)&&(m[_]=d[_]);return m}function fr(d){return Array.isArray(d)?d.map(fr):typeof d=="object"&&d?kt(d,fr):d}const ve={};function Ee(d){ve[d]||(typeof console<"u"&&console.warn(d),ve[d]=!0)}function He(d,l,h){return(h.y-d.y)*(l.x-d.x)>(l.y-d.y)*(h.x-d.x)}function wt(d){return typeof WorkerGlobalScope<"u"&&d!==void 0&&d instanceof WorkerGlobalScope}let Qe=null;function mt(d){return typeof ImageBitmap<"u"&&d instanceof ImageBitmap}const $t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Dt(d,l,h,m,_){return o(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const x=new VideoFrame(d,{timestamp:0});try{const w=x?.format;if(!w||!w.startsWith("BGR")&&!w.startsWith("RGB"))throw new Error(`Unrecognized format ${w}`);const E=w.startsWith("BGR"),B=new Uint8ClampedArray(m*_*4);if(yield x.copyTo(B,function(O,N,U,G,K){const q=4*Math.max(-N,0),Z=(Math.max(0,U)-U)*G*4+q,ee=4*G,ue=Math.max(0,N),xe=Math.max(0,U);return{rect:{x:ue,y:xe,width:Math.min(O.width,N+G)-ue,height:Math.min(O.height,U+K)-xe},layout:[{offset:Z,stride:ee}]}}(d,l,h,m,_)),E)for(let O=0;O<B.length;O+=4){const N=B[O];B[O]=B[O+2],B[O+2]=N}return B}finally{x.close()}})}let Nt,It;function mr(d,l,h,m){return d.addEventListener(l,h,m),{unsubscribe:()=>{d.removeEventListener(l,h,m)}}}function Qt(d){return d*Math.PI/180}function cr(d){return d/Math.PI*180}const Fe={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},re={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},ne="AbortError";class he extends Error{constructor(l=ne){super(l instanceof Error?l.message:l),this.name=ne,l instanceof Error&&l.stack&&(this.stack=l.stack)}}function Be(d){return d.name===ne}const ke={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Ke(d){return ke.REGISTERED_PROTOCOLS[d.substring(0,d.indexOf("://"))]}const Ge="global-dispatcher";class Ue extends Error{constructor(l,h,m,_){super(`AJAXError: ${h} (${l}): ${m}`),this.status=l,this.statusText=h,this.url=m,this.body=_}}const nt=()=>wt(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,vt=function(d,l){if(/:\/\//.test(d.url)&&!/^https?:|^file:/.test(d.url)){const m=Ke(d.url);if(m)return m(d,l);if(wt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:d,targetMapId:Ge},l)}if(!(/^file:/.test(h=d.url)||/^file:/.test(nt())&&!/^\w+:/.test(h))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(m,_){return o(this,void 0,void 0,function*(){const x=new Request(m.url,{method:m.method||"GET",body:m.body,credentials:m.credentials,headers:m.headers,cache:m.cache,referrer:nt(),signal:_.signal});let w,E;m.type!=="json"||x.headers.has("Accept")||x.headers.set("Accept","application/json");try{w=yield fetch(x)}catch(O){throw Be(O)?O:new Ue(0,O.message,m.url,new Blob)}if(!w.ok){const O=yield w.blob();throw new Ue(w.status,w.statusText,m.url,O)}E=m.type==="arrayBuffer"||m.type==="image"?w.arrayBuffer():m.type==="json"?w.json():w.text();const B=yield E;return _.signal.throwIfAborted(),{data:B,cacheControl:w.headers.get("Cache-Control"),expires:w.headers.get("Expires")}})}(d,l);if(wt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:d,mustQueue:!0,targetMapId:Ge},l)}var h;return function(m,_){return new Promise((x,w)=>{var E;const B=new XMLHttpRequest;B.open(m.method||"GET",m.url,!0),m.type!=="arrayBuffer"&&m.type!=="image"||(B.responseType="arraybuffer");for(const O in m.headers)B.setRequestHeader(O,m.headers[O]);m.type==="json"&&(B.responseType="text",!((E=m.headers)===null||E===void 0)&&E.Accept||B.setRequestHeader("Accept","application/json")),B.withCredentials=m.credentials==="include",B.onerror=()=>{w(new Error(B.statusText))},B.onload=()=>{if(!_.signal.aborted)if((B.status>=200&&B.status<300||B.status===0)&&B.response!==null){let O=B.response;if(m.type==="json")try{O=JSON.parse(B.response)}catch(N){return void w(N)}x({data:O,cacheControl:B.getResponseHeader("Cache-Control"),expires:B.getResponseHeader("Expires")})}else{const O=new Blob([B.response],{type:B.getResponseHeader("Content-Type")});w(new Ue(B.status,B.statusText,m.url,O))}},_.signal.addEventListener("abort",()=>{B.abort(),w(new he(_.signal.reason))}),B.send(m.body)})}(d,l)};function pt(d){if(!d||d.indexOf("://")<=0||d.indexOf("data:image/")===0||d.indexOf("blob:")===0)return!0;const l=new URL(d),h=window.location;return l.protocol===h.protocol&&l.host===h.host}function Wt(d,l,h){h[d]&&h[d].indexOf(l)!==-1||(h[d]=h[d]||[],h[d].push(l))}function ar(d,l,h){if(h&&h[d]){const m=h[d].indexOf(l);m!==-1&&h[d].splice(m,1)}}class Br{constructor(l,h={}){Mn(this,h),this.type=l}}class Cn extends Br{constructor(l,h={}){super("error",Mn({error:l},h))}}class ln{on(l,h){return this._listeners=this._listeners||{},Wt(l,h,this._listeners),{unsubscribe:()=>{this.off(l,h)}}}off(l,h){return ar(l,h,this._listeners),ar(l,h,this._oneTimeListeners),this}once(l,h){return h?(this._oneTimeListeners=this._oneTimeListeners||{},Wt(l,h,this._oneTimeListeners),this):new Promise(m=>this.once(l,m))}fire(l,h){typeof l=="string"&&(l=new Br(l,h||{}));const m=l.type;if(this.listens(m)){l.target=this;const _=this._listeners&&this._listeners[m]?this._listeners[m].slice():[];for(const E of _)E.call(this,l);const x=this._oneTimeListeners&&this._oneTimeListeners[m]?this._oneTimeListeners[m].slice():[];for(const E of x)ar(m,E,this._oneTimeListeners),E.call(this,l);const w=this._eventedParent;w&&(Mn(l,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),w.fire(l))}else l instanceof Cn&&console.error(l.error);return this}listens(l){return this._listeners&&this._listeners[l]&&this._listeners[l].length>0||this._oneTimeListeners&&this._oneTimeListeners[l]&&this._oneTimeListeners[l].length>0||this._eventedParent&&this._eventedParent.listens(l)}setEventedParent(l,h){return this._eventedParent=l,this._eventedParentData=h,this}}var et={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number",length:2},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"filter"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},filter:{type:"boolean",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"expression_name",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}},interpolation:{type:"array",value:"interpolation_name",minimum:1},interpolation_name:{type:"enum",values:{linear:{syntax:{overloads:[{parameters:[],"output-type":"interpolation"}],parameters:[]}},exponential:{syntax:{overloads:[{parameters:["base"],"output-type":"interpolation"}],parameters:[{name:"base",type:"number literal"}]}},"cubic-bezier":{syntax:{overloads:[{parameters:["x1","y1","x2","y2"],"output-type":"interpolation"}],parameters:[{name:"x1",type:"number literal"},{name:"y1",type:"number literal"},{name:"x2",type:"number literal"},{name:"y2",type:"number literal"}]}}}}};const Tn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Xi(d,l){const h={};for(const m in d)m!=="ref"&&(h[m]=d[m]);return Tn.forEach(m=>{m in l&&(h[m]=l[m])}),h}function Ir(d,l){if(Array.isArray(d)){if(!Array.isArray(l)||d.length!==l.length)return!1;for(let h=0;h<d.length;h++)if(!Ir(d[h],l[h]))return!1;return!0}if(typeof d=="object"&&d!==null&&l!==null){if(typeof l!="object"||Object.keys(d).length!==Object.keys(l).length)return!1;for(const h in d)if(!Ir(d[h],l[h]))return!1;return!0}return d===l}function qr(d,l){d.push(l)}function Ji(d,l,h){qr(h,{command:"addSource",args:[d,l[d]]})}function Rn(d,l,h){qr(l,{command:"removeSource",args:[d]}),h[d]=!0}function nn(d,l,h,m){Rn(d,h,m),Ji(d,l,h)}function yn(d,l,h){let m;for(m in d[h])if(Object.prototype.hasOwnProperty.call(d[h],m)&&m!=="data"&&!Ir(d[h][m],l[h][m]))return!1;for(m in l[h])if(Object.prototype.hasOwnProperty.call(l[h],m)&&m!=="data"&&!Ir(d[h][m],l[h][m]))return!1;return!0}function ni(d,l,h,m,_,x){d=d||{},l=l||{};for(const w in d)Object.prototype.hasOwnProperty.call(d,w)&&(Ir(d[w],l[w])||h.push({command:x,args:[m,w,l[w],_]}));for(const w in l)Object.prototype.hasOwnProperty.call(l,w)&&!Object.prototype.hasOwnProperty.call(d,w)&&(Ir(d[w],l[w])||h.push({command:x,args:[m,w,l[w],_]}))}function xl(d){return d.id}function oc(d,l){return d[l.id]=l,d}class Rt{constructor(l,h,m,_){this.message=(l?`${l}: `:"")+m,_&&(this.identifier=_),h!=null&&h.__line__&&(this.line=h.__line__)}}function ns(d,...l){for(const h of l)for(const m in h)d[m]=h[m];return d}class is extends Error{constructor(l,h){super(h),this.message=h,this.key=l}}class ga{constructor(l,h=[]){this.parent=l,this.bindings={};for(const[m,_]of h)this.bindings[m]=_}concat(l){return new ga(this,l)}get(l){if(this.bindings[l])return this.bindings[l];if(this.parent)return this.parent.get(l);throw new Error(`${l} not found in scope.`)}has(l){return!!this.bindings[l]||!!this.parent&&this.parent.has(l)}}const Hs={kind:"null"},Kt={kind:"number"},Nr={kind:"string"},Dr={kind:"boolean"},Ws={kind:"color"},ih={kind:"projectionDefinition"},ma={kind:"object"},Lr={kind:"value"},Qc={kind:"collator"},eu={kind:"formatted"},tu={kind:"padding"},Ho={kind:"colorArray"},ac={kind:"numberArray"},wl={kind:"resolvedImage"},lc={kind:"variableAnchorOffsetCollection"};function ss(d,l){return{kind:"array",itemType:d,N:l}}function gn(d){if(d.kind==="array"){const l=gn(d.itemType);return typeof d.N=="number"?`array<${l}, ${d.N}>`:d.itemType.kind==="value"?"array":`array<${l}>`}return d.kind}const cc=[Hs,Kt,Nr,Dr,Ws,ih,eu,ma,ss(Lr),tu,ac,Ho,wl,lc];function Cl(d,l){if(l.kind==="error")return null;if(d.kind==="array"){if(l.kind==="array"&&(l.N===0&&l.itemType.kind==="value"||!Cl(d.itemType,l.itemType))&&(typeof d.N!="number"||d.N===l.N))return null}else{if(d.kind===l.kind)return null;if(d.kind==="value"){for(const h of cc)if(!Cl(h,l))return null}}return`Expected ${gn(d)} but found ${gn(l)} instead.`}function uc(d,l){return l.some(h=>h.kind===d.kind)}function qa(d,l){return l.some(h=>h==="null"?d===null:h==="array"?Array.isArray(d):h==="object"?d&&!Array.isArray(d)&&typeof d=="object":h===typeof d)}function ao(d,l){return d.kind==="array"&&l.kind==="array"?d.itemType.kind===l.itemType.kind&&typeof d.N=="number":d.kind===l.kind}const Pp=.96422,ie=.82521,de=4/29,Ie=6/29,je=3*Ie*Ie,yt=Ie*Ie*Ie,Pt=Math.PI/180,Ft=180/Math.PI;function yr(d){return(d%=360)<0&&(d+=360),d}function Mr([d,l,h,m]){let _,x;const w=sn((.2225045*(d=Fr(d))+.7168786*(l=Fr(l))+.0606169*(h=Fr(h)))/1);d===l&&l===h?_=x=w:(_=sn((.4360747*d+.3850649*l+.1430804*h)/Pp),x=sn((.0139322*d+.0971045*l+.7141733*h)/ie));const E=116*w-16;return[E<0?0:E,500*(_-w),200*(w-x),m]}function Fr(d){return d<=.04045?d/12.92:Math.pow((d+.055)/1.055,2.4)}function sn(d){return d>yt?Math.pow(d,1/3):d/je+de}function xi([d,l,h,m]){let _=(d+16)/116,x=isNaN(l)?_:_+l/500,w=isNaN(h)?_:_-h/200;return _=1*Ya(_),x=Pp*Ya(x),w=ie*Ya(w),[Fi(3.1338561*x-1.6168667*_-.4906146*w),Fi(-.9787684*x+1.9161415*_+.033454*w),Fi(.0719453*x-.2289914*_+1.4052427*w),m]}function Fi(d){return(d=d<=.00304?12.92*d:1.055*Math.pow(d,1/2.4)-.055)<0?0:d>1?1:d}function Ya(d){return d>Ie?d*d*d:je*(d-de)}const hc=Object.hasOwn||function(d,l){return Object.prototype.hasOwnProperty.call(d,l)};function ru(d,l){return hc(d,l)?d[l]:void 0}function sh(d){return parseInt(d.padEnd(2,d),16)/255}function Bd(d,l){return Tl(l?d/100:d,0,1)}function Tl(d,l,h){return Math.min(Math.max(l,d),h)}function oh(d){return!d.some(Number.isNaN)}const dc={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Za(d,l,h){return d+h*(l-d)}function fc(d,l,h){return d.map((m,_)=>Za(m,l[_],h))}class Ur{constructor(l,h,m,_=1,x=!0){this.r=l,this.g=h,this.b=m,this.a=_,x||(this.r*=_,this.g*=_,this.b*=_,_||this.overwriteGetter("rgb",[l,h,m,_]))}static parse(l){if(l instanceof Ur)return l;if(typeof l!="string")return;const h=function(m){if((m=m.toLowerCase().trim())==="transparent")return[0,0,0,0];const _=ru(dc,m);if(_){const[w,E,B]=_;return[w/255,E/255,B/255,1]}if(m.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(m)){const w=m.length<6?1:2;let E=1;return[sh(m.slice(E,E+=w)),sh(m.slice(E,E+=w)),sh(m.slice(E,E+=w)),sh(m.slice(E,E+w)||"ff")]}if(m.startsWith("rgb")){const w=m.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(w){const[E,B,O,N,U,G,K,q,Z,ee,ue,xe]=w,fe=[N||" ",K||" ",ee].join("");if(fe==="  "||fe==="  /"||fe===",,"||fe===",,,"){const pe=[O,G,Z].join(""),Te=pe==="%%%"?100:pe===""?255:0;if(Te){const Oe=[Tl(+B/Te,0,1),Tl(+U/Te,0,1),Tl(+q/Te,0,1),ue?Bd(+ue,xe):1];if(oh(Oe))return Oe}}return}}const x=m.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[w,E,B,O,N,U,G,K,q]=x,Z=[B||" ",N||" ",G].join("");if(Z==="  "||Z==="  /"||Z===",,"||Z===",,,"){const ee=[+E,Tl(+O,0,100),Tl(+U,0,100),K?Bd(+K,q):1];if(oh(ee))return function([ue,xe,fe,pe]){function Te(Oe){const Ze=(Oe+ue/30)%12,xt=xe*Math.min(fe,1-fe);return fe-xt*Math.max(-1,Math.min(Ze-3,9-Ze,1))}return ue=yr(ue),xe/=100,fe/=100,[Te(0),Te(8),Te(4),pe]}(ee)}}}(l);return h?new Ur(...h,!1):void 0}get rgb(){const{r:l,g:h,b:m,a:_}=this,x=_||1/0;return this.overwriteGetter("rgb",[l/x,h/x,m/x,_])}get hcl(){return this.overwriteGetter("hcl",function(l){const[h,m,_,x]=Mr(l),w=Math.sqrt(m*m+_*_);return[Math.round(1e4*w)?yr(Math.atan2(_,m)*Ft):NaN,w,h,x]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Mr(this.rgb))}overwriteGetter(l,h){return Object.defineProperty(this,l,{value:h}),h}toString(){const[l,h,m,_]=this.rgb;return`rgba(${[l,h,m].map(x=>Math.round(255*x)).join(",")},${_})`}static interpolate(l,h,m,_="rgb"){switch(_){case"rgb":{const[x,w,E,B]=fc(l.rgb,h.rgb,m);return new Ur(x,w,E,B,!1)}case"hcl":{const[x,w,E,B]=l.hcl,[O,N,U,G]=h.hcl;let K,q;if(isNaN(x)||isNaN(O))isNaN(x)?isNaN(O)?K=NaN:(K=O,E!==1&&E!==0||(q=N)):(K=x,U!==1&&U!==0||(q=w));else{let fe=O-x;O>x&&fe>180?fe-=360:O<x&&x-O>180&&(fe+=360),K=x+m*fe}const[Z,ee,ue,xe]=function([fe,pe,Te,Oe]){return fe=isNaN(fe)?0:fe*Pt,xi([Te,Math.cos(fe)*pe,Math.sin(fe)*pe,Oe])}([K,q??Za(w,N,m),Za(E,U,m),Za(B,G,m)]);return new Ur(Z,ee,ue,xe,!1)}case"lab":{const[x,w,E,B]=xi(fc(l.lab,h.lab,m));return new Ur(x,w,E,B,!1)}}}}Ur.black=new Ur(0,0,0,1),Ur.white=new Ur(1,1,1,1),Ur.transparent=new Ur(0,0,0,0),Ur.red=new Ur(1,0,0,1);class Md{constructor(l,h,m){this.sensitivity=l?h?"variant":"case":h?"accent":"base",this.locale=m,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(l,h){return this.collator.compare(l,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Rd=["bottom","center","top"];class ah{constructor(l,h,m,_,x,w){this.text=l,this.image=h,this.scale=m,this.fontStack=_,this.textColor=x,this.verticalAlign=w}}class Cs{constructor(l){this.sections=l}static fromString(l){return new Cs([new ah(l,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(l=>l.text.length!==0||l.image&&l.image.name.length!==0)}static factory(l){return l instanceof Cs?l:Cs.fromString(l)}toString(){return this.sections.length===0?"":this.sections.map(l=>l.text).join("")}}class pr{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof pr)return l;if(typeof l=="number")return new pr([l,l,l,l]);if(Array.isArray(l)&&!(l.length<1||l.length>4)){for(const h of l)if(typeof h!="number")return;switch(l.length){case 1:l=[l[0],l[0],l[0],l[0]];break;case 2:l=[l[0],l[1],l[0],l[1]];break;case 3:l=[l[0],l[1],l[2],l[1]]}return new pr(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,h,m){return new pr(fc(l.values,h.values,m))}}class Zr{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof Zr)return l;if(typeof l=="number")return new Zr([l]);if(Array.isArray(l)){for(const h of l)if(typeof h!="number")return;return new Zr(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,h,m){return new Zr(fc(l.values,h.values,m))}}class _r{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof _r)return l;if(typeof l=="string"){const m=Ur.parse(l);return m?new _r([m]):void 0}if(!Array.isArray(l))return;const h=[];for(const m of l){if(typeof m!="string")return;const _=Ur.parse(m);if(!_)return;h.push(_)}return new _r(h)}toString(){return JSON.stringify(this.values)}static interpolate(l,h,m,_="rgb"){const x=[];if(l.values.length!=h.values.length)throw new Error(`colorArray: Arrays have mismatched length (${l.values.length} vs. ${h.values.length}), cannot interpolate.`);for(let w=0;w<l.values.length;w++)x.push(Ur.interpolate(l.values[w],h.values[w],m,_));return new _r(x)}}class dn extends Error{constructor(l){super(l),this.name="RuntimeError"}toJSON(){return this.message}}const ya=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Ks{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof Ks)return l;if(Array.isArray(l)&&!(l.length<1)&&l.length%2==0){for(let h=0;h<l.length;h+=2){const m=l[h],_=l[h+1];if(typeof m!="string"||!ya.has(m)||!Array.isArray(_)||_.length!==2||typeof _[0]!="number"||typeof _[1]!="number")return}return new Ks(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,h,m){const _=l.values,x=h.values;if(_.length!==x.length)throw new dn(`Cannot interpolate values of different length. from: ${l.toString()}, to: ${h.toString()}`);const w=[];for(let E=0;E<_.length;E+=2){if(_[E]!==x[E])throw new dn(`Cannot interpolate values containing mismatched anchors. from[${E}]: ${_[E]}, to[${E}]: ${x[E]}`);w.push(_[E]);const[B,O]=_[E+1],[N,U]=x[E+1];w.push([Za(B,N,m),Za(O,U,m)])}return new Ks(w)}}class Io{constructor(l){this.name=l.name,this.available=l.available}toString(){return this.name}static fromString(l){return l?new Io({name:l,available:!1}):null}}class Xs{constructor(l,h,m){this.from=l,this.to=h,this.transition=m}static interpolate(l,h,m){return new Xs(l,h,m)}static parse(l){return l instanceof Xs?l:Array.isArray(l)&&l.length===3&&typeof l[0]=="string"&&typeof l[1]=="string"&&typeof l[2]=="number"?new Xs(l[0],l[1],l[2]):typeof l=="object"&&typeof l.from=="string"&&typeof l.to=="string"&&typeof l.transition=="number"?new Xs(l.from,l.to,l.transition):typeof l=="string"?new Xs(l,l,1):void 0}}function lh(d,l,h,m){return typeof d=="number"&&d>=0&&d<=255&&typeof l=="number"&&l>=0&&l<=255&&typeof h=="number"&&h>=0&&h<=255?m===void 0||typeof m=="number"&&m>=0&&m<=1?null:`Invalid rgba value [${[d,l,h,m].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof m=="number"?[d,l,h,m]:[d,l,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function pc(d){if(d===null||typeof d=="string"||typeof d=="boolean"||typeof d=="number"||d instanceof Xs||d instanceof Ur||d instanceof Md||d instanceof Cs||d instanceof pr||d instanceof Zr||d instanceof _r||d instanceof Ks||d instanceof Io)return!0;if(Array.isArray(d)){for(const l of d)if(!pc(l))return!1;return!0}if(typeof d=="object"){for(const l in d)if(!pc(d[l]))return!1;return!0}return!1}function wi(d){if(d===null)return Hs;if(typeof d=="string")return Nr;if(typeof d=="boolean")return Dr;if(typeof d=="number")return Kt;if(d instanceof Ur)return Ws;if(d instanceof Xs)return ih;if(d instanceof Md)return Qc;if(d instanceof Cs)return eu;if(d instanceof pr)return tu;if(d instanceof Zr)return ac;if(d instanceof _r)return Ho;if(d instanceof Ks)return lc;if(d instanceof Io)return wl;if(Array.isArray(d)){const l=d.length;let h;for(const m of d){const _=wi(m);if(h){if(h===_)continue;h=Lr;break}h=_}return ss(h||Lr,l)}return ma}function nu(d){const l=typeof d;return d===null?"":l==="string"||l==="number"||l==="boolean"?String(d):d instanceof Ur||d instanceof Xs||d instanceof Cs||d instanceof pr||d instanceof Zr||d instanceof _r||d instanceof Ks||d instanceof Io?d.toString():JSON.stringify(d)}class Qa{constructor(l,h){this.type=l,this.value=h}static parse(l,h){if(l.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${l.length-1} instead.`);if(!pc(l[1]))return h.error("invalid value");const m=l[1];let _=wi(m);const x=h.expectedType;return _.kind!=="array"||_.N!==0||!x||x.kind!=="array"||typeof x.N=="number"&&x.N!==0||(_=x),new Qa(_,m)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Bp={string:Nr,number:Kt,boolean:Dr,object:ma};class lo{constructor(l,h){this.type=l,this.args=h}static parse(l,h){if(l.length<2)return h.error("Expected at least one argument.");let m,_=1;const x=l[0];if(x==="array"){let E,B;if(l.length>2){const O=l[1];if(typeof O!="string"||!(O in Bp)||O==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);E=Bp[O],_++}else E=Lr;if(l.length>3){if(l[2]!==null&&(typeof l[2]!="number"||l[2]<0||l[2]!==Math.floor(l[2])))return h.error('The length argument to "array" must be a positive integer literal',2);B=l[2],_++}m=ss(E,B)}else{if(!Bp[x])throw new Error(`Types doesn't contain name = ${x}`);m=Bp[x]}const w=[];for(;_<l.length;_++){const E=h.parse(l[_],_,Lr);if(!E)return null;w.push(E)}return new lo(m,w)}evaluate(l){for(let h=0;h<this.args.length;h++){const m=this.args[h].evaluate(l);if(!Cl(this.type,wi(m)))return m;if(h===this.args.length-1)throw new dn(`Expected value to be of type ${gn(this.type)}, but found ${gn(wi(m))} instead.`)}throw new Error}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}const iu={"to-boolean":Dr,"to-color":Ws,"to-number":Kt,"to-string":Nr};class Sl{constructor(l,h){this.type=l,this.args=h}static parse(l,h){if(l.length<2)return h.error("Expected at least one argument.");const m=l[0];if(!iu[m])throw new Error(`Can't parse ${m} as it is not part of the known types`);if((m==="to-boolean"||m==="to-string")&&l.length!==2)return h.error("Expected one argument.");const _=iu[m],x=[];for(let w=1;w<l.length;w++){const E=h.parse(l[w],w,Lr);if(!E)return null;x.push(E)}return new Sl(_,x)}evaluate(l){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(l);case"color":{let h,m;for(const _ of this.args){if(h=_.evaluate(l),m=null,h instanceof Ur)return h;if(typeof h=="string"){const x=l.parseColor(h);if(x)return x}else if(Array.isArray(h)&&(m=h.length<3||h.length>4?`Invalid rgba value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:lh(h[0],h[1],h[2],h[3]),!m))return new Ur(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new dn(m||`Could not parse color from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"padding":{let h;for(const m of this.args){h=m.evaluate(l);const _=pr.parse(h);if(_)return _}throw new dn(`Could not parse padding from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"numberArray":{let h;for(const m of this.args){h=m.evaluate(l);const _=Zr.parse(h);if(_)return _}throw new dn(`Could not parse numberArray from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"colorArray":{let h;for(const m of this.args){h=m.evaluate(l);const _=_r.parse(h);if(_)return _}throw new dn(`Could not parse colorArray from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"variableAnchorOffsetCollection":{let h;for(const m of this.args){h=m.evaluate(l);const _=Ks.parse(h);if(_)return _}throw new dn(`Could not parse variableAnchorOffsetCollection from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"number":{let h=null;for(const m of this.args){if(h=m.evaluate(l),h===null)return 0;const _=Number(h);if(!isNaN(_))return _}throw new dn(`Could not convert ${JSON.stringify(h)} to number.`)}case"formatted":return Cs.fromString(nu(this.args[0].evaluate(l)));case"resolvedImage":return Io.fromString(nu(this.args[0].evaluate(l)));case"projectionDefinition":return this.args[0].evaluate(l);default:return nu(this.args[0].evaluate(l))}}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}const cA=["Unknown","Point","LineString","Polygon"];class Ly{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?cA[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(l){let h=this._parseColorCache.get(l);return h||(h=Ur.parse(l),this._parseColorCache.set(l,h)),h}}class su{constructor(l,h,m=[],_,x=new ga,w=[]){this.registry=l,this.path=m,this.key=m.map(E=>`[${E}]`).join(""),this.scope=x,this.errors=w,this.expectedType=_,this._isConstant=h}parse(l,h,m,_,x={}){return h?this.concat(h,m,_)._parse(l,x):this._parse(l,x)}_parse(l,h){function m(_,x,w){return w==="assert"?new lo(x,[_]):w==="coerce"?new Sl(x,[_]):_}if(l!==null&&typeof l!="string"&&typeof l!="boolean"&&typeof l!="number"||(l=["literal",l]),Array.isArray(l)){if(l.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const _=l[0];if(typeof _!="string")return this.error(`Expression name must be a string, but found ${typeof _} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const x=this.registry[_];if(x){let w=x.parse(l,this);if(!w)return null;if(this.expectedType){const E=this.expectedType,B=w.type;if(E.kind!=="string"&&E.kind!=="number"&&E.kind!=="boolean"&&E.kind!=="object"&&E.kind!=="array"||B.kind!=="value"){if(E.kind==="projectionDefinition"&&["string","array"].includes(B.kind)||["color","formatted","resolvedImage"].includes(E.kind)&&["value","string"].includes(B.kind)||["padding","numberArray"].includes(E.kind)&&["value","number","array"].includes(B.kind)||E.kind==="colorArray"&&["value","string","array"].includes(B.kind)||E.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(B.kind))w=m(w,E,h.typeAnnotation||"coerce");else if(this.checkSubtype(E,B))return null}else w=m(w,E,h.typeAnnotation||"assert")}if(!(w instanceof Qa)&&w.type.kind!=="resolvedImage"&&this._isConstant(w)){const E=new Ly;try{w=new Qa(w.type,w.evaluate(E))}catch(B){return this.error(B.message),null}}return w}return this.error(`Unknown expression "${_}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(l===void 0?"'undefined' value invalid. Use null instead.":typeof l=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof l} instead.`)}concat(l,h,m){const _=typeof l=="number"?this.path.concat(l):this.path,x=m?this.scope.concat(m):this.scope;return new su(this.registry,this._isConstant,_,h||null,x,this.errors)}error(l,...h){const m=`${this.key}${h.map(_=>`[${_}]`).join("")}`;this.errors.push(new is(m,l))}checkSubtype(l,h){const m=Cl(l,h);return m&&this.error(m),m}}class Un{constructor(l,h){this.type=h.type,this.bindings=[].concat(l),this.result=h}evaluate(l){return this.result.evaluate(l)}eachChild(l){for(const h of this.bindings)l(h[1]);l(this.result)}static parse(l,h){if(l.length<4)return h.error(`Expected at least 3 arguments, but found ${l.length-1} instead.`);const m=[];for(let x=1;x<l.length-1;x+=2){const w=l[x];if(typeof w!="string")return h.error(`Expected string, but found ${typeof w} instead.`,x);if(/[^a-zA-Z0-9_]/.test(w))return h.error("Variable names must contain only alphanumeric characters or '_'.",x);const E=h.parse(l[x+1],x+1);if(!E)return null;m.push([w,E])}const _=h.parse(l[l.length-1],l.length-1,h.expectedType,m);return _?new Un(m,_):null}outputDefined(){return this.result.outputDefined()}}class ch{constructor(l,h){this.type=h.type,this.name=l,this.boundExpression=h}static parse(l,h){if(l.length!==2||typeof l[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");const m=l[1];return h.scope.has(m)?new ch(m,h.scope.get(m)):h.error(`Unknown variable "${m}". Make sure "${m}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(l){return this.boundExpression.evaluate(l)}eachChild(){}outputDefined(){return!1}}class en{constructor(l,h,m){this.type=l,this.index=h,this.input=m}static parse(l,h){if(l.length!==3)return h.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const m=h.parse(l[1],1,Kt),_=h.parse(l[2],2,ss(h.expectedType||Lr));return m&&_?new en(_.type.itemType,m,_):null}evaluate(l){const h=this.index.evaluate(l),m=this.input.evaluate(l);if(h<0)throw new dn(`Array index out of bounds: ${h} < 0.`);if(h>=m.length)throw new dn(`Array index out of bounds: ${h} > ${m.length-1}.`);if(h!==Math.floor(h))throw new dn(`Array index must be an integer, but found ${h} instead.`);return m[h]}eachChild(l){l(this.index),l(this.input)}outputDefined(){return!1}}class zr{constructor(l,h){this.type=Dr,this.needle=l,this.haystack=h}static parse(l,h){if(l.length!==3)return h.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const m=h.parse(l[1],1,Lr),_=h.parse(l[2],2,Lr);return m&&_?uc(m.type,[Dr,Nr,Kt,Hs,Lr])?new zr(m,_):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${gn(m.type)} instead`):null}evaluate(l){const h=this.needle.evaluate(l),m=this.haystack.evaluate(l);if(!m)return!1;if(!qa(h,["boolean","string","number","null"]))throw new dn(`Expected first argument to be of type boolean, string, number or null, but found ${gn(wi(h))} instead.`);if(!qa(m,["string","array"]))throw new dn(`Expected second argument to be of type array or string, but found ${gn(wi(m))} instead.`);return m.indexOf(h)>=0}eachChild(l){l(this.needle),l(this.haystack)}outputDefined(){return!0}}class uh{constructor(l,h,m){this.type=Kt,this.needle=l,this.haystack=h,this.fromIndex=m}static parse(l,h){if(l.length<=2||l.length>=5)return h.error(`Expected 2 or 3 arguments, but found ${l.length-1} instead.`);const m=h.parse(l[1],1,Lr),_=h.parse(l[2],2,Lr);if(!m||!_)return null;if(!uc(m.type,[Dr,Nr,Kt,Hs,Lr]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${gn(m.type)} instead`);if(l.length===4){const x=h.parse(l[3],3,Kt);return x?new uh(m,_,x):null}return new uh(m,_)}evaluate(l){const h=this.needle.evaluate(l),m=this.haystack.evaluate(l);if(!qa(h,["boolean","string","number","null"]))throw new dn(`Expected first argument to be of type boolean, string, number or null, but found ${gn(wi(h))} instead.`);let _;if(this.fromIndex&&(_=this.fromIndex.evaluate(l)),qa(m,["string"])){const x=m.indexOf(h,_);return x===-1?-1:[...m.slice(0,x)].length}if(qa(m,["array"]))return m.indexOf(h,_);throw new dn(`Expected second argument to be of type array or string, but found ${gn(wi(m))} instead.`)}eachChild(l){l(this.needle),l(this.haystack),this.fromIndex&&l(this.fromIndex)}outputDefined(){return!1}}class on{constructor(l,h,m,_,x,w){this.inputType=l,this.type=h,this.input=m,this.cases=_,this.outputs=x,this.otherwise=w}static parse(l,h){if(l.length<5)return h.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if(l.length%2!=1)return h.error("Expected an even number of arguments.");let m,_;h.expectedType&&h.expectedType.kind!=="value"&&(_=h.expectedType);const x={},w=[];for(let O=2;O<l.length-1;O+=2){let N=l[O];const U=l[O+1];Array.isArray(N)||(N=[N]);const G=h.concat(O);if(N.length===0)return G.error("Expected at least one branch label.");for(const q of N){if(typeof q!="number"&&typeof q!="string")return G.error("Branch labels must be numbers or strings.");if(typeof q=="number"&&Math.abs(q)>Number.MAX_SAFE_INTEGER)return G.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof q=="number"&&Math.floor(q)!==q)return G.error("Numeric branch labels must be integer values.");if(m){if(G.checkSubtype(m,wi(q)))return null}else m=wi(q);if(x[String(q)]!==void 0)return G.error("Branch labels must be unique.");x[String(q)]=w.length}const K=h.parse(U,O,_);if(!K)return null;_=_||K.type,w.push(K)}const E=h.parse(l[1],1,Lr);if(!E)return null;const B=h.parse(l[l.length-1],l.length-1,_);return B?E.type.kind!=="value"&&h.concat(1).checkSubtype(m,E.type)?null:new on(m,_,E,x,w,B):null}evaluate(l){const h=this.input.evaluate(l);return(wi(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(l)}eachChild(l){l(this.input),this.outputs.forEach(l),l(this.otherwise)}outputDefined(){return this.outputs.every(l=>l.outputDefined())&&this.otherwise.outputDefined()}}class kd{constructor(l,h,m){this.type=l,this.branches=h,this.otherwise=m}static parse(l,h){if(l.length<4)return h.error(`Expected at least 3 arguments, but found only ${l.length-1}.`);if(l.length%2!=0)return h.error("Expected an odd number of arguments.");let m;h.expectedType&&h.expectedType.kind!=="value"&&(m=h.expectedType);const _=[];for(let w=1;w<l.length-1;w+=2){const E=h.parse(l[w],w,Dr);if(!E)return null;const B=h.parse(l[w+1],w+1,m);if(!B)return null;_.push([E,B]),m=m||B.type}const x=h.parse(l[l.length-1],l.length-1,m);if(!x)return null;if(!m)throw new Error("Can't infer output type");return new kd(m,_,x)}evaluate(l){for(const[h,m]of this.branches)if(h.evaluate(l))return m.evaluate(l);return this.otherwise.evaluate(l)}eachChild(l){for(const[h,m]of this.branches)l(h),l(m);l(this.otherwise)}outputDefined(){return this.branches.every(([l,h])=>h.outputDefined())&&this.otherwise.outputDefined()}}class Wo{constructor(l,h,m,_){this.type=l,this.input=h,this.beginIndex=m,this.endIndex=_}static parse(l,h){if(l.length<=2||l.length>=5)return h.error(`Expected 2 or 3 arguments, but found ${l.length-1} instead.`);const m=h.parse(l[1],1,Lr),_=h.parse(l[2],2,Kt);if(!m||!_)return null;if(!uc(m.type,[ss(Lr),Nr,Lr]))return h.error(`Expected first argument to be of type array or string, but found ${gn(m.type)} instead`);if(l.length===4){const x=h.parse(l[3],3,Kt);return x?new Wo(m.type,m,_,x):null}return new Wo(m.type,m,_)}evaluate(l){const h=this.input.evaluate(l),m=this.beginIndex.evaluate(l);let _;if(this.endIndex&&(_=this.endIndex.evaluate(l)),qa(h,["string"]))return[...h].slice(m,_).join("");if(qa(h,["array"]))return h.slice(m,_);throw new dn(`Expected first argument to be of type array or string, but found ${gn(wi(h))} instead.`)}eachChild(l){l(this.input),l(this.beginIndex),this.endIndex&&l(this.endIndex)}outputDefined(){return!1}}function hh(d,l){const h=d.length-1;let m,_,x=0,w=h,E=0;for(;x<=w;)if(E=Math.floor((x+w)/2),m=d[E],_=d[E+1],m<=l){if(E===h||l<_)return E;x=E+1}else{if(!(m>l))throw new dn("Input is not a number.");w=E-1}return 0}class gc{constructor(l,h,m){this.type=l,this.input=h,this.labels=[],this.outputs=[];for(const[_,x]of m)this.labels.push(_),this.outputs.push(x)}static parse(l,h){if(l.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return h.error("Expected an even number of arguments.");const m=h.parse(l[1],1,Kt);if(!m)return null;const _=[];let x=null;h.expectedType&&h.expectedType.kind!=="value"&&(x=h.expectedType);for(let w=1;w<l.length;w+=2){const E=w===1?-1/0:l[w],B=l[w+1],O=w,N=w+1;if(typeof E!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(_.length&&_[_.length-1][0]>=E)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',O);const U=h.parse(B,N,x);if(!U)return null;x=x||U.type,_.push([E,U])}return new gc(x,m,_)}evaluate(l){const h=this.labels,m=this.outputs;if(h.length===1)return m[0].evaluate(l);const _=this.input.evaluate(l);if(_<=h[0])return m[0].evaluate(l);const x=h.length;return _>=h[x-1]?m[x-1].evaluate(l):m[hh(h,_)].evaluate(l)}eachChild(l){l(this.input);for(const h of this.outputs)l(h)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}}function uA(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var Od,Ny,v2=function(){if(Ny)return Od;function d(l,h,m,_){this.cx=3*l,this.bx=3*(m-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(_-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=h,this.p2x=m,this.p2y=_}return Ny=1,Od=d,d.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,h){if(h===void 0&&(h=1e-6),l<0)return 0;if(l>1)return 1;for(var m=l,_=0;_<8;_++){var x=this.sampleCurveX(m)-l;if(Math.abs(x)<h)return m;var w=this.sampleCurveDerivativeX(m);if(Math.abs(w)<1e-6)break;m-=x/w}var E=0,B=1;for(m=l,_=0;_<20&&(x=this.sampleCurveX(m),!(Math.abs(x-l)<h));_++)l>x?E=m:B=m,m=.5*(B-E)+E;return m},solve:function(l,h){return this.sampleCurveY(this.solveCurveX(l,h))}},Od}(),hA=uA(v2);class Js{constructor(l,h,m,_,x){this.type=l,this.operator=h,this.interpolation=m,this.input=_,this.labels=[],this.outputs=[];for(const[w,E]of x)this.labels.push(w),this.outputs.push(E)}static interpolationFactor(l,h,m,_){let x=0;if(l.name==="exponential")x=el(h,l.base,m,_);else if(l.name==="linear")x=el(h,1,m,_);else if(l.name==="cubic-bezier"){const w=l.controlPoints;x=new hA(w[0],w[1],w[2],w[3]).solve(el(h,1,m,_))}return x}static parse(l,h){let[m,_,x,...w]=l;if(!Array.isArray(_)||_.length===0)return h.error("Expected an interpolation type expression.",1);if(_[0]==="linear")_={name:"linear"};else if(_[0]==="exponential"){const O=_[1];if(typeof O!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);_={name:"exponential",base:O}}else{if(_[0]!=="cubic-bezier")return h.error(`Unknown interpolation type ${String(_[0])}`,1,0);{const O=_.slice(1);if(O.length!==4||O.some(N=>typeof N!="number"||N<0||N>1))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);_={name:"cubic-bezier",controlPoints:O}}}if(l.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return h.error("Expected an even number of arguments.");if(x=h.parse(x,2,Kt),!x)return null;const E=[];let B=null;m!=="interpolate-hcl"&&m!=="interpolate-lab"||h.expectedType==Ho?h.expectedType&&h.expectedType.kind!=="value"&&(B=h.expectedType):B=Ws;for(let O=0;O<w.length;O+=2){const N=w[O],U=w[O+1],G=O+3,K=O+4;if(typeof N!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',G);if(E.length&&E[E.length-1][0]>=N)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',G);const q=h.parse(U,K,B);if(!q)return null;B=B||q.type,E.push([N,q])}return ao(B,Kt)||ao(B,ih)||ao(B,Ws)||ao(B,tu)||ao(B,ac)||ao(B,Ho)||ao(B,lc)||ao(B,ss(Kt))?new Js(B,m,_,x,E):h.error(`Type ${gn(B)} is not interpolatable.`)}evaluate(l){const h=this.labels,m=this.outputs;if(h.length===1)return m[0].evaluate(l);const _=this.input.evaluate(l);if(_<=h[0])return m[0].evaluate(l);const x=h.length;if(_>=h[x-1])return m[x-1].evaluate(l);const w=hh(h,_),E=Js.interpolationFactor(this.interpolation,_,h[w],h[w+1]),B=m[w].evaluate(l),O=m[w+1].evaluate(l);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Za(B,O,E);case"color":return Ur.interpolate(B,O,E);case"padding":return pr.interpolate(B,O,E);case"colorArray":return _r.interpolate(B,O,E);case"numberArray":return Zr.interpolate(B,O,E);case"variableAnchorOffsetCollection":return Ks.interpolate(B,O,E);case"array":return fc(B,O,E);case"projectionDefinition":return Xs.interpolate(B,O,E)}case"interpolate-hcl":switch(this.type.kind){case"color":return Ur.interpolate(B,O,E,"hcl");case"colorArray":return _r.interpolate(B,O,E,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Ur.interpolate(B,O,E,"lab");case"colorArray":return _r.interpolate(B,O,E,"lab")}}}eachChild(l){l(this.input);for(const h of this.outputs)l(h)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}}function el(d,l,h,m){const _=m-h,x=d-h;return _===0?0:l===1?x/_:(Math.pow(l,x)-1)/(Math.pow(l,_)-1)}const ii={color:Ur.interpolate,number:Za,padding:pr.interpolate,numberArray:Zr.interpolate,colorArray:_r.interpolate,variableAnchorOffsetCollection:Ks.interpolate,array:fc};class ou{constructor(l,h){this.type=l,this.args=h}static parse(l,h){if(l.length<2)return h.error("Expected at least one argument.");let m=null;const _=h.expectedType;_&&_.kind!=="value"&&(m=_);const x=[];for(const E of l.slice(1)){const B=h.parse(E,1+x.length,m,void 0,{typeAnnotation:"omit"});if(!B)return null;m=m||B.type,x.push(B)}if(!m)throw new Error("No output type");const w=_&&x.some(E=>Cl(_,E.type));return new ou(w?Lr:m,x)}evaluate(l){let h,m=null,_=0;for(const x of this.args)if(_++,m=x.evaluate(l),m&&m instanceof Io&&!m.available&&(h||(h=m.name),m=null,_===this.args.length&&(m=h)),m!==null)break;return m}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}function Fy(d,l){return d==="=="||d==="!="?l.kind==="boolean"||l.kind==="string"||l.kind==="number"||l.kind==="null"||l.kind==="value":l.kind==="string"||l.kind==="number"||l.kind==="value"}function Dd(d,l,h,m){return m.compare(l,h)===0}function yi(d,l,h){const m=d!=="=="&&d!=="!=";return class kH{constructor(x,w,E){this.type=Dr,this.lhs=x,this.rhs=w,this.collator=E,this.hasUntypedArgument=x.type.kind==="value"||w.type.kind==="value"}static parse(x,w){if(x.length!==3&&x.length!==4)return w.error("Expected two or three arguments.");const E=x[0];let B=w.parse(x[1],1,Lr);if(!B)return null;if(!Fy(E,B.type))return w.concat(1).error(`"${E}" comparisons are not supported for type '${gn(B.type)}'.`);let O=w.parse(x[2],2,Lr);if(!O)return null;if(!Fy(E,O.type))return w.concat(2).error(`"${E}" comparisons are not supported for type '${gn(O.type)}'.`);if(B.type.kind!==O.type.kind&&B.type.kind!=="value"&&O.type.kind!=="value")return w.error(`Cannot compare types '${gn(B.type)}' and '${gn(O.type)}'.`);m&&(B.type.kind==="value"&&O.type.kind!=="value"?B=new lo(O.type,[B]):B.type.kind!=="value"&&O.type.kind==="value"&&(O=new lo(B.type,[O])));let N=null;if(x.length===4){if(B.type.kind!=="string"&&O.type.kind!=="string"&&B.type.kind!=="value"&&O.type.kind!=="value")return w.error("Cannot use collator to compare non-string types.");if(N=w.parse(x[3],3,Qc),!N)return null}return new kH(B,O,N)}evaluate(x){const w=this.lhs.evaluate(x),E=this.rhs.evaluate(x);if(m&&this.hasUntypedArgument){const B=wi(w),O=wi(E);if(B.kind!==O.kind||B.kind!=="string"&&B.kind!=="number")throw new dn(`Expected arguments for "${d}" to be (string, string) or (number, number), but found (${B.kind}, ${O.kind}) instead.`)}if(this.collator&&!m&&this.hasUntypedArgument){const B=wi(w),O=wi(E);if(B.kind!=="string"||O.kind!=="string")return l(x,w,E)}return this.collator?h(x,w,E,this.collator.evaluate(x)):l(x,w,E)}eachChild(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)}outputDefined(){return!0}}}const dA=yi("==",function(d,l,h){return l===h},Dd),Uy=yi("!=",function(d,l,h){return l!==h},function(d,l,h,m){return!Dd(0,l,h,m)}),fA=yi("<",function(d,l,h){return l<h},function(d,l,h,m){return m.compare(l,h)<0}),A2=yi(">",function(d,l,h){return l>h},function(d,l,h,m){return m.compare(l,h)>0}),dh=yi("<=",function(d,l,h){return l<=h},function(d,l,h,m){return m.compare(l,h)<=0}),Mp=yi(">=",function(d,l,h){return l>=h},function(d,l,h,m){return m.compare(l,h)>=0});class fh{constructor(l,h,m){this.type=Qc,this.locale=m,this.caseSensitive=l,this.diacriticSensitive=h}static parse(l,h){if(l.length!==2)return h.error("Expected one argument.");const m=l[1];if(typeof m!="object"||Array.isArray(m))return h.error("Collator options argument must be an object.");const _=h.parse(m["case-sensitive"]!==void 0&&m["case-sensitive"],1,Dr);if(!_)return null;const x=h.parse(m["diacritic-sensitive"]!==void 0&&m["diacritic-sensitive"],1,Dr);if(!x)return null;let w=null;return m.locale&&(w=h.parse(m.locale,1,Nr),!w)?null:new fh(_,x,w)}evaluate(l){return new Md(this.caseSensitive.evaluate(l),this.diacriticSensitive.evaluate(l),this.locale?this.locale.evaluate(l):null)}eachChild(l){l(this.caseSensitive),l(this.diacriticSensitive),this.locale&&l(this.locale)}outputDefined(){return!1}}class zy{constructor(l,h,m,_,x){this.type=Nr,this.number=l,this.locale=h,this.currency=m,this.minFractionDigits=_,this.maxFractionDigits=x}static parse(l,h){if(l.length!==3)return h.error("Expected two arguments.");const m=h.parse(l[1],1,Kt);if(!m)return null;const _=l[2];if(typeof _!="object"||Array.isArray(_))return h.error("NumberFormat options argument must be an object.");let x=null;if(_.locale&&(x=h.parse(_.locale,1,Nr),!x))return null;let w=null;if(_.currency&&(w=h.parse(_.currency,1,Nr),!w))return null;let E=null;if(_["min-fraction-digits"]&&(E=h.parse(_["min-fraction-digits"],1,Kt),!E))return null;let B=null;return _["max-fraction-digits"]&&(B=h.parse(_["max-fraction-digits"],1,Kt),!B)?null:new zy(m,x,w,E,B)}evaluate(l){return new Intl.NumberFormat(this.locale?this.locale.evaluate(l):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(l):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(l):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(l):void 0}).format(this.number.evaluate(l))}eachChild(l){l(this.number),this.locale&&l(this.locale),this.currency&&l(this.currency),this.minFractionDigits&&l(this.minFractionDigits),this.maxFractionDigits&&l(this.maxFractionDigits)}outputDefined(){return!1}}class Ld{constructor(l){this.type=eu,this.sections=l}static parse(l,h){if(l.length<2)return h.error("Expected at least one argument.");const m=l[1];if(!Array.isArray(m)&&typeof m=="object")return h.error("First argument must be an image or text section.");const _=[];let x=!1;for(let w=1;w<=l.length-1;++w){const E=l[w];if(x&&typeof E=="object"&&!Array.isArray(E)){x=!1;let B=null;if(E["font-scale"]&&(B=h.parse(E["font-scale"],1,Kt),!B))return null;let O=null;if(E["text-font"]&&(O=h.parse(E["text-font"],1,ss(Nr)),!O))return null;let N=null;if(E["text-color"]&&(N=h.parse(E["text-color"],1,Ws),!N))return null;let U=null;if(E["vertical-align"]){if(typeof E["vertical-align"]=="string"&&!Rd.includes(E["vertical-align"]))return h.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${E["vertical-align"]}' instead.`);if(U=h.parse(E["vertical-align"],1,Nr),!U)return null}const G=_[_.length-1];G.scale=B,G.font=O,G.textColor=N,G.verticalAlign=U}else{const B=h.parse(l[w],1,Lr);if(!B)return null;const O=B.type.kind;if(O!=="string"&&O!=="value"&&O!=="null"&&O!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");x=!0,_.push({content:B,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Ld(_)}evaluate(l){return new Cs(this.sections.map(h=>{const m=h.content.evaluate(l);return wi(m)===wl?new ah("",m,null,null,null,h.verticalAlign?h.verticalAlign.evaluate(l):null):new ah(nu(m),null,h.scale?h.scale.evaluate(l):null,h.font?h.font.evaluate(l).join(","):null,h.textColor?h.textColor.evaluate(l):null,h.verticalAlign?h.verticalAlign.evaluate(l):null)}))}eachChild(l){for(const h of this.sections)l(h.content),h.scale&&l(h.scale),h.font&&l(h.font),h.textColor&&l(h.textColor),h.verticalAlign&&l(h.verticalAlign)}outputDefined(){return!1}}class ph{constructor(l){this.type=wl,this.input=l}static parse(l,h){if(l.length!==2)return h.error("Expected two arguments.");const m=h.parse(l[1],1,Nr);return m?new ph(m):h.error("No image name provided.")}evaluate(l){const h=this.input.evaluate(l),m=Io.fromString(h);return m&&l.availableImages&&(m.available=l.availableImages.indexOf(h)>-1),m}eachChild(l){l(this.input)}outputDefined(){return!1}}class gh{constructor(l){this.type=Kt,this.input=l}static parse(l,h){if(l.length!==2)return h.error(`Expected 1 argument, but found ${l.length-1} instead.`);const m=h.parse(l[1],1);return m?m.type.kind!=="array"&&m.type.kind!=="string"&&m.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${gn(m.type)} instead.`):new gh(m):null}evaluate(l){const h=this.input.evaluate(l);if(typeof h=="string")return[...h].length;if(Array.isArray(h))return h.length;throw new dn(`Expected value to be of type string or array, but found ${gn(wi(h))} instead.`)}eachChild(l){l(this.input)}outputDefined(){return!1}}const Ui=8192;function pA(d,l){const h=(180+d[0])/360,m=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d[1]*Math.PI/360)))/360,_=Math.pow(2,l.z);return[Math.round(h*_*Ui),Math.round(m*_*Ui)]}function mh(d,l){const h=Math.pow(2,l.z);return[(_=(d[0]/Ui+l.x)/h,360*_-180),(m=(d[1]/Ui+l.y)/h,360/Math.PI*Math.atan(Math.exp((180-360*m)*Math.PI/180))-90)];var m,_}function Nd(d,l){d[0]=Math.min(d[0],l[0]),d[1]=Math.min(d[1],l[1]),d[2]=Math.max(d[2],l[0]),d[3]=Math.max(d[3],l[1])}function au(d,l){return!(d[0]<=l[0]||d[2]>=l[2]||d[1]<=l[1]||d[3]>=l[3])}function x2(d,l,h){const m=d[0]-l[0],_=d[1]-l[1],x=d[0]-h[0],w=d[1]-h[1];return m*w-x*_==0&&m*x<=0&&_*w<=0}function Rp(d,l,h,m){return(_=[m[0]-h[0],m[1]-h[1]])[0]*(x=[l[0]-d[0],l[1]-d[1]])[1]-_[1]*x[0]!=0&&!(!Vy(d,l,h,m)||!Vy(h,m,d,l));var _,x}function w2(d,l,h){for(const m of h)for(let _=0;_<m.length-1;++_)if(Rp(d,l,m[_],m[_+1]))return!0;return!1}function yh(d,l,h=!1){let m=!1;for(const E of l)for(let B=0;B<E.length-1;B++){if(x2(d,E[B],E[B+1]))return h;(x=E[B])[1]>(_=d)[1]!=(w=E[B+1])[1]>_[1]&&_[0]<(w[0]-x[0])*(_[1]-x[1])/(w[1]-x[1])+x[0]&&(m=!m)}var _,x,w;return m}function kp(d,l){for(const h of l)if(yh(d,h))return!0;return!1}function gA(d,l){for(const h of d)if(!yh(h,l))return!1;for(let h=0;h<d.length-1;++h)if(w2(d[h],d[h+1],l))return!1;return!0}function mA(d,l){for(const h of l)if(gA(d,h))return!0;return!1}function Vy(d,l,h,m){const _=m[0]-h[0],x=m[1]-h[1],w=(d[0]-h[0])*x-_*(d[1]-h[1]),E=(l[0]-h[0])*x-_*(l[1]-h[1]);return w>0&&E<0||w<0&&E>0}function $y(d,l,h){const m=[];for(let _=0;_<d.length;_++){const x=[];for(let w=0;w<d[_].length;w++){const E=pA(d[_][w],h);Nd(l,E),x.push(E)}m.push(x)}return m}function jy(d,l,h){const m=[];for(let _=0;_<d.length;_++){const x=$y(d[_],l,h);m.push(x)}return m}function yA(d,l,h,m){if(d[0]<h[0]||d[0]>h[2]){const _=.5*m;let x=d[0]-h[0]>_?-m:h[0]-d[0]>_?m:0;x===0&&(x=d[0]-h[2]>_?-m:h[2]-d[0]>_?m:0),d[0]+=x}Nd(l,d)}function bA(d,l,h,m){const _=Math.pow(2,m.z)*Ui,x=[m.x*Ui,m.y*Ui],w=[];for(const E of d)for(const B of E){const O=[B.x+x[0],B.y+x[1]];yA(O,l,h,_),w.push(O)}return w}function _A(d,l,h,m){const _=Math.pow(2,m.z)*Ui,x=[m.x*Ui,m.y*Ui],w=[];for(const B of d){const O=[];for(const N of B){const U=[N.x+x[0],N.y+x[1]];Nd(l,U),O.push(U)}w.push(O)}if(l[2]-l[0]<=_/2){(E=l)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const B of w)for(const O of B)yA(O,l,h,_)}var E;return w}class lu{constructor(l,h){this.type=Dr,this.geojson=l,this.geometries=h}static parse(l,h){if(l.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${l.length-1} instead.`);if(pc(l[1])){const m=l[1];if(m.type==="FeatureCollection"){const _=[];for(const x of m.features){const{type:w,coordinates:E}=x.geometry;w==="Polygon"&&_.push(E),w==="MultiPolygon"&&_.push(...E)}if(_.length)return new lu(m,{type:"MultiPolygon",coordinates:_})}else if(m.type==="Feature"){const _=m.geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new lu(m,m.geometry)}else if(m.type==="Polygon"||m.type==="MultiPolygon")return new lu(m,m)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return function(h,m){const _=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],w=h.canonicalID();if(m.type==="Polygon"){const E=$y(m.coordinates,x,w),B=bA(h.geometry(),_,x,w);if(!au(_,x))return!1;for(const O of B)if(!yh(O,E))return!1}if(m.type==="MultiPolygon"){const E=jy(m.coordinates,x,w),B=bA(h.geometry(),_,x,w);if(!au(_,x))return!1;for(const O of B)if(!kp(O,E))return!1}return!0}(l,this.geometries);if(l.geometryType()==="LineString")return function(h,m){const _=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],w=h.canonicalID();if(m.type==="Polygon"){const E=$y(m.coordinates,x,w),B=_A(h.geometry(),_,x,w);if(!au(_,x))return!1;for(const O of B)if(!gA(O,E))return!1}if(m.type==="MultiPolygon"){const E=jy(m.coordinates,x,w),B=_A(h.geometry(),_,x,w);if(!au(_,x))return!1;for(const O of B)if(!mA(O,E))return!1}return!0}(l,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let vA=class{constructor(d=[],l=(h,m)=>h<m?-1:h>m?1:0){if(this.data=d,this.length=this.data.length,this.compare=l,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(d){this.data.push(d),this._up(this.length++)}pop(){if(this.length===0)return;const d=this.data[0],l=this.data.pop();return--this.length>0&&(this.data[0]=l,this._down(0)),d}peek(){return this.data[0]}_up(d){const{data:l,compare:h}=this,m=l[d];for(;d>0;){const _=d-1>>1,x=l[_];if(h(m,x)>=0)break;l[d]=x,d=_}l[d]=m}_down(d){const{data:l,compare:h}=this,m=this.length>>1,_=l[d];for(;d<m;){let x=1+(d<<1);const w=x+1;if(w<this.length&&h(l[w],l[x])<0&&(x=w),h(l[x],_)>=0)break;l[d]=l[x],d=x}l[d]=_}};function Gy(d,l,h=0,m=d.length-1,_=AA){for(;m>h;){if(m-h>600){const B=m-h+1,O=l-h+1,N=Math.log(B),U=.5*Math.exp(2*N/3),G=.5*Math.sqrt(N*U*(B-U)/B)*(O-B/2<0?-1:1);Gy(d,l,Math.max(h,Math.floor(l-O*U/B+G)),Math.min(m,Math.floor(l+(B-O)*U/B+G)),_)}const x=d[l];let w=h,E=m;for(bh(d,h,l),_(d[m],x)>0&&bh(d,h,m);w<E;){for(bh(d,w,E),w++,E--;_(d[w],x)<0;)w++;for(;_(d[E],x)>0;)E--}_(d[h],x)===0?bh(d,h,E):(E++,bh(d,E,m)),E<=l&&(h=E+1),l<=E&&(m=E-1)}}function bh(d,l,h){const m=d[l];d[l]=d[h],d[h]=m}function AA(d,l){return d<l?-1:d>l?1:0}function Op(d,l){if(d.length<=1)return[d];const h=[];let m,_;for(const x of d){const w=T2(x);w!==0&&(x.area=Math.abs(w),_===void 0&&(_=w<0),_===w<0?(m&&h.push(m),m=[x]):m.push(x))}if(m&&h.push(m),l>1)for(let x=0;x<h.length;x++)h[x].length<=l||(Gy(h[x],l,1,h[x].length-1,C2),h[x]=h[x].slice(0,l));return h}function C2(d,l){return l.area-d.area}function T2(d){let l=0;for(let h,m,_=0,x=d.length,w=x-1;_<x;w=_++)h=d[_],m=d[w],l+=(m.x-h.x)*(h.y+m.y);return l}const xA=1/298.257223563,Fd=xA*(2-xA),wA=Math.PI/180;class Hy{constructor(l){const h=6378.137*wA*1e3,m=Math.cos(l*wA),_=1/(1-Fd*(1-m*m)),x=Math.sqrt(_);this.kx=h*x*m,this.ky=h*x*_*(1-Fd)}distance(l,h){const m=this.wrap(l[0]-h[0])*this.kx,_=(l[1]-h[1])*this.ky;return Math.sqrt(m*m+_*_)}pointOnLine(l,h){let m,_,x,w,E=1/0;for(let B=0;B<l.length-1;B++){let O=l[B][0],N=l[B][1],U=this.wrap(l[B+1][0]-O)*this.kx,G=(l[B+1][1]-N)*this.ky,K=0;U===0&&G===0||(K=(this.wrap(h[0]-O)*this.kx*U+(h[1]-N)*this.ky*G)/(U*U+G*G),K>1?(O=l[B+1][0],N=l[B+1][1]):K>0&&(O+=U/this.kx*K,N+=G/this.ky*K)),U=this.wrap(h[0]-O)*this.kx,G=(h[1]-N)*this.ky;const q=U*U+G*G;q<E&&(E=q,m=O,_=N,x=B,w=K)}return{point:[m,_],index:x,t:Math.max(0,Math.min(1,w))}}wrap(l){for(;l<-180;)l+=360;for(;l>180;)l-=360;return l}}function CA(d,l){return l[0]-d[0]}function Dp(d){return d[1]-d[0]+1}function ba(d,l){return d[1]>=d[0]&&d[1]<l}function Lp(d,l){if(d[0]>d[1])return[null,null];const h=Dp(d);if(l){if(h===2)return[d,null];const _=Math.floor(h/2);return[[d[0],d[0]+_],[d[0]+_,d[1]]]}if(h===1)return[d,null];const m=Math.floor(h/2)-1;return[[d[0],d[0]+m],[d[0]+m+1,d[1]]]}function Wy(d,l){if(!ba(l,d.length))return[1/0,1/0,-1/0,-1/0];const h=[1/0,1/0,-1/0,-1/0];for(let m=l[0];m<=l[1];++m)Nd(h,d[m]);return h}function Ky(d){const l=[1/0,1/0,-1/0,-1/0];for(const h of d)for(const m of h)Nd(l,m);return l}function Xy(d){return d[0]!==-1/0&&d[1]!==-1/0&&d[2]!==1/0&&d[3]!==1/0}function Np(d,l,h){if(!Xy(d)||!Xy(l))return NaN;let m=0,_=0;return d[2]<l[0]&&(m=l[0]-d[2]),d[0]>l[2]&&(m=d[0]-l[2]),d[1]>l[3]&&(_=d[1]-l[3]),d[3]<l[1]&&(_=l[1]-d[3]),h.distance([0,0],[m,_])}function cu(d,l,h){const m=h.pointOnLine(l,d);return h.distance(d,m.point)}function Jy(d,l,h,m,_){const x=Math.min(cu(d,[h,m],_),cu(l,[h,m],_)),w=Math.min(cu(h,[d,l],_),cu(m,[d,l],_));return Math.min(x,w)}function S2(d,l,h,m,_){if(!ba(l,d.length)||!ba(m,h.length))return 1/0;let x=1/0;for(let w=l[0];w<l[1];++w){const E=d[w],B=d[w+1];for(let O=m[0];O<m[1];++O){const N=h[O],U=h[O+1];if(Rp(E,B,N,U))return 0;x=Math.min(x,Jy(E,B,N,U,_))}}return x}function TA(d,l,h,m,_){if(!ba(l,d.length)||!ba(m,h.length))return NaN;let x=1/0;for(let w=l[0];w<=l[1];++w)for(let E=m[0];E<=m[1];++E)if(x=Math.min(x,_.distance(d[w],h[E])),x===0)return x;return x}function E2(d,l,h){if(yh(d,l,!0))return 0;let m=1/0;for(const _ of l){const x=_[0],w=_[_.length-1];if(x!==w&&(m=Math.min(m,cu(d,[w,x],h)),m===0))return m;const E=h.pointOnLine(_,d);if(m=Math.min(m,h.distance(d,E.point)),m===0)return m}return m}function I2(d,l,h,m){if(!ba(l,d.length))return NaN;for(let x=l[0];x<=l[1];++x)if(yh(d[x],h,!0))return 0;let _=1/0;for(let x=l[0];x<l[1];++x){const w=d[x],E=d[x+1];for(const B of h)for(let O=0,N=B.length,U=N-1;O<N;U=O++){const G=B[U],K=B[O];if(Rp(w,E,G,K))return 0;_=Math.min(_,Jy(w,E,G,K,m))}}return _}function SA(d,l){for(const h of d)for(const m of h)if(yh(m,l,!0))return!0;return!1}function P2(d,l,h,m=1/0){const _=Ky(d),x=Ky(l);if(m!==1/0&&Np(_,x,h)>=m)return m;if(au(_,x)){if(SA(d,l))return 0}else if(SA(l,d))return 0;let w=1/0;for(const E of d)for(let B=0,O=E.length,N=O-1;B<O;N=B++){const U=E[N],G=E[B];for(const K of l)for(let q=0,Z=K.length,ee=Z-1;q<Z;ee=q++){const ue=K[ee],xe=K[q];if(Rp(U,G,ue,xe))return 0;w=Math.min(w,Jy(U,G,ue,xe,h))}}return w}function fn(d,l,h,m,_,x){if(!x)return;const w=Np(Wy(m,x),_,h);w<l&&d.push([w,x,[0,0]])}function Fp(d,l,h,m,_,x,w){if(!x||!w)return;const E=Np(Wy(m,x),Wy(_,w),h);E<l&&d.push([E,x,w])}function Up(d,l,h,m,_=1/0){let x=Math.min(m.distance(d[0],h[0][0]),_);if(x===0)return x;const w=new vA([[0,[0,d.length-1],[0,0]]],CA),E=Ky(h);for(;w.length>0;){const B=w.pop();if(B[0]>=x)continue;const O=B[1],N=l?50:100;if(Dp(O)<=N){if(!ba(O,d.length))return NaN;if(l){const U=I2(d,O,h,m);if(isNaN(U)||U===0)return U;x=Math.min(x,U)}else for(let U=O[0];U<=O[1];++U){const G=E2(d[U],h,m);if(x=Math.min(x,G),x===0)return 0}}else{const U=Lp(O,l);fn(w,x,m,d,E,U[0]),fn(w,x,m,d,E,U[1])}}return x}function zp(d,l,h,m,_,x=1/0){let w=Math.min(x,_.distance(d[0],h[0]));if(w===0)return w;const E=new vA([[0,[0,d.length-1],[0,h.length-1]]],CA);for(;E.length>0;){const B=E.pop();if(B[0]>=w)continue;const O=B[1],N=B[2],U=l?50:100,G=m?50:100;if(Dp(O)<=U&&Dp(N)<=G){if(!ba(O,d.length)&&ba(N,h.length))return NaN;let K;if(l&&m)K=S2(d,O,h,N,_),w=Math.min(w,K);else if(l&&!m){const q=d.slice(O[0],O[1]+1);for(let Z=N[0];Z<=N[1];++Z)if(K=cu(h[Z],q,_),w=Math.min(w,K),w===0)return w}else if(!l&&m){const q=h.slice(N[0],N[1]+1);for(let Z=O[0];Z<=O[1];++Z)if(K=cu(d[Z],q,_),w=Math.min(w,K),w===0)return w}else K=TA(d,O,h,N,_),w=Math.min(w,K)}else{const K=Lp(O,l),q=Lp(N,m);Fp(E,w,_,d,h,K[0],q[0]),Fp(E,w,_,d,h,K[0],q[1]),Fp(E,w,_,d,h,K[1],q[0]),Fp(E,w,_,d,h,K[1],q[1])}}return w}function qy(d){return d.type==="MultiPolygon"?d.coordinates.map(l=>({type:"Polygon",coordinates:l})):d.type==="MultiLineString"?d.coordinates.map(l=>({type:"LineString",coordinates:l})):d.type==="MultiPoint"?d.coordinates.map(l=>({type:"Point",coordinates:l})):[d]}class uu{constructor(l,h){this.type=Kt,this.geojson=l,this.geometries=h}static parse(l,h){if(l.length!==2)return h.error(`'distance' expression requires exactly one argument, but found ${l.length-1} instead.`);if(pc(l[1])){const m=l[1];if(m.type==="FeatureCollection")return new uu(m,m.features.map(_=>qy(_.geometry)).flat());if(m.type==="Feature")return new uu(m,qy(m.geometry));if("type"in m&&"coordinates"in m)return new uu(m,qy(m))}return h.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return function(h,m){const _=h.geometry(),x=_.flat().map(B=>mh([B.x,B.y],h.canonical));if(_.length===0)return NaN;const w=new Hy(x[0][1]);let E=1/0;for(const B of m){switch(B.type){case"Point":E=Math.min(E,zp(x,!1,[B.coordinates],!1,w,E));break;case"LineString":E=Math.min(E,zp(x,!1,B.coordinates,!0,w,E));break;case"Polygon":E=Math.min(E,Up(x,!1,B.coordinates,w,E))}if(E===0)return E}return E}(l,this.geometries);if(l.geometryType()==="LineString")return function(h,m){const _=h.geometry(),x=_.flat().map(B=>mh([B.x,B.y],h.canonical));if(_.length===0)return NaN;const w=new Hy(x[0][1]);let E=1/0;for(const B of m){switch(B.type){case"Point":E=Math.min(E,zp(x,!0,[B.coordinates],!1,w,E));break;case"LineString":E=Math.min(E,zp(x,!0,B.coordinates,!0,w,E));break;case"Polygon":E=Math.min(E,Up(x,!0,B.coordinates,w,E))}if(E===0)return E}return E}(l,this.geometries);if(l.geometryType()==="Polygon")return function(h,m){const _=h.geometry();if(_.length===0||_[0].length===0)return NaN;const x=Op(_,0).map(B=>B.map(O=>O.map(N=>mh([N.x,N.y],h.canonical)))),w=new Hy(x[0][0][0][1]);let E=1/0;for(const B of m)for(const O of x){switch(B.type){case"Point":E=Math.min(E,Up([B.coordinates],!1,O,w,E));break;case"LineString":E=Math.min(E,Up(B.coordinates,!0,O,w,E));break;case"Polygon":E=Math.min(E,P2(O,B.coordinates,w,E))}if(E===0)return E}return E}(l,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Ud{constructor(l){this.type=Lr,this.key=l}static parse(l,h){if(l.length!==2)return h.error(`Expected 1 argument, but found ${l.length-1} instead.`);const m=l[1];return m==null?h.error("Global state property must be defined."):typeof m!="string"?h.error(`Global state property must be string, but found ${typeof l[1]} instead.`):new Ud(m)}evaluate(l){var h;const m=(h=l.globals)===null||h===void 0?void 0:h.globalState;return m&&Object.keys(m).length!==0?ru(m,this.key):null}eachChild(){}outputDefined(){return!1}}const _h={"==":dA,"!=":Uy,">":A2,"<":fA,">=":Mp,"<=":dh,array:lo,at:en,boolean:lo,case:kd,coalesce:ou,collator:fh,format:Ld,image:ph,in:zr,"index-of":uh,interpolate:Js,"interpolate-hcl":Js,"interpolate-lab":Js,length:gh,let:Un,literal:Qa,match:on,number:lo,"number-format":zy,object:lo,slice:Wo,step:gc,string:lo,"to-boolean":Sl,"to-color":Sl,"to-number":Sl,"to-string":Sl,var:ch,within:lu,distance:uu,"global-state":Ud};class Ko{constructor(l,h,m,_){this.name=l,this.type=h,this._evaluate=m,this.args=_}evaluate(l){return this._evaluate(l,this.args)}eachChild(l){this.args.forEach(l)}outputDefined(){return!1}static parse(l,h){const m=l[0],_=Ko.definitions[m];if(!_)return h.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0);const x=Array.isArray(_)?_[0]:_.type,w=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,E=w.filter(([O])=>!Array.isArray(O)||O.length===l.length-1);let B=null;for(const[O,N]of E){B=new su(h.registry,Vp,h.path,null,h.scope);const U=[];let G=!1;for(let K=1;K<l.length;K++){const q=l[K],Z=Array.isArray(O)?O[K-1]:O.type,ee=B.parse(q,1+U.length,Z);if(!ee){G=!0;break}U.push(ee)}if(!G)if(Array.isArray(O)&&O.length!==U.length)B.error(`Expected ${O.length} arguments, but found ${U.length} instead.`);else{for(let K=0;K<U.length;K++){const q=Array.isArray(O)?O[K]:O.type,Z=U[K];B.concat(K+1).checkSubtype(q,Z.type)}if(B.errors.length===0)return new Ko(m,x,N,U)}}if(E.length===1)h.errors.push(...B.errors);else{const O=(E.length?E:w).map(([U])=>{return G=U,Array.isArray(G)?`(${G.map(gn).join(", ")})`:`(${gn(G.type)}...)`;var G}).join(" | "),N=[];for(let U=1;U<l.length;U++){const G=h.parse(l[U],1+N.length);if(!G)return null;N.push(gn(G.type))}h.error(`Expected arguments of type ${O}, but found (${N.join(", ")}) instead.`)}return null}static register(l,h){Ko.definitions=h;for(const m in h)l[m]=Ko}}function EA(d,[l,h,m,_]){l=l.evaluate(d),h=h.evaluate(d),m=m.evaluate(d);const x=_?_.evaluate(d):1,w=lh(l,h,m,x);if(w)throw new dn(w);return new Ur(l/255,h/255,m/255,x,!1)}function IA(d,l){return d in l}function Yy(d,l){const h=l[d];return h===void 0?null:h}function hu(d){return{type:d}}function Vp(d){if(d instanceof ch)return Vp(d.boundExpression);if(d instanceof Ko&&d.name==="error"||d instanceof fh||d instanceof lu||d instanceof uu||d instanceof Ud)return!1;const l=d instanceof Sl||d instanceof lo;let h=!0;return d.eachChild(m=>{h=l?h&&Vp(m):h&&m instanceof Qa}),!!h&&$p(d)&&jp(d,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function $p(d){if(d instanceof Ko&&(d.name==="get"&&d.args.length===1||d.name==="feature-state"||d.name==="has"&&d.args.length===1||d.name==="properties"||d.name==="geometry-type"||d.name==="id"||/^filter-/.test(d.name))||d instanceof lu||d instanceof uu)return!1;let l=!0;return d.eachChild(h=>{l&&!$p(h)&&(l=!1)}),l}function zd(d){if(d instanceof Ko&&d.name==="feature-state")return!1;let l=!0;return d.eachChild(h=>{l&&!zd(h)&&(l=!1)}),l}function jp(d,l){if(d instanceof Ko&&l.indexOf(d.name)>=0)return!1;let h=!0;return d.eachChild(m=>{h&&!jp(m,l)&&(h=!1)}),h}function PA(d){return{result:"success",value:d}}function vh(d){return{result:"error",value:d}}function Ah(d){return d["property-type"]==="data-driven"||d["property-type"]==="cross-faded-data-driven"}function BA(d){return!!d.expression&&d.expression.parameters.indexOf("zoom")>-1}function Zy(d){return!!d.expression&&d.expression.interpolated}function jr(d){return d instanceof Number?"number":d instanceof String?"string":d instanceof Boolean?"boolean":Array.isArray(d)?"array":d===null?"null":typeof d}function Gp(d){return typeof d=="object"&&d!==null&&!Array.isArray(d)&&wi(d)===ma}function B2(d){return d}function MA(d,l){const h=d.stops&&typeof d.stops[0][0]=="object",m=h||!(h||d.property!==void 0),_=d.type||(Zy(l)?"exponential":"interval"),x=function(N){switch(N.type){case"color":return Ur.parse;case"padding":return pr.parse;case"numberArray":return Zr.parse;case"colorArray":return _r.parse;default:return null}}(l);if(x&&((d=ns({},d)).stops&&(d.stops=d.stops.map(N=>[N[0],x(N[1])])),d.default=x(d.default?d.default:l.default)),d.colorSpace&&(w=d.colorSpace)!=="rgb"&&w!=="hcl"&&w!=="lab")throw new Error(`Unknown color space: "${d.colorSpace}"`);var w;const E=function(N){switch(N){case"exponential":return RA;case"interval":return R2;case"categorical":return M2;case"identity":return k2;default:throw new Error(`Unknown function type "${N}"`)}}(_);let B,O;if(_==="categorical"){B=Object.create(null);for(const N of d.stops)B[N[0]]=N[1];O=typeof d.stops[0][0]}if(h){const N={},U=[];for(let q=0;q<d.stops.length;q++){const Z=d.stops[q],ee=Z[0].zoom;N[ee]===void 0&&(N[ee]={zoom:ee,type:d.type,property:d.property,default:d.default,stops:[]},U.push(ee)),N[ee].stops.push([Z[0].value,Z[1]])}const G=[];for(const q of U)G.push([N[q].zoom,MA(N[q],l)]);const K={name:"linear"};return{kind:"composite",interpolationType:K,interpolationFactor:Js.interpolationFactor.bind(void 0,K),zoomStops:G.map(q=>q[0]),evaluate:({zoom:q},Z)=>RA({stops:G,base:d.base},l,q).evaluate(q,Z)}}if(m){const N=_==="exponential"?{name:"exponential",base:d.base!==void 0?d.base:1}:null;return{kind:"camera",interpolationType:N,interpolationFactor:Js.interpolationFactor.bind(void 0,N),zoomStops:d.stops.map(U=>U[0]),evaluate:({zoom:U})=>E(d,l,U,B,O)}}return{kind:"source",evaluate(N,U){const G=U&&U.properties?U.properties[d.property]:void 0;return G===void 0?Vd(d.default,l.default):E(d,l,G,B,O)}}}function Vd(d,l,h){return d!==void 0?d:l!==void 0?l:h!==void 0?h:void 0}function M2(d,l,h,m,_){return Vd(typeof h===_?m[h]:void 0,d.default,l.default)}function R2(d,l,h){if(jr(h)!=="number")return Vd(d.default,l.default);const m=d.stops.length;if(m===1||h<=d.stops[0][0])return d.stops[0][1];if(h>=d.stops[m-1][0])return d.stops[m-1][1];const _=hh(d.stops.map(x=>x[0]),h);return d.stops[_][1]}function RA(d,l,h){const m=d.base!==void 0?d.base:1;if(jr(h)!=="number")return Vd(d.default,l.default);const _=d.stops.length;if(_===1||h<=d.stops[0][0])return d.stops[0][1];if(h>=d.stops[_-1][0])return d.stops[_-1][1];const x=hh(d.stops.map(N=>N[0]),h),w=function(N,U,G,K){const q=K-G,Z=N-G;return q===0?0:U===1?Z/q:(Math.pow(U,Z)-1)/(Math.pow(U,q)-1)}(h,m,d.stops[x][0],d.stops[x+1][0]),E=d.stops[x][1],B=d.stops[x+1][1],O=ii[l.type]||B2;return typeof E.evaluate=="function"?{evaluate(...N){const U=E.evaluate.apply(void 0,N),G=B.evaluate.apply(void 0,N);if(U!==void 0&&G!==void 0)return O(U,G,w,d.colorSpace)}}:O(E,B,w,d.colorSpace)}function k2(d,l,h){switch(l.type){case"color":h=Ur.parse(h);break;case"formatted":h=Cs.fromString(h.toString());break;case"resolvedImage":h=Io.fromString(h.toString());break;case"padding":h=pr.parse(h);break;case"colorArray":h=_r.parse(h);break;case"numberArray":h=Zr.parse(h);break;default:jr(h)===l.type||l.type==="enum"&&l.values[h]||(h=void 0)}return Vd(h,d.default,l.default)}Ko.register(_h,{error:[{kind:"error"},[Nr],(d,[l])=>{throw new dn(l.evaluate(d))}],typeof:[Nr,[Lr],(d,[l])=>gn(wi(l.evaluate(d)))],"to-rgba":[ss(Kt,4),[Ws],(d,[l])=>{const[h,m,_,x]=l.evaluate(d).rgb;return[255*h,255*m,255*_,x]}],rgb:[Ws,[Kt,Kt,Kt],EA],rgba:[Ws,[Kt,Kt,Kt,Kt],EA],has:{type:Dr,overloads:[[[Nr],(d,[l])=>IA(l.evaluate(d),d.properties())],[[Nr,ma],(d,[l,h])=>IA(l.evaluate(d),h.evaluate(d))]]},get:{type:Lr,overloads:[[[Nr],(d,[l])=>Yy(l.evaluate(d),d.properties())],[[Nr,ma],(d,[l,h])=>Yy(l.evaluate(d),h.evaluate(d))]]},"feature-state":[Lr,[Nr],(d,[l])=>Yy(l.evaluate(d),d.featureState||{})],properties:[ma,[],d=>d.properties()],"geometry-type":[Nr,[],d=>d.geometryType()],id:[Lr,[],d=>d.id()],zoom:[Kt,[],d=>d.globals.zoom],"heatmap-density":[Kt,[],d=>d.globals.heatmapDensity||0],elevation:[Kt,[],d=>d.globals.elevation||0],"line-progress":[Kt,[],d=>d.globals.lineProgress||0],accumulated:[Lr,[],d=>d.globals.accumulated===void 0?null:d.globals.accumulated],"+":[Kt,hu(Kt),(d,l)=>{let h=0;for(const m of l)h+=m.evaluate(d);return h}],"*":[Kt,hu(Kt),(d,l)=>{let h=1;for(const m of l)h*=m.evaluate(d);return h}],"-":{type:Kt,overloads:[[[Kt,Kt],(d,[l,h])=>l.evaluate(d)-h.evaluate(d)],[[Kt],(d,[l])=>-l.evaluate(d)]]},"/":[Kt,[Kt,Kt],(d,[l,h])=>l.evaluate(d)/h.evaluate(d)],"%":[Kt,[Kt,Kt],(d,[l,h])=>l.evaluate(d)%h.evaluate(d)],ln2:[Kt,[],()=>Math.LN2],pi:[Kt,[],()=>Math.PI],e:[Kt,[],()=>Math.E],"^":[Kt,[Kt,Kt],(d,[l,h])=>Math.pow(l.evaluate(d),h.evaluate(d))],sqrt:[Kt,[Kt],(d,[l])=>Math.sqrt(l.evaluate(d))],log10:[Kt,[Kt],(d,[l])=>Math.log(l.evaluate(d))/Math.LN10],ln:[Kt,[Kt],(d,[l])=>Math.log(l.evaluate(d))],log2:[Kt,[Kt],(d,[l])=>Math.log(l.evaluate(d))/Math.LN2],sin:[Kt,[Kt],(d,[l])=>Math.sin(l.evaluate(d))],cos:[Kt,[Kt],(d,[l])=>Math.cos(l.evaluate(d))],tan:[Kt,[Kt],(d,[l])=>Math.tan(l.evaluate(d))],asin:[Kt,[Kt],(d,[l])=>Math.asin(l.evaluate(d))],acos:[Kt,[Kt],(d,[l])=>Math.acos(l.evaluate(d))],atan:[Kt,[Kt],(d,[l])=>Math.atan(l.evaluate(d))],min:[Kt,hu(Kt),(d,l)=>Math.min(...l.map(h=>h.evaluate(d)))],max:[Kt,hu(Kt),(d,l)=>Math.max(...l.map(h=>h.evaluate(d)))],abs:[Kt,[Kt],(d,[l])=>Math.abs(l.evaluate(d))],round:[Kt,[Kt],(d,[l])=>{const h=l.evaluate(d);return h<0?-Math.round(-h):Math.round(h)}],floor:[Kt,[Kt],(d,[l])=>Math.floor(l.evaluate(d))],ceil:[Kt,[Kt],(d,[l])=>Math.ceil(l.evaluate(d))],"filter-==":[Dr,[Nr,Lr],(d,[l,h])=>d.properties()[l.value]===h.value],"filter-id-==":[Dr,[Lr],(d,[l])=>d.id()===l.value],"filter-type-==":[Dr,[Nr],(d,[l])=>d.geometryType()===l.value],"filter-<":[Dr,[Nr,Lr],(d,[l,h])=>{const m=d.properties()[l.value],_=h.value;return typeof m==typeof _&&m<_}],"filter-id-<":[Dr,[Lr],(d,[l])=>{const h=d.id(),m=l.value;return typeof h==typeof m&&h<m}],"filter->":[Dr,[Nr,Lr],(d,[l,h])=>{const m=d.properties()[l.value],_=h.value;return typeof m==typeof _&&m>_}],"filter-id->":[Dr,[Lr],(d,[l])=>{const h=d.id(),m=l.value;return typeof h==typeof m&&h>m}],"filter-<=":[Dr,[Nr,Lr],(d,[l,h])=>{const m=d.properties()[l.value],_=h.value;return typeof m==typeof _&&m<=_}],"filter-id-<=":[Dr,[Lr],(d,[l])=>{const h=d.id(),m=l.value;return typeof h==typeof m&&h<=m}],"filter->=":[Dr,[Nr,Lr],(d,[l,h])=>{const m=d.properties()[l.value],_=h.value;return typeof m==typeof _&&m>=_}],"filter-id->=":[Dr,[Lr],(d,[l])=>{const h=d.id(),m=l.value;return typeof h==typeof m&&h>=m}],"filter-has":[Dr,[Lr],(d,[l])=>l.value in d.properties()],"filter-has-id":[Dr,[],d=>d.id()!==null&&d.id()!==void 0],"filter-type-in":[Dr,[ss(Nr)],(d,[l])=>l.value.indexOf(d.geometryType())>=0],"filter-id-in":[Dr,[ss(Lr)],(d,[l])=>l.value.indexOf(d.id())>=0],"filter-in-small":[Dr,[Nr,ss(Lr)],(d,[l,h])=>h.value.indexOf(d.properties()[l.value])>=0],"filter-in-large":[Dr,[Nr,ss(Lr)],(d,[l,h])=>function(m,_,x,w){for(;x<=w;){const E=x+w>>1;if(_[E]===m)return!0;_[E]>m?w=E-1:x=E+1}return!1}(d.properties()[l.value],h.value,0,h.value.length-1)],all:{type:Dr,overloads:[[[Dr,Dr],(d,[l,h])=>l.evaluate(d)&&h.evaluate(d)],[hu(Dr),(d,l)=>{for(const h of l)if(!h.evaluate(d))return!1;return!0}]]},any:{type:Dr,overloads:[[[Dr,Dr],(d,[l,h])=>l.evaluate(d)||h.evaluate(d)],[hu(Dr),(d,l)=>{for(const h of l)if(h.evaluate(d))return!0;return!1}]]},"!":[Dr,[Dr],(d,[l])=>!l.evaluate(d)],"is-supported-script":[Dr,[Nr],(d,[l])=>{const h=d.globals&&d.globals.isSupportedScript;return!h||h(l.evaluate(d))}],upcase:[Nr,[Nr],(d,[l])=>l.evaluate(d).toUpperCase()],downcase:[Nr,[Nr],(d,[l])=>l.evaluate(d).toLowerCase()],concat:[Nr,hu(Lr),(d,l)=>l.map(h=>nu(h.evaluate(d))).join("")],"resolved-locale":[Nr,[Qc],(d,[l])=>l.evaluate(d).resolvedLocale()]});class Qy{constructor(l,h,m){this.expression=l,this._warningHistory={},this._evaluator=new Ly,this._defaultValue=h?function(_){if(_.type==="color"&&Gp(_.default))return new Ur(0,0,0,0);switch(_.type){case"color":return Ur.parse(_.default)||null;case"padding":return pr.parse(_.default)||null;case"numberArray":return Zr.parse(_.default)||null;case"colorArray":return _r.parse(_.default)||null;case"variableAnchorOffsetCollection":return Ks.parse(_.default)||null;case"projectionDefinition":return Xs.parse(_.default)||null;default:return _.default===void 0?null:_.default}}(h):null,this._enumValues=h&&h.type==="enum"?h.values:null,this._globalState=m}evaluateWithoutErrorHandling(l,h,m,_,x,w){return this._globalState&&(l=du(l,this._globalState)),this._evaluator.globals=l,this._evaluator.feature=h,this._evaluator.featureState=m,this._evaluator.canonical=_,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=w,this.expression.evaluate(this._evaluator)}evaluate(l,h,m,_,x,w){this._globalState&&(l=du(l,this._globalState)),this._evaluator.globals=l,this._evaluator.feature=h||null,this._evaluator.featureState=m||null,this._evaluator.canonical=_,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=w||null;try{const E=this.expression.evaluate(this._evaluator);if(E==null||typeof E=="number"&&E!=E)return this._defaultValue;if(this._enumValues&&!(E in this._enumValues))throw new dn(`Expected value to be one of ${Object.keys(this._enumValues).map(B=>JSON.stringify(B)).join(", ")}, but found ${JSON.stringify(E)} instead.`);return E}catch(E){return this._warningHistory[E.message]||(this._warningHistory[E.message]=!0,typeof console<"u"&&console.warn(E.message)),this._defaultValue}}}function xh(d){return Array.isArray(d)&&d.length>0&&typeof d[0]=="string"&&d[0]in _h}function $d(d,l,h){const m=new su(_h,Vp,[],l?function(x){const w={color:Ws,string:Nr,number:Kt,enum:Nr,boolean:Dr,formatted:eu,padding:tu,numberArray:ac,colorArray:Ho,projectionDefinition:ih,resolvedImage:wl,variableAnchorOffsetCollection:lc};return x.type==="array"?ss(w[x.value]||Lr,x.length):w[x.type]}(l):void 0),_=m.parse(d,void 0,void 0,void 0,l&&l.type==="string"?{typeAnnotation:"coerce"}:void 0);return _?PA(new Qy(_,l,h)):vh(m.errors)}class Hp{constructor(l,h,m){this.kind=l,this._styleExpression=h,this.isStateDependent=l!=="constant"&&!zd(h.expression),this.globalStateRefs=mc(h.expression),this._globalState=m}evaluateWithoutErrorHandling(l,h,m,_,x,w){return this._globalState&&(l=du(l,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(l,h,m,_,x,w)}evaluate(l,h,m,_,x,w){return this._globalState&&(l=du(l,this._globalState)),this._styleExpression.evaluate(l,h,m,_,x,w)}}class eb{constructor(l,h,m,_,x){this.kind=l,this.zoomStops=m,this._styleExpression=h,this.isStateDependent=l!=="camera"&&!zd(h.expression),this.globalStateRefs=mc(h.expression),this.interpolationType=_,this._globalState=x}evaluateWithoutErrorHandling(l,h,m,_,x,w){return this._globalState&&(l=du(l,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(l,h,m,_,x,w)}evaluate(l,h,m,_,x,w){return this._globalState&&(l=du(l,this._globalState)),this._styleExpression.evaluate(l,h,m,_,x,w)}interpolationFactor(l,h,m){return this.interpolationType?Js.interpolationFactor(this.interpolationType,l,h,m):0}}function tb(d,l,h){const m=$d(d,l,h);if(m.result==="error")return m;const _=m.value.expression,x=$p(_);if(!x&&!Ah(l))return vh([new is("","data expressions not supported")]);const w=jp(_,["zoom"]);if(!w&&!BA(l))return vh([new is("","zoom expressions not supported")]);const E=Kp(_);return E||w?E instanceof is?vh([E]):E instanceof Js&&!Zy(l)?vh([new is("",'"interpolate" expressions cannot be used with this property')]):PA(E?new eb(x?"camera":"composite",m.value,E.labels,E instanceof Js?E.interpolation:void 0,h):new Hp(x?"constant":"source",m.value,h)):vh([new is("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Wp{constructor(l,h){this._parameters=l,this._specification=h,ns(this,MA(this._parameters,this._specification))}static deserialize(l){return new Wp(l._parameters,l._specification)}static serialize(l){return{_parameters:l._parameters,_specification:l._specification}}}function Kp(d){let l=null;if(d instanceof Un)l=Kp(d.result);else if(d instanceof ou){for(const h of d.args)if(l=Kp(h),l)break}else(d instanceof gc||d instanceof Js)&&d.input instanceof Ko&&d.input.name==="zoom"&&(l=d);return l instanceof is||d.eachChild(h=>{const m=Kp(h);m instanceof is?l=m:!l&&m?l=new is("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):l&&m&&l!==m&&(l=new is("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),l}function mc(d,l=new Set){return d instanceof Ud&&l.add(d.key),d.eachChild(h=>{mc(h,l)}),l}function du(d,l){const{zoom:h,heatmapDensity:m,elevation:_,lineProgress:x,isSupportedScript:w,accumulated:E}=d??{};return{zoom:h,heatmapDensity:m,elevation:_,lineProgress:x,isSupportedScript:w,accumulated:E,globalState:l}}function rb(d){if(d===!0||d===!1)return!0;if(!Array.isArray(d)||d.length===0)return!1;switch(d[0]){case"has":return d.length>=2&&d[1]!=="$id"&&d[1]!=="$type";case"in":return d.length>=3&&(typeof d[1]!="string"||Array.isArray(d[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return d.length!==3||Array.isArray(d[1])||Array.isArray(d[2]);case"any":case"all":for(const l of d.slice(1))if(!rb(l)&&typeof l!="boolean")return!1;return!0;default:return!0}}const O2={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function jd(d,l){if(d==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};rb(d)||(d=Gd(d));const h=$d(d,O2,l);if(h.result==="error")throw new Error(h.value.map(m=>`${m.key}: ${m.message}`).join(", "));return{filter:(m,_,x)=>h.value.evaluate(m,_,{},x),needGeometry:kA(d),getGlobalStateRefs:()=>mc(h.value.expression)}}function D2(d,l){return d<l?-1:d>l?1:0}function kA(d){if(!Array.isArray(d))return!1;if(d[0]==="within"||d[0]==="distance")return!0;for(let l=1;l<d.length;l++)if(kA(d[l]))return!0;return!1}function Gd(d){if(!d)return!0;const l=d[0];return d.length<=1?l!=="any":l==="=="?Xp(d[1],d[2],"=="):l==="!="?Hd(Xp(d[1],d[2],"==")):l==="<"||l===">"||l==="<="||l===">="?Xp(d[1],d[2],l):l==="any"?(h=d.slice(1),["any"].concat(h.map(Gd))):l==="all"?["all"].concat(d.slice(1).map(Gd)):l==="none"?["all"].concat(d.slice(1).map(Gd).map(Hd)):l==="in"?OA(d[1],d.slice(2)):l==="!in"?Hd(OA(d[1],d.slice(2))):l==="has"?DA(d[1]):l!=="!has"||Hd(DA(d[1]));var h}function Xp(d,l,h){switch(d){case"$type":return[`filter-type-${h}`,l];case"$id":return[`filter-id-${h}`,l];default:return[`filter-${h}`,d,l]}}function OA(d,l){if(l.length===0)return!1;switch(d){case"$type":return["filter-type-in",["literal",l]];case"$id":return["filter-id-in",["literal",l]];default:return l.length>200&&!l.some(h=>typeof h!=typeof l[0])?["filter-in-large",d,["literal",l.sort(D2)]]:["filter-in-small",d,["literal",l]]}}function DA(d){switch(d){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",d]}}function Hd(d){return["!",d]}function Jp(d){const l=typeof d;if(l==="number"||l==="boolean"||l==="string"||d==null)return JSON.stringify(d);if(Array.isArray(d)){let _="[";for(const x of d)_+=`${Jp(x)},`;return`${_}]`}const h=Object.keys(d).sort();let m="{";for(let _=0;_<h.length;_++)m+=`${JSON.stringify(h[_])}:${Jp(d[h[_]])},`;return`${m}}`}function LA(d){let l="";for(const h of Tn)l+=`/${Jp(d[h])}`;return l}function NA(d){const l=d.value;return l?[new Rt(d.key,l,"constants have been deprecated as of v8")]:[]}function Ci(d){return d instanceof Number||d instanceof String||d instanceof Boolean?d.valueOf():d}function fu(d){if(Array.isArray(d))return d.map(fu);if(d instanceof Object&&!(d instanceof Number||d instanceof String||d instanceof Boolean)){const l={};for(const h in d)l[h]=fu(d[h]);return l}return Ci(d)}function Po(d){const l=d.key,h=d.value,m=d.valueSpec||{},_=d.objectElementValidators||{},x=d.style,w=d.styleSpec,E=d.validateSpec;let B=[];const O=jr(h);if(O!=="object")return[new Rt(l,h,`object expected, ${O} found`)];for(const N in h){const U=N.split(".")[0],G=ru(m,U)||m["*"];let K;if(ru(_,U))K=_[U];else if(ru(m,U)){if(h[N]===void 0)continue;K=E}else if(_["*"])K=_["*"];else{if(!m["*"]){B.push(new Rt(l,h[N],`unknown property "${N}"`));continue}K=E}B=B.concat(K({key:(l&&`${l}.`)+N,value:h[N],valueSpec:G,style:x,styleSpec:w,object:h,objectKey:N,validateSpec:E},h))}for(const N in m)_[N]||m[N].required&&m[N].default===void 0&&h[N]===void 0&&B.push(new Rt(l,h,`missing required property "${N}"`));return B}function qp(d){const l=d.value,h=d.valueSpec,m=d.style,_=d.styleSpec,x=d.key,w=d.arrayElementValidator||d.validateSpec;if(jr(l)!=="array")return[new Rt(x,l,`array expected, ${jr(l)} found`)];if(h.length&&l.length!==h.length)return[new Rt(x,l,`array length ${h.length} expected, length ${l.length} found`)];let E={type:h.value,values:h.values};_.$version<7&&(E.function=h.function),jr(h.value)==="object"&&(E=h.value);let B=[];for(let O=0;O<l.length;O++)B=B.concat(w({array:l,arrayIndex:O,value:l[O],valueSpec:E,validateSpec:d.validateSpec,style:m,styleSpec:_,key:`${x}[${O}]`}));return B}function Wd(d){const l=d.key,h=d.value,m=d.valueSpec;let _=jr(h);return _==="number"&&h!=h&&(_="NaN"),_!=="number"?[new Rt(l,h,`number expected, ${_} found`)]:"minimum"in m&&h<m.minimum?[new Rt(l,h,`${h} is less than the minimum value ${m.minimum}`)]:"maximum"in m&&h>m.maximum?[new Rt(l,h,`${h} is greater than the maximum value ${m.maximum}`)]:[]}function Yp(d){const l=d.valueSpec,h=Ci(d.value.type);let m,_,x,w={};const E=h!=="categorical"&&d.value.property===void 0,B=!E,O=jr(d.value.stops)==="array"&&jr(d.value.stops[0])==="array"&&jr(d.value.stops[0][0])==="object",N=Po({key:d.key,value:d.value,valueSpec:d.styleSpec.function,validateSpec:d.validateSpec,style:d.style,styleSpec:d.styleSpec,objectElementValidators:{stops:function(K){if(h==="identity")return[new Rt(K.key,K.value,'identity function may not have a "stops" property')];let q=[];const Z=K.value;return q=q.concat(qp({key:K.key,value:Z,valueSpec:K.valueSpec,validateSpec:K.validateSpec,style:K.style,styleSpec:K.styleSpec,arrayElementValidator:U})),jr(Z)==="array"&&Z.length===0&&q.push(new Rt(K.key,Z,"array must have at least one stop")),q},default:function(K){return K.validateSpec({key:K.key,value:K.value,valueSpec:l,validateSpec:K.validateSpec,style:K.style,styleSpec:K.styleSpec})}}});return h==="identity"&&E&&N.push(new Rt(d.key,d.value,'missing required property "property"')),h==="identity"||d.value.stops||N.push(new Rt(d.key,d.value,'missing required property "stops"')),h==="exponential"&&d.valueSpec.expression&&!Zy(d.valueSpec)&&N.push(new Rt(d.key,d.value,"exponential functions not supported")),d.styleSpec.$version>=8&&(B&&!Ah(d.valueSpec)?N.push(new Rt(d.key,d.value,"property functions not supported")):E&&!BA(d.valueSpec)&&N.push(new Rt(d.key,d.value,"zoom functions not supported"))),h!=="categorical"&&!O||d.value.property!==void 0||N.push(new Rt(d.key,d.value,'"property" property is required')),N;function U(K){let q=[];const Z=K.value,ee=K.key;if(jr(Z)!=="array")return[new Rt(ee,Z,`array expected, ${jr(Z)} found`)];if(Z.length!==2)return[new Rt(ee,Z,`array length 2 expected, length ${Z.length} found`)];if(O){if(jr(Z[0])!=="object")return[new Rt(ee,Z,`object expected, ${jr(Z[0])} found`)];if(Z[0].zoom===void 0)return[new Rt(ee,Z,"object stop key must have zoom")];if(Z[0].value===void 0)return[new Rt(ee,Z,"object stop key must have value")];if(x&&x>Ci(Z[0].zoom))return[new Rt(ee,Z[0].zoom,"stop zoom values must appear in ascending order")];Ci(Z[0].zoom)!==x&&(x=Ci(Z[0].zoom),_=void 0,w={}),q=q.concat(Po({key:`${ee}[0]`,value:Z[0],valueSpec:{zoom:{}},validateSpec:K.validateSpec,style:K.style,styleSpec:K.styleSpec,objectElementValidators:{zoom:Wd,value:G}}))}else q=q.concat(G({key:`${ee}[0]`,value:Z[0],validateSpec:K.validateSpec,style:K.style,styleSpec:K.styleSpec},Z));return xh(fu(Z[1]))?q.concat([new Rt(`${ee}[1]`,Z[1],"expressions are not allowed in function stops.")]):q.concat(K.validateSpec({key:`${ee}[1]`,value:Z[1],valueSpec:l,validateSpec:K.validateSpec,style:K.style,styleSpec:K.styleSpec}))}function G(K,q){const Z=jr(K.value),ee=Ci(K.value),ue=K.value!==null?K.value:q;if(m){if(Z!==m)return[new Rt(K.key,ue,`${Z} stop domain type must match previous stop domain type ${m}`)]}else m=Z;if(Z!=="number"&&Z!=="string"&&Z!=="boolean")return[new Rt(K.key,ue,"stop domain value must be a number, string, or boolean")];if(Z!=="number"&&h!=="categorical"){let xe=`number expected, ${Z} found`;return Ah(l)&&h===void 0&&(xe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Rt(K.key,ue,xe)]}return h!=="categorical"||Z!=="number"||isFinite(ee)&&Math.floor(ee)===ee?h!=="categorical"&&Z==="number"&&_!==void 0&&ee<_?[new Rt(K.key,ue,"stop domain values must appear in ascending order")]:(_=ee,h==="categorical"&&ee in w?[new Rt(K.key,ue,"stop domain values must be unique")]:(w[ee]=!0,[])):[new Rt(K.key,ue,`integer expected, found ${ee}`)]}}function yc(d){const l=(d.expressionContext==="property"?tb:$d)(fu(d.value),d.valueSpec);if(l.result==="error")return l.value.map(m=>new Rt(`${d.key}${m.key}`,d.value,m.message));const h=l.value.expression||l.value._styleExpression.expression;if(d.expressionContext==="property"&&d.propertyKey==="text-font"&&!h.outputDefined())return[new Rt(d.key,d.value,`Invalid data expression for "${d.propertyKey}". Output values must be contained as literals within the expression.`)];if(d.expressionContext==="property"&&d.propertyType==="layout"&&!zd(h))return[new Rt(d.key,d.value,'"feature-state" data expressions are not supported with layout properties.')];if(d.expressionContext==="filter"&&!zd(h))return[new Rt(d.key,d.value,'"feature-state" data expressions are not supported with filters.')];if(d.expressionContext&&d.expressionContext.indexOf("cluster")===0){if(!jp(h,["zoom","feature-state"]))return[new Rt(d.key,d.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(d.expressionContext==="cluster-initial"&&!$p(h))return[new Rt(d.key,d.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Kd(d){const l=d.key,h=d.value,m=jr(h);return m!=="string"?[new Rt(l,h,`color expected, ${m} found`)]:Ur.parse(String(h))?[]:[new Rt(l,h,`color expected, "${h}" found`)]}function pu(d){const l=d.key,h=d.value,m=d.valueSpec,_=[];return Array.isArray(m.values)?m.values.indexOf(Ci(h))===-1&&_.push(new Rt(l,h,`expected one of [${m.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(m.values).indexOf(Ci(h))===-1&&_.push(new Rt(l,h,`expected one of [${Object.keys(m.values).join(", ")}], ${JSON.stringify(h)} found`)),_}function wh(d){return rb(fu(d.value))?yc(ns({},d,{expressionContext:"filter",valueSpec:{value:"boolean"}})):FA(d)}function FA(d){const l=d.value,h=d.key;if(jr(l)!=="array")return[new Rt(h,l,`array expected, ${jr(l)} found`)];const m=d.styleSpec;let _,x=[];if(l.length<1)return[new Rt(h,l,"filter array must have at least 1 element")];switch(x=x.concat(pu({key:`${h}[0]`,value:l[0],valueSpec:m.filter_operator,style:d.style,styleSpec:d.styleSpec})),Ci(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&Ci(l[1])==="$type"&&x.push(new Rt(h,l,`"$type" cannot be use with operator "${l[0]}"`));case"==":case"!=":l.length!==3&&x.push(new Rt(h,l,`filter array for operator "${l[0]}" must have 3 elements`));case"in":case"!in":l.length>=2&&(_=jr(l[1]),_!=="string"&&x.push(new Rt(`${h}[1]`,l[1],`string expected, ${_} found`)));for(let w=2;w<l.length;w++)_=jr(l[w]),Ci(l[1])==="$type"?x=x.concat(pu({key:`${h}[${w}]`,value:l[w],valueSpec:m.geometry_type,style:d.style,styleSpec:d.styleSpec})):_!=="string"&&_!=="number"&&_!=="boolean"&&x.push(new Rt(`${h}[${w}]`,l[w],`string, number, or boolean expected, ${_} found`));break;case"any":case"all":case"none":for(let w=1;w<l.length;w++)x=x.concat(FA({key:`${h}[${w}]`,value:l[w],style:d.style,styleSpec:d.styleSpec}));break;case"has":case"!has":_=jr(l[1]),l.length!==2?x.push(new Rt(h,l,`filter array for "${l[0]}" operator must have 2 elements`)):_!=="string"&&x.push(new Rt(`${h}[1]`,l[1],`string expected, ${_} found`))}return x}function UA(d,l){const h=d.key,m=d.validateSpec,_=d.style,x=d.styleSpec,w=d.value,E=d.objectKey,B=x[`${l}_${d.layerType}`];if(!B)return[];const O=E.match(/^(.*)-transition$/);if(l==="paint"&&O&&B[O[1]]&&B[O[1]].transition)return m({key:h,value:w,valueSpec:x.transition,style:_,styleSpec:x});const N=d.valueSpec||B[E];if(!N)return[new Rt(h,w,`unknown property "${E}"`)];let U;if(jr(w)==="string"&&Ah(N)&&!N.tokens&&(U=/^{([^}]+)}$/.exec(w)))return[new Rt(h,w,`"${E}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(U[1])} }\`.`)];const G=[];return d.layerType==="symbol"&&E==="text-font"&&Gp(fu(w))&&Ci(w.type)==="identity"&&G.push(new Rt(h,w,'"text-font" does not support identity functions')),G.concat(m({key:d.key,value:w,valueSpec:N,style:_,styleSpec:x,expressionContext:"property",propertyType:l,propertyKey:E}))}function zA(d){return UA(d,"paint")}function VA(d){return UA(d,"layout")}function $A(d){let l=[];const h=d.value,m=d.key,_=d.style,x=d.styleSpec;if(jr(h)!=="object")return[new Rt(m,h,`object expected, ${jr(h)} found`)];h.type||h.ref||l.push(new Rt(m,h,'either "type" or "ref" is required'));let w=Ci(h.type);const E=Ci(h.ref);if(h.id){const B=Ci(h.id);for(let O=0;O<d.arrayIndex;O++){const N=_.layers[O];Ci(N.id)===B&&l.push(new Rt(m,h.id,`duplicate layer id "${h.id}", previously used at line ${N.id.__line__}`))}}if("ref"in h){let B;["type","source","source-layer","filter","layout"].forEach(O=>{O in h&&l.push(new Rt(m,h[O],`"${O}" is prohibited for ref layers`))}),_.layers.forEach(O=>{Ci(O.id)===E&&(B=O)}),B?B.ref?l.push(new Rt(m,h.ref,"ref cannot reference another ref layer")):w=Ci(B.type):l.push(new Rt(m,h.ref,`ref layer "${E}" not found`))}else if(w!=="background")if(h.source){const B=_.sources&&_.sources[h.source],O=B&&Ci(B.type);B?O==="vector"&&w==="raster"?l.push(new Rt(m,h.source,`layer "${h.id}" requires a raster source`)):O!=="raster-dem"&&w==="hillshade"||O!=="raster-dem"&&w==="color-relief"?l.push(new Rt(m,h.source,`layer "${h.id}" requires a raster-dem source`)):O==="raster"&&w!=="raster"?l.push(new Rt(m,h.source,`layer "${h.id}" requires a vector source`)):O!=="vector"||h["source-layer"]?O==="raster-dem"&&w!=="hillshade"&&w!=="color-relief"?l.push(new Rt(m,h.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):w!=="line"||!h.paint||!h.paint["line-gradient"]||O==="geojson"&&B.lineMetrics||l.push(new Rt(m,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):l.push(new Rt(m,h,`layer "${h.id}" must specify a "source-layer"`)):l.push(new Rt(m,h.source,`source "${h.source}" not found`))}else l.push(new Rt(m,h,'missing required property "source"'));return l=l.concat(Po({key:m,value:h,valueSpec:x.layer,style:d.style,styleSpec:d.styleSpec,validateSpec:d.validateSpec,objectElementValidators:{"*":()=>[],type:()=>d.validateSpec({key:`${m}.type`,value:h.type,valueSpec:x.layer.type,style:d.style,styleSpec:d.styleSpec,validateSpec:d.validateSpec,object:h,objectKey:"type"}),filter:wh,layout:B=>Po({layer:h,key:B.key,value:B.value,style:B.style,styleSpec:B.styleSpec,validateSpec:B.validateSpec,objectElementValidators:{"*":O=>VA(ns({layerType:w},O))}}),paint:B=>Po({layer:h,key:B.key,value:B.value,style:B.style,styleSpec:B.styleSpec,validateSpec:B.validateSpec,objectElementValidators:{"*":O=>zA(ns({layerType:w},O))}})}})),l}function bc(d){const l=d.value,h=d.key,m=jr(l);return m!=="string"?[new Rt(h,l,`string expected, ${m} found`)]:[]}const nb={promoteId:function({key:d,value:l}){if(jr(l)==="string")return bc({key:d,value:l});{const h=[];for(const m in l)h.push(...bc({key:`${d}.${m}`,value:l[m]}));return h}}};function ib(d){const l=d.value,h=d.key,m=d.styleSpec,_=d.style,x=d.validateSpec;if(!l.type)return[new Rt(h,l,'"type" is required')];const w=Ci(l.type);let E;switch(w){case"vector":case"raster":return E=Po({key:h,value:l,valueSpec:m[`source_${w.replace("-","_")}`],style:d.style,styleSpec:m,objectElementValidators:nb,validateSpec:x}),E;case"raster-dem":return E=function(B){var O;const N=(O=B.sourceName)!==null&&O!==void 0?O:"",U=B.value,G=B.styleSpec,K=G.source_raster_dem,q=B.style;let Z=[];const ee=jr(U);if(U===void 0)return Z;if(ee!=="object")return Z.push(new Rt("source_raster_dem",U,`object expected, ${ee} found`)),Z;const ue=Ci(U.encoding)==="custom",xe=["redFactor","greenFactor","blueFactor","baseShift"],fe=B.value.encoding?`"${B.value.encoding}"`:"Default";for(const pe in U)!ue&&xe.includes(pe)?Z.push(new Rt(pe,U[pe],`In "${N}": "${pe}" is only valid when "encoding" is set to "custom". ${fe} encoding found`)):K[pe]?Z=Z.concat(B.validateSpec({key:pe,value:U[pe],valueSpec:K[pe],validateSpec:B.validateSpec,style:q,styleSpec:G})):Z.push(new Rt(pe,U[pe],`unknown property "${pe}"`));return Z}({sourceName:h,value:l,style:d.style,styleSpec:m,validateSpec:x}),E;case"geojson":if(E=Po({key:h,value:l,valueSpec:m.source_geojson,style:_,styleSpec:m,validateSpec:x,objectElementValidators:nb}),l.cluster)for(const B in l.clusterProperties){const[O,N]=l.clusterProperties[B],U=typeof O=="string"?[O,["accumulated"],["get",B]]:O;E.push(...yc({key:`${h}.${B}.map`,value:N,expressionContext:"cluster-map"})),E.push(...yc({key:`${h}.${B}.reduce`,value:U,expressionContext:"cluster-reduce"}))}return E;case"video":return Po({key:h,value:l,valueSpec:m.source_video,style:_,validateSpec:x,styleSpec:m});case"image":return Po({key:h,value:l,valueSpec:m.source_image,style:_,validateSpec:x,styleSpec:m});case"canvas":return[new Rt(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return pu({key:`${h}.type`,value:l.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Xd(d){const l=d.value,h=d.styleSpec,m=h.light,_=d.style;let x=[];const w=jr(l);if(l===void 0)return x;if(w!=="object")return x=x.concat([new Rt("light",l,`object expected, ${w} found`)]),x;for(const E in l){const B=E.match(/^(.*)-transition$/);x=x.concat(B&&m[B[1]]&&m[B[1]].transition?d.validateSpec({key:E,value:l[E],valueSpec:h.transition,validateSpec:d.validateSpec,style:_,styleSpec:h}):m[E]?d.validateSpec({key:E,value:l[E],valueSpec:m[E],validateSpec:d.validateSpec,style:_,styleSpec:h}):[new Rt(E,l[E],`unknown property "${E}"`)])}return x}function jA(d){const l=d.value,h=d.styleSpec,m=h.sky,_=d.style,x=jr(l);if(l===void 0)return[];if(x!=="object")return[new Rt("sky",l,`object expected, ${x} found`)];let w=[];for(const E in l)w=w.concat(m[E]?d.validateSpec({key:E,value:l[E],valueSpec:m[E],style:_,styleSpec:h}):[new Rt(E,l[E],`unknown property "${E}"`)]);return w}function sb(d){const l=d.value,h=d.styleSpec,m=h.terrain,_=d.style;let x=[];const w=jr(l);if(l===void 0)return x;if(w!=="object")return x=x.concat([new Rt("terrain",l,`object expected, ${w} found`)]),x;for(const E in l)x=x.concat(m[E]?d.validateSpec({key:E,value:l[E],valueSpec:m[E],validateSpec:d.validateSpec,style:_,styleSpec:h}):[new Rt(E,l[E],`unknown property "${E}"`)]);return x}function ob(d){let l=[];const h=d.value,m=d.key;if(Array.isArray(h)){const _=[],x=[];for(const w in h)h[w].id&&_.includes(h[w].id)&&l.push(new Rt(m,h,`all the sprites' ids must be unique, but ${h[w].id} is duplicated`)),_.push(h[w].id),h[w].url&&x.includes(h[w].url)&&l.push(new Rt(m,h,`all the sprites' URLs must be unique, but ${h[w].url} is duplicated`)),x.push(h[w].url),l=l.concat(Po({key:`${m}[${w}]`,value:h[w],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:d.validateSpec}));return l}return bc({key:m,value:h})}function GA(d){return!!d&&d.constructor===Object}function ab(d){return GA(d.value)?[]:[new Rt(d.key,d.value,`object expected, ${jr(d.value)} found`)]}const lb={"*":()=>[],array:qp,boolean:function(d){const l=d.value,h=d.key,m=jr(l);return m!=="boolean"?[new Rt(h,l,`boolean expected, ${m} found`)]:[]},number:Wd,color:Kd,constants:NA,enum:pu,filter:wh,function:Yp,layer:$A,object:Po,source:ib,light:Xd,sky:jA,terrain:sb,projection:function(d){const l=d.value,h=d.styleSpec,m=h.projection,_=d.style,x=jr(l);if(l===void 0)return[];if(x!=="object")return[new Rt("projection",l,`object expected, ${x} found`)];let w=[];for(const E in l)w=w.concat(m[E]?d.validateSpec({key:E,value:l[E],valueSpec:m[E],style:_,styleSpec:h}):[new Rt(E,l[E],`unknown property "${E}"`)]);return w},projectionDefinition:function(d){const l=d.key;let h=d.value;h=h instanceof String?h.valueOf():h;const m=jr(h);return m!=="array"||function(_){return Array.isArray(_)&&_.length===3&&typeof _[0]=="string"&&typeof _[1]=="string"&&typeof _[2]=="number"}(h)||function(_){return!!["interpolate","step","literal"].includes(_[0])}(h)?["array","string"].includes(m)?[]:[new Rt(l,h,`projection expected, invalid type "${m}" found`)]:[new Rt(l,h,`projection expected, invalid array ${JSON.stringify(h)} found`)]},string:bc,formatted:function(d){return bc(d).length===0?[]:yc(d)},resolvedImage:function(d){return bc(d).length===0?[]:yc(d)},padding:function(d){const l=d.key,h=d.value;if(jr(h)==="array"){if(h.length<1||h.length>4)return[new Rt(l,h,`padding requires 1 to 4 values; ${h.length} values found`)];const m={type:"number"};let _=[];for(let x=0;x<h.length;x++)_=_.concat(d.validateSpec({key:`${l}[${x}]`,value:h[x],validateSpec:d.validateSpec,valueSpec:m}));return _}return Wd({key:l,value:h,valueSpec:{}})},numberArray:function(d){const l=d.key,h=d.value;if(jr(h)==="array"){const m={type:"number"};if(h.length<1)return[new Rt(l,h,"array length at least 1 expected, length 0 found")];let _=[];for(let x=0;x<h.length;x++)_=_.concat(d.validateSpec({key:`${l}[${x}]`,value:h[x],validateSpec:d.validateSpec,valueSpec:m}));return _}return Wd({key:l,value:h,valueSpec:{}})},colorArray:function(d){const l=d.key,h=d.value;if(jr(h)==="array"){if(h.length<1)return[new Rt(l,h,"array length at least 1 expected, length 0 found")];let m=[];for(let _=0;_<h.length;_++)m=m.concat(Kd({key:`${l}[${_}]`,value:h[_]}));return m}return Kd({key:l,value:h})},variableAnchorOffsetCollection:function(d){const l=d.key,h=d.value,m=jr(h),_=d.styleSpec;if(m!=="array"||h.length<1||h.length%2!=0)return[new Rt(l,h,"variableAnchorOffsetCollection requires a non-empty array of even length")];let x=[];for(let w=0;w<h.length;w+=2)x=x.concat(pu({key:`${l}[${w}]`,value:h[w],valueSpec:_.layout_symbol["text-anchor"]})),x=x.concat(qp({key:`${l}[${w+1}]`,value:h[w+1],valueSpec:{length:2,value:"number"},validateSpec:d.validateSpec,style:d.style,styleSpec:_}));return x},sprite:ob,state:ab,fontFaces:function(d){const l=d.key,h=d.value,m=d.validateSpec,_=d.styleSpec,x=d.style;if(!GA(h))return[new Rt(l,h,`object expected, ${jr(h)} found`)];const w=[];for(const E in h){const B=h[E],O=jr(B);if(O==="string")w.push(...bc({key:`${l}.${E}`,value:B}));else if(O==="array"){const N={url:{type:"string",required:!0},"unicode-range":{type:"array",value:"string"}};for(const[U,G]of B.entries())w.push(...Po({key:`${l}.${E}[${U}]`,value:G,valueSpec:N,styleSpec:_,style:x,validateSpec:m}))}else w.push(new Rt(`${l}.${E}`,B,`string or array expected, ${O} found`))}return w}};function _c(d){const l=d.value,h=d.valueSpec,m=d.styleSpec;return d.validateSpec=_c,h.expression&&Gp(Ci(l))?Yp(d):h.expression&&xh(fu(l))?yc(d):h.type&&lb[h.type]?lb[h.type](d):Po(ns({},d,{valueSpec:h.type?m[h.type]:h}))}function HA(d){const l=d.value,h=d.key,m=bc(d);return m.length||(l.indexOf("{fontstack}")===-1&&m.push(new Rt(h,l,'"glyphs" url must include a "{fontstack}" token')),l.indexOf("{range}")===-1&&m.push(new Rt(h,l,'"glyphs" url must include a "{range}" token'))),m}function Xo(d,l=et){let h=[];return h=h.concat(_c({key:"",value:d,valueSpec:l.$root,styleSpec:l,style:d,validateSpec:_c,objectElementValidators:{glyphs:HA,"*":()=>[]}})),d.constants&&(h=h.concat(NA({key:"constants",value:d.constants}))),WA(h)}function _a(d){return function(l){return d(Object.assign({},l,{validateSpec:_c}))}}function WA(d){return[].concat(d).sort((l,h)=>l.line-h.line)}function va(d){return function(...l){return WA(d.apply(this,l))}}Xo.source=va(_a(ib)),Xo.sprite=va(_a(ob)),Xo.glyphs=va(_a(HA)),Xo.light=va(_a(Xd)),Xo.sky=va(_a(jA)),Xo.terrain=va(_a(sb)),Xo.state=va(_a(ab)),Xo.layer=va(_a($A)),Xo.filter=va(_a(wh)),Xo.paintProperty=va(_a(zA)),Xo.layoutProperty=va(_a(VA));const L2={type:"enum","property-type":"data-constant",expression:{interpolated:!1,parameters:["global-state"]},values:{visible:{},none:{}},transition:!1,default:"visible"};class Jd{constructor(l,h){this._globalState=h,this.setValue(l)}evaluate(){var l;return(l=this._literalValue)!==null&&l!==void 0?l:this._compiledValue.evaluate({})}setValue(l){if(l==null||l==="visible"||l==="none")return this._literalValue=l==="none"?"none":"visible",this._compiledValue=void 0,void(this._globalStateRefs=new Set);const h=$d(l,L2,this._globalState);if(h.result==="error")throw this._literalValue="visible",this._compiledValue=void 0,new Error(h.value.map(m=>`${m.key}: ${m.message}`).join(", "));this._literalValue=void 0,this._compiledValue=h.value,this._globalStateRefs=mc(h.value.expression)}getGlobalStateRefs(){return this._globalStateRefs}}const qd=et,os=Xo,Yd=os.light,KA=os.sky,N2=os.paintProperty,F2=os.layoutProperty;function Ch(d,l){let h=!1;if(l&&l.length)for(const m of l)d.fire(new Cn(new Error(m.message))),h=!0;return h}class Th{constructor(l,h,m){const _=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;const w=new Int32Array(this.arrayBuffer);l=w[0],this.d=(h=w[1])+2*(m=w[2]);for(let B=0;B<this.d*this.d;B++){const O=w[3+B],N=w[3+B+1];_.push(O===N?null:w.subarray(O,N))}const E=w[3+_.length+1];this.keys=w.subarray(w[3+_.length],E),this.bboxes=w.subarray(E),this.insert=this._insertReadonly}else{this.d=h+2*m;for(let w=0;w<this.d*this.d;w++)_.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=l,this.padding=m,this.scale=h/l,this.uid=0;const x=m/h*l;this.min=-x,this.max=l+x}insert(l,h,m,_,x){this._forEachCell(h,m,_,x,this._insertCell,this.uid++,void 0,void 0),this.keys.push(l),this.bboxes.push(h),this.bboxes.push(m),this.bboxes.push(_),this.bboxes.push(x)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(l,h,m,_,x,w){this.cells[x].push(w)}query(l,h,m,_,x){const w=this.min,E=this.max;if(l<=w&&h<=w&&E<=m&&E<=_&&!x)return Array.prototype.slice.call(this.keys);{const B=[];return this._forEachCell(l,h,m,_,this._queryCell,B,{},x),B}}_queryCell(l,h,m,_,x,w,E,B){const O=this.cells[x];if(O!==null){const N=this.keys,U=this.bboxes;for(let G=0;G<O.length;G++){const K=O[G];if(E[K]===void 0){const q=4*K;(B?B(U[q+0],U[q+1],U[q+2],U[q+3]):l<=U[q+2]&&h<=U[q+3]&&m>=U[q+0]&&_>=U[q+1])?(E[K]=!0,w.push(N[K])):E[K]=!1}}}}_forEachCell(l,h,m,_,x,w,E,B){const O=this._convertToCellCoord(l),N=this._convertToCellCoord(h),U=this._convertToCellCoord(m),G=this._convertToCellCoord(_);for(let K=O;K<=U;K++)for(let q=N;q<=G;q++){const Z=this.d*q+K;if((!B||B(this._convertFromCellCoord(K),this._convertFromCellCoord(q),this._convertFromCellCoord(K+1),this._convertFromCellCoord(q+1)))&&x.call(this,l,h,m,_,Z,w,E,B))return}}_convertFromCellCoord(l){return(l-this.padding)/this.scale}_convertToCellCoord(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const l=this.cells,h=3+this.cells.length+1+1;let m=0;for(let w=0;w<this.cells.length;w++)m+=this.cells[w].length;const _=new Int32Array(h+m+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;let x=h;for(let w=0;w<l.length;w++){const E=l[w];_[3+w]=x,_.set(E,x),x+=E.length}return _[3+l.length]=x,_.set(this.keys,x),x+=this.keys.length,_[3+l.length+1]=x,_.set(this.bboxes,x),x+=this.bboxes.length,_.buffer}static serialize(l,h){const m=l.toArrayBuffer();return h&&h.push(m),{buffer:m}}static deserialize(l){return new Th(l.buffer)}}const Aa={};function er(d,l,h={}){if(Aa[d])throw new Error(`${d} is already registered.`);Object.defineProperty(l,"_classRegistryKey",{value:d,writeable:!1}),Aa[d]={klass:l,omit:h.omit||[],shallow:h.shallow||[]}}er("Object",Object),er("Set",Set),er("TransferableGridIndex",Th),er("Color",Ur),er("Error",Error),er("AJAXError",Ue),er("ResolvedImage",Io),er("StylePropertyFunction",Wp),er("StyleExpression",Qy,{omit:["_evaluator"]}),er("ZoomDependentExpression",eb),er("ZoomConstantExpression",Hp),er("CompoundExpression",Ko,{omit:["_evaluate"]});for(const d in _h)_h[d]._classRegistryKey||er(`Expression_${d}`,_h[d]);function Zp(d){return d&&typeof ArrayBuffer<"u"&&(d instanceof ArrayBuffer||d.constructor&&d.constructor.name==="ArrayBuffer")}function cb(d){return d.$name||d.constructor._classRegistryKey}function Sh(d){return!function(l){if(l===null||typeof l!="object")return!1;const h=cb(l);return!(!h||h==="Object")}(d)&&(d==null||typeof d=="boolean"||typeof d=="number"||typeof d=="string"||d instanceof Boolean||d instanceof Number||d instanceof String||d instanceof Date||d instanceof RegExp||d instanceof Blob||d instanceof Error||Zp(d)||mt(d)||ArrayBuffer.isView(d)||d instanceof ImageData)}function Zd(d,l){if(Sh(d))return(Zp(d)||mt(d))&&l&&l.push(d),ArrayBuffer.isView(d)&&l&&l.push(d.buffer),d instanceof ImageData&&l&&l.push(d.data.buffer),d;if(Array.isArray(d)){const x=[];for(const w of d)x.push(Zd(w,l));return x}if(typeof d!="object")throw new Error("can't serialize object of type "+typeof d);const h=cb(d);if(!h)throw new Error(`can't serialize object of unregistered class ${d.constructor.name}`);if(!Aa[h])throw new Error(`${h} is not registered.`);const{klass:m}=Aa[h],_=m.serialize?m.serialize(d,l):{};if(m.serialize){if(l&&_===l[l.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const x in d){if(!d.hasOwnProperty(x)||Aa[h].omit.indexOf(x)>=0)continue;const w=d[x];_[x]=Aa[h].shallow.indexOf(x)>=0?w:Zd(w,l)}d instanceof Error&&(_.message=d.message)}if(_.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(_.$name=h),_}function Qd(d){if(Sh(d))return d;if(Array.isArray(d))return d.map(Qd);if(typeof d!="object")throw new Error("can't deserialize object of type "+typeof d);const l=cb(d)||"Object";if(!Aa[l])throw new Error(`can't deserialize unregistered class ${l}`);const{klass:h}=Aa[l];if(!h)throw new Error(`can't deserialize unregistered class ${l}`);if(h.deserialize)return h.deserialize(d);const m=Object.create(h.prototype);for(const _ of Object.keys(d)){if(_==="$name")continue;const x=d[_];m[_]=Aa[l].shallow.indexOf(_)>=0?x:Qd(x)}return m}class ub{constructor(){this.first=!0}update(l,h){const m=Math.floor(l);return this.first?(this.first=!1,this.lastIntegerZoom=m,this.lastIntegerZoomTime=0,this.lastZoom=l,this.lastFloorZoom=m,!0):(this.lastFloorZoom>m?(this.lastIntegerZoom=m+1,this.lastIntegerZoomTime=h):this.lastFloorZoom<m&&(this.lastIntegerZoom=m,this.lastIntegerZoomTime=h),l!==this.lastZoom&&(this.lastZoom=l,this.lastFloorZoom=m,!0))}}function ef(d){return/[\u02EA\u02EB\u2E80-\u2FDF\u2FF0-\u303F\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FD-\u30FF\u3105-\u312F\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(d))}function hb(d){return/[\u02EA\u02EB\u1100-\u11FF\u1400-\u167F\u18B0-\u18F5\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u3007\u3012\u3013\u3020-\u302F\u3031-\u303F\u3041-\u3096\u309D-\u30FB\u30FD-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE48\uFE50-\uFE57\uFE5F-\uFE62\uFE67-\uFE6F\uFF00-\uFF07\uFF0A-\uFF0C\uFF0E-\uFF19\uFF1F-\uFF3A\uFF3C\uFF3E\uFF40-\uFF5A\uFFE0-\uFFE2\uFFE4-\uFFE7]|\uD802[\uDD80-\uDD9F]|\uD805[\uDD80-\uDDFF]|\uD806[\uDE00-\uDEBF]|\uD811[\uDC00-\uDE7F]|\uD81B[\uDFE0-\uDFE4\uDFF0-\uDFF6]|[\uD81C-\uD822\uD83D\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD30-\uDEFB]|\uD833[\uDEC0-\uDFCF]|\uD834[\uDC00-\uDDFF\uDEE0-\uDF7F]|\uD836[\uDC00-\uDEAF]|\uD83C[\uDC00-\uDE00\uDF00-\uDFFF]|\uD83E[\uDD00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(d))}function XA(d){return/\s/u.test(String.fromCodePoint(d))}function Eh(d){for(const l of d)if(hb(l.codePointAt(0)))return!0;return!1}function U2(d){for(const l of d)if(!JA(l.codePointAt(0)))return!1;return!0}function Qp(d){const l=d.map(h=>{try{return new RegExp(`\\p{sc=${h}}`,"u").source}catch{return null}}).filter(h=>h);return new RegExp(l.join("|"),"u")}const eg=Qp(["Arab","Dupl","Mong","Ougr","Syrc"]);function JA(d){return!eg.test(String.fromCodePoint(d))}function db(d){return!(hb(d)||(l=d,/[\xA7\xA9\xAE\xB1\xBC-\xBE\xD7\xF7\u2016\u2020\u2021\u2030\u2031\u203B\u203C\u2042\u2047-\u2049\u2051\u2100-\u218F\u221E\u2234\u2235\u2300-\u2307\u230C-\u231F\u2324-\u2328\u232B\u237D-\u239A\u23BE-\u23CD\u23CF\u23D1-\u23DB\u23E2-\u2422\u2424-\u24FF\u25A0-\u2619\u2620-\u2767\u2776-\u2793\u2B12-\u2B2F\u2B50-\u2B59\u2BB8-\u2BEB\u3000-\u303F\u30A0-\u30FF\uE000-\uF8FF\uFE30-\uFE6F\uFF00-\uFFEF\uFFFC\uFFFD]|[\uDB80-\uDBFF][\uDC00-\uDFFF]/gim.test(String.fromCodePoint(l))));var l}const qA=Qp(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function fb(d){return qA.test(String.fromCodePoint(d))}function pb(d,l){return!(!l&&fb(d)||/[\u0900-\u0DFF\u0F00-\u109F\u1780-\u17FF]/gim.test(String.fromCodePoint(d)))}function YA(d){for(const l of d)if(fb(l.codePointAt(0)))return!0;return!1}const vc=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(d){this.pluginStatus=d.pluginStatus,this.pluginURL=d.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(d){if(vc.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=d.applyArabicShaping,this.processBidirectionalText=d.processBidirectionalText,this.processStyledBidirectionalText=d.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(d,l){return o(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(d.pluginStatus!=="loading")return this.setState(d),d;const h=d.pluginURL,m=new Promise(x=>{this.loadScriptResolve=x});l(h);const _=new Promise(x=>setTimeout(()=>x(),this.TIMEOUT));if(yield Promise.race([m,_]),this.isParsed()){const x={pluginStatus:"loaded",pluginURL:h};return this.setState(x),x}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${h}`)})}};class kn{constructor(l,h){this.isSupportedScript=z2,this.zoom=l,h?(this.now=h.now||0,this.fadeDuration=h.fadeDuration||0,this.zoomHistory=h.zoomHistory||new ub,this.transition=h.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ub,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const l=this.zoom,h=l-Math.floor(l),m=this.crossFadingFactor();return l>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:h+(1-h)*m}:{fromScale:.5,toScale:1,t:1-(1-m)*h}}}function z2(d){return function(l,h){for(const m of l)if(!pb(m.codePointAt(0),h))return!1;return!0}(d,vc.getRTLTextPluginStatus()==="loaded")}const tf="-transition";class tg{constructor(l,h,m){this.property=l,this.value=h,this.expression=function(_,x,w){if(Gp(_))return new Wp(_,x);if(xh(_)){const E=tb(_,x,w);if(E.result==="error")throw new Error(E.value.map(B=>`${B.key}: ${B.message}`).join(", "));return E.value}{let E=_;return x.type==="color"&&typeof _=="string"?E=Ur.parse(_):x.type!=="padding"||typeof _!="number"&&!Array.isArray(_)?x.type!=="numberArray"||typeof _!="number"&&!Array.isArray(_)?x.type!=="colorArray"||typeof _!="string"&&!Array.isArray(_)?x.type==="variableAnchorOffsetCollection"&&Array.isArray(_)?E=Ks.parse(_):x.type==="projectionDefinition"&&typeof _=="string"&&(E=Xs.parse(_)):E=_r.parse(_):E=Zr.parse(_):E=pr.parse(_),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>E}}}(h===void 0?l.specification.default:h,l.specification,m)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(l,h,m){return this.property.possiblyEvaluate(this,l,h,m)}}class rg{constructor(l,h){this.property=l,this.value=new tg(l,void 0,h)}transitioned(l,h){return new ZA(this.property,this.value,h,Mn({},l.transition,this.transition),l.now)}untransitioned(){return new ZA(this.property,this.value,null,{},0)}}class gb{constructor(l,h){this._properties=l,this._values=Object.create(l.defaultTransitionablePropertyValues),this._globalState=h}getValue(l){return fr(this._values[l].value.value)}setValue(l,h){Object.prototype.hasOwnProperty.call(this._values,l)||(this._values[l]=new rg(this._values[l].property,this._globalState)),this._values[l].value=new tg(this._values[l].property,h===null?void 0:fr(h),this._globalState)}getTransition(l){return fr(this._values[l].transition)}setTransition(l,h){Object.prototype.hasOwnProperty.call(this._values,l)||(this._values[l]=new rg(this._values[l].property,this._globalState)),this._values[l].transition=fr(h)||void 0}serialize(){const l={};for(const h of Object.keys(this._values)){const m=this.getValue(h);m!==void 0&&(l[h]=m);const _=this.getTransition(h);_!==void 0&&(l[`${h}${tf}`]=_)}return l}transitioned(l,h){const m=new QA(this._properties);for(const _ of Object.keys(this._values))m._values[_]=this._values[_].transitioned(l,h._values[_]);return m}untransitioned(){const l=new QA(this._properties);for(const h of Object.keys(this._values))l._values[h]=this._values[h].untransitioned();return l}}class ZA{constructor(l,h,m,_,x){this.property=l,this.value=h,this.begin=x+_.delay||0,this.end=this.begin+_.duration||0,l.specification.transition&&(_.delay||_.duration)&&(this.prior=m)}possiblyEvaluate(l,h,m){const _=l.now||0,x=this.value.possiblyEvaluate(l,h,m),w=this.prior;if(w){if(_>this.end)return this.prior=null,x;if(this.value.isDataDriven())return this.prior=null,x;if(_<this.begin)return w.possiblyEvaluate(l,h,m);{const E=(_-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(l,h,m),x,Xn(E))}}return x}}class QA{constructor(l){this._properties=l,this._values=Object.create(l.defaultTransitioningPropertyValues)}possiblyEvaluate(l,h,m){const _=new rf(this._properties);for(const x of Object.keys(this._values))_._values[x]=this._values[x].possiblyEvaluate(l,h,m);return _}hasTransition(){for(const l of Object.keys(this._values))if(this._values[l].prior)return!0;return!1}}class e1{constructor(l,h){this._properties=l,this._values=Object.create(l.defaultPropertyValues),this._globalState=h}hasValue(l){return this._values[l].value!==void 0}getValue(l){return fr(this._values[l].value)}setValue(l,h){this._values[l]=new tg(this._values[l].property,h===null?void 0:fr(h),this._globalState)}serialize(){const l={};for(const h of Object.keys(this._values)){const m=this.getValue(h);m!==void 0&&(l[h]=m)}return l}possiblyEvaluate(l,h,m){const _=new rf(this._properties);for(const x of Object.keys(this._values))_._values[x]=this._values[x].possiblyEvaluate(l,h,m);return _}}class xa{constructor(l,h,m){this.property=l,this.value=h,this.parameters=m}isConstant(){return this.value.kind==="constant"}constantOr(l){return this.value.kind==="constant"?this.value.value:l}evaluate(l,h,m,_){return this.property.evaluate(this.value,this.parameters,l,h,m,_)}}class rf{constructor(l){this._properties=l,this._values=Object.create(l.defaultPossiblyEvaluatedValues)}get(l){return this._values[l]}}class hr{constructor(l){this.specification=l}possiblyEvaluate(l,h){if(l.isDataDriven())throw new Error("Value should not be data driven");return l.expression.evaluate(h)}interpolate(l,h,m){const _=ii[this.specification.type];return _?_(l,h,m):l}}class Ar{constructor(l,h){this.specification=l,this.overrides=h}possiblyEvaluate(l,h,m,_){return new xa(this,l.expression.kind==="constant"||l.expression.kind==="camera"?{kind:"constant",value:l.expression.evaluate(h,null,{},m,_)}:l.expression,h)}interpolate(l,h,m){if(l.value.kind!=="constant"||h.value.kind!=="constant")return l;if(l.value.value===void 0||h.value.value===void 0)return new xa(this,{kind:"constant",value:void 0},l.parameters);const _=ii[this.specification.type];if(_){const x=_(l.value.value,h.value.value,m);return new xa(this,{kind:"constant",value:x},l.parameters)}return l}evaluate(l,h,m,_,x,w){return l.kind==="constant"?l.value:l.evaluate(h,m,_,x,w)}}class nf extends Ar{possiblyEvaluate(l,h,m,_){if(l.value===void 0)return new xa(this,{kind:"constant",value:void 0},h);if(l.expression.kind==="constant"){const x=l.expression.evaluate(h,null,{},m,_),w=l.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,E=this._calculate(w,w,w,h);return new xa(this,{kind:"constant",value:E},h)}if(l.expression.kind==="camera"){const x=this._calculate(l.expression.evaluate({zoom:h.zoom-1}),l.expression.evaluate({zoom:h.zoom}),l.expression.evaluate({zoom:h.zoom+1}),h);return new xa(this,{kind:"constant",value:x},h)}return new xa(this,l.expression,h)}evaluate(l,h,m,_,x,w){if(l.kind==="source"){const E=l.evaluate(h,m,_,x,w);return this._calculate(E,E,E,h)}return l.kind==="composite"?this._calculate(l.evaluate({zoom:Math.floor(h.zoom)-1},m,_),l.evaluate({zoom:Math.floor(h.zoom)},m,_),l.evaluate({zoom:Math.floor(h.zoom)+1},m,_),h):l.value}_calculate(l,h,m,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:l,to:h}:{from:m,to:h}}interpolate(l){return l}}class ng{constructor(l){this.specification=l}possiblyEvaluate(l,h,m,_){if(l.value!==void 0){if(l.expression.kind==="constant"){const x=l.expression.evaluate(h,null,{},m,_);return this._calculate(x,x,x,h)}return this._calculate(l.expression.evaluate(new kn(Math.floor(h.zoom-1),h)),l.expression.evaluate(new kn(Math.floor(h.zoom),h)),l.expression.evaluate(new kn(Math.floor(h.zoom+1),h)),h)}}_calculate(l,h,m,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:l,to:h}:{from:m,to:h}}interpolate(l){return l}}class ig{constructor(l){this.specification=l}possiblyEvaluate(l,h,m,_){return!!l.expression.evaluate(h,null,{},m,_)}interpolate(){return!1}}class qs{constructor(l){this.properties=l,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const h in l){const m=l[h];m.specification.overridable&&this.overridableProperties.push(h);const _=this.defaultPropertyValues[h]=new tg(m,void 0,void 0),x=this.defaultTransitionablePropertyValues[h]=new rg(m,void 0);this.defaultTransitioningPropertyValues[h]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=_.possiblyEvaluate({})}}}er("DataDrivenProperty",Ar),er("DataConstantProperty",hr),er("CrossFadedDataDrivenProperty",nf),er("CrossFadedProperty",ng),er("ColorRampProperty",ig);class Jo extends ln{constructor(l,h,m){if(super(),this.id=l.id,this.type=l.type,this._globalState=m,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},l.type!=="custom"&&(this.metadata=l.metadata,this.minzoom=l.minzoom,this.maxzoom=l.maxzoom,this._visibilityExpression=function(_,x){return new Jd(_,x)}(this.visibility,m),l.type!=="background"&&(this.source=l.source,this.sourceLayer=l["source-layer"],this.filter=l.filter,this._featureFilter=jd(l.filter,m)),h.layout&&(this._unevaluatedLayout=new e1(h.layout,m)),h.paint)){this._transitionablePaint=new gb(h.paint,m);for(const _ in l.paint)this.setPaintProperty(_,l.paint[_],{validate:!1});for(const _ in l.layout)this.setLayoutProperty(_,l.layout[_],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new rf(h.paint)}}setFilter(l){this.filter=l,this._featureFilter=jd(l,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(l){return l==="visibility"?this.visibility:this._unevaluatedLayout.getValue(l)}getLayoutAffectingGlobalStateRefs(){const l=new Set;for(const h of this._visibilityExpression.getGlobalStateRefs())l.add(h);if(this._unevaluatedLayout)for(const h in this._unevaluatedLayout._values){const m=this._unevaluatedLayout._values[h];for(const _ of m.getGlobalStateRefs())l.add(_)}for(const h of this._featureFilter.getGlobalStateRefs())l.add(h);return l}getPaintAffectingGlobalStateRefs(){var l;const h=new globalThis.Map;if(this._transitionablePaint)for(const m in this._transitionablePaint._values){const _=this._transitionablePaint._values[m].value;for(const x of _.getGlobalStateRefs()){const w=(l=h.get(x))!==null&&l!==void 0?l:[];w.push({name:m,value:_.value}),h.set(x,w)}}return h}getVisibilityAffectingGlobalStateRefs(){return this._visibilityExpression.getGlobalStateRefs()}setLayoutProperty(l,h,m={}){if(h==null||!this._validate(F2,`layers.${this.id}.layout.${l}`,l,h,m))return l==="visibility"?(this.visibility=h,this._visibilityExpression.setValue(h),void this.recalculateVisibility()):void this._unevaluatedLayout.setValue(l,h)}getPaintProperty(l){return l.endsWith(tf)?this._transitionablePaint.getTransition(l.slice(0,-11)):this._transitionablePaint.getValue(l)}setPaintProperty(l,h,m={}){if(h!=null&&this._validate(N2,`layers.${this.id}.paint.${l}`,l,h,m))return!1;if(l.endsWith(tf))return this._transitionablePaint.setTransition(l.slice(0,-11),h||void 0),!1;{const _=this._transitionablePaint._values[l],x=_.property.specification["property-type"]==="cross-faded-data-driven",w=_.value.isDataDriven(),E=_.value;this._transitionablePaint.setValue(l,h),this._handleSpecialPaintPropertyUpdate(l);const B=this._transitionablePaint._values[l].value;return B.isDataDriven()||w||x||this._handleOverridablePaintPropertyUpdate(l,E,B)}}_handleSpecialPaintPropertyUpdate(l){}_handleOverridablePaintPropertyUpdate(l,h,m){return!1}isHidden(l=this.minzoom,h=!1){return!!(this.minzoom&&l<(h?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&l>=this.maxzoom)||this._evaluatedVisibility==="none"}updateTransitions(l){this._transitioningPaint=this._transitionablePaint.transitioned(l,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculateVisibility(){this._evaluatedVisibility=this._visibilityExpression.evaluate()}recalculate(l,h){l.getCrossfadeParameters&&(this._crossfadeParameters=l.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(l,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(l,void 0,h)}serialize(){const l={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(l.layout=l.layout||{},l.layout.visibility=this.visibility),nr(l,(h,m)=>!(h===void 0||m==="layout"&&!Object.keys(h).length||m==="paint"&&!Object.keys(h).length))}_validate(l,h,m,_,x={}){return(!x||x.validate!==!1)&&Ch(this,l.call(os,{key:h,layerType:this.type,objectKey:m,value:_,styleSpec:et,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const l in this.paint._values){const h=this.paint.get(l);if(h instanceof xa&&Ah(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1}}let mb;var t1={get paint(){return mb=mb||new qs({"raster-opacity":new hr(et.paint_raster["raster-opacity"]),"raster-hue-rotate":new hr(et.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new hr(et.paint_raster["raster-brightness-min"]),"raster-brightness-max":new hr(et.paint_raster["raster-brightness-max"]),"raster-saturation":new hr(et.paint_raster["raster-saturation"]),"raster-contrast":new hr(et.paint_raster["raster-contrast"]),"raster-resampling":new hr(et.paint_raster["raster-resampling"]),"raster-fade-duration":new hr(et.paint_raster["raster-fade-duration"])})}};class V2 extends Jo{constructor(l,h){super(l,t1,h)}}const $2={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class sf{constructor(l,h){this._structArray=l,this._pos1=h*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class di{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(l,h){return l._trim(),h&&(l.isTransferred=!0,h.push(l.arrayBuffer)),{length:l.length,arrayBuffer:l.arrayBuffer}}static deserialize(l){const h=Object.create(this.prototype);return h.arrayBuffer=l.arrayBuffer,h.length=l.length,h.capacity=l.arrayBuffer.byteLength/h.bytesPerElement,h._refreshViews(),h}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(l){this.reserve(l),this.length=l}reserve(l){if(l>this.capacity){this.capacity=Math.max(l,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const h=this.uint8;this._refreshViews(),h&&this.uint8.set(h)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Ti(d,l=1){let h=0,m=0;return{members:d.map(_=>{const x=$2[_.type].BYTES_PER_ELEMENT,w=h=gu(h,Math.max(l,x)),E=_.components||1;return m=Math.max(m,x),h+=x*E,{name:_.name,type:_.type,components:E,offset:w}}),size:gu(h,Math.max(m,l)),alignment:l}}function gu(d,l){return Math.ceil(d/l)*l}class of extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h){const m=this.length;return this.resize(m+1),this.emplace(m,l,h)}emplace(l,h,m){const _=2*l;return this.int16[_+0]=h,this.int16[_+1]=m,l}}of.prototype.bytesPerElement=4,er("StructArrayLayout2i4",of);class sg extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,m){const _=this.length;return this.resize(_+1),this.emplace(_,l,h,m)}emplace(l,h,m,_){const x=3*l;return this.int16[x+0]=h,this.int16[x+1]=m,this.int16[x+2]=_,l}}sg.prototype.bytesPerElement=6,er("StructArrayLayout3i6",sg);class yb extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,m,_){const x=this.length;return this.resize(x+1),this.emplace(x,l,h,m,_)}emplace(l,h,m,_,x){const w=4*l;return this.int16[w+0]=h,this.int16[w+1]=m,this.int16[w+2]=_,this.int16[w+3]=x,l}}yb.prototype.bytesPerElement=8,er("StructArrayLayout4i8",yb);class og extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,m,_,x,w){const E=this.length;return this.resize(E+1),this.emplace(E,l,h,m,_,x,w)}emplace(l,h,m,_,x,w,E){const B=6*l;return this.int16[B+0]=h,this.int16[B+1]=m,this.int16[B+2]=_,this.int16[B+3]=x,this.int16[B+4]=w,this.int16[B+5]=E,l}}og.prototype.bytesPerElement=12,er("StructArrayLayout2i4i12",og);class bb extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,m,_,x,w){const E=this.length;return this.resize(E+1),this.emplace(E,l,h,m,_,x,w)}emplace(l,h,m,_,x,w,E){const B=4*l,O=8*l;return this.int16[B+0]=h,this.int16[B+1]=m,this.uint8[O+4]=_,this.uint8[O+5]=x,this.uint8[O+6]=w,this.uint8[O+7]=E,l}}bb.prototype.bytesPerElement=8,er("StructArrayLayout2i4ub8",bb);class af extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h){const m=this.length;return this.resize(m+1),this.emplace(m,l,h)}emplace(l,h,m){const _=2*l;return this.float32[_+0]=h,this.float32[_+1]=m,l}}af.prototype.bytesPerElement=8,er("StructArrayLayout2f8",af);class El extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,m,_,x,w,E,B,O,N){const U=this.length;return this.resize(U+1),this.emplace(U,l,h,m,_,x,w,E,B,O,N)}emplace(l,h,m,_,x,w,E,B,O,N,U){const G=10*l;return this.uint16[G+0]=h,this.uint16[G+1]=m,this.uint16[G+2]=_,this.uint16[G+3]=x,this.uint16[G+4]=w,this.uint16[G+5]=E,this.uint16[G+6]=B,this.uint16[G+7]=O,this.uint16[G+8]=N,this.uint16[G+9]=U,l}}El.prototype.bytesPerElement=20,er("StructArrayLayout10ui20",El);class ag extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,m,_,x,w,E,B){const O=this.length;return this.resize(O+1),this.emplace(O,l,h,m,_,x,w,E,B)}emplace(l,h,m,_,x,w,E,B,O){const N=8*l;return this.uint16[N+0]=h,this.uint16[N+1]=m,this.uint16[N+2]=_,this.uint16[N+3]=x,this.uint16[N+4]=w,this.uint16[N+5]=E,this.uint16[N+6]=B,this.uint16[N+7]=O,l}}ag.prototype.bytesPerElement=16,er("StructArrayLayout8ui16",ag);class lf extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,m,_,x,w,E,B,O,N,U,G){const K=this.length;return this.resize(K+1),this.emplace(K,l,h,m,_,x,w,E,B,O,N,U,G)}emplace(l,h,m,_,x,w,E,B,O,N,U,G,K){const q=12*l;return this.int16[q+0]=h,this.int16[q+1]=m,this.int16[q+2]=_,this.int16[q+3]=x,this.uint16[q+4]=w,this.uint16[q+5]=E,this.uint16[q+6]=B,this.uint16[q+7]=O,this.int16[q+8]=N,this.int16[q+9]=U,this.int16[q+10]=G,this.int16[q+11]=K,l}}lf.prototype.bytesPerElement=24,er("StructArrayLayout4i4ui4i24",lf);class lg extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,m){const _=this.length;return this.resize(_+1),this.emplace(_,l,h,m)}emplace(l,h,m,_){const x=3*l;return this.float32[x+0]=h,this.float32[x+1]=m,this.float32[x+2]=_,l}}lg.prototype.bytesPerElement=12,er("StructArrayLayout3f12",lg);class cf extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(l){const h=this.length;return this.resize(h+1),this.emplace(h,l)}emplace(l,h){return this.uint32[1*l+0]=h,l}}cf.prototype.bytesPerElement=4,er("StructArrayLayout1ul4",cf);class _b extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,m,_,x,w,E,B,O){const N=this.length;return this.resize(N+1),this.emplace(N,l,h,m,_,x,w,E,B,O)}emplace(l,h,m,_,x,w,E,B,O,N){const U=10*l,G=5*l;return this.int16[U+0]=h,this.int16[U+1]=m,this.int16[U+2]=_,this.int16[U+3]=x,this.int16[U+4]=w,this.int16[U+5]=E,this.uint32[G+3]=B,this.uint16[U+8]=O,this.uint16[U+9]=N,l}}_b.prototype.bytesPerElement=20,er("StructArrayLayout6i1ul2ui20",_b);class Ih extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,m,_,x,w){const E=this.length;return this.resize(E+1),this.emplace(E,l,h,m,_,x,w)}emplace(l,h,m,_,x,w,E){const B=6*l;return this.int16[B+0]=h,this.int16[B+1]=m,this.int16[B+2]=_,this.int16[B+3]=x,this.int16[B+4]=w,this.int16[B+5]=E,l}}Ih.prototype.bytesPerElement=12,er("StructArrayLayout2i2i2i12",Ih);class mu extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,m,_,x){const w=this.length;return this.resize(w+1),this.emplace(w,l,h,m,_,x)}emplace(l,h,m,_,x,w){const E=4*l,B=8*l;return this.float32[E+0]=h,this.float32[E+1]=m,this.float32[E+2]=_,this.int16[B+6]=x,this.int16[B+7]=w,l}}mu.prototype.bytesPerElement=16,er("StructArrayLayout2f1f2i16",mu);class vb extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,m,_,x,w){const E=this.length;return this.resize(E+1),this.emplace(E,l,h,m,_,x,w)}emplace(l,h,m,_,x,w,E){const B=16*l,O=4*l,N=8*l;return this.uint8[B+0]=h,this.uint8[B+1]=m,this.float32[O+1]=_,this.float32[O+2]=x,this.int16[N+6]=w,this.int16[N+7]=E,l}}vb.prototype.bytesPerElement=16,er("StructArrayLayout2ub2f2i16",vb);class uf extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,m){const _=this.length;return this.resize(_+1),this.emplace(_,l,h,m)}emplace(l,h,m,_){const x=3*l;return this.uint16[x+0]=h,this.uint16[x+1]=m,this.uint16[x+2]=_,l}}uf.prototype.bytesPerElement=6,er("StructArrayLayout3ui6",uf);class yu extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,m,_,x,w,E,B,O,N,U,G,K,q,Z,ee,ue){const xe=this.length;return this.resize(xe+1),this.emplace(xe,l,h,m,_,x,w,E,B,O,N,U,G,K,q,Z,ee,ue)}emplace(l,h,m,_,x,w,E,B,O,N,U,G,K,q,Z,ee,ue,xe){const fe=24*l,pe=12*l,Te=48*l;return this.int16[fe+0]=h,this.int16[fe+1]=m,this.uint16[fe+2]=_,this.uint16[fe+3]=x,this.uint32[pe+2]=w,this.uint32[pe+3]=E,this.uint32[pe+4]=B,this.uint16[fe+10]=O,this.uint16[fe+11]=N,this.uint16[fe+12]=U,this.float32[pe+7]=G,this.float32[pe+8]=K,this.uint8[Te+36]=q,this.uint8[Te+37]=Z,this.uint8[Te+38]=ee,this.uint32[pe+10]=ue,this.int16[fe+22]=xe,l}}yu.prototype.bytesPerElement=48,er("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",yu);class Ab extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,m,_,x,w,E,B,O,N,U,G,K,q,Z,ee,ue,xe,fe,pe,Te,Oe,Ze,xt,ht,Ct,Vt,Et){const bt=this.length;return this.resize(bt+1),this.emplace(bt,l,h,m,_,x,w,E,B,O,N,U,G,K,q,Z,ee,ue,xe,fe,pe,Te,Oe,Ze,xt,ht,Ct,Vt,Et)}emplace(l,h,m,_,x,w,E,B,O,N,U,G,K,q,Z,ee,ue,xe,fe,pe,Te,Oe,Ze,xt,ht,Ct,Vt,Et,bt){const at=32*l,Yt=16*l;return this.int16[at+0]=h,this.int16[at+1]=m,this.int16[at+2]=_,this.int16[at+3]=x,this.int16[at+4]=w,this.int16[at+5]=E,this.int16[at+6]=B,this.int16[at+7]=O,this.uint16[at+8]=N,this.uint16[at+9]=U,this.uint16[at+10]=G,this.uint16[at+11]=K,this.uint16[at+12]=q,this.uint16[at+13]=Z,this.uint16[at+14]=ee,this.uint16[at+15]=ue,this.uint16[at+16]=xe,this.uint16[at+17]=fe,this.uint16[at+18]=pe,this.uint16[at+19]=Te,this.uint16[at+20]=Oe,this.uint16[at+21]=Ze,this.uint16[at+22]=xt,this.uint32[Yt+12]=ht,this.float32[Yt+13]=Ct,this.float32[Yt+14]=Vt,this.uint16[at+30]=Et,this.uint16[at+31]=bt,l}}Ab.prototype.bytesPerElement=64,er("StructArrayLayout8i15ui1ul2f2ui64",Ab);class cg extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l){const h=this.length;return this.resize(h+1),this.emplace(h,l)}emplace(l,h){return this.float32[1*l+0]=h,l}}cg.prototype.bytesPerElement=4,er("StructArrayLayout1f4",cg);class ug extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,m){const _=this.length;return this.resize(_+1),this.emplace(_,l,h,m)}emplace(l,h,m,_){const x=3*l;return this.uint16[6*l+0]=h,this.float32[x+1]=m,this.float32[x+2]=_,l}}ug.prototype.bytesPerElement=12,er("StructArrayLayout1ui2f12",ug);class xb extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,m){const _=this.length;return this.resize(_+1),this.emplace(_,l,h,m)}emplace(l,h,m,_){const x=4*l;return this.uint32[2*l+0]=h,this.uint16[x+2]=m,this.uint16[x+3]=_,l}}xb.prototype.bytesPerElement=8,er("StructArrayLayout1ul2ui8",xb);class T extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h){const m=this.length;return this.resize(m+1),this.emplace(m,l,h)}emplace(l,h,m){const _=2*l;return this.uint16[_+0]=h,this.uint16[_+1]=m,l}}T.prototype.bytesPerElement=4,er("StructArrayLayout2ui4",T);class c extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l){const h=this.length;return this.resize(h+1),this.emplace(h,l)}emplace(l,h){return this.uint16[1*l+0]=h,l}}c.prototype.bytesPerElement=2,er("StructArrayLayout1ui2",c);class p extends di{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,m,_){const x=this.length;return this.resize(x+1),this.emplace(x,l,h,m,_)}emplace(l,h,m,_,x){const w=4*l;return this.float32[w+0]=h,this.float32[w+1]=m,this.float32[w+2]=_,this.float32[w+3]=x,l}}p.prototype.bytesPerElement=16,er("StructArrayLayout4f16",p);class b extends sf{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new u(this.anchorPointX,this.anchorPointY)}}b.prototype.size=20;class v extends _b{get(l){return new b(this,l)}}er("CollisionBoxArray",v);class S extends sf{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(l){this._structArray.uint8[this._pos1+37]=l}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(l){this._structArray.uint8[this._pos1+38]=l}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(l){this._structArray.uint32[this._pos4+10]=l}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}S.prototype.size=48;class P extends yu{get(l){return new S(this,l)}}er("PlacedSymbolArray",P);class R extends sf{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(l){this._structArray.uint32[this._pos4+12]=l}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}R.prototype.size=64;class L extends Ab{get(l){return new R(this,l)}}er("SymbolInstanceArray",L);class F extends cg{getoffsetX(l){return this.float32[1*l+0]}}er("GlyphOffsetArray",F);class j extends sg{getx(l){return this.int16[3*l+0]}gety(l){return this.int16[3*l+1]}gettileUnitDistanceFromAnchor(l){return this.int16[3*l+2]}}er("SymbolLineVertexArray",j);class J extends sf{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}J.prototype.size=12;class X extends ug{get(l){return new J(this,l)}}er("TextAnchorOffsetArray",X);class Q extends sf{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Q.prototype.size=8;class ae extends xb{get(l){return new Q(this,l)}}er("FeatureIndexArray",ae);class ge extends of{}class ye extends of{}class me extends of{}class we extends og{}class De extends bb{}class Ae extends af{}class Re extends El{}class Le extends ag{}class Pe extends lf{}class $e extends lg{}class ct extends cf{}class tt extends Ih{}class it extends vb{}class st extends uf{}class Ot extends T{}const Lt=Ti([{name:"a_pos",components:2,type:"Int16"}],4),{members:St}=Lt;class Ht{constructor(l=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=l}prepareSegment(l,h,m,_){const x=this.segments[this.segments.length-1];return l>Ht.MAX_VERTEX_ARRAY_LENGTH&&Ee(`Max vertices per segment is ${Ht.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${l}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Ht.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!x||x.vertexLength+l>Ht.MAX_VERTEX_ARRAY_LENGTH||x.sortKey!==_?this.createNewSegment(h,m,_):x}createNewSegment(l,h,m){const _={vertexOffset:l.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0,vaos:{}};return m!==void 0&&(_.sortKey=m),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(_),_}getOrCreateLatestSegment(l,h,m){return this.prepareSegment(0,l,h,m)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const l of this.segments)for(const h in l.vaos)l.vaos[h].destroy()}static simpleSegment(l,h,m,_){return new Ht([{vertexOffset:l,primitiveOffset:h,vertexLength:m,primitiveLength:_,vaos:{},sortKey:0}])}}function Or(d,l){return 256*(d=Bn(Math.floor(d),0,255))+Bn(Math.floor(l),0,255)}Ht.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,er("SegmentVector",Ht);const bn=Ti([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),qn=Ti([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var zn,si,Vn,bi={exports:{}},oi={exports:{}},as={exports:{}},ki=function(){if(Vn)return bi.exports;Vn=1;var d=(zn||(zn=1,oi.exports=function(h,m){var _,x,w,E,B,O,N,U;for(x=h.length-(_=3&h.length),w=m,B=3432918353,O=461845907,U=0;U<x;)N=255&h.charCodeAt(U)|(255&h.charCodeAt(++U))<<8|(255&h.charCodeAt(++U))<<16|(255&h.charCodeAt(++U))<<24,++U,w=27492+(65535&(E=5*(65535&(w=(w^=N=(65535&(N=(N=(65535&N)*B+(((N>>>16)*B&65535)<<16)&4294967295)<<15|N>>>17))*O+(((N>>>16)*O&65535)<<16)&4294967295)<<13|w>>>19))+((5*(w>>>16)&65535)<<16)&4294967295))+((58964+(E>>>16)&65535)<<16);switch(N=0,_){case 3:N^=(255&h.charCodeAt(U+2))<<16;case 2:N^=(255&h.charCodeAt(U+1))<<8;case 1:w^=N=(65535&(N=(N=(65535&(N^=255&h.charCodeAt(U)))*B+(((N>>>16)*B&65535)<<16)&4294967295)<<15|N>>>17))*O+(((N>>>16)*O&65535)<<16)&4294967295}return w^=h.length,w=2246822507*(65535&(w^=w>>>16))+((2246822507*(w>>>16)&65535)<<16)&4294967295,w=3266489909*(65535&(w^=w>>>13))+((3266489909*(w>>>16)&65535)<<16)&4294967295,(w^=w>>>16)>>>0}),oi.exports),l=(si||(si=1,as.exports=function(h,m){for(var _,x=h.length,w=m^x,E=0;x>=4;)_=1540483477*(65535&(_=255&h.charCodeAt(E)|(255&h.charCodeAt(++E))<<8|(255&h.charCodeAt(++E))<<16|(255&h.charCodeAt(++E))<<24))+((1540483477*(_>>>16)&65535)<<16),w=1540483477*(65535&w)+((1540483477*(w>>>16)&65535)<<16)^(_=1540483477*(65535&(_^=_>>>24))+((1540483477*(_>>>16)&65535)<<16)),x-=4,++E;switch(x){case 3:w^=(255&h.charCodeAt(E+2))<<16;case 2:w^=(255&h.charCodeAt(E+1))<<8;case 1:w=1540483477*(65535&(w^=255&h.charCodeAt(E)))+((1540483477*(w>>>16)&65535)<<16)}return w=1540483477*(65535&(w^=w>>>13))+((1540483477*(w>>>16)&65535)<<16),(w^=w>>>15)>>>0}),as.exports);return bi.exports=d,bi.exports.murmur3=d,bi.exports.murmur2=l,bi.exports}(),Si=f(ki);class Ts{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(l,h,m,_){this.ids.push(Ac(l)),this.positions.push(h,m,_)}getPositions(l){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const h=Ac(l);let m=0,_=this.ids.length-1;for(;m<_;){const w=m+_>>1;this.ids[w]>=h?_=w:m=w+1}const x=[];for(;this.ids[m]===h;)x.push({index:this.positions[3*m],start:this.positions[3*m+1],end:this.positions[3*m+2]}),m++;return x}static serialize(l,h){const m=new Float64Array(l.ids),_=new Uint32Array(l.positions);return Il(m,_,0,m.length-1),h&&h.push(m.buffer,_.buffer),{ids:m,positions:_}}static deserialize(l){const h=new Ts;return h.ids=l.ids,h.positions=l.positions,h.indexed=!0,h}}function Ac(d){const l=+d;return!isNaN(l)&&l<=Number.MAX_SAFE_INTEGER?l:Si(String(d))}function Il(d,l,h,m){for(;h<m;){const _=d[h+m>>1];let x=h-1,w=m+1;for(;;){do x++;while(d[x]<_);do w--;while(d[w]>_);if(x>=w)break;tl(d,x,w),tl(l,3*x,3*w),tl(l,3*x+1,3*w+1),tl(l,3*x+2,3*w+2)}w-h<m-w?(Il(d,l,h,w),h=w+1):(Il(d,l,w+1,m),m=w)}}function tl(d,l,h){const m=d[l];d[l]=d[h],d[h]=m}er("FeaturePositionMap",Ts);class co{constructor(l,h){this.gl=l.gl,this.location=h}}class bu extends co{constructor(l,h){super(l,h),this.current=0}set(l){this.current!==l&&(this.current=l,this.gl.uniform1f(this.location,l))}}class hf extends co{constructor(l,h){super(l,h),this.current=[0,0,0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]&&l[3]===this.current[3]||(this.current=l,this.gl.uniform4f(this.location,l[0],l[1],l[2],l[3]))}}class _u extends co{constructor(l,h){super(l,h),this.current=Ur.transparent}set(l){l.r===this.current.r&&l.g===this.current.g&&l.b===this.current.b&&l.a===this.current.a||(this.current=l,this.gl.uniform4f(this.location,l.r,l.g,l.b,l.a))}}const qo=new Float32Array(16);function rl(d){return[Or(255*d.r,255*d.g),Or(255*d.b,255*d.a)]}class wa{constructor(l,h,m){this.value=l,this.uniformNames=h.map(_=>`u_${_}`),this.type=m}setUniform(l,h,m){l.set(m.constantOr(this.value))}getBinding(l,h,m){return this.type==="color"?new _u(l,h):new bu(l,h)}}class Ca{constructor(l,h){this.uniformNames=h.map(m=>`u_${m}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(l,h){this.pixelRatioFrom=h.pixelRatio,this.pixelRatioTo=l.pixelRatio,this.patternFrom=h.tlbr,this.patternTo=l.tlbr}setConstantDashPositions(l,h){this.dashTo=[0,l.y,l.height,l.width],this.dashFrom=[0,h.y,h.height,h.width]}setUniform(l,h,m,_){let x=null;_==="u_pattern_to"?x=this.patternTo:_==="u_pattern_from"?x=this.patternFrom:_==="u_dasharray_to"?x=this.dashTo:_==="u_dasharray_from"?x=this.dashFrom:_==="u_pixel_ratio_to"?x=this.pixelRatioTo:_==="u_pixel_ratio_from"&&(x=this.pixelRatioFrom),x!==null&&l.set(x)}getBinding(l,h,m){return m.substr(0,9)==="u_pattern"||m.substr(0,12)==="u_dasharray_"?new hf(l,h):new bu(l,h)}}class Hn{constructor(l,h,m,_){this.expression=l,this.type=m,this.maxValue=0,this.paintVertexAttributes=h.map(x=>({name:`a_${x}`,type:"Float32",components:m==="color"?2:1,offset:0})),this.paintVertexArray=new _}populatePaintArray(l,h,m){const _=this.paintVertexArray.length,x=this.expression.evaluate(new kn(0,m),h,{},m.canonical,[],m.formattedSection);this.paintVertexArray.resize(l),this._setPaintValue(_,l,x)}updatePaintArray(l,h,m,_,x){const w=this.expression.evaluate(new kn(0,x),m,_);this._setPaintValue(l,h,w)}_setPaintValue(l,h,m){if(this.type==="color"){const _=rl(m);for(let x=l;x<h;x++)this.paintVertexArray.emplace(x,_[0],_[1])}else{for(let _=l;_<h;_++)this.paintVertexArray.emplace(_,m);this.maxValue=Math.max(this.maxValue,Math.abs(m))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class $n{constructor(l,h,m,_,x,w){this.expression=l,this.uniformNames=h.map(E=>`u_${E}_t`),this.type=m,this.useIntegerZoom=_,this.zoom=x,this.maxValue=0,this.paintVertexAttributes=h.map(E=>({name:`a_${E}`,type:"Float32",components:m==="color"?4:2,offset:0})),this.paintVertexArray=new w}populatePaintArray(l,h,m){const _=this.expression.evaluate(new kn(this.zoom,m),h,{},m.canonical,[],m.formattedSection),x=this.expression.evaluate(new kn(this.zoom+1,m),h,{},m.canonical,[],m.formattedSection),w=this.paintVertexArray.length;this.paintVertexArray.resize(l),this._setPaintValue(w,l,_,x)}updatePaintArray(l,h,m,_,x){const w=this.expression.evaluate(new kn(this.zoom,x),m,_),E=this.expression.evaluate(new kn(this.zoom+1,x),m,_);this._setPaintValue(l,h,w,E)}_setPaintValue(l,h,m,_){if(this.type==="color"){const x=rl(m),w=rl(_);for(let E=l;E<h;E++)this.paintVertexArray.emplace(E,x[0],x[1],w[0],w[1])}else{for(let x=l;x<h;x++)this.paintVertexArray.emplace(x,m,_);this.maxValue=Math.max(this.maxValue,Math.abs(m),Math.abs(_))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(l,h){const m=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,_=Bn(this.expression.interpolationFactor(m,this.zoom,this.zoom+1),0,1);l.set(_)}getBinding(l,h,m){return new bu(l,h)}}class qi{constructor(l,h,m,_,x,w){this.expression=l,this.type=h,this.useIntegerZoom=m,this.zoom=_,this.layerId=w,this.zoomInPaintVertexArray=new x,this.zoomOutPaintVertexArray=new x}populatePaintArray(l,h,m){const _=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(l),this.zoomOutPaintVertexArray.resize(l),this._setPaintValues(_,l,this.getPositionIds(h),m)}updatePaintArray(l,h,m,_,x){this._setPaintValues(l,h,this.getPositionIds(m),x)}_setPaintValues(l,h,m,_){const x=this.getPositions(_);if(!x||!m)return;const w=x[m.min],E=x[m.mid],B=x[m.max];if(w&&E&&B)for(let O=l;O<h;O++)this.emplace(this.zoomInPaintVertexArray,O,E,w),this.emplace(this.zoomOutPaintVertexArray,O,E,B)}upload(l){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const h=this.getVertexAttributes();this.zoomInPaintVertexBuffer=l.createVertexBuffer(this.zoomInPaintVertexArray,h,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=l.createVertexBuffer(this.zoomOutPaintVertexArray,h,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Yi extends qi{getPositions(l){return l.imagePositions}getPositionIds(l){return l.patterns&&l.patterns[this.layerId]}getVertexAttributes(){return bn.members}emplace(l,h,m,_){l.emplace(h,m.tlbr[0],m.tlbr[1],m.tlbr[2],m.tlbr[3],_.tlbr[0],_.tlbr[1],_.tlbr[2],_.tlbr[3],m.pixelRatio,_.pixelRatio)}}class r1 extends qi{getPositions(l){return l.dashPositions}getPositionIds(l){return l.dashes&&l.dashes[this.layerId]}getVertexAttributes(){return qn.members}emplace(l,h,m,_){l.emplace(h,0,m.y,m.height,m.width,0,_.y,_.height,_.width)}}class n1{constructor(l,h,m){this.binders={},this._buffers=[];const _=[];for(const x in l.paint._values){if(!m(x))continue;const w=l.paint.get(x);if(!(w instanceof xa&&Ah(w.property.specification)))continue;const E=j2(x,l.type),B=w.value,O=w.property.specification.type,N=w.property.useIntegerZoom,U=w.property.specification["property-type"],G=U==="cross-faded"||U==="cross-faded-data-driven";if(B.kind==="constant")this.binders[x]=G?new Ca(B.value,E):new wa(B.value,E,O),_.push(`/u_${x}`);else if(B.kind==="source"||G){const K=i1(x,O,"source");this.binders[x]=G?x==="line-dasharray"?new r1(B,O,N,h,K,l.id):new Yi(B,O,N,h,K,l.id):new Hn(B,E,O,K),_.push(`/a_${x}`)}else{const K=i1(x,O,"composite");this.binders[x]=new $n(B,E,O,N,h,K),_.push(`/z_${x}`)}}this.cacheKey=_.sort().join("")}getMaxValue(l){const h=this.binders[l];return h instanceof Hn||h instanceof $n?h.maxValue:0}populatePaintArrays(l,h,m){for(const _ in this.binders){const x=this.binders[_];(x instanceof Hn||x instanceof $n||x instanceof qi)&&x.populatePaintArray(l,h,m)}}setConstantPatternPositions(l,h){for(const m in this.binders){const _=this.binders[m];_ instanceof Ca&&_.setConstantPatternPositions(l,h)}}setConstantDashPositions(l,h){for(const m in this.binders){const _=this.binders[m];_ instanceof Ca&&_.setConstantDashPositions(l,h)}}updatePaintArrays(l,h,m,_,x){let w=!1;for(const E in l){const B=h.getPositions(E);for(const O of B){const N=m.feature(O.index);for(const U in this.binders){const G=this.binders[U];if((G instanceof Hn||G instanceof $n||G instanceof qi)&&G.expression.isStateDependent===!0){const K=_.paint.get(U);G.expression=K.value,G.updatePaintArray(O.start,O.end,N,l[E],x),w=!0}}}}return w}defines(){const l=[];for(const h in this.binders){const m=this.binders[h];(m instanceof wa||m instanceof Ca)&&l.push(...m.uniformNames.map(_=>`#define HAS_UNIFORM_${_}`))}return l}getBinderAttributes(){const l=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof Hn||m instanceof $n)for(let _=0;_<m.paintVertexAttributes.length;_++)l.push(m.paintVertexAttributes[_].name);else if(m instanceof qi){const _=m.getVertexAttributes();for(const x of _)l.push(x.name)}}return l}getBinderUniforms(){const l=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof wa||m instanceof Ca||m instanceof $n)for(const _ of m.uniformNames)l.push(_)}return l}getPaintVertexBuffers(){return this._buffers}getUniforms(l,h){const m=[];for(const _ in this.binders){const x=this.binders[_];if(x instanceof wa||x instanceof Ca||x instanceof $n){for(const w of x.uniformNames)if(h[w]){const E=x.getBinding(l,h[w],w);m.push({name:w,property:_,binding:E})}}}return m}setUniforms(l,h,m,_){for(const{name:x,property:w,binding:E}of h)this.binders[w].setUniform(E,_,m.get(w),x)}updatePaintBuffers(l){this._buffers=[];for(const h in this.binders){const m=this.binders[h];if(l&&m instanceof qi){const _=l.fromScale===2?m.zoomInPaintVertexBuffer:m.zoomOutPaintVertexBuffer;_&&this._buffers.push(_)}else(m instanceof Hn||m instanceof $n)&&m.paintVertexBuffer&&this._buffers.push(m.paintVertexBuffer)}}upload(l){for(const h in this.binders){const m=this.binders[h];(m instanceof Hn||m instanceof $n||m instanceof qi)&&m.upload(l)}this.updatePaintBuffers()}destroy(){for(const l in this.binders){const h=this.binders[l];(h instanceof Hn||h instanceof $n||h instanceof qi)&&h.destroy()}}}class vu{constructor(l,h,m=()=>!0){this.programConfigurations={};for(const _ of l)this.programConfigurations[_.id]=new n1(_,h,m);this.needsUpload=!1,this._featureMap=new Ts,this._bufferOffset=0}populatePaintArrays(l,h,m,_){for(const x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(l,h,_);h.id!==void 0&&this._featureMap.add(h.id,m,this._bufferOffset,l),this._bufferOffset=l,this.needsUpload=!0}updatePaintArrays(l,h,m,_){for(const x of m)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(l,this._featureMap,h,x,_)||this.needsUpload}get(l){return this.programConfigurations[l]}upload(l){if(this.needsUpload){for(const h in this.programConfigurations)this.programConfigurations[h].upload(l);this.needsUpload=!1}}destroy(){for(const l in this.programConfigurations)this.programConfigurations[l].destroy()}}function j2(d,l){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[d]||[d.replace(`${l}-`,"").replace(/-/g,"_")]}function i1(d,l,h){const m={color:{source:af,composite:p},number:{source:cg,composite:af}},_=function(x){return{"line-pattern":{source:Re,composite:Re},"fill-pattern":{source:Re,composite:Re},"fill-extrusion-pattern":{source:Re,composite:Re},"line-dasharray":{source:Le,composite:Le}}[x]}(d);return _&&_[h]||m[l][h]}er("ConstantBinder",wa),er("CrossFadedConstantBinder",Ca),er("SourceExpressionBinder",Hn),er("CrossFadedPatternBinder",Yi),er("CrossFadedDasharrayBinder",r1),er("CompositeExpressionBinder",$n),er("ProgramConfiguration",n1,{omit:["_buffers"]}),er("ProgramConfigurationSet",vu);const wb=Math.pow(2,14)-1,xc=-wb-1;function wc(d){const l=Ut/d.extent,h=d.loadGeometry();for(let m=0;m<h.length;m++){const _=h[m];for(let x=0;x<_.length;x++){const w=_[x],E=Math.round(w.x*l),B=Math.round(w.y*l);w.x=Bn(E,xc,wb),w.y=Bn(B,xc,wb),(E<w.x||E>w.x+1||B<w.y||B>w.y+1)&&Ee("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return h}function Cc(d,l){return{type:d.type,id:d.id,properties:d.properties,geometry:l?wc(d):[]}}const Cb=-32768;function Tb(d,l,h,m,_){d.emplaceBack(Cb+8*l+m,Cb+8*h+_)}class hg{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(h=>h.id),this.index=l.index,this.hasDependencies=!1,this.layoutVertexArray=new ye,this.indexArray=new st,this.segments=new Ht,this.programConfigurations=new vu(l.layers,l.zoom),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(l,h,m){const _=this.layers[0],x=[];let w=null,E=!1,B=_.type==="heatmap";if(_.type==="circle"){const N=_;w=N.layout.get("circle-sort-key"),E=!w.isConstant(),B=B||N.paint.get("circle-pitch-alignment")==="map"}const O=B?h.subdivisionGranularity.circle:1;for(const{feature:N,id:U,index:G,sourceLayerIndex:K}of l){const q=this.layers[0]._featureFilter.needGeometry,Z=Cc(N,q);if(!this.layers[0]._featureFilter.filter(new kn(this.zoom),Z,m))continue;const ee=E?w.evaluate(Z,{},m):void 0,ue={id:U,properties:N.properties,type:N.type,sourceLayerIndex:K,index:G,geometry:q?Z.geometry:wc(N),patterns:{},sortKey:ee};x.push(ue)}E&&x.sort((N,U)=>N.sortKey-U.sortKey);for(const N of x){const{geometry:U,index:G,sourceLayerIndex:K}=N,q=l[G].feature;this.addFeature(N,U,G,m,O),h.featureIndex.insert(q,U,G,K,this.index)}}update(l,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,{imagePositions:m})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,St),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(l,h,m,_,x=1){let w;switch(x){case 1:w=[0,7];break;case 3:w=[0,2,5,7];break;case 5:w=[0,1,3,4,6,7];break;case 7:w=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${x}; valid values are 1, 3, 5, 7.`)}const E=w.length;for(const B of h)for(const O of B){const N=O.x,U=O.y;if(N<0||N>=Ut||U<0||U>=Ut)continue;const G=this.segments.prepareSegment(E*E,this.layoutVertexArray,this.indexArray,l.sortKey),K=G.vertexLength;for(let q=0;q<E;q++)for(let Z=0;Z<E;Z++)Tb(this.layoutVertexArray,N,U,w[Z],w[q]);for(let q=0;q<E-1;q++)for(let Z=0;Z<E-1;Z++){const ee=K+q*E+Z,ue=K+(q+1)*E+Z;this.indexArray.emplaceBack(ee,ue+1,ee+1),this.indexArray.emplaceBack(ee,ue,ue+1)}G.vertexLength+=E*E,G.primitiveLength+=(E-1)*(E-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,m,{imagePositions:{},canonical:_})}}function dg(d,l){for(let h=0;h<d.length;h++)if(fg(l,d[h]))return!0;for(let h=0;h<l.length;h++)if(fg(d,l[h]))return!0;return!!G2(d,l)}function s1(d,l,h){return!!fg(d,l)||!!H2(l,d,h)}function xL(d,l){if(d.length===1)return CL(l,d[0]);for(let h=0;h<l.length;h++){const m=l[h];for(let _=0;_<m.length;_++)if(fg(d,m[_]))return!0}for(let h=0;h<d.length;h++)if(CL(l,d[h]))return!0;for(let h=0;h<l.length;h++)if(G2(d,l[h]))return!0;return!1}function pQ(d,l,h){if(d.length>1){if(G2(d,l))return!0;for(let m=0;m<l.length;m++)if(H2(l[m],d,h))return!0}for(let m=0;m<d.length;m++)if(H2(d[m],l,h))return!0;return!1}function G2(d,l){if(d.length===0||l.length===0)return!1;for(let h=0;h<d.length-1;h++){const m=d[h],_=d[h+1];for(let x=0;x<l.length-1;x++)if(gQ(m,_,l[x],l[x+1]))return!0}return!1}function gQ(d,l,h,m){return He(d,h,m)!==He(l,h,m)&&He(d,l,h)!==He(d,l,m)}function H2(d,l,h){const m=h*h;if(l.length===1)return d.distSqr(l[0])<m;for(let _=1;_<l.length;_++)if(wL(d,l[_-1],l[_])<m)return!0;return!1}function wL(d,l,h){const m=l.distSqr(h);if(m===0)return d.distSqr(l);const _=((d.x-l.x)*(h.x-l.x)+(d.y-l.y)*(h.y-l.y))/m;return d.distSqr(_<0?l:_>1?h:h.sub(l)._mult(_)._add(l))}function CL(d,l){let h,m,_,x=!1;for(let w=0;w<d.length;w++){h=d[w];for(let E=0,B=h.length-1;E<h.length;B=E++)m=h[E],_=h[B],m.y>l.y!=_.y>l.y&&l.x<(_.x-m.x)*(l.y-m.y)/(_.y-m.y)+m.x&&(x=!x)}return x}function fg(d,l){let h=!1;for(let m=0,_=d.length-1;m<d.length;_=m++){const x=d[m],w=d[_];x.y>l.y!=w.y>l.y&&l.x<(w.x-x.x)*(l.y-x.y)/(w.y-x.y)+x.x&&(h=!h)}return h}function mQ(d,l,h){const m=h[0],_=h[2];if(d.x<m.x&&l.x<m.x||d.x>_.x&&l.x>_.x||d.y<m.y&&l.y<m.y||d.y>_.y&&l.y>_.y)return!1;const x=He(d,l,h[0]);return x!==He(d,l,h[1])||x!==He(d,l,h[2])||x!==He(d,l,h[3])}function pg(d,l,h){const m=l.paint.get(d).value;return m.kind==="constant"?m.value:h.programConfigurations.get(l.id).getMaxValue(d)}function o1(d){return Math.sqrt(d[0]*d[0]+d[1]*d[1])}function a1(d,l,h,m,_){if(!l[0]&&!l[1])return d;const x=u.convert(l)._mult(_);h==="viewport"&&x._rotate(-m);const w=[];for(let E=0;E<d.length;E++)w.push(d[E].sub(x));return w}function yQ(d){const l=[];for(let h=0;h<d.length;h++){const m=d[h],_=l.at(-1);(h===0||_&&!m.equals(_))&&l.push(m)}return l}function bQ({queryGeometry:d,size:l},h){return s1(d,h,l)}function _Q({queryGeometry:d,size:l,transform:h,unwrappedTileID:m,getElevation:_},x){return s1(d,x,l*(h.projectTileCoordinates(x.x,x.y,m,_).signedDistanceFromCamera/h.cameraToCenterDistance))}function vQ({queryGeometry:d,size:l,transform:h,unwrappedTileID:m,getElevation:_},x){const w=h.projectTileCoordinates(x.x,x.y,m,_).signedDistanceFromCamera,E=l*(h.cameraToCenterDistance/w);return s1(d,W2(x,h,m,_),E)}function AQ({queryGeometry:d,size:l,transform:h,unwrappedTileID:m,getElevation:_},x){return s1(d,W2(x,h,m,_),l)}function TL({queryGeometry:d,size:l,transform:h,unwrappedTileID:m,getElevation:_,pitchAlignment:x="map",pitchScale:w="map"},E){const B=x==="map"?w==="map"?bQ:_Q:w==="map"?vQ:AQ,O={queryGeometry:d,size:l,transform:h,unwrappedTileID:m,getElevation:_};for(const N of E)for(const U of N)if(B(O,U))return!0;return!1}function W2(d,l,h,m){const _=l.projectTileCoordinates(d.x,d.y,h,m).point;return new u((.5*_.x+.5)*l.width,(.5*-_.y+.5)*l.height)}let SL,EL;er("CircleBucket",hg,{omit:["layers"]});var xQ={get paint(){return EL=EL||new qs({"circle-radius":new Ar(et.paint_circle["circle-radius"]),"circle-color":new Ar(et.paint_circle["circle-color"]),"circle-blur":new Ar(et.paint_circle["circle-blur"]),"circle-opacity":new Ar(et.paint_circle["circle-opacity"]),"circle-translate":new hr(et.paint_circle["circle-translate"]),"circle-translate-anchor":new hr(et.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new hr(et.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new hr(et.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ar(et.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ar(et.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ar(et.paint_circle["circle-stroke-opacity"])})},get layout(){return SL=SL||new qs({"circle-sort-key":new Ar(et.layout_circle["circle-sort-key"])})}};class wQ extends Jo{constructor(l,h){super(l,xQ,h)}createBucket(l){return new hg(l)}queryRadius(l){const h=l;return pg("circle-radius",this,h)+pg("circle-stroke-width",this,h)+o1(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:l,feature:h,featureState:m,geometry:_,transform:x,pixelsToTileUnits:w,unwrappedTileID:E,getElevation:B}){const O=a1(l,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-x.bearingInRadians,w),N=this.paint.get("circle-radius").evaluate(h,m)+this.paint.get("circle-stroke-width").evaluate(h,m),U=this.paint.get("circle-pitch-scale"),G=this.paint.get("circle-pitch-alignment");let K,q;return G==="map"?(K=O,q=N*w):(K=function(Z,ee,ue,xe){return Z.map(fe=>W2(fe,ee,ue,xe))}(O,x,E,B),q=N),TL({queryGeometry:K,size:q,transform:x,unwrappedTileID:E,getElevation:B,pitchAlignment:G,pitchScale:U},_)}}class IL extends hg{}let PL;er("HeatmapBucket",IL,{omit:["layers"]});var CQ={get paint(){return PL=PL||new qs({"heatmap-radius":new Ar(et.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ar(et.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new hr(et.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ig(et.paint_heatmap["heatmap-color"]),"heatmap-opacity":new hr(et.paint_heatmap["heatmap-opacity"])})}};function K2(d,{width:l,height:h},m,_){if(_){if(_ instanceof Uint8ClampedArray)_=new Uint8Array(_.buffer);else if(_.length!==l*h*m)throw new RangeError(`mismatched image size. expected: ${_.length} but got: ${l*h*m}`)}else _=new Uint8Array(l*h*m);return d.width=l,d.height=h,d.data=_,d}function BL(d,{width:l,height:h},m){if(l===d.width&&h===d.height)return;const _=K2({},{width:l,height:h},m);X2(d,_,{x:0,y:0},{x:0,y:0},{width:Math.min(d.width,l),height:Math.min(d.height,h)},m),d.width=l,d.height=h,d.data=_.data}function X2(d,l,h,m,_,x){if(_.width===0||_.height===0)return l;if(_.width>d.width||_.height>d.height||h.x>d.width-_.width||h.y>d.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>l.width||_.height>l.height||m.x>l.width-_.width||m.y>l.height-_.height)throw new RangeError("out of range destination coordinates for image copy");const w=d.data,E=l.data;if(w===E)throw new Error("srcData equals dstData, so image is already copied");for(let B=0;B<_.height;B++){const O=((h.y+B)*d.width+h.x)*x,N=((m.y+B)*l.width+m.x)*x;for(let U=0;U<_.width*x;U++)E[N+U]=w[O+U]}return l}class Sb{constructor(l,h){K2(this,l,1,h)}resize(l){BL(this,l,1)}clone(){return new Sb({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,h,m,_,x){X2(l,h,m,_,x,1)}}class Bo{constructor(l,h){K2(this,l,4,h)}resize(l){BL(this,l,4)}replace(l,h){h?this.data.set(l):this.data=l instanceof Uint8ClampedArray?new Uint8Array(l.buffer):l}clone(){return new Bo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,h,m,_,x){X2(l,h,m,_,x,4)}setPixel(l,h,m){const _=4*(l*this.width+h);this.data[_+0]=Math.round(255*m.r/m.a),this.data[_+1]=Math.round(255*m.g/m.a),this.data[_+2]=Math.round(255*m.b/m.a),this.data[_+3]=Math.round(255*m.a)}}function ML(d){const l={},h=d.resolution||256,m=d.clips?d.clips.length:1,_=d.image||new Bo({width:h,height:m});if(Math.log(h)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${h}`);const x=(w,E,B)=>{l[d.evaluationKey]=B;const O=d.expression.evaluate(l);_.setPixel(w/4/h,E/4,O)};if(d.clips)for(let w=0,E=0;w<m;++w,E+=4*h)for(let B=0,O=0;B<h;B++,O+=4){const N=B/(h-1),{start:U,end:G}=d.clips[w];x(E,O,U*(1-N)+G*N)}else for(let w=0,E=0;w<h;w++,E+=4)x(0,E,w/(h-1));return _}er("AlphaImage",Sb),er("RGBAImage",Bo);const J2="big-fb";class TQ extends Jo{createBucket(l){return new IL(l)}constructor(l,h){super(l,CQ,h),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=ML({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(J2)&&this.heatmapFbos.delete(J2)}queryRadius(l){return pg("heatmap-radius",this,l)}queryIntersectsFeature({queryGeometry:l,feature:h,featureState:m,geometry:_,transform:x,pixelsToTileUnits:w,unwrappedTileID:E,getElevation:B}){return TL({queryGeometry:l,size:this.paint.get("heatmap-radius").evaluate(h,m)*w,transform:x,unwrappedTileID:E,getElevation:B},_)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&!this.isHidden()}}let RL;var SQ={get paint(){return RL=RL||new qs({"hillshade-illumination-direction":new hr(et.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new hr(et.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new hr(et.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new hr(et.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new hr(et.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new hr(et.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new hr(et.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new hr(et.paint_hillshade["hillshade-method"])})}};class EQ extends Jo{constructor(l,h){super(l,SQ,h),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let l=this.paint.get("hillshade-illumination-direction").values,h=this.paint.get("hillshade-illumination-altitude").values,m=this.paint.get("hillshade-highlight-color").values,_=this.paint.get("hillshade-shadow-color").values;const x=Math.max(l.length,h.length,m.length,_.length);l=l.concat(Array(x-l.length).fill(l.at(-1))),h=h.concat(Array(x-h.length).fill(h.at(-1))),m=m.concat(Array(x-m.length).fill(m.at(-1))),_=_.concat(Array(x-_.length).fill(_.at(-1)));const w=h.map(Qt);return{directionRadians:l.map(Qt),altitudeRadians:w,shadowColor:_,highlightColor:m}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&!this.isHidden()}}let kL;var IQ={get paint(){return kL=kL||new qs({"color-relief-opacity":new hr(et["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new ig(et["paint_color-relief"]["color-relief-color"])})}};class q2{constructor(l,h,m,_){this.context=l,this.format=m,this.texture=l.gl.createTexture(),this.update(h,_)}update(l,h,m){const{width:_,height:x}=l,w=!(this.size&&this.size[0]===_&&this.size[1]===x||m),{context:E}=this,{gl:B}=E;if(this.useMipmap=!!(h&&h.useMipmap),B.bindTexture(B.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1),E.pixelStoreUnpackPremultiplyAlpha.set(this.format===B.RGBA&&(!h||h.premultiply!==!1)),w)this.size=[_,x],l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||mt(l)?B.texImage2D(B.TEXTURE_2D,0,this.format,this.format,B.UNSIGNED_BYTE,l):B.texImage2D(B.TEXTURE_2D,0,this.format,_,x,0,this.format,B.UNSIGNED_BYTE,l.data);else{const{x:O,y:N}=m||{x:0,y:0};l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||mt(l)?B.texSubImage2D(B.TEXTURE_2D,0,O,N,B.RGBA,B.UNSIGNED_BYTE,l):B.texSubImage2D(B.TEXTURE_2D,0,O,N,_,x,B.RGBA,B.UNSIGNED_BYTE,l.data)}this.useMipmap&&this.isSizePowerOfTwo()&&B.generateMipmap(B.TEXTURE_2D),E.pixelStoreUnpackFlipY.setDefault(),E.pixelStoreUnpack.setDefault(),E.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(l,h,m){const{context:_}=this,{gl:x}=_;x.bindTexture(x.TEXTURE_2D,this.texture),m!==x.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(m=x.LINEAR),l!==this.filter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,l),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,m||l),this.filter=l),h!==this.wrap&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,h),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,h),this.wrap=h)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}}class OL{constructor(l,h,m,_=1,x=1,w=1,E=0){if(this.uid=l,h.height!==h.width)throw new RangeError("DEM tiles must be square");if(m&&!["mapbox","terrarium","custom"].includes(m))return void Ee(`"${m}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=h.height;const B=this.dim=h.height-2;switch(this.data=new Uint32Array(h.data.buffer),m){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=_,this.greenFactor=x,this.blueFactor=w,this.baseShift=E;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let O=0;O<B;O++)this.data[this._idx(-1,O)]=this.data[this._idx(0,O)],this.data[this._idx(B,O)]=this.data[this._idx(B-1,O)],this.data[this._idx(O,-1)]=this.data[this._idx(O,0)],this.data[this._idx(O,B)]=this.data[this._idx(O,B-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(B,-1)]=this.data[this._idx(B-1,0)],this.data[this._idx(-1,B)]=this.data[this._idx(0,B-1)],this.data[this._idx(B,B)]=this.data[this._idx(B-1,B-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let O=0;O<B;O++)for(let N=0;N<B;N++){const U=this.get(O,N);U>this.max&&(this.max=U),U<this.min&&(this.min=U)}}get(l,h){const m=new Uint8Array(this.data.buffer),_=4*this._idx(l,h);return this.unpack(m[_],m[_+1],m[_+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(l,h){if(l<-1||l>=this.dim+1||h<-1||h>=this.dim+1)throw new RangeError(`Out of range source coordinates for DEM data. x: ${l}, y: ${h}, dim: ${this.dim}`);return(h+1)*this.stride+(l+1)}unpack(l,h,m){return l*this.redFactor+h*this.greenFactor+m*this.blueFactor-this.baseShift}pack(l){return DL(l,this.getUnpackVector())}getPixels(){return new Bo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(l,h,m){if(this.dim!==l.dim)throw new Error("dem dimension mismatch");let _=h*this.dim,x=h*this.dim+this.dim,w=m*this.dim,E=m*this.dim+this.dim;switch(h){case-1:_=x-1;break;case 1:x=_+1}switch(m){case-1:w=E-1;break;case 1:E=w+1}const B=-h*this.dim,O=-m*this.dim;for(let N=w;N<E;N++)for(let U=_;U<x;U++)this.data[this._idx(U,N)]=l.data[this._idx(U+B,N+O)]}}function DL(d,l){const h=l[0],m=l[1],_=l[2],x=l[3],w=Math.min(h,m,_),E=Math.round((d+x)/w);return{r:Math.floor(E*w/h)%256,g:Math.floor(E*w/m)%256,b:Math.floor(E*w/_)%256}}er("DEMData",OL);class PQ extends Jo{constructor(l,h){super(l,IQ,h)}_createColorRamp(l){const h={elevationStops:[],colorStops:[]},m=this._transitionablePaint._values["color-relief-color"].value.expression;if(m instanceof Hp&&m._styleExpression.expression instanceof Js){this.colorRampExpression=m;const w=m._styleExpression.expression;h.elevationStops=w.labels,h.colorStops=[];for(const E of h.elevationStops)h.colorStops.push(w.evaluate({globals:{elevation:E}}))}if(h.elevationStops.length<1&&(h.elevationStops=[0],h.colorStops=[Ur.transparent]),h.elevationStops.length<2&&(h.elevationStops.push(h.elevationStops[0]+1),h.colorStops.push(h.colorStops[0])),h.elevationStops.length<=l)return h;const _={elevationStops:[],colorStops:[]},x=(h.elevationStops.length-1)/(l-1);for(let w=0;w<h.elevationStops.length-.5;w+=x)_.elevationStops.push(h.elevationStops[Math.round(w)]),_.colorStops.push(h.colorStops[Math.round(w)]);return Ee(`Too many colors in specification of ${this.id} color-relief layer, may not render properly. Max possible colors: ${l}, provided: ${h.elevationStops.length}`),_}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(l,h,m){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const _=this._createColorRamp(h),x=new Bo({width:_.colorStops.length,height:1}),w=new Bo({width:_.colorStops.length,height:1});for(let E=0;E<_.elevationStops.length;E++){const B=DL(_.elevationStops[E],m);w.setPixel(0,E,new Ur(B.r/255,B.g/255,B.b/255,1)),x.setPixel(0,E,_.colorStops[E])}return this.colorRampTextures={elevationTexture:new q2(l,w,l.gl.RGBA),colorTexture:new q2(l,x,l.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return!this.isHidden()&&!!this.colorRampTextures}}const BQ=Ti([{name:"a_pos",components:2,type:"Int16"}],4),{members:MQ}=BQ;function l1(d,l,h){const m=h.patternDependencies;let _=!1;for(const x of l){const w=x.paint.get(`${d}-pattern`);w.isConstant()||(_=!0);const E=w.constantOr(null);E&&(_=!0,m[E.to]=!0,m[E.from]=!0)}return _}function Y2(d,l,h,m,_){const{zoom:x}=m,w=_.patternDependencies;for(const E of l){const B=E.paint.get(`${d}-pattern`).value;if(B.kind!=="constant"){let O=B.evaluate({zoom:x-1},h,{},_.availableImages),N=B.evaluate({zoom:x},h,{},_.availableImages),U=B.evaluate({zoom:x+1},h,{},_.availableImages);O=O&&O.name?O.name:O,N=N&&N.name?N.name:N,U=U&&U.name?U.name:U,w[O]=!0,w[N]=!0,w[U]=!0,h.patterns[E.id]={min:O,mid:N,max:U}}}return h}function LL(d,l,h,m,_){let x;if(_===function(w,E,B,O){let N=0;for(let U=E,G=B-O;U<B;U+=O)N+=(w[G]-w[U])*(w[U+1]+w[G+1]),G=U;return N}(d,l,h,m)>0)for(let w=l;w<h;w+=m)x=zL(w/m|0,d[w],d[w+1],x);else for(let w=h-m;w>=l;w-=m)x=zL(w/m|0,d[w],d[w+1],x);return x&&gg(x,x.next)&&(Bb(x),x=x.next),x}function df(d,l){if(!d)return d;l||(l=d);let h,m=d;do if(h=!1,m.steiner||!gg(m,m.next)&&Oi(m.prev,m,m.next)!==0)m=m.next;else{if(Bb(m),m=l=m.prev,m===m.next)break;h=!0}while(h||m!==l);return l}function Eb(d,l,h,m,_,x,w){if(!d)return;!w&&x&&function(B,O,N,U){let G=B;do G.z===0&&(G.z=Z2(G.x,G.y,O,N,U)),G.prevZ=G.prev,G.nextZ=G.next,G=G.next;while(G!==B);G.prevZ.nextZ=null,G.prevZ=null,function(K){let q,Z=1;do{let ee,ue=K;K=null;let xe=null;for(q=0;ue;){q++;let fe=ue,pe=0;for(let Oe=0;Oe<Z&&(pe++,fe=fe.nextZ,fe);Oe++);let Te=Z;for(;pe>0||Te>0&&fe;)pe!==0&&(Te===0||!fe||ue.z<=fe.z)?(ee=ue,ue=ue.nextZ,pe--):(ee=fe,fe=fe.nextZ,Te--),xe?xe.nextZ=ee:K=ee,ee.prevZ=xe,xe=ee;ue=fe}xe.nextZ=null,Z*=2}while(q>1)}(G)}(d,m,_,x);let E=d;for(;d.prev!==d.next;){const B=d.prev,O=d.next;if(x?kQ(d,m,_,x):RQ(d))l.push(B.i,d.i,O.i),Bb(d),d=O.next,E=O.next;else if((d=O)===E){w?w===1?Eb(d=OQ(df(d),l),l,h,m,_,x,2):w===2&&DQ(d,l,h,m,_,x):Eb(df(d),l,h,m,_,x,1);break}}}function RQ(d){const l=d.prev,h=d,m=d.next;if(Oi(l,h,m)>=0)return!1;const _=l.x,x=h.x,w=m.x,E=l.y,B=h.y,O=m.y,N=Math.min(_,x,w),U=Math.min(E,B,O),G=Math.max(_,x,w),K=Math.max(E,B,O);let q=m.next;for(;q!==l;){if(q.x>=N&&q.x<=G&&q.y>=U&&q.y<=K&&Ib(_,E,x,B,w,O,q.x,q.y)&&Oi(q.prev,q,q.next)>=0)return!1;q=q.next}return!0}function kQ(d,l,h,m){const _=d.prev,x=d,w=d.next;if(Oi(_,x,w)>=0)return!1;const E=_.x,B=x.x,O=w.x,N=_.y,U=x.y,G=w.y,K=Math.min(E,B,O),q=Math.min(N,U,G),Z=Math.max(E,B,O),ee=Math.max(N,U,G),ue=Z2(K,q,l,h,m),xe=Z2(Z,ee,l,h,m);let fe=d.prevZ,pe=d.nextZ;for(;fe&&fe.z>=ue&&pe&&pe.z<=xe;){if(fe.x>=K&&fe.x<=Z&&fe.y>=q&&fe.y<=ee&&fe!==_&&fe!==w&&Ib(E,N,B,U,O,G,fe.x,fe.y)&&Oi(fe.prev,fe,fe.next)>=0||(fe=fe.prevZ,pe.x>=K&&pe.x<=Z&&pe.y>=q&&pe.y<=ee&&pe!==_&&pe!==w&&Ib(E,N,B,U,O,G,pe.x,pe.y)&&Oi(pe.prev,pe,pe.next)>=0))return!1;pe=pe.nextZ}for(;fe&&fe.z>=ue;){if(fe.x>=K&&fe.x<=Z&&fe.y>=q&&fe.y<=ee&&fe!==_&&fe!==w&&Ib(E,N,B,U,O,G,fe.x,fe.y)&&Oi(fe.prev,fe,fe.next)>=0)return!1;fe=fe.prevZ}for(;pe&&pe.z<=xe;){if(pe.x>=K&&pe.x<=Z&&pe.y>=q&&pe.y<=ee&&pe!==_&&pe!==w&&Ib(E,N,B,U,O,G,pe.x,pe.y)&&Oi(pe.prev,pe,pe.next)>=0)return!1;pe=pe.nextZ}return!0}function OQ(d,l){let h=d;do{const m=h.prev,_=h.next.next;!gg(m,_)&&FL(m,h,h.next,_)&&Pb(m,_)&&Pb(_,m)&&(l.push(m.i,h.i,_.i),Bb(h),Bb(h.next),h=d=_),h=h.next}while(h!==d);return df(h)}function DQ(d,l,h,m,_,x){let w=d;do{let E=w.next.next;for(;E!==w.prev;){if(w.i!==E.i&&zQ(w,E)){let B=UL(w,E);return w=df(w,w.next),B=df(B,B.next),Eb(w,l,h,m,_,x,0),void Eb(B,l,h,m,_,x,0)}E=E.next}w=w.next}while(w!==d)}function LQ(d,l){let h=d.x-l.x;return h===0&&(h=d.y-l.y,h===0)&&(h=(d.next.y-d.y)/(d.next.x-d.x)-(l.next.y-l.y)/(l.next.x-l.x)),h}function NQ(d,l){const h=function(_,x){let w=x;const E=_.x,B=_.y;let O,N=-1/0;if(gg(_,w))return w;do{if(gg(_,w.next))return w.next;if(B<=w.y&&B>=w.next.y&&w.next.y!==w.y){const Z=w.x+(B-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(Z<=E&&Z>N&&(N=Z,O=w.x<w.next.x?w:w.next,Z===E))return O}w=w.next}while(w!==x);if(!O)return null;const U=O,G=O.x,K=O.y;let q=1/0;w=O;do{if(E>=w.x&&w.x>=G&&E!==w.x&&NL(B<K?E:N,B,G,K,B<K?N:E,B,w.x,w.y)){const Z=Math.abs(B-w.y)/(E-w.x);Pb(w,_)&&(Z<q||Z===q&&(w.x>O.x||w.x===O.x&&FQ(O,w)))&&(O=w,q=Z)}w=w.next}while(w!==U);return O}(d,l);if(!h)return l;const m=UL(h,d);return df(m,m.next),df(h,h.next)}function FQ(d,l){return Oi(d.prev,d,l.prev)<0&&Oi(l.next,d,d.next)<0}function Z2(d,l,h,m,_){return(d=1431655765&((d=858993459&((d=252645135&((d=16711935&((d=(d-h)*_|0)|d<<8))|d<<4))|d<<2))|d<<1))|(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-m)*_|0)|l<<8))|l<<4))|l<<2))|l<<1))<<1}function UQ(d){let l=d,h=d;do(l.x<h.x||l.x===h.x&&l.y<h.y)&&(h=l),l=l.next;while(l!==d);return h}function NL(d,l,h,m,_,x,w,E){return(_-w)*(l-E)>=(d-w)*(x-E)&&(d-w)*(m-E)>=(h-w)*(l-E)&&(h-w)*(x-E)>=(_-w)*(m-E)}function Ib(d,l,h,m,_,x,w,E){return!(d===w&&l===E)&&NL(d,l,h,m,_,x,w,E)}function zQ(d,l){return d.next.i!==l.i&&d.prev.i!==l.i&&!function(h,m){let _=h;do{if(_.i!==h.i&&_.next.i!==h.i&&_.i!==m.i&&_.next.i!==m.i&&FL(_,_.next,h,m))return!0;_=_.next}while(_!==h);return!1}(d,l)&&(Pb(d,l)&&Pb(l,d)&&function(h,m){let _=h,x=!1;const w=(h.x+m.x)/2,E=(h.y+m.y)/2;do _.y>E!=_.next.y>E&&_.next.y!==_.y&&w<(_.next.x-_.x)*(E-_.y)/(_.next.y-_.y)+_.x&&(x=!x),_=_.next;while(_!==h);return x}(d,l)&&(Oi(d.prev,d,l.prev)||Oi(d,l.prev,l))||gg(d,l)&&Oi(d.prev,d,d.next)>0&&Oi(l.prev,l,l.next)>0)}function Oi(d,l,h){return(l.y-d.y)*(h.x-l.x)-(l.x-d.x)*(h.y-l.y)}function gg(d,l){return d.x===l.x&&d.y===l.y}function FL(d,l,h,m){const _=u1(Oi(d,l,h)),x=u1(Oi(d,l,m)),w=u1(Oi(h,m,d)),E=u1(Oi(h,m,l));return _!==x&&w!==E||!(_!==0||!c1(d,h,l))||!(x!==0||!c1(d,m,l))||!(w!==0||!c1(h,d,m))||!(E!==0||!c1(h,l,m))}function c1(d,l,h){return l.x<=Math.max(d.x,h.x)&&l.x>=Math.min(d.x,h.x)&&l.y<=Math.max(d.y,h.y)&&l.y>=Math.min(d.y,h.y)}function u1(d){return d>0?1:d<0?-1:0}function Pb(d,l){return Oi(d.prev,d,d.next)<0?Oi(d,l,d.next)>=0&&Oi(d,d.prev,l)>=0:Oi(d,l,d.prev)<0||Oi(d,d.next,l)<0}function UL(d,l){const h=Q2(d.i,d.x,d.y),m=Q2(l.i,l.x,l.y),_=d.next,x=l.prev;return d.next=l,l.prev=d,h.next=_,_.prev=h,m.next=h,h.prev=m,x.next=m,m.prev=x,m}function zL(d,l,h,m){const _=Q2(d,l,h);return m?(_.next=m.next,_.prev=m,m.next.prev=_,m.next=_):(_.prev=_,_.next=_),_}function Bb(d){d.next.prev=d.prev,d.prev.next=d.next,d.prevZ&&(d.prevZ.nextZ=d.nextZ),d.nextZ&&(d.nextZ.prevZ=d.prevZ)}function Q2(d,l,h){return{i:d,x:l,y:h,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class mg{constructor(l,h){if(h>l)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=l,this._minGranularity=h}getGranularityForZoomLevel(l){return Math.max(Math.floor(this._baseZoomGranularity/(1<<l)),this._minGranularity,1)}}class h1{constructor(l){this.fill=l.fill,this.line=l.line,this.tile=l.tile,this.stencil=l.stencil,this.circle=l.circle}}h1.noSubdivision=new h1({fill:new mg(0,0),line:new mg(0,0),tile:new mg(0,0),stencil:new mg(0,0),circle:1}),er("SubdivisionGranularityExpression",mg),er("SubdivisionGranularitySetting",h1);const yg=-32768,Mb=32767;class VQ{constructor(l,h){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=l,this._granularityCellSize=Ut/l,this._canonical=h}_getKey(l,h){return(l+=32768)<<16|h+32768}_vertexToIndex(l,h){if(l<-32768||h<-32768||l>32767||h>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const m=0|Math.round(l),_=0|Math.round(h),x=this._getKey(m,_);if(this._vertexDictionary.has(x))return this._vertexDictionary.get(x);const w=this._vertexBuffer.length/2;return this._vertexDictionary.set(x,w),this._vertexBuffer.push(m,_),w}_subdivideTrianglesScanline(l){if(this._granularity<2)return function(_,x){const w=[];for(let E=0;E<x.length;E+=3){const B=x[E],O=x[E+1],N=x[E+2],U=_[2*B],G=_[2*B+1];(_[2*O]-U)*(_[2*N+1]-G)-(_[2*O+1]-G)*(_[2*N]-U)>0?(w.push(B),w.push(N),w.push(O)):(w.push(B),w.push(O),w.push(N))}return w}(this._vertexBuffer,l);const h=[],m=l.length;for(let _=0;_<m;_+=3){const x=[l[_+0],l[_+1],l[_+2]],w=[this._vertexBuffer[2*l[_+0]+0],this._vertexBuffer[2*l[_+0]+1],this._vertexBuffer[2*l[_+1]+0],this._vertexBuffer[2*l[_+1]+1],this._vertexBuffer[2*l[_+2]+0],this._vertexBuffer[2*l[_+2]+1]];let E=1/0,B=1/0,O=-1/0,N=-1/0;for(let Z=0;Z<3;Z++){const ee=w[2*Z],ue=w[2*Z+1];E=Math.min(E,ee),O=Math.max(O,ee),B=Math.min(B,ue),N=Math.max(N,ue)}if(E===O||B===N)continue;const U=Math.floor(E/this._granularityCellSize),G=Math.ceil(O/this._granularityCellSize),K=Math.floor(B/this._granularityCellSize),q=Math.ceil(N/this._granularityCellSize);if(U!==G||K!==q)for(let Z=K;Z<q;Z++){const ee=this._scanlineGenerateVertexRingForCellRow(Z,w,x);$Q(this._vertexBuffer,ee,h)}else h.push(...x)}return h}_scanlineGenerateVertexRingForCellRow(l,h,m){const _=l*this._granularityCellSize,x=_+this._granularityCellSize,w=[];for(let E=0;E<3;E++){const B=h[2*E],O=h[2*E+1],N=h[2*(E+1)%6],U=h[(2*(E+1)+1)%6],G=h[2*(E+2)%6],K=h[(2*(E+2)+1)%6],q=N-B,Z=U-O,ee=q===0,ue=Z===0,xe=(_-O)/Z,fe=(x-O)/Z,pe=Math.min(xe,fe),Te=Math.max(xe,fe);if(!ue&&(pe>=1||Te<=0)||ue&&(O<_||O>x)){U>=_&&U<=x&&w.push(m[(E+1)%3]);continue}!ue&&pe>0&&w.push(this._vertexToIndex(B+q*pe,O+Z*pe));const Oe=B+q*Math.max(pe,0),Ze=B+q*Math.min(Te,1);ee||this._generateIntraEdgeVertices(w,B,O,N,U,Oe,Ze),!ue&&Te<1&&w.push(this._vertexToIndex(B+q*Te,O+Z*Te)),(ue||U>=_&&U<=x)&&w.push(m[(E+1)%3]),!ue&&(U<=_||U>=x)&&this._generateInterEdgeVertices(w,B,O,N,U,G,K,Ze,_,x)}return w}_generateIntraEdgeVertices(l,h,m,_,x,w,E){const B=_-h,O=x-m,N=O===0,U=N?Math.min(h,_):Math.min(w,E),G=N?Math.max(h,_):Math.max(w,E),K=Math.floor(U/this._granularityCellSize)+1,q=Math.ceil(G/this._granularityCellSize)-1;if(N?h<_:w<E)for(let Z=K;Z<=q;Z++){const ee=Z*this._granularityCellSize;l.push(this._vertexToIndex(ee,m+O*(ee-h)/B))}else for(let Z=q;Z>=K;Z--){const ee=Z*this._granularityCellSize;l.push(this._vertexToIndex(ee,m+O*(ee-h)/B))}}_generateInterEdgeVertices(l,h,m,_,x,w,E,B,O,N){const U=x-m,G=w-_,K=E-x,q=(O-x)/K,Z=(N-x)/K,ee=Math.min(q,Z),ue=Math.max(q,Z),xe=_+G*ee;let fe=Math.floor(Math.min(xe,B)/this._granularityCellSize)+1,pe=Math.ceil(Math.max(xe,B)/this._granularityCellSize)-1,Te=B<xe;const Oe=K===0;if(Oe&&(E===O||E===N))return;if(Oe||ee>=1||ue<=0){const xt=m-E,ht=w+(h-w)*Math.min((O-E)/xt,(N-E)/xt);fe=Math.floor(Math.min(ht,B)/this._granularityCellSize)+1,pe=Math.ceil(Math.max(ht,B)/this._granularityCellSize)-1,Te=B<ht}const Ze=U>0?N:O;if(Te)for(let xt=fe;xt<=pe;xt++)l.push(this._vertexToIndex(xt*this._granularityCellSize,Ze));else for(let xt=pe;xt>=fe;xt--)l.push(this._vertexToIndex(xt*this._granularityCellSize,Ze))}_generateOutline(l){const h=[];for(const m of l){const _=ff(m,this._granularity,!0),x=this._pointArrayToIndices(_),w=[];for(let E=1;E<x.length;E++)w.push(x[E-1]),w.push(x[E]);h.push(w)}return h}_handlePoles(l){let h=!1,m=!1;this._canonical&&(this._canonical.y===0&&(h=!0),this._canonical.y===(1<<this._canonical.z)-1&&(m=!0)),(h||m)&&this._fillPoles(l,h,m)}_ensureNoPoleVertices(){const l=this._vertexBuffer;for(let h=0;h<l.length;h+=2){const m=l[h+1];m===yg&&(l[h+1]=-32767),m===Mb&&(l[h+1]=32766)}}_generatePoleQuad(l,h,m,_,x,w){_>x!=(w===yg)?(l.push(h),l.push(m),l.push(this._vertexToIndex(_,w)),l.push(m),l.push(this._vertexToIndex(x,w)),l.push(this._vertexToIndex(_,w))):(l.push(m),l.push(h),l.push(this._vertexToIndex(_,w)),l.push(this._vertexToIndex(x,w)),l.push(m),l.push(this._vertexToIndex(_,w)))}_fillPoles(l,h,m){const _=this._vertexBuffer,x=Ut,w=l.length;for(let E=2;E<w;E+=3){const B=l[E-2],O=l[E-1],N=l[E],U=_[2*B],G=_[2*B+1],K=_[2*O],q=_[2*O+1],Z=_[2*N],ee=_[2*N+1];h&&(G===0&&q===0&&this._generatePoleQuad(l,B,O,U,K,yg),q===0&&ee===0&&this._generatePoleQuad(l,O,N,K,Z,yg),ee===0&&G===0&&this._generatePoleQuad(l,N,B,Z,U,yg)),m&&(G===x&&q===x&&this._generatePoleQuad(l,B,O,U,K,Mb),q===x&&ee===x&&this._generatePoleQuad(l,O,N,K,Z,Mb),ee===x&&G===x&&this._generatePoleQuad(l,N,B,Z,U,Mb))}}_initializeVertices(l){for(let h=0;h<l.length;h+=2)this._vertexToIndex(l[h],l[h+1])}subdividePolygonInternal(l,h){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:m,holeIndices:_}=function(E){const B=[],O=[];for(const N of E)if(N.length!==0){N!==E[0]&&B.push(O.length/2);for(let U=0;U<N.length;U++)O.push(N[U].x),O.push(N[U].y)}return{flattened:O,holeIndices:B}}(l);let x;this._initializeVertices(m);try{const E=function(O,N,U=2){const G=N&&N.length,K=G?N[0]*U:O.length;let q=LL(O,0,K,U,!0);const Z=[];if(!q||q.next===q.prev)return Z;let ee,ue,xe;if(G&&(q=function(fe,pe,Te,Oe){const Ze=[];for(let xt=0,ht=pe.length;xt<ht;xt++){const Ct=LL(fe,pe[xt]*Oe,xt<ht-1?pe[xt+1]*Oe:fe.length,Oe,!1);Ct===Ct.next&&(Ct.steiner=!0),Ze.push(UQ(Ct))}Ze.sort(LQ);for(let xt=0;xt<Ze.length;xt++)Te=NQ(Ze[xt],Te);return Te}(O,N,q,U)),O.length>80*U){ee=O[0],ue=O[1];let fe=ee,pe=ue;for(let Te=U;Te<K;Te+=U){const Oe=O[Te],Ze=O[Te+1];Oe<ee&&(ee=Oe),Ze<ue&&(ue=Ze),Oe>fe&&(fe=Oe),Ze>pe&&(pe=Ze)}xe=Math.max(fe-ee,pe-ue),xe=xe!==0?32767/xe:0}return Eb(q,Z,U,ee,ue,xe,0),Z}(m,_),B=this._convertIndices(m,E);x=this._subdivideTrianglesScanline(B)}catch(E){console.error(E)}let w=[];return h&&(w=this._generateOutline(l)),this._ensureNoPoleVertices(),this._handlePoles(x),{verticesFlattened:this._vertexBuffer,indicesTriangles:x,indicesLineList:w}}_convertIndices(l,h){const m=[];for(let _=0;_<h.length;_++)m.push(this._vertexToIndex(l[2*h[_]],l[2*h[_]+1]));return m}_pointArrayToIndices(l){const h=[];for(let m=0;m<l.length;m++){const _=l[m];h.push(this._vertexToIndex(_.x,_.y))}return h}}function VL(d,l,h,m=!0){return new VQ(h,l).subdividePolygonInternal(d,m)}function ff(d,l,h=!1){if(!d||d.length<1)return[];if(d.length<2)return[];const m=d[0],_=d[d.length-1],x=h&&(m.x!==_.x||m.y!==_.y);if(l<2)return x?[...d,d[0]]:[...d];const w=Math.floor(Ut/l),E=[];E.push(new u(d[0].x,d[0].y));const B=d.length,O=x?B:B-1;for(let N=0;N<O;N++){const U=d[N],G=N<B-1?d[N+1]:d[0],K=U.x,q=U.y,Z=G.x,ee=G.y,ue=K!==Z,xe=q!==ee;if(!ue&&!xe)continue;const fe=Z-K,pe=ee-q,Te=Math.abs(fe),Oe=Math.abs(pe);let Ze=K,xt=q;for(;;){const Ct=fe>0?(Math.floor(Ze/w)+1)*w:(Math.ceil(Ze/w)-1)*w,Vt=pe>0?(Math.floor(xt/w)+1)*w:(Math.ceil(xt/w)-1)*w,Et=Math.abs(Ze-Ct),bt=Math.abs(xt-Vt),at=Math.abs(Ze-Z),Yt=Math.abs(xt-ee),Jt=ue?Et/Te:Number.POSITIVE_INFINITY,ir=xe?bt/Oe:Number.POSITIVE_INFINITY;if((at<=Et||!ue)&&(Yt<=bt||!xe))break;if(Jt<ir&&ue||!xe){Ze=Ct,xt+=pe*Jt;const Xt=new u(Ze,Math.round(xt));E[E.length-1].x===Xt.x&&E[E.length-1].y===Xt.y||E.push(Xt)}else{Ze+=fe*ir,xt=Vt;const Xt=new u(Math.round(Ze),xt);E[E.length-1].x===Xt.x&&E[E.length-1].y===Xt.y||E.push(Xt)}}const ht=new u(Z,ee);E[E.length-1].x===ht.x&&E[E.length-1].y===ht.y||E.push(ht)}return E}function $Q(d,l,h){if(l.length===0)throw new Error("Subdivision vertex ring is empty.");let m=0,_=d[2*l[0]];for(let B=1;B<l.length;B++){const O=d[2*l[B]];O<_&&(_=O,m=B)}const x=l.length;let w=m,E=(w+1)%x;for(;;){const B=w-1>=0?w-1:x-1,O=(E+1)%x,N=d[2*l[B]],U=d[2*l[O]],G=d[2*l[w]],K=d[2*l[w]+1],q=d[2*l[E]+1];let Z=!1;if(N<U)Z=!0;else if(N>U)Z=!1;else{const ee=q-K,ue=-(d[2*l[E]]-G),xe=K<q?1:-1;((N-G)*ee+(d[2*l[B]+1]-K)*ue)*xe>((U-G)*ee+(d[2*l[O]+1]-K)*ue)*xe&&(Z=!0)}if(Z){const ee=l[B],ue=l[w],xe=l[E];ee!==ue&&ee!==xe&&ue!==xe&&h.push(xe,ue,ee),w--,w<0&&(w=x-1)}else{const ee=l[O],ue=l[w],xe=l[E];ee!==ue&&ee!==xe&&ue!==xe&&h.push(xe,ue,ee),E++,E>=x&&(E=0)}if(B===O)break}}function $L(d,l,h,m,_,x,w,E,B){const O=_.length/2,N=w&&E&&B;if(O<Ht.MAX_VERTEX_ARRAY_LENGTH){const U=l.prepareSegment(O,h,m),G=U.vertexLength;for(let Z=0;Z<x.length;Z+=3)m.emplaceBack(G+x[Z],G+x[Z+1],G+x[Z+2]);let K,q;U.vertexLength+=O,U.primitiveLength+=x.length/3,N&&(q=w.prepareSegment(O,h,E),K=q.vertexLength,q.vertexLength+=O);for(let Z=0;Z<_.length;Z+=2)d(_[Z],_[Z+1]);if(N)for(let Z=0;Z<B.length;Z++){const ee=B[Z];for(let ue=1;ue<ee.length;ue+=2)E.emplaceBack(K+ee[ue-1],K+ee[ue]);q.primitiveLength+=ee.length/2}}else(function(U,G,K,q,Z,ee){const ue=[];for(let Oe=0;Oe<q.length/2;Oe++)ue.push(-1);const xe={count:0};let fe=0,pe=U.getOrCreateLatestSegment(G,K),Te=pe.vertexLength;for(let Oe=2;Oe<Z.length;Oe+=3){const Ze=Z[Oe-2],xt=Z[Oe-1],ht=Z[Oe];let Ct=ue[Ze]<fe,Vt=ue[xt]<fe,Et=ue[ht]<fe;pe.vertexLength+((Ct?1:0)+(Vt?1:0)+(Et?1:0))>Ht.MAX_VERTEX_ARRAY_LENGTH&&(pe=U.createNewSegment(G,K),fe=xe.count,Ct=!0,Vt=!0,Et=!0,Te=0);const bt=Rb(ue,q,ee,xe,Ze,Ct,pe),at=Rb(ue,q,ee,xe,xt,Vt,pe),Yt=Rb(ue,q,ee,xe,ht,Et,pe);K.emplaceBack(Te+bt-fe,Te+at-fe,Te+Yt-fe),pe.primitiveLength++}})(l,h,m,_,x,d),N&&function(U,G,K,q,Z,ee){const ue=[];for(let Oe=0;Oe<q.length/2;Oe++)ue.push(-1);const xe={count:0};let fe=0,pe=U.getOrCreateLatestSegment(G,K),Te=pe.vertexLength;for(let Oe=0;Oe<Z.length;Oe++){const Ze=Z[Oe];for(let xt=1;xt<Z[Oe].length;xt+=2){const ht=Ze[xt-1],Ct=Ze[xt];let Vt=ue[ht]<fe,Et=ue[Ct]<fe;pe.vertexLength+((Vt?1:0)+(Et?1:0))>Ht.MAX_VERTEX_ARRAY_LENGTH&&(pe=U.createNewSegment(G,K),fe=xe.count,Vt=!0,Et=!0,Te=0);const bt=Rb(ue,q,ee,xe,ht,Vt,pe),at=Rb(ue,q,ee,xe,Ct,Et,pe);K.emplaceBack(Te+bt-fe,Te+at-fe),pe.primitiveLength++}}}(w,h,E,_,B,d),l.forceNewSegmentOnNextPrepare(),w?.forceNewSegmentOnNextPrepare()}function Rb(d,l,h,m,_,x,w){if(x){const E=m.count;return h(l[2*_],l[2*_+1]),d[_]=m.count,m.count++,w.vertexLength++,E}return d[_]}class eE{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(h=>h.id),this.index=l.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new me,this.indexArray=new st,this.indexArray2=new Ot,this.programConfigurations=new vu(l.layers,l.zoom),this.segments=new Ht,this.segments2=new Ht,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(l,h,m){this.hasDependencies=l1("fill",this.layers,h);const _=this.layers[0].layout.get("fill-sort-key"),x=!_.isConstant(),w=[];for(const{feature:E,id:B,index:O,sourceLayerIndex:N}of l){const U=this.layers[0]._featureFilter.needGeometry,G=Cc(E,U);if(!this.layers[0]._featureFilter.filter(new kn(this.zoom),G,m))continue;const K=x?_.evaluate(G,{},m,h.availableImages):void 0,q={id:B,properties:E.properties,type:E.type,sourceLayerIndex:N,index:O,geometry:U?G.geometry:wc(E),patterns:{},sortKey:K};w.push(q)}x&&w.sort((E,B)=>E.sortKey-B.sortKey);for(const E of w){const{geometry:B,index:O,sourceLayerIndex:N}=E;if(this.hasDependencies){const U=Y2("fill",this.layers,E,{zoom:this.zoom},h);this.patternFeatures.push(U)}else this.addFeature(E,B,O,m,{},h.subdivisionGranularity);h.featureIndex.insert(l[O].feature,B,O,N,this.index)}}update(l,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,{imagePositions:m})}addFeatures(l,h,m){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,h,m,l.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,MQ),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.indexBuffer2=l.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(l,h,m,_,x,w){for(const E of Op(h,500)){const B=VL(E,_,w.fill.getGranularityForZoomLevel(_.z)),O=this.layoutVertexArray;$L((N,U)=>{O.emplaceBack(N,U)},this.segments,this.layoutVertexArray,this.indexArray,B.verticesFlattened,B.indicesTriangles,this.segments2,this.indexArray2,B.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,m,{imagePositions:x,canonical:_})}}let jL,HL;er("FillBucket",eE,{omit:["layers","patternFeatures"]});var jQ={get paint(){return HL=HL||new qs({"fill-antialias":new hr(et.paint_fill["fill-antialias"]),"fill-opacity":new Ar(et.paint_fill["fill-opacity"]),"fill-color":new Ar(et.paint_fill["fill-color"]),"fill-outline-color":new Ar(et.paint_fill["fill-outline-color"]),"fill-translate":new hr(et.paint_fill["fill-translate"]),"fill-translate-anchor":new hr(et.paint_fill["fill-translate-anchor"]),"fill-pattern":new nf(et.paint_fill["fill-pattern"])})},get layout(){return jL=jL||new qs({"fill-sort-key":new Ar(et.layout_fill["fill-sort-key"])})}};class GQ extends Jo{constructor(l,h){super(l,jQ,h)}recalculate(l,h){super.recalculate(l,h);const m=this.paint._values["fill-outline-color"];m.value.kind==="constant"&&m.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new eE(l)}queryRadius(){return o1(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:l,geometry:h,transform:m,pixelsToTileUnits:_}){return xL(a1(l,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-m.bearingInRadians,_),h)}isTileClipped(){return!0}}const HQ=Ti([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),WQ=Ti([{name:"a_centroid",components:2,type:"Int16"}],4),{members:KQ}=HQ;class kb{constructor(l,h,m,_,x){this.properties={},this.extent=m,this.type=0,this.id=void 0,this._pbf=l,this._geometry=-1,this._keys=_,this._values=x,l.readFields(XQ,this,h)}loadGeometry(){const l=this._pbf;l.pos=this._geometry;const h=l.readVarint()+l.pos,m=[];let _,x=1,w=0,E=0,B=0;for(;l.pos<h;){if(w<=0){const O=l.readVarint();x=7&O,w=O>>3}if(w--,x===1||x===2)E+=l.readSVarint(),B+=l.readSVarint(),x===1&&(_&&m.push(_),_=[]),_&&_.push(new u(E,B));else{if(x!==7)throw new Error(`unknown command ${x}`);_&&_.push(_[0].clone())}}return _&&m.push(_),m}bbox(){const l=this._pbf;l.pos=this._geometry;const h=l.readVarint()+l.pos;let m=1,_=0,x=0,w=0,E=1/0,B=-1/0,O=1/0,N=-1/0;for(;l.pos<h;){if(_<=0){const U=l.readVarint();m=7&U,_=U>>3}if(_--,m===1||m===2)x+=l.readSVarint(),w+=l.readSVarint(),x<E&&(E=x),x>B&&(B=x),w<O&&(O=w),w>N&&(N=w);else if(m!==7)throw new Error(`unknown command ${m}`)}return[E,O,B,N]}toGeoJSON(l,h,m){const _=this.extent*Math.pow(2,m),x=this.extent*l,w=this.extent*h,E=this.loadGeometry();function B(G){return[360*(G.x+x)/_-180,360/Math.PI*Math.atan(Math.exp((1-2*(G.y+w)/_)*Math.PI))-90]}function O(G){return G.map(B)}let N;if(this.type===1){const G=[];for(const q of E)G.push(q[0]);const K=O(G);N=G.length===1?{type:"Point",coordinates:K[0]}:{type:"MultiPoint",coordinates:K}}else if(this.type===2){const G=E.map(O);N=G.length===1?{type:"LineString",coordinates:G[0]}:{type:"MultiLineString",coordinates:G}}else{if(this.type!==3)throw new Error("unknown feature type");{const G=WL(E),K=[];for(const q of G)K.push(q.map(O));N=K.length===1?{type:"Polygon",coordinates:K[0]}:{type:"MultiPolygon",coordinates:K}}}const U={type:"Feature",geometry:N,properties:this.properties};return this.id!=null&&(U.id=this.id),U}}function XQ(d,l,h){d===1?l.id=h.readVarint():d===2?function(m,_){const x=m.readVarint()+m.pos;for(;m.pos<x;){const w=_._keys[m.readVarint()],E=_._values[m.readVarint()];_.properties[w]=E}}(h,l):d===3?l.type=h.readVarint():d===4&&(l._geometry=h.pos)}function WL(d){const l=d.length;if(l<=1)return[d];const h=[];let m,_;for(let x=0;x<l;x++){const w=JQ(d[x]);w!==0&&(_===void 0&&(_=w<0),_===w<0?(m&&h.push(m),m=[d[x]]):m&&m.push(d[x]))}return m&&h.push(m),h}function JQ(d){let l=0;for(let h,m,_=0,x=d.length,w=x-1;_<x;w=_++)h=d[_],m=d[w],l+=(m.x-h.x)*(h.y+m.y);return l}kb.types=["Unknown","Point","LineString","Polygon"];class qQ{constructor(l,h){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=l,this._keys=[],this._values=[],this._features=[],l.readFields(YQ,this,h),this.length=this._features.length}feature(l){if(l<0||l>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[l];const h=this._pbf.readVarint()+this._pbf.pos;return new kb(this._pbf,h,this.extent,this._keys,this._values)}}function YQ(d,l,h){d===15?l.version=h.readVarint():d===1?l.name=h.readString():d===5?l.extent=h.readVarint():d===2?l._features.push(h.pos):d===3?l._keys.push(h.readString()):d===4&&l._values.push(function(m){let _=null;const x=m.readVarint()+m.pos;for(;m.pos<x;){const w=m.readVarint()>>3;_=w===1?m.readString():w===2?m.readFloat():w===3?m.readDouble():w===4?m.readVarint64():w===5?m.readVarint():w===6?m.readSVarint():w===7?m.readBoolean():null}if(_==null)throw new Error("unknown feature value");return _}(h))}class KL{constructor(l,h){this.layers=l.readFields(ZQ,{},h)}}function ZQ(d,l,h){if(d===3){const m=new qQ(h,h.readVarint()+h.pos);m.length&&(l[m.name]=m)}}const tE=Math.pow(2,13);function Ob(d,l,h,m,_,x,w,E){d.emplaceBack(l,h,2*Math.floor(m*tE)+w,_*tE*2,x*tE*2,Math.round(E))}class rE{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(h=>h.id),this.index=l.index,this.hasDependencies=!1,this.layoutVertexArray=new we,this.centroidVertexArray=new ge,this.indexArray=new st,this.programConfigurations=new vu(l.layers,l.zoom),this.segments=new Ht,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(l,h,m){this.features=[],this.hasDependencies=l1("fill-extrusion",this.layers,h);for(const{feature:_,id:x,index:w,sourceLayerIndex:E}of l){const B=this.layers[0]._featureFilter.needGeometry,O=Cc(_,B);if(!this.layers[0]._featureFilter.filter(new kn(this.zoom),O,m))continue;const N={id:x,sourceLayerIndex:E,index:w,geometry:B?O.geometry:wc(_),properties:_.properties,type:_.type,patterns:{}};this.hasDependencies?this.features.push(Y2("fill-extrusion",this.layers,N,{zoom:this.zoom},h)):this.addFeature(N,N.geometry,w,m,{},h.subdivisionGranularity),h.featureIndex.insert(_,N.geometry,w,E,this.index,!0)}}addFeatures(l,h,m){for(const _ of this.features){const{geometry:x}=_;this.addFeature(_,x,_.index,h,m,l.subdivisionGranularity)}}update(l,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,{imagePositions:m})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,KQ),this.centroidVertexBuffer=l.createVertexBuffer(this.centroidVertexArray,WQ.members,!0),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(l,h,m,_,x,w){for(const E of Op(h,500)){const B={x:0,y:0,sampleCount:0},O=this.layoutVertexArray.length;this.processPolygon(B,_,l,E,w);const N=this.layoutVertexArray.length-O,U=Math.floor(B.x/B.sampleCount),G=Math.floor(B.y/B.sampleCount);for(let K=0;K<N;K++)this.centroidVertexArray.emplaceBack(U,G)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,m,{imagePositions:x,canonical:_})}processPolygon(l,h,m,_,x){if(_.length<1||XL(_[0]))return;for(const U of _)U.length!==0&&QQ(l,U);const w={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},E=x.fill.getGranularityForZoomLevel(h.z),B=kb.types[m.type]==="Polygon";for(const U of _){if(U.length===0||XL(U))continue;const G=ff(U,E,B);this._generateSideFaces(G,w)}if(!B)return;const O=VL(_,h,E,!1),N=this.layoutVertexArray;$L((U,G)=>{Ob(N,U,G,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,O.verticesFlattened,O.indicesTriangles)}_generateSideFaces(l,h){let m=0;for(let _=1;_<l.length;_++){const x=l[_],w=l[_-1];if(eee(x,w))continue;h.segment.vertexLength+4>Ht.MAX_VERTEX_ARRAY_LENGTH&&(h.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const E=x.sub(w)._perp()._unit(),B=w.dist(x);m+B>32768&&(m=0),Ob(this.layoutVertexArray,x.x,x.y,E.x,E.y,0,0,m),Ob(this.layoutVertexArray,x.x,x.y,E.x,E.y,0,1,m),m+=B,Ob(this.layoutVertexArray,w.x,w.y,E.x,E.y,0,0,m),Ob(this.layoutVertexArray,w.x,w.y,E.x,E.y,0,1,m);const O=h.segment.vertexLength;this.indexArray.emplaceBack(O,O+2,O+1),this.indexArray.emplaceBack(O+1,O+2,O+3),h.segment.vertexLength+=4,h.segment.primitiveLength+=2}}}function QQ(d,l){for(let h=0;h<l.length;h++){const m=l[h];h===l.length-1&&l[0].x===m.x&&l[0].y===m.y||(d.x+=m.x,d.y+=m.y,d.sampleCount++)}}function eee(d,l){return d.x===l.x&&(d.x<0||d.x>Ut)||d.y===l.y&&(d.y<0||d.y>Ut)}function XL(d){return d.every(l=>l.x<0)||d.every(l=>l.x>Ut)||d.every(l=>l.y<0)||d.every(l=>l.y>Ut)}let JL;er("FillExtrusionBucket",rE,{omit:["layers","features"]});var tee={get paint(){return JL=JL||new qs({"fill-extrusion-opacity":new hr(et["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ar(et["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new hr(et["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new hr(et["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new nf(et["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ar(et["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ar(et["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new hr(et["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class ree extends Jo{constructor(l,h){super(l,tee,h)}createBucket(l){return new rE(l)}queryRadius(){return o1(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:l,feature:h,featureState:m,geometry:_,transform:x,pixelsToTileUnits:w,pixelPosMatrix:E}){const B=a1(l,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-x.bearingInRadians,w),O=this.paint.get("fill-extrusion-height").evaluate(h,m),N=this.paint.get("fill-extrusion-base").evaluate(h,m),U=function(K,q){const Z=[];for(const ee of K){const ue=[ee.x,ee.y,0,1];Ve(ue,ue,q),Z.push(new u(ue[0]/ue[3],ue[1]/ue[3]))}return Z}(B,E),G=function(K,q,Z,ee){const ue=[],xe=[],fe=ee[8]*q,pe=ee[9]*q,Te=ee[10]*q,Oe=ee[11]*q,Ze=ee[8]*Z,xt=ee[9]*Z,ht=ee[10]*Z,Ct=ee[11]*Z;for(const Vt of K){const Et=[],bt=[];for(const at of Vt){const Yt=at.x,Jt=at.y,ir=ee[0]*Yt+ee[4]*Jt+ee[12],Xt=ee[1]*Yt+ee[5]*Jt+ee[13],dr=ee[2]*Yt+ee[6]*Jt+ee[14],an=ee[3]*Yt+ee[7]*Jt+ee[15],Gr=dr+Te,ai=an+Oe,Ds=ir+Ze,zi=Xt+xt,li=dr+ht,Yn=an+Ct,mn=new u((ir+fe)/ai,(Xt+pe)/ai);mn.z=Gr/ai,Et.push(mn);const _i=new u(Ds/Yn,zi/Yn);_i.z=li/Yn,bt.push(_i)}ue.push(Et),xe.push(bt)}return[ue,xe]}(_,N,O,E);return function(K,q,Z){let ee=1/0;xL(Z,q)&&(ee=qL(Z,q[0]));for(let ue=0;ue<q.length;ue++){const xe=q[ue],fe=K[ue];for(let pe=0;pe<xe.length-1;pe++){const Te=xe[pe],Oe=[Te,xe[pe+1],fe[pe+1],fe[pe],Te];dg(Z,Oe)&&(ee=Math.min(ee,qL(Z,Oe)))}}return ee!==1/0&&ee}(G[0],G[1],U)}}function Db(d,l){return d.x*l.x+d.y*l.y}function qL(d,l){if(d.length===1){let h=0;const m=l[h++];let _;for(;!_||m.equals(_);)if(_=l[h++],!_)return 1/0;for(;h<l.length;h++){const x=l[h],w=d[0],E=_.sub(m),B=x.sub(m),O=w.sub(m),N=Db(E,E),U=Db(E,B),G=Db(B,B),K=Db(O,E),q=Db(O,B),Z=N*G-U*U,ee=(G*K-U*q)/Z,ue=(N*q-U*K)/Z,xe=m.z*(1-ee-ue)+_.z*ee+x.z*ue;if(isFinite(xe))return xe}return 1/0}{let h=1/0;for(const m of l)h=Math.min(h,m.z);return h}}const nee=Ti([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:iee}=nee,see=Ti([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:oee}=see,aee=Math.cos(Math.PI/180*37.5),YL=Math.pow(2,14)/.5;class nE{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(h=>h.id),this.index=l.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(h=>{this.gradients[h.id]={}}),this.layoutVertexArray=new De,this.layoutVertexArray2=new Ae,this.indexArray=new st,this.programConfigurations=new vu(l.layers,l.zoom),this.segments=new Ht,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(l,h,m){this.hasDependencies=l1("line",this.layers,h)||this.hasLineDasharray(this.layers);const _=this.layers[0].layout.get("line-sort-key"),x=!_.isConstant(),w=[];for(const{feature:E,id:B,index:O,sourceLayerIndex:N}of l){const U=this.layers[0]._featureFilter.needGeometry,G=Cc(E,U);if(!this.layers[0]._featureFilter.filter(new kn(this.zoom),G,m))continue;const K=x?_.evaluate(G,{},m):void 0,q={id:B,properties:E.properties,type:E.type,sourceLayerIndex:N,index:O,geometry:U?G.geometry:wc(E),patterns:{},dashes:{},sortKey:K};w.push(q)}x&&w.sort((E,B)=>E.sortKey-B.sortKey);for(const E of w){const{geometry:B,index:O,sourceLayerIndex:N}=E;this.hasDependencies?(l1("line",this.layers,h)?Y2("line",this.layers,E,{zoom:this.zoom},h):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,E,this.zoom,h),this.patternFeatures.push(E)):this.addFeature(E,B,O,m,{},{},h.subdivisionGranularity),h.featureIndex.insert(l[O].feature,B,O,N,this.index)}}update(l,h,m,_){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,{imagePositions:m,dashPositions:_})}addFeatures(l,h,m,_){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,h,m,_,l.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=l.createVertexBuffer(this.layoutVertexArray2,oee)),this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,iee),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(l){if(l.properties&&Object.prototype.hasOwnProperty.call(l.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(l.properties,"mapbox_clip_end"))return{start:+l.properties.mapbox_clip_start,end:+l.properties.mapbox_clip_end}}addFeature(l,h,m,_,x,w,E){const B=this.layers[0].layout,O=B.get("line-join").evaluate(l,{}),N=B.get("line-cap"),U=B.get("line-miter-limit"),G=B.get("line-round-limit");this.lineClips=this.lineFeatureClips(l);for(const K of h)this.addLine(K,l,O,N,U,G,_,E);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,m,{imagePositions:x,dashPositions:w,canonical:_})}addLine(l,h,m,_,x,w,E,B){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,l=ff(l,E?B.line.getGranularityForZoomLevel(E.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let fe=0;fe<l.length-1;fe++)this.totalDistance+=l[fe].dist(l[fe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const O=kb.types[h.type]==="Polygon";let N=l.length;for(;N>=2&&l[N-1].equals(l[N-2]);)N--;let U=0;for(;U<N-1&&l[U].equals(l[U+1]);)U++;if(N<(O?3:2))return;m==="bevel"&&(x=1.05);const G=this.overscaling<=16?122880/(512*this.overscaling):0,K=this.segments.prepareSegment(10*N,this.layoutVertexArray,this.indexArray);let q,Z,ee,ue,xe;this.e1=this.e2=-1,O&&(q=l[N-2],xe=l[U].sub(q)._unit()._perp());for(let fe=U;fe<N;fe++){if(ee=fe===N-1?O?l[U+1]:void 0:l[fe+1],ee&&l[fe].equals(ee))continue;xe&&(ue=xe),q&&(Z=q),q=l[fe],xe=ee?ee.sub(q)._unit()._perp():ue,ue=ue||xe;let pe=ue.add(xe);pe.x===0&&pe.y===0||pe._unit();const Te=ue.x*xe.x+ue.y*xe.y,Oe=pe.x*xe.x+pe.y*xe.y,Ze=Oe!==0?1/Oe:1/0,xt=2*Math.sqrt(2-2*Oe),ht=Oe<aee&&Z&&ee,Ct=ue.x*xe.y-ue.y*xe.x>0;if(ht&&fe>U){const bt=q.dist(Z);if(bt>2*G){const at=q.sub(q.sub(Z)._mult(G/bt)._round());this.updateDistance(Z,at),this.addCurrentVertex(at,ue,0,0,K),Z=at}}const Vt=Z&&ee;let Et=Vt?m:O?"butt":_;if(Vt&&Et==="round"&&(Ze<w?Et="miter":Ze<=2&&(Et="fakeround")),Et==="miter"&&Ze>x&&(Et="bevel"),Et==="bevel"&&(Ze>2&&(Et="flipbevel"),Ze<x&&(Et="miter")),Z&&this.updateDistance(Z,q),Et==="miter")pe._mult(Ze),this.addCurrentVertex(q,pe,0,0,K);else if(Et==="flipbevel"){if(Ze>100)pe=xe.mult(-1);else{const bt=Ze*ue.add(xe).mag()/ue.sub(xe).mag();pe._perp()._mult(bt*(Ct?-1:1))}this.addCurrentVertex(q,pe,0,0,K),this.addCurrentVertex(q,pe.mult(-1),0,0,K)}else if(Et==="bevel"||Et==="fakeround"){const bt=-Math.sqrt(Ze*Ze-1),at=Ct?bt:0,Yt=Ct?0:bt;if(Z&&this.addCurrentVertex(q,ue,at,Yt,K),Et==="fakeround"){const Jt=Math.round(180*xt/Math.PI/20);for(let ir=1;ir<Jt;ir++){let Xt=ir/Jt;if(Xt!==.5){const an=Xt-.5;Xt+=Xt*an*(Xt-1)*((1.0904+Te*(Te*(3.55645-1.43519*Te)-3.2452))*an*an+(.848013+Te*(.215638*Te-1.06021)))}const dr=xe.sub(ue)._mult(Xt)._add(ue)._unit()._mult(Ct?-1:1);this.addHalfVertex(q,dr.x,dr.y,!1,Ct,0,K)}}ee&&this.addCurrentVertex(q,xe,-at,-Yt,K)}else if(Et==="butt")this.addCurrentVertex(q,pe,0,0,K);else if(Et==="square"){const bt=Z?1:-1;this.addCurrentVertex(q,pe,bt,bt,K)}else Et==="round"&&(Z&&(this.addCurrentVertex(q,ue,0,0,K),this.addCurrentVertex(q,ue,1,1,K,!0)),ee&&(this.addCurrentVertex(q,xe,-1,-1,K,!0),this.addCurrentVertex(q,xe,0,0,K)));if(ht&&fe<N-1){const bt=q.dist(ee);if(bt>2*G){const at=q.add(ee.sub(q)._mult(G/bt)._round());this.updateDistance(q,at),this.addCurrentVertex(at,xe,0,0,K),q=at}}}}addCurrentVertex(l,h,m,_,x,w=!1){const E=h.y*_-h.x,B=-h.y-h.x*_;this.addHalfVertex(l,h.x+h.y*m,h.y-h.x*m,w,!1,m,x),this.addHalfVertex(l,E,B,w,!0,-_,x),this.distance>YL/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(l,h,m,_,x,w))}addHalfVertex({x:l,y:h},m,_,x,w,E,B){const O=.5*(this.lineClips?this.scaledDistance*(YL-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((l<<1)+(x?1:0),(h<<1)+(w?1:0),Math.round(63*m)+128,Math.round(63*_)+128,1+(E===0?0:E<0?-1:1)|(63&O)<<2,O>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const N=B.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,N,this.e2),B.primitiveLength++),w?this.e2=N:this.e1=N}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(l,h){this.distance+=l.dist(h),this.updateScaledDistance()}hasLineDasharray(l){for(const h of l){const m=h.paint.get("line-dasharray");if(m&&!m.isConstant())return!0}return!1}addLineDashDependencies(l,h,m,_){for(const x of l){const w=x.paint.get("line-dasharray");if(!w||w.value.kind==="constant")continue;const E=x.layout.get("line-cap")==="round",B={dasharray:w.value.evaluate({zoom:m-1},h,{}),round:E},O={dasharray:w.value.evaluate({zoom:m},h,{}),round:E},N={dasharray:w.value.evaluate({zoom:m+1},h,{}),round:E},U=`${B.dasharray.join(",")},${B.round}`,G=`${O.dasharray.join(",")},${O.round}`,K=`${N.dasharray.join(",")},${N.round}`;_.dashDependencies[U]=B,_.dashDependencies[G]=O,_.dashDependencies[K]=N,h.dashes[x.id]={min:U,mid:G,max:K}}}}let ZL,QL;er("LineBucket",nE,{omit:["layers","patternFeatures"]});var eN={get paint(){return QL=QL||new qs({"line-opacity":new Ar(et.paint_line["line-opacity"]),"line-color":new Ar(et.paint_line["line-color"]),"line-translate":new hr(et.paint_line["line-translate"]),"line-translate-anchor":new hr(et.paint_line["line-translate-anchor"]),"line-width":new Ar(et.paint_line["line-width"]),"line-gap-width":new Ar(et.paint_line["line-gap-width"]),"line-offset":new Ar(et.paint_line["line-offset"]),"line-blur":new Ar(et.paint_line["line-blur"]),"line-dasharray":new nf(et.paint_line["line-dasharray"]),"line-pattern":new nf(et.paint_line["line-pattern"]),"line-gradient":new ig(et.paint_line["line-gradient"])})},get layout(){return ZL=ZL||new qs({"line-cap":new hr(et.layout_line["line-cap"]),"line-join":new Ar(et.layout_line["line-join"]),"line-miter-limit":new hr(et.layout_line["line-miter-limit"]),"line-round-limit":new hr(et.layout_line["line-round-limit"]),"line-sort-key":new Ar(et.layout_line["line-sort-key"])})}};class lee extends Ar{possiblyEvaluate(l,h){return h=new kn(Math.floor(h.zoom),{now:h.now,fadeDuration:h.fadeDuration,zoomHistory:h.zoomHistory,transition:h.transition}),super.possiblyEvaluate(l,h)}evaluate(l,h,m,_){return h=Mn({},h,{zoom:Math.floor(h.zoom)}),super.evaluate(l,h,m,_)}}let d1;class cee extends Jo{constructor(l,h){super(l,eN,h),this.gradientVersion=0,d1||(d1=new lee(eN.paint.properties["line-width"].specification),d1.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(l){if(l==="line-gradient"){const h=this.gradientExpression();this.stepInterpolant=!!function(m){return m._styleExpression!==void 0}(h)&&h._styleExpression.expression instanceof gc,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(l,h){super.recalculate(l,h),this.paint._values["line-floorwidth"]=d1.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new nE(l)}queryRadius(l){const h=l,m=tN(pg("line-width",this,h),pg("line-gap-width",this,h)),_=pg("line-offset",this,h);return m/2+Math.abs(_)+o1(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:l,feature:h,featureState:m,geometry:_,transform:x,pixelsToTileUnits:w}){const E=a1(l,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-x.bearingInRadians,w),B=w/2*tN(this.paint.get("line-width").evaluate(h,m),this.paint.get("line-gap-width").evaluate(h,m)),O=this.paint.get("line-offset").evaluate(h,m);return O&&(_=function(N,U){const G=[];for(let K=0;K<N.length;K++){const q=yQ(N[K]),Z=[];for(let ee=0;ee<q.length;ee++){const ue=q[ee],xe=q[ee-1],fe=q[ee+1],pe=ee===0?new u(0,0):ue.sub(xe)._unit()._perp(),Te=ee===q.length-1?new u(0,0):fe.sub(ue)._unit()._perp(),Oe=pe._add(Te)._unit(),Ze=Oe.x*Te.x+Oe.y*Te.y;Ze!==0&&Oe._mult(1/Ze),Z.push(Oe._mult(U)._add(ue))}G.push(Z)}return G}(_,O*w)),function(N,U,G){for(let K=0;K<U.length;K++){const q=U[K];if(N.length>=3){for(let Z=0;Z<q.length;Z++)if(fg(N,q[Z]))return!0}if(pQ(N,q,G))return!0}return!1}(E,_,B)}isTileClipped(){return!0}}function tN(d,l){return l>0?l+2*d:d}const uee=Ti([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),hee=Ti([{name:"a_projected_pos",components:3,type:"Float32"}],4);Ti([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const dee=Ti([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Ti([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const rN=Ti([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),fee=Ti([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function pee(d,l,h){return d.sections.forEach(m=>{m.text=function(_,x,w){const E=x.layout.get("text-transform").evaluate(w,{});return E==="uppercase"?_=_.toLocaleUpperCase():E==="lowercase"&&(_=_.toLocaleLowerCase()),vc.applyArabicShaping&&(_=vc.applyArabicShaping(_)),_}(m.text,l,h)}),d}Ti([{name:"triangle",components:3,type:"Uint16"}]),Ti([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ti([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Ti([{type:"Float32",name:"offsetX"}]),Ti([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Ti([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var ls=24;const Lb={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},gee={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},mee={40:!0};function nN(d,l,h,m,_,x){if("fontStack"in l){const w=h[l.fontStack],E=w&&w[d];return E?E.metrics.advance*l.scale+_:0}{const w=m[l.imageName];return w?w.displaySize[0]*l.scale*ls/x+_:0}}function iN(d,l,h,m){const _=Math.pow(d-l,2);return m?d<l?_/2:2*_:_+Math.abs(h)*h}function yee(d,l,h){let m=0;return d===10&&(m-=1e4),h&&(m+=150),d!==40&&d!==65288||(m+=50),l!==41&&l!==65289||(m+=50),m}function sN(d,l,h,m,_,x){let w=null,E=iN(l,h,_,x);for(const B of m){const O=iN(l-B.x,h,_,x)+B.badness;O<=E&&(w=B,E=O)}return{index:d,x:l,priorBreak:w,badness:E}}function oN(d){return d?oN(d.priorBreak).concat(d.index):[]}class bg{constructor(l="",h=[],m=[]){this.text=l,this.sections=h,this.sectionIndex=m,this.imageSectionID=null}static fromFeature(l,h){const m=new bg;for(let _=0;_<l.sections.length;_++){const x=l.sections[_];x.image?m.addImageSection(x):m.addTextSection(x,h)}return m}length(){return[...this.text].length}getSection(l){return this.sections[this.sectionIndex[l]]}getSectionIndex(l){return this.sectionIndex[l]}verticalizePunctuation(){this.text=function(l){let h="",m={premature:!0,value:void 0};const _=l[Symbol.iterator]();let x=_.next();const w=l[Symbol.iterator]();w.next();let E=w.next();for(;!x.done;)h+=!E.done&&db(E.value.codePointAt(0))&&!Lb[E.value]||!m.premature&&db(m.value.codePointAt(0))&&!Lb[m.value]||!Lb[x.value]?x.value:Lb[x.value],m={value:x.value,premature:!1},x=_.next(),E=w.next();return h}(this.text)}hasZeroWidthSpaces(){return this.text.includes("")}trim(){const l=this.text.match(/^\s*/),h=l?l[0].length:0,m=this.text.match(/\S\s*$/),_=m?m[0].length-1:0;this.text=this.text.substring(h,this.text.length-_),this.sectionIndex=this.sectionIndex.slice(h,this.sectionIndex.length-_)}substring(l,h){const m=[...this.text].slice(l,h).join(""),_=this.sectionIndex.slice(l,h);return new bg(m,this.sections,_)}toCodeUnitIndex(l){return[...this.text].slice(0,l).join("").length}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((l,h)=>Math.max(l,this.sections[h].scale),0)}getMaxImageSize(l){let h=0,m=0;for(let _=0;_<this.length();_++){const x=this.getSection(_);if("imageName"in x){const w=l[x.imageName];if(!w)continue;const E=w.displaySize;h=Math.max(h,E[0]),m=Math.max(m,E[1])}}return{maxImageWidth:h,maxImageHeight:m}}addTextSection(l,h){this.text+=l.text,this.sections.push({scale:l.scale||1,verticalAlign:l.verticalAlign||"bottom",fontStack:l.fontStack||h});const m=this.sections.length-1;this.sectionIndex.push(...[...l.text].map(()=>m))}addImageSection(l){const h=l.image?l.image.name:"";if(h.length===0)return void Ee("Can't add FormattedSection with an empty image.");const m=this.getNextImageSectionCharCode();m?(this.text+=String.fromCharCode(m),this.sections.push({scale:1,verticalAlign:l.verticalAlign||"bottom",imageName:h}),this.sectionIndex.push(this.sections.length-1)):Ee("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}determineLineBreaks(l,h,m,_,x){const w=[],E=this.determineAverageLineWidth(l,h,m,_,x),B=this.hasZeroWidthSpaces();let O=0,N=0;const U=this.text[Symbol.iterator]();let G=U.next();const K=this.text[Symbol.iterator]();K.next();let q=K.next();const Z=this.text[Symbol.iterator]();Z.next(),Z.next();let ee=Z.next();for(;!G.done;){const ue=this.getSection(N),xe=G.value.codePointAt(0);if(XA(xe)||(O+=nN(xe,ue,m,_,l,x)),!q.done){const fe=ef(xe),pe=q.value.codePointAt(0);(gee[xe]||fe||"imageName"in ue||!ee.done&&mee[pe])&&w.push(sN(N+1,O,E,w,yee(xe,pe,fe&&B),!1))}N++,G=U.next(),q=K.next(),ee=Z.next()}return oN(sN(this.length(),O,E,w,0,!0))}determineAverageLineWidth(l,h,m,_,x){let w=0,E=0;for(const B of this.text){const O=this.getSection(E);w+=nN(B.codePointAt(0),O,m,_,l,x),E++}return w/Math.max(1,Math.ceil(w/h))}}const iE=4294967296,aN=1/iE,lN=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class f1{constructor(l=new Uint8Array(16)){this.buf=ArrayBuffer.isView(l)?l:new Uint8Array(l),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(l,h,m=this.length){for(;this.pos<m;){const _=this.readVarint(),x=_>>3,w=this.pos;this.type=7&_,l(x,h,this),this.pos===w&&this.skip(_)}return h}readMessage(l,h){return this.readFields(l,h,this.readVarint()+this.pos)}readFixed32(){const l=this.dataView.getUint32(this.pos,!0);return this.pos+=4,l}readSFixed32(){const l=this.dataView.getInt32(this.pos,!0);return this.pos+=4,l}readFixed64(){const l=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*iE;return this.pos+=8,l}readSFixed64(){const l=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*iE;return this.pos+=8,l}readFloat(){const l=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,l}readDouble(){const l=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,l}readVarint(l){const h=this.buf;let m,_;return _=h[this.pos++],m=127&_,_<128?m:(_=h[this.pos++],m|=(127&_)<<7,_<128?m:(_=h[this.pos++],m|=(127&_)<<14,_<128?m:(_=h[this.pos++],m|=(127&_)<<21,_<128?m:(_=h[this.pos],m|=(15&_)<<28,function(x,w,E){const B=E.buf;let O,N;if(N=B[E.pos++],O=(112&N)>>4,N<128||(N=B[E.pos++],O|=(127&N)<<3,N<128)||(N=B[E.pos++],O|=(127&N)<<10,N<128)||(N=B[E.pos++],O|=(127&N)<<17,N<128)||(N=B[E.pos++],O|=(127&N)<<24,N<128)||(N=B[E.pos++],O|=(1&N)<<31,N<128))return _g(x,O,w);throw new Error("Expected varint not more than 10 bytes")}(m,l,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const l=this.readVarint();return l%2==1?(l+1)/-2:l/2}readBoolean(){return!!this.readVarint()}readString(){const l=this.readVarint()+this.pos,h=this.pos;return this.pos=l,l-h>=12&&lN?lN.decode(this.buf.subarray(h,l)):function(m,_,x){let w="",E=_;for(;E<x;){const B=m[E];let O,N,U,G=null,K=B>239?4:B>223?3:B>191?2:1;if(E+K>x)break;K===1?B<128&&(G=B):K===2?(O=m[E+1],(192&O)==128&&(G=(31&B)<<6|63&O,G<=127&&(G=null))):K===3?(O=m[E+1],N=m[E+2],(192&O)==128&&(192&N)==128&&(G=(15&B)<<12|(63&O)<<6|63&N,(G<=2047||G>=55296&&G<=57343)&&(G=null))):K===4&&(O=m[E+1],N=m[E+2],U=m[E+3],(192&O)==128&&(192&N)==128&&(192&U)==128&&(G=(15&B)<<18|(63&O)<<12|(63&N)<<6|63&U,(G<=65535||G>=1114112)&&(G=null))),G===null?(G=65533,K=1):G>65535&&(G-=65536,w+=String.fromCharCode(G>>>10&1023|55296),G=56320|1023&G),w+=String.fromCharCode(G),E+=K}return w}(this.buf,h,l)}readBytes(){const l=this.readVarint()+this.pos,h=this.buf.subarray(this.pos,l);return this.pos=l,h}readPackedVarint(l=[],h){const m=this.readPackedEnd();for(;this.pos<m;)l.push(this.readVarint(h));return l}readPackedSVarint(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readSVarint());return l}readPackedBoolean(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readBoolean());return l}readPackedFloat(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readFloat());return l}readPackedDouble(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readDouble());return l}readPackedFixed32(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readFixed32());return l}readPackedSFixed32(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readSFixed32());return l}readPackedFixed64(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readFixed64());return l}readPackedSFixed64(l=[]){const h=this.readPackedEnd();for(;this.pos<h;)l.push(this.readSFixed64());return l}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(l){const h=7&l;if(h===0)for(;this.buf[this.pos++]>127;);else if(h===2)this.pos=this.readVarint()+this.pos;else if(h===5)this.pos+=4;else{if(h!==1)throw new Error(`Unimplemented type: ${h}`);this.pos+=8}}writeTag(l,h){this.writeVarint(l<<3|h)}realloc(l){let h=this.length||16;for(;h<this.pos+l;)h*=2;if(h!==this.length){const m=new Uint8Array(h);m.set(this.buf),this.buf=m,this.dataView=new DataView(m.buffer),this.length=h}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(l){this.realloc(4),this.dataView.setInt32(this.pos,l,!0),this.pos+=4}writeSFixed32(l){this.realloc(4),this.dataView.setInt32(this.pos,l,!0),this.pos+=4}writeFixed64(l){this.realloc(8),this.dataView.setInt32(this.pos,-1&l,!0),this.dataView.setInt32(this.pos+4,Math.floor(l*aN),!0),this.pos+=8}writeSFixed64(l){this.realloc(8),this.dataView.setInt32(this.pos,-1&l,!0),this.dataView.setInt32(this.pos+4,Math.floor(l*aN),!0),this.pos+=8}writeVarint(l){(l=+l||0)>268435455||l<0?function(h,m){let _,x;if(h>=0?(_=h%4294967296|0,x=h/4294967296|0):(_=~(-h%4294967296),x=~(-h/4294967296),4294967295^_?_=_+1|0:(_=0,x=x+1|0)),h>=18446744073709552e3||h<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");m.realloc(10),function(w,E,B){B.buf[B.pos++]=127&w|128,w>>>=7,B.buf[B.pos++]=127&w|128,w>>>=7,B.buf[B.pos++]=127&w|128,w>>>=7,B.buf[B.pos++]=127&w|128,B.buf[B.pos]=127&(w>>>=7)}(_,0,m),function(w,E){const B=(7&w)<<4;E.buf[E.pos++]|=B|((w>>>=3)?128:0),w&&(E.buf[E.pos++]=127&w|((w>>>=7)?128:0),w&&(E.buf[E.pos++]=127&w|((w>>>=7)?128:0),w&&(E.buf[E.pos++]=127&w|((w>>>=7)?128:0),w&&(E.buf[E.pos++]=127&w|((w>>>=7)?128:0),w&&(E.buf[E.pos++]=127&w)))))}(x,m)}(l,this):(this.realloc(4),this.buf[this.pos++]=127&l|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=127&(l>>>=7)|(l>127?128:0),l<=127||(this.buf[this.pos++]=l>>>7&127))))}writeSVarint(l){this.writeVarint(l<0?2*-l-1:2*l)}writeBoolean(l){this.writeVarint(+l)}writeString(l){l=String(l),this.realloc(4*l.length),this.pos++;const h=this.pos;this.pos=function(_,x,w){for(let E,B,O=0;O<x.length;O++){if(E=x.charCodeAt(O),E>55295&&E<57344){if(!B){E>56319||O+1===x.length?(_[w++]=239,_[w++]=191,_[w++]=189):B=E;continue}if(E<56320){_[w++]=239,_[w++]=191,_[w++]=189,B=E;continue}E=B-55296<<10|E-56320|65536,B=null}else B&&(_[w++]=239,_[w++]=191,_[w++]=189,B=null);E<128?_[w++]=E:(E<2048?_[w++]=E>>6|192:(E<65536?_[w++]=E>>12|224:(_[w++]=E>>18|240,_[w++]=E>>12&63|128),_[w++]=E>>6&63|128),_[w++]=63&E|128)}return w}(this.buf,l,this.pos);const m=this.pos-h;m>=128&&cN(h,m,this),this.pos=h-1,this.writeVarint(m),this.pos+=m}writeFloat(l){this.realloc(4),this.dataView.setFloat32(this.pos,l,!0),this.pos+=4}writeDouble(l){this.realloc(8),this.dataView.setFloat64(this.pos,l,!0),this.pos+=8}writeBytes(l){const h=l.length;this.writeVarint(h),this.realloc(h);for(let m=0;m<h;m++)this.buf[this.pos++]=l[m]}writeRawMessage(l,h){this.pos++;const m=this.pos;l(h,this);const _=this.pos-m;_>=128&&cN(m,_,this),this.pos=m-1,this.writeVarint(_),this.pos+=_}writeMessage(l,h,m){this.writeTag(l,2),this.writeRawMessage(h,m)}writePackedVarint(l,h){h.length&&this.writeMessage(l,bee,h)}writePackedSVarint(l,h){h.length&&this.writeMessage(l,_ee,h)}writePackedBoolean(l,h){h.length&&this.writeMessage(l,xee,h)}writePackedFloat(l,h){h.length&&this.writeMessage(l,vee,h)}writePackedDouble(l,h){h.length&&this.writeMessage(l,Aee,h)}writePackedFixed32(l,h){h.length&&this.writeMessage(l,wee,h)}writePackedSFixed32(l,h){h.length&&this.writeMessage(l,Cee,h)}writePackedFixed64(l,h){h.length&&this.writeMessage(l,Tee,h)}writePackedSFixed64(l,h){h.length&&this.writeMessage(l,See,h)}writeBytesField(l,h){this.writeTag(l,2),this.writeBytes(h)}writeFixed32Field(l,h){this.writeTag(l,5),this.writeFixed32(h)}writeSFixed32Field(l,h){this.writeTag(l,5),this.writeSFixed32(h)}writeFixed64Field(l,h){this.writeTag(l,1),this.writeFixed64(h)}writeSFixed64Field(l,h){this.writeTag(l,1),this.writeSFixed64(h)}writeVarintField(l,h){this.writeTag(l,0),this.writeVarint(h)}writeSVarintField(l,h){this.writeTag(l,0),this.writeSVarint(h)}writeStringField(l,h){this.writeTag(l,2),this.writeString(h)}writeFloatField(l,h){this.writeTag(l,5),this.writeFloat(h)}writeDoubleField(l,h){this.writeTag(l,1),this.writeDouble(h)}writeBooleanField(l,h){this.writeVarintField(l,+h)}}function _g(d,l,h){return h?4294967296*l+(d>>>0):4294967296*(l>>>0)+(d>>>0)}function cN(d,l,h){const m=l<=16383?1:l<=2097151?2:l<=268435455?3:Math.floor(Math.log(l)/(7*Math.LN2));h.realloc(m);for(let _=h.pos-1;_>=d;_--)h.buf[_+m]=h.buf[_]}function bee(d,l){for(let h=0;h<d.length;h++)l.writeVarint(d[h])}function _ee(d,l){for(let h=0;h<d.length;h++)l.writeSVarint(d[h])}function vee(d,l){for(let h=0;h<d.length;h++)l.writeFloat(d[h])}function Aee(d,l){for(let h=0;h<d.length;h++)l.writeDouble(d[h])}function xee(d,l){for(let h=0;h<d.length;h++)l.writeBoolean(d[h])}function wee(d,l){for(let h=0;h<d.length;h++)l.writeFixed32(d[h])}function Cee(d,l){for(let h=0;h<d.length;h++)l.writeSFixed32(d[h])}function Tee(d,l){for(let h=0;h<d.length;h++)l.writeFixed64(d[h])}function See(d,l){for(let h=0;h<d.length;h++)l.writeSFixed64(d[h])}function Eee(d,l,h){d===1&&h.readMessage(Iee,l)}function Iee(d,l,h){if(d===3){const{id:m,bitmap:_,width:x,height:w,left:E,top:B,advance:O}=h.readMessage(Pee,{});l.push({id:m,bitmap:new Sb({width:x+6,height:w+6},_),metrics:{width:x,height:w,left:E,top:B,advance:O}})}}function Pee(d,l,h){d===1?l.id=h.readVarint():d===2?l.bitmap=h.readBytes():d===3?l.width=h.readVarint():d===4?l.height=h.readVarint():d===5?l.left=h.readSVarint():d===6?l.top=h.readSVarint():d===7&&(l.advance=h.readVarint())}function uN(d){let l=0,h=0;for(const w of d)l+=w.w*w.h,h=Math.max(h,w.w);d.sort((w,E)=>E.h-w.h);const m=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(l/.95)),h),h:1/0}];let _=0,x=0;for(const w of d)for(let E=m.length-1;E>=0;E--){const B=m[E];if(!(w.w>B.w||w.h>B.h)){if(w.x=B.x,w.y=B.y,x=Math.max(x,w.y+w.h),_=Math.max(_,w.x+w.w),w.w===B.w&&w.h===B.h){const O=m.pop();O&&E<m.length&&(m[E]=O)}else w.h===B.h?(B.x+=w.w,B.w-=w.w):w.w===B.w?(B.y+=w.h,B.h-=w.h):(m.push({x:B.x+w.w,y:B.y,w:B.w-w.w,h:w.h}),B.y+=w.h,B.h-=w.h);break}}return{w:_,h:x,fill:l/(_*x)||0}}class sE{constructor(l,{pixelRatio:h,version:m,stretchX:_,stretchY:x,content:w,textFitWidth:E,textFitHeight:B}){this.paddedRect=l,this.pixelRatio=h,this.stretchX=_,this.stretchY=x,this.content=w,this.version=m,this.textFitWidth=E,this.textFitHeight=B}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class hN{constructor(l,h){const m={},_={};this.haveRenderCallbacks=[];const x=[];this.addImages(l,m,x),this.addImages(h,_,x);const{w,h:E}=uN(x),B=new Bo({width:w||1,height:E||1});for(const O in l){const N=l[O],U=m[O].paddedRect;Bo.copy(N.data,B,{x:0,y:0},{x:U.x+1,y:U.y+1},N.data)}for(const O in h){const N=h[O],U=_[O].paddedRect,G=U.x+1,K=U.y+1,q=N.data.width,Z=N.data.height;Bo.copy(N.data,B,{x:0,y:0},{x:G,y:K},N.data),Bo.copy(N.data,B,{x:0,y:Z-1},{x:G,y:K-1},{width:q,height:1}),Bo.copy(N.data,B,{x:0,y:0},{x:G,y:K+Z},{width:q,height:1}),Bo.copy(N.data,B,{x:q-1,y:0},{x:G-1,y:K},{width:1,height:Z}),Bo.copy(N.data,B,{x:0,y:0},{x:G+q,y:K},{width:1,height:Z})}this.image=B,this.iconPositions=m,this.patternPositions=_}addImages(l,h,m){for(const _ in l){const x=l[_],w={x:0,y:0,w:x.data.width+2,h:x.data.height+2};m.push(w),h[_]=new sE(w,x),x.hasRenderCallback&&this.haveRenderCallbacks.push(_)}}patchUpdatedImages(l,h){l.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const m in l.updatedImages)this.patchUpdatedImage(this.iconPositions[m],l.getImage(m),h),this.patchUpdatedImage(this.patternPositions[m],l.getImage(m),h)}patchUpdatedImage(l,h,m){if(!l||!h||l.version===h.version)return;l.version=h.version;const[_,x]=l.tl;m.update(h.data,void 0,{x:_,y:x})}}var Ph;function p1(d,l,h,m,_,x,w,E,B,O,N,U,G,K,q){const Z=bg.fromFeature(d,_);let ee;U===a.az.vertical&&Z.verticalizePunctuation();let ue=Z.determineLineBreaks(O,x,l,m,K);const{processBidirectionalText:xe,processStyledBidirectionalText:fe}=vc;if(xe&&Z.sections.length===1){ee=[],ue=ue.map(Ze=>Z.toCodeUnitIndex(Ze));const Oe=xe(Z.toString(),ue);for(const Ze of Oe){const xt=[...Ze].map(()=>0);ee.push(new bg(Ze,Z.sections,xt))}}else if(fe){ee=[],ue=ue.map(ht=>Z.toCodeUnitIndex(ht));let Oe=0;const Ze=[];for(const ht of Z.text)Ze.push(...Array(ht.length).fill(Z.sectionIndex[Oe])),Oe++;const xt=fe(Z.text,Ze,ue);for(const ht of xt){const Ct=[];let Vt="";for(const Et of ht[0])Ct.push(ht[1][Vt.length]),Vt+=Et;ee.push(new bg(ht[0],Z.sections,Ct))}}else ee=function(Oe,Ze){const xt=[];let ht=0;for(const Ct of Ze)xt.push(Oe.substring(ht,Ct)),ht=Ct;return ht<Oe.length()&&xt.push(Oe.substring(ht,Oe.length())),xt}(Z,ue);const pe=[],Te={positionedLines:pe,text:Z.toString(),top:N[1],bottom:N[1],left:N[0],right:N[0],writingMode:U,iconsInText:!1,verticalizable:!1};return function(Oe,Ze,xt,ht,Ct,Vt,Et,bt,at,Yt,Jt,ir){let Xt=0,dr=0,an=0,Gr=0;const ai=bt==="right"?1:bt==="left"?0:.5,Ds=ls/ir;let zi=0;for(const mn of Ct){mn.trim();const _i=mn.getMaxScale(),Ei={positionedGlyphs:[],lineOffset:0};Oe.positionedLines[zi]=Ei;const Wn=Ei.positionedGlyphs;let Mo=0;if(!mn.length()){dr+=Vt,++zi;continue}const Ls=Bee(ht,mn,Ds);let Ro=0;for(const hs of mn.text){const fi=mn.getSection(Ro),Vi=hs.codePointAt(0),vi=Mee(at,Jt,Vi),ds={glyph:Vi,imageName:null,x:Xt,y:dr+-17,vertical:vi,scale:1,fontStack:"",sectionIndex:mn.getSectionIndex(Ro),metrics:null,rect:null};let wu;if("fontStack"in fi){if(wu=Ree(fi,Vi,vi,Ls,Ze,xt),!wu)continue;ds.fontStack=fi.fontStack}else{if(Oe.iconsInText=!0,fi.scale*=Ds,wu=kee(fi,vi,_i,Ls,ht),!wu)continue;Mo=Math.max(Mo,wu.imageOffset),ds.imageName=fi.imageName}const{rect:Ml,metrics:jb,baselineOffset:Oh}=wu;ds.y+=Oh,ds.scale=fi.scale,ds.metrics=jb,ds.rect=Ml,Wn.push(ds),vi?(Oe.verticalizable=!0,Xt+=("imageName"in fi?jb.advance:ls)*fi.scale+Yt):Xt+=jb.advance*fi.scale+Yt,Ro++}Wn.length!==0&&(an=Math.max(Xt-Yt,an),Oee(Wn,0,Wn.length-1,ai)),Xt=0,Ei.lineOffset=Math.max(Mo,(_i-1)*ls);const nl=Vt*_i+Mo;dr+=nl,Gr=Math.max(nl,Gr),++zi}const{horizontalAlign:li,verticalAlign:Yn}=oE(Et);(function(mn,_i,Ei,Wn,Mo,Ls,Ro,nl,hs){const fi=(_i-Ei)*Mo;let Vi=0;Vi=Ls!==Ro?-nl*Wn- -17:-Wn*hs*Ro+.5*Ro;for(const vi of mn)for(const ds of vi.positionedGlyphs)ds.x+=fi,ds.y+=Vi})(Oe.positionedLines,ai,li,Yn,an,Gr,Vt,dr,Ct.length),Oe.top+=-Yn*dr,Oe.bottom=Oe.top+dr,Oe.left+=-li*an,Oe.right=Oe.left+an}(Te,l,h,m,ee,w,E,B,U,O,G,q),!function(Oe){for(const Ze of Oe)if(Ze.positionedGlyphs.length!==0)return!1;return!0}(pe)&&Te}function oE(d){let l=.5,h=.5;switch(d){case"right":case"top-right":case"bottom-right":l=1;break;case"left":case"top-left":case"bottom-left":l=0}switch(d){case"bottom":case"bottom-right":case"bottom-left":h=1;break;case"top":case"top-right":case"top-left":h=0}return{horizontalAlign:l,verticalAlign:h}}function Bee(d,l,h){const m=l.getMaxScale()*ls,{maxImageWidth:_,maxImageHeight:x}=l.getMaxImageSize(d),w=Math.max(m,x*h);return{verticalLineContentWidth:Math.max(m,_*h),horizontalLineContentHeight:w}}function dN(d){switch(d){case"top":return 0;case"center":return .5;default:return 1}}function Mee(d,l,h){return!(d===a.az.horizontal||!l&&!hb(h)||l&&(XA(h)||(m=h,/\p{sc=Arab}/u.test(String.fromCodePoint(m)))));var m}function Ree(d,l,h,m,_,x){const w=x[d.fontStack],E=function(O,N,U,G){if(O&&O.rect)return O;const K=N[U.fontStack],q=K&&K[G];return q?{rect:null,metrics:q.metrics}:null}(w&&w[l],_,d,l);if(E===null)return null;let B;if(h)B=m.verticalLineContentWidth-d.scale*ls;else{const O=dN(d.verticalAlign);B=(m.horizontalLineContentHeight-d.scale*ls)*O}return{rect:E.rect,metrics:E.metrics,baselineOffset:B}}function kee(d,l,h,m,_){const x=_[d.imageName];if(!x)return null;const w=x.paddedRect,E=x.displaySize,B={width:E[0],height:E[1],left:1,top:-3,advance:l?E[1]:E[0]};let O;if(l)O=m.verticalLineContentWidth-E[1]*d.scale;else{const N=dN(d.verticalAlign);O=(m.horizontalLineContentHeight-E[1]*d.scale)*N}return{rect:w,metrics:B,baselineOffset:O,imageOffset:(l?E[0]:E[1])*d.scale-ls*h}}function Oee(d,l,h,m){if(m===0)return;const _=d[h],x=(d[h].x+_.metrics.advance*_.scale)*m;for(let w=l;w<=h;w++)d[w].x-=x}function Dee(d,l,h){const{horizontalAlign:m,verticalAlign:_}=oE(h),x=l[0]-d.displaySize[0]*m,w=l[1]-d.displaySize[1]*_;return{image:d,top:w,bottom:w+d.displaySize[1],left:x,right:x+d.displaySize[0]}}function fN(d){var l,h;let m=d.left,_=d.top,x=d.right-m,w=d.bottom-_;const E=(l=d.image.textFitWidth)!==null&&l!==void 0?l:"stretchOrShrink",B=(h=d.image.textFitHeight)!==null&&h!==void 0?h:"stretchOrShrink",O=(d.image.content[2]-d.image.content[0])/(d.image.content[3]-d.image.content[1]);if(B==="proportional"){if(E==="stretchOnly"&&x/w<O||E==="proportional"){const N=Math.ceil(w*O);m*=N/x,x=N}}else if(E==="proportional"&&B==="stretchOnly"&&O!==0&&x/w>O){const N=Math.ceil(x/O);_*=N/w,w=N}return{x1:m,y1:_,x2:m+x,y2:_+w}}function pN(d,l,h,m,_,x){const w=d.image;let E;if(w.content){const ee=w.content,ue=w.pixelRatio||1;E=[ee[0]/ue,ee[1]/ue,w.displaySize[0]-ee[2]/ue,w.displaySize[1]-ee[3]/ue]}const B=l.left*x,O=l.right*x;let N,U,G,K;h==="width"||h==="both"?(K=_[0]+B-m[3],U=_[0]+O+m[1]):(K=_[0]+(B+O-w.displaySize[0])/2,U=K+w.displaySize[0]);const q=l.top*x,Z=l.bottom*x;return h==="height"||h==="both"?(N=_[1]+q-m[0],G=_[1]+Z+m[2]):(N=_[1]+(q+Z-w.displaySize[1])/2,G=N+w.displaySize[1]),{image:w,top:N,right:U,bottom:G,left:K,collisionPadding:E}}er("ImagePosition",sE),er("ImageAtlas",hN),a.az=void 0,(Ph=a.az||(a.az={}))[Ph.none=0]="none",Ph[Ph.horizontal=1]="horizontal",Ph[Ph.vertical=2]="vertical",Ph[Ph.horizontalOnly=3]="horizontalOnly";const Au=128,Bh=32640;function gN(d,l){const{expression:h}=l;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new kn(d+1))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:m,interpolationType:_}=h;let x=0;for(;x<m.length&&m[x]<=d;)x++;x=Math.max(0,x-1);let w=x;for(;w<m.length&&m[w]<d+1;)w++;w=Math.min(m.length-1,w);const E=m[x],B=m[w];return h.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:B,interpolationType:_}:{kind:"camera",minZoom:E,maxZoom:B,minSize:h.evaluate(new kn(E)),maxSize:h.evaluate(new kn(B)),interpolationType:_}}}function aE(d,l,h){let m="never";const _=d.get(l);return _?m=_:d.get(h)&&(m="always"),m}const Lee=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function g1(d,l,h,m,_,x,w,E,B,O,N,U,G){const K=E?Math.min(Bh,Math.round(E[0])):0,q=E?Math.min(Bh,Math.round(E[1])):0;d.emplaceBack(l,h,Math.round(32*m),Math.round(32*_),x,w,(K<<1)+(B?1:0),q,16*O,16*N,256*U,256*G)}function lE(d,l,h){d.emplaceBack(l.x,l.y,h),d.emplaceBack(l.x,l.y,h),d.emplaceBack(l.x,l.y,h),d.emplaceBack(l.x,l.y,h)}function Nee(d){for(const l of d.sections)if(YA(l.text))return!0;return!1}class cE{constructor(l){this.layoutVertexArray=new Pe,this.indexArray=new st,this.programConfigurations=l,this.segments=new Ht,this.dynamicLayoutVertexArray=new $e,this.opacityVertexArray=new ct,this.hasVisibleVertices=!1,this.placedSymbolArray=new P}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(l,h,m,_){this.isEmpty()||(m&&(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,uee.members),this.indexBuffer=l.createIndexBuffer(this.indexArray,h),this.dynamicLayoutVertexBuffer=l.createVertexBuffer(this.dynamicLayoutVertexArray,hee.members,!0),this.opacityVertexBuffer=l.createVertexBuffer(this.opacityVertexArray,Lee,!0),this.opacityVertexBuffer.itemSize=1),(m||_)&&this.programConfigurations.upload(l))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}er("SymbolBuffers",cE);class uE{constructor(l,h,m){this.layoutVertexArray=new l,this.layoutAttributes=h,this.indexArray=new m,this.segments=new Ht,this.collisionVertexArray=new it}upload(l){this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=l.createVertexBuffer(this.collisionVertexArray,dee.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}er("CollisionBuffers",uE);class vg{constructor(l){this.collisionBoxArray=l.collisionBoxArray,this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(w=>w.id),this.index=l.index,this.pixelRatio=l.pixelRatio,this.sourceLayerIndex=l.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const h=this.layers[0]._unevaluatedLayout._values;this.textSizeData=gN(this.zoom,h["text-size"]),this.iconSizeData=gN(this.zoom,h["icon-size"]);const m=this.layers[0].layout,_=m.get("symbol-sort-key"),x=m.get("symbol-z-order");this.canOverlap=aE(m,"text-overlap","text-allow-overlap")!=="never"||aE(m,"icon-overlap","icon-allow-overlap")!=="never"||m.get("text-ignore-placement")||m.get("icon-ignore-placement"),this.sortFeaturesByKey=x!=="viewport-y"&&!_.isConstant(),this.sortFeaturesByY=(x==="viewport-y"||x==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,m.get("symbol-placement")==="point"&&(this.writingModes=m.get("text-writing-mode").map(w=>a.az[w])),this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id),this.sourceID=l.sourceID}createArrays(){this.text=new cE(new vu(this.layers,this.zoom,l=>/^text/.test(l))),this.icon=new cE(new vu(this.layers,this.zoom,l=>/^icon/.test(l))),this.glyphOffsetArray=new F,this.lineVertexArray=new j,this.symbolInstances=new L,this.textAnchorOffsets=new X}calculateGlyphDependencies(l,h,m,_,x){for(const w of l)if(h[w.codePointAt(0)]=!0,(m||_)&&x){const E=Lb[w];E&&(h[E.codePointAt(0)]=!0)}}populate(l,h,m){const _=this.layers[0],x=_.layout,w=x.get("text-font"),E=x.get("text-field"),B=x.get("icon-image"),O=(E.value.kind!=="constant"||E.value.value instanceof Cs&&!E.value.value.isEmpty()||E.value.value.toString().length>0)&&(w.value.kind!=="constant"||w.value.value.length>0),N=B.value.kind!=="constant"||!!B.value.value||Object.keys(B.parameters).length>0,U=x.get("symbol-sort-key");if(this.features=[],!O&&!N)return;const G=h.iconDependencies,K=h.glyphDependencies,q=h.availableImages,Z=new kn(this.zoom);for(const{feature:ee,id:ue,index:xe,sourceLayerIndex:fe}of l){const pe=_._featureFilter.needGeometry,Te=Cc(ee,pe);if(!_._featureFilter.filter(Z,Te,m))continue;let Oe,Ze;if(pe||(Te.geometry=wc(ee)),O){const ht=_.getValueAndResolveTokens("text-field",Te,m,q),Ct=Cs.factory(ht),Vt=this.hasRTLText=this.hasRTLText||Nee(Ct);(!Vt||vc.getRTLTextPluginStatus()==="unavailable"||Vt&&vc.isParsed())&&(Oe=pee(Ct,_,Te))}if(N){const ht=_.getValueAndResolveTokens("icon-image",Te,m,q);Ze=ht instanceof Io?ht:Io.fromString(ht)}if(!Oe&&!Ze)continue;const xt=this.sortFeaturesByKey?U.evaluate(Te,{},m):void 0;if(this.features.push({id:ue,text:Oe,icon:Ze,index:xe,sourceLayerIndex:fe,geometry:Te.geometry,properties:ee.properties,type:kb.types[ee.type],sortKey:xt}),Ze&&(G[Ze.name]=!0),Oe){const ht=w.evaluate(Te,{},m).join(","),Ct=x.get("text-rotation-alignment")!=="viewport"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(a.az.vertical)>=0;for(const Vt of Oe.sections)if(Vt.image)G[Vt.image.name]=!0;else{const Et=Eh(Oe.toString()),bt=Vt.fontStack||ht,at=K[bt]=K[bt]||{};this.calculateGlyphDependencies(Vt.text,at,Ct,this.allowVerticalPlacement,Et)}}}x.get("symbol-placement")==="line"&&(this.features=function(ee){const ue={},xe={},fe=[];let pe=0;function Te(ht){fe.push(ee[ht]),pe++}function Oe(ht,Ct,Vt){const Et=xe[ht];return delete xe[ht],xe[Ct]=Et,fe[Et].geometry[0].pop(),fe[Et].geometry[0]=fe[Et].geometry[0].concat(Vt[0]),Et}function Ze(ht,Ct,Vt){const Et=ue[Ct];return delete ue[Ct],ue[ht]=Et,fe[Et].geometry[0].shift(),fe[Et].geometry[0]=Vt[0].concat(fe[Et].geometry[0]),Et}function xt(ht,Ct,Vt){const Et=Vt?Ct[0][Ct[0].length-1]:Ct[0][0];return`${ht}:${Et.x}:${Et.y}`}for(let ht=0;ht<ee.length;ht++){const Ct=ee[ht],Vt=Ct.geometry,Et=Ct.text?Ct.text.toString():null;if(!Et){Te(ht);continue}const bt=xt(Et,Vt),at=xt(Et,Vt,!0);if(bt in xe&&at in ue&&xe[bt]!==ue[at]){const Yt=Ze(bt,at,Vt),Jt=Oe(bt,at,fe[Yt].geometry);delete ue[bt],delete xe[at],xe[xt(Et,fe[Jt].geometry,!0)]=Jt,fe[Yt].geometry=null}else bt in xe?Oe(bt,at,Vt):at in ue?Ze(bt,at,Vt):(Te(ht),ue[bt]=pe-1,xe[at]=pe-1)}return fe.filter(ht=>ht.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ee,ue)=>ee.sortKey-ue.sortKey)}update(l,h,m){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(l,h,this.layers,{imagePositions:m}),this.icon.programConfigurations.updatePaintArrays(l,h,this.layers,{imagePositions:m}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(l){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(l),this.iconCollisionBox.upload(l)),this.text.upload(l,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(l,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(l,h){const m=this.lineVertexArray.length;if(l.segment!==void 0){let _=l.dist(h[l.segment+1]),x=l.dist(h[l.segment]);const w={};for(let E=l.segment+1;E<h.length;E++)w[E]={x:h[E].x,y:h[E].y,tileUnitDistanceFromAnchor:_},E<h.length-1&&(_+=h[E+1].dist(h[E]));for(let E=l.segment||0;E>=0;E--)w[E]={x:h[E].x,y:h[E].y,tileUnitDistanceFromAnchor:x},E>0&&(x+=h[E-1].dist(h[E]));for(let E=0;E<h.length;E++){const B=w[E];this.lineVertexArray.emplaceBack(B.x,B.y,B.tileUnitDistanceFromAnchor)}}return{lineStartIndex:m,lineLength:this.lineVertexArray.length-m}}addSymbols(l,h,m,_,x,w,E,B,O,N,U,G){const K=l.indexArray,q=l.layoutVertexArray,Z=l.segments.prepareSegment(4*h.length,q,K,this.canOverlap?w.sortKey:void 0),ee=this.glyphOffsetArray.length,ue=Z.vertexLength,xe=this.allowVerticalPlacement&&E===a.az.vertical?Math.PI/2:0,fe=w.text&&w.text.sections;for(let pe=0;pe<h.length;pe++){const{tl:Te,tr:Oe,bl:Ze,br:xt,tex:ht,pixelOffsetTL:Ct,pixelOffsetBR:Vt,minFontScaleX:Et,minFontScaleY:bt,glyphOffset:at,isSDF:Yt,sectionIndex:Jt}=h[pe],ir=Z.vertexLength,Xt=at[1];g1(q,B.x,B.y,Te.x,Xt+Te.y,ht.x,ht.y,m,Yt,Ct.x,Ct.y,Et,bt),g1(q,B.x,B.y,Oe.x,Xt+Oe.y,ht.x+ht.w,ht.y,m,Yt,Vt.x,Ct.y,Et,bt),g1(q,B.x,B.y,Ze.x,Xt+Ze.y,ht.x,ht.y+ht.h,m,Yt,Ct.x,Vt.y,Et,bt),g1(q,B.x,B.y,xt.x,Xt+xt.y,ht.x+ht.w,ht.y+ht.h,m,Yt,Vt.x,Vt.y,Et,bt),lE(l.dynamicLayoutVertexArray,B,xe),K.emplaceBack(ir,ir+2,ir+1),K.emplaceBack(ir+1,ir+2,ir+3),Z.vertexLength+=4,Z.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(at[0]),pe!==h.length-1&&Jt===h[pe+1].sectionIndex||l.programConfigurations.populatePaintArrays(q.length,w,w.index,{imagePositions:{},canonical:G,formattedSection:fe&&fe[Jt]})}l.placedSymbolArray.emplaceBack(B.x,B.y,ee,this.glyphOffsetArray.length-ee,ue,O,N,B.segment,m?m[0]:0,m?m[1]:0,_[0],_[1],E,0,!1,0,U)}_addCollisionDebugVertex(l,h,m,_,x,w){return h.emplaceBack(0,0),l.emplaceBack(m.x,m.y,_,x,Math.round(w.x),Math.round(w.y))}addCollisionDebugVertices(l,h,m,_,x,w,E){const B=x.segments.prepareSegment(4,x.layoutVertexArray,x.indexArray),O=B.vertexLength,N=x.layoutVertexArray,U=x.collisionVertexArray,G=E.anchorX,K=E.anchorY;this._addCollisionDebugVertex(N,U,w,G,K,new u(l,h)),this._addCollisionDebugVertex(N,U,w,G,K,new u(m,h)),this._addCollisionDebugVertex(N,U,w,G,K,new u(m,_)),this._addCollisionDebugVertex(N,U,w,G,K,new u(l,_)),B.vertexLength+=4;const q=x.indexArray;q.emplaceBack(O,O+1),q.emplaceBack(O+1,O+2),q.emplaceBack(O+2,O+3),q.emplaceBack(O+3,O),B.primitiveLength+=4}addDebugCollisionBoxes(l,h,m,_){for(let x=l;x<h;x++){const w=this.collisionBoxArray.get(x);this.addCollisionDebugVertices(w.x1,w.y1,w.x2,w.y2,_?this.textCollisionBox:this.iconCollisionBox,w.anchorPoint,m)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new uE(tt,rN.members,Ot),this.iconCollisionBox=new uE(tt,rN.members,Ot);for(let l=0;l<this.symbolInstances.length;l++){const h=this.symbolInstances.get(l);this.addDebugCollisionBoxes(h.textBoxStartIndex,h.textBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.iconBoxStartIndex,h.iconBoxEndIndex,h,!1),this.addDebugCollisionBoxes(h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h,!1)}}_deserializeCollisionBoxesForSymbol(l,h,m,_,x,w,E,B,O){const N={};for(let U=h;U<m;U++){const G=l.get(U);N.textBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},N.textFeatureIndex=G.featureIndex;break}for(let U=_;U<x;U++){const G=l.get(U);N.verticalTextBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},N.verticalTextFeatureIndex=G.featureIndex;break}for(let U=w;U<E;U++){const G=l.get(U);N.iconBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},N.iconFeatureIndex=G.featureIndex;break}for(let U=B;U<O;U++){const G=l.get(U);N.verticalIconBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},N.verticalIconFeatureIndex=G.featureIndex;break}return N}deserializeCollisionBoxes(l){this.collisionArrays=[];for(let h=0;h<this.symbolInstances.length;h++){const m=this.symbolInstances.get(h);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(l,m.textBoxStartIndex,m.textBoxEndIndex,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m.iconBoxStartIndex,m.iconBoxEndIndex,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(l,h){const m=l.placedSymbolArray.get(h),_=m.vertexStartIndex+4*m.numGlyphs;for(let x=m.vertexStartIndex;x<_;x+=4)l.indexArray.emplaceBack(x,x+2,x+1),l.indexArray.emplaceBack(x+1,x+2,x+3)}getSortedSymbolIndexes(l){if(this.sortedAngle===l&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const h=Math.sin(l),m=Math.cos(l),_=[],x=[],w=[];for(let E=0;E<this.symbolInstances.length;++E){w.push(E);const B=this.symbolInstances.get(E);_.push(0|Math.round(h*B.anchorX+m*B.anchorY)),x.push(B.featureIndex)}return w.sort((E,B)=>_[E]-_[B]||x[B]-x[E]),w}addToSortKeyRanges(l,h){const m=this.sortKeyRanges[this.sortKeyRanges.length-1];m&&m.sortKey===h?m.symbolInstanceEnd=l+1:this.sortKeyRanges.push({sortKey:h,symbolInstanceStart:l,symbolInstanceEnd:l+1})}sortFeatures(l){if(this.sortFeaturesByY&&this.sortedAngle!==l&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(l),this.sortedAngle=l,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const h of this.symbolInstanceIndexes){const m=this.symbolInstances.get(h);this.featureSortOrder.push(m.featureIndex),[m.rightJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.leftJustifiedTextSymbolIndex].forEach((_,x,w)=>{_>=0&&w.indexOf(_)===x&&this.addIndicesForPlacedSymbol(this.text,_)}),m.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,m.verticalPlacedTextSymbolIndex),m.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,m.placedIconSymbolIndex),m.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,m.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let mN,yN;er("SymbolBucket",vg,{omit:["layers","collisionBoxArray","features","compareText"]}),vg.MAX_GLYPHS=65535,vg.addDynamicAttributes=lE;var hE={get paint(){return yN=yN||new qs({"icon-opacity":new Ar(et.paint_symbol["icon-opacity"]),"icon-color":new Ar(et.paint_symbol["icon-color"]),"icon-halo-color":new Ar(et.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ar(et.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ar(et.paint_symbol["icon-halo-blur"]),"icon-translate":new hr(et.paint_symbol["icon-translate"]),"icon-translate-anchor":new hr(et.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ar(et.paint_symbol["text-opacity"]),"text-color":new Ar(et.paint_symbol["text-color"],{runtimeType:Ws,getOverride:d=>d.textColor,hasOverride:d=>!!d.textColor}),"text-halo-color":new Ar(et.paint_symbol["text-halo-color"]),"text-halo-width":new Ar(et.paint_symbol["text-halo-width"]),"text-halo-blur":new Ar(et.paint_symbol["text-halo-blur"]),"text-translate":new hr(et.paint_symbol["text-translate"]),"text-translate-anchor":new hr(et.paint_symbol["text-translate-anchor"])})},get layout(){return mN=mN||new qs({"symbol-placement":new hr(et.layout_symbol["symbol-placement"]),"symbol-spacing":new hr(et.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new hr(et.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ar(et.layout_symbol["symbol-sort-key"]),"symbol-z-order":new hr(et.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new hr(et.layout_symbol["icon-allow-overlap"]),"icon-overlap":new hr(et.layout_symbol["icon-overlap"]),"icon-ignore-placement":new hr(et.layout_symbol["icon-ignore-placement"]),"icon-optional":new hr(et.layout_symbol["icon-optional"]),"icon-rotation-alignment":new hr(et.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ar(et.layout_symbol["icon-size"]),"icon-text-fit":new hr(et.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new hr(et.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ar(et.layout_symbol["icon-image"]),"icon-rotate":new Ar(et.layout_symbol["icon-rotate"]),"icon-padding":new Ar(et.layout_symbol["icon-padding"]),"icon-keep-upright":new hr(et.layout_symbol["icon-keep-upright"]),"icon-offset":new Ar(et.layout_symbol["icon-offset"]),"icon-anchor":new Ar(et.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new hr(et.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new hr(et.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new hr(et.layout_symbol["text-rotation-alignment"]),"text-field":new Ar(et.layout_symbol["text-field"]),"text-font":new Ar(et.layout_symbol["text-font"]),"text-size":new Ar(et.layout_symbol["text-size"]),"text-max-width":new Ar(et.layout_symbol["text-max-width"]),"text-line-height":new hr(et.layout_symbol["text-line-height"]),"text-letter-spacing":new Ar(et.layout_symbol["text-letter-spacing"]),"text-justify":new Ar(et.layout_symbol["text-justify"]),"text-radial-offset":new Ar(et.layout_symbol["text-radial-offset"]),"text-variable-anchor":new hr(et.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Ar(et.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Ar(et.layout_symbol["text-anchor"]),"text-max-angle":new hr(et.layout_symbol["text-max-angle"]),"text-writing-mode":new hr(et.layout_symbol["text-writing-mode"]),"text-rotate":new Ar(et.layout_symbol["text-rotate"]),"text-padding":new hr(et.layout_symbol["text-padding"]),"text-keep-upright":new hr(et.layout_symbol["text-keep-upright"]),"text-transform":new Ar(et.layout_symbol["text-transform"]),"text-offset":new Ar(et.layout_symbol["text-offset"]),"text-allow-overlap":new hr(et.layout_symbol["text-allow-overlap"]),"text-overlap":new hr(et.layout_symbol["text-overlap"]),"text-ignore-placement":new hr(et.layout_symbol["text-ignore-placement"]),"text-optional":new hr(et.layout_symbol["text-optional"])})}};class bN{constructor(l){if(l.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=l.property.overrides?l.property.overrides.runtimeType:Hs,this.defaultValue=l}evaluate(l){if(l.formattedSection){const h=this.defaultValue.property.overrides;if(h&&h.hasOverride(l.formattedSection))return h.getOverride(l.formattedSection)}return l.feature&&l.featureState?this.defaultValue.evaluate(l.feature,l.featureState):this.defaultValue.property.specification.default}eachChild(l){this.defaultValue.isConstant()||l(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}er("FormatSectionOverride",bN,{omit:["defaultValue"]});class m1 extends Jo{constructor(l,h){super(l,hE,h)}recalculate(l,h){if(super.recalculate(l,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const m=this.layout.get("text-writing-mode");if(m){const _=[];for(const x of m)_.indexOf(x)<0&&_.push(x);this.layout._values["text-writing-mode"]=_}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(l,h,m,_){const x=this.layout.get(l).evaluate(h,{},m,_),w=this._unevaluatedLayout._values[l];return w.isDataDriven()||xh(w.value)||!x?x:function(E,B){return B.replace(/{([^{}]+)}/g,(O,N)=>E&&N in E?String(E[N]):"")}(h.properties,x)}createBucket(l){return new vg(l)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const l of hE.paint.overridableProperties){if(!m1.hasPaintOverride(this.layout,l))continue;const h=this.paint.get(l),m=new bN(h),_=new Qy(m,h.property.specification);let x=null;x=h.value.kind==="constant"||h.value.kind==="source"?new Hp("source",_):new eb("composite",_,h.value.zoomStops),this.paint._values[l]=new xa(h.property,x,h.parameters)}}_handleOverridablePaintPropertyUpdate(l,h,m){return!(!this.layout||h.isDataDriven()||m.isDataDriven())&&m1.hasPaintOverride(this.layout,l)}static hasPaintOverride(l,h){const m=l.get("text-field"),_=hE.paint.properties[h];let x=!1;const w=E=>{for(const B of E)if(_.overrides&&_.overrides.hasOverride(B))return void(x=!0)};if(m.value.kind==="constant"&&m.value.value instanceof Cs)w(m.value.value.sections);else if(m.value.kind==="source"||m.value.kind==="composite"){const E=O=>{x||(O instanceof Qa&&wi(O.value)===eu?w(O.value.sections):O instanceof Ld?w(O.sections):O.eachChild(E))},B=m.value;B._styleExpression&&E(B._styleExpression.expression)}return x}}let _N;var Fee={get paint(){return _N=_N||new qs({"background-color":new hr(et.paint_background["background-color"]),"background-pattern":new ng(et.paint_background["background-pattern"]),"background-opacity":new hr(et.paint_background["background-opacity"])})}};class Uee extends Jo{constructor(l,h){super(l,Fee,h)}}class zee extends Jo{constructor(l,h){super(l,{},h),this.onAdd=m=>{this.implementation.onAdd&&this.implementation.onAdd(m,m.painter.context.gl)},this.onRemove=m=>{this.implementation.onRemove&&this.implementation.onRemove(m,m.painter.context.gl)},this.implementation=l}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Vee{constructor(l){this._methodToThrottle=l,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const $ee={once:!0},dE=63710088e-1;class Mh{constructor(l,h){if(isNaN(l)||isNaN(h))throw new Error(`Invalid LngLat object: (${l}, ${h})`);if(this.lng=+l,this.lat=+h,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Mh(Jn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(l){const h=Math.PI/180,m=this.lat*h,_=l.lat*h,x=Math.sin(m)*Math.sin(_)+Math.cos(m)*Math.cos(_)*Math.cos((l.lng-this.lng)*h);return dE*Math.acos(Math.min(x,1))}static convert(l){if(l instanceof Mh)return l;if(Array.isArray(l)&&(l.length===2||l.length===3))return new Mh(Number(l[0]),Number(l[1]));if(!Array.isArray(l)&&typeof l=="object"&&l!==null)return new Mh(Number("lng"in l?l.lng:l.lon),Number(l.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const vN=2*Math.PI*dE;function AN(d){return vN*Math.cos(d*Math.PI/180)}function xN(d){return(180+d)/360}function wN(d){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d*Math.PI/360)))/360}function CN(d,l){return d/AN(l)}function TN(d){return 360*d-180}function y1(d){return 360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90}function SN(d,l){return d*AN(y1(l))}class Nb{constructor(l,h,m=0){this.x=+l,this.y=+h,this.z=+m}static fromLngLat(l,h=0){const m=Mh.convert(l);return new Nb(xN(m.lng),wN(m.lat),CN(h,m.lat))}toLngLat(){return new Mh(TN(this.x),y1(this.y))}toAltitude(){return SN(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/vN*(l=y1(this.y),1/Math.cos(l*Math.PI/180));var l}}function EN(d,l,h){var m=2*Math.PI*6378137/256/Math.pow(2,h);return[d*m-2*Math.PI*6378137/2,l*m-2*Math.PI*6378137/2]}class fE{constructor(l,h,m){if(!function(_,x,w){return!(_<0||_>25||w<0||w>=Math.pow(2,_)||x<0||x>=Math.pow(2,_))}(l,h,m))throw new Error(`x=${h}, y=${m}, z=${l} outside of bounds. 0<=x<${Math.pow(2,l)}, 0<=y<${Math.pow(2,l)} 0<=z<=25 `);this.z=l,this.x=h,this.y=m,this.key=Ag(0,l,l,h,m)}equals(l){return this.z===l.z&&this.x===l.x&&this.y===l.y}url(l,h,m){const _=function(w,E,B){var O=EN(256*w,256*(E=Math.pow(2,B)-E-1),B),N=EN(256*(w+1),256*(E+1),B);return O[0]+","+O[1]+","+N[0]+","+N[1]}(this.x,this.y,this.z),x=function(w,E,B){let O,N="";for(let U=w;U>0;U--)O=1<<U-1,N+=(E&O?1:0)+(B&O?2:0);return N}(this.z,this.x,this.y);return l[(this.x+this.y)%l.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(m==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,h>1?"@2x":"").replace(/{quadkey}/g,x).replace(/{bbox-epsg-3857}/g,_)}isChildOf(l){const h=this.z-l.z;return h>0&&l.x===this.x>>h&&l.y===this.y>>h}getTilePoint(l){const h=Math.pow(2,this.z);return new u((l.x*h-this.x)*Ut,(l.y*h-this.y)*Ut)}toString(){return`${this.z}/${this.x}/${this.y}`}}class IN{constructor(l,h){this.wrap=l,this.canonical=h,this.key=Ag(l,h.z,h.z,h.x,h.y)}}class Ta{constructor(l,h,m,_,x){if(this.terrainRttPosMatrix32f=null,l<m)throw new Error(`overscaledZ should be >= z; overscaledZ = ${l}; z = ${m}`);this.overscaledZ=l,this.wrap=h,this.canonical=new fE(m,+_,+x),this.key=Ag(h,l,m,_,x)}clone(){return new Ta(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(l){return this.overscaledZ===l.overscaledZ&&this.wrap===l.wrap&&this.canonical.equals(l.canonical)}scaledTo(l){if(l>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${l}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-l;return l>this.canonical.z?new Ta(l,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ta(l,this.wrap,l,this.canonical.x>>h,this.canonical.y>>h)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(l,h){if(l>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${l}; overscaledZ = ${this.overscaledZ}`);const m=this.canonical.z-l;return l>this.canonical.z?Ag(this.wrap*+h,l,this.canonical.z,this.canonical.x,this.canonical.y):Ag(this.wrap*+h,l,l,this.canonical.x>>m,this.canonical.y>>m)}isChildOf(l){if(l.wrap!==this.wrap||this.overscaledZ-l.overscaledZ<=0)return!1;if(l.overscaledZ===0)return this.overscaledZ>0;const h=this.canonical.z-l.canonical.z;return!(h<0)&&l.canonical.x===this.canonical.x>>h&&l.canonical.y===this.canonical.y>>h}children(l){if(this.overscaledZ>=l)return[new Ta(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const h=this.canonical.z+1,m=2*this.canonical.x,_=2*this.canonical.y;return[new Ta(h,this.wrap,h,m,_),new Ta(h,this.wrap,h,m+1,_),new Ta(h,this.wrap,h,m,_+1),new Ta(h,this.wrap,h,m+1,_+1)]}isLessThan(l){return this.wrap<l.wrap||!(this.wrap>l.wrap)&&(this.overscaledZ<l.overscaledZ||!(this.overscaledZ>l.overscaledZ)&&(this.canonical.x<l.canonical.x||!(this.canonical.x>l.canonical.x)&&this.canonical.y<l.canonical.y))}wrapped(){return new Ta(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(l){return new Ta(this.overscaledZ,l,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new IN(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(l){return this.canonical.getTilePoint(new Nb(l.x-this.wrap,l.y))}}function Ag(d,l,h,m,_){(d*=2)<0&&(d=-1*d-1);const x=1<<h;return(x*x*d+x*_+m).toString(36)+h.toString(36)+l.toString(36)}function pE(d,l){return l?d.properties[l]:d.id}function jee(d,l){const h={id:d.id};if(l.removeAllProperties&&(delete d.removeProperties,delete d.addOrUpdateProperties,delete l.removeProperties),l.removeProperties)for(const m of l.removeProperties){const _=d.addOrUpdateProperties.findIndex(x=>x.key===m);_>-1&&d.addOrUpdateProperties.splice(_,1)}return(d.removeAllProperties||l.removeAllProperties)&&(h.removeAllProperties=!0),(d.removeProperties||l.removeProperties)&&(h.removeProperties=[...d.removeProperties||[],...l.removeProperties||[]]),(d.addOrUpdateProperties||l.addOrUpdateProperties)&&(h.addOrUpdateProperties=[...d.addOrUpdateProperties||[],...l.addOrUpdateProperties||[]]),(d.newGeometry||l.newGeometry)&&(h.newGeometry=l.newGeometry||d.newGeometry),h}function PN(d){var l,h;if(!d)return{};const m={};return m.removeAll=d.removeAll,m.remove=new Set(d.remove||[]),m.add=new Map((l=d.add)===null||l===void 0?void 0:l.map(_=>[_.id,_])),m.update=new Map((h=d.update)===null||h===void 0?void 0:h.map(_=>[_.id,_])),m}er("CanonicalTileID",fE),er("OverscaledTileID",Ta,{omit:["terrainRttPosMatrix32f"]});class pf{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(l){return this.minX=Math.min(this.minX,l.x),this.minY=Math.min(this.minY,l.y),this.maxX=Math.max(this.maxX,l.x),this.maxY=Math.max(this.maxY,l.y),this}expandBy(l){return this.minX-=l,this.minY-=l,this.maxX+=l,this.maxY+=l,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(l){return this.expandBy(-l)}map(l){const h=new pf;return h.extend(l(new u(this.minX,this.minY))),h.extend(l(new u(this.maxX,this.minY))),h.extend(l(new u(this.minX,this.maxY))),h.extend(l(new u(this.maxX,this.maxY))),h}static fromPoints(l){const h=new pf;for(const m of l)h.extend(m);return h}contains(l){return l.x>=this.minX&&l.x<=this.maxX&&l.y>=this.minY&&l.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(l){return!this.empty()&&!l.empty()&&l.minX>=this.minX&&l.maxX<=this.maxX&&l.minY>=this.minY&&l.maxY<=this.maxY}intersects(l){return!this.empty()&&!l.empty()&&l.minX<=this.maxX&&l.maxX>=this.minX&&l.minY<=this.maxY&&l.maxY>=this.minY}}class BN{constructor(l){this._stringToNumber={},this._numberToString=[];for(let h=0;h<l.length;h++){const m=l[h];this._stringToNumber[m]=h,this._numberToString[h]=m}}encode(l){return this._stringToNumber[l]}decode(l){if(l>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${l} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[l]}}class MN{constructor(l,h,m,_,x){this.type="Feature",this._vectorTileFeature=l,this._x=m,this._y=_,this._z=h,this.properties=l.properties,this.id=x}projectPoint(l,h,m,_){return[360*(l.x+h)/_-180,360/Math.PI*Math.atan(Math.exp((1-2*(l.y+m)/_)*Math.PI))-90]}projectLine(l,h,m,_){return l.map(x=>this.projectPoint(x,h,m,_))}get geometry(){if(this._geometry)return this._geometry;const l=this._vectorTileFeature,h=l.extent*Math.pow(2,this._z),m=l.extent*this._x,_=l.extent*this._y,x=l.loadGeometry();switch(l.type){case 1:{const w=[];for(const B of x)w.push(B[0]);const E=this.projectLine(w,m,_,h);this._geometry=w.length===1?{type:"Point",coordinates:E[0]}:{type:"MultiPoint",coordinates:E};break}case 2:{const w=x.map(E=>this.projectLine(E,m,_,h));this._geometry=w.length===1?{type:"LineString",coordinates:w[0]}:{type:"MultiLineString",coordinates:w};break}case 3:{const w=WL(x),E=[];for(const B of w)E.push(B.map(O=>this.projectLine(O,m,_,h)));this._geometry=E.length===1?{type:"Polygon",coordinates:E[0]}:{type:"MultiPolygon",coordinates:E};break}default:throw new Error(`unknown feature type: ${l.type}`)}return this._geometry}set geometry(l){this._geometry=l}toJSON(){const l={geometry:this.geometry};for(const h in this)h!=="_geometry"&&h!=="_vectorTileFeature"&&h!=="_x"&&h!=="_y"&&h!=="_z"&&(l[h]=this[h]);return l}}class xg{constructor(l,h,m){H(this,"_name");H(this,"dataBuffer");H(this,"nullabilityBuffer");H(this,"_size");this._name=l,this.dataBuffer=h,typeof m=="number"?this._size=m:(this.nullabilityBuffer=m,this._size=m.size())}getValue(l){return this.nullabilityBuffer&&!this.nullabilityBuffer.get(l)?null:this.getValueFromBuffer(l)}has(l){return this.nullabilityBuffer&&this.nullabilityBuffer.get(l)||!this.nullabilityBuffer}get name(){return this._name}get size(){return this._size}}class b1 extends xg{}class gE extends b1{getValueFromBuffer(l){return this.dataBuffer[l]}}class mE extends b1{getValueFromBuffer(l){return this.dataBuffer[l]}}class RN extends xg{constructor(h,m,_,x){super(h,m,x);H(this,"delta");this.delta=_}}class yE extends RN{constructor(l,h,m,_){super(l,Int32Array.of(h),m,_)}getValueFromBuffer(l){return this.dataBuffer[0]+l*this.delta}}class bE extends xg{constructor(l,h,m){super(l,Int32Array.of(h),m)}getValueFromBuffer(l){return this.dataBuffer[0]}}class Gee{constructor(l,h,m,_,x=4096){H(this,"_name");H(this,"_geometryVector");H(this,"_idVector");H(this,"_propertyVectors");H(this,"_extent");H(this,"propertyVectorsMap");this._name=l,this._geometryVector=h,this._idVector=m,this._propertyVectors=_,this._extent=x}get name(){return this._name}get idVector(){return this._idVector}get geometryVector(){return this._geometryVector}get propertyVectors(){return this._propertyVectors}getPropertyVector(l){return this.propertyVectorsMap||(this.propertyVectorsMap=new Map(this._propertyVectors.map(h=>[h.name,h]))),this.propertyVectorsMap.get(l)}*[Symbol.iterator](){const l=this.geometryVector[Symbol.iterator]();let h=0;for(;h<this.numFeatures;){let m;this.idVector&&(m=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(h)):this.idVector.getValue(h));const _=l?.next().value,x={};for(const w of this.propertyVectors){if(!w)continue;const E=w.name,B=w.getValue(h);B!==null&&(x[E]=B)}h++,yield{id:m,geometry:_,properties:x}}}get numFeatures(){return this.geometryVector.numGeometries}get extent(){return this._extent}getFeatures(){const l=[],h=this.geometryVector.getGeometries();for(let m=0;m<this.numFeatures;m++){let _;this.idVector&&(_=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(m)):this.idVector.getValue(m));const x={coordinates:h[m],type:this.geometryVector.geometryType(m)},w={};for(const E of this.propertyVectors){if(!E)continue;const B=E.name,O=E.getValue(m);O!==null&&(w[B]=O)}l.push({id:_,geometry:x,properties:w})}return l}containsMaxSaveIntegerValues(l){return l instanceof gE||l instanceof bE&&l instanceof yE||l instanceof mE}}class Hee{constructor(l){H(this,"value");this.value=l}get(){return this.value}set(l){this.value=l}increment(){return this.value++}add(l){this.value+=l}}var Kr,xu,ks,Pl,gf,Yo,cs,us,kN,Sa;function Ss(d,l,h){const m=new Int32Array(h);let _=0,x=l.get();for(let w=0;w<m.length;w++){let E=d[x++],B=127&E;E<128||(E=d[x++],B|=(127&E)<<7,E<128||(E=d[x++],B|=(127&E)<<14,E<128||(E=d[x++],B|=(127&E)<<21,E<128||(E=d[x++],B|=(15&E)<<28)))),m[_++]=B}return l.set(x),m}function _1(d,l,h){const m=new BigInt64Array(h);for(let _=0;_<m.length;_++)m[_]=Kee(d,l);return m}function Wee(d,l){let h,m;return m=d[l.get()],l.increment(),h=127&m,m<128?h:(m=d[l.get()],l.increment(),h|=(127&m)<<7,m<128?h:(m=d[l.get()],l.increment(),h|=(127&m)<<14,m<128?h:(m=d[l.get()],l.increment(),h|=(127&m)<<21,m<128?h:(m=d[l.get()],h|=(15&m)<<28,function(_,x,w){let E,B;if(B=x[w.get()],w.increment(),E=(112&B)>>4,B<128||(B=x[w.get()],w.increment(),E|=(127&B)<<3,B<128)||(B=x[w.get()],w.increment(),E|=(127&B)<<10,B<128)||(B=x[w.get()],w.increment(),E|=(127&B)<<17,B<128)||(B=x[w.get()],w.increment(),E|=(127&B)<<24,B<128)||(B=x[w.get()],w.increment(),E|=(1&B)<<31,B<128))return 4294967296*E+(_>>>0);throw new Error("Expected varint not more than 10 bytes")}(h,d,l)))))}function ON(d,l,h,m){throw new Error("FastPFor is not implemented yet.")}function mf(d){return d>>>1^-(1&d)}function wg(d){return d>>1n^-(1n&d)}function Kee(d,l){let h=0n,m=0,_=l.get();for(;_<d.length;){const x=d[_++];if(h|=BigInt(127&x)<<BigInt(m),!(128&x))break;if(m+=7,m>=64)throw new Error("Varint too long")}return l.set(_),h}function DN(d,l,h){const m=new Int32Array(h);let _=0;for(let x=0;x<l;x++){const w=d[x];m.fill(d[x+l],_,_+w),_+=w}return m}function LN(d,l,h){const m=new BigInt64Array(h);let _=0;for(let x=0;x<l;x++){const w=Number(d[x]);m.fill(d[x+l],_,_+w),_+=w}return m}function NN(d,l,h){const m=new Float64Array(h);let _=0;for(let x=0;x<l;x++){const w=d[x];m.fill(d[x+l],_,_+w),_+=w}return m}function _E(d){const l=d.length/4*4;let h=1;if(l>=4)for(let m=d[0];h<l-4;h+=4)m=d[h]+=m,m=d[h+1]+=m,m=d[h+2]+=m,m=d[h+3]+=m;for(;h!=d.length;)d[h]+=d[h-1],++h}function FN(d){d[0]=d[0]>>>1^-(1&d[0]),d[1]=d[1]>>>1^-(1&d[1]);const l=d.length/4*4;let h=2;if(l>=4)for(;h<l-4;h+=4){const m=d[h],_=d[h+1],x=d[h+2],w=d[h+3];d[h]=(m>>>1^-(1&m))+d[h-2],d[h+1]=(_>>>1^-(1&_))+d[h-1],d[h+2]=(x>>>1^-(1&x))+d[h],d[h+3]=(w>>>1^-(1&w))+d[h+1]}for(;h!=d.length;h+=2)d[h]=(d[h]>>>1^-(1&d[h]))+d[h-2],d[h+1]=(d[h+1]>>>1^-(1&d[h+1]))+d[h-1]}(function(d){d.NONE="NONE",d.DELTA="DELTA",d.COMPONENTWISE_DELTA="COMPONENTWISE_DELTA",d.RLE="RLE",d.MORTON="MORTON",d.PDE="PDE"})(Kr||(Kr={})),function(d){d.NONE="NONE",d.FAST_PFOR="FAST_PFOR",d.VARINT="VARINT",d.ALP="ALP"}(xu||(xu={})),function(d){d.PRESENT="PRESENT",d.DATA="DATA",d.OFFSET="OFFSET",d.LENGTH="LENGTH"}(ks||(ks={}));class vE{constructor(l,h,m){H(this,"_dictionaryType");H(this,"_offsetType");H(this,"_lengthType");this._dictionaryType=l,this._offsetType=h,this._lengthType=m}get dictionaryType(){return this._dictionaryType}get offsetType(){return this._offsetType}get lengthType(){return this._lengthType}}function uo(d,l){const h=function(m,_){const x=m[_.get()],w=Object.values(ks)[x>>4];let E=null;switch(w){case ks.DATA:E=new vE(Object.values(Pl)[15&x]);break;case ks.OFFSET:E=new vE(null,Object.values(gf)[15&x]);break;case ks.LENGTH:E=new vE(null,null,Object.values(Yo)[15&x])}_.increment();const B=m[_.get()],O=Object.values(Kr)[B>>5],N=Object.values(Kr)[B>>2&7],U=Object.values(xu)[3&B];_.increment();const G=Ss(m,_,2),K=G[0];return{physicalStreamType:w,logicalStreamType:E,logicalLevelTechnique1:O,logicalLevelTechnique2:N,physicalLevelTechnique:U,numValues:K,byteLength:G[1],decompressedCount:K}}(d,l);return h.logicalLevelTechnique1===Kr.MORTON?function(m,_,x){const w=Ss(_,x,2);return{physicalStreamType:m.physicalStreamType,logicalStreamType:m.logicalStreamType,logicalLevelTechnique1:m.logicalLevelTechnique1,logicalLevelTechnique2:m.logicalLevelTechnique2,physicalLevelTechnique:m.physicalLevelTechnique,numValues:m.numValues,byteLength:m.byteLength,decompressedCount:m.decompressedCount,numBits:w[0],coordinateShift:w[1]}}(h,d,l):Kr.RLE!==h.logicalLevelTechnique1&&Kr.RLE!==h.logicalLevelTechnique2||xu.NONE===h.physicalLevelTechnique?h:function(m,_,x){const w=Ss(_,x,2);return{physicalStreamType:m.physicalStreamType,logicalStreamType:m.logicalStreamType,logicalLevelTechnique1:m.logicalLevelTechnique1,logicalLevelTechnique2:m.logicalLevelTechnique2,physicalLevelTechnique:m.physicalLevelTechnique,numValues:m.numValues,byteLength:m.byteLength,decompressedCount:w[1],runs:w[0],numRleValues:w[1]}}(h,d,l)}(function(d){d.NONE="NONE",d.SINGLE="SINGLE",d.SHARED="SHARED",d.VERTEX="VERTEX",d.MORTON="MORTON",d.FSST="FSST"})(Pl||(Pl={})),function(d){d.VERTEX="VERTEX",d.INDEX="INDEX",d.STRING="STRING",d.KEY="KEY"}(gf||(gf={})),function(d){d.VAR_BINARY="VAR_BINARY",d.GEOMETRIES="GEOMETRIES",d.PARTS="PARTS",d.RINGS="RINGS",d.TRIANGLES="TRIANGLES",d.SYMBOL="SYMBOL",d.DICTIONARY="DICTIONARY"}(Yo||(Yo={})),function(d){d[d.FLAT=0]="FLAT",d[d.CONST=1]="CONST",d[d.SEQUENCE=2]="SEQUENCE",d[d.DICTIONARY=3]="DICTIONARY",d[d.FSST_DICTIONARY=4]="FSST_DICTIONARY"}(cs||(cs={}));class Bl{constructor(l,h){H(this,"values");H(this,"_size");this.values=l,this._size=h}get(l){const h=Math.floor(l/8);return(this.values[h]>>l%8&1)==1}set(l,h){const m=Math.floor(l/8);this.values[m]=this.values[m]|(h?1:0)<<l%8}getInt(l){const h=Math.floor(l/8);return this.values[h]>>l%8&1}size(){return this._size}getBuffer(){return this.values}}function ho(d,l,h,m,_){return function(x,w,E){switch(w.logicalLevelTechnique1){case Kr.DELTA:return w.logicalLevelTechnique2===Kr.RLE?function(B,O,N){const U=new Int32Array(N);let G=0,K=0;for(let q=0;q<O;q++){const Z=B[q],ee=mf(B[q+O]);for(let ue=0;ue<Z;ue++)K+=ee,U[G++]=K}return U}(x,w.runs,w.numRleValues):(function(B){B[0]=B[0]>>>1^-(1&B[0]);const O=B.length/4*4;let N=1;if(O>=4)for(;N<O-4;N+=4){const U=B[N],G=B[N+1],K=B[N+2],q=B[N+3];B[N]=(U>>>1^-(1&U))+B[N-1],B[N+1]=(G>>>1^-(1&G))+B[N],B[N+2]=(K>>>1^-(1&K))+B[N+1],B[N+3]=(q>>>1^-(1&q))+B[N+2]}for(;N!=B.length;++N)B[N]=(B[N]>>>1^-(1&B[N]))+B[N-1]}(x),x);case Kr.RLE:return function(B,O,N){return N?function(U,G,K){const q=new Int32Array(K);let Z=0;for(let ee=0;ee<G;ee++){const ue=U[ee];let xe=U[ee+G];xe=xe>>>1^-(1&xe),q.fill(xe,Z,Z+ue),Z+=ue}return q}(B,O.runs,O.numRleValues):DN(B,O.runs,O.numRleValues)}(x,w,E);case Kr.MORTON:return _E(x),x;case Kr.COMPONENTWISE_DELTA:return FN(x),x;case Kr.NONE:return E&&function(B){for(let O=0;O<B.length;O++){const N=B[O];B[O]=N>>>1^-(1&N)}}(x),x;default:throw new Error(`The specified Logical level technique is not supported: ${w.logicalLevelTechnique1}`)}}(v1(d,l,h),h,m)}function Rh(d,l,h){return function(m,_){if(_.logicalLevelTechnique1===Kr.DELTA&&_.logicalLevelTechnique2===Kr.NONE)return function(w){const E=new Int32Array(w.length+1);E[0]=0,E[1]=mf(w[0]);let B=E[1],O=2;for(;O!=E.length;++O){const N=w[O-1];B+=N>>>1^-(1&N),E[O]=E[O-1]+B}return E}(m);if(_.logicalLevelTechnique1===Kr.RLE&&_.logicalLevelTechnique2===Kr.NONE)return function(w,E,B){const O=new Int32Array(B+1);O[0]=0;let N=1,U=O[0];for(let G=0;G<E;G++){const K=w[G],q=w[G+E];for(let Z=N;Z<N+K;Z++)O[Z]=q+U,U=O[Z];N+=K}return O}(m,_.runs,_.numRleValues);if(_.logicalLevelTechnique1===Kr.NONE&&_.logicalLevelTechnique2===Kr.NONE){(function(w){let E=0;for(let B=0;B<w.length;B++)w[B]+=E,E=w[B]})(m);const x=new Int32Array(_.numValues+1);return x[0]=0,x.set(m,1),x}if(_.logicalLevelTechnique1===Kr.DELTA&&_.logicalLevelTechnique2===Kr.RLE){const x=function(w,E,B){const O=new Int32Array(B+1);O[0]=0;let N=1,U=O[0];for(let G=0;G<E;G++){const K=w[G];let q=w[G+E];q=q>>>1^-(1&q);for(let Z=N;Z<N+K;Z++)O[Z]=q+U,U=O[Z];N+=K}return O}(m,_.runs,_.numRleValues);return _E(x),x}throw new Error("Only delta encoding is supported for transforming length to offset streams yet.")}(v1(d,l,h),h)}function v1(d,l,h){const m=h.physicalLevelTechnique;if(m===xu.FAST_PFOR)return ON();if(m===xu.VARINT)return Ss(d,l,h.numValues);if(m===xu.NONE){const _=l.get();l.add(h.byteLength);const x=d.subarray(_,l.get());return new Int32Array(x)}throw new Error("Specified physicalLevelTechnique is not supported (yet).")}function AE(d,l,h,m){const _=v1(d,l,h);if(_.length===1){const x=_[0];return m?mf(x):x}return m?function(x){return mf(x[1])}(_):function(x){return x[1]}(_)}function UN(d,l,h){return function(m){if(m.length==2){const _=mf(m[1]);return[_,_]}return[mf(m[2]),mf(m[3])]}(v1(d,l,h))}function zN(d,l,h){return function(m){if(m.length==2){const _=wg(m[1]);return[_,_]}return[wg(m[2]),wg(m[3])]}(_1(d,l,h.numValues))}function VN(d,l,h,m){return function(_,x,w){switch(x.logicalLevelTechnique1){case Kr.DELTA:return x.logicalLevelTechnique2===Kr.RLE?function(E,B,O){const N=new BigInt64Array(O);let U=0,G=0n;for(let K=0;K<B;K++){const q=Number(E[K]),Z=wg(E[K+B]);for(let ee=0;ee<q;ee++)G+=Z,N[U++]=G}return N}(_,x.runs,x.numRleValues):(function(E){E[0]=E[0]>>1n^-(1n&E[0]);const B=E.length/4*4;let O=1;if(B>=4)for(;O<B-4;O+=4){const N=E[O],U=E[O+1],G=E[O+2],K=E[O+3];E[O]=(N>>1n^-(1n&N))+E[O-1],E[O+1]=(U>>1n^-(1n&U))+E[O],E[O+2]=(G>>1n^-(1n&G))+E[O+1],E[O+3]=(K>>1n^-(1n&K))+E[O+2]}for(;O!=E.length;++O)E[O]=(E[O]>>1n^-(1n&E[O]))+E[O-1]}(_),_);case Kr.RLE:return function(E,B,O){return O?function(N,U,G){const K=new BigInt64Array(G);let q=0;for(let Z=0;Z<U;Z++){const ee=Number(N[Z]);let ue=N[Z+U];ue=ue>>1n^-(1n&ue),K.fill(ue,q,q+ee),q+=ee}return K}(E,B.runs,B.numRleValues):LN(E,B.runs,B.numRleValues)}(_,x,w);case Kr.NONE:return w&&function(E){for(let B=0;B<E.length;B++){const O=E[B];E[B]=O>>1n^-(1n&O)}}(_),_;default:throw new Error(`The specified Logical level technique is not supported: ${x.logicalLevelTechnique1}`)}}(_1(d,l,h.numValues),h,m)}function $N(d,l,h,m){const _=_1(d,l,h.numValues);if(_.length===1){const x=_[0];return m?wg(x):x}return m?function(x){return wg(x[1])}(_):function(x){return x[1]}(_)}function xE(d,l,h,m,_){return function(x,w,E,B){switch(w.logicalLevelTechnique1){case Kr.DELTA:return w.logicalLevelTechnique2===Kr.RLE&&(x=DN(x,w.runs,w.numRleValues)),function(O,N){const U=new Int32Array(O.size());let G=0;O.get(0)?(U[0]=O.get(0)?N[0]>>>1^-(1&N[0]):0,G=1):U[0]=0;let K=1;for(;K!=U.length;++K)U[K]=O.get(K)?U[K-1]+(N[G]>>>1^-(1&N[G++])):U[K-1];return U}(B,x);case Kr.RLE:return function(O,N,U,G){const K=N;return U?function(q,Z,ee){const ue=new Int32Array(q.size());let xe=0;for(let fe=0;fe<ee;fe++){const pe=Z[fe];let Te=Z[fe+ee];Te=Te>>>1^-(1&Te);for(let Oe=xe;Oe<xe+pe;Oe++)q.get(Oe)?ue[Oe]=Te:(ue[Oe]=0,xe++);xe+=pe}return ue}(G,O,K.runs):function(q,Z,ee){const ue=new Int32Array(q.size());let xe=0;for(let fe=0;fe<ee;fe++){const pe=Z[fe],Te=Z[fe+ee];for(let Oe=xe;Oe<xe+pe;Oe++)q.get(Oe)?ue[Oe]=Te:(ue[Oe]=0,xe++);xe+=pe}return ue}(G,O,K.runs)}(x,w,E,B);case Kr.MORTON:return _E(x),x;case Kr.COMPONENTWISE_DELTA:return FN(x),x;case Kr.NONE:return x=E?function(O,N){const U=new Int32Array(O.size());let G=0,K=0;for(;K!=U.length;++K)if(O.get(K)){const q=N[G++];U[K]=q>>>1^-(1&q)}else U[K]=0;return U}(B,x):function(O,N){const U=new Int32Array(O.size());let G=0,K=0;for(;K!=U.length;++K)U[K]=O.get(K)?N[G++]:0;return U}(B,x),x;default:throw new Error("The specified Logical level technique is not supported")}}(h.physicalLevelTechnique===xu.FAST_PFOR?ON():Ss(d,l,h.numValues),h,m,_)}function A1(d,l,h,m){const _=d.logicalLevelTechnique1;if(_===Kr.RLE)return d.runs===1?cs.CONST:cs.FLAT;const x=l instanceof Bl?l.size():l;if(_===Kr.DELTA&&d.logicalLevelTechnique2===Kr.RLE){const w=d.runs,E=2;if(d.numRleValues!==x)return cs.FLAT;if(w===1)return cs.SEQUENCE;if(w===2){const B=m.get();let O;if(d.physicalLevelTechnique===xu.VARINT)O=Ss(h,m,4);else{const N=m.get();O=new Int32Array(h.buffer,h.byteOffset+N,4)}if(m.set(B),O[2]===E&&O[3]===E)return cs.SEQUENCE}}return d.numValues===1?cs.CONST:cs.FLAT}class jN extends b1{getValueFromBuffer(l){return this.dataBuffer[l]}}class GN extends RN{constructor(l,h,m,_){super(l,BigInt64Array.of(h),m,_)}getValueFromBuffer(l){return this.dataBuffer[0]+BigInt(l)*this.delta}}class Cg{constructor(l,h,m){H(this,"_geometryOffsets");H(this,"_partOffsets");H(this,"_ringOffsets");this._geometryOffsets=l,this._partOffsets=h,this._ringOffsets=m}get geometryOffsets(){return this._geometryOffsets}get partOffsets(){return this._partOffsets}get ringOffsets(){return this._ringOffsets}}function wE(d,l,h){return{x:HN(d,l)-h,y:HN(d>>1,l)-h}}function HN(d,l){let h=0;for(let m=0;m<l;m++)h|=(d&1<<2*m)>>m;return h}(function(d){d[d.POINT=0]="POINT",d[d.LINESTRING=1]="LINESTRING",d[d.POLYGON=2]="POLYGON",d[d.MULTIPOINT=3]="MULTIPOINT",d[d.MULTILINESTRING=4]="MULTILINESTRING",d[d.MULTIPOLYGON=5]="MULTIPOLYGON"})(us||(us={})),function(d){d[d.POINT=0]="POINT",d[d.LINESTRING=1]="LINESTRING",d[d.POLYGON=2]="POLYGON"}(kN||(kN={})),function(d){d[d.MORTON=0]="MORTON",d[d.VEC_2=1]="VEC_2",d[d.VEC_3=2]="VEC_3"}(Sa||(Sa={}));class Xee{createPoint(l){return[[l]]}createMultiPoint(l){return l.map(h=>[h])}createLineString(l){return[l]}createMultiLineString(l){return l}createPolygon(l,h){return[l].concat(h)}createMultiPolygon(l){return l.flat()}}function WN(d){const l=new Array(d.numGeometries);let h=1,m=1,_=1,x=0;const w=new Xee;let E=0,B=0;const O=d.mortonSettings,N=d.topologyVector,U=N.geometryOffsets,G=N.partOffsets,K=N.ringOffsets,q=d.vertexOffsets,Z=d.containsPolygonGeometry(),ee=d.vertexBuffer;for(let ue=0;ue<d.numGeometries;ue++){const xe=d.geometryType(ue);if(xe===us.POINT){if(q&&q.length!==0)if(d.vertexBufferType===Sa.VEC_2){const fe=2*q[B++],pe=new u(ee[fe],ee[fe+1]);l[x++]=w.createPoint(pe)}else{const fe=wE(ee[q[B++]],O.numBits,O.coordinateShift),pe=new u(fe.x,fe.y);l[x++]=w.createPoint(pe)}else{const fe=new u(ee[E++],ee[E++]);l[x++]=w.createPoint(fe)}U&&_++,G&&h++,K&&m++}else if(xe===us.MULTIPOINT){const fe=U[_]-U[_-1];_++;const pe=new Array(fe);if(q&&q.length!==0){for(let Te=0;Te<fe;Te++){const Oe=2*q[B++];pe[Te]=new u(ee[Oe],ee[Oe+1])}l[x++]=w.createMultiPoint(pe)}else{for(let Te=0;Te<fe;Te++){const Oe=ee[E++],Ze=ee[E++];pe[Te]=new u(Oe,Ze)}l[x++]=w.createMultiPoint(pe)}}else if(xe===us.LINESTRING){let fe,pe=0;Z?(pe=K[m]-K[m-1],m++):pe=G[h]-G[h-1],h++,q&&q.length!==0?(fe=d.vertexBufferType===Sa.VEC_2?TE(ee,q,B,pe,!1):SE(ee,q,B,pe,!1,O),B+=pe):(fe=CE(ee,E,pe,!1),E+=2*pe),l[x++]=w.createLineString(fe),U&&_++}else if(xe===us.POLYGON){const fe=G[h]-G[h-1];h++;const pe=new Array(fe-1);let Te=K[m]-K[m-1];if(m++,q&&q.length!==0){const Oe=d.vertexBufferType===Sa.VEC_2?w1(ee,q,B,Te):C1(ee,q,B,Te,0,O);B+=Te;for(let Ze=0;Ze<pe.length;Ze++)Te=K[m]-K[m-1],m++,pe[Ze]=d.vertexBufferType===Sa.VEC_2?w1(ee,q,B,Te):C1(ee,q,B,Te,0,O),B+=Te;l[x++]=w.createPolygon(Oe,pe)}else{const Oe=x1(ee,E,Te);E+=2*Te;for(let Ze=0;Ze<pe.length;Ze++)Te=K[m]-K[m-1],m++,pe[Ze]=x1(ee,E,Te),E+=2*Te;l[x++]=w.createPolygon(Oe,pe)}U&&_++}else if(xe===us.MULTILINESTRING){const fe=U[_]-U[_-1];_++;const pe=new Array(fe);if(q&&q.length!==0){for(let Te=0;Te<fe;Te++){let Oe=0;Z?(Oe=K[m]-K[m-1],m++):Oe=G[h]-G[h-1],h++;const Ze=d.vertexBufferType===Sa.VEC_2?TE(ee,q,B,Oe,!1):SE(ee,q,B,Oe,!1,O);pe[Te]=Ze,B+=Oe}l[x++]=w.createMultiLineString(pe)}else{for(let Te=0;Te<fe;Te++){let Oe=0;Z?(Oe=K[m]-K[m-1],m++):Oe=G[h]-G[h-1],h++,pe[Te]=CE(ee,E,Oe,!1),E+=2*Oe}l[x++]=w.createMultiLineString(pe)}}else{if(xe!==us.MULTIPOLYGON)throw new Error("The specified geometry type is currently not supported.");{const fe=U[_]-U[_-1];_++;const pe=new Array(fe);let Te=0;if(q&&q.length!==0){for(let Oe=0;Oe<fe;Oe++){const Ze=G[h]-G[h-1];h++;const xt=new Array(Ze-1);Te=K[m]-K[m-1],m++;const ht=d.vertexBufferType===Sa.VEC_2?w1(ee,q,B,Te):C1(ee,q,B,Te,0,O);B+=Te;for(let Ct=0;Ct<xt.length;Ct++)Te=K[m]-K[m-1],m++,xt[Ct]=d.vertexBufferType===Sa.VEC_2?w1(ee,q,B,Te):C1(ee,q,B,Te,0,O),B+=Te;pe[Oe]=w.createPolygon(ht,xt)}l[x++]=w.createMultiPolygon(pe)}else{for(let Oe=0;Oe<fe;Oe++){const Ze=G[h]-G[h-1];h++;const xt=new Array(Ze-1);Te=K[m]-K[m-1],m++;const ht=x1(ee,E,Te);E+=2*Te;for(let Ct=0;Ct<xt.length;Ct++){const Vt=K[m]-K[m-1];m++,xt[Ct]=x1(ee,E,Vt),E+=2*Vt}pe[Oe]=w.createPolygon(ht,xt)}l[x++]=w.createMultiPolygon(pe)}}}}return l}function x1(d,l,h){return CE(d,l,h,!0)}function w1(d,l,h,m){return TE(d,l,h,m,!0)}function C1(d,l,h,m,_,x){return SE(d,l,h,m,!0,x)}function CE(d,l,h,m){const _=new Array(m?h+1:h);for(let x=0;x<2*h;x+=2)_[x/2]=new u(d[l+x],d[l+x+1]);return m&&(_[_.length-1]=_[0]),_}function TE(d,l,h,m,_){const x=new Array(_?m+1:m);for(let w=0;w<2*m;w+=2){const E=2*l[h+w/2];x[w/2]=new u(d[E],d[E+1])}return _&&(x[x.length-1]=x[0]),x}function SE(d,l,h,m,_,x){const w=new Array(_?m+1:m);for(let E=0;E<m;E++){const B=wE(d[l[h+E]],x.numBits,x.coordinateShift);w[E]=new u(B.x,B.y)}return _&&(w[w.length-1]=w[0]),w}class KN{constructor(l,h,m,_,x){H(this,"_vertexBufferType");H(this,"_topologyVector");H(this,"_vertexOffsets");H(this,"_vertexBuffer");H(this,"_mortonSettings");this._vertexBufferType=l,this._topologyVector=h,this._vertexOffsets=m,this._vertexBuffer=_,this._mortonSettings=x}get vertexBufferType(){return this._vertexBufferType}get topologyVector(){return this._topologyVector}get vertexOffsets(){return this._vertexOffsets}get vertexBuffer(){return this._vertexBuffer}*[Symbol.iterator](){const l=WN(this);let h=0;for(;h<this.numGeometries;)yield{coordinates:l[h],type:this.geometryType(h)},h++}getSimpleEncodedVertex(l){const h=this.vertexOffsets?2*this.vertexOffsets[l]:2*l;return[this.vertexBuffer[h],this.vertexBuffer[h+1]]}getVertex(l){if(this.vertexOffsets&&this.mortonSettings){const m=wE(this.vertexBuffer[this.vertexOffsets[l]],this.mortonSettings.numBits,this.mortonSettings.coordinateShift);return[m.x,m.y]}const h=this.vertexOffsets?2*this.vertexOffsets[l]:2*l;return[this.vertexBuffer[h],this.vertexBuffer[h+1]]}getGeometries(){return WN(this)}get mortonSettings(){return this._mortonSettings}}class XN extends KN{constructor(h,m,_,x,w,E,B){super(_,x,w,E,B);H(this,"_numGeometries");H(this,"_geometryType");this._numGeometries=h,this._geometryType=m}geometryType(h){return this._geometryType}get numGeometries(){return this._numGeometries}containsPolygonGeometry(){return this._geometryType===us.POLYGON||this._geometryType===us.MULTIPOLYGON}containsSingleGeometryType(){return!0}}class JN extends KN{constructor(h,m,_,x,w,E){super(h,_,x,w,E);H(this,"_geometryTypes");this._geometryTypes=m}geometryType(h){return this._geometryTypes[h]}get numGeometries(){return this._geometryTypes.length}containsPolygonGeometry(){for(let h=0;h<this.numGeometries;h++)if(this.geometryType(h)===us.POLYGON||this.geometryType(h)===us.MULTIPOLYGON)return!0;return!1}containsSingleGeometryType(){return!1}}class qN{constructor(l,h,m,_){H(this,"_triangleOffsets");H(this,"_indexBuffer");H(this,"_vertexBuffer");H(this,"_topologyVector");this._triangleOffsets=l,this._indexBuffer=h,this._vertexBuffer=m,this._topologyVector=_}get triangleOffsets(){return this._triangleOffsets}get indexBuffer(){return this._indexBuffer}get vertexBuffer(){return this._vertexBuffer}get topologyVector(){return this._topologyVector}getGeometries(){if(!this._topologyVector)throw new Error("Cannot convert GpuVector to coordinates without topology information");const l=new Array(this.numGeometries),h=this._topologyVector,m=h.partOffsets,_=h.ringOffsets,x=h.geometryOffsets;let w=0,E=1,B=1,O=1;for(let N=0;N<this.numGeometries;N++)switch(this.geometryType(N)){case us.POLYGON:{const U=m[E]-m[E-1];E++;const G=[];for(let K=0;K<U;K++){const q=_[B]-_[B-1];B++;const Z=[];for(let ee=0;ee<q;ee++){const ue=this._vertexBuffer[w++],xe=this._vertexBuffer[w++];Z.push(new u(ue,xe))}Z.length>0&&Z.push(Z[0]),G.push(Z)}l[N]=G,x&&O++}break;case us.MULTIPOLYGON:{const U=x[O]-x[O-1];O++;const G=[];for(let K=0;K<U;K++){const q=m[E]-m[E-1];E++;for(let Z=0;Z<q;Z++){const ee=_[B]-_[B-1];B++;const ue=[];for(let xe=0;xe<ee;xe++){const fe=this._vertexBuffer[w++],pe=this._vertexBuffer[w++];ue.push(new u(fe,pe))}ue.length>0&&ue.push(ue[0]),G.push(ue)}}l[N]=G}}return l}[Symbol.iterator](){return null}}function YN(d,l,h,m,_,x){return new Jee(d,l,h,m,_,x)}class Jee extends qN{constructor(h,m,_,x,w,E){super(_,x,w,E);H(this,"_numGeometries");H(this,"_geometryType");this._numGeometries=h,this._geometryType=m}geometryType(h){return this._geometryType}get numGeometries(){return this._numGeometries}containsSingleGeometryType(){return!0}}function ZN(d,l,h,m,_){return new qee(d,l,h,m,_)}class qee extends qN{constructor(h,m,_,x,w){super(m,_,x,w);H(this,"_geometryTypes");this._geometryTypes=h}geometryType(h){return this._geometryTypes[h]}get numGeometries(){return this._geometryTypes.length}containsSingleGeometryType(){return!1}}function Yee(d,l,h,m,_){const x=uo(d,h);let w=null,E=null,B=null,O=null,N=null,U=null,G=null,K=null;if(A1(x,m,d,h)===cs.CONST){const Z=AE(d,h,x,!1);for(let ee=0;ee<l-1;ee++){const ue=uo(d,h);switch(ue.physicalStreamType){case ks.LENGTH:switch(ue.logicalStreamType.lengthType){case Yo.GEOMETRIES:w=Rh(d,h,ue);break;case Yo.PARTS:E=Rh(d,h,ue);break;case Yo.RINGS:B=Rh(d,h,ue);break;case Yo.TRIANGLES:G=Rh(d,h,ue)}break;case ks.OFFSET:switch(ue.logicalStreamType.offsetType){case gf.VERTEX:O=ho(d,h,ue,!1);break;case gf.INDEX:K=ho(d,h,ue,!1)}break;case ks.DATA:Pl.VERTEX===ue.logicalStreamType.dictionaryType?N=ho(d,h,ue,!0):(U={numBits:ue.numBits,coordinateShift:ue.coordinateShift},N=ho(d,h,ue,!1))}}return K!==null?w!=null||E!=null?YN(m,Z,G,K,N,new Cg(w,E,B)):YN(m,Z,G,K,N):U===null?function(ee,ue,xe,fe,pe){return new XN(ee,ue,Sa.VEC_2,xe,fe,pe)}(m,Z,new Cg(w,E,B),O,N):function(ee,ue,xe,fe,pe,Te){return new XN(ee,ue,Sa.MORTON,xe,fe,pe,Te)}(m,Z,new Cg(w,E,B),O,N,U)}const q=ho(d,h,x,!1);for(let Z=0;Z<l-1;Z++){const ee=uo(d,h);switch(ee.physicalStreamType){case ks.LENGTH:switch(ee.logicalStreamType.lengthType){case Yo.GEOMETRIES:w=ho(d,h,ee,!1);break;case Yo.PARTS:E=ho(d,h,ee,!1);break;case Yo.RINGS:B=ho(d,h,ee,!1);break;case Yo.TRIANGLES:G=Rh(d,h,ee)}break;case ks.OFFSET:switch(ee.logicalStreamType.offsetType){case gf.VERTEX:O=ho(d,h,ee,!1);break;case gf.INDEX:K=ho(d,h,ee,!1)}break;case ks.DATA:Pl.VERTEX===ee.logicalStreamType.dictionaryType?N=ho(d,h,ee,!0):(U={numBits:ee.numBits,coordinateShift:ee.coordinateShift},N=ho(d,h,ee,!1))}}return K!==null&&E===null?ZN(q,G,K,N):(w!==null?(w=EE(q,w,2),E!==null&&B!==null?(E=QN(q,w,E,!1),B=function(Z,ee,ue,xe){const fe=new Int32Array(ue[ue.length-1]+1);let pe=0;fe[0]=pe;let Te=1,Oe=1,Ze=0;for(let xt=0;xt<Z.length;xt++){const ht=Z[xt],Ct=ee[xt+1]-ee[xt];if(ht!==0&&ht!==3)for(let Vt=0;Vt<Ct;Vt++){const Et=ue[Te]-ue[Te-1];Te++;for(let bt=0;bt<Et;bt++)pe=fe[Oe++]=pe+xe[Ze++]}else for(let Vt=0;Vt<Ct;Vt++)fe[Oe++]=++pe,Te++}return fe}(q,w,E,B)):E!==null&&(E=function(Z,ee,ue){const xe=new Int32Array(ee[ee.length-1]+1);let fe=0;xe[0]=fe;let pe=1,Te=0;for(let Oe=0;Oe<Z.length;Oe++){const Ze=Z[Oe],xt=ee[Oe+1]-ee[Oe];if(Ze===4||Ze===1)for(let ht=0;ht<xt;ht++)fe=xe[pe++]=fe+ue[Te++];else for(let ht=0;ht<xt;ht++)xe[pe++]=++fe}return xe}(q,w,E))):E!==null&&B!==null?(E=EE(q,E,1),B=QN(q,E,B,!0)):E!==null&&(E=EE(q,E,0)),K!==null?ZN(q,G,K,N,new Cg(w,E,B)):U===null?function(Z,ee,ue,xe){return new JN(Sa.VEC_2,Z,ee,ue,xe)}(q,new Cg(w,E,B),O,N):function(Z,ee,ue,xe,fe){return new JN(Sa.MORTON,Z,ee,ue,xe,fe)}(q,new Cg(w,E,B),O,N,U))}function EE(d,l,h){const m=new Int32Array(d.length+1);let _=0;m[0]=_;let x=0;for(let w=0;w<d.length;w++)_=m[w+1]=_+(d[w]>h?l[x++]:1);return m}function QN(d,l,h,m){const _=new Int32Array(l[l.length-1]+1);let x=0;_[0]=x;let w=1,E=0;for(let B=0;B<d.length;B++){const O=d[B],N=l[B+1]-l[B];if(O===5||O===2||m&&(O===4||O===1))for(let U=0;U<N;U++)x=_[w++]=x+h[E++];else for(let U=0;U<N;U++)_[w++]=++x}return _}class Zee extends xg{constructor(h,m,_){super(h,m.getBuffer(),_);H(this,"dataVector");this.dataVector=m}getValueFromBuffer(h){return this.dataVector.get(h)}}class Qee extends b1{getValueFromBuffer(l){return this.dataBuffer[l]}}class eF extends xg{constructor(l,h,m){super(l,BigInt64Array.of(h),m)}getValueFromBuffer(l){return this.dataBuffer[0]}}function Fb(d,l,h){return tF(d,Math.ceil(l/8),h)}function tF(d,l,h){const m=new Uint8Array(l);let _=0;for(;_<l;){const x=d[h.increment()];if(x<=127){const w=x+3,E=d[h.increment()],B=_+w;m.fill(E,_,B),_=B}else{const w=256-x;for(let E=0;E<w;E++)m[_++]=d[h.increment()]}}return m}const ete=new TextDecoder;function IE(d,l,h){return h-l>=12?ete.decode(d.subarray(l,h)):function(m,_,x){let w="",E=_;for(;E<x;){const B=m[E];let O,N,U,G=null,K=B>239?4:B>223?3:B>191?2:1;if(E+K>x)break;K===1?B<128&&(G=B):K===2?(O=m[E+1],(192&O)==128&&(G=(31&B)<<6|63&O,G<=127&&(G=null))):K===3?(O=m[E+1],N=m[E+2],(192&O)==128&&(192&N)==128&&(G=(15&B)<<12|(63&O)<<6|63&N,(G<=2047||G>=55296&&G<=57343)&&(G=null))):K===4&&(O=m[E+1],N=m[E+2],U=m[E+3],(192&O)==128&&(192&N)==128&&(192&U)==128&&(G=(15&B)<<18|(63&O)<<12|(63&N)<<6|63&U,(G<=65535||G>=1114112)&&(G=null))),G===null?(G=65533,K=1):G>65535&&(G-=65536,w+=String.fromCharCode(G>>>10&1023|55296),G=56320|1023&G),w+=String.fromCharCode(G),E+=K}return w}(d,l,h)}class PE extends xg{constructor(h,m,_,x){super(h,_,x);H(this,"offsetBuffer");this.offsetBuffer=m}}class rF extends PE{constructor(h,m,_,x){super(h,m,_,x??m.length-1);H(this,"textEncoder");this.textEncoder=new TextEncoder}getValueFromBuffer(h){return IE(this.dataBuffer,this.offsetBuffer[h],this.offsetBuffer[h+1])}}class Tg extends PE{constructor(h,m,_,x,w){super(h,_,x,w??m.length);H(this,"indexBuffer");H(this,"textEncoder");this.indexBuffer=m,this.indexBuffer=m,this.textEncoder=new TextEncoder}getValueFromBuffer(h){const m=this.indexBuffer[h];return IE(this.dataBuffer,this.offsetBuffer[m],this.offsetBuffer[m+1])}}class nF extends PE{constructor(h,m,_,x,w,E,B){super(h,_,x,B);H(this,"indexBuffer");H(this,"symbolOffsetBuffer");H(this,"symbolTableBuffer");H(this,"textEncoder");H(this,"symbolLengthBuffer");H(this,"lengthBuffer");H(this,"decodedDictionary");this.indexBuffer=m,this.symbolOffsetBuffer=w,this.symbolTableBuffer=E,this.textEncoder=new TextEncoder}getValueFromBuffer(h){this.decodedDictionary==null&&(this.symbolLengthBuffer==null&&(this.symbolLengthBuffer=this.offsetToLengthBuffer(this.symbolOffsetBuffer),this.lengthBuffer=this.offsetToLengthBuffer(this.offsetBuffer)),this.decodedDictionary=function(_,x,w){const E=[],B=new Array(x.length).fill(0);for(let O=1;O<x.length;O++)B[O]=B[O-1]+x[O-1];for(let O=0;O<w.length;O++)if(w[O]===255)E.push(w[++O]);else{const N=x[w[O]],U=B[w[O]];for(let G=0;G<N;G++)E.push(_[U+G])}return new Uint8Array(E)}(this.symbolTableBuffer,this.symbolLengthBuffer,this.dataBuffer));const m=this.indexBuffer[h];return IE(this.decodedDictionary,this.offsetBuffer[m],this.offsetBuffer[m+1])}offsetToLengthBuffer(h){const m=new Uint32Array(h.length-1);let _=h[0];for(let x=1;x<h.length;x++){const w=h[x];m[x-1]=w-_,_=w}return m}}function tte(d,l,h,m,_,x){return h.type==="scalarType"?function(w,E,B,O,N,U){let G=null,K=0;if(w===0)return null;if(U.nullable){const Z=uo(E,B);K=Z.numValues;const ee=B.get(),ue=Fb(E,K,B);B.set(ee+Z.byteLength),G=new Bl(ue,Z.numValues)}const q=G??O;switch(N.physicalType){case 4:case 3:return function(Z,ee,ue,xe,fe){const pe=uo(Z,ee),Te=A1(pe,fe,Z,ee),Oe=xe.physicalType===3;if(Te===cs.FLAT){const Ze=Ub(fe)?xE(Z,ee,pe,Oe,fe):ho(Z,ee,pe,Oe);return new gE(ue.name,Ze,fe)}if(Te===cs.SEQUENCE){const Ze=UN(Z,ee,pe);return new yE(ue.name,Ze[0],Ze[1],pe.numRleValues)}{const Ze=AE(Z,ee,pe,Oe);return new bE(ue.name,Ze,fe)}}(E,B,U,N,q);case 9:return function(Z,ee,ue,xe,fe){let pe=null,Te=null,Oe=null,Ze=null,xt=null,ht=null,Ct=null,Vt=null;for(let Et=0;Et<xe;Et++){const bt=uo(ee,ue);if(bt.byteLength!==0)switch(bt.physicalStreamType){case ks.PRESENT:{const at=Fb(ee,bt.numValues,ue);ht=new Bl(at,bt.numValues);break}case ks.OFFSET:Te=fe!=null||ht!=null?xE(ee,ue,bt,!1,fe??ht):ho(ee,ue,bt,!1);break;case ks.LENGTH:{const at=Rh(ee,ue,bt);Yo.DICTIONARY===bt.logicalStreamType.lengthType?pe=at:Yo.SYMBOL===bt.logicalStreamType.lengthType?Ze=at:Ct=at;break}case ks.DATA:{const at=ee.subarray(ue.get(),ue.get()+bt.byteLength);ue.add(bt.byteLength);const Yt=bt.logicalStreamType.dictionaryType;Pl.FSST===Yt?xt=at:Pl.SINGLE===Yt||Pl.SHARED===Yt?Oe=at:Pl.NONE===Yt&&(Vt=at);break}}}return function(Et,bt,at,Yt,Jt,ir,Xt){return bt?new nF(Et,at,Yt,Jt,ir,bt,Xt):null}(Z,xt,Te,pe,Oe,Ze,fe??ht)??function(Et,bt,at,Yt,Jt){return bt?Jt?new Tg(Et,at,Yt,bt,Jt):new Tg(Et,at,Yt,bt):null}(Z,Oe,Te,pe,fe??ht)??function(Et,bt,at,Yt,Jt){if(!bt||!at)return null;if(Yt)return Jt?new Tg(Et,Yt,bt,at,Jt):new Tg(Et,Yt,bt,at);if(Jt&&Jt.size()!==bt.length-1){const ir=new Int32Array(Jt.size());let Xt=0;for(let dr=0;dr<Jt.size();dr++)ir[dr]=Jt.get(dr)?Xt++:0;return new Tg(Et,ir,bt,at,Jt)}return Jt?new rF(Et,bt,at,Jt):new rF(Et,bt,at)}(Z,Ct,Vt,Te,fe??ht)}(U.name,E,B,U.nullable?w-1:w,G);case 0:return function(Z,ee,ue,xe,fe){const pe=uo(Z,ee),Te=pe.numValues,Oe=ee.get(),Ze=Ub(fe)?function(ht,Ct,Vt,Et){const bt=tF(ht,Math.ceil(Ct/8),Vt),at=new Bl(bt,Ct),Yt=Et.size(),Jt=new Bl(new Uint8Array(Yt),Yt);let ir=0;for(let Xt=0;Xt<Et.size();Xt++){const dr=!!Et.get(Xt)&&at.get(ir++);Jt.set(Xt,dr)}return Jt.getBuffer()}(Z,Te,ee,fe):Fb(Z,Te,ee);ee.set(Oe+pe.byteLength);const xt=new Bl(Ze,Te);return new Zee(ue.name,xt,fe)}(E,B,U,0,q);case 6:case 5:return function(Z,ee,ue,xe,fe){const pe=uo(Z,ee),Te=A1(pe,xe,Z,ee),Oe=fe.physicalType===5;if(Te===cs.FLAT){const Ze=Ub(xe)?function(xt,ht,Ct,Vt,Et){return function(bt,at,Yt,Jt){switch(at.logicalLevelTechnique1){case Kr.DELTA:return at.logicalLevelTechnique2===Kr.RLE&&(bt=LN(bt,at.runs,at.numRleValues)),function(ir,Xt){const dr=new BigInt64Array(ir.size());let an=0;ir.get(0)?(dr[0]=ir.get(0)?Xt[0]>>1n^-(1n&Xt[0]):0n,an=1):dr[0]=0n;let Gr=1;for(;Gr!=dr.length;++Gr)dr[Gr]=ir.get(Gr)?dr[Gr-1]+(Xt[an]>>1n^-(1n&Xt[an++])):dr[Gr-1];return dr}(Jt,bt);case Kr.RLE:return function(ir,Xt,dr,an){const Gr=Xt;return dr?function(ai,Ds,zi){const li=new BigInt64Array(ai.size());let Yn=0;for(let mn=0;mn<zi;mn++){const _i=Number(Ds[mn]);let Ei=Ds[mn+zi];Ei=Ei>>1n^-(1n&Ei);for(let Wn=Yn;Wn<Yn+_i;Wn++)ai.get(Wn)?li[Wn]=Ei:(li[Wn]=0n,Yn++);Yn+=_i}return li}(an,ir,Gr.runs):function(ai,Ds,zi){const li=new BigInt64Array(ai.size());let Yn=0;for(let mn=0;mn<zi;mn++){const _i=Number(Ds[mn]),Ei=Ds[mn+zi];for(let Wn=Yn;Wn<Yn+_i;Wn++)ai.get(Wn)?li[Wn]=Ei:(li[Wn]=0n,Yn++);Yn+=_i}return li}(an,ir,Gr.runs)}(bt,at,Yt,Jt);case Kr.NONE:return bt=Yt?function(ir,Xt){const dr=new BigInt64Array(ir.size());let an=0,Gr=0;for(;Gr!=dr.length;++Gr)if(ir.get(Gr)){const ai=Xt[an++];dr[Gr]=ai>>1n^-(1n&ai)}else dr[Gr]=0n;return dr}(Jt,bt):function(ir,Xt){const dr=new BigInt64Array(ir.size());let an=0,Gr=0;for(;Gr!=dr.length;++Gr)dr[Gr]=ir.get(Gr)?Xt[an++]:0n;return dr}(Jt,bt),bt;default:throw new Error("The specified Logical level technique is not supported")}}(_1(xt,ht,Ct.numValues),Ct,Vt,Et)}(Z,ee,pe,Oe,xe):VN(Z,ee,pe,Oe);return new jN(ue.name,Ze,xe)}if(Te===cs.SEQUENCE){const Ze=zN(Z,ee,pe);return new GN(ue.name,Ze[0],Ze[1],pe.numRleValues)}{const Ze=$N(Z,ee,pe,Oe);return new eF(ue.name,Ze,xe)}}(E,B,U,q,N);case 7:return function(Z,ee,ue,xe){const fe=uo(Z,ee),pe=Ub(xe)?function(Te,Oe,Ze,xt){const ht=Oe.get(),Ct=ht+xt*Float32Array.BYTES_PER_ELEMENT,Vt=new Uint8Array(Te.subarray(ht,Ct)).buffer,Et=new Float32Array(Vt);Oe.set(Ct);const bt=Ze.size(),at=new Float32Array(bt);let Yt=0;for(let Jt=0;Jt<bt;Jt++)at[Jt]=Ze.get(Jt)?Et[Yt++]:0;return at}(Z,ee,xe,fe.numValues):function(Te,Oe,Ze){const xt=Oe.get(),ht=xt+Ze*Float32Array.BYTES_PER_ELEMENT,Ct=new Uint8Array(Te.subarray(xt,ht)).buffer,Vt=new Float32Array(Ct);return Oe.set(ht),Vt}(Z,ee,fe.numValues);return new Qee(ue.name,pe,xe)}(E,B,U,q);case 8:return function(Z,ee,ue,xe){const fe=uo(Z,ee),pe=Ub(xe)?function(Te,Oe,Ze,xt){const ht=Oe.get(),Ct=ht+xt*Float64Array.BYTES_PER_ELEMENT,Vt=new Uint8Array(Te.subarray(ht,Ct)).buffer,Et=new Float64Array(Vt);Oe.set(Ct);const bt=Ze.size(),at=new Float64Array(bt);let Yt=0;for(let Jt=0;Jt<bt;Jt++)at[Jt]=Ze.get(Jt)?Et[Yt++]:0;return at}(Z,ee,xe,fe.numValues):function(Te,Oe,Ze){const xt=Oe.get(),ht=xt+Ze*Float64Array.BYTES_PER_ELEMENT,Ct=new Uint8Array(Te.subarray(xt,ht)).buffer,Vt=new Float64Array(Ct);return Oe.set(ht),Vt}(Z,ee,fe.numValues);return new mE(ue.name,pe,xe)}(E,B,U,q);default:throw new Error(`The specified data type for the field is currently not supported: ${N}`)}}(m,d,l,_,h.scalarType,h):m!=1?null:function(w,E,B,O){let N=null,U=null,G=null,K=null,q=!1;for(;!q;){const xe=uo(w,E);switch(xe.physicalStreamType){case ks.LENGTH:Yo.DICTIONARY===xe.logicalStreamType.lengthType?N=Rh(w,E,xe):G=Rh(w,E,xe);break;case ks.DATA:Pl.SINGLE===xe.logicalStreamType.dictionaryType||Pl.SHARED===xe.logicalStreamType.dictionaryType?(U=w.subarray(E.get(),E.get()+xe.byteLength),q=!0):K=w.subarray(E.get(),E.get()+xe.byteLength),E.add(xe.byteLength)}}const Z=B.complexType.children,ee=[];let ue=0;for(const xe of Z){const fe=Ss(w,E,1)[0];if(fe==0)continue;const pe=`${B.name}${xe.name==="default"?"":":"+xe.name}`;if(fe!==2||xe.type!=="scalarField"||xe.scalarField.physicalType!==9)throw new Error("Currently only optional string fields are implemented for a struct.");const Te=uo(w,E),Oe=Fb(w,Te.numValues,E),Ze=uo(w,E),xt=Ze.decompressedCount!==O?xE(w,E,Ze,!1,new Bl(Oe,Te.numValues)):ho(w,E,Ze,!1);ee[ue++]=K?new nF(pe,xt,N,U,G,K,new Bl(Oe,Te.numValues)):new Tg(pe,xt,N,U,new Bl(Oe,Te.numValues))}return ee}(d,l,h,_)}function Ub(d){return d instanceof Bl}function rte(d){if(d.name==="id")return!1;if(d.type==="scalarType"){const l=d.scalarType;if(l.type==="physicalType")switch(l.physicalType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:default:return!1;case 9:return!0}else if(l.type==="logicalType")return!1}else if(d.type==="complexType"){const l=d.complexType;if(l.type==="physicalType")switch(l.physicalType){case 0:case 1:return!0;default:return!1}}return console.warn("Unexpected column type in hasStreamCount",d),!1}const nte=new TextDecoder;function iF(d,l){const h=Ss(d,l,1)[0];if(h===0)return"";const m=l.get(),_=d.subarray(m,m+h);return l.add(h),nte.decode(_)}function sF(d,l){const h=Ss(d,l,1)[0]>>>0,m=!!(4&h),_=!!(2&h),x=Ss(d,l,1)[0]>>>0,w={};if(1&h&&(w.nullable=!0),_){const E={};if(m?(E.type="logicalType",E.logicalType=x):(E.type="physicalType",E.physicalType=x),8&h){const B=Ss(d,l,1)[0]>>>0;E.children=new Array(B);for(let O=0;O<B;O++)E.children[O]=sF(d,l)}w.type="complexField",w.complexField=E}else{const E={};m?(E.type="logicalType",E.logicalType=x):(E.type="physicalType",E.physicalType=x),w.type="scalarField",w.scalarField=E}return w}function ite(d,l){const h=Ss(d,l,1)[0]>>>0,m=function(_){switch(_){case 0:case 1:case 2:case 3:{const x={};x.nullable=!!(1&_),x.columnScope=0;const w={};return w.physicalType=_>1?6:4,w.type="physicalType",x.scalarType=w,x.type="scalarType",x}case 4:{const x={nullable:!1,columnScope:0},w={type:"physicalType",physicalType:0};return x.type="complexType",x.complexType=w,x}case 30:{const x={nullable:!1,columnScope:0},w={type:"physicalType",physicalType:1};return x.type="complexType",x.complexType=w,x}default:return function(x){let w=null;switch(x){case 10:case 11:w=0;break;case 12:case 13:w=1;break;case 14:case 15:w=2;break;case 16:case 17:w=3;break;case 18:case 19:w=4;break;case 20:case 21:w=5;break;case 22:case 23:w=6;break;case 24:case 25:w=7;break;case 26:case 27:w=8;break;case 28:case 29:w=9;break;default:return null}const E={};E.nullable=!!(1&x),E.columnScope=0;const B={type:"physicalType"};return B.physicalType=w,E.type="scalarType",E.scalarType=B,E}(_)}}(h);if(!m)throw new Error(`Unsupported column type code: ${h}`);if(function(_){return _>=10}(h)?m.name=iF(d,l):h>=0&&h<=3?m.name="id":h===4&&(m.name="geometry"),function(_){return _===30}(h)){const _=Ss(d,l,1)[0]>>>0,x=m.complexType;x.children=new Array(_);for(let w=0;w<_;w++)x.children[w]=sF(d,l)}return m}function ste(d,l){const h={featureTables:[]},m={};m.name=iF(d,l);const _=Ss(d,l,1)[0]>>>0,x=Ss(d,l,1)[0]>>>0;m.columns=new Array(x);for(let w=0;w<x;w++)m.columns[w]=ite(d,l);return h.featureTables.push(m),[h,_]}function ote(d,l,h,m,_,x,w=!1){const E=l.scalarType.physicalType,B=A1(_,x,d,h);if(E===4)switch(B){case cs.FLAT:{const O=ho(d,h,_,!1);return new gE(m,O,x)}case cs.SEQUENCE:{const O=UN(d,h,_);return new yE(m,O[0],O[1],_.numRleValues)}case cs.CONST:{const O=AE(d,h,_,!1);return new bE(m,O,x)}}else switch(B){case cs.FLAT:{if(w){const N=function(U,G,K,q){const Z=function(ee,ue,xe){const fe=new Float64Array(ue);for(let pe=0;pe<ue;pe++)fe[pe]=Wee(ee,xe);return fe}(U,K.numValues,G);return function(ee,ue,xe){switch(ue.logicalLevelTechnique1){case Kr.DELTA:return ue.logicalLevelTechnique2===Kr.RLE&&(ee=NN(ee,ue.runs,ue.numRleValues)),function(fe){fe[0]=fe[0]%2==1?(fe[0]+1)/-2:fe[0]/2;const pe=fe.length/4*4;let Te=1;if(pe>=4)for(;Te<pe-4;Te+=4){const Oe=fe[Te],Ze=fe[Te+1],xt=fe[Te+2],ht=fe[Te+3];fe[Te]=(Oe%2==1?(Oe+1)/-2:Oe/2)+fe[Te-1],fe[Te+1]=(Ze%2==1?(Ze+1)/-2:Ze/2)+fe[Te],fe[Te+2]=(xt%2==1?(xt+1)/-2:xt/2)+fe[Te+1],fe[Te+3]=(ht%2==1?(ht+1)/-2:ht/2)+fe[Te+2]}for(;Te!=fe.length;++Te)fe[Te]=(fe[Te]%2==1?(fe[Te]+1)/-2:fe[Te]/2)+fe[Te-1]}(ee),ee;case Kr.RLE:return function(fe,pe,Te){return NN(fe,pe.runs,pe.numRleValues)}(ee,ue);case Kr.NONE:return ee;default:throw new Error(`The specified Logical level technique is not supported: ${ue.logicalLevelTechnique1}`)}}(Z,K)}(d,h,_);return new mE(m,N,x)}const O=VN(d,h,_,!1);return new jN(m,O,x)}case cs.SEQUENCE:{const O=zN(d,h,_);return new GN(m,O[0],O[1],_.numRleValues)}case cs.CONST:{const O=$N(d,h,_,!1);return new eF(m,O,x)}}throw new Error("Vector type not supported for id column.")}class ate{constructor(l,h){var m;switch(this._featureData=l,this.properties=this._featureData.properties||{},(m=this._featureData.geometry)===null||m===void 0?void 0:m.type){case us.POINT:case us.MULTIPOINT:this.type=1;break;case us.LINESTRING:case us.MULTILINESTRING:this.type=2;break;case us.POLYGON:case us.MULTIPOLYGON:this.type=3;break;default:this.type=0}this.extent=h,this.id=Number(this._featureData.id)}loadGeometry(){const l=[];for(const h of this._featureData.geometry.coordinates){const m=[];for(const _ of h)m.push(new u(_.x,_.y));l.push(m)}return l}}class lte{constructor(l){this.features=[],this.featureTable=l,this.name=l.name,this.extent=l.extent,this.version=2,this.features=l.getFeatures(),this.length=this.features.length}feature(l){return new ate(this.features[l],this.extent)}}class oF{constructor(l){this.layers={};const h=function(m,_,x=!0){const w=new Hee(0),E=[];for(;w.get()<m.length;){const B=Ss(m,w,1)[0]>>>0,O=w.get()+B;if(O>m.length)throw new Error(`Block overruns tile: ${O} > ${m.length}`);if(Ss(m,w,1)[0]>>>0!=1){w.set(O);continue}const N=ste(m,w),U=N[1],G=N[0].featureTables[0];let K=null,q=null;const Z=[];let ee=0;for(const xe of G.columns){const fe=xe.name;if(fe==="id"){let pe=null;if(xe.nullable){const Oe=uo(m,w),Ze=w.get(),xt=Fb(m,Oe.numValues,w);w.set(Ze+Oe.byteLength),pe=new Bl(xt,Oe.numValues)}const Te=uo(m,w);ee=Te.decompressedCount,K=ote(m,xe,w,fe,Te,pe??ee,x)}else if(fe==="geometry"){const pe=Ss(m,w,1)[0];if(ee===0){const Te=w.get();ee=uo(m,w).decompressedCount,w.set(Te)}q=Yee(m,pe,w,ee)}else{const pe=rte(xe)?Ss(m,w,1)[0]:1;if(pe===0&&xe.type==="scalarType")continue;const Te=tte(m,w,xe,pe,ee);if(Te)if(Array.isArray(Te))for(const Oe of Te)Z.push(Oe);else Z.push(Te)}}const ue=new Gee(G.name,q,K,Z,U);E.push(ue),w.set(O)}return E}(new Uint8Array(l));this.layers=h.reduce((m,_)=>Object.assign(Object.assign({},m),{[_.name]:new lte(_)}),{})}}class cte{constructor(l,h){this.feature=l,this.type=l.type,this.properties=l.tags?l.tags:{},this.extent=h,"id"in l&&(typeof l.id=="string"?this.id=parseInt(l.id,10):typeof l.id!="number"||isNaN(l.id)||(this.id=l.id))}loadGeometry(){const l=[],h=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const m of h){const _=[];for(const x of m)_.push(new u(x[0],x[1]));l.push(_)}return l}}const zb="_geojsonTileLayer";function ute(d,l){l.writeVarintField(15,d.version||1),l.writeStringField(1,d.name||""),l.writeVarintField(5,d.extent||4096);const h={keys:[],values:[],keycache:{},valuecache:{}};for(let x=0;x<d.length;x++)h.feature=d.feature(x),l.writeMessage(2,hte,h);const m=h.keys;for(const x of m)l.writeStringField(3,x);const _=h.values;for(const x of _)l.writeMessage(4,pte,x)}function hte(d,l){if(!d.feature)return;const h=d.feature;h.id!==void 0&&l.writeVarintField(1,h.id),l.writeMessage(2,dte,d),l.writeVarintField(3,h.type),l.writeMessage(4,fte,h)}function dte(d,l){for(const h in d.feature?.properties){let m=d.feature.properties[h],_=d.keycache[h];if(m==null)continue;_===void 0&&(d.keys.push(h),_=d.keys.length-1,d.keycache[h]=_),l.writeVarint(_),typeof m!="string"&&typeof m!="boolean"&&typeof m!="number"&&(m=JSON.stringify(m));const x=typeof m+":"+m;let w=d.valuecache[x];w===void 0&&(d.values.push(m),w=d.values.length-1,d.valuecache[x]=w),l.writeVarint(w)}}function BE(d,l){return(l<<3)+(7&d)}function aF(d){return d<<1^d>>31}function fte(d,l){const h=d.loadGeometry(),m=d.type;let _=0,x=0;for(const w of h){let E=1;m===1&&(E=w.length),l.writeVarint(BE(1,E));const B=m===3?w.length-1:w.length;for(let O=0;O<B;O++){O===1&&m!==1&&l.writeVarint(BE(2,B-1));const N=w[O].x-_,U=w[O].y-x;l.writeVarint(aF(N)),l.writeVarint(aF(U)),_+=N,x+=U}d.type===3&&l.writeVarint(BE(7,1))}}function pte(d,l){const h=typeof d;h==="string"?l.writeStringField(1,d):h==="boolean"?l.writeBooleanField(7,d):h==="number"&&(d%1!=0?l.writeDoubleField(3,d):d<0?l.writeSVarintField(6,d):l.writeVarintField(5,d))}class lF{constructor(l,h){this.tileID=l,this.x=l.canonical.x,this.y=l.canonical.y,this.z=l.canonical.z,this.grid=new Th(Ut,16,0),this.grid3D=new Th(Ut,16,0),this.featureIndexArray=new ae,this.promoteId=h}insert(l,h,m,_,x,w){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(m,_,x);const B=w?this.grid3D:this.grid;for(let O=0;O<h.length;O++){const N=h[O],U=[1/0,1/0,-1/0,-1/0];for(let G=0;G<N.length;G++){const K=N[G];U[0]=Math.min(U[0],K.x),U[1]=Math.min(U[1],K.y),U[2]=Math.max(U[2],K.x),U[3]=Math.max(U[3],K.y)}U[0]<Ut&&U[1]<Ut&&U[2]>=0&&U[3]>=0&&B.insert(E,U[0],U[1],U[2],U[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=this.encoding!=="mlt"?new KL(new f1(this.rawTileData)).layers:new oF(this.rawTileData).layers,this.sourceLayerCoder=new BN(this.vtLayers?Object.keys(this.vtLayers).sort():[zb])),this.vtLayers}query(l,h,m,_){this.loadVTLayers();const x=l.params,w=Ut/l.tileSize/l.scale,E=jd(x.filter,x.globalState),B=l.queryGeometry,O=l.queryPadding*w,N=pf.fromPoints(B),U=this.grid.query(N.minX-O,N.minY-O,N.maxX+O,N.maxY+O),G=pf.fromPoints(l.cameraQueryGeometry).expandBy(O),K=this.grid3D.query(G.minX,G.minY,G.maxX,G.maxY,(ee,ue,xe,fe)=>function(pe,Te,Oe,Ze,xt){for(const Ct of pe)if(Te<=Ct.x&&Oe<=Ct.y&&Ze>=Ct.x&&xt>=Ct.y)return!0;const ht=[new u(Te,Oe),new u(Te,xt),new u(Ze,xt),new u(Ze,Oe)];if(pe.length>2){for(const Ct of ht)if(fg(pe,Ct))return!0}for(let Ct=0;Ct<pe.length-1;Ct++)if(mQ(pe[Ct],pe[Ct+1],ht))return!0;return!1}(l.cameraQueryGeometry,ee-O,ue-O,xe+O,fe+O));for(const ee of K)U.push(ee);U.sort(gte);const q={};let Z;for(let ee=0;ee<U.length;ee++){const ue=U[ee];if(ue===Z)continue;Z=ue;const xe=this.featureIndexArray.get(ue);let fe=null;this.loadMatchingFeature(q,xe.bucketIndex,xe.sourceLayerIndex,xe.featureIndex,E,x.layers,x.availableImages,h,m,_,(pe,Te,Oe)=>(fe||(fe=wc(pe)),Te.queryIntersectsFeature({queryGeometry:B,feature:pe,featureState:Oe,geometry:fe,zoom:this.z,transform:l.transform,pixelsToTileUnits:w,pixelPosMatrix:l.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:l.getElevation})))}return q}loadMatchingFeature(l,h,m,_,x,w,E,B,O,N,U){const G=this.bucketLayerIDs[h];if(w&&!G.some(ee=>w.has(ee)))return;const K=this.sourceLayerCoder.decode(m),q=this.vtLayers[K].feature(_);if(x.needGeometry){const ee=Cc(q,!0);if(!x.filter(new kn(this.tileID.overscaledZ),ee,this.tileID.canonical))return}else if(!x.filter(new kn(this.tileID.overscaledZ),q))return;const Z=this.getId(q,K);for(let ee=0;ee<G.length;ee++){const ue=G[ee];if(w&&!w.has(ue))continue;const xe=B[ue];if(!xe)continue;let fe={};Z&&N&&(fe=N.getState(xe.sourceLayer||zb,Z));const pe=Mn({},O[ue]);pe.paint=cF(pe.paint,xe.paint,q,fe,E),pe.layout=cF(pe.layout,xe.layout,q,fe,E);const Te=!U||U(q,xe,fe);if(!Te)continue;const Oe=new MN(q,this.z,this.x,this.y,Z);Oe.layer=pe;let Ze=l[ue];Ze===void 0&&(Ze=l[ue]=[]),Ze.push({featureIndex:_,feature:Oe,intersectionZ:Te})}}lookupSymbolFeatures(l,h,m,_,x,w,E,B){const O={};this.loadVTLayers();const N=jd(x.filterSpec,x.globalState);for(const U of l)this.loadMatchingFeature(O,m,_,U,N,w,E,B,h);return O}hasLayer(l){for(const h of this.bucketLayerIDs)for(const m of h)if(l===m)return!0;return!1}getId(l,h){var m;let _=l.id;return this.promoteId&&(_=l.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[h]],typeof _=="boolean"&&(_=Number(_)),_===void 0&&(!((m=l.properties)===null||m===void 0)&&m.cluster)&&this.promoteId&&(_=Number(l.properties.cluster_id))),_}}function cF(d,l,h,m,_){return kt(d,(x,w)=>{const E=l instanceof rf?l.get(w):null;return E&&E.evaluate?E.evaluate(h,m,_):E})}function gte(d,l){return l-d}function uF(d,l,h,m,_){const x=[];for(let w=0;w<d.length;w++){const E=d[w];let B;for(let O=0;O<E.length-1;O++){let N=E[O],U=E[O+1];N.x<l&&U.x<l||(N.x<l?N=new u(l,N.y+(l-N.x)/(U.x-N.x)*(U.y-N.y))._round():U.x<l&&(U=new u(l,N.y+(l-N.x)/(U.x-N.x)*(U.y-N.y))._round()),N.y<h&&U.y<h||(N.y<h?N=new u(N.x+(h-N.y)/(U.y-N.y)*(U.x-N.x),h)._round():U.y<h&&(U=new u(N.x+(h-N.y)/(U.y-N.y)*(U.x-N.x),h)._round()),N.x>=m&&U.x>=m||(N.x>=m?N=new u(m,N.y+(m-N.x)/(U.x-N.x)*(U.y-N.y))._round():U.x>=m&&(U=new u(m,N.y+(m-N.x)/(U.x-N.x)*(U.y-N.y))._round()),N.y>=_&&U.y>=_||(N.y>=_?N=new u(N.x+(_-N.y)/(U.y-N.y)*(U.x-N.x),_)._round():U.y>=_&&(U=new u(N.x+(_-N.y)/(U.y-N.y)*(U.x-N.x),_)._round()),B&&N.equals(B[B.length-1])||(B=[N],x.push(B)),B.push(U)))))}}return x}function hF(d,l,h,m,_){switch(l){case 1:return function(x,w,E,B){const O=[];for(const N of x)for(const U of N){const G=B===0?U.x:U.y;G>=w&&G<=E&&O.push([U])}return O}(d,h,m,_);case 2:return dF(d,h,m,_,!1);case 3:return dF(d,h,m,_,!0)}return[]}function mte(d,l,h,m,_){const x=m===0?yte:bte;let w=[];const E=[];for(let N=0;N<d.length-1;N++){const U=d[N],G=d[N+1],K=m===0?U.x:U.y,q=m===0?G.x:G.y;let Z=!1;K<l?q>l&&w.push(x(U,G,l)):K>h?q<h&&w.push(x(U,G,h)):w.push(U),q<l&&K>=l&&(w.push(x(U,G,l)),Z=!0),q>h&&K<=h&&(w.push(x(U,G,h)),Z=!0),!_&&Z&&(E.push(w),w=[])}const B=d.length-1,O=m===0?d[B].x:d[B].y;return O>=l&&O<=h&&w.push(d[B]),_&&w.length>0&&!w[0].equals(w[w.length-1])&&w.push(new u(w[0].x,w[0].y)),w.length>0&&E.push(w),E}function dF(d,l,h,m,_){const x=[];for(const w of d){const E=mte(w,l,h,m,_);E.length>0&&x.push(...E)}return x}function yte(d,l,h){return new u(h,d.y+(h-d.x)/(l.x-d.x)*(l.y-d.y))}function bte(d,l,h){return new u(d.x+(h-d.y)/(l.y-d.y)*(l.x-d.x),h)}er("FeatureIndex",lF,{omit:["rawTileData","sourceLayerCoder"]});class kh extends u{constructor(l,h,m,_){super(l,h),this.angle=m,_!==void 0&&(this.segment=_)}clone(){return new kh(this.x,this.y,this.angle,this.segment)}}function fF(d,l,h,m,_){if(l.segment===void 0||h===0)return!0;let x=l,w=l.segment+1,E=0;for(;E>-h/2;){if(w--,w<0)return!1;E-=d[w].dist(x),x=d[w]}E+=d[w].dist(d[w+1]),w++;const B=[];let O=0;for(;E<h/2;){const N=d[w],U=d[w+1];if(!U)return!1;let G=d[w-1].angleTo(N)-N.angleTo(U);for(G=Math.abs((G+3*Math.PI)%(2*Math.PI)-Math.PI),B.push({distance:E,angleDelta:G}),O+=G;E-B[0].distance>m;)O-=B.shift().angleDelta;if(O>_)return!1;w++,E+=N.dist(U)}return!0}function pF(d){let l=0;for(let h=0;h<d.length-1;h++)l+=d[h].dist(d[h+1]);return l}function gF(d,l,h){return d?.6*l*h:0}function mF(d,l){return Math.max(d?d.right-d.left:0,l?l.right-l.left:0)}function _te(d,l,h,m,_,x){const w=gF(h,_,x),E=mF(h,m)*x;let B=0;const O=pF(d)/2;for(let N=0;N<d.length-1;N++){const U=d[N],G=d[N+1],K=U.dist(G);if(B+K>O){const q=(O-B)/K,Z=ii.number(U.x,G.x,q),ee=ii.number(U.y,G.y,q),ue=new kh(Z,ee,G.angleTo(U),N);return ue._round(),!w||fF(d,ue,E,w,l)?ue:void 0}B+=K}}function vte(d,l,h,m,_,x,w,E,B){const O=gF(m,x,w),N=mF(m,_),U=N*w,G=d[0].x===0||d[0].x===B||d[0].y===0||d[0].y===B;return l-U<l/4&&(l=U+l/4),yF(d,G?l/2*E%l:(N/2+2*x)*w*E%l,l,O,h,U,G,!1,B)}function yF(d,l,h,m,_,x,w,E,B){const O=x/2,N=pF(d);let U=0,G=l-h,K=[];for(let q=0;q<d.length-1;q++){const Z=d[q],ee=d[q+1],ue=Z.dist(ee),xe=ee.angleTo(Z);for(;G+h<U+ue;){G+=h;const fe=(G-U)/ue,pe=ii.number(Z.x,ee.x,fe),Te=ii.number(Z.y,ee.y,fe);if(pe>=0&&pe<B&&Te>=0&&Te<B&&G-O>=0&&G+O<=N){const Oe=new kh(pe,Te,xe,q);Oe._round(),m&&!fF(d,Oe,x,m,_)||K.push(Oe)}}U+=ue}return E||K.length||w||(K=yF(d,U/2,h,m,_,x,w,!0,B)),K}function bF(d,l,h,m){const _=[],x=d.image,w=x.pixelRatio,E=x.paddedRect.w-2,B=x.paddedRect.h-2;let O={x1:d.left,y1:d.top,x2:d.right,y2:d.bottom};const N=x.stretchX||[[0,E]],U=x.stretchY||[[0,B]],G=(at,Yt)=>at+Yt[1]-Yt[0],K=N.reduce(G,0),q=U.reduce(G,0),Z=E-K,ee=B-q;let ue=0,xe=K,fe=0,pe=q,Te=0,Oe=Z,Ze=0,xt=ee;if(x.content&&m){const at=x.content,Yt=at[2]-at[0],Jt=at[3]-at[1];(x.textFitWidth||x.textFitHeight)&&(O=fN(d)),ue=T1(N,0,at[0]),fe=T1(U,0,at[1]),xe=T1(N,at[0],at[2]),pe=T1(U,at[1],at[3]),Te=at[0]-ue,Ze=at[1]-fe,Oe=Yt-xe,xt=Jt-pe}const ht=O.x1,Ct=O.y1,Vt=O.x2-ht,Et=O.y2-Ct,bt=(at,Yt,Jt,ir)=>{const Xt=S1(at.stretch-ue,xe,Vt,ht),dr=E1(at.fixed-Te,Oe,at.stretch,K),an=S1(Yt.stretch-fe,pe,Et,Ct),Gr=E1(Yt.fixed-Ze,xt,Yt.stretch,q),ai=S1(Jt.stretch-ue,xe,Vt,ht),Ds=E1(Jt.fixed-Te,Oe,Jt.stretch,K),zi=S1(ir.stretch-fe,pe,Et,Ct),li=E1(ir.fixed-Ze,xt,ir.stretch,q),Yn=new u(Xt,an),mn=new u(ai,an),_i=new u(ai,zi),Ei=new u(Xt,zi),Wn=new u(dr/w,Gr/w),Mo=new u(Ds/w,li/w),Ls=l*Math.PI/180;if(Ls){const hs=Math.sin(Ls),fi=Math.cos(Ls),Vi=[fi,-hs,hs,fi];Yn._matMult(Vi),mn._matMult(Vi),Ei._matMult(Vi),_i._matMult(Vi)}const Ro=at.stretch+at.fixed,nl=Yt.stretch+Yt.fixed;return{tl:Yn,tr:mn,bl:Ei,br:_i,tex:{x:x.paddedRect.x+1+Ro,y:x.paddedRect.y+1+nl,w:Jt.stretch+Jt.fixed-Ro,h:ir.stretch+ir.fixed-nl},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Wn,pixelOffsetBR:Mo,minFontScaleX:Oe/w/Vt,minFontScaleY:xt/w/Et,isSDF:h}};if(m&&(x.stretchX||x.stretchY)){const at=_F(N,Z,K),Yt=_F(U,ee,q);for(let Jt=0;Jt<at.length-1;Jt++){const ir=at[Jt],Xt=at[Jt+1];for(let dr=0;dr<Yt.length-1;dr++)_.push(bt(ir,Yt[dr],Xt,Yt[dr+1]))}}else _.push(bt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:B+1}));return _}function T1(d,l,h){let m=0;for(const _ of d)m+=Math.max(l,Math.min(h,_[1]))-Math.max(l,Math.min(h,_[0]));return m}function _F(d,l,h){const m=[{fixed:-1,stretch:0}];for(const[_,x]of d){const w=m[m.length-1];m.push({fixed:_-w.stretch,stretch:w.stretch}),m.push({fixed:_-w.stretch,stretch:w.stretch+(x-_)})}return m.push({fixed:l+1,stretch:h}),m}function S1(d,l,h,m){return d/l*h+m}function E1(d,l,h,m){return d-l*h/m}er("Anchor",kh);class I1{constructor(l,h,m,_,x,w,E,B,O,N){var U;if(this.boxStartIndex=l.length,O){let G=w.top,K=w.bottom;const q=w.collisionPadding;q&&(G-=q[1],K+=q[3]);let Z=K-G;Z>0&&(Z=Math.max(10,Z),this.circleDiameter=Z)}else{const G=!((U=w.image)===null||U===void 0)&&U.content&&(w.image.textFitWidth||w.image.textFitHeight)?fN(w):{x1:w.left,y1:w.top,x2:w.right,y2:w.bottom};G.y1=G.y1*E-B[0],G.y2=G.y2*E+B[2],G.x1=G.x1*E-B[3],G.x2=G.x2*E+B[1];const K=w.collisionPadding;if(K&&(G.x1-=K[0]*E,G.y1-=K[1]*E,G.x2+=K[2]*E,G.y2+=K[3]*E),N){const q=new u(G.x1,G.y1),Z=new u(G.x2,G.y1),ee=new u(G.x1,G.y2),ue=new u(G.x2,G.y2),xe=N*Math.PI/180;q._rotate(xe),Z._rotate(xe),ee._rotate(xe),ue._rotate(xe),G.x1=Math.min(q.x,Z.x,ee.x,ue.x),G.x2=Math.max(q.x,Z.x,ee.x,ue.x),G.y1=Math.min(q.y,Z.y,ee.y,ue.y),G.y2=Math.max(q.y,Z.y,ee.y,ue.y)}l.emplaceBack(h.x,h.y,G.x1,G.y1,G.x2,G.y2,m,_,x)}this.boxEndIndex=l.length}}class Ate{constructor(l=[],h=(m,_)=>m<_?-1:m>_?1:0){if(this.data=l,this.length=this.data.length,this.compare=h,this.length>0)for(let m=(this.length>>1)-1;m>=0;m--)this._down(m)}push(l){this.data.push(l),this._up(this.length++)}pop(){if(this.length===0)return;const l=this.data[0],h=this.data.pop();return--this.length>0&&(this.data[0]=h,this._down(0)),l}peek(){return this.data[0]}_up(l){const{data:h,compare:m}=this,_=h[l];for(;l>0;){const x=l-1>>1,w=h[x];if(m(_,w)>=0)break;h[l]=w,l=x}h[l]=_}_down(l){const{data:h,compare:m}=this,_=this.length>>1,x=h[l];for(;l<_;){let w=1+(l<<1);const E=w+1;if(E<this.length&&m(h[E],h[w])<0&&(w=E),m(h[w],x)>=0)break;h[l]=h[w],l=w}h[l]=x}}function xte(d,l=1,h=!1){const m=pf.fromPoints(d[0]),_=Math.min(m.width(),m.height());let x=_/2;const w=new Ate([],wte),{minX:E,minY:B,maxX:O,maxY:N}=m;if(_===0)return new u(E,B);for(let K=E;K<O;K+=_)for(let q=B;q<N;q+=_)w.push(new Sg(K+x,q+x,x,d));let U=function(K){let q=0,Z=0,ee=0;const ue=K[0];for(let xe=0,fe=ue.length,pe=fe-1;xe<fe;pe=xe++){const Te=ue[xe],Oe=ue[pe],Ze=Te.x*Oe.y-Oe.x*Te.y;Z+=(Te.x+Oe.x)*Ze,ee+=(Te.y+Oe.y)*Ze,q+=3*Ze}return new Sg(Z/q,ee/q,0,K)}(d),G=w.length;for(;w.length;){const K=w.pop();(K.d>U.d||!U.d)&&(U=K,h&&console.log("found best %d after %d probes",Math.round(1e4*K.d)/1e4,G)),K.max-U.d<=l||(x=K.h/2,w.push(new Sg(K.p.x-x,K.p.y-x,x,d)),w.push(new Sg(K.p.x+x,K.p.y-x,x,d)),w.push(new Sg(K.p.x-x,K.p.y+x,x,d)),w.push(new Sg(K.p.x+x,K.p.y+x,x,d)),G+=4)}return h&&(console.log(`num probes: ${G}`),console.log(`best distance: ${U.d}`)),U.p}function wte(d,l){return l.max-d.max}function Sg(d,l,h,m){this.p=new u(d,l),this.h=h,this.d=function(_,x){let w=!1,E=1/0;for(let B=0;B<x.length;B++){const O=x[B];for(let N=0,U=O.length,G=U-1;N<U;G=N++){const K=O[N],q=O[G];K.y>_.y!=q.y>_.y&&_.x<(q.x-K.x)*(_.y-K.y)/(q.y-K.y)+K.x&&(w=!w),E=Math.min(E,wL(_,K,q))}}return(w?1:-1)*Math.sqrt(E)}(this.p,m),this.max=this.d+this.h*Math.SQRT2}var Os;a.aP=void 0,(Os=a.aP||(a.aP={}))[Os.center=1]="center",Os[Os.left=2]="left",Os[Os.right=3]="right",Os[Os.top=4]="top",Os[Os.bottom=5]="bottom",Os[Os["top-left"]=6]="top-left",Os[Os["top-right"]=7]="top-right",Os[Os["bottom-left"]=8]="bottom-left",Os[Os["bottom-right"]=9]="bottom-right";const ME=Number.POSITIVE_INFINITY;function vF(d,l){return l[1]!==ME?function(h,m,_){let x=0,w=0;switch(m=Math.abs(m),_=Math.abs(_),h){case"top-right":case"top-left":case"top":w=_-7;break;case"bottom-right":case"bottom-left":case"bottom":w=7-_}switch(h){case"top-right":case"bottom-right":case"right":x=-m;break;case"top-left":case"bottom-left":case"left":x=m}return[x,w]}(d,l[0],l[1]):function(h,m){let _=0,x=0;m<0&&(m=0);const w=m/Math.SQRT2;switch(h){case"top-right":case"top-left":x=w-7;break;case"bottom-right":case"bottom-left":x=7-w;break;case"bottom":x=7-m;break;case"top":x=m-7}switch(h){case"top-right":case"bottom-right":_=-w;break;case"top-left":case"bottom-left":_=w;break;case"left":_=m;break;case"right":_=-m}return[_,x]}(d,l[0])}function AF(d,l,h){var m;const _=d.layout,x=(m=_.get("text-variable-anchor-offset"))===null||m===void 0?void 0:m.evaluate(l,{},h);if(x){const E=x.values,B=[];for(let O=0;O<E.length;O+=2){const N=B[O]=E[O],U=E[O+1].map(G=>G*ls);N.startsWith("top")?U[1]-=7:N.startsWith("bottom")&&(U[1]+=7),B[O+1]=U}return new Ks(B)}const w=_.get("text-variable-anchor");if(w){let E;E=d._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[_.get("text-radial-offset").evaluate(l,{},h)*ls,ME]:_.get("text-offset").evaluate(l,{},h).map(O=>O*ls);const B=[];for(const O of w)B.push(O,vF(O,E));return new Ks(B)}return null}function RE(d){switch(d){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Cte(d,l,h,m,_,x,w,E,B,O,N,U){let G=x.textMaxSize.evaluate(l,{});G===void 0&&(G=w);const K=d.layers[0].layout,q=K.get("icon-offset").evaluate(l,{},N),Z=wF(h.horizontal),ee=w/24,ue=d.tilePixelRatio*ee,xe=d.tilePixelRatio*G/24,fe=d.tilePixelRatio*E,pe=d.tilePixelRatio*K.get("symbol-spacing"),Te=K.get("text-padding")*d.tilePixelRatio,Oe=function(Jt,ir,Xt,dr=1){const an=Jt.get("icon-padding").evaluate(ir,{},Xt),Gr=an&&an.values;return[Gr[0]*dr,Gr[1]*dr,Gr[2]*dr,Gr[3]*dr]}(K,l,N,d.tilePixelRatio),Ze=K.get("text-max-angle")/180*Math.PI,xt=K.get("text-rotation-alignment")!=="viewport"&&K.get("symbol-placement")!=="point",ht=K.get("icon-rotation-alignment")==="map"&&K.get("symbol-placement")!=="point",Ct=K.get("symbol-placement"),Vt=pe/2,Et=K.get("icon-text-fit");let bt;m&&Et!=="none"&&(d.allowVerticalPlacement&&h.vertical&&(bt=pN(m,h.vertical,Et,K.get("icon-text-fit-padding"),q,ee)),Z&&(m=pN(m,Z,Et,K.get("icon-text-fit-padding"),q,ee)));const at=N?U.line.getGranularityForZoomLevel(N.z):1,Yt=(Jt,ir)=>{ir.x<0||ir.x>=Ut||ir.y<0||ir.y>=Ut||function(Xt,dr,an,Gr,ai,Ds,zi,li,Yn,mn,_i,Ei,Wn,Mo,Ls,Ro,nl,hs,fi,Vi,vi,ds,wu,Ml,jb){const Oh=Xt.addToLineVertexArray(dr,an);let yf,Eg,Ig,Pg,EF=0,IF=0,PF=0,BF=0,zE=-1,VE=-1;const Cu={};let MF=Si("");if(Xt.allowVerticalPlacement&&Gr.vertical){const Ys=li.layout.get("text-rotate").evaluate(vi,{},Ml)+90;Ig=new I1(Yn,dr,mn,_i,Ei,Gr.vertical,Wn,Mo,Ls,Ys),zi&&(Pg=new I1(Yn,dr,mn,_i,Ei,zi,nl,hs,Ls,Ys))}if(ai){const Ys=li.layout.get("icon-rotate").evaluate(vi,{}),Ea=li.layout.get("icon-text-fit")!=="none",bf=bF(ai,Ys,wu,Ea),kl=zi?bF(zi,Ys,wu,Ea):void 0;Eg=new I1(Yn,dr,mn,_i,Ei,ai,nl,hs,!1,Ys),EF=4*bf.length;const _f=Xt.iconSizeData;let Tc=null;_f.kind==="source"?(Tc=[Au*li.layout.get("icon-size").evaluate(vi,{})],Tc[0]>Bh&&Ee(`${Xt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):_f.kind==="composite"&&(Tc=[Au*ds.compositeIconSizes[0].evaluate(vi,{},Ml),Au*ds.compositeIconSizes[1].evaluate(vi,{},Ml)],(Tc[0]>Bh||Tc[1]>Bh)&&Ee(`${Xt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Xt.addSymbols(Xt.icon,bf,Tc,Vi,fi,vi,a.az.none,dr,Oh.lineStartIndex,Oh.lineLength,-1,Ml),zE=Xt.icon.placedSymbolArray.length-1,kl&&(IF=4*kl.length,Xt.addSymbols(Xt.icon,kl,Tc,Vi,fi,vi,a.az.vertical,dr,Oh.lineStartIndex,Oh.lineLength,-1,Ml),VE=Xt.icon.placedSymbolArray.length-1)}const RF=Object.keys(Gr.horizontal);for(const Ys of RF){const Ea=Gr.horizontal[Ys];if(!yf){MF=Si(Ea.text);const kl=li.layout.get("text-rotate").evaluate(vi,{},Ml);yf=new I1(Yn,dr,mn,_i,Ei,Ea,Wn,Mo,Ls,kl)}const bf=Ea.positionedLines.length===1;if(PF+=xF(Xt,dr,Ea,Ds,li,Ls,vi,Ro,Oh,Gr.vertical?a.az.horizontal:a.az.horizontalOnly,bf?RF:[Ys],Cu,zE,ds,Ml),bf)break}Gr.vertical&&(BF+=xF(Xt,dr,Gr.vertical,Ds,li,Ls,vi,Ro,Oh,a.az.vertical,["vertical"],Cu,VE,ds,Ml));const Ete=yf?yf.boxStartIndex:Xt.collisionBoxArray.length,Ite=yf?yf.boxEndIndex:Xt.collisionBoxArray.length,Pte=Ig?Ig.boxStartIndex:Xt.collisionBoxArray.length,Bte=Ig?Ig.boxEndIndex:Xt.collisionBoxArray.length,Mte=Eg?Eg.boxStartIndex:Xt.collisionBoxArray.length,Rte=Eg?Eg.boxEndIndex:Xt.collisionBoxArray.length,kte=Pg?Pg.boxStartIndex:Xt.collisionBoxArray.length,Ote=Pg?Pg.boxEndIndex:Xt.collisionBoxArray.length;let Rl=-1;const B1=(Ys,Ea)=>Ys&&Ys.circleDiameter?Math.max(Ys.circleDiameter,Ea):Ea;Rl=B1(yf,Rl),Rl=B1(Ig,Rl),Rl=B1(Eg,Rl),Rl=B1(Pg,Rl);const kF=Rl>-1?1:0;kF&&(Rl*=jb/ls),Xt.glyphOffsetArray.length>=vg.MAX_GLYPHS&&Ee("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),vi.sortKey!==void 0&&Xt.addToSortKeyRanges(Xt.symbolInstances.length,vi.sortKey);const Dte=AF(li,vi,Ml),[Lte,Nte]=function(Ys,Ea){const bf=Ys.length,kl=Ea?.values;if(kl?.length>0)for(let _f=0;_f<kl.length;_f+=2){const Tc=kl[_f+1];Ys.emplaceBack(a.aP[kl[_f]],Tc[0],Tc[1])}return[bf,Ys.length]}(Xt.textAnchorOffsets,Dte);Xt.symbolInstances.emplaceBack(dr.x,dr.y,Cu.right>=0?Cu.right:-1,Cu.center>=0?Cu.center:-1,Cu.left>=0?Cu.left:-1,Cu.vertical||-1,zE,VE,MF,Ete,Ite,Pte,Bte,Mte,Rte,kte,Ote,mn,PF,BF,EF,IF,kF,0,Wn,Rl,Lte,Nte)}(d,ir,Jt,h,m,_,bt,d.layers[0],d.collisionBoxArray,l.index,l.sourceLayerIndex,d.index,ue,[Te,Te,Te,Te],xt,B,fe,Oe,ht,q,l,x,O,N,w)};if(Ct==="line")for(const Jt of uF(l.geometry,0,0,Ut,Ut)){const ir=ff(Jt,at),Xt=vte(ir,pe,Ze,h.vertical||Z,m,24,xe,d.overscaling,Ut);for(const dr of Xt)Z&&Tte(d,Z.text,Vt,dr)||Yt(ir,dr)}else if(Ct==="line-center"){for(const Jt of l.geometry)if(Jt.length>1){const ir=ff(Jt,at),Xt=_te(ir,Ze,h.vertical||Z,m,24,xe);Xt&&Yt(ir,Xt)}}else if(l.type==="Polygon")for(const Jt of Op(l.geometry,0)){const ir=xte(Jt,16);Yt(ff(Jt[0],at,!0),new kh(ir.x,ir.y,0))}else if(l.type==="LineString")for(const Jt of l.geometry){const ir=ff(Jt,at);Yt(ir,new kh(ir[0].x,ir[0].y,0))}else if(l.type==="Point")for(const Jt of l.geometry)for(const ir of Jt)Yt([ir],new kh(ir.x,ir.y,0))}function xF(d,l,h,m,_,x,w,E,B,O,N,U,G,K,q){const Z=function(xe,fe,pe,Te,Oe,Ze,xt,ht){const Ct=Te.layout.get("text-rotate").evaluate(Ze,{})*Math.PI/180,Vt=[];for(const Et of fe.positionedLines)for(const bt of Et.positionedGlyphs){if(!bt.rect)continue;const at=bt.rect||{};let Yt=4,Jt=!0,ir=1,Xt=0;const dr=(Oe||ht)&&bt.vertical,an=bt.metrics.advance*bt.scale/2;if(ht&&fe.verticalizable&&(Xt=Et.lineOffset/2-(bt.imageName?-(ls-bt.metrics.width*bt.scale)/2:(bt.scale-1)*ls)),bt.imageName){const hs=xt[bt.imageName];Jt=hs.sdf,ir=hs.pixelRatio,Yt=1/ir}const Gr=Oe?[bt.x+an,bt.y]:[0,0];let ai=Oe?[0,0]:[bt.x+an+pe[0],bt.y+pe[1]-Xt],Ds=[0,0];dr&&(Ds=ai,ai=[0,0]);const zi=bt.metrics.isDoubleResolution?2:1,li=(bt.metrics.left-Yt)*bt.scale-an+ai[0],Yn=(-bt.metrics.top-Yt)*bt.scale+ai[1],mn=li+at.w/zi*bt.scale/ir,_i=Yn+at.h/zi*bt.scale/ir,Ei=new u(li,Yn),Wn=new u(mn,Yn),Mo=new u(li,_i),Ls=new u(mn,_i);if(dr){const hs=new u(-an,an- -17),fi=-Math.PI/2,Vi=12-an,vi=new u(22-Vi,-(bt.imageName?Vi:0)),ds=new u(...Ds);Ei._rotateAround(fi,hs)._add(vi)._add(ds),Wn._rotateAround(fi,hs)._add(vi)._add(ds),Mo._rotateAround(fi,hs)._add(vi)._add(ds),Ls._rotateAround(fi,hs)._add(vi)._add(ds)}if(Ct){const hs=Math.sin(Ct),fi=Math.cos(Ct),Vi=[fi,-hs,hs,fi];Ei._matMult(Vi),Wn._matMult(Vi),Mo._matMult(Vi),Ls._matMult(Vi)}const Ro=new u(0,0),nl=new u(0,0);Vt.push({tl:Ei,tr:Wn,bl:Mo,br:Ls,tex:at,writingMode:fe.writingMode,glyphOffset:Gr,sectionIndex:bt.sectionIndex,isSDF:Jt,pixelOffsetTL:Ro,pixelOffsetBR:nl,minFontScaleX:0,minFontScaleY:0})}return Vt}(0,h,E,_,x,w,m,d.allowVerticalPlacement),ee=d.textSizeData;let ue=null;ee.kind==="source"?(ue=[Au*_.layout.get("text-size").evaluate(w,{})],ue[0]>Bh&&Ee(`${d.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ee.kind==="composite"&&(ue=[Au*K.compositeTextSizes[0].evaluate(w,{},q),Au*K.compositeTextSizes[1].evaluate(w,{},q)],(ue[0]>Bh||ue[1]>Bh)&&Ee(`${d.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),d.addSymbols(d.text,Z,ue,E,x,w,O,l,B.lineStartIndex,B.lineLength,G,q);for(const xe of N)U[xe]=d.text.placedSymbolArray.length-1;return 4*Z.length}function wF(d){for(const l in d)return d[l];return null}function Tte(d,l,h,m){const _=d.compareText;if(l in _){const x=_[l];for(let w=x.length-1;w>=0;w--)if(m.dist(x[w])<h)return!0}else _[l]=[];return _[l].push(m),!1}const CF=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class kE{static from(l){if(!(l instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[h,m]=new Uint8Array(l,0,2);if(h!==219)throw new Error("Data does not appear to be in a KDBush format.");const _=m>>4;if(_!==1)throw new Error(`Got v${_} data when expected v1.`);const x=CF[15&m];if(!x)throw new Error("Unrecognized array type.");const[w]=new Uint16Array(l,2,1),[E]=new Uint32Array(l,4,1);return new kE(E,w,x,l)}constructor(l,h=64,m=Float64Array,_){if(isNaN(l)||l<0)throw new Error(`Unpexpected numItems value: ${l}.`);this.numItems=+l,this.nodeSize=Math.min(Math.max(+h,2),65535),this.ArrayType=m,this.IndexArrayType=l<65536?Uint16Array:Uint32Array;const x=CF.indexOf(this.ArrayType),w=2*l*this.ArrayType.BYTES_PER_ELEMENT,E=l*this.IndexArrayType.BYTES_PER_ELEMENT,B=(8-E%8)%8;if(x<0)throw new Error(`Unexpected typed array class: ${m}.`);_&&_ instanceof ArrayBuffer?(this.data=_,this.ids=new this.IndexArrayType(this.data,8,l),this.coords=new this.ArrayType(this.data,8+E+B,2*l),this._pos=2*l,this._finished=!0):(this.data=new ArrayBuffer(8+w+E+B),this.ids=new this.IndexArrayType(this.data,8,l),this.coords=new this.ArrayType(this.data,8+E+B,2*l),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+x]),new Uint16Array(this.data,2,1)[0]=h,new Uint32Array(this.data,4,1)[0]=l)}add(l,h){const m=this._pos>>1;return this.ids[m]=m,this.coords[this._pos++]=l,this.coords[this._pos++]=h,m}finish(){const l=this._pos>>1;if(l!==this.numItems)throw new Error(`Added ${l} items when expected ${this.numItems}.`);return OE(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(l,h,m,_){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:w,nodeSize:E}=this,B=[0,x.length-1,0],O=[];for(;B.length;){const N=B.pop()||0,U=B.pop()||0,G=B.pop()||0;if(U-G<=E){for(let ee=G;ee<=U;ee++){const ue=w[2*ee],xe=w[2*ee+1];ue>=l&&ue<=m&&xe>=h&&xe<=_&&O.push(x[ee])}continue}const K=G+U>>1,q=w[2*K],Z=w[2*K+1];q>=l&&q<=m&&Z>=h&&Z<=_&&O.push(x[K]),(N===0?l<=q:h<=Z)&&(B.push(G),B.push(K-1),B.push(1-N)),(N===0?m>=q:_>=Z)&&(B.push(K+1),B.push(U),B.push(1-N))}return O}within(l,h,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:x,nodeSize:w}=this,E=[0,_.length-1,0],B=[],O=m*m;for(;E.length;){const N=E.pop()||0,U=E.pop()||0,G=E.pop()||0;if(U-G<=w){for(let ee=G;ee<=U;ee++)SF(x[2*ee],x[2*ee+1],l,h)<=O&&B.push(_[ee]);continue}const K=G+U>>1,q=x[2*K],Z=x[2*K+1];SF(q,Z,l,h)<=O&&B.push(_[K]),(N===0?l-m<=q:h-m<=Z)&&(E.push(G),E.push(K-1),E.push(1-N)),(N===0?l+m>=q:h+m>=Z)&&(E.push(K+1),E.push(U),E.push(1-N))}return B}}function OE(d,l,h,m,_,x){if(_-m<=h)return;const w=m+_>>1;TF(d,l,w,m,_,x),OE(d,l,h,m,w-1,1-x),OE(d,l,h,w+1,_,1-x)}function TF(d,l,h,m,_,x){for(;_>m;){if(_-m>600){const O=_-m+1,N=h-m+1,U=Math.log(O),G=.5*Math.exp(2*U/3),K=.5*Math.sqrt(U*G*(O-G)/O)*(N-O/2<0?-1:1);TF(d,l,h,Math.max(m,Math.floor(h-N*G/O+K)),Math.min(_,Math.floor(h+(O-N)*G/O+K)),x)}const w=l[2*h+x];let E=m,B=_;for(Vb(d,l,m,h),l[2*_+x]>w&&Vb(d,l,m,_);E<B;){for(Vb(d,l,E,B),E++,B--;l[2*E+x]<w;)E++;for(;l[2*B+x]>w;)B--}l[2*m+x]===w?Vb(d,l,m,B):(B++,Vb(d,l,B,_)),B<=h&&(m=B+1),h<=B&&(_=B-1)}}function Vb(d,l,h,m){DE(d,h,m),DE(l,2*h,2*m),DE(l,2*h+1,2*m+1)}function DE(d,l,h){const m=d[l];d[l]=d[h],d[h]=m}function SF(d,l,h,m){const _=d-h,x=l-m;return _*_+x*x}var LE;a.cH=void 0,(LE=a.cH||(a.cH={})).create="create",LE.load="load",LE.fullLoad="fullLoad";let P1=null,$b=[];const NE=1e3/60,FE="loadTime",UE="fullLoadTime",Ste={mark(d){performance.mark(d)},frame(d){const l=d;P1!=null&&$b.push(l-P1),P1=l},clearMetrics(){P1=null,$b=[],performance.clearMeasures(FE),performance.clearMeasures(UE);for(const d in a.cH)performance.clearMarks(a.cH[d])},getPerformanceMetrics(){performance.measure(FE,a.cH.create,a.cH.load),performance.measure(UE,a.cH.create,a.cH.fullLoad);const d=performance.getEntriesByName(FE)[0].duration,l=performance.getEntriesByName(UE)[0].duration,h=$b.length,m=1/($b.reduce((x,w)=>x+w,0)/h/1e3),_=$b.filter(x=>x>NE).reduce((x,w)=>x+(w-NE)/NE,0);return{loadTime:d,fullLoadTime:l,fps:m,percentDroppedFrames:_/(h+_)*100,totalFrames:h}}};a.$=D,a.A=z,a.B=Ch,a.C=os,a.D=hr,a.E=ln,a.F=function([d,l,h]){return l+=90,l*=Math.PI/180,h*=Math.PI/180,{x:d*Math.cos(l)*Math.sin(h),y:d*Math.sin(l)*Math.sin(h),z:d*Math.cos(h)}},a.G=ii,a.H=kn,a.I=sE,a.J=KA,a.K=function(d){if(Qe==null){const l=d.navigator?d.navigator.userAgent:null;Qe=!!d.safari||!(!l||!(/\b(iPad|iPhone|iPod)\b/.test(l)||l.match("Safari")&&!l.match("Chrome")))}return Qe},a.L=class{constructor(d,l){this.target=d,this.mapId=l,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Vee(()=>this.process()),this.subscription=mr(this.target,"message",h=>this.receive(h),!1),this.globalScope=wt(self)?d:window}registerMessageHandler(d,l){this.messageHandlers[d]=l}unregisterMessageHandler(d){delete this.messageHandlers[d]}sendAsync(d,l){return new Promise((h,m)=>{const _=Math.round(1e18*Math.random()).toString(36).substring(0,10),x=l?mr(l.signal,"abort",()=>{x?.unsubscribe(),delete this.resolveRejects[_];const B={id:_,type:"<cancel>",origin:location.origin,targetMapId:d.targetMapId,sourceMapId:this.mapId};this.target.postMessage(B)},$ee):null;this.resolveRejects[_]={resolve:B=>{x?.unsubscribe(),h(B)},reject:B=>{x?.unsubscribe(),m(B)}};const w=[],E=Object.assign(Object.assign({},d),{id:_,sourceMapId:this.mapId,origin:location.origin,data:Zd(d.data,w)});this.target.postMessage(E,{transfer:w})})}receive(d){const l=d.data,h=l.id;if(!(l.origin!=="file://"&&location.origin!=="file://"&&l.origin!=="resource://android"&&location.origin!=="resource://android"&&l.origin!==location.origin||l.targetMapId&&this.mapId!==l.targetMapId)){if(l.type==="<cancel>"){delete this.tasks[h];const m=this.abortControllers[h];return delete this.abortControllers[h],void(m&&m.abort())}if(wt(self)||l.mustQueue)return this.tasks[h]=l,this.taskQueue.push(h),void this.invoker.trigger();this.processTask(h,l)}}process(){if(this.taskQueue.length===0)return;const d=this.taskQueue.shift(),l=this.tasks[d];delete this.tasks[d],this.taskQueue.length>0&&this.invoker.trigger(),l&&this.processTask(d,l)}processTask(d,l){return o(this,void 0,void 0,function*(){if(l.type==="<response>"){const _=this.resolveRejects[d];return delete this.resolveRejects[d],_?void(l.error?_.reject(Qd(l.error)):_.resolve(Qd(l.data))):void 0}if(!this.messageHandlers[l.type])return void this.completeTask(d,new Error(`Could not find a registered handler for ${l.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const h=Qd(l.data),m=new AbortController;this.abortControllers[d]=m;try{const _=yield this.messageHandlers[l.type](l.sourceMapId,h,m);this.completeTask(d,null,_)}catch(_){this.completeTask(d,_)}})}completeTask(d,l,h){const m=[];delete this.abortControllers[d];const _={id:d,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:l?Zd(l):null,data:Zd(h,m)};this.target.postMessage(_,{transfer:m})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},a.M=Ge,a.N=function(){var d=new z(16);return z!=Float32Array&&(d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[11]=0,d[12]=0,d[13]=0,d[14]=0),d[0]=1,d[5]=1,d[10]=1,d[15]=1,d},a.O=function(d,l,h){var m,_,x,w,E,B,O,N,U,G,K,q,Z=h[0],ee=h[1],ue=h[2];return l===d?(d[12]=l[0]*Z+l[4]*ee+l[8]*ue+l[12],d[13]=l[1]*Z+l[5]*ee+l[9]*ue+l[13],d[14]=l[2]*Z+l[6]*ee+l[10]*ue+l[14],d[15]=l[3]*Z+l[7]*ee+l[11]*ue+l[15]):(_=l[1],x=l[2],w=l[3],E=l[4],B=l[5],O=l[6],N=l[7],U=l[8],G=l[9],K=l[10],q=l[11],d[0]=m=l[0],d[1]=_,d[2]=x,d[3]=w,d[4]=E,d[5]=B,d[6]=O,d[7]=N,d[8]=U,d[9]=G,d[10]=K,d[11]=q,d[12]=m*Z+E*ee+U*ue+l[12],d[13]=_*Z+B*ee+G*ue+l[13],d[14]=x*Z+O*ee+K*ue+l[14],d[15]=w*Z+N*ee+q*ue+l[15]),d},a.P=u,a.Q=function(d,l,h){var m=h[0],_=h[1],x=h[2];return d[0]=l[0]*m,d[1]=l[1]*m,d[2]=l[2]*m,d[3]=l[3]*m,d[4]=l[4]*_,d[5]=l[5]*_,d[6]=l[6]*_,d[7]=l[7]*_,d[8]=l[8]*x,d[9]=l[9]*x,d[10]=l[10]*x,d[11]=l[11]*x,d[12]=l[12],d[13]=l[13],d[14]=l[14],d[15]=l[15],d},a.R=Bo,a.S=function(d,l,h){var m=l[0],_=l[1],x=l[2],w=l[3],E=l[4],B=l[5],O=l[6],N=l[7],U=l[8],G=l[9],K=l[10],q=l[11],Z=l[12],ee=l[13],ue=l[14],xe=l[15],fe=h[0],pe=h[1],Te=h[2],Oe=h[3];return d[0]=fe*m+pe*E+Te*U+Oe*Z,d[1]=fe*_+pe*B+Te*G+Oe*ee,d[2]=fe*x+pe*O+Te*K+Oe*ue,d[3]=fe*w+pe*N+Te*q+Oe*xe,d[4]=(fe=h[4])*m+(pe=h[5])*E+(Te=h[6])*U+(Oe=h[7])*Z,d[5]=fe*_+pe*B+Te*G+Oe*ee,d[6]=fe*x+pe*O+Te*K+Oe*ue,d[7]=fe*w+pe*N+Te*q+Oe*xe,d[8]=(fe=h[8])*m+(pe=h[9])*E+(Te=h[10])*U+(Oe=h[11])*Z,d[9]=fe*_+pe*B+Te*G+Oe*ee,d[10]=fe*x+pe*O+Te*K+Oe*ue,d[11]=fe*w+pe*N+Te*q+Oe*xe,d[12]=(fe=h[12])*m+(pe=h[13])*E+(Te=h[14])*U+(Oe=h[15])*Z,d[13]=fe*_+pe*B+Te*G+Oe*ee,d[14]=fe*x+pe*O+Te*K+Oe*ue,d[15]=fe*w+pe*N+Te*q+Oe*xe,d},a.T=q2,a.U=function(d,l){const h={};for(let m=0;m<l.length;m++){const _=l[m];_ in d&&(h[_]=d[_])}return h},a.V=Mh,a.W=Jn,a.X=wN,a.Y=xN,a.Z=Be,a._=o,a.a=he,a.a$=ce,a.a0=V,a.a1=Dt,a.a2=Ta,a.a3=TN,a.a4=y1,a.a5=Ut,a.a6=function(d,l,h){if(!d)return l||{};if(!l)return d||{};const m=PN(d),_=PN(l);(function(w,E){E.removeAll&&(w.add.clear(),w.update.clear(),w.remove.clear(),E.remove.clear());for(const B of E.remove)w.add.delete(B),w.update.delete(B);for(const[B,O]of E.update){const N=w.update.get(B);N&&(E.update.set(B,jee(N,O)),w.update.delete(B))}})(m,_);const x={};if((m.removeAll||_.removeAll)&&(x.removeAll=!0),x.remove=new Set([...m.remove,..._.remove]),x.add=new Map([...m.add,..._.add]),x.update=new Map([...m.update,..._.update]),x.remove.size&&x.add.size)for(const w of x.add.keys())x.remove.delete(w);return function(w){const E={};return w.removeAll&&(E.removeAll=w.removeAll),w.remove&&(E.remove=Array.from(w.remove)),w.add&&(E.add=Array.from(w.add.values())),w.update&&(E.update=Array.from(w.update.values())),E}(x)},a.a7=function(d,l){const h=new Map;if(d==null||d.type==null)return h;if(d.type==="Feature"){const m=pE(d,l);return m==null?void 0:(h.set(m,d),h)}if(d.type==="FeatureCollection"){const m=new Set;for(const _ of d.features){const x=pE(_,l);if(x==null||m.has(x))return;m.add(x),h.set(x,_)}return h}},a.a8=function(d,l,h){var m,_;const x=[];if(l.removeAll)d.clear();else if(l.remove)for(const w of l.remove){const E=d.get(w);E&&(x.push(E.geometry),d.delete(w))}if(l.add)for(const w of l.add){const E=pE(w,h);if(E==null)continue;const B=d.get(E);B&&x.push(B.geometry),x.push(w.geometry),d.set(E,w)}if(l.update)for(const w of l.update){const E=d.get(w.id);if(!E)continue;const B=!!w.newGeometry,O=w.removeAllProperties||((m=w.removeProperties)===null||m===void 0?void 0:m.length)>0||((_=w.addOrUpdateProperties)===null||_===void 0?void 0:_.length)>0;if(!B&&!O)continue;x.push(E.geometry);const N=Object.assign({},E);if(d.set(w.id,N),B&&(x.push(w.newGeometry),N.geometry=w.newGeometry),O){if(N.properties=w.removeAllProperties?{}:Object.assign({},N.properties||{}),w.removeProperties)for(const U of w.removeProperties)delete N.properties[U];if(w.addOrUpdateProperties)for(const{key:U,value:G}of w.addOrUpdateProperties)N.properties[U]=G}}return x},a.a9=Nb,a.aA=function(d,{uSize:l,uSizeT:h},{lowerSize:m,upperSize:_}){return d.kind==="source"?m/Au:d.kind==="composite"?ii.number(m/Au,_/Au,h):l},a.aB=function(d,l){var h=l[0],m=l[1],_=l[2],x=l[3],w=l[4],E=l[5],B=l[6],O=l[7],N=l[8],U=l[9],G=l[10],K=l[11],q=l[12],Z=l[13],ee=l[14],ue=l[15],xe=h*E-m*w,fe=h*B-_*w,pe=h*O-x*w,Te=m*B-_*E,Oe=m*O-x*E,Ze=_*O-x*B,xt=N*Z-U*q,ht=N*ee-G*q,Ct=N*ue-K*q,Vt=U*ee-G*Z,Et=U*ue-K*Z,bt=G*ue-K*ee,at=xe*bt-fe*Et+pe*Vt+Te*Ct-Oe*ht+Ze*xt;return at?(d[0]=(E*bt-B*Et+O*Vt)*(at=1/at),d[1]=(_*Et-m*bt-x*Vt)*at,d[2]=(Z*Ze-ee*Oe+ue*Te)*at,d[3]=(G*Oe-U*Ze-K*Te)*at,d[4]=(B*Ct-w*bt-O*ht)*at,d[5]=(h*bt-_*Ct+x*ht)*at,d[6]=(ee*pe-q*Ze-ue*fe)*at,d[7]=(N*Ze-G*pe+K*fe)*at,d[8]=(w*Et-E*Ct+O*xt)*at,d[9]=(m*Ct-h*Et-x*xt)*at,d[10]=(q*Oe-Z*pe+ue*xe)*at,d[11]=(U*pe-N*Oe-K*xe)*at,d[12]=(E*ht-w*Vt-B*xt)*at,d[13]=(h*Vt-m*ht+_*xt)*at,d[14]=(Z*fe-q*Te-ee*xe)*at,d[15]=(N*Te-U*fe+G*xe)*at,d):null},a.aC=At,a.aD=function(d){var l=d[0],h=d[1];return Math.sqrt(l*l+h*h)},a.aE=function(d){return d[0]=0,d[1]=0,d},a.aF=function(d,l,h){return d[0]=l[0]*h,d[1]=l[1]*h,d},a.aG=lE,a.aH=Ve,a.aI=function(d,l,h,m){const _=l.y-d.y,x=l.x-d.x,w=m.y-h.y,E=m.x-h.x,B=w*x-E*_;if(B===0)return null;const O=(E*(d.y-h.y)-w*(d.x-h.x))/B;return new u(d.x+O*x,d.y+O*_)},a.aJ=uF,a.aK=dg,a.aL=function(d){let l=1/0,h=1/0,m=-1/0,_=-1/0;for(const x of d)l=Math.min(l,x.x),h=Math.min(h,x.y),m=Math.max(m,x.x),_=Math.max(_,x.y);return[l,h,m,_]},a.aM=ls,a.aN=xr,a.aO=function(d,l,h,m,_=!1){if(!h[0]&&!h[1])return[0,0];const x=_?m==="map"?-d.bearingInRadians:0:m==="viewport"?d.bearingInRadians:0;if(x){const w=Math.sin(x),E=Math.cos(x);h=[h[0]*E-h[1]*w,h[0]*w+h[1]*E]}return[_?h[0]:xr(l,h[0],d.zoom),_?h[1]:xr(l,h[1],d.zoom)]},a.aQ=aE,a.aR=RE,a.aS=oE,a.aT=kE,a.aU=Ti,a.aV=h1,a.aW=ge,a.aX=Ht,a.aY=st,a.aZ=cr,a.a_=SN,a.aa=pf,a.ab=25,a.ac=fE,a.ad=d=>{const l=window.document.createElement("video");return l.muted=!0,new Promise(h=>{l.onloadstart=()=>{h(l)};for(const m of d){const _=window.document.createElement("source");pt(m)||(l.crossOrigin="Anonymous"),_.src=m,l.appendChild(_)}})},a.ae=Rt,a.af=function(){return _t++},a.ag=v,a.ah=vg,a.ai=zb,a.aj=jd,a.ak=Cc,a.al=MN,a.am=function(d){const l={};if(d.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(h,m,_,x)=>{const w=_||x;return l[m]=!w||w.toLowerCase(),""}),l["max-age"]){const h=parseInt(l["max-age"],10);isNaN(h)?delete l["max-age"]:l["max-age"]=h}return l},a.an=Bn,a.ao=85.051129,a.ap=Qt,a.aq=function(d){return Math.pow(2,d)},a.ar=te,a.as=CN,a.at=function(d){return Math.log(d)/Math.LN2},a.au=function(d){var l=d[0],h=d[1];return l*l+h*h},a.av=function(d){if(!d.length)return new Set;const l=Math.max(...d.map(B=>B.canonical.z));let h=1/0,m=-1/0,_=1/0,x=-1/0;const w=[];for(const B of d){const{x:O,y:N,z:U}=B.canonical,G=Math.pow(2,l-U),K=O*G,q=N*G;w.push({id:B,x:K,y:q}),K<h&&(h=K),K>m&&(m=K),q<_&&(_=q),q>x&&(x=q)}const E=new Set;for(const B of w)B.x!==h&&B.x!==m&&B.y!==_&&B.y!==x||E.add(B.id);return E},a.aw=function(d,l){const h=Math.abs(2*d.wrap)-+(d.wrap<0),m=Math.abs(2*l.wrap)-+(l.wrap<0);return d.overscaledZ-l.overscaledZ||m-h||l.canonical.y-d.canonical.y||l.canonical.x-d.canonical.x},a.ax=class{constructor(d,l){this.max=d,this.onRemove=l,this.reset()}reset(){for(const d in this.data)for(const l of this.data[d])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(d,l,h){const m=d.wrapped().key;this.data[m]===void 0&&(this.data[m]=[]);const _={value:l,timeout:void 0};if(h!==void 0&&(_.timeout=setTimeout(()=>{this.remove(d,_)},h)),this.data[m].push(_),this.order.push(m),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(d){return d.wrapped().key in this.data}getAndRemove(d){return this.has(d)?this._getAndRemoveByKey(d.wrapped().key):null}_getAndRemoveByKey(d){const l=this.data[d].shift();return l.timeout&&clearTimeout(l.timeout),this.data[d].length===0&&delete this.data[d],this.order.splice(this.order.indexOf(d),1),l.value}getByKey(d){const l=this.data[d];return l?l[0].value:null}get(d){return this.has(d)?this.data[d.wrapped().key][0].value:null}remove(d,l){if(!this.has(d))return this;const h=d.wrapped().key,m=l===void 0?0:this.data[h].indexOf(l),_=this.data[h][m];return this.data[h].splice(m,1),_.timeout&&clearTimeout(_.timeout),this.data[h].length===0&&delete this.data[h],this.onRemove(_.value),this.order.splice(this.order.indexOf(h),1),this}setMaxSize(d){for(this.max=d;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(d){const l=[];for(const h in this.data)for(const m of this.data[h])d(m.value)||l.push(m);for(const h of l)this.remove(h.value.tileID,h)}},a.ay=function(d,l){let h=0,m=0;if(d.kind==="constant")m=d.layoutSize;else if(d.kind!=="source"){const{interpolationType:_,minZoom:x,maxZoom:w}=d,E=_?Bn(Js.interpolationFactor(_,l,x,w),0,1):0;d.kind==="camera"?m=ii.number(d.minSize,d.maxSize,E):h=E}return{uSizeT:h,uSize:m}},a.b=mt,a.b$=_u,a.b0=Y,a.b1=function(d){var l=new z(3);return l[0]=d[0],l[1]=d[1],l[2]=d[2],l},a.b2=function(d,l,h){return d[0]=l[0]-h[0],d[1]=l[1]-h[1],d[2]=l[2]-h[2],d},a.b3=function(d,l){var h=l[0],m=l[1],_=l[2],x=h*h+m*m+_*_;return x>0&&(x=1/Math.sqrt(x)),d[0]=l[0]*x,d[1]=l[1]*x,d[2]=l[2]*x,d},a.b4=oe,a.b5=function(d,l){return d[0]*l[0]+d[1]*l[1]+d[2]*l[2]},a.b6=function(d,l,h){return d[0]=l[0]*h[0],d[1]=l[1]*h[1],d[2]=l[2]*h[2],d[3]=l[3]*h[3],d},a.b7=_e,a.b8=function(d,l,h){const m=l[0]*h[0]+l[1]*h[1]+l[2]*h[2];return m===0?null:(-(d[0]*h[0]+d[1]*h[1]+d[2]*h[2])-h[3])/m},a.b9=ze,a.bA=function(d,l,h,m){return d[0]=l[0]+h[0]*m,d[1]=l[1]+h[1]*m,d[2]=l[2]+h[2]*m,d},a.bB=gt,a.bC=function(d,l,h){var m=h[0],_=h[1],x=h[2],w=h[3],E=l[0],B=l[1],O=l[2],N=_*O-x*B,U=x*E-m*O,G=m*B-_*E;return d[0]=E+w*(N+=N)+_*(G+=G)-x*(U+=U),d[1]=B+w*U+x*N-m*G,d[2]=O+w*G+m*U-_*N,d},a.bD=function(d,l,h){const m=function(B){var O=B[3],N=B[4],U=B[5],G=B[6],K=B[7],q=B[8];return B[0]*(q*N-U*K)+B[1]*(-q*O+U*G)+B[2]*(K*O-N*G)}([d[0],d[1],d[2],l[0],l[1],l[2],h[0],h[1],h[2]]);if(m===0)return null;const _=oe([],[l[0],l[1],l[2]],[h[0],h[1],h[2]]),x=oe([],[h[0],h[1],h[2]],[d[0],d[1],d[2]]),w=oe([],[d[0],d[1],d[2]],[l[0],l[1],l[2]]),E=ce([],_,-d[3]);return Y(E,E,ce([],x,-l[3])),Y(E,E,ce([],w,-h[3])),ce(E,E,1/m),E},a.bE=dE,a.bF=function(){return new Float64Array(4)},a.bG=function(d,l,h,m){var _=[],x=[];return _[0]=l[0]-h[0],_[1]=l[1]-h[1],_[2]=l[2]-h[2],x[0]=_[0]*Math.cos(m)-_[1]*Math.sin(m),x[1]=_[0]*Math.sin(m)+_[1]*Math.cos(m),x[2]=_[2],d[0]=x[0]+h[0],d[1]=x[1]+h[1],d[2]=x[2]+h[2],d},a.bH=function(d,l,h,m){var _=[],x=[];return _[0]=l[0]-h[0],_[1]=l[1]-h[1],_[2]=l[2]-h[2],x[0]=_[0],x[1]=_[1]*Math.cos(m)-_[2]*Math.sin(m),x[2]=_[1]*Math.sin(m)+_[2]*Math.cos(m),d[0]=x[0]+h[0],d[1]=x[1]+h[1],d[2]=x[2]+h[2],d},a.bI=function(d,l,h,m){var _=[],x=[];return _[0]=l[0]-h[0],_[1]=l[1]-h[1],_[2]=l[2]-h[2],x[0]=_[2]*Math.sin(m)+_[0]*Math.cos(m),x[1]=_[1],x[2]=_[2]*Math.cos(m)-_[0]*Math.sin(m),d[0]=x[0]+h[0],d[1]=x[1]+h[1],d[2]=x[2]+h[2],d},a.bJ=function(d,l,h){var m=Math.sin(h),_=Math.cos(h),x=l[0],w=l[1],E=l[2],B=l[3],O=l[8],N=l[9],U=l[10],G=l[11];return l!==d&&(d[4]=l[4],d[5]=l[5],d[6]=l[6],d[7]=l[7],d[12]=l[12],d[13]=l[13],d[14]=l[14],d[15]=l[15]),d[0]=x*_-O*m,d[1]=w*_-N*m,d[2]=E*_-U*m,d[3]=B*_-G*m,d[8]=x*m+O*_,d[9]=w*m+N*_,d[10]=E*m+U*_,d[11]=B*m+G*_,d},a.bK=function(d,l){const h=Er(d,360),m=Er(l,360),_=m-h,x=m>h?_-360:_+360;return Math.abs(_)<Math.abs(x)?_:x},a.bL=function(d){return d[0]=0,d[1]=0,d[2]=0,d},a.bM=function(d,l,h,m){const _=Math.sqrt(d*d+l*l),x=Math.sqrt(h*h+m*m);d/=_,l/=_,h/=x,m/=x;const w=Math.acos(d*h+l*m);return-l*h+d*m>0?w:-w},a.bN=function(d,l){const h=Er(d,2*Math.PI),m=Er(l,2*Math.PI);return Math.min(Math.abs(h-m),Math.abs(h-m+2*Math.PI),Math.abs(h-m-2*Math.PI))},a.bO=function(){const d={},l=et.$version;for(const h in et.$root){const m=et.$root[h];if(m.required){let _=null;_=h==="version"?l:m.type==="array"?[]:{},_!=null&&(d[h]=_)}}return d},a.bP=nt,a.bQ=ub,a.bR=function d(l,h){if(Array.isArray(l)){if(!Array.isArray(h)||l.length!==h.length)return!1;for(let m=0;m<l.length;m++)if(!d(l[m],h[m]))return!1;return!0}if(typeof l=="object"&&l!==null&&h!==null){if(typeof h!="object"||Object.keys(l).length!==Object.keys(h).length)return!1;for(const m in l)if(!d(l[m],h[m]))return!1;return!0}return l===h},a.bS=function(d){d=d.slice();const l=Object.create(null);for(let h=0;h<d.length;h++)l[d[h].id]=d[h];for(let h=0;h<d.length;h++)"ref"in d[h]&&(d[h]=Xi(d[h],l[d[h].ref]));return d},a.bT=function(d,l){if(d.type==="custom")return new zee(d,l);switch(d.type){case"background":return new Uee(d,l);case"circle":return new wQ(d,l);case"color-relief":return new PQ(d,l);case"fill":return new GQ(d,l);case"fill-extrusion":return new ree(d,l);case"heatmap":return new TQ(d,l);case"hillshade":return new EQ(d,l);case"line":return new cee(d,l);case"raster":return new V2(d,l);case"symbol":return new m1(d,l)}},a.bU=d=>d.type==="raster",a.bV=fr,a.bW=function(d,l){if(!d)return[{command:"setStyle",args:[l]}];let h=[];try{if(!Ir(d.version,l.version))return[{command:"setStyle",args:[l]}];Ir(d.center,l.center)||h.push({command:"setCenter",args:[l.center]}),Ir(d.state,l.state)||h.push({command:"setGlobalState",args:[l.state]}),Ir(d.centerAltitude,l.centerAltitude)||h.push({command:"setCenterAltitude",args:[l.centerAltitude]}),Ir(d.zoom,l.zoom)||h.push({command:"setZoom",args:[l.zoom]}),Ir(d.bearing,l.bearing)||h.push({command:"setBearing",args:[l.bearing]}),Ir(d.pitch,l.pitch)||h.push({command:"setPitch",args:[l.pitch]}),Ir(d.roll,l.roll)||h.push({command:"setRoll",args:[l.roll]}),Ir(d.sprite,l.sprite)||h.push({command:"setSprite",args:[l.sprite]}),Ir(d.glyphs,l.glyphs)||h.push({command:"setGlyphs",args:[l.glyphs]}),Ir(d.transition,l.transition)||h.push({command:"setTransition",args:[l.transition]}),Ir(d.light,l.light)||h.push({command:"setLight",args:[l.light]}),Ir(d.terrain,l.terrain)||h.push({command:"setTerrain",args:[l.terrain]}),Ir(d.sky,l.sky)||h.push({command:"setSky",args:[l.sky]}),Ir(d.projection,l.projection)||h.push({command:"setProjection",args:[l.projection]});const m={},_=[];(function(w,E,B,O){let N;for(N in E=E||{},w=w||{})Object.prototype.hasOwnProperty.call(w,N)&&(Object.prototype.hasOwnProperty.call(E,N)||Rn(N,B,O));for(N in E)Object.prototype.hasOwnProperty.call(E,N)&&(Object.prototype.hasOwnProperty.call(w,N)?Ir(w[N],E[N])||(w[N].type==="geojson"&&E[N].type==="geojson"&&yn(w,E,N)?qr(B,{command:"setGeoJSONSourceData",args:[N,E[N].data]}):nn(N,E,B,O)):Ji(N,E,B))})(d.sources,l.sources,_,m);const x=[];d.layers&&d.layers.forEach(w=>{"source"in w&&m[w.source]?h.push({command:"removeLayer",args:[w.id]}):x.push(w)}),h=h.concat(_),function(w,E,B){E=E||[];const O=(w=w||[]).map(xl),N=E.map(xl),U=w.reduce(oc,{}),G=E.reduce(oc,{}),K=O.slice(),q=Object.create(null);let Z,ee,ue,xe,fe;for(let pe=0,Te=0;pe<O.length;pe++)Z=O[pe],Object.prototype.hasOwnProperty.call(G,Z)?Te++:(qr(B,{command:"removeLayer",args:[Z]}),K.splice(K.indexOf(Z,Te),1));for(let pe=0,Te=0;pe<N.length;pe++)Z=N[N.length-1-pe],K[K.length-1-pe]!==Z&&(Object.prototype.hasOwnProperty.call(U,Z)?(qr(B,{command:"removeLayer",args:[Z]}),K.splice(K.lastIndexOf(Z,K.length-Te),1)):Te++,xe=K[K.length-pe],qr(B,{command:"addLayer",args:[G[Z],xe]}),K.splice(K.length-pe,0,Z),q[Z]=!0);for(let pe=0;pe<N.length;pe++)if(Z=N[pe],ee=U[Z],ue=G[Z],!q[Z]&&!Ir(ee,ue))if(Ir(ee.source,ue.source)&&Ir(ee["source-layer"],ue["source-layer"])&&Ir(ee.type,ue.type)){for(fe in ni(ee.layout,ue.layout,B,Z,null,"setLayoutProperty"),ni(ee.paint,ue.paint,B,Z,null,"setPaintProperty"),Ir(ee.filter,ue.filter)||qr(B,{command:"setFilter",args:[Z,ue.filter]}),Ir(ee.minzoom,ue.minzoom)&&Ir(ee.maxzoom,ue.maxzoom)||qr(B,{command:"setLayerZoomRange",args:[Z,ue.minzoom,ue.maxzoom]}),ee)Object.prototype.hasOwnProperty.call(ee,fe)&&fe!=="layout"&&fe!=="paint"&&fe!=="filter"&&fe!=="metadata"&&fe!=="minzoom"&&fe!=="maxzoom"&&(fe.indexOf("paint.")===0?ni(ee[fe],ue[fe],B,Z,fe.slice(6),"setPaintProperty"):Ir(ee[fe],ue[fe])||qr(B,{command:"setLayerProperty",args:[Z,fe,ue[fe]]}));for(fe in ue)Object.prototype.hasOwnProperty.call(ue,fe)&&!Object.prototype.hasOwnProperty.call(ee,fe)&&fe!=="layout"&&fe!=="paint"&&fe!=="filter"&&fe!=="metadata"&&fe!=="minzoom"&&fe!=="maxzoom"&&(fe.indexOf("paint.")===0?ni(ee[fe],ue[fe],B,Z,fe.slice(6),"setPaintProperty"):Ir(ee[fe],ue[fe])||qr(B,{command:"setLayerProperty",args:[Z,fe,ue[fe]]}))}else qr(B,{command:"removeLayer",args:[Z]}),xe=K[K.lastIndexOf(Z)+1],qr(B,{command:"addLayer",args:[ue,xe]})}(x,l.layers,h)}catch(m){console.warn("Unable to compute style diff:",m),h=[{command:"setStyle",args:[l]}]}return h},a.bX=function(d){const l=[],h=d.id;return h===void 0&&l.push({message:`layers.${h}: missing required property "id"`}),d.render===void 0&&l.push({message:`layers.${h}: missing required method "render"`}),d.renderingMode&&d.renderingMode!=="2d"&&d.renderingMode!=="3d"&&l.push({message:`layers.${h}: property "renderingMode" must be either "2d" or "3d"`}),l},a.bY=kt,a.bZ=nr,a.b_=class extends co{constructor(d,l){super(d,l),this.current=0}set(d){this.current!==d&&(this.current=d,this.gl.uniform1i(this.location,d))}},a.ba=function(d,l,h){return d[0]=l[0]*h,d[1]=l[1]*h,d[2]=l[2]*h,d[3]=l[3]*h,d},a.bb=function(d,l){return d[0]*l[0]+d[1]*l[1]+d[2]*l[2]+d[3]},a.bc=IN,a.bd=Ag,a.be=function(d,l,h,m,_){var x=1/Math.tan(l/2);if(d[0]=x/h,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=x,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[11]=-1,d[12]=0,d[13]=0,d[15]=0,_!=null&&_!==1/0){var w=1/(m-_);d[10]=(_+m)*w,d[14]=2*_*m*w}else d[10]=-1,d[14]=-2*m;return d},a.bf=function(d){var l=new z(16);return l[0]=d[0],l[1]=d[1],l[2]=d[2],l[3]=d[3],l[4]=d[4],l[5]=d[5],l[6]=d[6],l[7]=d[7],l[8]=d[8],l[9]=d[9],l[10]=d[10],l[11]=d[11],l[12]=d[12],l[13]=d[13],l[14]=d[14],l[15]=d[15],l},a.bg=function(d,l,h){var m=Math.sin(h),_=Math.cos(h),x=l[0],w=l[1],E=l[2],B=l[3],O=l[4],N=l[5],U=l[6],G=l[7];return l!==d&&(d[8]=l[8],d[9]=l[9],d[10]=l[10],d[11]=l[11],d[12]=l[12],d[13]=l[13],d[14]=l[14],d[15]=l[15]),d[0]=x*_+O*m,d[1]=w*_+N*m,d[2]=E*_+U*m,d[3]=B*_+G*m,d[4]=O*_-x*m,d[5]=N*_-w*m,d[6]=U*_-E*m,d[7]=G*_-B*m,d},a.bh=function(d,l,h){var m=Math.sin(h),_=Math.cos(h),x=l[4],w=l[5],E=l[6],B=l[7],O=l[8],N=l[9],U=l[10],G=l[11];return l!==d&&(d[0]=l[0],d[1]=l[1],d[2]=l[2],d[3]=l[3],d[12]=l[12],d[13]=l[13],d[14]=l[14],d[15]=l[15]),d[4]=x*_+O*m,d[5]=w*_+N*m,d[6]=E*_+U*m,d[7]=B*_+G*m,d[8]=O*_-x*m,d[9]=N*_-w*m,d[10]=U*_-E*m,d[11]=G*_-B*m,d},a.bi=function(){const d=new Float32Array(16);return te(d),d},a.bj=function(){const d=new Float64Array(16);return te(d),d},a.bk=function(){return new Float64Array(16)},a.bl=function(d,l,h){const m=new Float64Array(4);return gt(m,d,l-90,h),m},a.bm=function(d,l,h,m){var _,x,w,E,B,O=l[0],N=l[1],U=l[2],G=l[3],K=h[0],q=h[1],Z=h[2],ee=h[3];return(x=O*K+N*q+U*Z+G*ee)<0&&(x=-x,K=-K,q=-q,Z=-Z,ee=-ee),1-x>W?(_=Math.acos(x),w=Math.sin(_),E=Math.sin((1-m)*_)/w,B=Math.sin(m*_)/w):(E=1-m,B=m),d[0]=E*O+B*K,d[1]=E*N+B*q,d[2]=E*U+B*Z,d[3]=E*G+B*ee,d},a.bn=function(d){const l=new Float64Array(9);(function(x,w){var E=w[0],B=w[1],O=w[2],N=w[3],U=E+E,G=B+B,K=O+O,q=E*U,Z=B*U,ee=B*G,ue=O*U,xe=O*G,fe=O*K,pe=N*U,Te=N*G,Oe=N*K;x[0]=1-ee-fe,x[3]=Z-Oe,x[6]=ue+Te,x[1]=Z+Oe,x[4]=1-q-fe,x[7]=xe-pe,x[2]=ue-Te,x[5]=xe+pe,x[8]=1-q-ee})(l,d);const h=cr(-Math.asin(Bn(l[2],-1,1)));let m,_;return Math.hypot(l[5],l[8])<.001?(m=0,_=-cr(Math.atan2(l[3],l[4]))):(m=cr(l[5]===0&&l[8]===0?0:Math.atan2(l[5],l[8])),_=cr(l[1]===0&&l[0]===0?0:Math.atan2(l[1],l[0]))),{roll:m,pitch:h+90,bearing:_}},a.bo=function(d,l){return d.roll==l.roll&&d.pitch==l.pitch&&d.bearing==l.bearing},a.bp=Ur,a.bq=bu,a.br=yg,a.bs=Mb,a.bt=mg,a.bu=Jr,a.bv=Xn,a.bw=Xs,a.bx=function(d,l,h,m,_){return Jr(m,_,Bn((d-l)/(h-l),0,1))},a.by=Er,a.bz=function(){return new Float64Array(3)},a.c=ke,a.c$=function(d,l,h,m,_){return o(this,void 0,void 0,function*(){if(V())try{return yield Dt(d,l,h,m,_)}catch{}return function(x,w,E,B,O){const N=x.width,U=x.height;Nt&&It||(Nt=new OffscreenCanvas(N,U),It=Nt.getContext("2d",{willReadFrequently:!0})),Nt.width=N,Nt.height=U,It.drawImage(x,0,0,N,U);const G=It.getImageData(w,E,B,O);return It.clearRect(0,0,N,U),G.data}(d,l,h,m,_)})},a.c0=class extends co{constructor(d,l){super(d,l),this.current=qo}set(d){if(d[12]!==this.current[12]||d[0]!==this.current[0])return this.current=d,void this.gl.uniformMatrix4fv(this.location,!1,d);for(let l=1;l<16;l++)if(d[l]!==this.current[l]){this.current=d,this.gl.uniformMatrix4fv(this.location,!1,d);break}}},a.c1=hf,a.c2=class extends co{constructor(d,l){super(d,l),this.current=[0,0,0]}set(d){d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]||(this.current=d,this.gl.uniform3f(this.location,d[0],d[1],d[2]))}},a.c3=class extends co{constructor(d,l){super(d,l),this.current=[0,0]}set(d){d[0]===this.current[0]&&d[1]===this.current[1]||(this.current=d,this.gl.uniform2f(this.location,d[0],d[1]))}},a.c4=$,a.c5=function(d,l){var h=Math.sin(l),m=Math.cos(l);return d[0]=m,d[1]=h,d[2]=0,d[3]=-h,d[4]=m,d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},a.c6=function(d,l,h){var m=l[0],_=l[1],x=l[2];return d[0]=m*h[0]+_*h[3]+x*h[6],d[1]=m*h[1]+_*h[4]+x*h[7],d[2]=m*h[2]+_*h[5]+x*h[8],d},a.c7=function(d,l,h,m,_,x,w){var E=1/(l-h),B=1/(m-_),O=1/(x-w);return d[0]=-2*E,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=-2*B,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=2*O,d[11]=0,d[12]=(l+h)*E,d[13]=(_+m)*B,d[14]=(w+x)*O,d[15]=1,d},a.c8=class extends co{constructor(d,l){super(d,l),this.current=new Array}set(d){if(d!=this.current){this.current=d;const l=new Float32Array(4*d.length);for(let h=0;h<d.length;h++)l[4*h]=d[h].r,l[4*h+1]=d[h].g,l[4*h+2]=d[h].b,l[4*h+3]=d[h].a;this.gl.uniform4fv(this.location,l)}}},a.c9=class extends co{constructor(d,l){super(d,l),this.current=new Array}set(d){if(d!=this.current){this.current=d;const l=new Float32Array(d);this.gl.uniform1fv(this.location,l)}}},a.cA=function(d,l){return Fe[l]&&"touches"in d},a.cB=function(d){return Fe[d]||re[d]},a.cC=function(d,l,h){var m=l[0],_=l[1];return d[0]=h[0]*m+h[4]*_+h[12],d[1]=h[1]*m+h[5]*_+h[13],d},a.cD=function(d,l){const{x:h,y:m}=Nb.fromLngLat(l);return!(d<0||d>25||m<0||m>=1||h<0||h>=1)},a.cE=function(d,l){return d[0]=l[0],d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=l[1],d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=l[2],d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d},a.cF=class extends sg{},a.cG=Ste,a.cI=Ue,a.cJ=function(d,l){ke.REGISTERED_PROTOCOLS[d]=l},a.cK=function(d){delete ke.REGISTERED_PROTOCOLS[d]},a.cL=function(d,l){const h={};for(let _=0;_<d.length;_++){const x=l&&l[d[_].id]||LA(d[_]);l&&(l[d[_].id]=x);let w=h[x];w||(w=h[x]=[]),w.push(d[_])}const m=[];for(const _ in h)m.push(h[_]);return m},a.cM=er,a.cN=BN,a.cO=lF,a.cP=hN,a.cQ=function(d){d.bucket.createArrays(),d.bucket.tilePixelRatio=Ut/(512*d.bucket.overscaling),d.bucket.compareText={},d.bucket.iconsNeedLinear=!1;const l=d.bucket.layers[0],h=l.layout,m=l._unevaluatedLayout._values,_={layoutIconSize:m["icon-size"].possiblyEvaluate(new kn(d.bucket.zoom+1),d.canonical),layoutTextSize:m["text-size"].possiblyEvaluate(new kn(d.bucket.zoom+1),d.canonical),textMaxSize:m["text-size"].possiblyEvaluate(new kn(18))};if(d.bucket.textSizeData.kind==="composite"){const{minZoom:O,maxZoom:N}=d.bucket.textSizeData;_.compositeTextSizes=[m["text-size"].possiblyEvaluate(new kn(O),d.canonical),m["text-size"].possiblyEvaluate(new kn(N),d.canonical)]}if(d.bucket.iconSizeData.kind==="composite"){const{minZoom:O,maxZoom:N}=d.bucket.iconSizeData;_.compositeIconSizes=[m["icon-size"].possiblyEvaluate(new kn(O),d.canonical),m["icon-size"].possiblyEvaluate(new kn(N),d.canonical)]}const x=h.get("text-line-height")*ls,w=h.get("text-rotation-alignment")!=="viewport"&&h.get("symbol-placement")!=="point",E=h.get("text-keep-upright"),B=h.get("text-size");for(const O of d.bucket.features){const N=h.get("text-font").evaluate(O,{},d.canonical).join(","),U=B.evaluate(O,{},d.canonical),G=_.layoutTextSize.evaluate(O,{},d.canonical),K=_.layoutIconSize.evaluate(O,{},d.canonical),q={horizontal:{},vertical:void 0},Z=O.text;let ee,ue=[0,0];if(Z){const pe=Z.toString(),Te=h.get("text-letter-spacing").evaluate(O,{},d.canonical)*ls,Oe=U2(pe)?Te:0,Ze=h.get("text-anchor").evaluate(O,{},d.canonical),xt=AF(l,O,d.canonical);if(!xt){const Et=h.get("text-radial-offset").evaluate(O,{},d.canonical);ue=Et?vF(Ze,[Et*ls,ME]):h.get("text-offset").evaluate(O,{},d.canonical).map(bt=>bt*ls)}let ht=w?"center":h.get("text-justify").evaluate(O,{},d.canonical);const Ct=h.get("symbol-placement")==="point"?h.get("text-max-width").evaluate(O,{},d.canonical)*ls:1/0,Vt=()=>{d.bucket.allowVerticalPlacement&&Eh(pe)&&(q.vertical=p1(Z,d.glyphMap,d.glyphPositions,d.imagePositions,N,Ct,x,Ze,"left",Oe,ue,a.az.vertical,!0,G,U))};if(!w&&xt){const Et=new Set;if(ht==="auto")for(let at=0;at<xt.values.length;at+=2)Et.add(RE(xt.values[at]));else Et.add(ht);let bt=!1;for(const at of Et)if(!q.horizontal[at])if(bt)q.horizontal[at]=q.horizontal[0];else{const Yt=p1(Z,d.glyphMap,d.glyphPositions,d.imagePositions,N,Ct,x,"center",at,Oe,ue,a.az.horizontal,!1,G,U);Yt&&(q.horizontal[at]=Yt,bt=Yt.positionedLines.length===1)}Vt()}else{ht==="auto"&&(ht=RE(Ze));const Et=p1(Z,d.glyphMap,d.glyphPositions,d.imagePositions,N,Ct,x,Ze,ht,Oe,ue,a.az.horizontal,!1,G,U);Et&&(q.horizontal[ht]=Et),Vt(),Eh(pe)&&w&&E&&(q.vertical=p1(Z,d.glyphMap,d.glyphPositions,d.imagePositions,N,Ct,x,Ze,ht,Oe,ue,a.az.vertical,!1,G,U))}}let xe=!1;if(O.icon&&O.icon.name){const pe=d.imageMap[O.icon.name];pe&&(ee=Dee(d.imagePositions[O.icon.name],h.get("icon-offset").evaluate(O,{},d.canonical),h.get("icon-anchor").evaluate(O,{},d.canonical)),xe=!!pe.sdf,d.bucket.sdfIcons===void 0?d.bucket.sdfIcons=xe:d.bucket.sdfIcons!==xe&&Ee("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(pe.pixelRatio!==d.bucket.pixelRatio||h.get("icon-rotate").constantOr(1)!==0)&&(d.bucket.iconsNeedLinear=!0))}const fe=wF(q.horizontal)||q.vertical;d.bucket.iconsInText=!!fe&&fe.iconsInText,(fe||ee)&&Cte(d.bucket,O,q,ee,d.imageMap,_,G,K,ue,xe,d.canonical,d.subdivisionGranularity)}d.showCollisionBoxes&&d.bucket.generateCollisionDebugBuffers()},a.cR=eE,a.cS=rE,a.cT=nE,a.cU=function(d){const l=new f1;return function(h,m){for(const _ in h.layers)m.writeMessage(3,ute,h.layers[_])}(d,l),l.finish()},a.cV=function(d,l,h,m,_,x){let w=hF(d,l,h,_,0);return w=hF(w,l,m,x,1),w},a.cW=class{constructor(d){this.maxEntries=d,this.map=new Map}get(d){const l=this.map.get(d);return l!==void 0&&(this.map.delete(d),this.map.set(d,l)),l}set(d,l){if(this.map.has(d))this.map.delete(d);else if(this.map.size>=this.maxEntries){const h=this.map.keys().next().value;this.map.delete(h)}this.map.set(d,l)}clear(){this.map.clear()}},a.cX=KL,a.cY=f1,a.cZ=oF,a.c_=class{constructor(d){this._marks={start:[d.url,"start"].join("#"),end:[d.url,"end"].join("#"),measure:d.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let d=performance.getEntriesByName(this._marks.measure);return d.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),d=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),d}},a.ca=class extends mu{},a.cb=fee,a.cc=class extends uf{},a.cd=J2,a.ce=function(d){return d<=1?1:Math.pow(2,Math.ceil(Math.log(d)/Math.LN2))},a.cf=ML,a.cg=function(d,l,h){var m=l[0],_=l[1],x=l[2],w=h[3]*m+h[7]*_+h[11]*x+h[15];return d[0]=(h[0]*m+h[4]*_+h[8]*x+h[12])/(w=w||1),d[1]=(h[1]*m+h[5]*_+h[9]*x+h[13])/w,d[2]=(h[2]*m+h[6]*_+h[10]*x+h[14])/w,d},a.ch=class extends yb{},a.ci=class extends c{},a.cj=function(d,l){return d[0]===l[0]&&d[1]===l[1]&&d[2]===l[2]&&d[3]===l[3]&&d[4]===l[4]&&d[5]===l[5]&&d[6]===l[6]&&d[7]===l[7]&&d[8]===l[8]&&d[9]===l[9]&&d[10]===l[10]&&d[11]===l[11]&&d[12]===l[12]&&d[13]===l[13]&&d[14]===l[14]&&d[15]===l[15]},a.ck=function(d,l){var h=d[0],m=d[1],_=d[2],x=d[3],w=d[4],E=d[5],B=d[6],O=d[7],N=d[8],U=d[9],G=d[10],K=d[11],q=d[12],Z=d[13],ee=d[14],ue=d[15],xe=l[0],fe=l[1],pe=l[2],Te=l[3],Oe=l[4],Ze=l[5],xt=l[6],ht=l[7],Ct=l[8],Vt=l[9],Et=l[10],bt=l[11],at=l[12],Yt=l[13],Jt=l[14],ir=l[15];return Math.abs(h-xe)<=W*Math.max(1,Math.abs(h),Math.abs(xe))&&Math.abs(m-fe)<=W*Math.max(1,Math.abs(m),Math.abs(fe))&&Math.abs(_-pe)<=W*Math.max(1,Math.abs(_),Math.abs(pe))&&Math.abs(x-Te)<=W*Math.max(1,Math.abs(x),Math.abs(Te))&&Math.abs(w-Oe)<=W*Math.max(1,Math.abs(w),Math.abs(Oe))&&Math.abs(E-Ze)<=W*Math.max(1,Math.abs(E),Math.abs(Ze))&&Math.abs(B-xt)<=W*Math.max(1,Math.abs(B),Math.abs(xt))&&Math.abs(O-ht)<=W*Math.max(1,Math.abs(O),Math.abs(ht))&&Math.abs(N-Ct)<=W*Math.max(1,Math.abs(N),Math.abs(Ct))&&Math.abs(U-Vt)<=W*Math.max(1,Math.abs(U),Math.abs(Vt))&&Math.abs(G-Et)<=W*Math.max(1,Math.abs(G),Math.abs(Et))&&Math.abs(K-bt)<=W*Math.max(1,Math.abs(K),Math.abs(bt))&&Math.abs(q-at)<=W*Math.max(1,Math.abs(q),Math.abs(at))&&Math.abs(Z-Yt)<=W*Math.max(1,Math.abs(Z),Math.abs(Yt))&&Math.abs(ee-Jt)<=W*Math.max(1,Math.abs(ee),Math.abs(Jt))&&Math.abs(ue-ir)<=W*Math.max(1,Math.abs(ue),Math.abs(ir))},a.cl=function(d,l){return d[0]=l[0],d[1]=l[1],d[2]=l[2],d[3]=l[3],d[4]=l[4],d[5]=l[5],d[6]=l[6],d[7]=l[7],d[8]=l[8],d[9]=l[9],d[10]=l[10],d[11]=l[11],d[12]=l[12],d[13]=l[13],d[14]=l[14],d[15]=l[15],d},a.cm=d=>d.type==="symbol",a.cn=d=>d.type==="circle",a.co=d=>d.type==="heatmap",a.cp=d=>d.type==="line",a.cq=d=>d.type==="fill",a.cr=d=>d.type==="fill-extrusion",a.cs=d=>d.type==="hillshade",a.ct=d=>d.type==="color-relief",a.cu=d=>d.type==="background",a.cv=d=>d.type==="custom",a.cw=mi,a.cx=function(d,l,h){const m=Tt(l.x-h.x,l.y-h.y),_=Tt(d.x-h.x,d.y-h.y),x=Math.atan2(m[0]*_[1]-m[1]*_[0],function(w,E){return w[0]*E[0]+w[1]*E[1]}(m,_));return cr(x)},a.cy=Pn,a.cz=function(d,l){return re[l]&&(d instanceof MouseEvent||d instanceof WheelEvent)},a.d=pt,a.d0=OL,a.d1=f,a.d2=class{constructor(d,l){this.layers={[zb]:this},this.name=zb,this.version=l?l.version:1,this.extent=l?l.extent:4096,this.length=d.length,this.features=d}feature(d){return new cte(this.features[d],this.extent)}},a.d3=$d,a.d4=vc,a.e=Mn,a.f=d=>o(void 0,void 0,void 0,function*(){if(d.byteLength===0)return createImageBitmap(new ImageData(1,1));const l=new Blob([new Uint8Array(d)],{type:"image/png"});try{return createImageBitmap(l)}catch(h){throw new Error(`Could not load image because of ${h.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),a.g=Ke,a.h=d=>new Promise((l,h)=>{const m=new Image;m.onload=()=>{l(m),URL.revokeObjectURL(m.src),m.onload=null,window.requestAnimationFrame(()=>{m.src=$t})},m.onerror=()=>h(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const _=new Blob([new Uint8Array(d)],{type:"image/png"});m.src=d.byteLength?URL.createObjectURL(_):$t}),a.i=wt,a.j=(d,l)=>vt(Mn(d,{type:"json"}),l),a.k=Cn,a.l=Br,a.m=vt,a.n=(d,l)=>vt(Mn(d,{type:"arrayBuffer"}),l),a.o=function(d){return new f1(d).readFields(Eee,[])},a.p=uN,a.q=function(d){return/[\u02EA\u02EB\u1100-\u11FF\u2E80-\u2FDF\u3000-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(d))},a.r=Sb,a.s=mr,a.t=qs,a.u=et,a.v=qd,a.w=Ee,a.x=gb,a.y=Yd,a.z=tf}),i("worker",["./shared"],function(a){class o{constructor(re,ne){this.keyCache={},re&&this.replace(re,ne)}replace(re,ne){this._layerConfigs={},this._layers={},this.update(re,[],ne)}update(re,ne,he){for(const ke of re){this._layerConfigs[ke.id]=ke;const Ke=this._layers[ke.id]=a.bT(ke,he);Ke._featureFilter=a.aj(Ke.filter,he),this.keyCache[ke.id]&&delete this.keyCache[ke.id]}for(const ke of ne)delete this.keyCache[ke],delete this._layerConfigs[ke],delete this._layers[ke];this.familiesBySource={};const Be=a.cL(Object.values(this._layerConfigs),this.keyCache);for(const ke of Be){const Ke=ke.map(Wt=>this._layers[Wt.id]),Ge=Ke[0];if(Ge.isHidden())continue;const Ue=Ge.source||"";let nt=this.familiesBySource[Ue];nt||(nt=this.familiesBySource[Ue]={});const vt=Ge.sourceLayer||a.ai;let pt=nt[vt];pt||(pt=nt[vt]=[]),pt.push(Ke)}}}class u{constructor(re){const ne={},he=[];for(const Ge in re){const Ue=re[Ge],nt=ne[Ge]={};for(const vt in Ue){const pt=Ue[+vt];if(!pt||pt.bitmap.width===0||pt.bitmap.height===0)continue;const Wt={x:0,y:0,w:pt.bitmap.width+2,h:pt.bitmap.height+2};he.push(Wt),nt[vt]={rect:Wt,metrics:pt.metrics}}}const{w:Be,h:ke}=a.p(he),Ke=new a.r({width:Be||1,height:ke||1});for(const Ge in re){const Ue=re[Ge];for(const nt in Ue){const vt=Ue[+nt];if(!vt||vt.bitmap.width===0||vt.bitmap.height===0)continue;const pt=ne[Ge][nt].rect;a.r.copy(vt.bitmap,Ke,{x:0,y:0},{x:pt.x+1,y:pt.y+1},vt.bitmap)}}this.image=Ke,this.positions=ne}}a.cM("GlyphAtlas",u);class f{constructor(re){this.tileID=new a.a2(re.tileID.overscaledZ,re.tileID.wrap,re.tileID.canonical.z,re.tileID.canonical.x,re.tileID.canonical.y),this.uid=re.uid,this.zoom=re.zoom,this.pixelRatio=re.pixelRatio,this.tileSize=re.tileSize,this.source=re.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=re.showCollisionBoxes,this.collectResourceTiming=!!re.collectResourceTiming,this.returnDependencies=!!re.returnDependencies,this.promoteId=re.promoteId,this.inFlightDependencies=[]}parse(re,ne,he,Be,ke){return a._(this,void 0,void 0,function*(){this.status="parsing",this.data=re,this.collisionBoxArray=new a.ag;const Ke=new a.cN(Object.keys(re.layers).sort()),Ge=new a.cO(this.tileID,this.promoteId);Ge.bucketLayerIDs=[];const Ue={},nt={featureIndex:Ge,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:he,subdivisionGranularity:ke},vt=ne.familiesBySource[this.source];for(const yn in vt){const ni=re.layers[yn];if(!ni)continue;ni.version===1&&a.w(`Vector tile source "${this.source}" layer "${yn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const xl=Ke.encode(yn),oc=[];for(let Rt=0;Rt<ni.length;Rt++){const ns=ni.feature(Rt),is=Ge.getId(ns,yn);oc.push({feature:ns,id:is,index:Rt,sourceLayerIndex:xl})}for(const Rt of vt[yn]){const ns=Rt[0];ns.source!==this.source&&a.w(`layer.source = ${ns.source} does not equal this.source = ${this.source}`),ns.isHidden(this.zoom,!0)||(g(Rt,this.zoom,he),(Ue[ns.id]=ns.createBucket({index:Ge.bucketLayerIDs.length,layers:Rt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:xl,sourceID:this.source})).populate(oc,nt,this.tileID.canonical),Ge.bucketLayerIDs.push(Rt.map(is=>is.id)))}}const pt=a.bY(nt.glyphDependencies,yn=>Object.keys(yn).map(Number));this.inFlightDependencies.forEach(yn=>yn?.abort()),this.inFlightDependencies=[];let Wt=Promise.resolve({});if(Object.keys(pt).length){const yn=new AbortController;this.inFlightDependencies.push(yn),Wt=Be.sendAsync({type:"GG",data:{stacks:pt,source:this.source,tileID:this.tileID,type:"glyphs"}},yn)}const ar=Object.keys(nt.iconDependencies);let Br=Promise.resolve({});if(ar.length){const yn=new AbortController;this.inFlightDependencies.push(yn),Br=Be.sendAsync({type:"GI",data:{icons:ar,source:this.source,tileID:this.tileID,type:"icons"}},yn)}const Cn=Object.keys(nt.patternDependencies);let ln=Promise.resolve({});if(Cn.length){const yn=new AbortController;this.inFlightDependencies.push(yn),ln=Be.sendAsync({type:"GI",data:{icons:Cn,source:this.source,tileID:this.tileID,type:"patterns"}},yn)}const et=nt.dashDependencies;let Tn=Promise.resolve({});if(Object.keys(et).length){const yn=new AbortController;this.inFlightDependencies.push(yn),Tn=Be.sendAsync({type:"GDA",data:{dashes:et}},yn)}const[Xi,Ir,qr,Ji]=yield Promise.all([Wt,Br,ln,Tn]),Rn=new u(Xi),nn=new a.cP(Ir,qr);for(const yn in Ue){const ni=Ue[yn];ni instanceof a.ah?(g(ni.layers,this.zoom,he),a.cQ({bucket:ni,glyphMap:Xi,glyphPositions:Rn.positions,imageMap:Ir,imagePositions:nn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:nt.subdivisionGranularity})):ni.hasDependencies&&(ni instanceof a.cR||ni instanceof a.cS||ni instanceof a.cT)&&(g(ni.layers,this.zoom,he),ni.addFeatures(nt,this.tileID.canonical,nn.patternPositions,Ji))}return this.status="done",{buckets:Object.values(Ue).filter(yn=>!yn.isEmpty()),featureIndex:Ge,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Rn.image,imageAtlas:nn,dashPositions:Ji,glyphMap:this.returnDependencies?Xi:null,iconMap:this.returnDependencies?Ir:null,glyphPositions:this.returnDependencies?Rn.positions:null}})}}function g(Fe,re,ne){const he=new a.H(re);for(const Be of Fe)Be.recalculate(he,ne)}class y{constructor(re,ne,he,Be,ke){this.type=re,this.properties=he||{},this.extent=ke,this.pointsArray=ne,this.id=Be}loadGeometry(){return this.pointsArray.map(re=>re.map(ne=>new a.P(ne.x,ne.y)))}}class A{constructor(re,ne,he){this.version=2,this._myFeatures=re,this.name=ne,this.length=re.length,this.extent=he}feature(re){return this._myFeatures[re]}}class C{constructor(){this.layers={}}addLayer(re){this.layers[re.name]=re}}function M(Fe){let re=a.cU(Fe);return re.byteOffset===0&&re.byteLength===re.buffer.byteLength||(re=new Uint8Array(re)),{vectorTile:Fe,rawData:re.buffer}}function k(Fe,re,ne){const{extent:he}=Fe,Be=Math.pow(2,ne.z-re.z),ke=(ne.x-re.x*Be)*he,Ke=(ne.y-re.y*Be)*he,Ge=[];for(let Ue=0;Ue<Fe.length;Ue++){const nt=Fe.feature(Ue);let vt=nt.loadGeometry();for(const Wt of vt)for(const ar of Wt)ar.x=ar.x*Be-ke,ar.y=ar.y*Be-Ke;const pt=128;vt=a.cV(vt,nt.type,-pt,-pt,he+pt,he+pt),vt.length!==0&&Ge.push(new y(nt.type,vt,nt.properties,nt.id,he))}return new A(Ge,Fe.name,he)}class D{constructor(re,ne,he){this.actor=re,this.layerIndex=ne,this.availableImages=he,this.fetching={},this.loading={},this.loaded={},this.overzoomedTileResultCache=new a.cW(1e3)}loadVectorTile(re,ne){return a._(this,void 0,void 0,function*(){const he=yield a.n(re.request,ne);try{return{vectorTile:re.encoding!=="mlt"?new a.cX(new a.cY(he.data)):new a.cZ(he.data),rawData:he.data,cacheControl:he.cacheControl,expires:he.expires}}catch(Be){const ke=new Uint8Array(he.data);let Ke=`Unable to parse the tile at ${re.request.url}, `;throw Ke+=ke[0]===31&&ke[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Be.message}`,new Error(Ke)}})}loadTile(re){return a._(this,void 0,void 0,function*(){const{uid:ne,overzoomParameters:he}=re;he&&(re.request=he.overzoomRequest);const Be=!!(re&&re.request&&re.request.collectResourceTiming)&&new a.c_(re.request),ke=new f(re);this.loading[ne]=ke;const Ke=new AbortController;ke.abort=Ke;try{const Ge=yield this.loadVectorTile(re,Ke);if(delete this.loading[ne],!Ge)return null;if(he){const Wt=this._getOverzoomTile(re,Ge.vectorTile);Ge.rawData=Wt.rawData,Ge.vectorTile=Wt.vectorTile}const Ue=Ge.rawData,nt={};Ge.expires&&(nt.expires=Ge.expires),Ge.cacheControl&&(nt.cacheControl=Ge.cacheControl);const vt={};if(Be){const Wt=Be.finish();Wt&&(vt.resourceTiming=JSON.parse(JSON.stringify(Wt)))}ke.vectorTile=Ge.vectorTile;const pt=ke.parse(Ge.vectorTile,this.layerIndex,this.availableImages,this.actor,re.subdivisionGranularity);this.loaded[ne]=ke,this.fetching[ne]={rawTileData:Ue,cacheControl:nt,resourceTiming:vt};try{const Wt=yield pt;return a.e({rawTileData:Ue.slice(0),encoding:re.encoding},Wt,nt,vt)}finally{delete this.fetching[ne]}}catch(Ge){throw delete this.loading[ne],ke.status="done",this.loaded[ne]=ke,Ge}})}_getOverzoomTile(re,ne){const{tileID:he,source:Be,overzoomParameters:ke}=re,{maxZoomTileID:Ke}=ke,Ge=`${Ke.key}_${he.key}`,Ue=this.overzoomedTileResultCache.get(Ge);if(Ue)return Ue;const nt=new C,vt=this.layerIndex.familiesBySource[Be];for(const Wt in vt){const ar=ne.layers[Wt];if(!ar)continue;const Br=k(ar,Ke,he.canonical);Br.length>0&&nt.addLayer(Br)}const pt=M(nt);return this.overzoomedTileResultCache.set(Ge,pt),pt}reloadTile(re){return a._(this,void 0,void 0,function*(){const ne=re.uid;if(!this.loaded||!this.loaded[ne])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const he=this.loaded[ne];if(he.showCollisionBoxes=re.showCollisionBoxes,he.status==="parsing"){const Be=yield he.parse(he.vectorTile,this.layerIndex,this.availableImages,this.actor,re.subdivisionGranularity);let ke;if(this.fetching[ne]){const{rawTileData:Ke,cacheControl:Ge,resourceTiming:Ue}=this.fetching[ne];delete this.fetching[ne],ke=a.e({rawTileData:Ke.slice(0),encoding:re.encoding},Be,Ge,Ue)}else ke=Be;return ke}if(he.status==="done"&&he.vectorTile)return he.parse(he.vectorTile,this.layerIndex,this.availableImages,this.actor,re.subdivisionGranularity)})}abortTile(re){return a._(this,void 0,void 0,function*(){const ne=this.loading,he=re.uid;ne&&ne[he]&&ne[he].abort&&(ne[he].abort.abort(),delete ne[he])})}removeTile(re){return a._(this,void 0,void 0,function*(){this.loaded&&this.loaded[re.uid]&&delete this.loaded[re.uid]})}}class V{constructor(){this.loaded={}}loadTile(re){return a._(this,void 0,void 0,function*(){const{uid:ne,encoding:he,rawImageData:Be,redFactor:ke,greenFactor:Ke,blueFactor:Ge,baseShift:Ue}=re,nt=Be.width+2,vt=Be.height+2,pt=a.b(Be)?new a.R({width:nt,height:vt},yield a.c$(Be,-1,-1,nt,vt)):Be,Wt=new a.d0(ne,pt,he,ke,Ke,Ge,Ue);return this.loaded=this.loaded||{},this.loaded[ne]=Wt,Wt})}removeTile(re){const ne=this.loaded,he=re.uid;ne&&ne[he]&&delete ne[he]}}var W,z,$=function(){if(z)return W;function Fe(ne,he){if(ne.length!==0){re(ne[0],he);for(var Be=1;Be<ne.length;Be++)re(ne[Be],!he)}}function re(ne,he){for(var Be=0,ke=0,Ke=0,Ge=ne.length,Ue=Ge-1;Ke<Ge;Ue=Ke++){var nt=(ne[Ke][0]-ne[Ue][0])*(ne[Ue][1]+ne[Ke][1]),vt=Be+nt;ke+=Math.abs(Be)>=Math.abs(nt)?Be-vt+nt:nt-vt+Be,Be=vt}Be+ke>=0!=!!he&&ne.reverse()}return z=1,W=function ne(he,Be){var ke,Ke=he&&he.type;if(Ke==="FeatureCollection")for(ke=0;ke<he.features.length;ke++)ne(he.features[ke],Be);else if(Ke==="GeometryCollection")for(ke=0;ke<he.geometries.length;ke++)ne(he.geometries[ke],Be);else if(Ke==="Feature")ne(he.geometry,Be);else if(Ke==="Polygon")Fe(he.coordinates,Be);else if(Ke==="MultiPolygon")for(ke=0;ke<he.coordinates.length;ke++)Fe(he.coordinates[ke],Be);return he}}(),te=a.d1($);const le={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Fe=>Fe},_e=Math.fround||(se=new Float32Array(1),Fe=>(se[0]=+Fe,se[0]));var se;class Y{constructor(re){this.options=Object.assign(Object.create(le),re),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(re){const{log:ne,minZoom:he,maxZoom:Be}=this.options;ne&&console.time("total time");const ke=`prepare ${re.length} points`;ne&&console.time(ke),this.points=re;const Ke=[];for(let Ue=0;Ue<re.length;Ue++){const nt=re[Ue];if(!nt.geometry)continue;const[vt,pt]=nt.geometry.coordinates,Wt=_e(Me(vt)),ar=_e(ze(pt));Ke.push(Wt,ar,1/0,Ue,-1,1),this.options.reduce&&Ke.push(0)}let Ge=this.trees[Be+1]=this._createTree(Ke);ne&&console.timeEnd(ke);for(let Ue=Be;Ue>=he;Ue--){const nt=+Date.now();Ge=this.trees[Ue]=this._createTree(this._cluster(Ge,Ue)),ne&&console.log("z%d: %d clusters in %dms",Ue,Ge.numItems,+Date.now()-nt)}return ne&&console.timeEnd("total time"),this}getClusters(re,ne){let he=((re[0]+180)%360+360)%360-180;const Be=Math.max(-90,Math.min(90,re[1]));let ke=re[2]===180?180:((re[2]+180)%360+360)%360-180;const Ke=Math.max(-90,Math.min(90,re[3]));if(re[2]-re[0]>=360)he=-180,ke=180;else if(he>ke){const pt=this.getClusters([he,Be,180,Ke],ne),Wt=this.getClusters([-180,Be,ke,Ke],ne);return pt.concat(Wt)}const Ge=this.trees[this._limitZoom(ne)],Ue=Ge.range(Me(he),ze(Ke),Me(ke),ze(Be)),nt=Ge.data,vt=[];for(const pt of Ue){const Wt=this.stride*pt;vt.push(nt[Wt+5]>1?ce(nt,Wt,this.clusterProps):this.points[nt[Wt+3]])}return vt}getChildren(re){const ne=this._getOriginId(re),he=this._getOriginZoom(re),Be="No cluster with the specified id.",ke=this.trees[he];if(!ke)throw new Error(Be);const Ke=ke.data;if(ne*this.stride>=Ke.length)throw new Error(Be);const Ge=this.options.radius/(this.options.extent*Math.pow(2,he-1)),Ue=ke.within(Ke[ne*this.stride],Ke[ne*this.stride+1],Ge),nt=[];for(const vt of Ue){const pt=vt*this.stride;Ke[pt+4]===re&&nt.push(Ke[pt+5]>1?ce(Ke,pt,this.clusterProps):this.points[Ke[pt+3]])}if(nt.length===0)throw new Error(Be);return nt}getLeaves(re,ne,he){const Be=[];return this._appendLeaves(Be,re,ne=ne||10,he=he||0,0),Be}getTile(re,ne,he){const Be=this.trees[this._limitZoom(re)],ke=Math.pow(2,re),{extent:Ke,radius:Ge}=this.options,Ue=Ge/Ke,nt=(he-Ue)/ke,vt=(he+1+Ue)/ke,pt={features:[]};return this._addTileFeatures(Be.range((ne-Ue)/ke,nt,(ne+1+Ue)/ke,vt),Be.data,ne,he,ke,pt),ne===0&&this._addTileFeatures(Be.range(1-Ue/ke,nt,1,vt),Be.data,ke,he,ke,pt),ne===ke-1&&this._addTileFeatures(Be.range(0,nt,Ue/ke,vt),Be.data,-1,he,ke,pt),pt.features.length?pt:null}getClusterExpansionZoom(re){let ne=this._getOriginZoom(re)-1;for(;ne<=this.options.maxZoom;){const he=this.getChildren(re);if(ne++,he.length!==1)break;re=he[0].properties.cluster_id}return ne}_appendLeaves(re,ne,he,Be,ke){const Ke=this.getChildren(ne);for(const Ge of Ke){const Ue=Ge.properties;if(Ue&&Ue.cluster?ke+Ue.point_count<=Be?ke+=Ue.point_count:ke=this._appendLeaves(re,Ue.cluster_id,he,Be,ke):ke<Be?ke++:re.push(Ge),re.length===he)break}return ke}_createTree(re){const ne=new a.aT(re.length/this.stride|0,this.options.nodeSize,Float32Array);for(let he=0;he<re.length;he+=this.stride)ne.add(re[he],re[he+1]);return ne.finish(),ne.data=re,ne}_addTileFeatures(re,ne,he,Be,ke,Ke){for(const Ge of re){const Ue=Ge*this.stride,nt=ne[Ue+5]>1;let vt,pt,Wt;if(nt)vt=oe(ne,Ue,this.clusterProps),pt=ne[Ue],Wt=ne[Ue+1];else{const Cn=this.points[ne[Ue+3]];vt=Cn.properties;const[ln,et]=Cn.geometry.coordinates;pt=Me(ln),Wt=ze(et)}const ar={type:1,geometry:[[Math.round(this.options.extent*(pt*ke-he)),Math.round(this.options.extent*(Wt*ke-Be))]],tags:vt};let Br;Br=nt||this.options.generateId?ne[Ue+3]:this.points[ne[Ue+3]].id,Br!==void 0&&(ar.id=Br),Ke.features.push(ar)}}_limitZoom(re){return Math.max(this.options.minZoom,Math.min(Math.floor(+re),this.options.maxZoom+1))}_cluster(re,ne){const{radius:he,extent:Be,reduce:ke,minPoints:Ke}=this.options,Ge=he/(Be*Math.pow(2,ne)),Ue=re.data,nt=[],vt=this.stride;for(let pt=0;pt<Ue.length;pt+=vt){if(Ue[pt+2]<=ne)continue;Ue[pt+2]=ne;const Wt=Ue[pt],ar=Ue[pt+1],Br=re.within(Ue[pt],Ue[pt+1],Ge),Cn=Ue[pt+5];let ln=Cn;for(const et of Br){const Tn=et*vt;Ue[Tn+2]>ne&&(ln+=Ue[Tn+5])}if(ln>Cn&&ln>=Ke){let et,Tn=Wt*Cn,Xi=ar*Cn,Ir=-1;const qr=(pt/vt<<5)+(ne+1)+this.points.length;for(const Ji of Br){const Rn=Ji*vt;if(Ue[Rn+2]<=ne)continue;Ue[Rn+2]=ne;const nn=Ue[Rn+5];Tn+=Ue[Rn]*nn,Xi+=Ue[Rn+1]*nn,Ue[Rn+4]=qr,ke&&(et||(et=this._map(Ue,pt,!0),Ir=this.clusterProps.length,this.clusterProps.push(et)),ke(et,this._map(Ue,Rn)))}Ue[pt+4]=qr,nt.push(Tn/ln,Xi/ln,1/0,qr,-1,ln),ke&&nt.push(Ir)}else{for(let et=0;et<vt;et++)nt.push(Ue[pt+et]);if(ln>1)for(const et of Br){const Tn=et*vt;if(!(Ue[Tn+2]<=ne)){Ue[Tn+2]=ne;for(let Xi=0;Xi<vt;Xi++)nt.push(Ue[Tn+Xi])}}}}return nt}_getOriginId(re){return re-this.points.length>>5}_getOriginZoom(re){return(re-this.points.length)%32}_map(re,ne,he){if(re[ne+5]>1){const Ke=this.clusterProps[re[ne+6]];return he?Object.assign({},Ke):Ke}const Be=this.points[re[ne+3]].properties,ke=this.options.map(Be);return he&&ke===Be?Object.assign({},ke):ke}}function ce(Fe,re,ne){return{type:"Feature",id:Fe[re+3],properties:oe(Fe,re,ne),geometry:{type:"Point",coordinates:[(he=Fe[re],360*(he-.5)),Ve(Fe[re+1])]}};var he}function oe(Fe,re,ne){const he=Fe[re+5],Be=he>=1e4?`${Math.round(he/1e3)}k`:he>=1e3?Math.round(he/100)/10+"k":he,ke=Fe[re+6],Ke=ke===-1?{}:Object.assign({},ne[ke]);return Object.assign(Ke,{cluster:!0,cluster_id:Fe[re+3],point_count:he,point_count_abbreviated:Be})}function Me(Fe){return Fe/360+.5}function ze(Fe){const re=Math.sin(Fe*Math.PI/180),ne=.5-.25*Math.log((1+re)/(1-re))/Math.PI;return ne<0?0:ne>1?1:ne}function Ve(Fe){const re=(180-360*Fe)*Math.PI/180;return 360*Math.atan(Math.exp(re))/Math.PI-90}function lt(Fe,re,ne,he){let Be=he;const ke=re+(ne-re>>1);let Ke,Ge=ne-re;const Ue=Fe[re],nt=Fe[re+1],vt=Fe[ne],pt=Fe[ne+1];for(let Wt=re+3;Wt<ne;Wt+=3){const ar=gt(Fe[Wt],Fe[Wt+1],Ue,nt,vt,pt);if(ar>Be)Ke=Wt,Be=ar;else if(ar===Be){const Br=Math.abs(Wt-ke);Br<Ge&&(Ke=Wt,Ge=Br)}}Be>he&&(Ke-re>3&&lt(Fe,re,Ke,he),Fe[Ke+2]=Be,ne-Ke>3&&lt(Fe,Ke,ne,he))}function gt(Fe,re,ne,he,Be,ke){let Ke=Be-ne,Ge=ke-he;if(Ke!==0||Ge!==0){const Ue=((Fe-ne)*Ke+(re-he)*Ge)/(Ke*Ke+Ge*Ge);Ue>1?(ne=Be,he=ke):Ue>0&&(ne+=Ke*Ue,he+=Ge*Ue)}return Ke=Fe-ne,Ge=re-he,Ke*Ke+Ge*Ge}function At(Fe,re,ne,he){const Be={id:Fe??null,type:re,geometry:ne,tags:he,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(re==="Point"||re==="MultiPoint"||re==="LineString")Tt(Be,ne);else if(re==="Polygon")Tt(Be,ne[0]);else if(re==="MultiLineString")for(const ke of ne)Tt(Be,ke);else if(re==="MultiPolygon")for(const ke of ne)Tt(Be,ke[0]);return Be}function Tt(Fe,re){for(let ne=0;ne<re.length;ne+=3)Fe.minX=Math.min(Fe.minX,re[ne]),Fe.minY=Math.min(Fe.minY,re[ne+1]),Fe.maxX=Math.max(Fe.maxX,re[ne]),Fe.maxY=Math.max(Fe.maxY,re[ne+1])}function Ut(Fe,re,ne,he){if(!re.geometry)return;const Be=re.geometry.coordinates;if(Be&&Be.length===0)return;const ke=re.geometry.type,Ke=Math.pow(ne.tolerance/((1<<ne.maxZoom)*ne.extent),2);let Ge=[],Ue=re.id;if(ne.promoteId?Ue=re.properties[ne.promoteId]:ne.generateId&&(Ue=he||0),ke==="Point")xr(Be,Ge);else if(ke==="MultiPoint")for(const nt of Be)xr(nt,Ge);else if(ke==="LineString")Er(Be,Ge,Ke,!1);else if(ke==="MultiLineString"){if(ne.lineMetrics){for(const nt of Be)Ge=[],Er(nt,Ge,Ke,!1),Fe.push(At(Ue,"LineString",Ge,re.properties));return}Jr(Be,Ge,Ke,!1)}else if(ke==="Polygon")Jr(Be,Ge,Ke,!0);else{if(ke!=="MultiPolygon"){if(ke==="GeometryCollection"){for(const nt of re.geometry.geometries)Ut(Fe,{id:Ue,geometry:nt,properties:re.properties},ne,he);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const nt of Be){const vt=[];Jr(nt,vt,Ke,!0),Ge.push(vt)}}Fe.push(At(Ue,ke,Ge,re.properties))}function xr(Fe,re){re.push(Xn(Fe[0]),mi(Fe[1]),0)}function Er(Fe,re,ne,he){let Be,ke,Ke=0;for(let Ue=0;Ue<Fe.length;Ue++){const nt=Xn(Fe[Ue][0]),vt=mi(Fe[Ue][1]);re.push(nt,vt,0),Ue>0&&(Ke+=he?(Be*vt-nt*ke)/2:Math.sqrt(Math.pow(nt-Be,2)+Math.pow(vt-ke,2))),Be=nt,ke=vt}const Ge=re.length-3;re[2]=1,lt(re,0,Ge,ne),re[Ge+2]=1,re.size=Math.abs(Ke),re.start=0,re.end=re.size}function Jr(Fe,re,ne,he){for(let Be=0;Be<Fe.length;Be++){const ke=[];Er(Fe[Be],ke,ne,he),re.push(ke)}}function Xn(Fe){return Fe/360+.5}function mi(Fe){const re=Math.sin(Fe*Math.PI/180),ne=.5-.25*Math.log((1+re)/(1-re))/Math.PI;return ne<0?0:ne>1?1:ne}function Pn(Fe,re,ne,he,Be,ke,Ke,Ge){if(he/=re,ke>=(ne/=re)&&Ke<he)return Fe;if(Ke<ne||ke>=he)return null;const Ue=[];for(const nt of Fe){const vt=nt.geometry;let pt=nt.type;const Wt=Be===0?nt.minX:nt.minY,ar=Be===0?nt.maxX:nt.maxY;if(Wt>=ne&&ar<he){Ue.push(nt);continue}if(ar<ne||Wt>=he)continue;let Br=[];if(pt==="Point"||pt==="MultiPoint")Bn(vt,Br,ne,he,Be);else if(pt==="LineString")Jn(vt,Br,ne,he,Be,!1,Ge.lineMetrics);else if(pt==="MultiLineString")_t(vt,Br,ne,he,Be,!1);else if(pt==="Polygon")_t(vt,Br,ne,he,Be,!0);else if(pt==="MultiPolygon")for(const Cn of vt){const ln=[];_t(Cn,ln,ne,he,Be,!0),ln.length&&Br.push(ln)}if(Br.length){if(Ge.lineMetrics&&pt==="LineString"){for(const Cn of Br)Ue.push(At(nt.id,pt,Cn,nt.tags));continue}pt!=="LineString"&&pt!=="MultiLineString"||(Br.length===1?(pt="LineString",Br=Br[0]):pt="MultiLineString"),pt!=="Point"&&pt!=="MultiPoint"||(pt=Br.length===3?"Point":"MultiPoint"),Ue.push(At(nt.id,pt,Br,nt.tags))}}return Ue.length?Ue:null}function Bn(Fe,re,ne,he,Be){for(let ke=0;ke<Fe.length;ke+=3){const Ke=Fe[ke+Be];Ke>=ne&&Ke<=he&&kt(re,Fe[ke],Fe[ke+1],Fe[ke+2])}}function Jn(Fe,re,ne,he,Be,ke,Ke){let Ge=Mn(Fe);const Ue=Be===0?nr:fr;let nt,vt,pt=Fe.start;for(let ln=0;ln<Fe.length-3;ln+=3){const et=Fe[ln],Tn=Fe[ln+1],Xi=Fe[ln+2],Ir=Fe[ln+3],qr=Fe[ln+4],Ji=Be===0?et:Tn,Rn=Be===0?Ir:qr;let nn=!1;Ke&&(nt=Math.sqrt(Math.pow(et-Ir,2)+Math.pow(Tn-qr,2))),Ji<ne?Rn>ne&&(vt=Ue(Ge,et,Tn,Ir,qr,ne),Ke&&(Ge.start=pt+nt*vt)):Ji>he?Rn<he&&(vt=Ue(Ge,et,Tn,Ir,qr,he),Ke&&(Ge.start=pt+nt*vt)):kt(Ge,et,Tn,Xi),Rn<ne&&Ji>=ne&&(vt=Ue(Ge,et,Tn,Ir,qr,ne),nn=!0),Rn>he&&Ji<=he&&(vt=Ue(Ge,et,Tn,Ir,qr,he),nn=!0),!ke&&nn&&(Ke&&(Ge.end=pt+nt*vt),re.push(Ge),Ge=Mn(Fe)),Ke&&(pt+=nt)}let Wt=Fe.length-3;const ar=Fe[Wt],Br=Fe[Wt+1],Cn=Be===0?ar:Br;Cn>=ne&&Cn<=he&&kt(Ge,ar,Br,Fe[Wt+2]),Wt=Ge.length-3,ke&&Wt>=3&&(Ge[Wt]!==Ge[0]||Ge[Wt+1]!==Ge[1])&&kt(Ge,Ge[0],Ge[1],Ge[2]),Ge.length&&re.push(Ge)}function Mn(Fe){const re=[];return re.size=Fe.size,re.start=Fe.start,re.end=Fe.end,re}function _t(Fe,re,ne,he,Be,ke){for(const Ke of Fe)Jn(Ke,re,ne,he,Be,ke,!1)}function kt(Fe,re,ne,he){Fe.push(re,ne,he)}function nr(Fe,re,ne,he,Be,ke){const Ke=(ke-re)/(he-re);return kt(Fe,ke,ne+(Be-ne)*Ke,1),Ke}function fr(Fe,re,ne,he,Be,ke){const Ke=(ke-ne)/(Be-ne);return kt(Fe,re+(he-re)*Ke,ke,1),Ke}function ve(Fe,re){const ne=[];for(let he=0;he<Fe.length;he++){const Be=Fe[he],ke=Be.type;let Ke;if(ke==="Point"||ke==="MultiPoint"||ke==="LineString")Ke=Ee(Be.geometry,re);else if(ke==="MultiLineString"||ke==="Polygon"){Ke=[];for(const Ge of Be.geometry)Ke.push(Ee(Ge,re))}else if(ke==="MultiPolygon"){Ke=[];for(const Ge of Be.geometry){const Ue=[];for(const nt of Ge)Ue.push(Ee(nt,re));Ke.push(Ue)}}ne.push(At(Be.id,ke,Ke,Be.tags))}return ne}function Ee(Fe,re){const ne=[];ne.size=Fe.size,Fe.start!==void 0&&(ne.start=Fe.start,ne.end=Fe.end);for(let he=0;he<Fe.length;he+=3)ne.push(Fe[he]+re,Fe[he+1],Fe[he+2]);return ne}function He(Fe,re){if(Fe.transformed)return Fe;const ne=1<<Fe.z,he=Fe.x,Be=Fe.y;for(const ke of Fe.features){const Ke=ke.geometry,Ge=ke.type;if(ke.geometry=[],Ge===1)for(let Ue=0;Ue<Ke.length;Ue+=2)ke.geometry.push(wt(Ke[Ue],Ke[Ue+1],re,ne,he,Be));else for(let Ue=0;Ue<Ke.length;Ue++){const nt=[];for(let vt=0;vt<Ke[Ue].length;vt+=2)nt.push(wt(Ke[Ue][vt],Ke[Ue][vt+1],re,ne,he,Be));ke.geometry.push(nt)}}return Fe.transformed=!0,Fe}function wt(Fe,re,ne,he,Be,ke){return[Math.round(ne*(Fe*he-Be)),Math.round(ne*(re*he-ke))]}function Qe(Fe,re,ne,he,Be){const ke=re===Be.maxZoom?0:Be.tolerance/((1<<re)*Be.extent),Ke={features:[],numPoints:0,numSimplified:0,numFeatures:Fe.length,source:null,x:ne,y:he,z:re,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ge of Fe)mt(Ke,Ge,ke,Be);return Ke}function mt(Fe,re,ne,he){const Be=re.geometry,ke=re.type,Ke=[];if(Fe.minX=Math.min(Fe.minX,re.minX),Fe.minY=Math.min(Fe.minY,re.minY),Fe.maxX=Math.max(Fe.maxX,re.maxX),Fe.maxY=Math.max(Fe.maxY,re.maxY),ke==="Point"||ke==="MultiPoint")for(let Ge=0;Ge<Be.length;Ge+=3)Ke.push(Be[Ge],Be[Ge+1]),Fe.numPoints++,Fe.numSimplified++;else if(ke==="LineString")$t(Ke,Be,Fe,ne,!1,!1);else if(ke==="MultiLineString"||ke==="Polygon")for(let Ge=0;Ge<Be.length;Ge++)$t(Ke,Be[Ge],Fe,ne,ke==="Polygon",Ge===0);else if(ke==="MultiPolygon")for(let Ge=0;Ge<Be.length;Ge++){const Ue=Be[Ge];for(let nt=0;nt<Ue.length;nt++)$t(Ke,Ue[nt],Fe,ne,!0,nt===0)}if(Ke.length){let Ge=re.tags||null;if(ke==="LineString"&&he.lineMetrics){Ge={};for(const nt in re.tags)Ge[nt]=re.tags[nt];Ge.mapbox_clip_start=Be.start/Be.size,Ge.mapbox_clip_end=Be.end/Be.size}const Ue={geometry:Ke,type:ke==="Polygon"||ke==="MultiPolygon"?3:ke==="LineString"||ke==="MultiLineString"?2:1,tags:Ge};re.id!==null&&(Ue.id=re.id),Fe.features.push(Ue)}}function $t(Fe,re,ne,he,Be,ke){const Ke=he*he;if(he>0&&re.size<(Be?Ke:he))return void(ne.numPoints+=re.length/3);const Ge=[];for(let Ue=0;Ue<re.length;Ue+=3)(he===0||re[Ue+2]>Ke)&&(ne.numSimplified++,Ge.push(re[Ue],re[Ue+1])),ne.numPoints++;Be&&function(Ue,nt){let vt=0;for(let pt=0,Wt=Ue.length,ar=Wt-2;pt<Wt;ar=pt,pt+=2)vt+=(Ue[pt]-Ue[ar])*(Ue[pt+1]+Ue[ar+1]);if(vt>0===nt)for(let pt=0,Wt=Ue.length;pt<Wt/2;pt+=2){const ar=Ue[pt],Br=Ue[pt+1];Ue[pt]=Ue[Wt-2-pt],Ue[pt+1]=Ue[Wt-1-pt],Ue[Wt-2-pt]=ar,Ue[Wt-1-pt]=Br}}(Ge,ke),Fe.push(Ge)}const Dt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Nt{constructor(re,ne){const he=(ne=this.options=function(ke,Ke){for(const Ge in Ke)ke[Ge]=Ke[Ge];return ke}(Object.create(Dt),ne)).debug;if(he&&console.time("preprocess data"),ne.maxZoom<0||ne.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ne.promoteId&&ne.generateId)throw new Error("promoteId and generateId cannot be used together.");let Be=function(ke,Ke){const Ge=[];if(ke.type==="FeatureCollection")for(let Ue=0;Ue<ke.features.length;Ue++)Ut(Ge,ke.features[Ue],Ke,Ue);else Ut(Ge,ke.type==="Feature"?ke:{geometry:ke},Ke);return Ge}(re,ne);this.tiles={},this.tileCoords=[],he&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ne.indexMaxZoom,ne.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Be=function(ke,Ke){const Ge=Ke.buffer/Ke.extent;let Ue=ke;const nt=Pn(ke,1,-1-Ge,Ge,0,-1,2,Ke),vt=Pn(ke,1,1-Ge,2+Ge,0,-1,2,Ke);return(nt||vt)&&(Ue=Pn(ke,1,-Ge,1+Ge,0,-1,2,Ke)||[],nt&&(Ue=ve(nt,1).concat(Ue)),vt&&(Ue=Ue.concat(ve(vt,-1)))),Ue}(Be,ne),Be.length&&this.splitTile(Be,0,0,0),he&&(Be.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(re,ne,he,Be,ke,Ke,Ge){const Ue=[re,ne,he,Be],nt=this.options,vt=nt.debug;for(;Ue.length;){Be=Ue.pop(),he=Ue.pop(),ne=Ue.pop(),re=Ue.pop();const pt=1<<ne,Wt=It(ne,he,Be);let ar=this.tiles[Wt];if(!ar&&(vt>1&&console.time("creation"),ar=this.tiles[Wt]=Qe(re,ne,he,Be,nt),this.tileCoords.push({z:ne,x:he,y:Be}),vt)){vt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ne,he,Be,ar.numFeatures,ar.numPoints,ar.numSimplified),console.timeEnd("creation"));const nn=`z${ne}`;this.stats[nn]=(this.stats[nn]||0)+1,this.total++}if(ar.source=re,ke==null){if(ne===nt.indexMaxZoom||ar.numPoints<=nt.indexMaxPoints)continue}else{if(ne===nt.maxZoom||ne===ke)continue;if(ke!=null){const nn=ke-ne;if(he!==Ke>>nn||Be!==Ge>>nn)continue}}if(ar.source=null,re.length===0)continue;vt>1&&console.time("clipping");const Br=.5*nt.buffer/nt.extent,Cn=.5-Br,ln=.5+Br,et=1+Br;let Tn=null,Xi=null,Ir=null,qr=null,Ji=Pn(re,pt,he-Br,he+ln,0,ar.minX,ar.maxX,nt),Rn=Pn(re,pt,he+Cn,he+et,0,ar.minX,ar.maxX,nt);re=null,Ji&&(Tn=Pn(Ji,pt,Be-Br,Be+ln,1,ar.minY,ar.maxY,nt),Xi=Pn(Ji,pt,Be+Cn,Be+et,1,ar.minY,ar.maxY,nt),Ji=null),Rn&&(Ir=Pn(Rn,pt,Be-Br,Be+ln,1,ar.minY,ar.maxY,nt),qr=Pn(Rn,pt,Be+Cn,Be+et,1,ar.minY,ar.maxY,nt),Rn=null),vt>1&&console.timeEnd("clipping"),Ue.push(Tn||[],ne+1,2*he,2*Be),Ue.push(Xi||[],ne+1,2*he,2*Be+1),Ue.push(Ir||[],ne+1,2*he+1,2*Be),Ue.push(qr||[],ne+1,2*he+1,2*Be+1)}}getTile(re,ne,he){re=+re,ne=+ne,he=+he;const Be=this.options,{extent:ke,debug:Ke}=Be;if(re<0||re>24)return null;const Ge=1<<re,Ue=It(re,ne=ne+Ge&Ge-1,he);if(this.tiles[Ue])return He(this.tiles[Ue],ke);Ke>1&&console.log("drilling down to z%d-%d-%d",re,ne,he);let nt,vt=re,pt=ne,Wt=he;for(;!nt&&vt>0;)vt--,pt>>=1,Wt>>=1,nt=this.tiles[It(vt,pt,Wt)];return nt&&nt.source?(Ke>1&&(console.log("found parent tile z%d-%d-%d",vt,pt,Wt),console.time("drilling down")),this.splitTile(nt.source,vt,pt,Wt,re,ne,he),Ke>1&&console.timeEnd("drilling down"),this.tiles[Ue]?He(this.tiles[Ue],ke):null):null}}function It(Fe,re,ne){return 32*((1<<Fe)*ne+re)+Fe}class mr extends D{constructor(re,ne,he,Be=Qt){super(re,ne,he),this._dataUpdateable=new Map,this._createGeoJSONIndex=Be}loadVectorTile(re,ne){return a._(this,void 0,void 0,function*(){const he=re.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const Be=this._geoJSONIndex.getTile(he.z,he.x,he.y);return Be?M(new a.d2(Be.features,{version:2,extent:a.a5})):null})}loadData(re){return a._(this,void 0,void 0,function*(){var ne;(ne=this._pendingRequest)===null||ne===void 0||ne.abort();const he=this._startPerformance(re);this._pendingRequest=new AbortController;try{(!this._pendingData||re.request||re.data||re.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON(re,this._pendingRequest));const Be=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(Be,re),this.loaded={};const ke={};return re.request&&(ke.data=Be),this._finishPerformance(he,re,ke),ke}catch(Be){if(delete this._pendingRequest,a.Z(Be))return{abandoned:!0};throw Be}})}_startPerformance(re){var ne;if(!((ne=re?.request)===null||ne===void 0)&&ne.collectResourceTiming)return new a.c_(re.request)}_finishPerformance(re,ne,he){if(!re)return;const Be=re.finish();Be&&(he.resourceTiming={},he.resourceTiming[ne.source]=JSON.parse(JSON.stringify(Be)))}getData(){return a._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(re){const ne=this.loaded;return ne&&ne[re.uid]?super.reloadTile(re):this.loadTile(re)}loadAndProcessGeoJSON(re,ne){return a._(this,void 0,void 0,function*(){let he;if(re.request?he=yield this.loadGeoJSONFromUrl(re.request,re.promoteId,ne):re.data?he=this._loadGeoJSONFromObject(re.data,re.promoteId):re.dataDiff&&(he=this._loadGeoJSONFromDiff(re.dataDiff,re.promoteId,re.source)),delete this._pendingRequest,typeof he!="object")throw new Error(`Input data given to '${re.source}' is not a valid GeoJSON object.`);return te(he,!0),re.filter&&(he=this._filterGeoJSON(he,re.filter)),he})}loadGeoJSONFromUrl(re,ne,he){return a._(this,void 0,void 0,function*(){const Be=yield a.j(re,he);return this._dataUpdateable=a.a7(Be.data,ne),Be.data})}_loadGeoJSONFromObject(re,ne){return this._dataUpdateable=a.a7(re,ne),re}_loadGeoJSONFromDiff(re,ne,he){if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${he}`);a.a8(this._dataUpdateable,re,ne);const Be=Array.from(this._dataUpdateable.values());return this._toFeatureCollection(Be)}_filterGeoJSON(re,ne){const he=a.d3(ne,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(he.result==="error")throw new Error(he.value.map(ke=>`${ke.key}: ${ke.message}`).join(", "));const Be=re.features.filter(ke=>he.value.evaluate({zoom:0},ke));return this._toFeatureCollection(Be)}_toFeatureCollection(re){return{type:"FeatureCollection",features:re}}removeSource(re){return a._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(re){return this._geoJSONIndex.getClusterExpansionZoom(re.clusterId)}getClusterChildren(re){return this._geoJSONIndex.getChildren(re.clusterId)}getClusterLeaves(re){return this._geoJSONIndex.getLeaves(re.clusterId,re.limit,re.offset)}}function Qt(Fe,re){return re.cluster?new Y(function({superclusterOptions:ne,clusterProperties:he}){if(!he||!ne)return ne;const Be={},ke={},Ke={accumulated:null,zoom:0},Ge={properties:null},Ue=Object.keys(he);for(const nt of Ue){const[vt,pt]=he[nt],Wt=a.d3(pt),ar=a.d3(typeof vt=="string"?[vt,["accumulated"],["get",nt]]:vt);Be[nt]=Wt.value,ke[nt]=ar.value}return ne.map=nt=>{Ge.properties=nt;const vt={};for(const pt of Ue)vt[pt]=Be[pt].evaluate(Ke,Ge);return vt},ne.reduce=(nt,vt)=>{Ge.properties=vt;for(const pt of Ue)Ke.accumulated=nt[pt],nt[pt]=ke[pt].evaluate(Ke,Ge)},ne}(re)).load(Fe.features):function(ne,he){return new Nt(ne,he)}(Fe,re.geojsonVtOptions)}class cr{constructor(re){this.self=re,this.actor=new a.L(re),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(ne,he)=>{if(this.externalWorkerSourceTypes[ne])throw new Error(`Worker source with name "${ne}" already registered.`);this.externalWorkerSourceTypes[ne]=he},this.self.addProtocol=a.cJ,this.self.removeProtocol=a.cK,this.self.registerRTLTextPlugin=ne=>{a.d4.setMethods(ne)},this.actor.registerMessageHandler("LDT",(ne,he)=>this._getDEMWorkerSource(ne,he.source).loadTile(he)),this.actor.registerMessageHandler("RDT",(ne,he)=>a._(this,void 0,void 0,function*(){this._getDEMWorkerSource(ne,he.source).removeTile(he)})),this.actor.registerMessageHandler("GCEZ",(ne,he)=>a._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,he.type,he.source).getClusterExpansionZoom(he)})),this.actor.registerMessageHandler("GCC",(ne,he)=>a._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,he.type,he.source).getClusterChildren(he)})),this.actor.registerMessageHandler("GCL",(ne,he)=>a._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,he.type,he.source).getClusterLeaves(he)})),this.actor.registerMessageHandler("LD",(ne,he)=>this._getWorkerSource(ne,he.type,he.source).loadData(he)),this.actor.registerMessageHandler("GD",(ne,he)=>this._getWorkerSource(ne,he.type,he.source).getData()),this.actor.registerMessageHandler("LT",(ne,he)=>this._getWorkerSource(ne,he.type,he.source).loadTile(he)),this.actor.registerMessageHandler("RT",(ne,he)=>this._getWorkerSource(ne,he.type,he.source).reloadTile(he)),this.actor.registerMessageHandler("AT",(ne,he)=>this._getWorkerSource(ne,he.type,he.source).abortTile(he)),this.actor.registerMessageHandler("RMT",(ne,he)=>this._getWorkerSource(ne,he.type,he.source).removeTile(he)),this.actor.registerMessageHandler("RS",(ne,he)=>a._(this,void 0,void 0,function*(){if(!this.workerSources[ne]||!this.workerSources[ne][he.type]||!this.workerSources[ne][he.type][he.source])return;const Be=this.workerSources[ne][he.type][he.source];delete this.workerSources[ne][he.type][he.source],Be.removeSource!==void 0&&Be.removeSource(he)})),this.actor.registerMessageHandler("RM",ne=>a._(this,void 0,void 0,function*(){delete this.layerIndexes[ne],delete this.availableImages[ne],delete this.workerSources[ne],delete this.demWorkerSources[ne],this.globalStates.delete(ne)})),this.actor.registerMessageHandler("SR",(ne,he)=>a._(this,void 0,void 0,function*(){this.referrer=he})),this.actor.registerMessageHandler("SRPS",(ne,he)=>this._syncRTLPluginState(ne,he)),this.actor.registerMessageHandler("IS",(ne,he)=>a._(this,void 0,void 0,function*(){this.self.importScripts(he)})),this.actor.registerMessageHandler("SI",(ne,he)=>this._setImages(ne,he)),this.actor.registerMessageHandler("UL",(ne,he)=>a._(this,void 0,void 0,function*(){this._getLayerIndex(ne).update(he.layers,he.removedIds,this._getGlobalState(ne))})),this.actor.registerMessageHandler("UGS",(ne,he)=>a._(this,void 0,void 0,function*(){const Be=this._getGlobalState(ne);for(const ke in he)Be[ke]=he[ke]})),this.actor.registerMessageHandler("SL",(ne,he)=>a._(this,void 0,void 0,function*(){this._getLayerIndex(ne).replace(he,this._getGlobalState(ne))}))}_getGlobalState(re){let ne=this.globalStates.get(re);return ne||(ne={},this.globalStates.set(re,ne)),ne}_setImages(re,ne){return a._(this,void 0,void 0,function*(){this.availableImages[re]=ne;for(const he in this.workerSources[re]){const Be=this.workerSources[re][he];for(const ke in Be)Be[ke].availableImages=ne}})}_syncRTLPluginState(re,ne){return a._(this,void 0,void 0,function*(){return yield a.d4.syncState(ne,this.self.importScripts)})}_getAvailableImages(re){let ne=this.availableImages[re];return ne||(ne=[]),ne}_getLayerIndex(re){let ne=this.layerIndexes[re];return ne||(ne=this.layerIndexes[re]=new o),ne}_getWorkerSource(re,ne,he){if(this.workerSources[re]||(this.workerSources[re]={}),this.workerSources[re][ne]||(this.workerSources[re][ne]={}),!this.workerSources[re][ne][he]){const Be={sendAsync:(ke,Ke)=>(ke.targetMapId=re,this.actor.sendAsync(ke,Ke))};switch(ne){case"vector":this.workerSources[re][ne][he]=new D(Be,this._getLayerIndex(re),this._getAvailableImages(re));break;case"geojson":this.workerSources[re][ne][he]=new mr(Be,this._getLayerIndex(re),this._getAvailableImages(re));break;default:this.workerSources[re][ne][he]=new this.externalWorkerSourceTypes[ne](Be,this._getLayerIndex(re),this._getAvailableImages(re))}}return this.workerSources[re][ne][he]}_getDEMWorkerSource(re,ne){return this.demWorkerSources[re]||(this.demWorkerSources[re]={}),this.demWorkerSources[re][ne]||(this.demWorkerSources[re][ne]=new V),this.demWorkerSources[re][ne]}}return a.i(self)&&(self.worker=new cr(self)),cr}),i("index",["exports","./shared"],function(a,o){var u="5.15.0";function f(){var T=new o.A(4);return o.A!=Float32Array&&(T[1]=0,T[2]=0),T[0]=1,T[3]=1,T}let g,y,A;const C={frame(T,c,p){const b=requestAnimationFrame(S=>{v(),c(S)}),{unsubscribe:v}=o.s(T.signal,"abort",()=>{v(),cancelAnimationFrame(b),p(new o.a(T.signal.reason))},!1)},frameAsync(T){return new Promise((c,p)=>{this.frame(T,c,p)})},getImageData(T,c=0){return this.getImageCanvasContext(T).getImageData(-c,-c,T.width+2*c,T.height+2*c)},getImageCanvasContext(T){const c=window.document.createElement("canvas"),p=c.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return c.width=T.width,c.height=T.height,p.drawImage(T,0,0,T.width,T.height),p},resolveURL:T=>(g||(g=document.createElement("a")),g.href=T,g.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return A!==void 0?A:!!matchMedia&&(y==null&&(y=matchMedia("(prefers-reduced-motion: reduce)")),y.matches)},set prefersReducedMotion(T){A=T}},M=new class{constructor(){this._realTime=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return this._frozenAt!==null?this._frozenAt:this._realTime()}setNow(T){this._frozenAt=T}restoreNow(){this._frozenAt=null}isFrozen(){return this._frozenAt!==null}};function k(){return M.getCurrentTime()}class D{static testProp(c){if(!D.docStyle)return c[0];for(let p=0;p<c.length;p++)if(c[p]in D.docStyle)return c[p];return c[0]}static create(c,p,b){const v=window.document.createElement(c);return p!==void 0&&(v.className=p),b&&b.appendChild(v),v}static createNS(c,p){return window.document.createElementNS(c,p)}static disableDrag(){D.docStyle&&D.selectProp&&(D.userSelect=D.docStyle[D.selectProp],D.docStyle[D.selectProp]="none")}static enableDrag(){D.docStyle&&D.selectProp&&(D.docStyle[D.selectProp]=D.userSelect)}static setTransform(c,p){c.style[D.transformProp]=p}static addEventListener(c,p,b,v={}){c.addEventListener(p,b,"passive"in v?v:v.capture)}static removeEventListener(c,p,b,v={}){c.removeEventListener(p,b,"passive"in v?v:v.capture)}static suppressClickInternal(c){c.preventDefault(),c.stopPropagation(),window.removeEventListener("click",D.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",D.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",D.suppressClickInternal,!0)},0)}static getScale(c){const p=c.getBoundingClientRect();return{x:p.width/c.offsetWidth||1,y:p.height/c.offsetHeight||1,boundingClientRect:p}}static getPoint(c,p,b){const v=p.boundingClientRect;return new o.P((b.clientX-v.left)/p.x-c.clientLeft,(b.clientY-v.top)/p.y-c.clientTop)}static mousePos(c,p){const b=D.getScale(c);return D.getPoint(c,b,p)}static touchPos(c,p){const b=[],v=D.getScale(c);for(let S=0;S<p.length;S++)b.push(D.getPoint(c,v,p[S]));return b}static mouseButton(c){return c.button}static remove(c){c.parentNode&&c.parentNode.removeChild(c)}static sanitize(c){const p=new DOMParser().parseFromString(c,"text/html").body||document.createElement("body"),b=p.querySelectorAll("script");for(const v of b)v.remove();return D.clean(p),p.innerHTML}static isPossiblyDangerous(c,p){const b=p.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(c)||!b.includes("javascript:")&&!b.includes("data:"))||!!c.startsWith("on")||void 0}static clean(c){const p=c.children;for(const b of p)D.removeAttributes(b),D.clean(b)}static removeAttributes(c){for(const{name:p,value:b}of c.attributes)D.isPossiblyDangerous(p,b)&&c.removeAttribute(p)}}D.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,D.selectProp=D.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),D.transformProp=D.testProp(["transform","WebkitTransform"]);const V={supported:!1,testSupport:function(T){!$&&z&&(te?le(T):W=T)}};let W,z,$=!1,te=!1;function le(T){const c=T.createTexture();T.bindTexture(T.TEXTURE_2D,c);try{if(T.texImage2D(T.TEXTURE_2D,0,T.RGBA,T.RGBA,T.UNSIGNED_BYTE,z),T.isContextLost())return;V.supported=!0}catch{}T.deleteTexture(c),$=!0}var _e;typeof document<"u"&&(z=document.createElement("img"),z.onload=()=>{W&&le(W),W=null,te=!0},z.onerror=()=>{$=!0,W=null},z.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(T){let c,p,b,v;T.resetRequestQueue=()=>{c=[],p=0,b=0,v={}},T.addThrottleControl=L=>{const F=b++;return v[F]=L,F},T.removeThrottleControl=L=>{delete v[L],P()},T.getImage=(L,F,j=!0)=>new Promise((J,X)=>{V.supported&&(L.headers||(L.headers={}),L.headers.accept="image/webp,*/*"),o.e(L,{type:"image"}),c.push({abortController:F,requestParameters:L,supportImageRefresh:j,state:"queued",onError:Q=>{X(Q)},onSuccess:Q=>{J(Q)}}),P()});const S=L=>o._(this,void 0,void 0,function*(){L.state="running";const{requestParameters:F,supportImageRefresh:j,onError:J,onSuccess:X,abortController:Q}=L,ae=j===!1&&!o.i(self)&&!o.g(F.url)&&(!F.headers||Object.keys(F.headers).reduce((me,we)=>me&&we==="accept",!0));p++;const ge=ae?R(F,Q):o.m(F,Q);try{const me=yield ge;delete L.abortController,L.state="completed",me.data instanceof HTMLImageElement||o.b(me.data)?X(me):me.data&&X({data:yield(ye=me.data,typeof createImageBitmap=="function"?o.f(ye):o.h(ye)),cacheControl:me.cacheControl,expires:me.expires})}catch(me){delete L.abortController,J(me)}finally{p--,P()}var ye}),P=()=>{const L=(()=>{for(const F of Object.keys(v))if(v[F]())return!0;return!1})()?o.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let F=p;F<L&&c.length>0;F++){const j=c.shift();j.abortController.signal.aborted?F--:S(j)}},R=(L,F)=>new Promise((j,J)=>{const X=new Image,Q=L.url,ae=L.credentials;ae&&ae==="include"?X.crossOrigin="use-credentials":(ae&&ae==="same-origin"||!o.d(Q))&&(X.crossOrigin="anonymous"),F.signal.addEventListener("abort",()=>{X.src="",J(new o.a(F.signal.reason))}),X.fetchPriority="high",X.onload=()=>{X.onerror=X.onload=null,j({data:X})},X.onerror=()=>{X.onerror=X.onload=null,F.signal.aborted||J(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},X.src=Q})}(_e||(_e={})),_e.resetRequestQueue();class se{constructor(c){this._transformRequestFn=c??null}transformRequest(c,p){return this._transformRequestFn&&this._transformRequestFn(c,p)||{url:c}}setTransformRequest(c){this._transformRequestFn=c}}function Y(T){const c=[];if(typeof T=="string")c.push({id:"default",url:T});else if(T&&T.length>0){const p=[];for(const{id:b,url:v}of T){const S=`${b}${v}`;p.indexOf(S)===-1&&(p.push(S),c.push({id:b,url:v}))}}return c}function ce(T,c,p){try{const b=new URL(T);return b.pathname+=`${c}${p}`,b.toString()}catch{throw new Error(`Invalid sprite URL "${T}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function oe(T){const{userImage:c}=T;return!!(c&&c.render&&c.render())&&(T.data.replace(new Uint8Array(c.data.buffer)),!0)}class Me extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}destroy(){this.atlasTexture&&(this.atlasTexture.destroy(),this.atlasTexture=null);for(const c of Object.keys(this.images))this.removeImage(c);this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(c){if(this.loaded!==c&&(this.loaded=c,c)){for(const{ids:p,promiseResolve:b}of this.requestors)b(this._getImagesForIds(p));this.requestors=[]}}getImage(c){const p=this.images[c];if(p&&!p.data&&p.spriteData){const b=p.spriteData;p.data=new o.R({width:b.width,height:b.height},b.context.getImageData(b.x,b.y,b.width,b.height).data),p.spriteData=null}return p}addImage(c,p){if(this.images[c])throw new Error(`Image id ${c} already exist, use updateImage instead`);this._validate(c,p)&&(this.images[c]=p)}_validate(c,p){let b=!0;const v=p.data||p.spriteData;return this._validateStretch(p.stretchX,v&&v.width)||(this.fire(new o.k(new Error(`Image "${c}" has invalid "stretchX" value`))),b=!1),this._validateStretch(p.stretchY,v&&v.height)||(this.fire(new o.k(new Error(`Image "${c}" has invalid "stretchY" value`))),b=!1),this._validateContent(p.content,p)||(this.fire(new o.k(new Error(`Image "${c}" has invalid "content" value`))),b=!1),b}_validateStretch(c,p){if(!c)return!0;let b=0;for(const v of c){if(v[0]<b||v[1]<v[0]||p<v[1])return!1;b=v[1]}return!0}_validateContent(c,p){if(!c)return!0;if(c.length!==4)return!1;const b=p.spriteData,v=b&&b.width||p.data.width,S=b&&b.height||p.data.height;return!(c[0]<0||v<c[0]||c[1]<0||S<c[1]||c[2]<0||v<c[2]||c[3]<0||S<c[3]||c[2]<c[0]||c[3]<c[1])}updateImage(c,p,b=!0){const v=this.getImage(c);if(b&&(v.data.width!==p.data.width||v.data.height!==p.data.height))throw new Error(`size mismatch between old image (${v.data.width}x${v.data.height}) and new image (${p.data.width}x${p.data.height}).`);p.version=v.version+1,this.images[c]=p,this.updatedImages[c]=!0}removeImage(c){const p=this.images[c];delete this.images[c],delete this.patterns[c],p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(c){return new Promise((p,b)=>{let v=!0;if(!this.isLoaded())for(const S of c)this.images[S]||(v=!1);this.isLoaded()||v?p(this._getImagesForIds(c)):this.requestors.push({ids:c,promiseResolve:p})})}_getImagesForIds(c){const p={};for(const b of c){let v=this.getImage(b);v||(this.fire(new o.l("styleimagemissing",{id:b})),v=this.getImage(b)),v?p[b]={data:v.data.clone(),pixelRatio:v.pixelRatio,sdf:v.sdf,version:v.version,stretchX:v.stretchX,stretchY:v.stretchY,content:v.content,textFitWidth:v.textFitWidth,textFitHeight:v.textFitHeight,hasRenderCallback:!!(v.userImage&&v.userImage.render)}:o.w(`Image "${b}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return p}getPixelSize(){const{width:c,height:p}=this.atlasImage;return{width:c,height:p}}getPattern(c){const p=this.patterns[c],b=this.getImage(c);if(!b)return null;if(p&&p.position.version===b.version)return p.position;if(p)p.position.version=b.version;else{const v={w:b.data.width+2,h:b.data.height+2,x:0,y:0},S=new o.I(v,b);this.patterns[c]={bin:v,position:S}}return this._updatePatternAtlas(),this.patterns[c].position}bind(c){const p=c.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.T(c,this.atlasImage,p.RGBA),this.atlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE)}_updatePatternAtlas(){const c=[];for(const S in this.patterns)c.push(this.patterns[S].bin);const{w:p,h:b}=o.p(c),v=this.atlasImage;v.resize({width:p||1,height:b||1});for(const S in this.patterns){const{bin:P}=this.patterns[S],R=P.x+1,L=P.y+1,F=this.getImage(S).data,j=F.width,J=F.height;o.R.copy(F,v,{x:0,y:0},{x:R,y:L},{width:j,height:J}),o.R.copy(F,v,{x:0,y:J-1},{x:R,y:L-1},{width:j,height:1}),o.R.copy(F,v,{x:0,y:0},{x:R,y:L+J},{width:j,height:1}),o.R.copy(F,v,{x:j-1,y:0},{x:R-1,y:L},{width:1,height:J}),o.R.copy(F,v,{x:0,y:0},{x:R+j,y:L},{width:1,height:J})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(c){for(const p of c){if(this.callbackDispatchedThisFrame[p])continue;this.callbackDispatchedThisFrame[p]=!0;const b=this.getImage(p);b||o.w(`Image with ID: "${p}" was not found`),oe(b)&&this.updateImage(p,b)}}cloneImages(){const c={};for(const p in this.images){const b=this.images[p];c[p]=Object.assign(Object.assign({},b),{data:b.data?b.data.clone():null})}return c}}const ze=1e20;function Ve(T,c,p,b,v,S,P,R,L){for(let F=c;F<c+b;F++)lt(T,p*S+F,S,v,P,R,L);for(let F=p;F<p+v;F++)lt(T,F*S+c,1,b,P,R,L)}function lt(T,c,p,b,v,S,P){S[0]=0,P[0]=-ze,P[1]=ze,v[0]=T[c];for(let R=1,L=0,F=0;R<b;R++){v[R]=T[c+R*p];const j=R*R;do{const J=S[L];F=(v[R]-v[J]+j-J*J)/(R-J)/2}while(F<=P[L]&&--L>-1);L++,S[L]=R,P[L]=F,P[L+1]=ze}for(let R=0,L=0;R<b;R++){for(;P[L+1]<R;)L++;const F=S[L],j=R-F;T[c+R*p]=v[F]+j*j}}const gt=o.v.layout_symbol["text-font"].default.join(",");class At{constructor(c,p,b){this.requestManager=c,this.localIdeographFontFamily=p,this.entries={},this.lang=b}setURL(c){this.url=c}getGlyphs(c){return o._(this,void 0,void 0,function*(){const p=[];for(const S in c)for(const P of c[S])p.push(this._getAndCacheGlyphsPromise(S,P));const b=yield Promise.all(p),v={};for(const{stack:S,id:P,glyph:R}of b)v[S]||(v[S]={}),v[S][P]=R&&{id:R.id,bitmap:R.bitmap.clone(),metrics:R.metrics};return v})}_getAndCacheGlyphsPromise(c,p){return o._(this,void 0,void 0,function*(){let b=this.entries[c];b||(b=this.entries[c]={glyphs:{},requests:{},ranges:{}});let v=b.glyphs[p];return v!==void 0?{stack:c,id:p,glyph:v}:!this.url||this._charUsesLocalIdeographFontFamily(p)?(v=b.glyphs[p]=this._drawGlyph(b,c,p),{stack:c,id:p,glyph:v}):yield this._downloadAndCacheRangePromise(c,p)})}_downloadAndCacheRangePromise(c,p){return o._(this,void 0,void 0,function*(){const b=this.entries[c],v=Math.floor(p/256);if(b.ranges[v])return{stack:c,id:p,glyph:null};if(!b.requests[v]){const S=At.loadGlyphRange(c,v,this.url,this.requestManager);b.requests[v]=S}try{const S=yield b.requests[v];for(const P in S)b.glyphs[+P]=S[+P];return b.ranges[v]=!0,{stack:c,id:p,glyph:S[p]||null}}catch(S){const P=b.glyphs[p]=this._drawGlyph(b,c,p);return this._warnOnMissingGlyphRange(P,v,p,S),{stack:c,id:p,glyph:P}}})}_warnOnMissingGlyphRange(c,p,b,v){const S=256*p,P=S+255,R=b.toString(16).padStart(4,"0").toUpperCase();o.w(`Unable to load glyph range ${p}, ${S}-${P}. Rendering codepoint U+${R} locally instead. ${v}`)}_charUsesLocalIdeographFontFamily(c){return!!this.localIdeographFontFamily&&o.q(c)}_drawGlyph(c,p,b){const v=p===gt&&this.localIdeographFontFamily!==""&&this._charUsesLocalIdeographFontFamily(b),S=v?"ideographTinySDF":"tinySDF";c[S]||(c[S]=this._createTinySDF(v?this.localIdeographFontFamily:p));const P=c[S].draw(String.fromCodePoint(b));return{id:b,bitmap:new o.r({width:P.width||60,height:P.height||60},P.data),metrics:{width:P.glyphWidth/2||24,height:P.glyphHeight/2||24,left:P.glyphLeft/2+.5||0,top:P.glyphTop/2-27.5||-8,advance:P.glyphAdvance/2||24,isDoubleResolution:!0}}}_createTinySDF(c){const p=c?c.split(","):[];p.push("sans-serif");const b=p.map(v=>/[-\w]+/.test(v)?v:`'${CSS.escape(v)}'`).join(",");return new At.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:b,fontWeight:this._fontWeight(p[0]),fontStyle:this._fontStyle(p[0]),lang:this.lang})}_fontStyle(c){return/italic/i.test(c)?"italic":/oblique/i.test(c)?"oblique":"normal"}_fontWeight(c){const p={thin:100,hairline:100,"extra light":200,"ultra light":200,light:300,normal:400,regular:400,medium:500,semibold:600,demibold:600,bold:700,"extra bold":800,"ultra bold":800,black:900,heavy:900,"extra black":950,"ultra black":950};let b;for(const[v,S]of Object.entries(p))new RegExp(`\\b${v}\\b`,"i").test(c)&&(b=`${S}`);return b}destroy(){for(const c in this.entries){const p=this.entries[c];p.tinySDF&&(p.tinySDF=null),p.ideographTinySDF&&(p.ideographTinySDF=null),p.glyphs={},p.requests={},p.ranges={}}this.entries={}}}At.loadGlyphRange=function(T,c,p,b){return o._(this,void 0,void 0,function*(){const v=256*c,S=v+255,P=b.transformRequest(p.replace("{fontstack}",T).replace("{range}",`${v}-${S}`),"Glyphs"),R=yield o.n(P,new AbortController);if(!R||!R.data)throw new Error(`Could not load glyph range. range: ${c}, ${v}-${S}`);const L={};for(const F of o.o(R.data))L[F.id]=F;return L})},At.TinySDF=class{constructor({fontSize:T=24,buffer:c=3,radius:p=8,cutoff:b=.25,fontFamily:v="sans-serif",fontWeight:S="normal",fontStyle:P="normal",lang:R=null}={}){this.buffer=c,this.cutoff=b,this.radius=p,this.lang=R;const L=this.size=T+4*c,F=this._createCanvas(L),j=this.ctx=F.getContext("2d",{willReadFrequently:!0});j.font=`${P} ${S} ${T}px ${v}`,j.textBaseline="alphabetic",j.textAlign="left",j.fillStyle="black",this.gridOuter=new Float64Array(L*L),this.gridInner=new Float64Array(L*L),this.f=new Float64Array(L),this.z=new Float64Array(L+1),this.v=new Uint16Array(L)}_createCanvas(T){const c=document.createElement("canvas");return c.width=c.height=T,c}draw(T){const{width:c,actualBoundingBoxAscent:p,actualBoundingBoxDescent:b,actualBoundingBoxLeft:v,actualBoundingBoxRight:S}=this.ctx.measureText(T),P=Math.ceil(p),R=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(S-v))),L=Math.min(this.size-this.buffer,P+Math.ceil(b)),F=R+2*this.buffer,j=L+2*this.buffer,J=Math.max(F*j,0),X=new Uint8ClampedArray(J),Q={data:X,width:F,height:j,glyphWidth:R,glyphHeight:L,glyphTop:P,glyphLeft:0,glyphAdvance:c};if(R===0||L===0)return Q;const{ctx:ae,buffer:ge,gridInner:ye,gridOuter:me}=this;this.lang&&(ae.lang=this.lang),ae.clearRect(ge,ge,R,L),ae.fillText(T,ge,ge+P);const we=ae.getImageData(ge,ge,R,L);me.fill(ze,0,J),ye.fill(0,0,J);for(let De=0;De<L;De++)for(let Ae=0;Ae<R;Ae++){const Re=we.data[4*(De*R+Ae)+3]/255;if(Re===0)continue;const Le=(De+ge)*F+Ae+ge;if(Re===1)me[Le]=0,ye[Le]=ze;else{const Pe=.5-Re;me[Le]=Pe>0?Pe*Pe:0,ye[Le]=Pe<0?Pe*Pe:0}}Ve(me,0,0,F,j,F,this.f,this.v,this.z),Ve(ye,ge,ge,R,L,F,this.f,this.v,this.z);for(let De=0;De<J;De++){const Ae=Math.sqrt(me[De])-Math.sqrt(ye[De]);X[De]=Math.round(255-255*(Ae/this.radius+this.cutoff))}return Q}};class Tt{constructor(){this.specification=o.u.light.position}possiblyEvaluate(c,p){return o.F(c.expression.evaluate(p))}interpolate(c,p,b){return{x:o.G.number(c.x,p.x,b),y:o.G.number(c.y,p.y,b),z:o.G.number(c.z,p.z,b)}}}let Ut;class xr extends o.E{constructor(c){super(),Ut=Ut||new o.t({anchor:new o.D(o.u.light.anchor),position:new Tt,color:new o.D(o.u.light.color),intensity:new o.D(o.u.light.intensity)}),this._transitionable=new o.x(Ut,void 0),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(c,p={}){if(!this._validate(o.y,c,p))for(const b in c){const v=c[b];b.endsWith(o.z)?this._transitionable.setTransition(b.slice(0,-o.z.length),v):this._transitionable.setValue(b,v)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,p,b){return(!b||b.validate!==!1)&&o.B(this,c.call(o.C,{value:p,style:{glyphs:!0,sprite:!0},styleSpec:o.u}))}}const Er=new o.t({"sky-color":new o.D(o.u.sky["sky-color"]),"horizon-color":new o.D(o.u.sky["horizon-color"]),"fog-color":new o.D(o.u.sky["fog-color"]),"fog-ground-blend":new o.D(o.u.sky["fog-ground-blend"]),"horizon-fog-blend":new o.D(o.u.sky["horizon-fog-blend"]),"sky-horizon-blend":new o.D(o.u.sky["sky-horizon-blend"]),"atmosphere-blend":new o.D(o.u.sky["atmosphere-blend"])});class Jr extends o.E{constructor(c){super(),this._transitionable=new o.x(Er,void 0),this.setSky(c),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.H(0))}setSky(c,p={}){if(!this._validate(o.J,c,p)){c||(c={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const b in c){const v=c[b];b.endsWith(o.z)?this._transitionable.setTransition(b.slice(0,-o.z.length),v):this._transitionable.setValue(b,v)}}}getSky(){return this._transitionable.serialize()}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,p,b={}){return b?.validate!==!1&&o.B(this,c.call(o.C,o.e({value:p,style:{glyphs:!0,sprite:!0},styleSpec:o.u})))}calculateFogBlendOpacity(c){return c<60?0:c<70?(c-60)/10:1}}class Xn{constructor(c,p){this.width=c,this.height=p,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(c,p){const b=c.join(",")+String(p);return this.dashEntry[b]||(this.dashEntry[b]=this.addDash(c,p)),this.dashEntry[b]}getDashRanges(c,p,b){const v=[];let S=c.length%2==1?-c[c.length-1]*b:0,P=c[0]*b,R=!0;v.push({left:S,right:P,isDash:R,zeroLength:c[0]===0});let L=c[0];for(let F=1;F<c.length;F++){R=!R;const j=c[F];S=L*b,L+=j,P=L*b,v.push({left:S,right:P,isDash:R,zeroLength:j===0})}return v}addRoundDash(c,p,b){const v=p/2;for(let S=-b;S<=b;S++){const P=this.width*(this.nextRow+b+S);let R=0,L=c[R];for(let F=0;F<this.width;F++){F/L.right>1&&(L=c[++R]);const j=Math.abs(F-L.left),J=Math.abs(F-L.right),X=Math.min(j,J);let Q;const ae=S/b*(v+1);if(L.isDash){const ge=v-Math.abs(ae);Q=Math.sqrt(X*X+ge*ge)}else Q=v-Math.sqrt(X*X+ae*ae);this.data[P+F]=Math.max(0,Math.min(255,Q+128))}}}addRegularDash(c){for(let R=c.length-1;R>=0;--R){const L=c[R],F=c[R+1];L.zeroLength?c.splice(R,1):F&&F.isDash===L.isDash&&(F.left=L.left,c.splice(R,1))}const p=c[0],b=c[c.length-1];p.isDash===b.isDash&&(p.left=b.left-this.width,b.right=p.right+this.width);const v=this.width*this.nextRow;let S=0,P=c[S];for(let R=0;R<this.width;R++){R/P.right>1&&(P=c[++S]);const L=Math.abs(R-P.left),F=Math.abs(R-P.right),j=Math.min(L,F);this.data[v+R]=Math.max(0,Math.min(255,(P.isDash?j:-j)+128))}}addDash(c,p){const b=p?7:0,v=2*b+1;if(this.nextRow+v>this.height)return o.w("LineAtlas out of space"),null;let S=0;for(let R=0;R<c.length;R++)S+=c[R];if(S!==0){const R=this.width/S,L=this.getDashRanges(c,this.width,R);p?this.addRoundDash(L,R,b):this.addRegularDash(L)}const P={y:this.nextRow+b,height:2*b,width:S};return this.nextRow+=v,this.dirty=!0,P}bind(c){const p=c.gl;this.texture?(p.bindTexture(p.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,p.texSubImage2D(p.TEXTURE_2D,0,0,0,this.width,this.height,p.ALPHA,p.UNSIGNED_BYTE,this.data))):(this.texture=p.createTexture(),p.bindTexture(p.TEXTURE_2D,this.texture),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.REPEAT),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR),p.texImage2D(p.TEXTURE_2D,0,p.ALPHA,this.width,this.height,0,p.ALPHA,p.UNSIGNED_BYTE,this.data))}}const mi="maplibre_preloaded_worker_pool";class Pn{constructor(){this.active={}}acquire(c){if(!this.workers)for(this.workers=[];this.workers.length<Pn.workerCount;)this.workers.push(new Worker(o.c.WORKER_URL));return this.active[c]=!0,this.workers.slice()}release(c){delete this.active[c],this.numActive()===0&&(this.workers.forEach(p=>{p.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[mi]}numActive(){return Object.keys(this.active).length}}const Bn=Math.floor(C.hardwareConcurrency/2);let Jn,Mn;function _t(){return Jn||(Jn=new Pn),Jn}Pn.workerCount=o.K(globalThis)?Math.max(Math.min(Bn,3),1):1;class kt{constructor(c,p){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=p;const b=this.workerPool.acquire(p);for(let v=0;v<b.length;v++){const S=new o.L(b[v],p);S.name=`Worker ${v}`,this.actors.push(S)}if(!this.actors.length)throw new Error("No actors found")}broadcast(c,p){const b=[];for(const v of this.actors)b.push(v.sendAsync({type:c,data:p}));return Promise.all(b)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(c=!0){this.actors.forEach(p=>{p.remove()}),this.actors=[],c&&this.workerPool.release(this.id)}registerMessageHandler(c,p){for(const b of this.actors)b.registerMessageHandler(c,p)}unregisterMessageHandler(c){for(const p of this.actors)p.unregisterMessageHandler(c)}}function nr(){return Mn||(Mn=new kt(_t(),o.M),Mn.registerMessageHandler("GR",(T,c,p)=>o.m(c,p))),Mn}function fr(T,c){const p=o.N();return o.O(p,p,[1,1,0]),o.Q(p,p,[.5*T.width,.5*T.height,1]),T.calculatePosMatrix?o.S(p,p,T.calculatePosMatrix(c.toUnwrapped())):p}function ve(T,c,p,b,v,S,P){var R;const L=function(X,Q,ae){if(X)for(const ge of X){const ye=Q[ge];if(ye&&ye.source===ae&&ye.type==="fill-extrusion")return!0}else for(const ge in Q){const ye=Q[ge];if(ye.source===ae&&ye.type==="fill-extrusion")return!0}return!1}((R=v?.layers)!==null&&R!==void 0?R:null,c,T.id),F=S.maxPitchScaleFactor(),j=T.tilesIn(b,F,L);j.sort(Ee);const J=[];for(const X of j)J.push({wrappedTileID:X.tileID.wrapped().key,queryResults:X.tile.queryRenderedFeatures(c,p,T.getState(),X.queryGeometry,X.cameraQueryGeometry,X.scale,v,S,F,fr(S,X.tileID),P?(Q,ae)=>P(X.tileID,Q,ae):void 0)});return function(X,Q){for(const ae in X)for(const ge of X[ae])He(ge,Q);return X}(function(X){const Q={},ae={};for(const ge of X){const ye=ge.queryResults,me=ge.wrappedTileID,we=ae[me]=ae[me]||{};for(const De in ye){const Ae=ye[De],Re=we[De]=we[De]||{},Le=Q[De]=Q[De]||[];for(const Pe of Ae)Re[Pe.featureIndex]||(Re[Pe.featureIndex]=!0,Le.push(Pe))}}return Q}(J),T)}function Ee(T,c){const p=T.tileID,b=c.tileID;return p.overscaledZ-b.overscaledZ||p.canonical.y-b.canonical.y||p.wrap-b.wrap||p.canonical.x-b.canonical.x}function He(T,c){const p=T.feature,b=c.getFeatureState(p.layer["source-layer"],p.id);p.source=p.layer.source,p.layer["source-layer"]&&(p.sourceLayer=p.layer["source-layer"]),p.state=b}function wt(T,c,p){return o._(this,void 0,void 0,function*(){let b=T;if(T.url?b=(yield o.j(c.transformRequest(T.url,"Source"),p)).data:yield C.frameAsync(p),!b)return null;const v=o.U(o.e(b,T),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in b&&b.vector_layers&&(v.vectorLayerIds=b.vector_layers.map(S=>S.id)),v})}class Qe{constructor(c,p){c&&(p?this.setSouthWest(c).setNorthEast(p):Array.isArray(c)&&(c.length===4?this.setSouthWest([c[0],c[1]]).setNorthEast([c[2],c[3]]):this.setSouthWest(c[0]).setNorthEast(c[1])))}setNorthEast(c){return this._ne=c instanceof o.V?new o.V(c.lng,c.lat):o.V.convert(c),this}setSouthWest(c){return this._sw=c instanceof o.V?new o.V(c.lng,c.lat):o.V.convert(c),this}extend(c){const p=this._sw,b=this._ne;let v,S;if(c instanceof o.V)v=c,S=c;else{if(!(c instanceof Qe))return Array.isArray(c)?c.length===4||c.every(Array.isArray)?this.extend(Qe.convert(c)):this.extend(o.V.convert(c)):c&&("lng"in c||"lon"in c)&&"lat"in c?this.extend(o.V.convert(c)):this;if(v=c._sw,S=c._ne,!v||!S)return this}return p||b?(p.lng=Math.min(v.lng,p.lng),p.lat=Math.min(v.lat,p.lat),b.lng=Math.max(S.lng,b.lng),b.lat=Math.max(S.lat,b.lat)):(this._sw=new o.V(v.lng,v.lat),this._ne=new o.V(S.lng,S.lat)),this}getCenter(){return new o.V((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.V(this.getWest(),this.getNorth())}getSouthEast(){return new o.V(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(c){const{lng:p,lat:b}=o.V.convert(c);let v=this._sw.lng<=p&&p<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=p&&p>=this._ne.lng),this._sw.lat<=b&&b<=this._ne.lat&&v}intersects(c){if(!((c=Qe.convert(c)).getNorth()>=this.getSouth()&&c.getSouth()<=this.getNorth()))return!1;const p=Math.abs(this.getEast()-this.getWest()),b=Math.abs(c.getEast()-c.getWest());if(p>=360||b>=360)return!0;const v=o.W(this.getWest(),-180,180),S=o.W(this.getEast(),-180,180),P=o.W(c.getWest(),-180,180),R=o.W(c.getEast(),-180,180),L=v>=S,F=P>=R;return!(!L||!F)||(L?R>=v||P<=S:F?S>=P||v<=R:P<=S&&R>=v)}static convert(c){return c instanceof Qe?c:c&&new Qe(c)}static fromLngLat(c,p=0){const b=360*p/40075017,v=b/Math.cos(Math.PI/180*c.lat);return new Qe(new o.V(c.lng-v,c.lat-b),new o.V(c.lng+v,c.lat+b))}adjustAntiMeridian(){const c=new o.V(this._sw.lng,this._sw.lat),p=new o.V(this._ne.lng,this._ne.lat);return new Qe(c,c.lng>p.lng?new o.V(p.lng+360,p.lat):p)}}class mt{constructor(c,p,b){this.bounds=Qe.convert(this.validateBounds(c)),this.minzoom=p||0,this.maxzoom=b||24}validateBounds(c){return Array.isArray(c)&&c.length===4?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]}contains(c){const p=Math.pow(2,c.z),b=Math.floor(o.Y(this.bounds.getWest())*p),v=Math.floor(o.X(this.bounds.getNorth())*p),S=Math.ceil(o.Y(this.bounds.getEast())*p),P=Math.ceil(o.X(this.bounds.getSouth())*p);return c.x>=b&&c.x<S&&c.y>=v&&c.y<P}}class $t extends o.E{constructor(c,p,b,v){if(super(),this.id=c,this.dispatcher=b,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.U(p,["url","scheme","tileSize","promoteId","encoding"])),this._options=o.e({type:"vector"},p),this._collectResourceTiming=p.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v)}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const c=yield wt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.tileManagers[this.id].clearTiles(),c&&(o.e(this,c),c.bounds&&(this.tileBounds=new mt(c.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})))}catch(c){this._tileJSONRequest=null,this._loaded=!0,o.Z(c)||this.fire(new o.k(c))}})}loaded(){return this._loaded}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}onAdd(c){this.map=c,this.load()}setSourceProperty(c){this._tileJSONRequest&&this._tileJSONRequest.abort(),c(),this.load()}setTiles(c){return this.setSourceProperty(()=>{this._options.tiles=c}),this}setUrl(c){return this.setSourceProperty(()=>{this.url=c,this._options.url=c}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(c){return o._(this,void 0,void 0,function*(){const p=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),b={request:this.map._requestManager.transformRequest(p,"Tile"),uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,encoding:this.encoding,overzoomParameters:this._getOverzoomParameters(c)};b.request.collectResourceTiming=this._collectResourceTiming;let v="RT";if(c.actor&&c.state!=="expired"){if(c.state==="loading")return new Promise((S,P)=>{c.reloadPromise={resolve:S,reject:P}})}else c.actor=this.dispatcher.getActor(),v="LT";c.abortController=new AbortController;try{const S=yield c.actor.sendAsync({type:v,data:b},c.abortController);if(delete c.abortController,c.aborted)return;this._afterTileLoadWorkerResponse(c,S)}catch(S){if(delete c.abortController,c.aborted)return;if(S&&S.status!==404)throw S;this._afterTileLoadWorkerResponse(c,null)}})}_getOverzoomParameters(c){if(c.tileID.canonical.z<=this.maxzoom||this.map._zoomLevelsToOverscale===void 0)return;const p=c.tileID.scaledTo(this.maxzoom).canonical,b=p.url(this.tiles,this.map.getPixelRatio(),this.scheme);return{maxZoomTileID:p,overzoomRequest:this.map._requestManager.transformRequest(b,"Tile")}}_afterTileLoadWorkerResponse(c,p){if(p&&p.resourceTiming&&(c.resourceTiming=p.resourceTiming),p&&this.map._refreshExpiredTiles&&c.setExpiryData(p),c.loadVectorData(p,this.map.painter),c.reloadPromise){const b=c.reloadPromise;c.reloadPromise=null,this.loadTile(c).then(b.resolve).catch(b.reject)}}abortTile(c){return o._(this,void 0,void 0,function*(){c.abortController&&(c.abortController.abort(),delete c.abortController),c.actor&&(yield c.actor.sendAsync({type:"AT",data:{uid:c.uid,type:this.type,source:this.id}}))})}unloadTile(c){return o._(this,void 0,void 0,function*(){c.unloadVectorData(),c.actor&&(yield c.actor.sendAsync({type:"RMT",data:{uid:c.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Dt extends o.E{constructor(c,p,b,v){super(),this.id=c,this.dispatcher=b,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},p),o.e(this,o.U(p,["url","scheme","tileSize"]))}load(){return o._(this,arguments,void 0,function*(c=!1){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const p=yield wt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,p&&(o.e(this,p),p.bounds&&(this.tileBounds=new mt(p.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:c})))}catch(p){this._tileJSONRequest=null,this._loaded=!0,o.Z(p)||this.fire(new o.k(p))}})}loaded(){return this._loaded}onAdd(c){this.map=c,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(c){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),c(),this.load(!0)}setTiles(c){return this.setSourceProperty(()=>{this._options.tiles=c}),this}setUrl(c){return this.setSourceProperty(()=>{this.url=c,this._options.url=c}),this}serialize(){return o.e({},this._options)}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}loadTile(c){return o._(this,void 0,void 0,function*(){const p=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);c.abortController=new AbortController;try{const b=yield _e.getImage(this.map._requestManager.transformRequest(p,"Tile"),c.abortController,this.map._refreshExpiredTiles);if(delete c.abortController,c.aborted)return void(c.state="unloaded");if(b&&b.data){this.map._refreshExpiredTiles&&(b.cacheControl||b.expires)&&c.setExpiryData({cacheControl:b.cacheControl,expires:b.expires});const v=this.map.painter.context,S=v.gl,P=b.data;c.texture=this.map.painter.getTileTexture(P.width),c.texture?c.texture.update(P,{useMipmap:!0}):(c.texture=new o.T(v,P,S.RGBA,{useMipmap:!0}),c.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST)),c.state="loaded"}}catch(b){if(delete c.abortController,c.aborted)c.state="unloaded";else if(b)throw c.state="errored",b}})}abortTile(c){return o._(this,void 0,void 0,function*(){c.abortController&&(c.abortController.abort(),delete c.abortController)})}unloadTile(c){return o._(this,void 0,void 0,function*(){c.texture&&this.map.painter.saveTileTexture(c.texture)})}hasTransition(){return!1}}class Nt extends Dt{constructor(c,p,b,v){super(c,p,b,v),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},p),this.encoding=p.encoding||"mapbox",this.redFactor=p.redFactor,this.greenFactor=p.greenFactor,this.blueFactor=p.blueFactor,this.baseShift=p.baseShift}loadTile(c){return o._(this,void 0,void 0,function*(){const p=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),b=this.map._requestManager.transformRequest(p,"Tile");c.neighboringTiles=this._getNeighboringTiles(c.tileID),c.abortController=new AbortController;try{const v=yield _e.getImage(b,c.abortController,this.map._refreshExpiredTiles);if(delete c.abortController,c.aborted)return void(c.state="unloaded");if(v&&v.data){const S=v.data;this.map._refreshExpiredTiles&&(v.cacheControl||v.expires)&&c.setExpiryData({cacheControl:v.cacheControl,expires:v.expires});const P=o.b(S)&&o.$()?S:yield this.readImageNow(S),R={type:this.type,uid:c.uid,source:this.id,rawImageData:P,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!c.actor||c.state==="expired"){c.actor=this.dispatcher.getActor();const L=yield c.actor.sendAsync({type:"LDT",data:R});c.dem=L,c.needsHillshadePrepare=!0,c.needsTerrainPrepare=!0,c.state="loaded"}}}catch(v){if(delete c.abortController,c.aborted)c.state="unloaded";else if(v)throw c.state="errored",v}})}readImageNow(c){return o._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&o.a0()){const p=c.width+2,b=c.height+2;try{return new o.R({width:p,height:b},yield o.a1(c,-1,-1,p,b))}catch{}}return C.getImageData(c,1)})}_getNeighboringTiles(c){const p=c.canonical,b=Math.pow(2,p.z),v=(p.x-1+b)%b,S=p.x===0?c.wrap-1:c.wrap,P=(p.x+1+b)%b,R=p.x+1===b?c.wrap+1:c.wrap,L={};return L[new o.a2(c.overscaledZ,S,p.z,v,p.y).key]={backfilled:!1},L[new o.a2(c.overscaledZ,R,p.z,P,p.y).key]={backfilled:!1},p.y>0&&(L[new o.a2(c.overscaledZ,S,p.z,v,p.y-1).key]={backfilled:!1},L[new o.a2(c.overscaledZ,c.wrap,p.z,p.x,p.y-1).key]={backfilled:!1},L[new o.a2(c.overscaledZ,R,p.z,P,p.y-1).key]={backfilled:!1}),p.y+1<b&&(L[new o.a2(c.overscaledZ,S,p.z,v,p.y+1).key]={backfilled:!1},L[new o.a2(c.overscaledZ,c.wrap,p.z,p.x,p.y+1).key]={backfilled:!1},L[new o.a2(c.overscaledZ,R,p.z,P,p.y+1).key]={backfilled:!1}),L}unloadTile(c){return o._(this,void 0,void 0,function*(){c.demTexture&&this.map.painter.saveTileTexture(c.demTexture),c.fbo&&(c.fbo.destroy(),delete c.fbo),c.dem&&delete c.dem,delete c.neighboringTiles,c.state="unloaded",c.actor&&(yield c.actor.sendAsync({type:"RDT",data:{type:this.type,uid:c.uid,source:this.id}}))})}}function It(T){return T.type==="GeometryCollection"?T.geometries.map(c=>c.coordinates).flat(1/0):T.coordinates.flat(1/0)}function mr(T){const c=new Qe;let p;switch(T.type){case"FeatureCollection":p=T.features.map(b=>It(b.geometry)).flat(1/0);break;case"Feature":p=It(T.geometry);break;default:p=It(T)}if(p.length==0)return c;for(let b=0;b<p.length-1;b+=2)c.extend([p[b],p[b+1]]);return c}class Qt extends o.E{constructor(c,p,b,v){super(),this.id=c,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:p.data},this.actor=b.getActor(),this.setEventedParent(v),this._data=typeof p.data=="string"?{url:p.data}:{geojson:p.data},this._options=o.e({},p),this._collectResourceTiming=p.collectResourceTiming,p.maxzoom!==void 0&&(this.maxzoom=p.maxzoom),p.type&&(this.type=p.type),p.attribution&&(this.attribution=p.attribution),this.promoteId=p.promoteId,p.clusterMaxZoom!==void 0&&this.maxzoom<=p.clusterMaxZoom&&o.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${p.clusterMaxZoom}".`),this.workerOptions=o.e({source:this.id,cluster:p.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(p.buffer!==void 0?p.buffer:128),tolerance:this._pixelsToTileUnits(p.tolerance!==void 0?p.tolerance:.375),extent:o.a5,maxZoom:this.maxzoom,lineMetrics:p.lineMetrics||!1,generateId:p.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(p.clusterMaxZoom),minPoints:Math.max(2,p.clusterMinPoints||2),extent:o.a5,radius:this._pixelsToTileUnits(p.clusterRadius||50),log:!1,generateId:p.generateId||!1},clusterProperties:p.clusterProperties,filter:p.filter},p.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return this._pendingWorkerUpdate.data!==void 0||this._pendingWorkerUpdate.diff!==void 0||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(c){return c*(o.a5/this.tileSize)}_getClusterMaxZoom(c){const p=c?Math.round(c):this.maxzoom-1;return Number.isInteger(c)||c===void 0||o.w(`Integer expected for option 'clusterMaxZoom': provided value "${c}" rounded to "${p}"`),p}load(){return o._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(c){this.map=c,this.load()}setData(c,p){this._data=typeof c=="string"?{url:c}:{geojson:c},this._pendingWorkerUpdate={data:c};const b=this._updateWorkerData();return p?b:this}updateData(c,p){this._pendingWorkerUpdate.diff=o.a6(this._pendingWorkerUpdate.diff,c);const b=this._updateWorkerData();return p?b:this}getData(){return o._(this,void 0,void 0,function*(){const c=o.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:c})})}getBounds(){return o._(this,void 0,void 0,function*(){return mr(yield this.getData())})}setClusterOptions(c){return this.workerOptions.cluster=c.cluster,c.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(c.clusterRadius)),c.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(c.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(c){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:c,source:this.id}})}getClusterChildren(c){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:c,source:this.id}})}getClusterLeaves(c,p,b){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:c,limit:p,offset:b}})}_updateWorkerData(){return o._(this,void 0,void 0,function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void o.w(`No pending worker updates for GeoJSONSource ${this.id}.`);const{data:c,diff:p}=this._pendingWorkerUpdate,b=o.e({type:this.type},this.workerOptions);c!==void 0?(typeof c=="string"?(b.request=this.map._requestManager.transformRequest(C.resolveURL(c),"Source"),b.request.collectResourceTiming=this._collectResourceTiming):b.data=c,this._pendingWorkerUpdate.data=void 0):p&&(b.dataDiff=p,this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,this._isUpdatingWorker=!0,this.fire(new o.l("dataloading",{dataType:"source"}));try{const v=yield this.actor.sendAsync({type:"LD",data:b});if(this._isUpdatingWorker=!1,this._removed||v.abandoned)return void this.fire(new o.l("dataabort",{dataType:"source"}));v.data&&(this._data={geojson:v.data});const S=this._applyDiffToSource(p),P=this._getShouldReloadTileOptions(S);let R=null;v.resourceTiming&&v.resourceTiming[this.id]&&(R=v.resourceTiming[this.id].slice(0));const L={dataType:"source"};this._collectResourceTiming&&R&&R.length>0&&o.e(L,{resourceTiming:R}),this.fire(new o.l("data",Object.assign(Object.assign({},L),{sourceDataType:"metadata"}))),this.fire(new o.l("data",Object.assign(Object.assign({},L),{sourceDataType:"content",shouldReloadTileOptions:P})))}catch(v){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new o.l("dataabort",{dataType:"source"}));this.fire(new o.k(v))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}})}_applyDiffToSource(c){if(!c)return;const p=typeof this.promoteId=="string"?this.promoteId:void 0;if(!this._data.url&&!this._data.updateable){const v=o.a7(this._data.geojson,p);if(!v)throw new Error(`GeoJSONSource "${this.id}": GeoJSON data is not compatible with updateData`);this._data={updateable:v}}if(!this._data.updateable)return;const b=o.a8(this._data.updateable,c,p);return c.removeAll||this._options.cluster?void 0:b}_getShouldReloadTileOptions(c){if(c)return{affectedBounds:c.filter(Boolean).map(p=>mr(p))}}shouldReloadTile(c,{affectedBounds:p}){if(c.state==="loading")return!0;if(c.state==="unloaded")return!1;const{buffer:b,extent:v}=this.workerOptions.geojsonVtOptions,S=function({x:P,y:R,z:L},F=0){const j=o.a3((P-F)/Math.pow(2,L)),J=o.a4((R+1+F)/Math.pow(2,L)),X=o.a3((P+1+F)/Math.pow(2,L)),Q=o.a4((R-F)/Math.pow(2,L));return new Qe([j,J],[X,Q])}(c.tileID.canonical,b/v);for(const P of p)if(S.intersects(P))return!0;return!1}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(c){return o._(this,void 0,void 0,function*(){const p=c.actor?"RT":"LT";c.actor=this.actor;const b={type:this.type,uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};c.abortController=new AbortController;const v=yield this.actor.sendAsync({type:p,data:b},c.abortController);delete c.abortController,c.unloadVectorData(),c.aborted||c.loadVectorData(v,this.map.painter,p==="RT")})}abortTile(c){return o._(this,void 0,void 0,function*(){c.abortController&&(c.abortController.abort(),delete c.abortController),c.aborted=!0})}unloadTile(c){return o._(this,void 0,void 0,function*(){c.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:c.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data.updateable?{type:"FeatureCollection",features:Array.from(this._data.updateable.values())}:this._data.url||this._data.geojson})}hasTransition(){return!1}}class cr extends o.E{constructor(c,p,b,v){super(),this.flippedWindingOrder=!1,this.id=c,this.dispatcher=b,this.coordinates=p.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(v),this.options=p}load(c){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const p=yield _e.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,p&&p.data&&(this.image=p.data,c&&(this.coordinates=c),this._finishLoading())}catch(p){this._request=null,this._loaded=!0,o.Z(p)||this.fire(new o.k(p))}})}loaded(){return this._loaded}updateImage(c){return c.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=c.url,this.load(c.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(c){this.map=c,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(c){this.coordinates=c;const p=c.map(o.a9.fromLngLat);var b;return this.tileID=function(v){const S=o.aa.fromPoints(v),P=S.width(),R=S.height(),L=Math.max(P,R),F=Math.max(0,Math.floor(-Math.log(L)/Math.LN2)),j=Math.pow(2,F);return new o.ac(F,Math.floor((S.minX+S.maxX)/2*j),Math.floor((S.minY+S.maxY)/2*j))}(p),this.terrainTileRanges=this._getOverlappingTileRanges(p),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=p.map(v=>this.tileID.getTilePoint(v)._round()),this.flippedWindingOrder=((b=this.tileCoords)[1].x-b[0].x)*(b[2].y-b[0].y)-(b[1].y-b[0].y)*(b[2].x-b[0].x)<0,this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const c=this.map.painter.context,p=c.gl;this.texture||(this.texture=new o.T(c,this.image,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE));let b=!1;for(const v in this.tiles){const S=this.tiles[v];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,b=!0)}b&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(c){return o._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={}):c.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(c){const{minX:p,minY:b,maxX:v,maxY:S}=o.aa.fromPoints(c),P={};for(let R=0;R<=o.ab;R++){const L=Math.pow(2,R),F=Math.floor(p*L),j=Math.floor(b*L),J=Math.floor(v*L),X=Math.floor(S*L);P[R]={minTileX:F,minTileY:j,maxTileX:J,maxTileY:X}}return P}}class Fe extends cr{constructor(c,p,b,v){super(c,p,b,v),this.roundZoom=!0,this.type="video",this.options=p}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1;const c=this.options;this.urls=[];for(const p of c.urls)this.urls.push(this.map._requestManager.transformRequest(p,"Source").url);try{const p=yield o.ad(this.urls);if(this._loaded=!0,!p)return;this.video=p,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(p){this.fire(new o.k(p))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(c){if(this.video){const p=this.video.seekable;c<p.start(0)||c>p.end(0)?this.fire(new o.k(new o.ae(`sources.${this.id}`,null,`Playback for this video can be set only between the ${p.start(0)} and ${p.end(0)}-second mark.`))):this.video.currentTime=c}}getVideo(){return this.video}onAdd(c){this.map||(this.map=c,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const c=this.map.painter.context,p=c.gl;this.texture?this.video.paused||(this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE),p.texSubImage2D(p.TEXTURE_2D,0,0,0,p.RGBA,p.UNSIGNED_BYTE,this.video)):(this.texture=new o.T(c,this.video,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE));let b=!1;for(const v in this.tiles){const S=this.tiles[v];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,b=!0)}b&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class re extends cr{constructor(c,p,b,v){super(c,p,b,v),p.coordinates?Array.isArray(p.coordinates)&&p.coordinates.length===4&&!p.coordinates.some(S=>!Array.isArray(S)||S.length!==2||S.some(P=>typeof P!="number"))||this.fire(new o.k(new o.ae(`sources.${c}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.k(new o.ae(`sources.${c}`,null,'missing required property "coordinates"'))),p.animate&&typeof p.animate!="boolean"&&this.fire(new o.k(new o.ae(`sources.${c}`,null,'optional "animate" property must be a boolean value'))),p.canvas?typeof p.canvas=="string"||p.canvas instanceof HTMLCanvasElement||this.fire(new o.k(new o.ae(`sources.${c}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.k(new o.ae(`sources.${c}`,null,'missing required property "canvas"'))),this.options=p,this.animate=p.animate===void 0||p.animate}load(){return o._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(c){this.map=c,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let c=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,c=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,c=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const p=this.map.painter.context,b=p.gl;this.texture?(c||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):(this.texture=new o.T(p,this.canvas,b.RGBA,{premultiply:!0}),this.texture.bind(b.LINEAR,b.CLAMP_TO_EDGE));let v=!1;for(const S in this.tiles){const P=this.tiles[S];P.state!=="loaded"&&(P.state="loaded",P.texture=this.texture,v=!0)}v&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",animate:this.animate,canvas:this.options.canvas,coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const c of[this.canvas.width,this.canvas.height])if(isNaN(c)||c<=0)return!0;return!1}}const ne={},he=T=>{switch(T){case"geojson":return Qt;case"image":return cr;case"raster":return Dt;case"raster-dem":return Nt;case"vector":return $t;case"video":return Fe;case"canvas":return re}return ne[T]},Be="RTLPluginLoaded";class ke extends o.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=nr()}_syncState(c){return this.status=c,this.dispatcher.broadcast("SRPS",{pluginStatus:c,pluginURL:this.url}).catch(p=>{throw this.status="error",p})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(c){return o._(this,arguments,void 0,function*(p,b=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=C.resolveURL(p),!this.url)throw new Error(`requested url ${p} is invalid`);if(this.status==="unavailable"){if(!b)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return o._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new o.l(Be))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Ke=null;function Ge(){return Ke||(Ke=new ke),Ke}var Ue,nt;(function(T){T[T.Base=0]="Base",T[T.Parent=1]="Parent"})(Ue||(Ue={})),function(T){T[T.Departing=0]="Departing",T[T.Incoming=1]="Incoming"}(nt||(nt={}));class vt{constructor(c,p){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=c,this.uid=o.af(),this.uses=0,this.tileSize=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(c){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(c||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:c,fadingDirection:p,fadingParentID:b,fadeEndTime:v}){this.resetFadeLogic(),this.fadingRole=c,this.fadingDirection=p,this.fadingParentID=b,this.fadeEndTime=v}setSelfFadeLogic(c){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=c}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=k(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(c){this.demTexture&&c.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(c,p,b){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",c){c.featureIndex&&(this.latestFeatureIndex=c.featureIndex,c.rawTileData?(this.latestRawTileData=c.rawTileData,this.latestFeatureIndex.rawTileData=c.rawTileData,this.latestFeatureIndex.encoding=c.encoding):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData,this.latestFeatureIndex.encoding=this.latestEncoding)),this.collisionBoxArray=c.collisionBoxArray,this.buckets=function(v,S){const P={};if(!S)return P;for(const R of v){const L=R.layerIds.map(F=>S.getLayer(F)).filter(Boolean);if(L.length!==0){R.layers=L,R.stateDependentLayerIds&&(R.stateDependentLayers=R.stateDependentLayerIds.map(F=>L.filter(j=>j.id===F)[0]));for(const F of L)P[F.id]=R}}return P}(c.buckets,p?.style),this.hasSymbolBuckets=!1;for(const v in this.buckets){const S=this.buckets[v];if(S instanceof o.ah){if(this.hasSymbolBuckets=!0,!b)break;S.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const v in this.buckets){const S=this.buckets[v];if(S instanceof o.ah&&S.hasRTLText){this.hasRTLText=!0,Ge().lazyLoad();break}}this.queryPadding=0;for(const v in this.buckets){const S=this.buckets[v];this.queryPadding=Math.max(this.queryPadding,p.style.getLayer(v).queryRadius(S))}c.imageAtlas&&(this.imageAtlas=c.imageAtlas),c.glyphAtlasImage&&(this.glyphAtlasImage=c.glyphAtlasImage),this.dashPositions=c.dashPositions}else this.collisionBoxArray=new o.ag}unloadVectorData(){for(const c in this.buckets)this.buckets[c].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(c){return this.buckets[c.id]}upload(c){for(const b in this.buckets){const v=this.buckets[b];v.uploadPending()&&v.upload(c)}const p=c.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new o.T(c,this.imageAtlas.image,p.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new o.T(c,this.glyphAtlasImage,p.ALPHA),this.glyphAtlasImage=null)}prepare(c){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(c,this.imageAtlasTexture)}queryRenderedFeatures(c,p,b,v,S,P,R,L,F,j,J){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:v,cameraQueryGeometry:S,scale:P,tileSize:this.tileSize,pixelPosMatrix:j,transform:L,params:R,queryPadding:this.queryPadding*F,getElevation:J},c,p,b):{}}querySourceFeatures(c,p){const b=this.latestFeatureIndex;if(!b||!b.rawTileData)return;const v=b.loadVTLayers(),S=p&&p.sourceLayer?p.sourceLayer:"",P=v[o.ai]||v[S];if(!P)return;const R=o.aj(p?.filter,p?.globalState),{z:L,x:F,y:j}=this.tileID.canonical,J={z:L,x:F,y:j};for(let X=0;X<P.length;X++){const Q=P.feature(X);if(R.needGeometry){const ye=o.ak(Q,!0);if(!R.filter(new o.H(this.tileID.overscaledZ),ye,this.tileID.canonical))continue}else if(!R.filter(new o.H(this.tileID.overscaledZ),Q))continue;const ae=b.getId(Q,S),ge=new o.al(Q,L,F,j,ae);ge.tile=J,c.push(ge)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(c){const p=this.expirationTime;if(c.cacheControl){const b=o.am(c.cacheControl);b["max-age"]&&(this.expirationTime=Date.now()+1e3*b["max-age"])}else c.expires&&(this.expirationTime=new Date(c.expires).getTime());if(this.expirationTime){const b=Date.now();let v=!1;if(this.expirationTime>b)v=!1;else if(p)if(this.expirationTime<p)v=!0;else{const S=this.expirationTime-p;S?this.expirationTime=b+Math.max(S,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(c,p){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(c).length===0)return;const b=this.latestFeatureIndex.loadVTLayers();for(const v in this.buckets){if(!p.style.hasLayer(v))continue;const S=this.buckets[v],P=S.layers[0].sourceLayer||o.ai,R=b[P],L=c[P];if(!R||!L||Object.keys(L).length===0)continue;S.update(L,R,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const F=p&&p.style&&p.style.getLayer(v);F&&(this.queryPadding=Math.max(this.queryPadding,F.queryRadius(S)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<k()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(c){this.symbolFadeHoldUntil=k()+c}setDependencies(c,p){const b={};for(const v of p)b[v]=!0;this.dependencies[c]=b}hasDependency(c,p){for(const b of c){const v=this.dependencies[b];if(v){for(const S of p)if(v[S])return!0}}return!1}}class pt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(c,p,b){const v=String(p);if(this.stateChanges[c]=this.stateChanges[c]||{},this.stateChanges[c][v]=this.stateChanges[c][v]||{},o.e(this.stateChanges[c][v],b),this.deletedStates[c]===null){this.deletedStates[c]={};for(const S in this.state[c])S!==v&&(this.deletedStates[c][S]=null)}else if(this.deletedStates[c]&&this.deletedStates[c][v]===null){this.deletedStates[c][v]={};for(const S in this.state[c][v])b[S]||(this.deletedStates[c][v][S]=null)}else for(const S in b)this.deletedStates[c]&&this.deletedStates[c][v]&&this.deletedStates[c][v][S]===null&&delete this.deletedStates[c][v][S]}removeFeatureState(c,p,b){if(this.deletedStates[c]===null)return;const v=String(p);if(this.deletedStates[c]=this.deletedStates[c]||{},b&&p!==void 0)this.deletedStates[c][v]!==null&&(this.deletedStates[c][v]=this.deletedStates[c][v]||{},this.deletedStates[c][v][b]=null);else if(p!==void 0)if(this.stateChanges[c]&&this.stateChanges[c][v])for(b in this.deletedStates[c][v]={},this.stateChanges[c][v])this.deletedStates[c][v][b]=null;else this.deletedStates[c][v]=null;else this.deletedStates[c]=null}getState(c,p){const b=String(p),v=o.e({},(this.state[c]||{})[b],(this.stateChanges[c]||{})[b]);if(this.deletedStates[c]===null)return{};if(this.deletedStates[c]){const S=this.deletedStates[c][p];if(S===null)return{};for(const P in S)delete v[P]}return v}initializeTileState(c,p){c.setFeatureState(this.state,p)}coalesceChanges(c,p){const b={};for(const v in this.stateChanges){this.state[v]=this.state[v]||{};const S={};for(const P in this.stateChanges[v])this.state[v][P]||(this.state[v][P]={}),o.e(this.state[v][P],this.stateChanges[v][P]),S[P]=this.state[v][P];b[v]=S}for(const v in this.deletedStates){this.state[v]=this.state[v]||{};const S={};if(this.deletedStates[v]===null)for(const P in this.state[v])S[P]={},this.state[v][P]={};else for(const P in this.deletedStates[v]){if(this.deletedStates[v][P]===null)this.state[v][P]={};else for(const R of Object.keys(this.deletedStates[v][P]))delete this.state[v][P][R];S[P]=this.state[v][P]}b[v]=b[v]||{},o.e(b[v],S)}this.stateChanges={},this.deletedStates={},Object.keys(b).length!==0&&c.setFeatureState(b,p)}}const Wt=89.25;function ar(T,c){const p=o.an(c.lat,-o.ao,o.ao);return new o.P(o.Y(c.lng)*T,o.X(p)*T)}function Br(T,c){return new o.a9(c.x/T,c.y/T).toLngLat()}function Cn(T){return T.cameraToCenterDistance*Math.min(.85*Math.tan(o.ap(90-T.pitch)),Math.tan(o.ap(Wt-T.pitch)))}function ln(T,c){const p=T.canonical,b=c/o.aq(p.z),v=p.x+Math.pow(2,p.z)*T.wrap,S=o.ar(new Float64Array(16));return o.O(S,S,[v*b,p.y*b,0]),o.Q(S,S,[b/o.a5,b/o.a5,1]),S}function et(T,c,p,b,v){const S=o.a9.fromLngLat(T,c),P=v*o.as(1,T.lat),{x:R,y:L,z:F}=Tn(p,b);return new o.a9(S.x+P*-R,S.y+P*-L,S.z+P*-F)}function Tn(T,c){const p=o.ap(T),b=o.ap(c),v=Math.cos(-p),S=Math.sin(p);return{x:S*Math.sin(b),y:-S*Math.cos(b),z:v}}function Xi(T,c,p){const b=c.intersectsFrustum(T);if(!p||b===0)return b;const v=c.intersectsPlane(p);return v===0?0:b===2&&v===2?2:1}function Ir(T,c,p){let b=0;const v=(p-c)/10;for(let S=0;S<10;S++)b+=v*Math.pow(Math.cos(c+(S+.5)/10*(p-c)),T);return b}function qr(T,c){return function(p,b,v,S,P){const R=2*((T-1)/o.at(Math.cos(o.ap(Wt-P))/Math.cos(o.ap(Wt)))-1),L=Math.acos(v/S),F=2*Ir(R-1,0,o.ap(P/2)),j=Math.min(o.ap(Wt),L+o.ap(P/2)),J=Ir(R-1,Math.min(j,L-o.ap(P/2)),j),X=Math.atan(b/v),Q=Math.hypot(b,v);let ae=p;return ae+=o.at(S/Q/Math.max(.5,Math.cos(o.ap(P/2)))),ae+=R*o.at(Math.cos(X))/2,ae-=o.at(Math.max(1,J/F/c))/2,ae}}const Ji=qr(9.314,3);function Rn(T,c){const p=(c.roundZoom?Math.round:Math.floor)(T.zoom+o.at(T.tileSize/c.tileSize));return Math.max(0,p)}function nn(T,c){const p=T.getCameraFrustum(),b=T.getClippingPlane(),v=T.screenPointToMercatorCoordinate(T.getCameraPoint()),S=o.a9.fromLngLat(T.center,T.elevation);v.z=S.z+Math.cos(T.pitchInRadians)*T.cameraToCenterDistance/T.worldSize;const P=T.getCoveringTilesDetailsProvider(),R=P.allowVariableZoom(T,c),L=Rn(T,c),F=c.minzoom||0,j=c.maxzoom!==void 0?c.maxzoom:T.maxZoom,J=Math.min(Math.max(0,L),j),X=Math.pow(2,J),Q=[X*v.x,X*v.y,0],ae=[X*S.x,X*S.y,0],ge=Math.hypot(S.x-v.x,S.y-v.y),ye=Math.abs(S.z-v.z),me=Math.hypot(ge,ye),we=Re=>({zoom:0,x:0,y:0,wrap:Re,fullyVisible:!1}),De=[],Ae=[];if(T.renderWorldCopies&&P.allowWorldCopies())for(let Re=1;Re<=3;Re++)De.push(we(-Re)),De.push(we(Re));for(De.push(we(0));De.length>0;){const Re=De.pop(),Le=Re.x,Pe=Re.y;let $e=Re.fullyVisible;const ct={x:Le,y:Pe,z:Re.zoom},tt=P.getTileBoundingVolume(ct,Re.wrap,T.elevation,c);if(!$e){const Lt=Xi(p,tt,b);if(Lt===0)continue;$e=Lt===2}const it=P.distanceToTile2d(v.x,v.y,ct,tt);let st=L;R&&(st=(c.calculateTileZoom||Ji)(T.zoom+o.at(T.tileSize/c.tileSize),it,ye,me,T.fov)),st=(c.roundZoom?Math.round:Math.floor)(st),st=Math.max(0,st);const Ot=Math.min(st,j);if(Re.wrap=P.getWrap(S,ct,Re.wrap),Re.zoom>=Ot){if(Re.zoom<F)continue;const Lt=J-Re.zoom,St=Q[0]-.5-(Le<<Lt),Ht=Q[1]-.5-(Pe<<Lt),Or=c.reparseOverscaled?Math.max(Re.zoom,st):Re.zoom;Ae.push({tileID:new o.a2(Re.zoom===j?Or:Re.zoom,Re.wrap,Re.zoom,Le,Pe),distanceSq:o.au([ae[0]-.5-Le,ae[1]-.5-Pe]),tileDistanceToCamera:Math.sqrt(St*St+Ht*Ht)})}else for(let Lt=0;Lt<4;Lt++)De.push({zoom:Re.zoom+1,x:(Le<<1)+Lt%2,y:(Pe<<1)+(Lt>>1),wrap:Re.wrap,fullyVisible:$e})}return Ae.sort((Re,Le)=>Re.distanceSq-Le.distanceSq).map(Re=>Re.tileID)}const yn=o.aa.fromPoints([new o.P(0,0),new o.P(o.a5,o.a5)]);function ni(T){return T==="raster"||T==="image"||T==="video"}function xl(T,c,p,b,v,S,P){if(!c.hasData())return!1;const{tileID:R,fadingRole:L,fadingDirection:F,fadingParentID:j}=c;if(L===Ue.Base&&F===nt.Incoming&&j)return p[j.key]=j,!0;const J=Math.max(R.overscaledZ-v,S);for(let X=R.overscaledZ-1;X>=J;X--){const Q=R.scaledTo(X),ae=T.getLoadedTile(Q);if(ae)return c.setCrossFadeLogic({fadingRole:Ue.Base,fadingDirection:nt.Incoming,fadingParentID:ae.tileID,fadeEndTime:b+P}),ae.setCrossFadeLogic({fadingRole:Ue.Parent,fadingDirection:nt.Departing,fadeEndTime:b+P}),p[Q.key]=Q,!0}return!1}function oc(T,c,p,b,v,S){if(!c.hasData())return!1;const P=c.tileID.children(v);let R=Rt(T,c,P,p,b,v,S);if(R)return!0;for(const L of P)Rt(T,c,L.children(v),p,b,v,S)&&(R=!0);return R}function Rt(T,c,p,b,v,S,P){if(p[0].overscaledZ>=S)return!1;let R=!1;for(const L of p){const F=T.getLoadedTile(L);if(!F)continue;const{fadingRole:j,fadingDirection:J,fadingParentID:X}=F;j===Ue.Base&&J===nt.Departing&&X||(F.setCrossFadeLogic({fadingRole:Ue.Base,fadingDirection:nt.Departing,fadingParentID:c.tileID,fadeEndTime:v+P}),c.setCrossFadeLogic({fadingRole:Ue.Parent,fadingDirection:nt.Incoming,fadeEndTime:v+P})),b[L.key]=L,R=!0}return R}function ns(T,c,p,b){const v=T.tileID;return!!T.selfFading||!T.hasData()&&!!c.has(v)&&(T.setSelfFadeLogic(p+b),!0)}function is(T,c){var p;T.needsHillshadePrepare=!0,T.needsTerrainPrepare=!0;let b=c.tileID.canonical.x-T.tileID.canonical.x;const v=c.tileID.canonical.y-T.tileID.canonical.y,S=Math.pow(2,T.tileID.canonical.z),P=c.tileID.key;b===0&&v===0||Math.abs(v)>1||(Math.abs(b)>1&&(Math.abs(b+S)===1?b+=S:Math.abs(b-S)===1&&(b-=S)),c.dem&&T.dem&&(T.dem.backfillBorder(c.dem,b,v),!((p=T.neighboringTiles)===null||p===void 0)&&p[P]&&(T.neighboringTiles[P].backfilled=!0)))}class ga{constructor(){this._tiles={}}handleWrapJump(c){const p={};for(const b in this._tiles){const v=this._tiles[b];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+c),p[v.tileID.key]=v}this._tiles=p}setFeatureState(c,p){for(const b in this._tiles)this._tiles[b].setFeatureState(c,p)}getAllTiles(){return Object.values(this._tiles)}getAllIds(c=!1){return c?Object.values(this._tiles).map(p=>p.tileID).sort(o.aw).map(p=>p.key):Object.keys(this._tiles)}getTileById(c){return this._tiles[c]}setTile(c,p){this._tiles[c]=p}deleteTileById(c){delete this._tiles[c]}getLoadedTile(c){const p=this.getTileById(c.key);return p?.hasData()?p:null}isIdRenderable(c,p=!1){var b;return(b=this.getTileById(c))===null||b===void 0?void 0:b.isRenderable(p)}getRenderableIds(c=0,p){const b=[];for(const v of this.getAllIds())this.isIdRenderable(v,p)&&b.push(this.getTileById(v));return p?b.sort((v,S)=>{const P=v.tileID,R=S.tileID,L=new o.P(P.canonical.x,P.canonical.y)._rotate(-c),F=new o.P(R.canonical.x,R.canonical.y)._rotate(-c);return P.overscaledZ-R.overscaledZ||F.y-L.y||F.x-L.x}).map(v=>v.tileID.key):b.map(v=>v.tileID).sort(o.aw).map(v=>v.key)}}class Hs extends o.E{constructor(c,p,b){super(),this.id=c,this.dispatcher=b,this.on("data",v=>this._dataHandler(v)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((v,S,P,R)=>{const L=new(he(S.type))(v,S,P,R);if(L.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${L.id}`);return L})(c,p,b,this),this._inViewTiles=new ga,this._outOfViewCache=new o.ax(0,v=>this._unloadTile(v)),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new pt,this._didEmitContent=!1,this._updated=!1}onAdd(c){this.map=c,this._maxTileCacheSize=c?c._maxTileCacheSize:null,this._maxTileCacheZoomLevels=c?c._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(c)}onRemove(c){for(const p of this._inViewTiles.getAllTiles())p.unloadVectorData();this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(c),this._inViewTiles=new ga}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const c of this._inViewTiles.getAllTiles())if(c.state!=="loaded"&&c.state!=="errored")return!1;return!0}getSource(){return this._source}getState(){return this._state}pause(){this._paused=!0}resume(){if(!this._paused)return;const c=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,c&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(c,p,b){return o._(this,void 0,void 0,function*(){try{yield this._source.loadTile(c),this._tileLoaded(c,p,b)}catch(v){c.state="errored",v.status!==404?this._source.fire(new o.k(v,{tile:c})):this.update(this.transform,this.terrain)}})}_unloadTile(c){this._source.unloadTile&&this._source.unloadTile(c)}_abortTile(c){this._source.abortTile&&this._source.abortTile(c),this._source.fire(new o.l("dataabort",{tile:c,coord:c.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(c){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._inViewTiles,this.map?this.map.painter:null);for(const p of this._inViewTiles.getAllTiles())p.upload(c),p.prepare(this.map.style.imageManager)}getIds(){return this._inViewTiles.getAllIds(!0)}getRenderableIds(c){var p;return this._inViewTiles.getRenderableIds((p=this.transform)===null||p===void 0?void 0:p.bearingInRadians,c)}hasRenderableParent(c){const p=c.overscaledZ-1;if(p>=this._source.minzoom){const b=this.getLoadedTile(c.scaledTo(p));if(b)return this._inViewTiles.isIdRenderable(b.tileID.key)}return!1}reload(c,p=void 0){if(this._paused)this._shouldReloadOnResume=!0;else{this._outOfViewCache.reset();for(const b of this._inViewTiles.getAllIds()){const v=this._inViewTiles.getTileById(b);p&&!this._source.shouldReloadTile(v,p)||(c?this._reloadTile(b,"expired"):v.state!=="errored"&&this._reloadTile(b,"reloading"))}}}_reloadTile(c,p){return o._(this,void 0,void 0,function*(){const b=this._inViewTiles.getTileById(c);b&&(b.state!=="loading"&&(b.state=p),yield this._loadTile(b,c,p))})}_tileLoaded(c,p,b){c.timeAdded=k(),c.selfFading&&(c.fadeEndTime=c.timeAdded+this._rasterFadeDuration),b==="expired"&&(c.refreshedUponExpiration=!0),this._setTileReloadTimer(p,c),this.getSource().type==="raster-dem"&&c.dem&&function(v,S){var P,R;const L=S.getRenderableIds();for(const F of L){if(!v.neighboringTiles||!v.neighboringTiles[F])continue;const j=S.getTileById(F);v.neighboringTiles[F].backfilled||is(v,j),!((R=(P=j.neighboringTiles)===null||P===void 0?void 0:P[v.tileID.key])===null||R===void 0)&&R.backfilled||is(j,v)}}(c,this._inViewTiles),this._state.initializeTileState(c,this.map?this.map.painter:null),c.aborted||this._source.fire(new o.l("data",{dataType:"source",tile:c,coord:c.tileID}))}getTile(c){return this.getTileByID(c.key)}getTileByID(c){return this._inViewTiles.getTileById(c)}_retainLoadedChildren(c,p){const b=this._getLoadedDescendents(p),v=new Set;for(const S of p){const P=b[S.key];if(!P?.length){v.add(S);continue}const R=S.overscaledZ+Hs.maxOverzooming,L=P.filter(J=>J.tileID.overscaledZ<=R);if(!L.length){v.add(S);continue}const F=Math.min(...L.map(J=>J.tileID.overscaledZ)),j=L.filter(J=>J.tileID.overscaledZ===F).map(J=>J.tileID);for(const J of j)c[J.key]=J;this._areDescendentsComplete(j,F,S.overscaledZ)||v.add(S)}return v}_getLoadedDescendents(c){var p;const b={};for(const v of this._inViewTiles.getAllTiles().filter(S=>S.hasData()))for(const S of c)v.tileID.isChildOf(S)&&(b[p=S.key]||(b[p]=[])).push(v);return b}_areDescendentsComplete(c,p,b){return c.length===1&&c[0].isOverscaled()?c[0].overscaledZ===p:Math.pow(4,p-b)===c.length}getLoadedTile(c){return this._inViewTiles.getLoadedTile(c)}updateCacheSize(c){const p=Math.ceil(c.width/this._source.tileSize)+1,b=Math.ceil(c.height/this._source.tileSize)+1,v=Math.floor(p*b*(this._maxTileCacheZoomLevels===null?o.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),S=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,v):v;this._outOfViewCache.setMaxSize(S)}handleWrapJump(c){const p=Math.round((c-(this._prevLng===void 0?c:this._prevLng))/360);this._prevLng=c,p&&(this._inViewTiles.handleWrapJump(p),this._resetTileReloadTimers())}update(c,p){if(!this._sourceLoaded||this._paused)return;let b;this.transform=c,this.terrain=p,this.updateCacheSize(c),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?b=c.getVisibleUnwrappedCoordinates(this._source.tileID).map(L=>new o.a2(L.canonical.z,L.wrap,L.canonical.z,L.canonical.x,L.canonical.y)):(b=nn(c,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.type==="vector"&&this.map._zoomLevelsToOverscale!==void 0?c.maxZoom-this.map._zoomLevelsToOverscale:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:p,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(b=b.filter(L=>this._source.hasTile(L)))):b=[],this.usedForTerrain&&(b=this._addTerrainIdealTiles(b));const v=b.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,v&&this.fire(new o.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const S=Rn(c,this._source),P=this._updateRetainedTiles(b,S),R=ni(this._source.type);R&&this._rasterFadeDuration>0&&!p&&function(L,F,j,J,X,Q,ae){const ge=k(),ye=o.av(F);for(const me of F){const we=L.getTileById(me.key);we.fadingDirection!==nt.Departing&&we.fadeOpacity!==0||we.resetFadeLogic(),xl(L,we,j,ge,J,X,ae)||oc(L,we,j,ge,Q,ae)||ns(we,ye,ge,ae)||we.resetFadeLogic()}}(this._inViewTiles,b,P,this._maxFadingAncestorLevels,this._source.minzoom,this._source.maxzoom,this._rasterFadeDuration),R?this._cleanUpRasterTiles(P):this._cleanUpVectorTiles(P)}_cleanUpRasterTiles(c){for(const p of this._inViewTiles.getAllIds())c[p]||this._removeTile(p)}_cleanUpVectorTiles(c){for(const p of this._inViewTiles.getAllIds()){const b=this._inViewTiles.getTileById(p);c[p]?b.clearSymbolFadeHold():b.hasSymbolBuckets?b.holdingForSymbolFade()?b.symbolFadeFinished()&&this._removeTile(p):b.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(p)}}_addTerrainIdealTiles(c){const p=[];for(const b of c)if(b.canonical.z>this._source.minzoom){const v=b.scaledTo(b.canonical.z-1);p.push(v);const S=b.scaledTo(Math.max(this._source.minzoom,Math.min(b.canonical.z,5)));p.push(S)}return c.concat(p)}releaseSymbolFadeTiles(){for(const c of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(c).holdingForSymbolFade()&&this._removeTile(c)}_updateRetainedTiles(c,p){var b;const v=new Set;for(const F of c)this._addTile(F).hasData()||v.add(F);const S=c.reduce((F,j)=>(F[j.key]=j,F),{}),P=this._retainLoadedChildren(S,v),R={},L=Math.max(p-Hs.maxUnderzooming,this._source.minzoom);for(const F of P){let j=this._inViewTiles.getTileById(F.key),J=j?.wasRequested();for(let X=F.overscaledZ-1;X>=L;--X){const Q=F.scaledTo(X);if(R[Q.key])break;if(R[Q.key]=!0,j=this.getTile(Q),!j&&J&&(j=this._addTile(Q)),j){const ae=j.hasData();if((ae||!(!((b=this.map)===null||b===void 0)&&b.cancelPendingTileRequestsWhileZooming)||J)&&(S[Q.key]=Q),J=j.wasRequested(),ae)break}}}return S}_addTile(c){let p=this._inViewTiles.getTileById(c.key);if(p)return p;p=this._outOfViewCache.getAndRemove(c),p&&(p.resetFadeLogic(),this._setTileReloadTimer(c.key,p),p.tileID=c,this._state.initializeTileState(p,this.map?this.map.painter:null));const b=p;return p||(p=new vt(c,this._source.tileSize*c.overscaleFactor()),this._loadTile(p,c.key,p.state)),p.uses++,this._inViewTiles.setTile(c.key,p),b||this._source.fire(new o.l("dataloading",{tile:p,coord:p.tileID,dataType:"source"})),p}_setTileReloadTimer(c,p){this._clearTileReloadTimer(c);const b=p.getExpiryTimeout();b&&(this._timers[c]=setTimeout(()=>{this._reloadTile(c,"expired"),delete this._timers[c]},b))}_clearTileReloadTimer(c){const p=this._timers[c];p&&(clearTimeout(p),delete this._timers[c])}_resetTileReloadTimers(){for(const c in this._timers)clearTimeout(this._timers[c]),delete this._timers[c];for(const c of this._inViewTiles.getAllIds()){const p=this._inViewTiles.getTileById(c);this._setTileReloadTimer(c,p)}}refreshTiles(c){for(const p of this._inViewTiles.getAllIds()){const b=this._inViewTiles.getTileById(p);(this._inViewTiles.isIdRenderable(p)||b.state=="errored")&&c.some(v=>v.equals(b.tileID.canonical))&&this._reloadTile(p,"expired")}}_removeTile(c){const p=this._inViewTiles.getTileById(c);p&&(p.uses--,this._inViewTiles.deleteTileById(c),this._clearTileReloadTimer(c),p.uses>0||(p.hasData()&&p.state!=="reloading"?this._outOfViewCache.add(p.tileID,p,p.getExpiryTimeout()):(p.aborted=!0,this._abortTile(p),this._unloadTile(p))))}_dataHandler(c){c.dataType==="source"&&(c.sourceDataType!=="metadata"?c.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(c.sourceDataChanged,c.shouldReloadTileOptions),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const c of this._inViewTiles.getAllIds())this._removeTile(c);this._outOfViewCache.reset()}tilesIn(c,p,b){const v=[],S=this.transform;if(!S)return v;const P=S.getCoveringTilesDetailsProvider().allowWorldCopies(),R=b?S.getCameraQueryGeometry(c):c,L=Q=>S.screenPointToMercatorCoordinate(Q,this.terrain),F=this.transformBbox(c,L,!P),j=this.transformBbox(R,L,!P),J=this.getIds(),X=o.aa.fromPoints(j);for(let Q=0;Q<J.length;Q++){const ae=this._inViewTiles.getTileById(J[Q]);if(ae.holdingForSymbolFade())continue;const ge=P?[ae.tileID]:[ae.tileID.unwrapTo(-1),ae.tileID.unwrapTo(0)],ye=Math.pow(2,S.zoom-ae.tileID.overscaledZ),me=p*ae.queryPadding*o.a5/ae.tileSize/ye;for(const we of ge){const De=X.map(Ae=>we.getTilePoint(new o.a9(Ae.x,Ae.y)));if(De.expandBy(me),De.intersects(yn)){const Ae=F.map(Le=>we.getTilePoint(Le)),Re=j.map(Le=>we.getTilePoint(Le));v.push({tile:ae,tileID:P?we:we.unwrapTo(0),queryGeometry:Ae,cameraQueryGeometry:Re,scale:ye})}}}return v}transformBbox(c,p,b){let v=c.map(p);if(b){const S=o.aa.fromPoints(c);S.shrinkBy(.001*Math.min(S.width(),S.height()));const P=S.map(p);o.aa.fromPoints(v).covers(P)||(v=v.map(R=>R.x>.5?new o.a9(R.x-1,R.y,R.z):R))}return v}getVisibleCoordinates(c){const p=this.getRenderableIds(c).map(b=>this._inViewTiles.getTileById(b).tileID);return this.transform&&this.transform.populateCache(p),p}hasTransition(){return!!this._source.hasTransition()||!(!ni(this._source.type)||!function(c,p){if(p<=0)return!1;const b=k();for(const v of c.getAllTiles())if(v.fadeEndTime>=b)return!0;return!1}(this._inViewTiles,this._rasterFadeDuration))}setRasterFadeDuration(c){this._rasterFadeDuration=c}setFeatureState(c,p,b){this._state.updateState(c=c||o.ai,p,b)}removeFeatureState(c,p,b){this._state.removeFeatureState(c=c||o.ai,p,b)}getFeatureState(c,p){return this._state.getState(c=c||o.ai,p)}setDependencies(c,p,b){const v=this._inViewTiles.getTileById(c);v&&v.setDependencies(p,b)}reloadTilesForDependencies(c,p){for(const b of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(b).hasDependency(c,p)&&this._reloadTile(b,"reloading");this._outOfViewCache.filter(b=>!b.hasDependency(c,p))}areTilesLoaded(){for(const c of this._inViewTiles.getAllTiles())if(c.state!=="loaded"&&c.state!=="errored")return!1;return!0}}Hs.maxUnderzooming=10,Hs.maxOverzooming=3;class Kt{constructor(c,p){this.reset(c,p)}reset(c,p){this.points=c||[],this._distances=[0];for(let b=1;b<this.points.length;b++)this._distances[b]=this._distances[b-1]+this.points[b].dist(this.points[b-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(p||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(c){if(this.points.length===1)return this.points[0];c=o.an(c,0,1);let p=1,b=this._distances[p];const v=c*this.paddedLength+this.padding;for(;b<v&&p<this._distances.length;)b=this._distances[++p];const S=p-1,P=this._distances[S],R=b-P,L=R>0?(v-P)/R:0;return this.points[S].mult(1-L).add(this.points[p].mult(L))}}function Nr(T,c){let p=!0;return T==="always"||T!=="never"&&c!=="never"||(p=!1),p}class Dr{constructor(c,p,b){const v=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(c/b),this.yCellCount=Math.ceil(p/b);for(let P=0;P<this.xCellCount*this.yCellCount;P++)v.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=p,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/p,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(c,p,b,v,S){this._forEachCell(p,b,v,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(p),this.bboxes.push(b),this.bboxes.push(v),this.bboxes.push(S)}insertCircle(c,p,b,v){this._forEachCell(p-v,b-v,p+v,b+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(p),this.circles.push(b),this.circles.push(v)}_insertBoxCell(c,p,b,v,S,P){this.boxCells[S].push(P)}_insertCircleCell(c,p,b,v,S,P){this.circleCells[S].push(P)}_query(c,p,b,v,S,P,R){if(b<0||c>this.width||v<0||p>this.height)return[];const L=[];if(c<=0&&p<=0&&this.width<=b&&this.height<=v){if(S)return[{key:null,x1:c,y1:p,x2:b,y2:v}];for(let F=0;F<this.boxKeys.length;F++)L.push({key:this.boxKeys[F],x1:this.bboxes[4*F],y1:this.bboxes[4*F+1],x2:this.bboxes[4*F+2],y2:this.bboxes[4*F+3]});for(let F=0;F<this.circleKeys.length;F++){const j=this.circles[3*F],J=this.circles[3*F+1],X=this.circles[3*F+2];L.push({key:this.circleKeys[F],x1:j-X,y1:J-X,x2:j+X,y2:J+X})}}else this._forEachCell(c,p,b,v,this._queryCell,L,{hitTest:S,overlapMode:P,seenUids:{box:{},circle:{}}},R);return L}query(c,p,b,v){return this._query(c,p,b,v,!1,null)}hitTest(c,p,b,v,S,P){return this._query(c,p,b,v,!0,S,P).length>0}hitTestCircle(c,p,b,v,S){const P=c-b,R=c+b,L=p-b,F=p+b;if(R<0||P>this.width||F<0||L>this.height)return!1;const j=[];return this._forEachCell(P,L,R,F,this._queryCellCircle,j,{hitTest:!0,overlapMode:v,circle:{x:c,y:p,radius:b},seenUids:{box:{},circle:{}}},S),j.length>0}_queryCell(c,p,b,v,S,P,R,L){const{seenUids:F,hitTest:j,overlapMode:J}=R,X=this.boxCells[S];if(X!==null){const ae=this.bboxes;for(const ge of X)if(!F.box[ge]){F.box[ge]=!0;const ye=4*ge,me=this.boxKeys[ge];if(c<=ae[ye+2]&&p<=ae[ye+3]&&b>=ae[ye+0]&&v>=ae[ye+1]&&(!L||L(me))&&(!j||!Nr(J,me.overlapMode))&&(P.push({key:me,x1:ae[ye],y1:ae[ye+1],x2:ae[ye+2],y2:ae[ye+3]}),j))return!0}}const Q=this.circleCells[S];if(Q!==null){const ae=this.circles;for(const ge of Q)if(!F.circle[ge]){F.circle[ge]=!0;const ye=3*ge,me=this.circleKeys[ge];if(this._circleAndRectCollide(ae[ye],ae[ye+1],ae[ye+2],c,p,b,v)&&(!L||L(me))&&(!j||!Nr(J,me.overlapMode))){const we=ae[ye],De=ae[ye+1],Ae=ae[ye+2];if(P.push({key:me,x1:we-Ae,y1:De-Ae,x2:we+Ae,y2:De+Ae}),j)return!0}}}return!1}_queryCellCircle(c,p,b,v,S,P,R,L){const{circle:F,seenUids:j,overlapMode:J}=R,X=this.boxCells[S];if(X!==null){const ae=this.bboxes;for(const ge of X)if(!j.box[ge]){j.box[ge]=!0;const ye=4*ge,me=this.boxKeys[ge];if(this._circleAndRectCollide(F.x,F.y,F.radius,ae[ye+0],ae[ye+1],ae[ye+2],ae[ye+3])&&(!L||L(me))&&!Nr(J,me.overlapMode))return P.push(!0),!0}}const Q=this.circleCells[S];if(Q!==null){const ae=this.circles;for(const ge of Q)if(!j.circle[ge]){j.circle[ge]=!0;const ye=3*ge,me=this.circleKeys[ge];if(this._circlesCollide(ae[ye],ae[ye+1],ae[ye+2],F.x,F.y,F.radius)&&(!L||L(me))&&!Nr(J,me.overlapMode))return P.push(!0),!0}}}_forEachCell(c,p,b,v,S,P,R,L){const F=this._convertToXCellCoord(c),j=this._convertToYCellCoord(p),J=this._convertToXCellCoord(b),X=this._convertToYCellCoord(v);for(let Q=F;Q<=J;Q++)for(let ae=j;ae<=X;ae++)if(S.call(this,c,p,b,v,this.xCellCount*ae+Q,P,R,L))return}_convertToXCellCoord(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))}_convertToYCellCoord(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))}_circlesCollide(c,p,b,v,S,P){const R=v-c,L=S-p,F=b+P;return F*F>R*R+L*L}_circleAndRectCollide(c,p,b,v,S,P,R){const L=(P-v)/2,F=Math.abs(c-(v+L));if(F>L+b)return!1;const j=(R-S)/2,J=Math.abs(p-(S+j));if(J>j+b)return!1;if(F<=L||J<=j)return!0;const X=F-L,Q=J-j;return X*X+Q*Q<=b*b}}function Ws(T,c,p){const b=o.N();if(!T){const{vecSouth:J,vecEast:X}=ma(c),Q=f();Q[0]=X[0],Q[1]=X[1],Q[2]=J[0],Q[3]=J[1],v=Q,(j=(P=(S=Q)[0])*(F=S[3])-(L=S[2])*(R=S[1]))&&(v[0]=F*(j=1/j),v[1]=-R*j,v[2]=-L*j,v[3]=P*j),b[0]=Q[0],b[1]=Q[1],b[4]=Q[2],b[5]=Q[3]}var v,S,P,R,L,F,j;return o.Q(b,b,[1/p,1/p,1]),b}function ih(T,c,p,b){if(T){const v=o.N();if(!c){const{vecSouth:S,vecEast:P}=ma(p);v[0]=P[0],v[1]=P[1],v[4]=S[0],v[5]=S[1]}return o.Q(v,v,[b,b,1]),v}return p.pixelsToClipSpaceMatrix}function ma(T){const c=Math.cos(T.rollInRadians),p=Math.sin(T.rollInRadians),b=Math.cos(T.pitchInRadians),v=Math.cos(T.bearingInRadians),S=Math.sin(T.bearingInRadians),P=o.aC();P[0]=-v*b*p-S*c,P[1]=-S*b*p+v*c;const R=o.aD(P);R<1e-9?o.aE(P):o.aF(P,P,1/R);const L=o.aC();L[0]=v*b*c-S*p,L[1]=S*b*c+v*p;const F=o.aD(L);return F<1e-9?o.aE(L):o.aF(L,L,1/F),{vecEast:L,vecSouth:P}}function Lr(T,c,p,b){let v;b?(v=[T,c,b(T,c),1],o.aH(v,v,p)):(v=[T,c,0,1],de(v,v,p));const S=v[3];return{point:new o.P(v[0]/S,v[1]/S),signedDistanceFromCamera:S,isOccluded:!1}}function Qc(T,c){return .5+T/c*.5}function eu(T,c){return T.x>=-c[0]&&T.x<=c[0]&&T.y>=-c[1]&&T.y<=c[1]}function tu(T,c,p,b,v,S,P,R,L,F,j,J,X){const Q=p?T.textSizeData:T.iconSizeData,ae=o.ay(Q,c.transform.zoom),ge=[256/c.width*2+1,256/c.height*2+1],ye=p?T.text.dynamicLayoutVertexArray:T.icon.dynamicLayoutVertexArray;ye.clear();const me=T.lineVertexArray,we=p?T.text.placedSymbolArray:T.icon.placedSymbolArray,De=c.transform.width/c.transform.height;let Ae=!1;for(let Re=0;Re<we.length;Re++){const Le=we.get(Re);if(Le.hidden||Le.writingMode===o.az.vertical&&!Ae){ie(Le.numGlyphs,ye);continue}Ae=!1;const Pe=new o.P(Le.anchorX,Le.anchorY),$e={getElevation:X,pitchedLabelPlaneMatrix:b,lineVertexArray:me,pitchWithMap:S,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:c.transform,tileAnchorPoint:Pe,unwrappedTileID:L,width:F,height:j,translation:J},ct=Cl(Le.anchorX,Le.anchorY,$e);if(!eu(ct.point,ge)){ie(Le.numGlyphs,ye);continue}const tt=Qc(c.transform.cameraToCenterDistance,ct.signedDistanceFromCamera),it=o.aA(Q,ae,Le),st=S?it*c.transform.getPitchedTextCorrection(Le.anchorX,Le.anchorY,L)/tt:it*tt,Ot=wl({projectionContext:$e,pitchedLabelPlaneMatrixInverse:v,symbol:Le,fontSize:st,flip:!1,keepUpright:P,glyphOffsetArray:T.glyphOffsetArray,dynamicLayoutVertexArray:ye,aspectRatio:De,rotateToLine:R});Ae=Ot.useVertical,(Ot.notEnoughRoom||Ae||Ot.needsFlipping&&wl({projectionContext:$e,pitchedLabelPlaneMatrixInverse:v,symbol:Le,fontSize:st,flip:!0,keepUpright:P,glyphOffsetArray:T.glyphOffsetArray,dynamicLayoutVertexArray:ye,aspectRatio:De,rotateToLine:R}).notEnoughRoom)&&ie(Le.numGlyphs,ye)}p?T.text.dynamicLayoutVertexBuffer.updateData(ye):T.icon.dynamicLayoutVertexBuffer.updateData(ye)}function Ho(T,c,p,b,v,S,P,R){const L=S.glyphStartIndex+S.numGlyphs,F=S.lineStartIndex,j=S.lineStartIndex+S.lineLength,J=c.getoffsetX(S.glyphStartIndex),X=c.getoffsetX(L-1),Q=ao(T*J,p,b,v,S.segment,F,j,R,P);if(!Q)return null;const ae=ao(T*X,p,b,v,S.segment,F,j,R,P);return ae?R.projectionCache.anyProjectionOccluded?null:{first:Q,last:ae}:null}function ac(T,c,p,b){return T===o.az.horizontal&&Math.abs(p.y-c.y)>Math.abs(p.x-c.x)*b?{useVertical:!0}:(T===o.az.vertical?c.y<p.y:c.x>p.x)?{needsFlipping:!0}:null}function wl(T){const{projectionContext:c,pitchedLabelPlaneMatrixInverse:p,symbol:b,fontSize:v,flip:S,keepUpright:P,glyphOffsetArray:R,dynamicLayoutVertexArray:L,aspectRatio:F,rotateToLine:j}=T,J=v/24,X=b.lineOffsetX*J,Q=b.lineOffsetY*J;let ae;if(b.numGlyphs>1){const ge=b.glyphStartIndex+b.numGlyphs,ye=b.lineStartIndex,me=b.lineStartIndex+b.lineLength,we=Ho(J,R,X,Q,S,b,j,c);if(!we)return{notEnoughRoom:!0};const De=cc(we.first.point.x,we.first.point.y,c,p),Ae=cc(we.last.point.x,we.last.point.y,c,p);if(P&&!S){const Re=ac(b.writingMode,De,Ae,F);if(Re)return Re}ae=[we.first];for(let Re=b.glyphStartIndex+1;Re<ge-1;Re++){const Le=ao(J*R.getoffsetX(Re),X,Q,S,b.segment,ye,me,c,j);if(!Le)return{notEnoughRoom:!0};ae.push(Le)}ae.push(we.last)}else{if(P&&!S){const ye=gn(c.tileAnchorPoint.x,c.tileAnchorPoint.y,c).point,me=b.lineStartIndex+b.segment+1,we=new o.P(c.lineVertexArray.getx(me),c.lineVertexArray.gety(me)),De=gn(we.x,we.y,c),Ae=De.signedDistanceFromCamera>0?De.point:lc(c.tileAnchorPoint,we,ye,1,c),Re=cc(ye.x,ye.y,c,p),Le=cc(Ae.x,Ae.y,c,p),Pe=ac(b.writingMode,Re,Le,F);if(Pe)return Pe}const ge=ao(J*R.getoffsetX(b.glyphStartIndex),X,Q,S,b.segment,b.lineStartIndex,b.lineStartIndex+b.lineLength,c,j);if(!ge||c.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};ae=[ge]}for(const ge of ae)o.aG(L,ge.point,ge.angle);return{}}function lc(T,c,p,b,v){const S=T.add(T.sub(c)._unit()),P=gn(S.x,S.y,v).point,R=p.sub(P);return p.add(R._mult(b/R.mag()))}function ss(T,c,p){const b=c.projectionCache;if(b.projections[T])return b.projections[T];const v=new o.P(c.lineVertexArray.getx(T),c.lineVertexArray.gety(T)),S=gn(v.x,v.y,c);if(S.signedDistanceFromCamera>0)return b.projections[T]=S.point,b.anyProjectionOccluded=b.anyProjectionOccluded||S.isOccluded,S.point;const P=T-p.direction;return lc(p.distanceFromAnchor===0?c.tileAnchorPoint:new o.P(c.lineVertexArray.getx(P),c.lineVertexArray.gety(P)),v,p.previousVertex,p.absOffsetX-p.distanceFromAnchor+1,c)}function gn(T,c,p){const b=T+p.translation[0],v=c+p.translation[1];let S;return p.pitchWithMap?(S=Lr(b,v,p.pitchedLabelPlaneMatrix,p.getElevation),S.isOccluded=!1):(S=p.transform.projectTileCoordinates(b,v,p.unwrappedTileID,p.getElevation),S.point.x=(.5*S.point.x+.5)*p.width,S.point.y=(.5*-S.point.y+.5)*p.height),S}function cc(T,c,p,b){if(p.pitchWithMap){const v=[T,c,0,1];return o.aH(v,v,b),p.transform.projectTileCoordinates(v[0]/v[3],v[1]/v[3],p.unwrappedTileID,p.getElevation).point}return{x:T/p.width*2-1,y:1-c/p.height*2}}function Cl(T,c,p){return p.transform.projectTileCoordinates(T,c,p.unwrappedTileID,p.getElevation)}function uc(T,c,p){return T._unit()._perp()._mult(c*p)}function qa(T,c,p,b,v,S,P,R,L){if(R.projectionCache.offsets[T])return R.projectionCache.offsets[T];const F=p.add(c);if(T+L.direction<b||T+L.direction>=v)return R.projectionCache.offsets[T]=F,F;const j=ss(T+L.direction,R,L),J=uc(j.sub(p),P,L.direction),X=p.add(J),Q=j.add(J);return R.projectionCache.offsets[T]=o.aI(S,F,X,Q)||F,R.projectionCache.offsets[T]}function ao(T,c,p,b,v,S,P,R,L){const F=b?T-c:T+c;let j=F>0?1:-1,J=0;b&&(j*=-1,J=Math.PI),j<0&&(J+=Math.PI);let X,Q=j>0?S+v:S+v+1;R.projectionCache.cachedAnchorPoint?X=R.projectionCache.cachedAnchorPoint:(X=gn(R.tileAnchorPoint.x,R.tileAnchorPoint.y,R).point,R.projectionCache.cachedAnchorPoint=X);let ae,ge,ye=X,me=X,we=0,De=0;const Ae=Math.abs(F),Re=[];let Le;for(;we+De<=Ae;){if(Q+=j,Q<S||Q>=P)return null;we+=De,me=ye,ge=ae;const ct={absOffsetX:Ae,direction:j,distanceFromAnchor:we,previousVertex:me};if(ye=ss(Q,R,ct),p===0)Re.push(me),Le=ye.sub(me);else{let tt;const it=ye.sub(me);tt=it.mag()===0?uc(ss(Q+j,R,ct).sub(ye),p,j):uc(it,p,j),ge||(ge=me.add(tt)),ae=qa(Q,tt,ye,S,P,ge,p,R,ct),Re.push(ge),Le=ae.sub(ge)}De=Le.mag()}const Pe=Le._mult((Ae-we)/De)._add(ge||me),$e=J+Math.atan2(ye.y-me.y,ye.x-me.x);return Re.push(Pe),{point:Pe,angle:L?$e:0,path:Re}}const Pp=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ie(T,c){for(let p=0;p<T;p++){const b=c.length;c.resize(b+4),c.float32.set(Pp,3*b)}}function de(T,c,p){const b=c[0],v=c[1];return T[0]=p[0]*b+p[4]*v+p[12],T[1]=p[1]*b+p[5]*v+p[13],T[3]=p[3]*b+p[7]*v+p[15],T}const Ie=100;class je{constructor(c,p=new Dr(c.width+200,c.height+200,25),b=new Dr(c.width+200,c.height+200,25)){this.transform=c,this.grid=p,this.ignoredGrid=b,this.pitchFactor=Math.cos(c.pitch*Math.PI/180)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+Ie,this.screenBottomBoundary=c.height+Ie,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(c,p,b,v,S,P,R,L,F,j,J,X){const Q=this.projectAndGetPerspectiveRatio(c.anchorPointX+L[0],c.anchorPointY+L[1],S,j,X),ae=b*Q.perspectiveRatio;let ge;if(P||R)ge=this._projectCollisionBox(c,ae,v,S,P,R,L,Q,j,J,X);else{const Le=Q.x+(J?J.x*ae:0),Pe=Q.y+(J?J.y*ae:0);ge={allPointsOccluded:!1,box:[Le+c.x1*ae,Pe+c.y1*ae,Le+c.x2*ae,Pe+c.y2*ae]}}const[ye,me,we,De]=ge.box,Ae=P?ge.allPointsOccluded:Q.isOccluded;let Re=Ae;return Re||(Re=Q.perspectiveRatio<this.perspectiveRatioCutoff),Re||(Re=!this.isInsideGrid(ye,me,we,De)),Re||p!=="always"&&this.grid.hitTest(ye,me,we,De,p,F)?{box:[ye,me,we,De],placeable:!1,offscreen:!1,occluded:Ae}:{box:[ye,me,we,De],placeable:!0,offscreen:this.isOffscreen(ye,me,we,De),occluded:Ae}}placeCollisionCircles(c,p,b,v,S,P,R,L,F,j,J,X,Q,ae){const ge=[],ye=new o.P(p.anchorX,p.anchorY),me=this.getPerspectiveRatio(ye.x,ye.y,P,ae),we=(F?S*this.transform.getPitchedTextCorrection(p.anchorX,p.anchorY,P)/me:S*me)/o.aM,De={getElevation:ae,pitchedLabelPlaneMatrix:R,lineVertexArray:b,pitchWithMap:F,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ye,unwrappedTileID:P,width:this.transform.width,height:this.transform.height,translation:Q},Ae=Ho(we,v,p.lineOffsetX*we,p.lineOffsetY*we,!1,p,!1,De);let Re=!1,Le=!1,Pe=!0;if(Ae){const $e=.5*J*me+X,ct=new o.P(-100,-100),tt=new o.P(this.screenRightBoundary,this.screenBottomBoundary),it=new Kt,st=Ae.first,Ot=Ae.last;let Lt=[];for(let Or=st.path.length-1;Or>=1;Or--)Lt.push(st.path[Or]);for(let Or=1;Or<Ot.path.length;Or++)Lt.push(Ot.path[Or]);const St=2.5*$e;if(F){const Or=this.projectPathToScreenSpace(Lt,De);Lt=Or.some(bn=>bn.signedDistanceFromCamera<=0)?[]:Or.map(bn=>bn.point)}let Ht=[];if(Lt.length>0){const Or=Lt[0].clone(),bn=Lt[0].clone();for(let qn=1;qn<Lt.length;qn++)Or.x=Math.min(Or.x,Lt[qn].x),Or.y=Math.min(Or.y,Lt[qn].y),bn.x=Math.max(bn.x,Lt[qn].x),bn.y=Math.max(bn.y,Lt[qn].y);Ht=Or.x>=ct.x&&bn.x<=tt.x&&Or.y>=ct.y&&bn.y<=tt.y?[Lt]:bn.x<ct.x||Or.x>tt.x||bn.y<ct.y||Or.y>tt.y?[]:o.aJ([Lt],ct.x,ct.y,tt.x,tt.y)}for(const Or of Ht){it.reset(Or,.25*$e);let bn=0;bn=it.length<=.5*$e?1:Math.ceil(it.paddedLength/St)+1;for(let qn=0;qn<bn;qn++){const zn=qn/Math.max(bn-1,1),si=it.lerp(zn),Vn=si.x+Ie,bi=si.y+Ie;ge.push(Vn,bi,$e,0);const oi=Vn-$e,as=bi-$e,ki=Vn+$e,Si=bi+$e;if(Pe=Pe&&this.isOffscreen(oi,as,ki,Si),Le=Le||this.isInsideGrid(oi,as,ki,Si),c!=="always"&&this.grid.hitTestCircle(Vn,bi,$e,c,j)&&(Re=!0,!L))return{circles:[],offscreen:!1,collisionDetected:Re}}}}return{circles:!L&&Re||!Le||me<this.perspectiveRatioCutoff?[]:ge,offscreen:Pe,collisionDetected:Re}}projectPathToScreenSpace(c,p){const b=function(v,S){const P=o.N();return o.aB(P,S.pitchedLabelPlaneMatrix),v.map(R=>{const L=Lr(R.x,R.y,P,S.getElevation),F=S.transform.projectTileCoordinates(L.point.x,L.point.y,S.unwrappedTileID,S.getElevation);return F.point.x=(.5*F.point.x+.5)*S.width,F.point.y=(.5*-F.point.y+.5)*S.height,F})}(c,p);return function(v){let S=0,P=0,R=0,L=0;for(let F=0;F<v.length;F++)v[F].isOccluded?(R=F+1,L=0):(L++,L>P&&(P=L,S=R));return v.slice(S,S+P)}(b)}queryRenderedSymbols(c){if(c.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const p=[],b=new o.aa;for(const J of c){const X=new o.P(J.x+Ie,J.y+Ie);b.extend(X),p.push(X)}const{minX:v,minY:S,maxX:P,maxY:R}=b,L=this.grid.query(v,S,P,R).concat(this.ignoredGrid.query(v,S,P,R)),F={},j={};for(const J of L){const X=J.key;if(F[X.bucketInstanceId]===void 0&&(F[X.bucketInstanceId]={}),F[X.bucketInstanceId][X.featureIndex])continue;const Q=[new o.P(J.x1,J.y1),new o.P(J.x2,J.y1),new o.P(J.x2,J.y2),new o.P(J.x1,J.y2)];o.aK(p,Q)&&(F[X.bucketInstanceId][X.featureIndex]=!0,j[X.bucketInstanceId]===void 0&&(j[X.bucketInstanceId]=[]),j[X.bucketInstanceId].push(X.featureIndex))}return j}insertCollisionBox(c,p,b,v,S,P){(b?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:S,collisionGroupID:P,overlapMode:p},c[0],c[1],c[2],c[3])}insertCollisionCircles(c,p,b,v,S,P){const R=b?this.ignoredGrid:this.grid,L={bucketInstanceId:v,featureIndex:S,collisionGroupID:P,overlapMode:p};for(let F=0;F<c.length;F+=4)R.insertCircle(L,c[F],c[F+1],c[F+2])}projectAndGetPerspectiveRatio(c,p,b,v,S){if(S){let P;v?(P=[c,p,v(c,p),1],o.aH(P,P,S)):(P=[c,p,0,1],de(P,P,S));const R=P[3];return{x:(P[0]/R+1)/2*this.transform.width+Ie,y:(-P[1]/R+1)/2*this.transform.height+Ie,perspectiveRatio:.5+this.transform.cameraToCenterDistance/R*.5,isOccluded:!1,signedDistanceFromCamera:R}}{const P=this.transform.projectTileCoordinates(c,p,b,v);return{x:(P.point.x+1)/2*this.transform.width+Ie,y:(1-P.point.y)/2*this.transform.height+Ie,perspectiveRatio:.5+this.transform.cameraToCenterDistance/P.signedDistanceFromCamera*.5,isOccluded:P.isOccluded,signedDistanceFromCamera:P.signedDistanceFromCamera}}}getPerspectiveRatio(c,p,b,v){const S=this.transform.projectTileCoordinates(c,p,b,v);return .5+this.transform.cameraToCenterDistance/S.signedDistanceFromCamera*.5}isOffscreen(c,p,b,v){return b<Ie||c>=this.screenRightBoundary||v<Ie||p>this.screenBottomBoundary}isInsideGrid(c,p,b,v){return b>=0&&c<this.gridRightBoundary&&v>=0&&p<this.gridBottomBoundary}getViewportMatrix(){const c=o.ar([]);return o.O(c,c,[-100,-100,0]),c}_projectCollisionBox(c,p,b,v,S,P,R,L,F,j,J){let X=1,Q=0,ae=0,ge=1;const ye=c.anchorPointX+R[0],me=c.anchorPointY+R[1];if(P&&!S){const Lt=this.projectAndGetPerspectiveRatio(ye+1,me,v,F,J),St=Lt.x-L.x,Ht=Math.atan((Lt.y-L.y)/St)+(St<0?Math.PI:0),Or=Math.sin(Ht),bn=Math.cos(Ht);X=bn,Q=Or,ae=-Or,ge=bn}else if(!P&&S){const Lt=ma(this.transform);X=Lt.vecEast[0],Q=Lt.vecEast[1],ae=Lt.vecSouth[0],ge=Lt.vecSouth[1]}let we=L.x,De=L.y,Ae=p;S&&(we=ye,De=me,Ae=Math.pow(2,-(this.transform.zoom-b.overscaledZ)),Ae*=this.transform.getPitchedTextCorrection(ye,me,v),j||(Ae*=o.an(.5+L.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),j&&(we+=X*j.x*Ae+ae*j.y*Ae,De+=Q*j.x*Ae+ge*j.y*Ae);const Re=c.x1*Ae,Le=c.x2*Ae,Pe=(Re+Le)/2,$e=c.y1*Ae,ct=c.y2*Ae,tt=($e+ct)/2,it=[{offsetX:Re,offsetY:$e},{offsetX:Pe,offsetY:$e},{offsetX:Le,offsetY:$e},{offsetX:Le,offsetY:tt},{offsetX:Le,offsetY:ct},{offsetX:Pe,offsetY:ct},{offsetX:Re,offsetY:ct},{offsetX:Re,offsetY:tt}];let st=[];for(const{offsetX:Lt,offsetY:St}of it)st.push(new o.P(we+X*Lt+ae*St,De+Q*Lt+ge*St));let Ot=!1;if(S){const Lt=st.map(St=>this.projectAndGetPerspectiveRatio(St.x,St.y,v,F,J));Ot=Lt.some(St=>!St.isOccluded),st=Lt.map(St=>new o.P(St.x,St.y))}else Ot=!0;return{box:o.aL(st),allPointsOccluded:!Ot}}}class yt{constructor(c,p,b,v){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?p:-p))):v&&b?1:0,this.placed=b}isHidden(){return this.opacity===0&&!this.placed}}class Pt{constructor(c,p,b,v,S){this.text=new yt(c?c.text:null,p,b,S),this.icon=new yt(c?c.icon:null,p,v,S)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ft{constructor(c,p,b){this.text=c,this.icon=p,this.skipFade=b}}class yr{constructor(c,p,b,v,S){this.bucketInstanceId=c,this.featureIndex=p,this.sourceLayerIndex=b,this.bucketIndex=v,this.tileID=S}}class Mr{constructor(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}}get(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){const p=++this.maxGroupID;this.collisionGroups[c]={ID:p,predicate:b=>b.collisionGroupID===p}}return this.collisionGroups[c]}}function Fr(T,c,p,b,v){const{horizontalAlign:S,verticalAlign:P}=o.aS(T);return new o.P(-(S-.5)*c+b[0]*v,-(P-.5)*p+b[1]*v)}class sn{constructor(c,p,b,v,S){this.transform=c.clone(),this.terrain=p,this.collisionIndex=new je(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=b,this.retainedQueryData={},this.collisionGroups=new Mr(v),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(c){const p=this.terrain;return p?(b,v)=>p.getElevation(c,b,v):null}getBucketParts(c,p,b,v){const S=b.getBucket(p),P=b.latestFeatureIndex;if(!S||!P||p.id!==S.layerIds[0])return;const R=b.collisionBoxArray,L=S.layers[0].layout,F=S.layers[0].paint,j=Math.pow(2,this.transform.zoom-b.tileID.overscaledZ),J=b.tileSize/o.a5,X=b.tileID.toUnwrapped(),Q=L.get("text-rotation-alignment")==="map",ae=o.aN(b,1,this.transform.zoom),ge=o.aO(this.collisionIndex.transform,b,F.get("text-translate"),F.get("text-translate-anchor")),ye=o.aO(this.collisionIndex.transform,b,F.get("icon-translate"),F.get("icon-translate-anchor")),me=Ws(Q,this.transform,ae);this.retainedQueryData[S.bucketInstanceId]=new yr(S.bucketInstanceId,P,S.sourceLayerIndex,S.index,b.tileID);const we={bucket:S,layout:L,translationText:ge,translationIcon:ye,unwrappedTileID:X,pitchedLabelPlaneMatrix:me,scale:j,textPixelRatio:J,holdingForFade:b.holdingForSymbolFade(),collisionBoxArray:R,partiallyEvaluatedTextSize:o.ay(S.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(S.sourceID)};if(v)for(const De of S.sortKeyRanges){const{sortKey:Ae,symbolInstanceStart:Re,symbolInstanceEnd:Le}=De;c.push({sortKey:Ae,symbolInstanceStart:Re,symbolInstanceEnd:Le,parameters:we})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:we})}attemptAnchorPlacement(c,p,b,v,S,P,R,L,F,j,J,X,Q,ae,ge,ye,me,we,De,Ae){const Re=o.aP[c.textAnchor],Le=[c.textOffset0,c.textOffset1],Pe=Fr(Re,b,v,Le,S),$e=this.collisionIndex.placeCollisionBox(p,X,L,F,j,R,P,ye,J.predicate,De,Pe,Ae);if((!we||this.collisionIndex.placeCollisionBox(we,X,L,F,j,R,P,me,J.predicate,De,Pe,Ae).placeable)&&$e.placeable){let ct;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Q.crossTileID]&&this.prevPlacement.placements[Q.crossTileID]&&this.prevPlacement.placements[Q.crossTileID].text&&(ct=this.prevPlacement.variableOffsets[Q.crossTileID].anchor),Q.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Q.crossTileID]={textOffset:Le,width:b,height:v,anchor:Re,textBoxScale:S,prevAnchor:ct},this.markUsedJustification(ae,Re,Q,ge),ae.allowVerticalPlacement&&(this.markUsedOrientation(ae,ge,Q),this.placedOrientations[Q.crossTileID]=ge),{shift:Pe,placedGlyphBoxes:$e}}}placeLayerBucketPart(c,p,b){const{bucket:v,layout:S,translationText:P,translationIcon:R,unwrappedTileID:L,pitchedLabelPlaneMatrix:F,textPixelRatio:j,holdingForFade:J,collisionBoxArray:X,partiallyEvaluatedTextSize:Q,collisionGroup:ae}=c.parameters,ge=S.get("text-optional"),ye=S.get("icon-optional"),me=o.aQ(S,"text-overlap","text-allow-overlap"),we=me==="always",De=o.aQ(S,"icon-overlap","icon-allow-overlap"),Ae=De==="always",Re=S.get("text-rotation-alignment")==="map",Le=S.get("text-pitch-alignment")==="map",Pe=S.get("icon-text-fit")!=="none",$e=S.get("symbol-z-order")==="viewport-y",ct=we&&(Ae||!v.hasIconData()||ye),tt=Ae&&(we||!v.hasTextData()||ge);!v.collisionArrays&&X&&v.deserializeCollisionBoxes(X);const it=this.retainedQueryData[v.bucketInstanceId].tileID,st=this._getTerrainElevationFunc(it),Ot=this.transform.getFastPathSimpleProjectionMatrix(it),Lt=(St,Ht,Or)=>{var bn,qn;if(p[St.crossTileID])return;if(J)return void(this.placements[St.crossTileID]=new Ft(!1,!1,!1));let zn=!1,si=!1,Vn=!0,bi=null,oi={box:null,placeable:!1,offscreen:null,occluded:!1},as={placeable:!1},ki=null,Si=null,Ts=null,Ac=0,Il=0,tl=0;Ht.textFeatureIndex?Ac=Ht.textFeatureIndex:St.useRuntimeCollisionCircles&&(Ac=St.featureIndex),Ht.verticalTextFeatureIndex&&(Il=Ht.verticalTextFeatureIndex);const co=Ht.textBox;if(co){const qo=Hn=>{let $n=o.az.horizontal;if(v.allowVerticalPlacement&&!Hn&&this.prevPlacement){const qi=this.prevPlacement.placedOrientations[St.crossTileID];qi&&(this.placedOrientations[St.crossTileID]=qi,$n=qi,this.markUsedOrientation(v,$n,St))}return $n},rl=(Hn,$n)=>{if(v.allowVerticalPlacement&&St.numVerticalGlyphVertices>0&&Ht.verticalTextBox){for(const qi of v.writingModes)if(qi===o.az.vertical?(oi=$n(),as=oi):oi=Hn(),oi&&oi.placeable)break}else oi=Hn()},wa=St.textAnchorOffsetStartIndex,Ca=St.textAnchorOffsetEndIndex;if(Ca===wa){const Hn=($n,qi)=>{const Yi=this.collisionIndex.placeCollisionBox($n,me,j,it,L,Le,Re,P,ae.predicate,st,void 0,Ot);return Yi&&Yi.placeable&&(this.markUsedOrientation(v,qi,St),this.placedOrientations[St.crossTileID]=qi),Yi};rl(()=>Hn(co,o.az.horizontal),()=>{const $n=Ht.verticalTextBox;return v.allowVerticalPlacement&&St.numVerticalGlyphVertices>0&&$n?Hn($n,o.az.vertical):{box:null,offscreen:null}}),qo(oi&&oi.placeable)}else{let Hn=o.aP[(qn=(bn=this.prevPlacement)===null||bn===void 0?void 0:bn.variableOffsets[St.crossTileID])===null||qn===void 0?void 0:qn.anchor];const $n=(Yi,r1,n1)=>{const vu=Yi.x2-Yi.x1,j2=Yi.y2-Yi.y1,i1=St.textBoxScale,wb=Pe&&De==="never"?r1:null;let xc=null,wc=me==="never"?1:2,Cc="never";Hn&&wc++;for(let Cb=0;Cb<wc;Cb++){for(let Tb=wa;Tb<Ca;Tb++){const hg=v.textAnchorOffsets.get(Tb);if(Hn&&hg.textAnchor!==Hn)continue;const dg=this.attemptAnchorPlacement(hg,Yi,vu,j2,i1,Re,Le,j,it,L,ae,Cc,St,v,n1,P,R,wb,st);if(dg&&(xc=dg.placedGlyphBoxes,xc&&xc.placeable))return zn=!0,bi=dg.shift,xc}Hn?Hn=null:Cc=me}return b&&!xc&&(xc={box:this.collisionIndex.placeCollisionBox(co,"always",j,it,L,Le,Re,P,ae.predicate,st,void 0,Ot).box,offscreen:!1,placeable:!1,occluded:!1}),xc};rl(()=>$n(co,Ht.iconBox,o.az.horizontal),()=>{const Yi=Ht.verticalTextBox;return v.allowVerticalPlacement&&(!oi||!oi.placeable)&&St.numVerticalGlyphVertices>0&&Yi?$n(Yi,Ht.verticalIconBox,o.az.vertical):{box:null,occluded:!0,offscreen:null}}),oi&&(zn=oi.placeable,Vn=oi.offscreen);const qi=qo(oi&&oi.placeable);if(!zn&&this.prevPlacement){const Yi=this.prevPlacement.variableOffsets[St.crossTileID];Yi&&(this.variableOffsets[St.crossTileID]=Yi,this.markUsedJustification(v,Yi.anchor,St,qi))}}}if(ki=oi,zn=ki&&ki.placeable,Vn=ki&&ki.offscreen,St.useRuntimeCollisionCircles&&St.centerJustifiedTextSymbolIndex>=0){const qo=v.text.placedSymbolArray.get(St.centerJustifiedTextSymbolIndex),rl=o.aA(v.textSizeData,Q,qo),wa=S.get("text-padding");Si=this.collisionIndex.placeCollisionCircles(me,qo,v.lineVertexArray,v.glyphOffsetArray,rl,L,F,b,Le,ae.predicate,St.collisionCircleDiameter,wa,P,st),Si.circles.length&&Si.collisionDetected&&!b&&o.w("Collisions detected, but collision boxes are not shown"),zn=we||Si.circles.length>0&&!Si.collisionDetected,Vn=Vn&&Si.offscreen}if(Ht.iconFeatureIndex&&(tl=Ht.iconFeatureIndex),Ht.iconBox){const qo=rl=>this.collisionIndex.placeCollisionBox(rl,De,j,it,L,Le,Re,R,ae.predicate,st,Pe&&bi?bi:void 0,Ot);as&&as.placeable&&Ht.verticalIconBox?(Ts=qo(Ht.verticalIconBox),si=Ts.placeable):(Ts=qo(Ht.iconBox),si=Ts.placeable),Vn=Vn&&Ts.offscreen}const bu=ge||St.numHorizontalGlyphVertices===0&&St.numVerticalGlyphVertices===0,hf=ye||St.numIconVertices===0;bu||hf?hf?bu||(si=si&&zn):zn=si&&zn:si=zn=si&&zn;const _u=si&&Ts.placeable;if(zn&&ki.placeable&&this.collisionIndex.insertCollisionBox(ki.box,me,S.get("text-ignore-placement"),v.bucketInstanceId,as&&as.placeable&&Il?Il:Ac,ae.ID),_u&&this.collisionIndex.insertCollisionBox(Ts.box,De,S.get("icon-ignore-placement"),v.bucketInstanceId,tl,ae.ID),Si&&zn&&this.collisionIndex.insertCollisionCircles(Si.circles,me,S.get("text-ignore-placement"),v.bucketInstanceId,Ac,ae.ID),b&&this.storeCollisionData(v.bucketInstanceId,Or,Ht,ki,Ts,Si),St.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(v.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[St.crossTileID]=new Ft((zn||ct)&&!ki?.occluded,(si||tt)&&!Ts?.occluded,Vn||v.justReloaded),p[St.crossTileID]=!0};if($e){if(c.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const St=v.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Ht=St.length-1;Ht>=0;--Ht){const Or=St[Ht];Lt(v.symbolInstances.get(Or),v.collisionArrays[Or],Or)}}else for(let St=c.symbolInstanceStart;St<c.symbolInstanceEnd;St++)Lt(v.symbolInstances.get(St),v.collisionArrays[St],St);v.justReloaded=!1}storeCollisionData(c,p,b,v,S,P){if(b.textBox||b.iconBox){let R,L;this.collisionBoxArrays.has(c)?R=this.collisionBoxArrays.get(c):(R=new Map,this.collisionBoxArrays.set(c,R)),R.has(p)?L=R.get(p):(L={text:null,icon:null},R.set(p,L)),b.textBox&&(L.text=v.box),b.iconBox&&(L.icon=S.box)}if(P){let R=this.collisionCircleArrays[c];R===void 0&&(R=this.collisionCircleArrays[c]=[]);for(let L=0;L<P.circles.length;L+=4)R.push(P.circles[L+0]-Ie),R.push(P.circles[L+1]-Ie),R.push(P.circles[L+2]),R.push(P.collisionDetected?1:0)}}markUsedJustification(c,p,b,v){let S;S=v===o.az.vertical?b.verticalPlacedTextSymbolIndex:{left:b.leftJustifiedTextSymbolIndex,center:b.centerJustifiedTextSymbolIndex,right:b.rightJustifiedTextSymbolIndex}[o.aR(p)];const P=[b.leftJustifiedTextSymbolIndex,b.centerJustifiedTextSymbolIndex,b.rightJustifiedTextSymbolIndex,b.verticalPlacedTextSymbolIndex];for(const R of P)R>=0&&(c.text.placedSymbolArray.get(R).crossTileID=S>=0&&R!==S?0:b.crossTileID)}markUsedOrientation(c,p,b){const v=p===o.az.horizontal||p===o.az.horizontalOnly?p:0,S=p===o.az.vertical?p:0,P=[b.leftJustifiedTextSymbolIndex,b.centerJustifiedTextSymbolIndex,b.rightJustifiedTextSymbolIndex];for(const R of P)c.text.placedSymbolArray.get(R).placedOrientation=v;b.verticalPlacedTextSymbolIndex&&(c.text.placedSymbolArray.get(b.verticalPlacedTextSymbolIndex).placedOrientation=S)}commit(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;const p=this.prevPlacement;let b=!1;this.prevZoomAdjustment=p?p.zoomAdjustment(this.transform.zoom):0;const v=p?p.symbolFadeChange(c):1,S=p?p.opacities:{},P=p?p.variableOffsets:{},R=p?p.placedOrientations:{};for(const L in this.placements){const F=this.placements[L],j=S[L];j?(this.opacities[L]=new Pt(j,v,F.text,F.icon),b=b||F.text!==j.text.placed||F.icon!==j.icon.placed):(this.opacities[L]=new Pt(null,v,F.text,F.icon,F.skipFade),b=b||F.text||F.icon)}for(const L in S){const F=S[L];if(!this.opacities[L]){const j=new Pt(F,v,!1,!1);j.isHidden()||(this.opacities[L]=j,b=b||F.text.placed||F.icon.placed)}}for(const L in P)this.variableOffsets[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.variableOffsets[L]=P[L]);for(const L in R)this.placedOrientations[L]||!this.opacities[L]||this.opacities[L].isHidden()||(this.placedOrientations[L]=R[L]);if(p&&p.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");b?this.lastPlacementChangeTime=c:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=p?p.lastPlacementChangeTime:c)}updateLayerOpacities(c,p){const b={};for(const v of p){const S=v.getBucket(c);S&&v.latestFeatureIndex&&c.id===S.layerIds[0]&&this.updateBucketOpacities(S,v.tileID,b,v.collisionBoxArray)}}updateBucketOpacities(c,p,b,v){c.hasTextData()&&(c.text.opacityVertexArray.clear(),c.text.hasVisibleVertices=!1),c.hasIconData()&&(c.icon.opacityVertexArray.clear(),c.icon.hasVisibleVertices=!1),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();const S=c.layers[0],P=S.layout,R=new Pt(null,0,!1,!1,!0),L=P.get("text-allow-overlap"),F=P.get("icon-allow-overlap"),j=S._unevaluatedLayout.hasValue("text-variable-anchor")||S._unevaluatedLayout.hasValue("text-variable-anchor-offset"),J=P.get("text-rotation-alignment")==="map",X=P.get("text-pitch-alignment")==="map",Q=P.get("icon-text-fit")!=="none",ae=new Pt(null,0,L&&(F||!c.hasIconData()||P.get("icon-optional")),F&&(L||!c.hasTextData()||P.get("text-optional")),!0);!c.collisionArrays&&v&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(v);const ge=(me,we,De)=>{for(let Ae=0;Ae<we/4;Ae++)me.opacityVertexArray.emplaceBack(De);me.hasVisibleVertices=me.hasVisibleVertices||De!==dc},ye=this.collisionBoxArrays.get(c.bucketInstanceId);for(let me=0;me<c.symbolInstances.length;me++){const we=c.symbolInstances.get(me),{numHorizontalGlyphVertices:De,numVerticalGlyphVertices:Ae,crossTileID:Re}=we;let Le=this.opacities[Re];b[Re]?Le=R:Le||(Le=ae,this.opacities[Re]=Le),b[Re]=!0;const Pe=we.numIconVertices>0,$e=this.placedOrientations[we.crossTileID],ct=$e===o.az.vertical,tt=$e===o.az.horizontal||$e===o.az.horizontalOnly;if(De>0||Ae>0){const st=oh(Le.text);ge(c.text,De,ct?dc:st),ge(c.text,Ae,tt?dc:st);const Ot=Le.text.isHidden();[we.rightJustifiedTextSymbolIndex,we.centerJustifiedTextSymbolIndex,we.leftJustifiedTextSymbolIndex].forEach(Ht=>{Ht>=0&&(c.text.placedSymbolArray.get(Ht).hidden=Ot||ct?1:0)}),we.verticalPlacedTextSymbolIndex>=0&&(c.text.placedSymbolArray.get(we.verticalPlacedTextSymbolIndex).hidden=Ot||tt?1:0);const Lt=this.variableOffsets[we.crossTileID];Lt&&this.markUsedJustification(c,Lt.anchor,we,$e);const St=this.placedOrientations[we.crossTileID];St&&(this.markUsedJustification(c,"left",we,St),this.markUsedOrientation(c,St,we))}if(Pe){const st=oh(Le.icon),Ot=!(Q&&we.verticalPlacedIconSymbolIndex&&ct);we.placedIconSymbolIndex>=0&&(ge(c.icon,we.numIconVertices,Ot?st:dc),c.icon.placedSymbolArray.get(we.placedIconSymbolIndex).hidden=Le.icon.isHidden()),we.verticalPlacedIconSymbolIndex>=0&&(ge(c.icon,we.numVerticalIconVertices,Ot?dc:st),c.icon.placedSymbolArray.get(we.verticalPlacedIconSymbolIndex).hidden=Le.icon.isHidden())}const it=ye&&ye.has(me)?ye.get(me):{text:null,icon:null};if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){const st=c.collisionArrays[me];if(st){let Ot=new o.P(0,0);if(st.textBox||st.verticalTextBox){let Lt=!0;if(j){const St=this.variableOffsets[Re];St?(Ot=Fr(St.anchor,St.width,St.height,St.textOffset,St.textBoxScale),J&&Ot._rotate(X?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Lt=!1}if(st.textBox||st.verticalTextBox){let St;st.textBox&&(St=ct),st.verticalTextBox&&(St=tt),xi(c.textCollisionBox.collisionVertexArray,Le.text.placed,!Lt||St,it.text,Ot.x,Ot.y)}}if(st.iconBox||st.verticalIconBox){const Lt=!!(!tt&&st.verticalIconBox);let St;st.iconBox&&(St=Lt),st.verticalIconBox&&(St=!Lt),xi(c.iconCollisionBox.collisionVertexArray,Le.icon.placed,St,it.icon,Q?Ot.x:0,Q?Ot.y:0)}}}}if(c.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.text.opacityVertexArray.length!==c.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${c.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${c.text.layoutVertexArray.length}) / 4`);if(c.icon.opacityVertexArray.length!==c.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${c.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${c.icon.layoutVertexArray.length}) / 4`);c.bucketInstanceId in this.collisionCircleArrays&&(c.collisionCircleArray=this.collisionCircleArrays[c.bucketInstanceId],delete this.collisionCircleArrays[c.bucketInstanceId])}symbolFadeChange(c){return this.fadeDuration===0?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(c){return Math.max(0,(this.transform.zoom-c)/1.5)}hasTransitions(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(c,p){const b=this.zoomAtLastRecencyCheck===p?1-this.zoomAdjustment(p):1;return this.zoomAtLastRecencyCheck=p,this.commitTime+this.fadeDuration*b>c}setStale(){this.stale=!0}}function xi(T,c,p,b,v,S){b&&b.length!==0||(b=[0,0,0,0]);const P=b[0]-Ie,R=b[1]-Ie,L=b[2]-Ie,F=b[3]-Ie;T.emplaceBack(c?1:0,p?1:0,v||0,S||0,P,R),T.emplaceBack(c?1:0,p?1:0,v||0,S||0,L,R),T.emplaceBack(c?1:0,p?1:0,v||0,S||0,L,F),T.emplaceBack(c?1:0,p?1:0,v||0,S||0,P,F)}const Fi=Math.pow(2,25),Ya=Math.pow(2,24),hc=Math.pow(2,17),ru=Math.pow(2,16),sh=Math.pow(2,9),Bd=Math.pow(2,8),Tl=Math.pow(2,1);function oh(T){if(T.opacity===0&&!T.placed)return 0;if(T.opacity===1&&T.placed)return 4294967295;const c=T.placed?1:0,p=Math.floor(127*T.opacity);return p*Fi+c*Ya+p*hc+c*ru+p*sh+c*Bd+p*Tl+c}const dc=0;class Za{constructor(c){this._sortAcrossTiles=c.layout.get("symbol-z-order")!=="viewport-y"&&!c.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(c,p,b,v,S){const P=this._bucketParts;for(;this._currentTileIndex<c.length;)if(p.getBucketParts(P,v,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort((R,L)=>R.sortKey-L.sortKey));this._currentPartIndex<P.length;)if(p.placeLayerBucketPart(P[this._currentPartIndex],this._seenCrossTileIDs,b),this._currentPartIndex++,S())return!0;return!1}}class fc{constructor(c,p,b,v,S,P,R,L){this.placement=new sn(c,p,P,R,L),this._currentPlacementIndex=b.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(c,p,b){const v=k(),S=()=>!this._forceFullPlacement&&k()-v>2;for(;this._currentPlacementIndex>=0;){const P=p[c[this._currentPlacementIndex]],R=this.placement.collisionIndex.transform.zoom;if(P.type==="symbol"&&(!P.minzoom||P.minzoom<=R)&&(!P.maxzoom||P.maxzoom>R)){if(this._inProgressLayer||(this._inProgressLayer=new Za(P)),this._inProgressLayer.continuePlacement(b[P.source],this.placement,this._showCollisionBoxes,P,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(c){return this.placement.commit(c),this.placement}}const Ur=512/o.a5/2;class Md{constructor(c,p,b){this.tileID=c,this.bucketInstanceId=b,this._symbolsByKey={};const v=new Map;for(let S=0;S<p.length;S++){const P=p.get(S),R=P.key,L=v.get(R);L?L.push(P):v.set(R,[P])}for(const[S,P]of v){const R={positions:P.map(L=>({x:Math.floor(L.anchorX*Ur),y:Math.floor(L.anchorY*Ur)})),crossTileIDs:P.map(L=>L.crossTileID)};if(R.positions.length>128){const L=new o.aT(R.positions.length,16,Uint16Array);for(const{x:F,y:j}of R.positions)L.add(F,j);L.finish(),delete R.positions,R.index=L}this._symbolsByKey[S]=R}}getScaledCoordinates(c,p){const{x:b,y:v,z:S}=this.tileID.canonical,{x:P,y:R,z:L}=p.canonical,F=Ur/Math.pow(2,L-S),j=(R*o.a5+c.anchorY)*F,J=v*o.a5*Ur;return{x:Math.floor((P*o.a5+c.anchorX)*F-b*o.a5*Ur),y:Math.floor(j-J)}}findMatches(c,p,b){const v=this.tileID.canonical.z<p.canonical.z?1:Math.pow(2,this.tileID.canonical.z-p.canonical.z);for(let S=0;S<c.length;S++){const P=c.get(S);if(P.crossTileID)continue;const R=this._symbolsByKey[P.key];if(!R)continue;const L=this.getScaledCoordinates(P,p);if(R.index){const F=R.index.range(L.x-v,L.y-v,L.x+v,L.y+v).sort();for(const j of F){const J=R.crossTileIDs[j];if(!b[J]){b[J]=!0,P.crossTileID=J;break}}}else if(R.positions)for(let F=0;F<R.positions.length;F++){const j=R.positions[F],J=R.crossTileIDs[F];if(Math.abs(j.x-L.x)<=v&&Math.abs(j.y-L.y)<=v&&!b[J]){b[J]=!0,P.crossTileID=J;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:c})=>c)}}class Rd{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ah{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(c){const p=Math.round((c-this.lng)/360);if(p!==0)for(const b in this.indexes){const v=this.indexes[b],S={};for(const P in v){const R=v[P];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+p),S[R.tileID.key]=R}this.indexes[b]=S}this.lng=c}addBucket(c,p,b){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===p.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(let S=0;S<p.symbolInstances.length;S++)p.symbolInstances.get(S).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]={});const v=this.usedCrossTileIDs[c.overscaledZ];for(const S in this.indexes){const P=this.indexes[S];if(Number(S)>c.overscaledZ)for(const R in P){const L=P[R];L.tileID.isChildOf(c)&&L.findMatches(p.symbolInstances,c,v)}else{const R=P[c.scaledTo(Number(S)).key];R&&R.findMatches(p.symbolInstances,c,v)}}for(let S=0;S<p.symbolInstances.length;S++){const P=p.symbolInstances.get(S);P.crossTileID||(P.crossTileID=b.generate(),v[P.crossTileID]=!0)}return this.indexes[c.overscaledZ]===void 0&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new Md(c,p.symbolInstances,p.bucketInstanceId),!0}removeBucketCrossTileIDs(c,p){for(const b of p.getCrossTileIDsLists())for(const v of b)delete this.usedCrossTileIDs[c][v]}removeStaleBuckets(c){let p=!1;for(const b in this.indexes){const v=this.indexes[b];for(const S in v)c[v[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(b,v[S]),delete v[S],p=!0)}return p}}class Cs{constructor(){this.layerIndexes={},this.crossTileIDs=new Rd,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(c,p,b){let v=this.layerIndexes[c.id];v===void 0&&(v=this.layerIndexes[c.id]=new ah);let S=!1;const P={};v.handleWrapJump(b);for(const R of p){const L=R.getBucket(c);L&&c.id===L.layerIds[0]&&(L.bucketInstanceId||(L.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(R.tileID,L,this.crossTileIDs)&&(S=!0),P[L.bucketInstanceId]=!0)}return v.removeStaleBuckets(P)&&(S=!0),S}pruneUnusedLayers(c){const p={};c.forEach(b=>{p[b]=!0});for(const b in this.layerIndexes)p[b]||delete this.layerIndexes[b]}}var pr="void main() {fragColor=vec4(1.0);}";const Zr={prelude:_r(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:_r("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:_r("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:_r(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:_r(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:_r(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:_r(pr,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:_r(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:_r(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:_r("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:_r("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:_r(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:_r("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:_r(pr,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:_r(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:_r(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:_r(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:_r(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:_r(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:_r(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:_r(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:_r(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:_r(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:_r(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:_r(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:_r(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:_r(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:_r(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:_r(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:_r(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:_r(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:_r("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:_r("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:_r("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:_r("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:_r(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:_r("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function _r(T,c){const p=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,b=c.match(/in ([\w]+) ([\w]+)/g),v=T.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=c.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),P=S?S.concat(v):v,R={};return{fragmentSource:T=T.replace(p,(L,F,j,J,X)=>(R[X]=!0,F==="define"?`
#ifndef HAS_UNIFORM_u_${X}
in ${j} ${J} ${X};
#else
uniform ${j} ${J} u_${X};
#endif
`:`
#ifdef HAS_UNIFORM_u_${X}
    ${j} ${J} ${X} = u_${X};
#endif
`)),vertexSource:c=c.replace(p,(L,F,j,J,X)=>{const Q=J==="float"?"vec2":"vec4",ae=X.match(/color/)?"color":Q;return R[X]?F==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
in ${j} ${Q} a_${X};
out ${j} ${J} ${X};
#else
uniform ${j} ${J} u_${X};
#endif
`:ae==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = a_${X};
#else
    ${j} ${J} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = unpack_mix_${ae}(a_${X}, u_${X}_t);
#else
    ${j} ${J} ${X} = u_${X};
#endif
`:F==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
in ${j} ${Q} a_${X};
#else
uniform ${j} ${J} u_${X};
#endif
`:ae==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${j} ${J} ${X} = a_${X};
#else
    ${j} ${J} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${j} ${J} ${X} = unpack_mix_${ae}(a_${X}, u_${X}_t);
#else
    ${j} ${J} ${X} = u_${X};
#endif
`}),staticAttributes:b,staticUniforms:P}}class dn{constructor(c,p,b){this.vertexBuffer=c,this.indexBuffer=p,this.segments=b}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var ya=o.aU([{name:"a_pos",type:"Int16",components:2}]);const Ks="#define PROJECTION_MERCATOR",Io="mercator";class Xs{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Io}get shaderDefine(){return Ks}get shaderPreludeCode(){return Zr.projectionMercator}get vertexShaderPreludeCode(){return Zr.projectionMercator.vertexSource}get subdivisionGranularity(){return o.aV.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(c){}getMeshFromTileID(c,p,b,v,S){if(this._cachedMesh)return this._cachedMesh;const P=new o.aW;P.emplaceBack(0,0),P.emplaceBack(o.a5,0),P.emplaceBack(0,o.a5),P.emplaceBack(o.a5,o.a5);const R=c.createVertexBuffer(P,ya.members),L=o.aX.simpleSegment(0,0,4,2),F=new o.aY;F.emplaceBack(1,0,2),F.emplaceBack(1,2,3);const j=c.createIndexBuffer(F);return this._cachedMesh=new dn(R,j,L),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(c){}}class lh{constructor(c=0,p=0,b=0,v=0){if(isNaN(c)||c<0||isNaN(p)||p<0||isNaN(b)||b<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=p,this.left=b,this.right=v}interpolate(c,p,b){return p.top!=null&&c.top!=null&&(this.top=o.G.number(c.top,p.top,b)),p.bottom!=null&&c.bottom!=null&&(this.bottom=o.G.number(c.bottom,p.bottom,b)),p.left!=null&&c.left!=null&&(this.left=o.G.number(c.left,p.left,b)),p.right!=null&&c.right!=null&&(this.right=o.G.number(c.right,p.right,b)),this}getCenter(c,p){const b=o.an((this.left+c-this.right)/2,0,c),v=o.an((this.top+p-this.bottom)/2,0,p);return new o.P(b,v)}equals(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}clone(){return new lh(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function pc(T,c){if(!T.renderWorldCopies||T.lngRange)return;const p=c.lng-T.center.lng;c.lng+=p>180?-360:p<-180?360:0}function wi(T){return Math.max(0,Math.floor(T))}class nu{constructor(c,p){var b;this.applyConstrain=(v,S)=>this._constrainOverride!==null?this._constrainOverride(v,S):this._callbacks.defaultConstrain(v,S),this._callbacks=c,this._tileSize=512,this._renderWorldCopies=p?.renderWorldCopies===void 0||!!p?.renderWorldCopies,this._minZoom=p?.minZoom||0,this._maxZoom=p?.maxZoom||22,this._minPitch=p?.minPitch==null?0:p?.minPitch,this._maxPitch=p?.maxPitch==null?60:p?.maxPitch,this._constrainOverride=(b=p?.constrainOverride)!==null&&b!==void 0?b:null,this.setMaxBounds(),this._width=0,this._height=0,this._center=new o.V(0,0),this._elevation=0,this._zoom=0,this._tileZoom=wi(this._zoom),this._scale=o.aq(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new lh,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(c,p,b){this._constrainOverride=c.constrainOverride,this._latRange=c.latRange,this._lngRange=c.lngRange,this._width=c.width,this._height=c.height,this._center=c.center,this._elevation=c.elevation,this._minElevationForCurrentTile=c.minElevationForCurrentTile,this._zoom=c.zoom,this._tileZoom=wi(this._zoom),this._scale=o.aq(this._zoom),this._bearingInRadians=c.bearingInRadians,this._fovInRadians=c.fovInRadians,this._pitchInRadians=c.pitchInRadians,this._rollInRadians=c.rollInRadians,this._unmodified=c.unmodified,this._edgeInsets=new lh(c.padding.top,c.padding.bottom,c.padding.left,c.padding.right),this._minZoom=c.minZoom,this._maxZoom=c.maxZoom,this._minPitch=c.minPitch,this._maxPitch=c.maxPitch,this._renderWorldCopies=c.renderWorldCopies,this._cameraToCenterDistance=c.cameraToCenterDistance,this._nearZ=c.nearZ,this._farZ=c.farZ,this._autoCalculateNearFarZ=!b&&c.autoCalculateNearFarZ,p&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(c){this._minElevationForCurrentTile=c}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(c){this._minZoom!==c&&(this._minZoom=c,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(c){this._maxZoom!==c&&(this._maxZoom=c,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(c){this._minPitch!==c&&(this._minPitch=c,this.setPitch(Math.max(this.pitch,c)))}get maxPitch(){return this._maxPitch}setMaxPitch(c){this._maxPitch!==c&&(this._maxPitch=c,this.setPitch(Math.min(this.pitch,c)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c}get constrainOverride(){return this._constrainOverride}setConstrainOverride(c){c===void 0&&(c=null),this._constrainOverride!==c&&(this._constrainOverride=c,this.constrainInternal(),this._calcMatrices())}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(c){const p=o.W(c,-180,180)*Math.PI/180;var b,v,S,P,R,L,F,j,J;this._bearingInRadians!==p&&(this._unmodified=!1,this._bearingInRadians=p,this._calcMatrices(),this._rotationMatrix=f(),b=this._rotationMatrix,S=-this._bearingInRadians,P=(v=this._rotationMatrix)[0],R=v[1],L=v[2],F=v[3],j=Math.sin(S),J=Math.cos(S),b[0]=P*J+L*j,b[1]=R*J+F*j,b[2]=P*-j+L*J,b[3]=R*-j+F*J)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(c){const p=o.an(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==p&&(this._unmodified=!1,this._pitchInRadians=p,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(c){const p=c/180*Math.PI;this._rollInRadians!==p&&(this._unmodified=!1,this._rollInRadians=p,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return o.aZ(this._fovInRadians)}setFov(c){c=o.an(c,.1,150),this.fov!==c&&(this._unmodified=!1,this._fovInRadians=o.ap(c),this._calcMatrices())}get zoom(){return this._zoom}setZoom(c){const p=this.applyConstrain(this._center,c).zoom;this._zoom!==p&&(this._unmodified=!1,this._zoom=p,this._tileZoom=Math.max(0,Math.floor(p)),this._scale=o.aq(p),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(c){c!==this._elevation&&(this._elevation=c,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(c,p){this._autoCalculateNearFarZ=!1,this._nearZ=c,this._farZ=p,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(c){return this._edgeInsets.equals(c)}interpolatePadding(c,p,b){this._unmodified=!1,this._edgeInsets.interpolate(c,p,b),this.constrainInternal(),this._calcMatrices()}resize(c,p,b=!0){this._width=c,this._height=p,b&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Qe([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(c){c?(this._lngRange=[c.getWest(),c.getEast()],this._latRange=[c.getSouth(),c.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-o.ao,o.ao])}getCameraQueryGeometry(c,p){if(p.length===1)return[p[0],c];{const{minX:b,minY:v,maxX:S,maxY:P}=o.aa.fromPoints(p).extend(c);return[new o.P(b,v),new o.P(S,v),new o.P(S,P),new o.P(b,P),new o.P(b,v)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const c=this._unmodified,{center:p,zoom:b}=this.applyConstrain(this.center,this.zoom);this.setCenter(p),this.setZoom(b),this._unmodified=c,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let c=o.ar(new Float64Array(16));o.Q(c,c,[this._width/2,-this._height/2,1]),o.O(c,c,[1,-1,0]),this._clipSpaceToPixelsMatrix=c,c=o.ar(new Float64Array(16)),o.Q(c,c,[1,-1,1]),o.O(c,c,[-1,-1,0]),o.Q(c,c,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=c,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(c,p,b,v){const S=b!==void 0?b:this.bearing,P=v=v!==void 0?v:this.pitch,{distanceToCenter:R,clampedElevation:L}=this._distanceToCenterFromAltElevationPitch(p,this.elevation,P),{x:F,y:j}=Tn(P,S),J=o.a9.fromLngLat(c,p);let X,Q,ae=o.a_(1,J.y),ge=0;do{if(ge+=1,ge>10)break;Q=R/ae,X=new o.a9(J.x+F*Q,J.y+j*Q),ae=1/X.meterInMercatorCoordinateUnits()}while(Math.abs(R-Q*ae)>1e-12);return{center:X.toLngLat(),elevation:L,zoom:o.at(this.height/2/Math.tan(this.fovInRadians/2)/Q/this.tileSize)}}recalculateZoomAndCenter(c){if(this.elevation-c==0)return;const p=1/this.worldSize,b=o.as(1,this.center.lat)*this.worldSize,v=o.a9.fromLngLat(this.center,this.elevation),S=v.x/p,P=v.y/p,R=v.z/p,L=this.pitch,F=this.bearing,{x:j,y:J,z:X}=Tn(L,F),Q=this.cameraToCenterDistance,ae=S+Q*-j,ge=P+Q*-J,ye=R+Q*X,{distanceToCenter:me,clampedElevation:we}=this._distanceToCenterFromAltElevationPitch(ye/b,c,L),De=me*b,Ae=new o.a9((ae+j*De)*p,(ge+J*De)*p,0).toLngLat(),Re=o.as(1,Ae.lat),Le=o.at(this.height/2/Math.tan(this.fovInRadians/2)/me/Re/this.tileSize);this._elevation=we,this._center=Ae,this.setZoom(Le)}_distanceToCenterFromAltElevationPitch(c,p,b){const v=-Math.cos(o.ap(b)),S=c-p;let P,R=p;return v*S>=0||Math.abs(v)<.1?(P=1e4,R=c+P*v):P=-S/v,{distanceToCenter:P,clampedElevation:R}}getCameraPoint(){const c=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(c*Math.sin(this.rollInRadians),c*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const c=o.as(1,this.center.lat)*this.worldSize;return et(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/c).toLngLat()}getMercatorTileCoordinates(c){if(!c)return[0,0,1,1];const p=c.canonical.z>=0?1<<c.canonical.z:Math.pow(2,c.canonical.z);return[c.canonical.x/p,c.canonical.y/p,1/p/o.a5,1/p/o.a5]}}class Qa{constructor(c,p){this.min=c,this.max=p,this.center=o.a$([],o.b0([],this.min,this.max),.5)}quadrant(c){const p=[c%2==0,c<2],b=o.b1(this.min),v=o.b1(this.max);for(let S=0;S<p.length;S++)b[S]=p[S]?this.min[S]:this.center[S],v[S]=p[S]?this.center[S]:this.max[S];return v[2]=this.max[2],new Qa(b,v)}distanceX(c){return Math.max(Math.min(this.max[0],c[0]),this.min[0])-c[0]}distanceY(c){return Math.max(Math.min(this.max[1],c[1]),this.min[1])-c[1]}intersectsFrustum(c){let p=!0;for(let b=0;b<c.planes.length;b++){const v=this.intersectsPlane(c.planes[b]);if(v===0)return 0;v===1&&(p=!1)}return p?2:c.aabb.min[0]>this.max[0]||c.aabb.min[1]>this.max[1]||c.aabb.min[2]>this.max[2]||c.aabb.max[0]<this.min[0]||c.aabb.max[1]<this.min[1]||c.aabb.max[2]<this.min[2]?0:1}intersectsPlane(c){let p=c[3],b=c[3];for(let v=0;v<3;v++)c[v]>0?(p+=c[v]*this.min[v],b+=c[v]*this.max[v]):(b+=c[v]*this.min[v],p+=c[v]*this.max[v]);return p>=0?2:b<0?0:1}}class Bp{distanceToTile2d(c,p,b,v){const S=v.distanceX([c,p]),P=v.distanceY([c,p]);return Math.hypot(S,P)}getWrap(c,p,b){return b}getTileBoundingVolume(c,p,b,v){var S,P;let R=0,L=0;if(v?.terrain){const j=new o.a2(c.z,p,c.z,c.x,c.y),J=v.terrain.getMinMaxElevation(j);R=(S=J.minElevation)!==null&&S!==void 0?S:Math.min(0,b),L=(P=J.maxElevation)!==null&&P!==void 0?P:Math.max(0,b)}const F=1<<c.z;return new Qa([p+c.x/F,c.y/F,R],[p+(c.x+1)/F,(c.y+1)/F,L])}allowVariableZoom(c,p){const b=c.fov*(Math.abs(Math.cos(c.rollInRadians))*c.height+Math.abs(Math.sin(c.rollInRadians))*c.width)/c.height,v=o.an(78.5-b/2,0,60);return!!p.terrain||c.pitch>v}allowWorldCopies(){return!0}prepareNextFrame(){}}class lo{constructor(c,p,b){this.points=c,this.planes=p,this.aabb=b}static fromInvProjectionMatrix(c,p=1,b=0,v,S){const P=S?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],R=Math.pow(2,b),L=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(X=>function(Q,ae,ge,ye){const me=o.aH([],Q,ae),we=1/me[3]/ge*ye;return o.b6(me,me,[we,we,1/me[3],we])}(X,c,p,R));v&&function(X,Q,ae,ge){const ye=ge?4:0,me=ge?0:4;let we=0;const De=[],Ae=[];for(let Pe=0;Pe<4;Pe++){const $e=o.b2([],X[Pe+me],X[Pe+ye]),ct=o.b7($e);o.a$($e,$e,1/ct),De.push(ct),Ae.push($e)}for(let Pe=0;Pe<4;Pe++){const $e=o.b8(X[Pe+ye],Ae[Pe],ae);we=$e!==null&&$e>=0?Math.max(we,$e):Math.max(we,De[Pe])}const Re=function(Pe,$e){const ct=o.b2([],Pe[$e[0]],Pe[$e[1]]),tt=o.b2([],Pe[$e[2]],Pe[$e[1]]),it=[0,0,0,0];return o.b3(it,o.b4([],ct,tt)),it[3]=-o.b5(it,Pe[$e[0]]),it}(X,Q),Le=function(Pe,$e){const ct=o.b9(Pe),tt=o.ba([],Pe,1/ct),it=o.b2([],$e,o.a$([],tt,o.b5($e,tt))),st=o.b9(it);if(st>0){const Ot=Math.sqrt(1-tt[3]*tt[3]),Lt=o.a$([],tt,-tt[3]),St=o.b0([],Lt,o.a$([],it,Ot/st));return o.bb($e,St)}return null}(ae,Re);if(Le!==null){const Pe=Le/o.b5(Ae[0],Re);we=Math.min(we,Pe)}for(let Pe=0;Pe<4;Pe++){const $e=Math.min(we,De[Pe]);X[Pe+me]=[X[Pe+ye][0]+Ae[Pe][0]*$e,X[Pe+ye][1]+Ae[Pe][1]*$e,X[Pe+ye][2]+Ae[Pe][2]*$e,1]}}(L,P[0],v,S);const F=P.map(X=>{const Q=o.b2([],L[X[0]],L[X[1]]),ae=o.b2([],L[X[2]],L[X[1]]),ge=o.b3([],o.b4([],Q,ae)),ye=-o.b5(ge,L[X[1]]);return ge.concat(ye)}),j=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],J=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const X of L)for(let Q=0;Q<3;Q++)j[Q]=Math.min(j[Q],X[Q]),J[Q]=Math.max(J[Q],X[Q]);return new lo(L,F,new Qa(j,J))}}class iu{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(c){this._helper.setMinZoom(c)}setMaxZoom(c){this._helper.setMaxZoom(c)}setMinPitch(c){this._helper.setMinPitch(c)}setMaxPitch(c){this._helper.setMaxPitch(c)}setRenderWorldCopies(c){this._helper.setRenderWorldCopies(c)}setBearing(c){this._helper.setBearing(c)}setPitch(c){this._helper.setPitch(c)}setRoll(c){this._helper.setRoll(c)}setFov(c){this._helper.setFov(c)}setZoom(c){this._helper.setZoom(c)}setCenter(c){this._helper.setCenter(c)}setElevation(c){this._helper.setElevation(c)}setMinElevationForCurrentTile(c){this._helper.setMinElevationForCurrentTile(c)}setPadding(c){this._helper.setPadding(c)}interpolatePadding(c,p,b){return this._helper.interpolatePadding(c,p,b)}isPaddingEqual(c){return this._helper.isPaddingEqual(c)}resize(c,p,b=!0){this._helper.resize(c,p,b)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(c){this._helper.setMaxBounds(c)}setConstrainOverride(c){this._helper.setConstrainOverride(c)}overrideNearFarZ(c,p){this._helper.overrideNearFarZ(c,p)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(c){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),c)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(c,p){}constructor(c){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(p,b)=>{b=o.an(+b,this.minZoom,this.maxZoom);const v={center:new o.V(p.lng,p.lat),zoom:b};let S=this._helper._lngRange;if(!this._helper._renderWorldCopies&&S===null){const Ae=179.9999999999;S=[-Ae,Ae]}const P=this.tileSize*o.aq(v.zoom);let R=0,L=P,F=0,j=P,J=0,X=0;const{x:Q,y:ae}=this.size;if(this._helper._latRange){const Ae=this._helper._latRange;R=o.X(Ae[1])*P,L=o.X(Ae[0])*P,L-R<ae&&(J=ae/(L-R))}S&&(F=o.W(o.Y(S[0])*P,0,P),j=o.W(o.Y(S[1])*P,0,P),j<F&&(j+=P),j-F<Q&&(X=Q/(j-F)));const{x:ge,y:ye}=ar(P,p);let me,we;const De=Math.max(X||0,J||0);if(De){const Ae=new o.P(X?(j+F)/2:ge,J?(L+R)/2:ye);return v.center=Br(P,Ae).wrap(),v.zoom+=o.at(De),v}if(this._helper._latRange){const Ae=ae/2;ye-Ae<R&&(we=R+Ae),ye+Ae>L&&(we=L-Ae)}if(S){const Ae=(F+j)/2;let Re=ge;this._helper._renderWorldCopies&&(Re=o.W(ge,Ae-P/2,Ae+P/2));const Le=Q/2;Re-Le<F&&(me=F+Le),Re+Le>j&&(me=j-Le)}if(me!==void 0||we!==void 0){const Ae=new o.P(me??ge,we??ye);v.center=Br(P,Ae).wrap()}return v},this.applyConstrain=(p,b)=>this._helper.applyConstrain(p,b),this._helper=new nu({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(p,b)=>this.defaultConstrain(p,b)},c),this._coveringTilesDetailsProvider=new Bp}clone(){const c=new iu;return c.apply(this),c}apply(c,p,b){this._helper.apply(c,p,b)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(c){const p=[new o.bc(0,c)];if(this._helper._renderWorldCopies){const b=this.screenPointToMercatorCoordinate(new o.P(0,0)),v=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,0)),S=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,this._helper._height)),P=this.screenPointToMercatorCoordinate(new o.P(0,this._helper._height)),R=Math.floor(Math.min(b.x,v.x,S.x,P.x)),L=Math.floor(Math.max(b.x,v.x,S.x,P.x)),F=1;for(let j=R-F;j<=L+F;j++)j!==0&&p.push(new o.bc(j,c))}return p}getCameraFrustum(){return lo.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(c){const p=this.screenPointToLocation(this.centerPoint,c),b=c?c.getElevationForLngLatZoom(p,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(b)}setLocationAtPoint(c,p){const b=o.as(this.elevation,this.center.lat),v=this.screenPointToMercatorCoordinateAtZ(p,b),S=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,b),P=o.a9.fromLngLat(c),R=new o.a9(P.x-(v.x-S.x),P.y-(v.y-S.y));this.setCenter(R?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(c,p){return p?this.coordinatePoint(o.a9.fromLngLat(c),p.getElevationForLngLat(c,this),this._pixelMatrix3D):this.coordinatePoint(o.a9.fromLngLat(c))}screenPointToLocation(c,p){var b;return(b=this.screenPointToMercatorCoordinate(c,p))===null||b===void 0?void 0:b.toLngLat()}screenPointToMercatorCoordinate(c,p){if(p){const b=p.pointCoordinate(c);if(b!=null)return b}return this.screenPointToMercatorCoordinateAtZ(c)}screenPointToMercatorCoordinateAtZ(c,p){const b=p||0,v=[c.x,c.y,0,1],S=[c.x,c.y,1,1];o.aH(v,v,this._pixelMatrixInverse),o.aH(S,S,this._pixelMatrixInverse);const P=v[3],R=S[3],L=v[1]/P,F=S[1]/R,j=v[2]/P,J=S[2]/R,X=j===J?0:(b-j)/(J-j);return new o.a9(o.G.number(v[0]/P,S[0]/R,X)/this.worldSize,o.G.number(L,F,X)/this.worldSize,b)}coordinatePoint(c,p=0,b=this._pixelMatrix){const v=[c.x*this.worldSize,c.y*this.worldSize,p,1];return o.aH(v,v,b),new o.P(v[0]/v[3],v[1]/v[3])}getBounds(){const c=Math.max(0,this._helper._height/2-Cn(this));return new Qe().extend(this.screenPointToLocation(new o.P(0,c))).extend(this.screenPointToLocation(new o.P(this._helper._width,c))).extend(this.screenPointToLocation(new o.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new o.P(0,this._helper._height)))}isPointOnMapSurface(c,p){return p?p.pointCoordinate(c)!=null:c.y>this.height/2-Cn(this)}calculatePosMatrix(c,p=!1,b){var v;const S=(v=c.key)!==null&&v!==void 0?v:o.bd(c.wrap,c.canonical.z,c.canonical.z,c.canonical.x,c.canonical.y),P=p?this._alignedPosMatrixCache:this._posMatrixCache;if(P.has(S)){const F=P.get(S);return b?F.f32:F.f64}const R=ln(c,this.worldSize);o.S(R,p?this._alignedProjMatrix:this._viewProjMatrix,R);const L={f64:R,f32:new Float32Array(R)};return P.set(S,L),b?L.f32:L.f64}calculateFogMatrix(c){const p=c.key,b=this._fogMatrixCacheF32;if(b.has(p))return b.get(p);const v=ln(c,this.worldSize);return o.S(v,this._fogMatrix,v),b.set(p,new Float32Array(v)),b.get(p)}calculateCenterFromCameraLngLatAlt(c,p,b,v){return this._helper.calculateCenterFromCameraLngLatAlt(c,p,b,v)}_calculateNearFarZIfNeeded(c,p,b){if(!this._helper.autoCalculateNearFarZ)return;const v=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),S=c-v*this._helper._pixelPerMeter/Math.cos(p),P=v<0?S:c,R=Math.PI/2+this.pitchInRadians,L=o.ap(this.fov)*(Math.abs(Math.cos(o.ap(this.roll)))*this.height+Math.abs(Math.sin(o.ap(this.roll)))*this.width)/this.height*(.5+b.y/this.height),F=Math.sin(L)*P/Math.sin(o.an(Math.PI-R-L,.01,Math.PI-.01)),j=Cn(this),J=Math.atan(j/this._helper.cameraToCenterDistance),X=o.ap(.75),Q=J>X?2*J*(.5+b.y/(2*j)):X,ae=Math.sin(Q)*P/Math.sin(o.an(Math.PI-R-Q,.01,Math.PI-.01)),ge=Math.min(F,ae);this._helper._farZ=1.01*(Math.cos(Math.PI/2-p)*ge+P),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const c=this.centerOffset,p=ar(this.worldSize,this.center),b=p.x,v=p.y;this._helper._pixelPerMeter=o.as(1,this.center.lat)*this.worldSize;const S=o.ap(Math.min(this.pitch,Wt)),P=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(S));let R;this._calculateNearFarZIfNeeded(P,S,c),R=new Float64Array(16),o.be(R,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),o.aB(this._invProjMatrix,R),R[8]=2*-c.x/this._helper._width,R[9]=2*c.y/this._helper._height,this._projectionMatrix=o.bf(R),o.Q(R,R,[1,-1,1]),o.O(R,R,[0,0,-this._helper.cameraToCenterDistance]),o.bg(R,R,-this.rollInRadians),o.bh(R,R,this.pitchInRadians),o.bg(R,R,-this.bearingInRadians),o.O(R,R,[-b,-v,0]),this._mercatorMatrix=o.Q([],R,[this.worldSize,this.worldSize,this.worldSize]),o.Q(R,R,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=o.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,R),o.O(R,R,[0,0,-this.elevation]),this._viewProjMatrix=R,this._invViewProjMatrix=o.aB([],R);const L=[0,0,-1,1];o.aH(L,L,this._invViewProjMatrix),this._cameraPosition=[L[0]/L[3],L[1]/L[3],L[2]/L[3]],this._fogMatrix=new Float64Array(16),o.be(this._fogMatrix,this.fovInRadians,this.width/this.height,P,this._helper._farZ),this._fogMatrix[8]=2*-c.x/this.width,this._fogMatrix[9]=2*c.y/this.height,o.Q(this._fogMatrix,this._fogMatrix,[1,-1,1]),o.O(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),o.bg(this._fogMatrix,this._fogMatrix,-this.rollInRadians),o.bh(this._fogMatrix,this._fogMatrix,this.pitchInRadians),o.bg(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),o.O(this._fogMatrix,this._fogMatrix,[-b,-v,0]),o.Q(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),o.O(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=o.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,R);const F=this._helper._width%2/2,j=this._helper._height%2/2,J=Math.cos(this.bearingInRadians),X=Math.sin(-this.bearingInRadians),Q=b-Math.round(b)+J*F+X*j,ae=v-Math.round(v)+J*j+X*F,ge=new Float64Array(R);if(o.O(ge,ge,[Q>.5?Q-1:Q,ae>.5?ae-1:ae,0]),this._alignedProjMatrix=ge,R=o.aB(new Float64Array(16),this._pixelMatrix),!R)throw new Error("failed to invert matrix");this._pixelMatrixInverse=R,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const c=this.screenPointToMercatorCoordinate(new o.P(0,0)),p=[c.x*this.worldSize,c.y*this.worldSize,0,1];return o.aH(p,p,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const c=o.as(1,this.center.lat)*this.worldSize;return et(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/c).toLngLat()}lngLatToCameraDepth(c,p){const b=o.a9.fromLngLat(c),v=[b.x*this.worldSize,b.y*this.worldSize,p,1];return o.aH(v,v,this._viewProjMatrix),v[2]/v[3]}getProjectionData(c){const{overscaledTileID:p,aligned:b,applyTerrainMatrix:v}=c,S=this._helper.getMercatorTileCoordinates(p),P=p?this.calculatePosMatrix(p,b,!0):null;let R;return R=p&&p.terrainRttPosMatrix32f&&v?p.terrainRttPosMatrix32f:P||o.bi(),{mainMatrix:R,tileMercatorCoords:S,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:R}}isLocationOccluded(c){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(c,p,b){return 1}transformLightDirection(c){return o.b1(c)}getRayDirectionFromPixel(c){throw new Error("Not implemented.")}projectTileCoordinates(c,p,b,v){const S=this.calculatePosMatrix(b);let P;v?(P=[c,p,v(c,p),1],o.aH(P,P,S)):(P=[c,p,0,1],de(P,P,S));const R=P[3];return{point:new o.P(P[0]/R,P[1]/R),signedDistanceFromCamera:R,isOccluded:!1}}populateCache(c){for(const p of c)this.calculatePosMatrix(p)}getMatrixForModel(c,p){const b=o.a9.fromLngLat(c,p),v=b.meterInMercatorCoordinateUnits(),S=o.bj();return o.O(S,S,[b.x,b.y,b.z]),o.bg(S,S,Math.PI),o.bh(S,S,Math.PI/2),o.Q(S,S,[-v,v,v]),S}getProjectionDataForCustomLayer(c=!0){const p=new o.a2(0,0,0,0,0),b=this.getProjectionData({overscaledTileID:p,applyGlobeMatrix:c}),v=ln(p,this.worldSize);o.S(v,this._viewProjMatrix,v),b.tileMercatorCoords=[0,0,1,1];const S=[o.a5,o.a5,this.worldSize/this._helper.pixelsPerMeter],P=o.bk();return o.Q(P,v,S),b.fallbackMatrix=P,b.mainMatrix=P,b}getFastPathSimpleProjectionMatrix(c){return this.calculatePosMatrix(c)}}function Sl(){o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function cA(T){if(T.useSlerp)if(T.k<1){const c=o.bl(T.startEulerAngles.roll,T.startEulerAngles.pitch,T.startEulerAngles.bearing),p=o.bl(T.endEulerAngles.roll,T.endEulerAngles.pitch,T.endEulerAngles.bearing),b=new Float64Array(4);o.bm(b,c,p,T.k);const v=o.bn(b);T.tr.setRoll(v.roll),T.tr.setPitch(v.pitch),T.tr.setBearing(v.bearing)}else T.tr.setRoll(T.endEulerAngles.roll),T.tr.setPitch(T.endEulerAngles.pitch),T.tr.setBearing(T.endEulerAngles.bearing);else T.tr.setRoll(o.G.number(T.startEulerAngles.roll,T.endEulerAngles.roll,T.k)),T.tr.setPitch(o.G.number(T.startEulerAngles.pitch,T.endEulerAngles.pitch,T.k)),T.tr.setBearing(o.G.number(T.startEulerAngles.bearing,T.endEulerAngles.bearing,T.k))}function Ly(T,c,p,b,v){const S=v.padding,P=ar(v.worldSize,p.getNorthWest()),R=ar(v.worldSize,p.getNorthEast()),L=ar(v.worldSize,p.getSouthEast()),F=ar(v.worldSize,p.getSouthWest()),j=o.ap(-b),J=P.rotate(j),X=R.rotate(j),Q=L.rotate(j),ae=F.rotate(j),ge=new o.P(Math.max(J.x,X.x,ae.x,Q.x),Math.max(J.y,X.y,ae.y,Q.y)),ye=new o.P(Math.min(J.x,X.x,ae.x,Q.x),Math.min(J.y,X.y,ae.y,Q.y)),me=ge.sub(ye),we=(v.width-(S.left+S.right+c.left+c.right))/me.x,De=(v.height-(S.top+S.bottom+c.top+c.bottom))/me.y;if(De<0||we<0)return void Sl();const Ae=Math.min(o.at(v.scale*Math.min(we,De)),T.maxZoom),Re=o.P.convert(T.offset),Le=new o.P((c.left-c.right)/2,(c.top-c.bottom)/2).rotate(o.ap(b)),Pe=Re.add(Le).mult(v.scale/o.aq(Ae));return{center:Br(v.worldSize,P.add(L).div(2).sub(Pe)),zoom:Ae,bearing:b}}class su{get useGlobeControls(){return!1}handlePanInertia(c,p){const b=c.mag(),v=Math.abs(Cn(p));return{easingOffset:c.mult(Math.min(.75*v/b,1)),easingCenter:p.center}}handleMapControlsRollPitchBearingZoom(c,p){c.bearingDelta&&p.setBearing(p.bearing+c.bearingDelta),c.pitchDelta&&p.setPitch(p.pitch+c.pitchDelta),c.rollDelta&&p.setRoll(p.roll+c.rollDelta),c.zoomDelta&&p.setZoom(p.zoom+c.zoomDelta)}handleMapControlsPan(c,p,b){c.around.distSqr(p.centerPoint)<.01||p.setLocationAtPoint(b,c.around)}cameraForBoxAndBearing(c,p,b,v,S){return Ly(c,p,b,v,S)}handleJumpToCenterZoom(c,p){c.zoom!==(p.zoom!==void 0?+p.zoom:c.zoom)&&c.setZoom(+p.zoom),p.center!==void 0&&c.setCenter(o.V.convert(p.center))}handleEaseTo(c,p){const b=c.zoom,v=c.padding,S={roll:c.roll,pitch:c.pitch,bearing:c.bearing},P={roll:p.roll===void 0?c.roll:p.roll,pitch:p.pitch===void 0?c.pitch:p.pitch,bearing:p.bearing===void 0?c.bearing:p.bearing},R=p.zoom!==void 0,L=!c.isPaddingEqual(p.padding);let F=!1;const j=R?+p.zoom:c.zoom;let J=c.centerPoint.add(p.offsetAsPoint);const X=c.screenPointToLocation(J),{center:Q,zoom:ae}=c.applyConstrain(o.V.convert(p.center||X),j??b);pc(c,Q);const ge=ar(c.worldSize,X),ye=ar(c.worldSize,Q).sub(ge),me=o.aq(ae-b);return F=ae!==b,{easeFunc:we=>{if(F&&c.setZoom(o.G.number(b,ae,we)),o.bo(S,P)||cA({startEulerAngles:S,endEulerAngles:P,tr:c,k:we,useSlerp:S.roll!=P.roll}),L&&(c.interpolatePadding(v,p.padding,we),J=c.centerPoint.add(p.offsetAsPoint)),p.around)c.setLocationAtPoint(p.around,p.aroundPoint);else{const De=o.aq(c.zoom-b),Ae=ae>b?Math.min(2,me):Math.max(.5,me),Re=Math.pow(Ae,1-we),Le=Br(c.worldSize,ge.add(ye.mult(we*Re)).mult(De));c.setLocationAtPoint(c.renderWorldCopies?Le.wrap():Le,J)}},isZooming:F,elevationCenter:Q}}handleFlyTo(c,p){const b=p.zoom!==void 0,v=c.zoom,S=c.applyConstrain(o.V.convert(p.center||p.locationAtOffset),b?+p.zoom:v),P=S.center,R=S.zoom;pc(c,P);const L=ar(c.worldSize,p.locationAtOffset),F=ar(c.worldSize,P).sub(L),j=F.mag(),J=o.aq(R-v);let X;if(p.minZoom!==void 0){const Q=Math.min(+p.minZoom,v,R),ae=c.applyConstrain(P,Q).zoom;X=o.aq(ae-v)}return{easeFunc:(Q,ae,ge,ye)=>{c.setZoom(Q===1?R:v+o.at(ae));const me=Q===1?P:Br(c.worldSize,L.add(F.mult(ge)).mult(ae));c.setLocationAtPoint(c.renderWorldCopies?me.wrap():me,ye)},scaleOfZoom:J,targetCenter:P,scaleOfMinZoom:X,pixelPathLength:j}}}class Un{constructor(c,p,b){this.blendFunction=c,this.blendColor=p,this.mask=b}}Un.Replace=[1,0],Un.disabled=new Un(Un.Replace,o.bp.transparent,[!1,!1,!1,!1]),Un.unblended=new Un(Un.Replace,o.bp.transparent,[!0,!0,!0,!0]),Un.alphaBlended=new Un([1,771],o.bp.transparent,[!0,!0,!0,!0]);const ch=2305;class en{constructor(c,p,b){this.enable=c,this.mode=p,this.frontFace=b}}en.disabled=new en(!1,1029,ch),en.backCCW=new en(!0,1029,ch),en.frontCCW=new en(!0,1028,ch);class zr{constructor(c,p,b){this.func=c,this.mask=p,this.range=b}}zr.ReadOnly=!1,zr.ReadWrite=!0,zr.disabled=new zr(519,zr.ReadOnly,[0,1]);const uh=7680;class on{constructor(c,p,b,v,S,P){this.test=c,this.ref=p,this.mask=b,this.fail=v,this.depthFail=S,this.pass=P}}on.disabled=new on({func:519,mask:0},0,0,uh,uh,uh);const kd=new WeakMap;function Wo(T){var c;if(kd.has(T))return kd.get(T);{const p=(c=T.getParameter(T.VERSION))===null||c===void 0?void 0:c.startsWith("WebGL 2.0");return kd.set(T,p),p}}class hh{get awaitingQuery(){return!!this._readbackQueue}constructor(c){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=c;const p=c.context,b=p.gl;this._texFormat=b.RGBA,this._texType=b.UNSIGNED_BYTE;const v=new o.aW;v.emplaceBack(-1,-1),v.emplaceBack(2,-1),v.emplaceBack(-1,2);const S=new o.aY;S.emplaceBack(0,1,2),this._fullscreenTriangle=new dn(p.createVertexBuffer(v,ya.members),p.createIndexBuffer(S),o.aX.simpleSegment(0,0,v.length,S.length)),this._resultBuffer=new Uint8Array(4),p.activeTexture.set(b.TEXTURE1);const P=b.createTexture();b.bindTexture(b.TEXTURE_2D,P),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texImage2D(b.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=p.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(P),Wo(b)&&(this._pbo=b.createBuffer(),b.bindBuffer(b.PIXEL_PACK_BUFFER,this._pbo),b.bufferData(b.PIXEL_PACK_BUFFER,4,b.STREAM_READ),b.bindBuffer(b.PIXEL_PACK_BUFFER,null))}destroy(){const c=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),c.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(c,p){const b=this._updateCount;return this._readbackQueue?b>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():b>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(c,p),this._updateCount++,this._measuredError}_bindFramebuffer(){const c=this._cachedRenderContext.context,p=c.gl;c.activeTexture.set(p.TEXTURE1),p.bindTexture(p.TEXTURE_2D,this._fbo.colorAttachment.get()),c.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(c,p){const b=this._cachedRenderContext.context,v=b.gl;if(this._bindFramebuffer(),b.viewport.set([0,0,this._texWidth,this._texHeight]),b.clear({color:o.bp.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(b,v.TRIANGLES,zr.disabled,on.disabled,Un.unblended,en.disabled,((S,P)=>({u_input:S,u_output_expected:P}))(c,p),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Wo(v)){v.bindBuffer(v.PIXEL_PACK_BUFFER,this._pbo),v.readBuffer(v.COLOR_ATTACHMENT0),v.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),v.bindBuffer(v.PIXEL_PACK_BUFFER,null);const S=v.fenceSync(v.SYNC_GPU_COMMANDS_COMPLETE,0);v.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:S}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const c=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Wo(c)){const p=c.clientWaitSync(this._readbackQueue.sync,0,0);if(p===c.WAIT_FAILED)return o.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(p===c.TIMEOUT_EXPIRED)return;c.bindBuffer(c.PIXEL_PACK_BUFFER,this._pbo),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),c.bindBuffer(c.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),c.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=hh._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(c){let p=0;return p+=c[0]/256,p+=c[1]/65536,p+=c[2]/16777216,c[3]<127&&(p=-p),p/128}}const gc=o.a5/128;function uA(T,c){const p=T.granularity!==void 0?Math.max(T.granularity,1):1,b=p+(T.generateBorders?2:0),v=p+(T.extendToNorthPole||T.generateBorders?1:0)+(T.extendToSouthPole||T.generateBorders?1:0),S=b+1,P=v+1,R=T.generateBorders?-1:0,L=T.generateBorders||T.extendToNorthPole?-1:0,F=p+(T.generateBorders?1:0),j=p+(T.generateBorders||T.extendToSouthPole?1:0),J=S*P,X=b*v*6,Q=S*P>65536;if(Q&&c==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const ae=Q||c==="32bit",ge=new Int16Array(2*J);let ye=0;for(let De=L;De<=j;De++)for(let Ae=R;Ae<=F;Ae++){let Re=Ae/p*o.a5;Ae===-1&&(Re=-gc),Ae===p+1&&(Re=o.a5+gc);let Le=De/p*o.a5;De===-1&&(Le=T.extendToNorthPole?o.br:-gc),De===p+1&&(Le=T.extendToSouthPole?o.bs:o.a5+gc),ge[ye++]=Re,ge[ye++]=Le}const me=ae?new Uint32Array(X):new Uint16Array(X);let we=0;for(let De=0;De<v;De++)for(let Ae=0;Ae<b;Ae++){const Re=Ae+1+De*S,Le=Ae+(De+1)*S,Pe=Ae+1+(De+1)*S;me[we++]=Ae+De*S,me[we++]=Le,me[we++]=Re,me[we++]=Re,me[we++]=Le,me[we++]=Pe}return{vertices:ge.buffer.slice(0),indices:me.buffer.slice(0),uses32bitIndices:ae}}const Od=new o.aV({fill:new o.bt(128,2),line:new o.bt(512,0),tile:new o.bt(128,32),stencil:new o.bt(128,1),circle:3});class Ny{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Zr.projectionGlobe}get vertexShaderPreludeCode(){return Zr.projectionMercator.vertexSource}get subdivisionGranularity(){return Od}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(c){this._errorMeasurement||(this._errorMeasurement=new hh(c));const p=o.X(this._errorQueryLatitudeDegrees),b=2*Math.atan(Math.exp(Math.PI-p*Math.PI*2))-.5*Math.PI,v=this._errorMeasurement.updateErrorLoop(p,b),S=k();v!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=v,this._errorMeasurementLastChangeTime=S);const P=Math.min(Math.max((S-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=o.bu(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,o.bv(P))}_getMeshKey(c){return`${c.granularity.toString(36)}_${c.generateBorders?"b":""}${c.extendToNorthPole?"n":""}${c.extendToSouthPole?"s":""}`}getMeshFromTileID(c,p,b,v,S){const P=(S==="stencil"?Od.stencil:Od.tile).getGranularityForZoomLevel(p.z);return this._getMesh(c,{granularity:P,generateBorders:b,extendToNorthPole:p.y===0&&v,extendToSouthPole:p.y===(1<<p.z)-1&&v})}_getMesh(c,p){const b=this._getMeshKey(p);if(b in this._tileMeshCache)return this._tileMeshCache[b];const v=function(S,P){const R=uA(P,"16bit"),L=o.aW.deserialize({arrayBuffer:R.vertices,length:R.vertices.byteLength/2/2}),F=o.aY.deserialize({arrayBuffer:R.indices,length:R.indices.byteLength/2/3});return new dn(S.createVertexBuffer(L,ya.members),S.createIndexBuffer(F),o.aX.simpleSegment(0,0,L.length,F.length))}(c,p);return this._tileMeshCache[b]=v,v}recalculate(c){}hasTransition(){const c=k();let p=!1;return p=p||(c-this._errorMeasurementLastChangeTime)/1e3<.7,p=p||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,p}setErrorQueryLatitudeDegrees(c){this._errorQueryLatitudeDegrees=c}}const v2=new o.t({type:new o.D(o.u.projection.type)});class hA extends o.E{constructor(c){super(),this._transitionable=new o.x(v2,void 0),this.setProjection(c),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.H(0)),this._mercatorProjection=new Xs,this._verticalPerspectiveProjection=new Ny}get transitionState(){const c=this.properties.get("type");if(typeof c=="string"&&c==="mercator")return 0;if(typeof c=="string"&&c==="vertical-perspective")return 1;if(c instanceof o.bw){if(c.from==="vertical-perspective"&&c.to==="mercator")return 1-c.transition;if(c.from==="mercator"&&c.to==="vertical-perspective")return c.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(c){this._mercatorProjection.updateGPUdependent(c),this._verticalPerspectiveProjection.updateGPUdependent(c)}getMeshFromTileID(c,p,b,v,S){return this.currentProjection.getMeshFromTileID(c,p,b,v,S)}setProjection(c){this._transitionable.setValue("type",c?.type||"mercator")}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}setErrorQueryLatitudeDegrees(c){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(c),this._mercatorProjection.setErrorQueryLatitudeDegrees(c)}}function Js(T){const c=ou(T.worldSize,T.center.lat);return 2*Math.PI*c}function el(T,c,p,b,v){const S=1/(1<<v),P=c/o.a5*S+b*S,R=o.by((T/o.a5*S+p*S)*Math.PI*2+Math.PI,2*Math.PI),L=2*Math.atan(Math.exp(Math.PI-P*Math.PI*2))-.5*Math.PI,F=Math.cos(L),j=new Float64Array(3);return j[0]=Math.sin(R)*F,j[1]=Math.sin(L),j[2]=Math.cos(R)*F,j}function ii(T){return function(c,p){const b=Math.cos(p),v=new Float64Array(3);return v[0]=Math.sin(c)*b,v[1]=Math.sin(p),v[2]=Math.cos(c)*b,v}(T.lng*Math.PI/180,T.lat*Math.PI/180)}function ou(T,c){return T/(2*Math.PI)/Math.cos(c*Math.PI/180)}function Fy(T){const c=Math.asin(T[1])/Math.PI*180,p=Math.sqrt(T[0]*T[0]+T[2]*T[2]);if(p>1e-6){const b=T[0]/p,v=Math.acos(T[2]/p),S=(b>0?v:-v)/Math.PI*180;return new o.V(o.W(S,-180,180),c)}return new o.V(0,c)}function Dd(T){return Math.cos(T*Math.PI/180)}function yi(T,c){const p=Dd(T),b=Dd(c);return o.at(b/p)}function dA(T,c){const p=T.rotate(c.bearingInRadians),b=c.zoom+yi(c.center.lat,0),v=o.bu(1/Dd(c.center.lat),1/Dd(Math.min(Math.abs(c.center.lat),60)),o.bx(b,7,3,0,1)),S=360/Js({worldSize:c.worldSize,center:{lat:c.center.lat}});return new o.V(c.center.lng-p.x*S*v,o.an(c.center.lat+p.y*S,-o.ao,o.ao))}function Uy(T){const c=.5*T,p=Math.sin(c),b=Math.cos(c);return Math.log(p+b)-Math.log(b-p)}function fA(T,c,p,b){const v=T.lat+p*b;if(Math.abs(p)>1){const S=(Math.sign(T.lat+p)!==Math.sign(T.lat)?-Math.abs(T.lat):Math.abs(T.lat))*Math.PI/180,P=Math.abs(T.lat+p)*Math.PI/180,R=Uy(S+b*(P-S)),L=Uy(S),F=Uy(P);return new o.V(T.lng+c*((R-L)/(F-L)),v)}return new o.V(T.lng+c*b,v)}class A2{constructor(c){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=c}swapBuffers(){if(!this._hadAnyChanges)return;const c=this._cachePrevious;this._cachePrevious=this._cache,this._cache=c,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(c,p,b,v){const S=`${c.z}_${c.x}_${c.y}_${v?.terrain?"t":""}`,P=this._cache.get(S);if(P)return P;const R=this._cachePrevious.get(S);if(R)return this._cache.set(S,R),R;const L=this._boundingVolumeFactory(c,p,b,v);return this._cache.set(S,L),this._hadAnyChanges=!0,L}}class dh{constructor(c,p,b,v){this.min=b,this.max=v,this.points=c,this.planes=p}static fromAabb(c,p){const b=[];for(let v=0;v<8;v++)b.push([1&~v?c[0]:p[0],(v>>1&1)==1?p[1]:c[1],(v>>2&1)==1?p[2]:c[2]]);return new dh(b,[[-1,0,0,p[0]],[1,0,0,-c[0]],[0,-1,0,p[1]],[0,1,0,-c[1]],[0,0,-1,p[2]],[0,0,1,-c[2]]],c,p)}static fromCenterSizeAngles(c,p,b){const v=o.bB([],b[0],b[1],b[2]),S=o.bC([],[p[0],0,0],v),P=o.bC([],[0,p[1],0],v),R=o.bC([],[0,0,p[2]],v),L=[...c],F=[...c];for(let J=0;J<8;J++)for(let X=0;X<3;X++){const Q=c[X]+S[X]*(1&~J?-1:1)+P[X]*((J>>1&1)==1?1:-1)+R[X]*((J>>2&1)==1?1:-1);L[X]=Math.min(L[X],Q),F[X]=Math.max(F[X],Q)}const j=[];for(let J=0;J<8;J++){const X=[...c];o.b0(X,X,o.a$([],S,1&~J?-1:1)),o.b0(X,X,o.a$([],P,(J>>1&1)==1?1:-1)),o.b0(X,X,o.a$([],R,(J>>2&1)==1?1:-1)),j.push(X)}return new dh(j,[[...S,-o.b5(S,j[0])],[...P,-o.b5(P,j[0])],[...R,-o.b5(R,j[0])],[-S[0],-S[1],-S[2],-o.b5(S,j[7])],[-P[0],-P[1],-P[2],-o.b5(P,j[7])],[-R[0],-R[1],-R[2],-o.b5(R,j[7])]],L,F)}intersectsFrustum(c){let p=!0;const b=this.points.length,v=this.planes.length,S=c.planes.length,P=c.points.length;for(let R=0;R<S;R++){const L=c.planes[R];let F=0;for(let j=0;j<b;j++){const J=this.points[j];L[0]*J[0]+L[1]*J[1]+L[2]*J[2]+L[3]>=0&&F++}if(F===0)return 0;F<b&&(p=!1)}if(p)return 2;for(let R=0;R<v;R++){const L=this.planes[R];let F=0;for(let j=0;j<P;j++){const J=c.points[j];L[0]*J[0]+L[1]*J[1]+L[2]*J[2]+L[3]>=0&&F++}if(F===0)return 0}return 1}intersectsPlane(c){const p=this.points.length;let b=0;for(let v=0;v<p;v++){const S=this.points[v];c[0]*S[0]+c[1]*S[1]+c[2]*S[2]+c[3]>=0&&b++}return b===p?2:b===0?0:1}}function Mp(T,c,p){const b=T-c;return b<0?-b:Math.max(0,b-p)}function fh(T,c,p,b,v){const S=T-p;let P;return P=S<0?Math.min(-S,1+S-v):S>1?Math.min(Math.max(S-v,0),1-S):0,Math.max(P,Mp(c,b,v))}class zy{constructor(){this._boundingVolumeCache=new A2(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(c,p,b,v){const S=1<<b.z,P=1/S,R=b.x/S,L=b.y/S;let F=2;return F=Math.min(F,fh(c,p,R,L,P)),F=Math.min(F,fh(c,p,R+.5,-L-P,P)),F=Math.min(F,fh(c,p,R+.5,2-L-P,P)),F}getWrap(c,p,b){const v=1<<p.z,S=1/v,P=p.x/v,R=Mp(c.x,P,S),L=Mp(c.x,P-1,S),F=Mp(c.x,P+1,S),j=Math.min(R,L,F);return j===F?1:j===L?-1:0}allowVariableZoom(c,p){return Rn(c,p)>4}allowWorldCopies(){return!1}getTileBoundingVolume(c,p,b,v){return this._boundingVolumeCache.getTileBoundingVolume(c,p,b,v)}_computeTileBoundingVolume(c,p,b,v){var S,P;let R=0,L=0;if(v?.terrain){const F=new o.a2(c.z,p,c.z,c.x,c.y),j=v.terrain.getMinMaxElevation(F);R=(S=j.minElevation)!==null&&S!==void 0?S:Math.min(0,b),L=(P=j.maxElevation)!==null&&P!==void 0?P:Math.max(0,b)}if(R/=o.bE,L/=o.bE,R+=1,L+=1,c.z<=0)return dh.fromAabb([-L,-L,-L],[L,L,L]);if(c.z===1)return dh.fromAabb([c.x===0?-L:0,c.y===0?0:-L,-L],[c.x===0?0:L,c.y===0?L:0,L]);{const F=[el(0,0,c.x,c.y,c.z),el(o.a5,0,c.x,c.y,c.z),el(o.a5,o.a5,c.x,c.y,c.z),el(0,o.a5,c.x,c.y,c.z)],j=[];for(const it of F)j.push(o.a$([],it,L));if(L!==R)for(const it of F)j.push(o.a$([],it,R));c.y===0&&j.push([0,1,0]),c.y===(1<<c.z)-1&&j.push([0,-1,0]);const J=[1,1,1],X=[-1,-1,-1];for(const it of j)for(let st=0;st<3;st++)J[st]=Math.min(J[st],it[st]),X[st]=Math.max(X[st],it[st]);const Q=el(o.a5/2,o.a5/2,c.x,c.y,c.z),ae=o.b4([],[0,1,0],Q);o.b3(ae,ae);const ge=o.b4([],Q,ae);o.b3(ge,ge);const ye=o.b4([],F[2],F[1]);o.b3(ye,ye);const me=o.b4([],F[0],F[3]);o.b3(me,me),j.push(o.a$([],Q,L)),c.y>=(1<<c.z)/2&&j.push(o.a$([],el(o.a5/2,0,c.x,c.y,c.z),L)),c.y<(1<<c.z)/2&&j.push(o.a$([],el(o.a5/2,o.a5,c.x,c.y,c.z),L));const we=Ld(Q,j),De=Ld(ge,j),Ae=[-Q[0],-Q[1],-Q[2],we.max],Re=[Q[0],Q[1],Q[2],-we.min],Le=[-ge[0],-ge[1],-ge[2],De.max],Pe=[ge[0],ge[1],ge[2],-De.min],$e=[...ye,0],ct=[...me,0],tt=[];return c.y===0?tt.push(o.bD(ct,$e,Ae),o.bD(ct,$e,Re)):tt.push(o.bD(Le,$e,Ae),o.bD(Le,$e,Re),o.bD(Le,ct,Ae),o.bD(Le,ct,Re)),c.y===(1<<c.z)-1?tt.push(o.bD(ct,$e,Ae),o.bD(ct,$e,Re)):tt.push(o.bD(Pe,$e,Ae),o.bD(Pe,$e,Re),o.bD(Pe,ct,Ae),o.bD(Pe,ct,Re)),new dh(tt,[Ae,Re,Le,Pe,$e,ct],J,X)}}}function Ld(T,c){let p=1/0,b=-1/0;for(const v of c){const S=o.b5(T,v);p=Math.min(p,S),b=Math.max(b,S)}return{min:p,max:b}}class ph{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(c){this._helper.setMinZoom(c)}setMaxZoom(c){this._helper.setMaxZoom(c)}setMinPitch(c){this._helper.setMinPitch(c)}setMaxPitch(c){this._helper.setMaxPitch(c)}setRenderWorldCopies(c){this._helper.setRenderWorldCopies(c)}setBearing(c){this._helper.setBearing(c)}setPitch(c){this._helper.setPitch(c)}setRoll(c){this._helper.setRoll(c)}setFov(c){this._helper.setFov(c)}setZoom(c){this._helper.setZoom(c)}setCenter(c){this._helper.setCenter(c)}setElevation(c){this._helper.setElevation(c)}setMinElevationForCurrentTile(c){this._helper.setMinElevationForCurrentTile(c)}setPadding(c){this._helper.setPadding(c)}interpolatePadding(c,p,b){return this._helper.interpolatePadding(c,p,b)}isPaddingEqual(c){return this._helper.isPaddingEqual(c)}resize(c,p){this._helper.resize(c,p)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(c){this._helper.setMaxBounds(c)}setConstrainOverride(c){this._helper.setConstrainOverride(c)}overrideNearFarZ(c,p){this._helper.overrideNearFarZ(c,p)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(c){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),c)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(c){}constructor(c){this._cachedClippingPlane=o.bF(),this._projectionMatrix=o.bj(),this._globeViewProjMatrix32f=o.bi(),this._globeViewProjMatrixNoCorrection=o.bj(),this._globeViewProjMatrixNoCorrectionInverted=o.bj(),this._globeProjMatrixInverted=o.bj(),this._cameraPosition=o.bz(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(p,b)=>{const v=o.an(p.lat,-o.ao,o.ao),S=o.an(+b,this.minZoom+yi(0,v),this.maxZoom);return{center:new o.V(p.lng,v),zoom:S}},this.applyConstrain=(p,b)=>this._helper.applyConstrain(p,b),this._helper=new nu({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(p,b)=>this.defaultConstrain(p,b)},c),this._coveringTilesDetailsProvider=new zy}clone(){const c=new ph;return c.apply(this),c}apply(c,p){this._globeLatitudeErrorCorrectionRadians=p||0,this._helper.apply(c)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const c=o.bz();return c[0]=this._cameraPosition[0],c[1]=this._cameraPosition[1],c[2]=this._cameraPosition[2],c}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(c){const{overscaledTileID:p,applyGlobeMatrix:b}=c,v=this._helper.getMercatorTileCoordinates(p);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:v,clippingPlane:this._cachedClippingPlane,projectionTransition:b?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(c){const p=this.pitchInRadians,b=this.cameraToCenterDistance/c,v=Math.sin(p)*b,S=Math.cos(p)*b+1,P=1/Math.sqrt(v*v+S*S)*1;let R=-v,L=S;const F=Math.sqrt(R*R+L*L);R/=F,L/=F;const j=[0,R,L];o.bG(j,j,[0,0,0],-this.bearingInRadians),o.bH(j,j,[0,0,0],-1*this.center.lat*Math.PI/180),o.bI(j,j,[0,0,0],this.center.lng*Math.PI/180);const J=1/o.b7(j);return o.a$(j,j,J),[...j,-P*J]}isLocationOccluded(c){return!this.isSurfacePointVisible(ii(c))}transformLightDirection(c){const p=this._helper._center.lng*Math.PI/180,b=this._helper._center.lat*Math.PI/180,v=Math.cos(b),S=[Math.sin(p)*v,Math.sin(b),Math.cos(p)*v],P=[S[2],0,-S[0]],R=[0,0,0];o.b4(R,P,S),o.b3(P,P),o.b3(R,R);const L=[0,0,0];return o.b3(L,[P[0]*c[0]+R[0]*c[1]+S[0]*c[2],P[1]*c[0]+R[1]*c[1]+S[1]*c[2],P[2]*c[0]+R[2]*c[1]+S[2]*c[2]]),L}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(c,p,b){const v=function(R,L,F){const j=1/(1<<F.z);return new o.a9(R/o.a5*j+F.x*j,L/o.a5*j+F.y*j)}(c,p,b.canonical),S=(P=v.y,[o.by(v.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-P*Math.PI*2))-.5*Math.PI]);var P;return this.getCircleRadiusCorrection()/Math.cos(S[1])}projectTileCoordinates(c,p,b,v){const S=b.canonical,P=el(c,p,S.x,S.y,S.z),R=1+(v?v(c,p):0)/o.bE,L=[P[0]*R,P[1]*R,P[2]*R,1];o.aH(L,L,this._globeViewProjMatrixNoCorrection);const F=this._cachedClippingPlane,j=F[0]*P[0]+F[1]*P[1]+F[2]*P[2]+F[3]<0;return{point:new o.P(L[0]/L[3],L[1]/L[3]),signedDistanceFromCamera:L[3],isOccluded:j}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const c=ou(this.worldSize,this.center.lat),p=o.bk(),b=o.bk();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*c),o.be(p,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const v=this.centerOffset;p[8]=2*-v.x/this._helper._width,p[9]=2*v.y/this._helper._height,this._projectionMatrix=o.bf(p),this._globeProjMatrixInverted=o.bk(),o.aB(this._globeProjMatrixInverted,p),o.O(p,p,[0,0,-this.cameraToCenterDistance]),o.bg(p,p,this.rollInRadians),o.bh(p,p,-this.pitchInRadians),o.bg(p,p,this.bearingInRadians),o.O(p,p,[0,0,-c]);const S=o.bz();S[0]=c,S[1]=c,S[2]=c,o.bh(b,p,this.center.lat*Math.PI/180),o.bJ(b,b,-this.center.lng*Math.PI/180),o.Q(b,b,S),this._globeViewProjMatrixNoCorrection=b,o.bh(p,p,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),o.bJ(p,p,-this.center.lng*Math.PI/180),o.Q(p,p,S),this._globeViewProjMatrix32f=new Float32Array(p),this._globeViewProjMatrixNoCorrectionInverted=o.bk(),o.aB(this._globeViewProjMatrixNoCorrectionInverted,b);const P=o.bz();this._cameraPosition=o.bz(),this._cameraPosition[2]=this.cameraToCenterDistance/c,o.bG(this._cameraPosition,this._cameraPosition,P,-this.rollInRadians),o.bH(this._cameraPosition,this._cameraPosition,P,this.pitchInRadians),o.bG(this._cameraPosition,this._cameraPosition,P,-this.bearingInRadians),o.b0(this._cameraPosition,this._cameraPosition,[0,0,1]),o.bH(this._cameraPosition,this._cameraPosition,P,-this.center.lat*Math.PI/180),o.bI(this._cameraPosition,this._cameraPosition,P,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(c);const R=o.bf(this._globeViewProjMatrixNoCorrectionInverted);o.Q(R,R,[1,1,-1]),this._cachedFrustum=lo.fromInvProjectionMatrix(R,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(c){o.w("calculateFogMatrix is not supported on globe projection.");const p=o.bk();return o.ar(p),p}getVisibleUnwrappedCoordinates(c){return[new o.bc(0,c)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(c){c&&o.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(c,p){if(!this._globeViewProjMatrixNoCorrection)return 1;const b=ii(c);o.a$(b,b,1+p/o.bE);const v=o.bF();return o.aH(v,[b[0],b[1],b[2],1],this._globeViewProjMatrixNoCorrection),v[2]/v[3]}populateCache(c){}getBounds(){const c=.5*this.width,p=.5*this.height,b=[new o.P(0,0),new o.P(c,0),new o.P(this.width,0),new o.P(this.width,p),new o.P(this.width,this.height),new o.P(c,this.height),new o.P(0,this.height),new o.P(0,p)],v=[];for(const J of b)v.push(this.unprojectScreenPoint(J));let S=0,P=0,R=0,L=0;const F=this.center;for(const J of v){const X=o.bK(F.lng,J.lng),Q=o.bK(F.lat,J.lat);X<P&&(P=X),X>S&&(S=X),Q<L&&(L=Q),Q>R&&(R=Q)}const j=[F.lng+P,F.lat+L,F.lng+S,F.lat+R];return this.isSurfacePointOnScreen([0,1,0])&&(j[3]=90,j[0]=-180,j[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(j[1]=-90,j[0]=-180,j[2]=180),new Qe(j)}calculateCenterFromCameraLngLatAlt(c,p,b,v){return this._helper.calculateCenterFromCameraLngLatAlt(c,p,b,v)}setLocationAtPoint(c,p){const b=ii(this.unprojectScreenPoint(p)),v=ii(c),S=o.bz();o.bL(S);const P=o.bz();o.bI(P,b,S,-this.center.lng*Math.PI/180),o.bH(P,P,S,this.center.lat*Math.PI/180);const R=v[0]*v[0]+v[2]*v[2],L=P[0]*P[0];if(R<L)return;const F=Math.sqrt(R-L),j=-F,J=o.bM(v[0],v[2],P[0],F),X=o.bM(v[0],v[2],P[0],j),Q=o.bz();o.bI(Q,v,S,-J);const ae=o.bM(Q[1],Q[2],P[1],P[2]),ge=o.bz();o.bI(ge,v,S,-X);const ye=o.bM(ge[1],ge[2],P[1],P[2]),me=.5*Math.PI,we=ae>=-me&&ae<=me,De=ye>=-me&&ye<=me;let Ae,Re;if(we&&De){const ct=this.center.lng*Math.PI/180,tt=this.center.lat*Math.PI/180;o.bN(J,ct)+o.bN(ae,tt)<o.bN(X,ct)+o.bN(ye,tt)?(Ae=J,Re=ae):(Ae=X,Re=ye)}else if(we)Ae=J,Re=ae;else{if(!De)return;Ae=X,Re=ye}const Le=Ae/Math.PI*180,Pe=Re/Math.PI*180,$e=this.center.lat;this.setCenter(new o.V(Le,o.an(Pe,-90,90))),this.setZoom(this.zoom+yi($e,this.center.lat))}locationToScreenPoint(c,p){const b=ii(c);if(p){const v=p.getElevationForLngLatZoom(c,this._helper._tileZoom);o.a$(b,b,1+v/o.bE)}return this._projectSurfacePointToScreen(b)}_projectSurfacePointToScreen(c){const p=o.bF();return o.aH(p,[...c,1],this._globeViewProjMatrixNoCorrection),p[0]/=p[3],p[1]/=p[3],new o.P((.5*p[0]+.5)*this.width,(.5*-p[1]+.5)*this.height)}screenPointToMercatorCoordinate(c,p){if(p){const b=p.pointCoordinate(c);if(b)return b}return o.a9.fromLngLat(this.unprojectScreenPoint(c))}screenPointToLocation(c,p){var b;return(b=this.screenPointToMercatorCoordinate(c,p))===null||b===void 0?void 0:b.toLngLat()}isPointOnMapSurface(c,p){const b=this._cameraPosition,v=this.getRayDirectionFromPixel(c);return!!this.rayPlanetIntersection(b,v)}getRayDirectionFromPixel(c){const p=o.bF();p[0]=c.x/this.width*2-1,p[1]=-1*(c.y/this.height*2-1),p[2]=1,p[3]=1,o.aH(p,p,this._globeViewProjMatrixNoCorrectionInverted),p[0]/=p[3],p[1]/=p[3],p[2]/=p[3];const b=o.bz();b[0]=p[0]-this._cameraPosition[0],b[1]=p[1]-this._cameraPosition[1],b[2]=p[2]-this._cameraPosition[2];const v=o.bz();return o.b3(v,b),v}isSurfacePointVisible(c){const p=this._cachedClippingPlane;return p[0]*c[0]+p[1]*c[1]+p[2]*c[2]+p[3]>=0}isSurfacePointOnScreen(c){if(!this.isSurfacePointVisible(c))return!1;const p=o.bF();return o.aH(p,[...c,1],this._globeViewProjMatrixNoCorrection),p[0]/=p[3],p[1]/=p[3],p[2]/=p[3],p[0]>-1&&p[0]<1&&p[1]>-1&&p[1]<1&&p[2]>-1&&p[2]<1}rayPlanetIntersection(c,p){const b=o.b5(c,p),v=o.bz(),S=o.bz();o.a$(S,p,b),o.b2(v,c,S);const P=1-o.b5(v,v);if(P<0)return null;const R=o.b5(c,c)-1,L=-b+(b<0?1:-1)*Math.sqrt(P),F=R/L,j=L;return{tMin:Math.min(F,j),tMax:Math.max(F,j)}}unprojectScreenPoint(c){const p=this._cameraPosition,b=this.getRayDirectionFromPixel(c),v=this.rayPlanetIntersection(p,b);if(v){const j=o.bz();o.b0(j,p,[b[0]*v.tMin,b[1]*v.tMin,b[2]*v.tMin]);const J=o.bz();return o.b3(J,j),Fy(J)}const S=this._cachedClippingPlane,P=S[0]*b[0]+S[1]*b[1]+S[2]*b[2],R=-o.bb(S,p)/P,L=o.bz();if(R>0)o.b0(L,p,[b[0]*R,b[1]*R,b[2]*R]);else{const j=o.bz();o.b0(j,p,[2*b[0],2*b[1],2*b[2]]);const J=o.bb(this._cachedClippingPlane,j);o.b2(L,j,[this._cachedClippingPlane[0]*J,this._cachedClippingPlane[1]*J,this._cachedClippingPlane[2]*J])}const F=function(j){const J=o.bz();return J[0]=j[0]*-j[3],J[1]=j[1]*-j[3],J[2]=j[2]*-j[3],{center:J,radius:Math.sqrt(1-j[3]*j[3])}}(S);return Fy(function(j,J,X){const Q=o.bz();o.b2(Q,X,j);const ae=o.bz();return o.bA(ae,j,Q,J/o.b9(Q)),ae}(F.center,F.radius,L))}getMatrixForModel(c,p){const b=o.V.convert(c),v=1/o.bE,S=o.bj();return o.bJ(S,S,b.lng/180*Math.PI),o.bh(S,S,-b.lat/180*Math.PI),o.O(S,S,[0,0,1+p/o.bE]),o.bh(S,S,.5*Math.PI),o.Q(S,S,[v,v,v]),S}getProjectionDataForCustomLayer(c=!0){const p=this.getProjectionData({overscaledTileID:new o.a2(0,0,0,0,0),applyGlobeMatrix:c});return p.tileMercatorCoords=[0,0,1,1],p}getFastPathSimpleProjectionMatrix(c){}}class gh{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(c){this._helper.setMinZoom(c)}setMaxZoom(c){this._helper.setMaxZoom(c)}setMinPitch(c){this._helper.setMinPitch(c)}setMaxPitch(c){this._helper.setMaxPitch(c)}setRenderWorldCopies(c){this._helper.setRenderWorldCopies(c)}setBearing(c){this._helper.setBearing(c)}setPitch(c){this._helper.setPitch(c)}setRoll(c){this._helper.setRoll(c)}setFov(c){this._helper.setFov(c)}setZoom(c){this._helper.setZoom(c)}setCenter(c){this._helper.setCenter(c)}setElevation(c){this._helper.setElevation(c)}setMinElevationForCurrentTile(c){this._helper.setMinElevationForCurrentTile(c)}setPadding(c){this._helper.setPadding(c)}interpolatePadding(c,p,b){return this._helper.interpolatePadding(c,p,b)}isPaddingEqual(c){return this._helper.isPaddingEqual(c)}resize(c,p,b=!0){this._helper.resize(c,p,b)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(c){this._helper.setMaxBounds(c)}setConstrainOverride(c){this._helper.setConstrainOverride(c)}overrideNearFarZ(c,p){this._helper.overrideNearFarZ(c,p)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(c){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),c)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(c,p){this._globeness=c,this._globeLatitudeErrorCorrectionRadians=p,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(c){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(p,b)=>this.currentTransform.defaultConstrain(p,b),this.applyConstrain=(p,b)=>this._helper.applyConstrain(p,b),this._helper=new nu({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(p,b)=>this.defaultConstrain(p,b)},c),this._globeness=1,this._mercatorTransform=new iu,this._verticalPerspectiveTransform=new ph}clone(){const c=new gh;return c._globeness=this._globeness,c._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,c.apply(this),c}apply(c){this._helper.apply(c),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(c){const p=this._mercatorTransform.getProjectionData(c),b=this._verticalPerspectiveTransform.getProjectionData(c);return{mainMatrix:this.isGlobeRendering?b.mainMatrix:p.mainMatrix,clippingPlane:b.clippingPlane,tileMercatorCoords:b.tileMercatorCoords,projectionTransition:c.applyGlobeMatrix?this._globeness:0,fallbackMatrix:p.fallbackMatrix}}isLocationOccluded(c){return this.currentTransform.isLocationOccluded(c)}transformLightDirection(c){return this.currentTransform.transformLightDirection(c)}getPixelScale(){return o.bu(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return o.bu(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(c,p,b){const v=this._mercatorTransform.getPitchedTextCorrection(c,p,b),S=this._verticalPerspectiveTransform.getPitchedTextCorrection(c,p,b);return o.bu(v,S,this._globeness)}projectTileCoordinates(c,p,b,v){return this.currentTransform.projectTileCoordinates(c,p,b,v)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(c){return this.currentTransform.calculateFogMatrix(c)}getVisibleUnwrappedCoordinates(c){return this.currentTransform.getVisibleUnwrappedCoordinates(c)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(c){this._mercatorTransform.recalculateZoomAndCenter(c),this._verticalPerspectiveTransform.recalculateZoomAndCenter(c)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(c,p){return this.currentTransform.lngLatToCameraDepth(c,p)}populateCache(c){this._mercatorTransform.populateCache(c),this._verticalPerspectiveTransform.populateCache(c)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(c,p,b,v){return this._helper.calculateCenterFromCameraLngLatAlt(c,p,b,v)}setLocationAtPoint(c,p){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(c,p),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(c,p),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(c,p){return this.currentTransform.locationToScreenPoint(c,p)}screenPointToMercatorCoordinate(c,p){return this.currentTransform.screenPointToMercatorCoordinate(c,p)}screenPointToLocation(c,p){return this.currentTransform.screenPointToLocation(c,p)}isPointOnMapSurface(c,p){return this.currentTransform.isPointOnMapSurface(c,p)}getRayDirectionFromPixel(c){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(c)}getMatrixForModel(c,p){return this.currentTransform.getMatrixForModel(c,p)}getProjectionDataForCustomLayer(c=!0){const p=this._mercatorTransform.getProjectionDataForCustomLayer(c);if(!this.isGlobeRendering)return p;const b=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(c);return b.fallbackMatrix=p.mainMatrix,b}getFastPathSimpleProjectionMatrix(c){return this.currentTransform.getFastPathSimpleProjectionMatrix(c)}}class Ui{get useGlobeControls(){return!0}handlePanInertia(c,p){const b=dA(c,p);return Math.abs(b.lng-p.center.lng)>180&&(b.lng=p.center.lng+179.5*Math.sign(b.lng-p.center.lng)),{easingCenter:b,easingOffset:new o.P(0,0)}}handleMapControlsRollPitchBearingZoom(c,p){const b=c.around,v=p.screenPointToLocation(b);c.bearingDelta&&p.setBearing(p.bearing+c.bearingDelta),c.pitchDelta&&p.setPitch(p.pitch+c.pitchDelta),c.rollDelta&&p.setRoll(p.roll+c.rollDelta);const S=p.zoom;c.zoomDelta&&p.setZoom(p.zoom+c.zoomDelta);const P=p.zoom-S;if(P===0)return;const R=o.bK(p.center.lng,v.lng),L=R/(Math.abs(R/180)+1),F=o.bK(p.center.lat,v.lat),j=p.getRayDirectionFromPixel(b),J=p.cameraPosition,X=-1*o.b5(J,j),Q=o.bz();o.b0(Q,J,[j[0]*X,j[1]*X,j[2]*X]);const ae=o.b7(Q)-1,ge=Math.exp(.5*-Math.max(ae-.3,0)),ye=ou(p.worldSize,p.center.lat)/Math.min(p.width,p.height),me=o.bx(ye,.9,.5,1,.25),we=(1-o.aq(-P))*Math.min(ge,me),De=p.center.lat,Ae=p.zoom,Re=new o.V(p.center.lng+L*we,o.an(p.center.lat+F*we,-o.ao,o.ao));p.setLocationAtPoint(v,b);const Le=p.center,Pe=o.bx(Math.abs(R),45,85,0,1),$e=o.bx(ye,.75,.35,0,1),ct=Math.pow(Math.max(Pe,$e),.25),tt=o.bK(Le.lng,Re.lng),it=o.bK(Le.lat,Re.lat);p.setCenter(new o.V(Le.lng+tt*ct,Le.lat+it*ct).wrap()),p.setZoom(Ae+yi(De,p.center.lat))}handleMapControlsPan(c,p,b){if(!c.panDelta)return;const v=p.center.lat,S=p.zoom;p.setCenter(dA(c.panDelta,p).wrap()),p.setZoom(S+yi(v,p.center.lat))}cameraForBoxAndBearing(c,p,b,v,S){const P=Ly(c,p,b,v,S),R=p.left/S.width*2-1,L=(S.width-p.right)/S.width*2-1,F=p.top/S.height*-2+1,j=(S.height-p.bottom)/S.height*-2+1,J=o.bK(b.getWest(),b.getEast())<0,X=J?b.getEast():b.getWest(),Q=J?b.getWest():b.getEast(),ae=Math.max(b.getNorth(),b.getSouth()),ge=Math.min(b.getNorth(),b.getSouth()),ye=X+.5*o.bK(X,Q),me=ae+.5*o.bK(ae,ge),we=S.clone();we.setCenter(P.center),we.setBearing(P.bearing),we.setPitch(0),we.setRoll(0),we.setZoom(P.zoom);const De=we.modelViewProjectionMatrix,Ae=[ii(b.getNorthWest()),ii(b.getNorthEast()),ii(b.getSouthWest()),ii(b.getSouthEast()),ii(new o.V(Q,me)),ii(new o.V(X,me)),ii(new o.V(ye,ae)),ii(new o.V(ye,ge))],Re=ii(P.center);let Le=Number.POSITIVE_INFINITY;for(const Pe of Ae)R<0&&(Le=Ui.getLesserNonNegativeNonNull(Le,Ui.solveVectorScale(Pe,Re,De,"x",R))),L>0&&(Le=Ui.getLesserNonNegativeNonNull(Le,Ui.solveVectorScale(Pe,Re,De,"x",L))),F>0&&(Le=Ui.getLesserNonNegativeNonNull(Le,Ui.solveVectorScale(Pe,Re,De,"y",F))),j<0&&(Le=Ui.getLesserNonNegativeNonNull(Le,Ui.solveVectorScale(Pe,Re,De,"y",j)));if(Number.isFinite(Le)&&Le!==0)return P.zoom=we.zoom+o.at(Le),P;Sl()}handleJumpToCenterZoom(c,p){const b=c.center.lat,v=c.applyConstrain(p.center?o.V.convert(p.center):c.center,c.zoom).center;c.setCenter(v.wrap());const S=p.zoom!==void 0?+p.zoom:c.zoom+yi(b,v.lat);c.zoom!==S&&c.setZoom(S)}handleEaseTo(c,p){const b=c.zoom,v=c.center,S=c.padding,P={roll:c.roll,pitch:c.pitch,bearing:c.bearing},R={roll:p.roll===void 0?c.roll:p.roll,pitch:p.pitch===void 0?c.pitch:p.pitch,bearing:p.bearing===void 0?c.bearing:p.bearing},L=p.zoom!==void 0,F=!c.isPaddingEqual(p.padding);let j=!1;const J=p.center?o.V.convert(p.center):v,X=c.applyConstrain(J,b).center;pc(c,X);const Q=c.clone();Q.setCenter(X),Q.setZoom(L?+p.zoom:b+yi(v.lat,J.lat)),Q.setBearing(p.bearing);const ae=new o.P(o.an(c.centerPoint.x+p.offsetAsPoint.x,0,c.width),o.an(c.centerPoint.y+p.offsetAsPoint.y,0,c.height));Q.setLocationAtPoint(X,ae);const ge=(p.offset&&p.offsetAsPoint.mag())>0?Q.center:X,ye=L?+p.zoom:b+yi(v.lat,ge.lat),me=b+yi(v.lat,0),we=ye+yi(ge.lat,0),De=o.bK(v.lng,ge.lng),Ae=o.bK(v.lat,ge.lat),Re=o.aq(we-me);return j=ye!==b,{easeFunc:Le=>{if(o.bo(P,R)||cA({startEulerAngles:P,endEulerAngles:R,tr:c,k:Le,useSlerp:P.roll!=R.roll}),F&&c.interpolatePadding(S,p.padding,Le),p.around)o.w("Easing around a point is not supported under globe projection."),c.setLocationAtPoint(p.around,p.aroundPoint);else{const Pe=we>me?Math.min(2,Re):Math.max(.5,Re),$e=Math.pow(Pe,1-Le),ct=fA(v,De,Ae,Le*$e);c.setCenter(ct.wrap())}if(j){const Pe=o.G.number(me,we,Le)+yi(0,c.center.lat);c.setZoom(Pe)}},isZooming:j,elevationCenter:ge}}handleFlyTo(c,p){const b=p.zoom!==void 0,v=c.center,S=c.zoom,P=c.padding,R=!c.isPaddingEqual(p.padding),L=c.applyConstrain(o.V.convert(p.center||p.locationAtOffset),S).center,F=b?+p.zoom:c.zoom+yi(c.center.lat,L.lat),j=c.clone();j.setCenter(L),j.setZoom(F),j.setBearing(p.bearing);const J=new o.P(o.an(c.centerPoint.x+p.offsetAsPoint.x,0,c.width),o.an(c.centerPoint.y+p.offsetAsPoint.y,0,c.height));j.setLocationAtPoint(L,J);const X=j.center;pc(c,X);const Q=function(Ae,Re,Le){const Pe=ii(Re),$e=ii(Le),ct=o.b5(Pe,$e),tt=Math.acos(ct),it=Js(Ae);return tt/(2*Math.PI)*it}(c,v,X),ae=S+yi(v.lat,0),ge=F+yi(X.lat,0),ye=o.aq(ge-ae);let me;if(typeof p.minZoom=="number"){const Ae=+p.minZoom+yi(X.lat,0),Re=Math.min(Ae,ae,ge)+yi(0,X.lat),Le=c.applyConstrain(X,Re).zoom+yi(X.lat,0);me=o.aq(Le-ae)}const we=o.bK(v.lng,X.lng),De=o.bK(v.lat,X.lat);return{easeFunc:(Ae,Re,Le,Pe)=>{const $e=fA(v,we,De,Le);R&&c.interpolatePadding(P,p.padding,Ae);const ct=Ae===1?X:$e;c.setCenter(ct.wrap());const tt=ae+o.at(Re);c.setZoom(Ae===1?F:tt+yi(0,ct.lat))},scaleOfZoom:ye,targetCenter:X,scaleOfMinZoom:me,pixelPathLength:Q}}static solveVectorScale(c,p,b,v,S){const P=v==="x"?[b[0],b[4],b[8],b[12]]:[b[1],b[5],b[9],b[13]],R=[b[3],b[7],b[11],b[15]],L=c[0]*P[0]+c[1]*P[1]+c[2]*P[2],F=c[0]*R[0]+c[1]*R[1]+c[2]*R[2],j=p[0]*P[0]+p[1]*P[1]+p[2]*P[2],J=p[0]*R[0]+p[1]*R[1]+p[2]*R[2];return j+S*F===L+S*J||R[3]*(L-j)+P[3]*(J-F)+L*J==j*F?null:(j+P[3]-S*J-S*R[3])/(j-L-S*J+S*F)}static getLesserNonNegativeNonNull(c,p){return p!==null&&p>=0&&p<c?p:c}}class pA{constructor(c){this._globe=c,this._mercatorCameraHelper=new su,this._verticalPerspectiveCameraHelper=new Ui}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(c,p){return this.currentHelper.handlePanInertia(c,p)}handleMapControlsRollPitchBearingZoom(c,p){return this.currentHelper.handleMapControlsRollPitchBearingZoom(c,p)}handleMapControlsPan(c,p,b){this.currentHelper.handleMapControlsPan(c,p,b)}cameraForBoxAndBearing(c,p,b,v,S){return this.currentHelper.cameraForBoxAndBearing(c,p,b,v,S)}handleJumpToCenterZoom(c,p){this.currentHelper.handleJumpToCenterZoom(c,p)}handleEaseTo(c,p){return this.currentHelper.handleEaseTo(c,p)}handleFlyTo(c,p){return this.currentHelper.handleFlyTo(c,p)}}const mh=(T,c)=>o.B(T,c&&c.filter(p=>p.identifier!=="source.canvas")),Nd=o.bO();class au extends o.E{constructor(c,p={}){var b,v;super(),this._rtlPluginLoaded=()=>{for(const P in this.tileManagers){const R=this.tileManagers[P].getSource().type;R!=="vector"&&R!=="geojson"||this.tileManagers[P].reload()}},this.map=c,this.dispatcher=new kt(_t(),c._getMapId()),this.dispatcher.registerMessageHandler("GG",(P,R)=>this.getGlyphs(P,R)),this.dispatcher.registerMessageHandler("GI",(P,R)=>this.getImages(P,R)),this.dispatcher.registerMessageHandler("GDA",(P,R)=>this.getDashes(P,R)),this.imageManager=new Me,this.imageManager.setEventedParent(this);const S=((b=c._container)===null||b===void 0?void 0:b.lang)||typeof document<"u"&&((v=document.documentElement)===null||v===void 0?void 0:v.lang)||void 0;this.glyphManager=new At(c._requestManager,p.localIdeographFontFamily,S),this.lineAtlas=new Xn(256,512),this.crossTileSymbolIndex=new Cs,this._setInitialValues(),this._resetUpdates(),this.dispatcher.broadcast("SR",o.bP()),Ge().on(Be,this._rtlPluginLoaded),this.on("data",P=>{if(P.dataType!=="source"||P.sourceDataType!=="metadata")return;const R=this.tileManagers[P.sourceId];if(!R)return;const L=R.getSource();if(L&&L.vectorLayerIds)for(const F in this._layers){const j=this._layers[F];j.source===L.id&&this._validateLayer(j)}})}_setInitialValues(){var c;this._spritesImagesIds={},this._layers={},this._order=[],this.tileManagers={},this.zoomHistory=new o.bQ,this._availableImages=[],this._globalState={},this._serializedLayers={},this.stylesheet=null,this.light=null,this.sky=null,this.projection&&(this.projection.destroy(),delete this.projection),this._loaded=!1,this._changed=!1,this._updatedLayers={},this._updatedSources={},this._changedImages={},this._glyphsDidChange=!1,this._updatedPaintProps={},this._layerOrderChanged=!1,this.crossTileSymbolIndex=new(((c=this.crossTileSymbolIndex)===null||c===void 0?void 0:c.constructor)||Object),this.pauseablePlacement=void 0,this.placement=void 0,this.z=0}setGlobalStateProperty(c,p){var b,v,S;this._checkLoaded();const P=p===null?(S=(v=(b=this.stylesheet.state)===null||b===void 0?void 0:b[c])===null||v===void 0?void 0:v.default)!==null&&S!==void 0?S:null:p;if(o.bR(P,this._globalState[c]))return this;this._globalState[c]=P,this._applyGlobalStateChanges([c])}getGlobalState(){return this._globalState}setGlobalState(c){this._checkLoaded();const p=[];for(const b in c)!o.bR(this._globalState[b],c[b].default)&&(p.push(b),this._globalState[b]=c[b].default);this._applyGlobalStateChanges(p)}_applyGlobalStateChanges(c){if(c.length===0)return;const p=new Set,b={};for(const v of c){b[v]=this._globalState[v];for(const S in this._layers){const P=this._layers[S],R=P.getLayoutAffectingGlobalStateRefs(),L=P.getPaintAffectingGlobalStateRefs(),F=P.getVisibilityAffectingGlobalStateRefs();if(R.has(v)&&p.add(P.source),L.has(v))for(const{name:j,value:J}of L.get(v))this._updatePaintProperty(P,j,J);F?.has(v)&&(P.recalculateVisibility(),this._updateLayer(P))}}this.dispatcher.broadcast("UGS",b);for(const v in this.tileManagers)p.has(v)&&(this._reloadSource(v),this._changed=!0)}loadURL(c,p={},b){this.fire(new o.l("dataloading",{dataType:"style"})),p.validate=typeof p.validate!="boolean"||p.validate;const v=this.map._requestManager.transformRequest(c,"Style");this._loadStyleRequest=new AbortController;const S=this._loadStyleRequest;o.j(v,this._loadStyleRequest).then(P=>{this._loadStyleRequest=null,this._load(P.data,p,b)}).catch(P=>{this._loadStyleRequest=null,P&&!S.signal.aborted&&this.fire(new o.k(P))})}loadJSON(c,p={},b){this.fire(new o.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,C.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,p.validate=p.validate!==!1,this._load(c,p,b)}).catch(()=>{})}loadEmpty(){this.fire(new o.l("dataloading",{dataType:"style"})),this._load(Nd,{validate:!1})}_load(c,p,b){var v,S;let P=p.transformStyle?p.transformStyle(b,c):c;if(!p.validate||!mh(this,o.C(P))){P=Object.assign({},P),this._loaded=!0,this.stylesheet=P;for(const R in P.sources)this.addSource(R,P.sources[R],{validate:!1});P.sprite?this._loadSprite(P.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(P.glyphs),this._createLayers(),this.light=new xr(this.stylesheet.light),this._setProjectionInternal(((v=this.stylesheet.projection)===null||v===void 0?void 0:v.type)||"mercator"),this.sky=new Jr(this.stylesheet.sky),this.map.setTerrain((S=this.stylesheet.terrain)!==null&&S!==void 0?S:null),this.fire(new o.l("data",{dataType:"style"})),this.fire(new o.l("style.load"))}}_createLayers(){var c,p,b;const v=o.bS(this.stylesheet.layers);this.setGlobalState((c=this.stylesheet.state)!==null&&c!==void 0?c:null),this.dispatcher.broadcast("SL",v),this._order=v.map(S=>S.id),this._layers={},this._serializedLayers=null;for(const S of v){const P=o.bT(S,this._globalState);if(P.setEventedParent(this,{layer:{id:S.id}}),this._layers[S.id]=P,o.bU(P)&&this.tileManagers[P.source]){const R=(b=(p=S.paint)===null||p===void 0?void 0:p["raster-fade-duration"])!==null&&b!==void 0?b:P.paint.get("raster-fade-duration");this.tileManagers[P.source].setRasterFadeDuration(R)}}}_loadSprite(c,p=!1,b=void 0){this.imageManager.setLoaded(!1);const v=new AbortController;let S;this._spriteRequest=v,function(P,R,L,F){return o._(this,void 0,void 0,function*(){const j=Y(P),J=L>1?"@2x":"",X={},Q={};for(const{id:ae,url:ge}of j){const ye=R.transformRequest(ce(ge,J,".json"),"SpriteJSON");X[ae]=o.j(ye,F);const me=R.transformRequest(ce(ge,J,".png"),"SpriteImage");Q[ae]=_e.getImage(me,F)}return yield Promise.all([...Object.values(X),...Object.values(Q)]),function(ae,ge){return o._(this,void 0,void 0,function*(){const ye={};for(const me in ae){ye[me]={};const we=C.getImageCanvasContext((yield ge[me]).data),De=(yield ae[me]).data;for(const Ae in De){const{width:Re,height:Le,x:Pe,y:$e,sdf:ct,pixelRatio:tt,stretchX:it,stretchY:st,content:Ot,textFitWidth:Lt,textFitHeight:St}=De[Ae];ye[me][Ae]={data:null,pixelRatio:tt,sdf:ct,stretchX:it,stretchY:st,content:Ot,textFitWidth:Lt,textFitHeight:St,spriteData:{width:Re,height:Le,x:Pe,y:$e,context:we}}}}return ye})}(X,Q)})}(c,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(P=>{if(this._spriteRequest=null,P)for(const R in P){this._spritesImagesIds[R]=[];const L=this._spritesImagesIds[R]?this._spritesImagesIds[R].filter(F=>!(F in P)):[];for(const F of L)this.imageManager.removeImage(F),this._changedImages[F]=!0;for(const F in P[R]){const j=R==="default"?F:`${R}:${F}`;this._spritesImagesIds[R].push(j),j in this.imageManager.images?this.imageManager.updateImage(j,P[R][F],!1):this.imageManager.addImage(j,P[R][F]),p&&(this._changedImages[j]=!0)}}}).catch(P=>{this._spriteRequest=null,S=P,v.signal.aborted||this.fire(new o.k(S))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),p&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"})),b&&b(S)})}_unloadSprite(){for(const c of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(c),this._changedImages[c]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}_validateLayer(c){const p=this.tileManagers[c.source];if(!p)return;const b=c.sourceLayer;if(!b)return;const v=p.getSource();(v.type==="geojson"||v.vectorLayerIds&&v.vectorLayerIds.indexOf(b)===-1)&&this.fire(new o.k(new Error(`Source layer "${b}" does not exist on source "${v.id}" as specified by style layer "${c.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const c in this.tileManagers)if(!this.tileManagers[c].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(c,p=!1){const b=this._serializedAllLayers();if(!c||c.length===0)return Object.values(p?o.bV(b):b);const v=[];for(const S of c)if(b[S]){const P=p?o.bV(b[S]):b[S];v.push(P)}return v}_serializedAllLayers(){let c=this._serializedLayers;if(c)return c;c=this._serializedLayers={};const p=Object.keys(this._layers);for(const b of p){const v=this._layers[b];v.type!=="custom"&&(c[b]=v.serialize())}return c}hasTransitions(){var c,p,b;if(!((c=this.light)===null||c===void 0)&&c.hasTransition()||!((p=this.sky)===null||p===void 0)&&p.hasTransition()||!((b=this.projection)===null||b===void 0)&&b.hasTransition())return!0;for(const v in this.tileManagers)if(this.tileManagers[v].hasTransition())return!0;for(const v in this._layers)if(this._layers[v].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(c){if(!this._loaded)return;const p=this._changed;if(p){const v=Object.keys(this._updatedLayers),S=Object.keys(this._removedLayers);(v.length||S.length)&&this._updateWorkerLayers(v,S);for(const P in this._updatedSources){const R=this._updatedSources[P];if(R==="reload")this._reloadSource(P);else{if(R!=="clear")throw new Error(`Invalid action ${R}`);this._clearSource(P)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const P in this._updatedPaintProps)this._layers[P].updateTransitions(c);this.light.updateTransitions(c),this.sky.updateTransitions(c),this._resetUpdates()}const b={};for(const v in this.tileManagers){const S=this.tileManagers[v];b[v]=S.used,S.used=!1}for(const v of this._order){const S=this._layers[v];S.recalculate(c,this._availableImages),!S.isHidden(c.zoom)&&S.source&&(this.tileManagers[S.source].used=!0)}for(const v in b){const S=this.tileManagers[v];!!b[v]!=!!S.used&&S.fire(new o.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:v}))}this.light.recalculate(c),this.sky.recalculate(c),this.projection.recalculate(c),this.z=c.zoom,p&&this.fire(new o.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const c=Object.keys(this._changedImages);if(c.length){for(const p in this.tileManagers)this.tileManagers[p].reloadTilesForDependencies(["icons","patterns"],c);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const c in this.tileManagers)this.tileManagers[c].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(c,p){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(c,!1),removedIds:p})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(c,p={}){var b;this._checkLoaded();const v=this.serialize();if(c=p.transformStyle?p.transformStyle(v,c):c,((b=p.validate)===null||b===void 0||b)&&mh(this,o.C(c)))return!1;(c=o.bV(c)).layers=o.bS(c.layers);const S=o.bW(v,c),P=this._getOperationsToPerform(S);if(P.unimplemented.length>0)throw new Error(`Unimplemented: ${P.unimplemented.join(", ")}.`);if(P.operations.length===0)return!1;for(const R of P.operations)R();return this.stylesheet=c,this._serializedLayers=null,!0}_getOperationsToPerform(c){const p=[],b=[];for(const v of c)switch(v.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":p.push(()=>this.addLayer.apply(this,v.args));break;case"removeLayer":p.push(()=>this.removeLayer.apply(this,v.args));break;case"setPaintProperty":p.push(()=>this.setPaintProperty.apply(this,v.args));break;case"setLayoutProperty":p.push(()=>this.setLayoutProperty.apply(this,v.args));break;case"setFilter":p.push(()=>this.setFilter.apply(this,v.args));break;case"addSource":p.push(()=>this.addSource.apply(this,v.args));break;case"removeSource":p.push(()=>this.removeSource.apply(this,v.args));break;case"setLayerZoomRange":p.push(()=>this.setLayerZoomRange.apply(this,v.args));break;case"setLight":p.push(()=>this.setLight.apply(this,v.args));break;case"setGeoJSONSourceData":p.push(()=>this.setGeoJSONSourceData.apply(this,v.args));break;case"setGlyphs":p.push(()=>this.setGlyphs.apply(this,v.args));break;case"setSprite":p.push(()=>this.setSprite.apply(this,v.args));break;case"setTerrain":p.push(()=>this.map.setTerrain.apply(this,v.args));break;case"setSky":p.push(()=>this.setSky.apply(this,v.args));break;case"setProjection":this.setProjection.apply(this,v.args);break;case"setGlobalState":p.push(()=>this.setGlobalState.apply(this,v.args));break;case"setTransition":p.push(()=>{});break;default:b.push(v.command)}return{operations:p,unimplemented:b}}addImage(c,p){if(this.getImage(c))return this.fire(new o.k(new Error(`An image named "${c}" already exists.`)));this.imageManager.addImage(c,p),this._afterImageUpdated(c)}updateImage(c,p){this.imageManager.updateImage(c,p)}getImage(c){return this.imageManager.getImage(c)}removeImage(c){if(!this.getImage(c))return this.fire(new o.k(new Error(`An image named "${c}" does not exist.`)));this.imageManager.removeImage(c),this._afterImageUpdated(c)}_afterImageUpdated(c){this._availableImages=this.imageManager.listImages(),this._changedImages[c]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(c,p,b={}){if(this._checkLoaded(),this.tileManagers[c]!==void 0)throw new Error(`Source "${c}" already exists.`);if(!p.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(p).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(p.type)>=0&&this._validate(o.C.source,`sources.${c}`,p,null,b))return;this.map&&this.map._collectResourceTiming&&(p.collectResourceTiming=!0);const v=this.tileManagers[c]=new Hs(c,p,this.dispatcher);v.style=this,v.setEventedParent(this,()=>({isSourceLoaded:v.loaded(),source:v.serialize(),sourceId:c})),v.onAdd(this.map),this._changed=!0}removeSource(c){if(this._checkLoaded(),this.tileManagers[c]===void 0)throw new Error("There is no source with this ID");for(const b in this._layers)if(this._layers[b].source===c)return this.fire(new o.k(new Error(`Source "${c}" cannot be removed while layer "${b}" is using it.`)));const p=this.tileManagers[c];delete this.tileManagers[c],delete this._updatedSources[c],p.fire(new o.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:c})),p.setEventedParent(null),p.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(c,p){if(this._checkLoaded(),this.tileManagers[c]===void 0)throw new Error(`There is no source with this ID=${c}`);const b=this.tileManagers[c].getSource();if(b.type!=="geojson")throw new Error(`geojsonSource.type is ${b.type}, which is !== 'geojson`);b.setData(p),this._changed=!0}getSource(c){return this.tileManagers[c]&&this.tileManagers[c].getSource()}addLayer(c,p,b={}){this._checkLoaded();const v=c.id;if(this.getLayer(v))return void this.fire(new o.k(new Error(`Layer "${v}" already exists on this map.`)));let S;if(c.type==="custom"){if(mh(this,o.bX(c)))return;S=o.bT(c,this._globalState)}else{if("source"in c&&typeof c.source=="object"&&(this.addSource(v,c.source),c=o.bV(c),c=o.e(c,{source:v})),this._validate(o.C.layer,`layers.${v}`,c,{arrayIndex:-1},b))return;S=o.bT(c,this._globalState),this._validateLayer(S),S.setEventedParent(this,{layer:{id:v}})}const P=p?this._order.indexOf(p):this._order.length;if(p&&P===-1)this.fire(new o.k(new Error(`Cannot add layer "${v}" before non-existing layer "${p}".`)));else{if(this._order.splice(P,0,v),this._layerOrderChanged=!0,this._layers[v]=S,this._removedLayers[v]&&S.source&&S.type!=="custom"){const R=this._removedLayers[v];delete this._removedLayers[v],R.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",this.tileManagers[S.source].pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map)}}moveLayer(c,p){if(this._checkLoaded(),this._changed=!0,!this._layers[c])return void this.fire(new o.k(new Error(`The layer '${c}' does not exist in the map's style and cannot be moved.`)));if(c===p)return;const b=this._order.indexOf(c);this._order.splice(b,1);const v=p?this._order.indexOf(p):this._order.length;p&&v===-1?this.fire(new o.k(new Error(`Cannot move layer "${c}" before non-existing layer "${p}".`))):(this._order.splice(v,0,c),this._layerOrderChanged=!0)}removeLayer(c){this._checkLoaded();const p=this._layers[c];if(!p)return void this.fire(new o.k(new Error(`Cannot remove non-existing layer "${c}".`)));p.setEventedParent(null);const b=this._order.indexOf(c);this._order.splice(b,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[c]=p,delete this._layers[c],this._serializedLayers&&delete this._serializedLayers[c],delete this._updatedLayers[c],delete this._updatedPaintProps[c],p.onRemove&&p.onRemove(this.map)}getLayer(c){return this._layers[c]}getLayersOrder(){return[...this._order]}hasLayer(c){return c in this._layers}setLayerZoomRange(c,p,b){this._checkLoaded();const v=this.getLayer(c);v?v.minzoom===p&&v.maxzoom===b||(p!=null&&(v.minzoom=p),b!=null&&(v.maxzoom=b),this._updateLayer(v)):this.fire(new o.k(new Error(`Cannot set the zoom range of non-existing layer "${c}".`)))}setFilter(c,p,b={}){this._checkLoaded();const v=this.getLayer(c);if(v){if(!o.bR(v.filter,p))return p==null?(v.setFilter(void 0),void this._updateLayer(v)):void(this._validate(o.C.filter,`layers.${v.id}.filter`,p,null,b)||(v.setFilter(o.bV(p)),this._updateLayer(v)))}else this.fire(new o.k(new Error(`Cannot filter non-existing layer "${c}".`)))}getFilter(c){return o.bV(this.getLayer(c).filter)}setLayoutProperty(c,p,b,v={}){this._checkLoaded();const S=this.getLayer(c);S?o.bR(S.getLayoutProperty(p),b)||(S.setLayoutProperty(p,b,v),this._updateLayer(S)):this.fire(new o.k(new Error(`Cannot style non-existing layer "${c}".`)))}getLayoutProperty(c,p){const b=this.getLayer(c);if(b)return b.getLayoutProperty(p);this.fire(new o.k(new Error(`Cannot get style of non-existing layer "${c}".`)))}setPaintProperty(c,p,b,v={}){this._checkLoaded();const S=this.getLayer(c);S?o.bR(S.getPaintProperty(p),b)||this._updatePaintProperty(S,p,b,v):this.fire(new o.k(new Error(`Cannot style non-existing layer "${c}".`)))}_updatePaintProperty(c,p,b,v={}){c.setPaintProperty(p,b,v)&&this._updateLayer(c),o.bU(c)&&p==="raster-fade-duration"&&this.tileManagers[c.source].setRasterFadeDuration(b),this._changed=!0,this._updatedPaintProps[c.id]=!0,this._serializedLayers=null}getPaintProperty(c,p){return this.getLayer(c).getPaintProperty(p)}setFeatureState(c,p){this._checkLoaded();const b=c.source,v=c.sourceLayer,S=this.tileManagers[b];if(S===void 0)return void this.fire(new o.k(new Error(`The source '${b}' does not exist in the map's style.`)));const P=S.getSource().type;P==="geojson"&&v?this.fire(new o.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):P!=="vector"||v?(c.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),S.setFeatureState(v,c.id,p)):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(c,p){this._checkLoaded();const b=c.source,v=this.tileManagers[b];if(v===void 0)return void this.fire(new o.k(new Error(`The source '${b}' does not exist in the map's style.`)));const S=v.getSource().type,P=S==="vector"?c.sourceLayer:void 0;S!=="vector"||P?p&&typeof c.id!="string"&&typeof c.id!="number"?this.fire(new o.k(new Error("A feature id is required to remove its specific state property."))):v.removeFeatureState(P,c.id,p):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(c){this._checkLoaded();const p=c.source,b=c.sourceLayer,v=this.tileManagers[p];if(v!==void 0)return v.getSource().type!=="vector"||b?(c.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),v.getFeatureState(b,c.id)):void this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.k(new Error(`The source '${p}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const c=o.bY(this.tileManagers,S=>S.serialize()),p=this._serializeByIds(this._order,!0),b=this.map.getTerrain()||void 0,v=this.stylesheet;return o.bZ({version:v.version,name:v.name,metadata:v.metadata,light:v.light,sky:v.sky,center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch,sprite:v.sprite,glyphs:v.glyphs,transition:v.transition,projection:v.projection,sources:c,layers:p,terrain:b},S=>S!==void 0)}_updateLayer(c){this._updatedLayers[c.id]=!0,c.source&&!this._updatedSources[c.source]&&this.tileManagers[c.source].getSource().type!=="raster"&&(this._updatedSources[c.source]="reload",this.tileManagers[c.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(c){const p=P=>this._layers[P].type==="fill-extrusion",b={},v=[];for(let P=this._order.length-1;P>=0;P--){const R=this._order[P];if(p(R)){b[R]=P;for(const L of c){const F=L[R];if(F)for(const j of F)v.push(j)}}}v.sort((P,R)=>R.intersectionZ-P.intersectionZ);const S=[];for(let P=this._order.length-1;P>=0;P--){const R=this._order[P];if(p(R))for(let L=v.length-1;L>=0;L--){const F=v[L].feature;if(b[F.layer.id]<P)break;S.push(F),v.pop()}else for(const L of c){const F=L[R];if(F)for(const j of F)S.push(j.feature)}}return S}queryRenderedFeatures(c,p,b){p&&p.filter&&this._validate(o.C.filter,"queryRenderedFeatures.filter",p.filter,null,p);const v={};if(p&&p.layers){if(!(Array.isArray(p.layers)||p.layers instanceof Set))return this.fire(new o.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const F of p.layers){const j=this._layers[F];if(!j)return this.fire(new o.k(new Error(`The layer '${F}' does not exist in the map's style and cannot be queried for features.`))),[];v[j.source]=!0}}const S=[];p.availableImages=this._availableImages;const P=this._serializedAllLayers(),R=p.layers instanceof Set?p.layers:Array.isArray(p.layers)?new Set(p.layers):null,L=Object.assign(Object.assign({},p),{layers:R,globalState:this._globalState});for(const F in this.tileManagers)p.layers&&!v[F]||S.push(ve(this.tileManagers[F],this._layers,P,c,L,b,this.map.terrain?(j,J,X)=>this.map.terrain.getElevation(j,J,X):void 0));return this.placement&&S.push(function(F,j,J,X,Q,ae,ge){const ye={},me=ae.queryRenderedSymbols(X),we=[];for(const De of Object.keys(me).map(Number))we.push(ge[De]);we.sort(Ee);for(const De of we){const Ae=De.featureIndex.lookupSymbolFeatures(me[De.bucketInstanceId],j,De.bucketIndex,De.sourceLayerIndex,{filterSpec:Q.filter,globalState:Q.globalState},Q.layers,Q.availableImages,F);for(const Re in Ae){const Le=ye[Re]=ye[Re]||[],Pe=Ae[Re];Pe.sort(($e,ct)=>{const tt=De.featureSortOrder;if(tt){const it=tt.indexOf($e.featureIndex);return tt.indexOf(ct.featureIndex)-it}return ct.featureIndex-$e.featureIndex});for(const $e of Pe)Le.push($e)}}return function(De,Ae,Re){for(const Le in De)for(const Pe of De[Le])He(Pe,Re[Ae[Le].source]);return De}(ye,F,J)}(this._layers,P,this.tileManagers,c,L,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(S)}querySourceFeatures(c,p){p?.filter&&this._validate(o.C.filter,"querySourceFeatures.filter",p.filter,null,p);const b=this.tileManagers[c];return b?function(v,S){const P=v.getRenderableIds().map(F=>v.getTileByID(F)),R=[],L={};for(let F=0;F<P.length;F++){const j=P[F],J=j.tileID.canonical.key;L[J]||(L[J]=!0,j.querySourceFeatures(R,S))}return R}(b,p?Object.assign(Object.assign({},p),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(c,p={}){this._checkLoaded();const b=this.light.getLight();let v=!1;for(const P in c)if(!o.bR(c[P],b[P])){v=!0;break}if(!v)return;const S={now:k(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(c,p),this.light.updateTransitions(S)}getProjection(){var c;return(c=this.stylesheet)===null||c===void 0?void 0:c.projection}setProjection(c){if(this._checkLoaded(),this.projection){if(this.projection.name===c.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=c,this._setProjectionInternal(c.type)}getSky(){var c;return(c=this.stylesheet)===null||c===void 0?void 0:c.sky}setSky(c,p={}){this._checkLoaded();const b=this.getSky();let v=!1;if(!c&&!b)return;if(c&&!b)v=!0;else if(!c&&b)v=!0;else for(const P in c)if(!o.bR(c[P],b[P])){v=!0;break}if(!v)return;const S={now:k(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=c,this.sky.setSky(c,p),this.sky.updateTransitions(S)}_setProjectionInternal(c){const p=function(b,v){const S={constrainOverride:v};if(Array.isArray(b)){const P=new hA({type:b});return{projection:P,transform:new gh(S),cameraHelper:new pA(P)}}switch(b){case"mercator":return{projection:new Xs,transform:new iu(S),cameraHelper:new su};case"globe":{const P=new hA({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:P,transform:new gh(S),cameraHelper:new pA(P)}}case"vertical-perspective":return{projection:new Ny,transform:new ph(S),cameraHelper:new Ui};default:return o.w(`Unknown projection name: ${b}. Falling back to mercator projection.`),{projection:new Xs,transform:new iu(S),cameraHelper:new su}}}(c,this.map.transformConstrain);this.projection=p.projection,this.map.migrateProjection(p.transform,p.cameraHelper);for(const b in this.tileManagers)this.tileManagers[b].reload()}_validate(c,p,b,v,S={}){return(!S||S.validate!==!1)&&mh(this,c.call(o.C,o.e({key:p,style:this.serialize(),value:b,styleSpec:o.u},v)))}_remove(c=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Ge().off(Be,this._rtlPluginLoaded);for(const p in this._layers)this._layers[p].setEventedParent(null);for(const p in this.tileManagers){const b=this.tileManagers[p];b.setEventedParent(null),b.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),c&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(c)}_clearSource(c){this.tileManagers[c].clearTiles()}_reloadSource(c){this.tileManagers[c].resume(),this.tileManagers[c].reload()}_updateSources(c){for(const p in this.tileManagers)this.tileManagers[p].update(c,this.map.terrain)}_generateCollisionBoxes(){for(const c in this.tileManagers)this._reloadSource(c)}_updatePlacement(c,p,b,v,S=!1){let P=!1,R=!1;const L={};for(const F of this._order){const j=this._layers[F];if(j.type!=="symbol")continue;if(!L[j.source]){const X=this.tileManagers[j.source];L[j.source]=X.getRenderableIds(!0).map(Q=>X.getTileByID(Q)).sort((Q,ae)=>ae.tileID.overscaledZ-Q.tileID.overscaledZ||(Q.tileID.isLessThan(ae.tileID)?-1:1))}const J=this.crossTileSymbolIndex.addLayer(j,L[j.source],c.center.lng);P=P||J}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((S=S||this._layerOrderChanged||b===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(k(),c.zoom))&&(this.pauseablePlacement=new fc(c,this.map.terrain,this._order,S,p,b,v,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,L),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(k()),R=!0),P&&this.pauseablePlacement.placement.setStale()),R||P)for(const F of this._order){const j=this._layers[F];j.type==="symbol"&&this.placement.updateLayerOpacities(j,L[j.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(k())}_releaseSymbolFadeTiles(){for(const c in this.tileManagers)this.tileManagers[c].releaseSymbolFadeTiles()}getImages(c,p){return o._(this,void 0,void 0,function*(){const b=yield this.imageManager.getImages(p.icons);this._updateTilesForChangedImages();const v=this.tileManagers[p.source];return v&&v.setDependencies(p.tileID.key,p.type,p.icons),b})}getGlyphs(c,p){return o._(this,void 0,void 0,function*(){const b=yield this.glyphManager.getGlyphs(p.stacks),v=this.tileManagers[p.source];return v&&v.setDependencies(p.tileID.key,p.type,[""]),b})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(c,p={}){this._checkLoaded(),c&&this._validate(o.C.glyphs,"glyphs",c,null,p)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=c,this.glyphManager.entries={},this.glyphManager.setURL(c))}getDashes(c,p){return o._(this,void 0,void 0,function*(){const b={};for(const[v,S]of Object.entries(p.dashes))b[v]=this.lineAtlas.getDash(S.dasharray,S.round);return b})}addSprite(c,p,b={},v){this._checkLoaded();const S=[{id:c,url:p}],P=[...Y(this.stylesheet.sprite),...S];this._validate(o.C.sprite,"sprite",P,null,b)||(this.stylesheet.sprite=P,this._loadSprite(S,!0,v))}removeSprite(c){this._checkLoaded();const p=Y(this.stylesheet.sprite);if(p.find(b=>b.id===c)){if(this._spritesImagesIds[c])for(const b of this._spritesImagesIds[c])this.imageManager.removeImage(b),this._changedImages[b]=!0;p.splice(p.findIndex(b=>b.id===c),1),this.stylesheet.sprite=p.length>0?p:void 0,delete this._spritesImagesIds[c],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}else this.fire(new o.k(new Error(`Sprite "${c}" doesn't exists on this map.`)))}getSprite(){return Y(this.stylesheet.sprite)}setSprite(c,p={},b){this._checkLoaded(),c&&this._validate(o.C.sprite,"sprite",c,null,p)||(this.stylesheet.sprite=c,c?this._loadSprite(c,!0,b):(this._unloadSprite(),b&&b(null)))}destroy(){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null);for(const c in this.tileManagers){const p=this.tileManagers[c];p.setEventedParent(null),p.onRemove(this.map)}this.tileManagers={},this.imageManager&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this._availableImages=[],this._spritesImagesIds={}),this.glyphManager&&this.glyphManager.destroy();for(const c in this._layers){const p=this._layers[c];p.setEventedParent(null),p.onRemove&&p.onRemove(this.map)}this._setInitialValues(),this.setEventedParent(null),this.dispatcher.unregisterMessageHandler("GG"),this.dispatcher.unregisterMessageHandler("GI"),this.dispatcher.unregisterMessageHandler("GDA"),this.dispatcher.remove(!0),this._listeners={},this._oneTimeListeners={}}}var x2=o.aU([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Rp{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(c,p,b,v,S,P,R,L,F){this.context=c;let j=this.boundPaintVertexBuffers.length!==v.length;for(let J=0;!j&&J<v.length;J++)this.boundPaintVertexBuffers[J]!==v[J]&&(j=!0);!this.vao||this.boundProgram!==p||this.boundLayoutVertexBuffer!==b||j||this.boundIndexBuffer!==S||this.boundVertexOffset!==P||this.boundDynamicVertexBuffer!==R||this.boundDynamicVertexBuffer2!==L||this.boundDynamicVertexBuffer3!==F?this.freshBind(p,b,v,S,P,R,L,F):(c.bindVertexArray.set(this.vao),R&&R.bind(),S&&S.dynamicDraw&&S.bind(),L&&L.bind(),F&&F.bind())}freshBind(c,p,b,v,S,P,R,L){const F=c.numAttributes,j=this.context,J=j.gl;this.vao&&this.destroy(),this.vao=j.createVertexArray(),j.bindVertexArray.set(this.vao),this.boundProgram=c,this.boundLayoutVertexBuffer=p,this.boundPaintVertexBuffers=b,this.boundIndexBuffer=v,this.boundVertexOffset=S,this.boundDynamicVertexBuffer=P,this.boundDynamicVertexBuffer2=R,this.boundDynamicVertexBuffer3=L,p.enableAttributes(J,c);for(const X of b)X.enableAttributes(J,c);P&&P.enableAttributes(J,c),R&&R.enableAttributes(J,c),L&&L.enableAttributes(J,c),p.bind(),p.setVertexAttribPointers(J,c,S);for(const X of b)X.bind(),X.setVertexAttribPointers(J,c,S);P&&(P.bind(),P.setVertexAttribPointers(J,c,S)),v&&v.bind(),R&&(R.bind(),R.setVertexAttribPointers(J,c,S)),L&&(L.bind(),L.setVertexAttribPointers(J,c,S)),j.currentNumAttributes=F}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const w2=(T,c,p,b,v)=>({u_texture:0,u_ele_delta:T,u_fog_matrix:c,u_fog_color:p?p.properties.get("fog-color"):o.bp.white,u_fog_ground_blend:p?p.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:v?0:p?p.calculateFogBlendOpacity(b):0,u_horizon_color:p?p.properties.get("horizon-color"):o.bp.white,u_horizon_fog_blend:p?p.properties.get("horizon-fog-blend"):1,u_is_globe_mode:v?1:0}),yh={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function kp(T){const c=[];for(let p=0;p<T.length;p++){if(T[p]===null)continue;const b=T[p].split(" ");c.push(b.pop())}return c}class gA{constructor(c,p,b,v,S,P,R,L,F=[]){const j=c.gl;this.program=j.createProgram();const J=kp(p.staticAttributes),X=b?b.getBinderAttributes():[],Q=J.concat(X),ae=Zr.prelude.staticUniforms?kp(Zr.prelude.staticUniforms):[],ge=R.staticUniforms?kp(R.staticUniforms):[],ye=p.staticUniforms?kp(p.staticUniforms):[],me=b?b.getBinderUniforms():[],we=ae.concat(ge).concat(ye).concat(me),De=[];for(const tt of we)De.indexOf(tt)<0&&De.push(tt);const Ae=b?b.defines():[];Wo(j)&&Ae.unshift("#version 300 es"),S&&Ae.push("#define OVERDRAW_INSPECTOR;"),P&&Ae.push("#define TERRAIN3D;"),L&&Ae.push(L),F&&Ae.push(...F);let Re=Ae.concat(Zr.prelude.fragmentSource,R.fragmentSource,p.fragmentSource).join(`
`),Le=Ae.concat(Zr.prelude.vertexSource,R.vertexSource,p.vertexSource).join(`
`);Wo(j)||(Re=function(tt){return tt.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(Re),Le=function(tt){return tt.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Le));const Pe=j.createShader(j.FRAGMENT_SHADER);if(j.isContextLost())return void(this.failedToCreate=!0);if(j.shaderSource(Pe,Re),j.compileShader(Pe),!j.getShaderParameter(Pe,j.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${j.getShaderInfoLog(Pe)}`);j.attachShader(this.program,Pe);const $e=j.createShader(j.VERTEX_SHADER);if(j.isContextLost())return void(this.failedToCreate=!0);if(j.shaderSource($e,Le),j.compileShader($e),!j.getShaderParameter($e,j.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${j.getShaderInfoLog($e)}`);j.attachShader(this.program,$e),this.attributes={};const ct={};this.numAttributes=Q.length;for(let tt=0;tt<this.numAttributes;tt++)Q[tt]&&(j.bindAttribLocation(this.program,tt,Q[tt]),this.attributes[Q[tt]]=tt);if(j.linkProgram(this.program),!j.getProgramParameter(this.program,j.LINK_STATUS))throw new Error(`Program failed to link: ${j.getProgramInfoLog(this.program)}`);j.deleteShader($e),j.deleteShader(Pe);for(let tt=0;tt<De.length;tt++){const it=De[tt];if(it&&!ct[it]){const st=j.getUniformLocation(this.program,it);st&&(ct[it]=st)}}this.fixedUniforms=v(c,ct),this.terrainUniforms=((tt,it)=>({u_depth:new o.b_(tt,it.u_depth),u_terrain:new o.b_(tt,it.u_terrain),u_terrain_dim:new o.bq(tt,it.u_terrain_dim),u_terrain_matrix:new o.c0(tt,it.u_terrain_matrix),u_terrain_unpack:new o.c1(tt,it.u_terrain_unpack),u_terrain_exaggeration:new o.bq(tt,it.u_terrain_exaggeration)}))(c,ct),this.projectionUniforms=((tt,it)=>({u_projection_matrix:new o.c0(tt,it.u_projection_matrix),u_projection_tile_mercator_coords:new o.c1(tt,it.u_projection_tile_mercator_coords),u_projection_clipping_plane:new o.c1(tt,it.u_projection_clipping_plane),u_projection_transition:new o.bq(tt,it.u_projection_transition),u_projection_fallback_matrix:new o.c0(tt,it.u_projection_fallback_matrix)}))(c,ct),this.binderUniforms=b?b.getUniforms(c,ct):[]}draw(c,p,b,v,S,P,R,L,F,j,J,X,Q,ae,ge,ye,me,we,De){const Ae=c.gl;if(this.failedToCreate)return;if(c.program.set(this.program),c.setDepthMode(b),c.setStencilMode(v),c.setColorMode(S),c.setCullFace(P),L){c.activeTexture.set(Ae.TEXTURE2),Ae.bindTexture(Ae.TEXTURE_2D,L.depthTexture),c.activeTexture.set(Ae.TEXTURE3),Ae.bindTexture(Ae.TEXTURE_2D,L.texture);for(const Le in this.terrainUniforms)this.terrainUniforms[Le].set(L[Le])}if(F)for(const Le in F)this.projectionUniforms[yh[Le]].set(F[Le]);if(R)for(const Le in this.fixedUniforms)this.fixedUniforms[Le].set(R[Le]);ye&&ye.setUniforms(c,this.binderUniforms,ae,{zoom:ge});let Re=0;switch(p){case Ae.LINES:Re=2;break;case Ae.TRIANGLES:Re=3;break;case Ae.LINE_STRIP:Re=1}for(const Le of Q.get()){const Pe=Le.vaos||(Le.vaos={});(Pe[j]||(Pe[j]=new Rp)).bind(c,this,J,ye?ye.getPaintVertexBuffers():[],X,Le.vertexOffset,me,we,De),Ae.drawElements(p,Le.primitiveLength*Re,Ae.UNSIGNED_SHORT,Le.primitiveOffset*Re*2)}}}function mA(T,c,p){const b=1/o.aN(p,1,c.transform.tileZoom),v=Math.pow(2,p.tileID.overscaledZ),S=p.tileSize*Math.pow(2,c.transform.tileZoom)/v,P=S*(p.tileID.canonical.x+p.tileID.wrap*v),R=S*p.tileID.canonical.y;return{u_image:0,u_texsize:p.imageAtlasTexture.size,u_scale:[b,T.fromScale,T.toScale],u_fade:T.t,u_pixel_coord_upper:[P>>16,R>>16],u_pixel_coord_lower:[65535&P,65535&R]}}const Vy=(T,c,p,b)=>{const v=T.style.light,S=v.properties.get("position"),P=[S.x,S.y,S.z],R=o.c4();v.properties.get("anchor")==="viewport"&&o.c5(R,T.transform.bearingInRadians),o.c6(P,P,R);const L=T.transform.transformLightDirection(P),F=v.properties.get("color");return{u_lightpos:P,u_lightpos_globe:L,u_lightintensity:v.properties.get("intensity"),u_lightcolor:[F.r,F.g,F.b],u_vertical_gradient:+c,u_opacity:p,u_fill_translate:b}},$y=(T,c,p,b,v,S,P)=>o.e(Vy(T,c,p,b),mA(S,T,P),{u_height_factor:-Math.pow(2,v.overscaledZ)/P.tileSize/8}),jy=(T,c,p,b)=>o.e(mA(c,T,p),{u_fill_translate:b}),yA=(T,c)=>({u_world:T,u_fill_translate:c}),bA=(T,c,p,b,v)=>o.e(jy(T,c,p,v),{u_world:b}),_A=(T,c,p,b,v)=>{const S=T.transform;let P,R,L=0;if(p.paint.get("circle-pitch-alignment")==="map"){const F=o.aN(c,1,S.zoom);P=!0,R=[F,F],L=F/(o.a5*Math.pow(2,c.tileID.overscaledZ))*2*Math.PI*v}else P=!1,R=S.pixelsToGLUnits;return{u_camera_to_center_distance:S.cameraToCenterDistance,u_scale_with_map:+(p.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+P,u_device_pixel_ratio:T.pixelRatio,u_extrude_scale:R,u_globe_extrude_scale:L,u_translate:b}},lu=T=>({u_pixel_extrude_scale:[1/T.width,1/T.height]}),vA=T=>({u_viewport_size:[T.width,T.height]}),Gy=(T,c=1)=>({u_color:T,u_overlay:0,u_overlay_scale:c}),bh=(T,c,p,b)=>{const v=o.aN(T,1,c)/(o.a5*Math.pow(2,T.tileID.overscaledZ))*2*Math.PI*b;return{u_extrude_scale:o.aN(T,1,c),u_intensity:p,u_globe_extrude_scale:v}},AA=(T,c,p,b)=>{const v=o.N();o.c7(v,0,T.width,T.height,0,0,1);const S=T.context.gl;return{u_matrix:v,u_world:[S.drawingBufferWidth,S.drawingBufferHeight],u_image:p,u_color_ramp:b,u_opacity:c.paint.get("heatmap-opacity")}},Op=(T,c,p)=>{const b=p.paint.get("hillshade-accent-color");let v;switch(p.paint.get("hillshade-method")){case"basic":v=4;break;case"combined":v=1;break;case"igor":v=2;break;case"multidirectional":v=3;break;default:v=0}const S=p.getIlluminationProperties();for(let P=0;P<S.directionRadians.length;P++)p.paint.get("hillshade-illumination-anchor")==="viewport"&&(S.directionRadians[P]+=T.transform.bearingInRadians);return{u_image:0,u_latrange:T2(0,c.tileID),u_exaggeration:p.paint.get("hillshade-exaggeration"),u_altitudes:S.altitudeRadians,u_azimuths:S.directionRadians,u_accent:b,u_method:v,u_highlights:S.highlightColor,u_shadows:S.shadowColor}},C2=(T,c)=>{const p=c.stride,b=o.N();return o.c7(b,0,o.a5,-o.a5,0,0,1),o.O(b,b,[0,-o.a5,0]),{u_matrix:b,u_image:1,u_dimension:[p,p],u_zoom:T.overscaledZ,u_unpack:c.getUnpackVector()}};function T2(T,c){const p=Math.pow(2,c.canonical.z),b=c.canonical.y;return[new o.a9(0,b/p).toLngLat().lat,new o.a9(0,(b+1)/p).toLngLat().lat]}const xA=(T,c,p=0)=>({u_image:0,u_unpack:c.getUnpackVector(),u_dimension:[c.stride,c.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:p,u_opacity:T.paint.get("color-relief-opacity")}),Fd=(T,c,p,b)=>{const v=T.transform;return{u_translation:Lp(T,c,p),u_ratio:b/o.aN(c,1,v.zoom),u_device_pixel_ratio:T.pixelRatio,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},wA=(T,c,p,b,v)=>o.e(Fd(T,c,p,b),{u_image:0,u_image_height:v}),Hy=(T,c,p,b,v)=>{const S=T.transform,P=ba(c,S);return{u_translation:Lp(T,c,p),u_texsize:c.imageAtlasTexture.size,u_ratio:b/o.aN(c,1,S.zoom),u_device_pixel_ratio:T.pixelRatio,u_image:0,u_scale:[P,v.fromScale,v.toScale],u_fade:v.t,u_units_to_pixels:[1/S.pixelsToGLUnits[0],1/S.pixelsToGLUnits[1]]}},CA=(T,c,p,b,v)=>{const S=ba(c,T.transform);return o.e(Fd(T,c,p,b),{u_tileratio:S,u_crossfade_from:v.fromScale,u_crossfade_to:v.toScale,u_image:0,u_mix:v.t,u_lineatlas_width:T.lineAtlas.width,u_lineatlas_height:T.lineAtlas.height})},Dp=(T,c,p,b,v,S)=>{const P=ba(c,T.transform);return o.e(Fd(T,c,p,b),{u_image:0,u_image_height:S,u_tileratio:P,u_crossfade_from:v.fromScale,u_crossfade_to:v.toScale,u_image_dash:1,u_mix:v.t,u_lineatlas_width:T.lineAtlas.width,u_lineatlas_height:T.lineAtlas.height})};function ba(T,c){return 1/o.aN(T,1,c.tileZoom)}function Lp(T,c,p){return o.aO(T.transform,c,p.paint.get("line-translate"),p.paint.get("line-translate-anchor"))}const Wy=(T,c,p,b,v)=>{return{u_tl_parent:T,u_scale_parent:c,u_buffer_scale:1,u_fade_t:p.mix,u_opacity:p.opacity*b.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:b.paint.get("raster-brightness-min"),u_brightness_high:b.paint.get("raster-brightness-max"),u_saturation_factor:(P=b.paint.get("raster-saturation"),P>0?1-1/(1.001-P):-P),u_contrast_factor:(S=b.paint.get("raster-contrast"),S>0?1/(1-S):1+S),u_spin_weights:Ky(b.paint.get("raster-hue-rotate")),u_coords_top:[v[0].x,v[0].y,v[1].x,v[1].y],u_coords_bottom:[v[3].x,v[3].y,v[2].x,v[2].y]};var S,P};function Ky(T){T*=Math.PI/180;const c=Math.sin(T),p=Math.cos(T);return[(2*p+1)/3,(-Math.sqrt(3)*c-p+1)/3,(Math.sqrt(3)*c-p+1)/3]}const Xy=(T,c,p,b,v,S,P,R,L,F,j,J,X)=>{const Q=P.transform;return{u_is_size_zoom_constant:+(T==="constant"||T==="source"),u_is_size_feature_constant:+(T==="constant"||T==="camera"),u_size_t:c?c.uSizeT:0,u_size:c?c.uSize:0,u_camera_to_center_distance:Q.cameraToCenterDistance,u_pitch:Q.pitch/360*2*Math.PI,u_rotate_symbol:+p,u_aspect_ratio:Q.width/Q.height,u_fade_change:P.options.fadeDuration?P.symbolFadeChange:1,u_label_plane_matrix:R,u_coord_matrix:L,u_is_text:+j,u_pitch_with_map:+b,u_is_along_line:v,u_is_variable_anchor:S,u_texsize:J,u_texture:0,u_translation:F,u_pitched_scale:X}},Np=(T,c,p,b,v,S,P,R,L,F,j,J,X,Q)=>{const ae=P.transform;return o.e(Xy(T,c,p,b,v,S,P,R,L,F,j,J,Q),{u_gamma_scale:b?Math.cos(ae.pitch*Math.PI/180)*ae.cameraToCenterDistance:1,u_device_pixel_ratio:P.pixelRatio,u_is_halo:1})},cu=(T,c,p,b,v,S,P,R,L,F,j,J,X)=>o.e(Np(T,c,p,b,v,S,P,R,L,F,!0,j,0,X),{u_texsize_icon:J,u_texture_icon:1}),Jy=(T,c)=>({u_opacity:T,u_color:c}),S2=(T,c,p,b,v)=>o.e(function(S,P,R,L){const F=R.imageManager.getPattern(S.from.toString()),j=R.imageManager.getPattern(S.to.toString()),{width:J,height:X}=R.imageManager.getPixelSize(),Q=Math.pow(2,L.tileID.overscaledZ),ae=L.tileSize*Math.pow(2,R.transform.tileZoom)/Q,ge=ae*(L.tileID.canonical.x+L.tileID.wrap*Q),ye=ae*L.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:F.tl,u_pattern_br_a:F.br,u_pattern_tl_b:j.tl,u_pattern_br_b:j.br,u_texsize:[J,X],u_mix:P.t,u_pattern_size_a:F.displaySize,u_pattern_size_b:j.displaySize,u_scale_a:P.fromScale,u_scale_b:P.toScale,u_tile_units_to_pixels:1/o.aN(L,1,R.transform.tileZoom),u_pixel_coord_upper:[ge>>16,ye>>16],u_pixel_coord_lower:[65535&ge,65535&ye]}}(p,v,c,b),{u_opacity:T}),TA=(T,c)=>{},E2={fillExtrusion:(T,c)=>({u_lightpos:new o.c2(T,c.u_lightpos),u_lightpos_globe:new o.c2(T,c.u_lightpos_globe),u_lightintensity:new o.bq(T,c.u_lightintensity),u_lightcolor:new o.c2(T,c.u_lightcolor),u_vertical_gradient:new o.bq(T,c.u_vertical_gradient),u_opacity:new o.bq(T,c.u_opacity),u_fill_translate:new o.c3(T,c.u_fill_translate)}),fillExtrusionPattern:(T,c)=>({u_lightpos:new o.c2(T,c.u_lightpos),u_lightpos_globe:new o.c2(T,c.u_lightpos_globe),u_lightintensity:new o.bq(T,c.u_lightintensity),u_lightcolor:new o.c2(T,c.u_lightcolor),u_vertical_gradient:new o.bq(T,c.u_vertical_gradient),u_height_factor:new o.bq(T,c.u_height_factor),u_opacity:new o.bq(T,c.u_opacity),u_fill_translate:new o.c3(T,c.u_fill_translate),u_image:new o.b_(T,c.u_image),u_texsize:new o.c3(T,c.u_texsize),u_pixel_coord_upper:new o.c3(T,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(T,c.u_pixel_coord_lower),u_scale:new o.c2(T,c.u_scale),u_fade:new o.bq(T,c.u_fade)}),fill:(T,c)=>({u_fill_translate:new o.c3(T,c.u_fill_translate)}),fillPattern:(T,c)=>({u_image:new o.b_(T,c.u_image),u_texsize:new o.c3(T,c.u_texsize),u_pixel_coord_upper:new o.c3(T,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(T,c.u_pixel_coord_lower),u_scale:new o.c2(T,c.u_scale),u_fade:new o.bq(T,c.u_fade),u_fill_translate:new o.c3(T,c.u_fill_translate)}),fillOutline:(T,c)=>({u_world:new o.c3(T,c.u_world),u_fill_translate:new o.c3(T,c.u_fill_translate)}),fillOutlinePattern:(T,c)=>({u_world:new o.c3(T,c.u_world),u_image:new o.b_(T,c.u_image),u_texsize:new o.c3(T,c.u_texsize),u_pixel_coord_upper:new o.c3(T,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(T,c.u_pixel_coord_lower),u_scale:new o.c2(T,c.u_scale),u_fade:new o.bq(T,c.u_fade),u_fill_translate:new o.c3(T,c.u_fill_translate)}),circle:(T,c)=>({u_camera_to_center_distance:new o.bq(T,c.u_camera_to_center_distance),u_scale_with_map:new o.b_(T,c.u_scale_with_map),u_pitch_with_map:new o.b_(T,c.u_pitch_with_map),u_extrude_scale:new o.c3(T,c.u_extrude_scale),u_device_pixel_ratio:new o.bq(T,c.u_device_pixel_ratio),u_globe_extrude_scale:new o.bq(T,c.u_globe_extrude_scale),u_translate:new o.c3(T,c.u_translate)}),collisionBox:(T,c)=>({u_pixel_extrude_scale:new o.c3(T,c.u_pixel_extrude_scale)}),collisionCircle:(T,c)=>({u_viewport_size:new o.c3(T,c.u_viewport_size)}),debug:(T,c)=>({u_color:new o.b$(T,c.u_color),u_overlay:new o.b_(T,c.u_overlay),u_overlay_scale:new o.bq(T,c.u_overlay_scale)}),depth:TA,clippingMask:TA,heatmap:(T,c)=>({u_extrude_scale:new o.bq(T,c.u_extrude_scale),u_intensity:new o.bq(T,c.u_intensity),u_globe_extrude_scale:new o.bq(T,c.u_globe_extrude_scale)}),heatmapTexture:(T,c)=>({u_matrix:new o.c0(T,c.u_matrix),u_world:new o.c3(T,c.u_world),u_image:new o.b_(T,c.u_image),u_color_ramp:new o.b_(T,c.u_color_ramp),u_opacity:new o.bq(T,c.u_opacity)}),hillshade:(T,c)=>({u_image:new o.b_(T,c.u_image),u_latrange:new o.c3(T,c.u_latrange),u_exaggeration:new o.bq(T,c.u_exaggeration),u_altitudes:new o.c9(T,c.u_altitudes),u_azimuths:new o.c9(T,c.u_azimuths),u_accent:new o.b$(T,c.u_accent),u_method:new o.b_(T,c.u_method),u_shadows:new o.c8(T,c.u_shadows),u_highlights:new o.c8(T,c.u_highlights)}),hillshadePrepare:(T,c)=>({u_matrix:new o.c0(T,c.u_matrix),u_image:new o.b_(T,c.u_image),u_dimension:new o.c3(T,c.u_dimension),u_zoom:new o.bq(T,c.u_zoom),u_unpack:new o.c1(T,c.u_unpack)}),colorRelief:(T,c)=>({u_image:new o.b_(T,c.u_image),u_unpack:new o.c1(T,c.u_unpack),u_dimension:new o.c3(T,c.u_dimension),u_elevation_stops:new o.b_(T,c.u_elevation_stops),u_color_stops:new o.b_(T,c.u_color_stops),u_color_ramp_size:new o.b_(T,c.u_color_ramp_size),u_opacity:new o.bq(T,c.u_opacity)}),line:(T,c)=>({u_translation:new o.c3(T,c.u_translation),u_ratio:new o.bq(T,c.u_ratio),u_device_pixel_ratio:new o.bq(T,c.u_device_pixel_ratio),u_units_to_pixels:new o.c3(T,c.u_units_to_pixels)}),lineGradient:(T,c)=>({u_translation:new o.c3(T,c.u_translation),u_ratio:new o.bq(T,c.u_ratio),u_device_pixel_ratio:new o.bq(T,c.u_device_pixel_ratio),u_units_to_pixels:new o.c3(T,c.u_units_to_pixels),u_image:new o.b_(T,c.u_image),u_image_height:new o.bq(T,c.u_image_height)}),linePattern:(T,c)=>({u_translation:new o.c3(T,c.u_translation),u_texsize:new o.c3(T,c.u_texsize),u_ratio:new o.bq(T,c.u_ratio),u_device_pixel_ratio:new o.bq(T,c.u_device_pixel_ratio),u_image:new o.b_(T,c.u_image),u_units_to_pixels:new o.c3(T,c.u_units_to_pixels),u_scale:new o.c2(T,c.u_scale),u_fade:new o.bq(T,c.u_fade)}),lineSDF:(T,c)=>({u_translation:new o.c3(T,c.u_translation),u_ratio:new o.bq(T,c.u_ratio),u_device_pixel_ratio:new o.bq(T,c.u_device_pixel_ratio),u_units_to_pixels:new o.c3(T,c.u_units_to_pixels),u_image:new o.b_(T,c.u_image),u_mix:new o.bq(T,c.u_mix),u_tileratio:new o.bq(T,c.u_tileratio),u_crossfade_from:new o.bq(T,c.u_crossfade_from),u_crossfade_to:new o.bq(T,c.u_crossfade_to),u_lineatlas_width:new o.bq(T,c.u_lineatlas_width),u_lineatlas_height:new o.bq(T,c.u_lineatlas_height)}),lineGradientSDF:(T,c)=>({u_translation:new o.c3(T,c.u_translation),u_ratio:new o.bq(T,c.u_ratio),u_device_pixel_ratio:new o.bq(T,c.u_device_pixel_ratio),u_units_to_pixels:new o.c3(T,c.u_units_to_pixels),u_image:new o.b_(T,c.u_image),u_image_height:new o.bq(T,c.u_image_height),u_tileratio:new o.bq(T,c.u_tileratio),u_crossfade_from:new o.bq(T,c.u_crossfade_from),u_crossfade_to:new o.bq(T,c.u_crossfade_to),u_image_dash:new o.b_(T,c.u_image_dash),u_mix:new o.bq(T,c.u_mix),u_lineatlas_width:new o.bq(T,c.u_lineatlas_width),u_lineatlas_height:new o.bq(T,c.u_lineatlas_height)}),raster:(T,c)=>({u_tl_parent:new o.c3(T,c.u_tl_parent),u_scale_parent:new o.bq(T,c.u_scale_parent),u_buffer_scale:new o.bq(T,c.u_buffer_scale),u_fade_t:new o.bq(T,c.u_fade_t),u_opacity:new o.bq(T,c.u_opacity),u_image0:new o.b_(T,c.u_image0),u_image1:new o.b_(T,c.u_image1),u_brightness_low:new o.bq(T,c.u_brightness_low),u_brightness_high:new o.bq(T,c.u_brightness_high),u_saturation_factor:new o.bq(T,c.u_saturation_factor),u_contrast_factor:new o.bq(T,c.u_contrast_factor),u_spin_weights:new o.c2(T,c.u_spin_weights),u_coords_top:new o.c1(T,c.u_coords_top),u_coords_bottom:new o.c1(T,c.u_coords_bottom)}),symbolIcon:(T,c)=>({u_is_size_zoom_constant:new o.b_(T,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.b_(T,c.u_is_size_feature_constant),u_size_t:new o.bq(T,c.u_size_t),u_size:new o.bq(T,c.u_size),u_camera_to_center_distance:new o.bq(T,c.u_camera_to_center_distance),u_pitch:new o.bq(T,c.u_pitch),u_rotate_symbol:new o.b_(T,c.u_rotate_symbol),u_aspect_ratio:new o.bq(T,c.u_aspect_ratio),u_fade_change:new o.bq(T,c.u_fade_change),u_label_plane_matrix:new o.c0(T,c.u_label_plane_matrix),u_coord_matrix:new o.c0(T,c.u_coord_matrix),u_is_text:new o.b_(T,c.u_is_text),u_pitch_with_map:new o.b_(T,c.u_pitch_with_map),u_is_along_line:new o.b_(T,c.u_is_along_line),u_is_variable_anchor:new o.b_(T,c.u_is_variable_anchor),u_texsize:new o.c3(T,c.u_texsize),u_texture:new o.b_(T,c.u_texture),u_translation:new o.c3(T,c.u_translation),u_pitched_scale:new o.bq(T,c.u_pitched_scale)}),symbolSDF:(T,c)=>({u_is_size_zoom_constant:new o.b_(T,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.b_(T,c.u_is_size_feature_constant),u_size_t:new o.bq(T,c.u_size_t),u_size:new o.bq(T,c.u_size),u_camera_to_center_distance:new o.bq(T,c.u_camera_to_center_distance),u_pitch:new o.bq(T,c.u_pitch),u_rotate_symbol:new o.b_(T,c.u_rotate_symbol),u_aspect_ratio:new o.bq(T,c.u_aspect_ratio),u_fade_change:new o.bq(T,c.u_fade_change),u_label_plane_matrix:new o.c0(T,c.u_label_plane_matrix),u_coord_matrix:new o.c0(T,c.u_coord_matrix),u_is_text:new o.b_(T,c.u_is_text),u_pitch_with_map:new o.b_(T,c.u_pitch_with_map),u_is_along_line:new o.b_(T,c.u_is_along_line),u_is_variable_anchor:new o.b_(T,c.u_is_variable_anchor),u_texsize:new o.c3(T,c.u_texsize),u_texture:new o.b_(T,c.u_texture),u_gamma_scale:new o.bq(T,c.u_gamma_scale),u_device_pixel_ratio:new o.bq(T,c.u_device_pixel_ratio),u_is_halo:new o.b_(T,c.u_is_halo),u_translation:new o.c3(T,c.u_translation),u_pitched_scale:new o.bq(T,c.u_pitched_scale)}),symbolTextAndIcon:(T,c)=>({u_is_size_zoom_constant:new o.b_(T,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.b_(T,c.u_is_size_feature_constant),u_size_t:new o.bq(T,c.u_size_t),u_size:new o.bq(T,c.u_size),u_camera_to_center_distance:new o.bq(T,c.u_camera_to_center_distance),u_pitch:new o.bq(T,c.u_pitch),u_rotate_symbol:new o.b_(T,c.u_rotate_symbol),u_aspect_ratio:new o.bq(T,c.u_aspect_ratio),u_fade_change:new o.bq(T,c.u_fade_change),u_label_plane_matrix:new o.c0(T,c.u_label_plane_matrix),u_coord_matrix:new o.c0(T,c.u_coord_matrix),u_is_text:new o.b_(T,c.u_is_text),u_pitch_with_map:new o.b_(T,c.u_pitch_with_map),u_is_along_line:new o.b_(T,c.u_is_along_line),u_is_variable_anchor:new o.b_(T,c.u_is_variable_anchor),u_texsize:new o.c3(T,c.u_texsize),u_texsize_icon:new o.c3(T,c.u_texsize_icon),u_texture:new o.b_(T,c.u_texture),u_texture_icon:new o.b_(T,c.u_texture_icon),u_gamma_scale:new o.bq(T,c.u_gamma_scale),u_device_pixel_ratio:new o.bq(T,c.u_device_pixel_ratio),u_is_halo:new o.b_(T,c.u_is_halo),u_translation:new o.c3(T,c.u_translation),u_pitched_scale:new o.bq(T,c.u_pitched_scale)}),background:(T,c)=>({u_opacity:new o.bq(T,c.u_opacity),u_color:new o.b$(T,c.u_color)}),backgroundPattern:(T,c)=>({u_opacity:new o.bq(T,c.u_opacity),u_image:new o.b_(T,c.u_image),u_pattern_tl_a:new o.c3(T,c.u_pattern_tl_a),u_pattern_br_a:new o.c3(T,c.u_pattern_br_a),u_pattern_tl_b:new o.c3(T,c.u_pattern_tl_b),u_pattern_br_b:new o.c3(T,c.u_pattern_br_b),u_texsize:new o.c3(T,c.u_texsize),u_mix:new o.bq(T,c.u_mix),u_pattern_size_a:new o.c3(T,c.u_pattern_size_a),u_pattern_size_b:new o.c3(T,c.u_pattern_size_b),u_scale_a:new o.bq(T,c.u_scale_a),u_scale_b:new o.bq(T,c.u_scale_b),u_pixel_coord_upper:new o.c3(T,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.c3(T,c.u_pixel_coord_lower),u_tile_units_to_pixels:new o.bq(T,c.u_tile_units_to_pixels)}),terrain:(T,c)=>({u_texture:new o.b_(T,c.u_texture),u_ele_delta:new o.bq(T,c.u_ele_delta),u_fog_matrix:new o.c0(T,c.u_fog_matrix),u_fog_color:new o.b$(T,c.u_fog_color),u_fog_ground_blend:new o.bq(T,c.u_fog_ground_blend),u_fog_ground_blend_opacity:new o.bq(T,c.u_fog_ground_blend_opacity),u_horizon_color:new o.b$(T,c.u_horizon_color),u_horizon_fog_blend:new o.bq(T,c.u_horizon_fog_blend),u_is_globe_mode:new o.bq(T,c.u_is_globe_mode)}),terrainDepth:(T,c)=>({u_ele_delta:new o.bq(T,c.u_ele_delta)}),terrainCoords:(T,c)=>({u_texture:new o.b_(T,c.u_texture),u_terrain_coords_id:new o.bq(T,c.u_terrain_coords_id),u_ele_delta:new o.bq(T,c.u_ele_delta)}),projectionErrorMeasurement:(T,c)=>({u_input:new o.bq(T,c.u_input),u_output_expected:new o.bq(T,c.u_output_expected)}),atmosphere:(T,c)=>({u_sun_pos:new o.c2(T,c.u_sun_pos),u_atmosphere_blend:new o.bq(T,c.u_atmosphere_blend),u_globe_position:new o.c2(T,c.u_globe_position),u_globe_radius:new o.bq(T,c.u_globe_radius),u_inv_proj_matrix:new o.c0(T,c.u_inv_proj_matrix)}),sky:(T,c)=>({u_sky_color:new o.b$(T,c.u_sky_color),u_horizon_color:new o.b$(T,c.u_horizon_color),u_horizon:new o.c3(T,c.u_horizon),u_horizon_normal:new o.c3(T,c.u_horizon_normal),u_sky_horizon_blend:new o.bq(T,c.u_sky_horizon_blend),u_sky_blend:new o.bq(T,c.u_sky_blend)})};class I2{constructor(c,p,b){this.context=c;const v=c.gl;this.buffer=v.createBuffer(),this.dynamicDraw=!!b,this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(c){const p=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),p.bufferSubData(p.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const SA={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class P2{constructor(c,p,b,v){this.length=p.length,this.attributes=b,this.itemSize=p.bytesPerElement,this.dynamicDraw=v,this.context=c;const S=c.gl;this.buffer=S.createBuffer(),c.bindVertexBuffer.set(this.buffer),S.bufferData(S.ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||delete p.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(c){if(c.length!==this.length)throw new Error(`Length of new data is ${c.length}, which doesn't match current length of ${this.length}`);const p=this.context.gl;this.bind(),p.bufferSubData(p.ARRAY_BUFFER,0,c.arrayBuffer)}enableAttributes(c,p){for(let b=0;b<this.attributes.length;b++){const v=p.attributes[this.attributes[b].name];v!==void 0&&c.enableVertexAttribArray(v)}}setVertexAttribPointers(c,p,b){for(let v=0;v<this.attributes.length;v++){const S=this.attributes[v],P=p.attributes[S.name];P!==void 0&&c.vertexAttribPointer(P,S.components,c[SA[S.type]],!1,this.itemSize,S.offset+this.itemSize*(b||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class fn{constructor(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(c){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Fp extends fn{getDefault(){return o.bp.transparent}set(c){const p=this.current;(c.r!==p.r||c.g!==p.g||c.b!==p.b||c.a!==p.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class Up extends fn{getDefault(){return 1}set(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)}}class zp extends fn{getDefault(){return 0}set(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)}}class qy extends fn{getDefault(){return[!0,!0,!0,!0]}set(c){const p=this.current;(c[0]!==p[0]||c[1]!==p[1]||c[2]!==p[2]||c[3]!==p[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class uu extends fn{getDefault(){return!0}set(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)}}class Ud extends fn{getDefault(){return 255}set(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)}}class _h extends fn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(c){const p=this.current;(c.func!==p.func||c.ref!==p.ref||c.mask!==p.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)}}class Ko extends fn{getDefault(){const c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]}set(c){const p=this.current;(c[0]!==p[0]||c[1]!==p[1]||c[2]!==p[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)}}class EA extends fn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const p=this.gl;c?p.enable(p.STENCIL_TEST):p.disable(p.STENCIL_TEST),this.current=c,this.dirty=!1}}class IA extends fn{getDefault(){return[0,1]}set(c){const p=this.current;(c[0]!==p[0]||c[1]!==p[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)}}class Yy extends fn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const p=this.gl;c?p.enable(p.DEPTH_TEST):p.disable(p.DEPTH_TEST),this.current=c,this.dirty=!1}}class hu extends fn{getDefault(){return this.gl.LESS}set(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)}}class Vp extends fn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const p=this.gl;c?p.enable(p.BLEND):p.disable(p.BLEND),this.current=c,this.dirty=!1}}class $p extends fn{getDefault(){const c=this.gl;return[c.ONE,c.ZERO]}set(c){const p=this.current;(c[0]!==p[0]||c[1]!==p[1]||this.dirty)&&(this.gl.blendFunc(c[0],c[1]),this.current=c,this.dirty=!1)}}class zd extends fn{getDefault(){return o.bp.transparent}set(c){const p=this.current;(c.r!==p.r||c.g!==p.g||c.b!==p.b||c.a!==p.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class jp extends fn{getDefault(){return this.gl.FUNC_ADD}set(c){(c!==this.current||this.dirty)&&(this.gl.blendEquation(c),this.current=c,this.dirty=!1)}}class PA extends fn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const p=this.gl;c?p.enable(p.CULL_FACE):p.disable(p.CULL_FACE),this.current=c,this.dirty=!1}}class vh extends fn{getDefault(){return this.gl.BACK}set(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)}}class Ah extends fn{getDefault(){return this.gl.CCW}set(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)}}class BA extends fn{getDefault(){return null}set(c){(c!==this.current||this.dirty)&&(this.gl.useProgram(c),this.current=c,this.dirty=!1)}}class Zy extends fn{getDefault(){return this.gl.TEXTURE0}set(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)}}class jr extends fn{getDefault(){const c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]}set(c){const p=this.current;(c[0]!==p[0]||c[1]!==p[1]||c[2]!==p[2]||c[3]!==p[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class Gp extends fn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const p=this.gl;p.bindFramebuffer(p.FRAMEBUFFER,c),this.current=c,this.dirty=!1}}class B2 extends fn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const p=this.gl;p.bindRenderbuffer(p.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class MA extends fn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const p=this.gl;p.bindTexture(p.TEXTURE_2D,c),this.current=c,this.dirty=!1}}class Vd extends fn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const p=this.gl;p.bindBuffer(p.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class M2 extends fn{getDefault(){return null}set(c){const p=this.gl;p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class R2 extends fn{getDefault(){return null}set(c){var p;if(c===this.current&&!this.dirty)return;const b=this.gl;Wo(b)?b.bindVertexArray(c):(p=b.getExtension("OES_vertex_array_object"))===null||p===void 0||p.bindVertexArrayOES(c),this.current=c,this.dirty=!1}}class RA extends fn{getDefault(){return 4}set(c){if(c===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}}class k2 extends fn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}}class Qy extends fn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}}class xh extends fn{constructor(c,p){super(c),this.context=c,this.parent=p}getDefault(){return null}}class $d extends xh{setDirty(){this.dirty=!0}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class Hp extends xh{set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferRenderbuffer(p.FRAMEBUFFER,p.DEPTH_ATTACHMENT,p.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class eb extends xh{set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferRenderbuffer(p.FRAMEBUFFER,p.DEPTH_STENCIL_ATTACHMENT,p.RENDERBUFFER,c),this.current=c,this.dirty=!1}}const tb="Framebuffer is not complete";class Wp{constructor(c,p,b,v,S){this.context=c,this.width=p,this.height=b;const P=c.gl,R=this.framebuffer=P.createFramebuffer();if(this.colorAttachment=new $d(c,R),v)this.depthAttachment=S?new eb(c,R):new Hp(c,R);else if(S)throw new Error("Stencil cannot be set without depth");if(P.checkFramebufferStatus(P.FRAMEBUFFER)!==P.FRAMEBUFFER_COMPLETE)throw new Error(tb)}destroy(){const c=this.context.gl,p=this.colorAttachment.get();if(p&&c.deleteTexture(p),this.depthAttachment){const b=this.depthAttachment.get();b&&c.deleteRenderbuffer(b)}c.deleteFramebuffer(this.framebuffer)}}class Kp{constructor(c){var p,b;if(this.gl=c,this.clearColor=new Fp(this),this.clearDepth=new Up(this),this.clearStencil=new zp(this),this.colorMask=new qy(this),this.depthMask=new uu(this),this.stencilMask=new Ud(this),this.stencilFunc=new _h(this),this.stencilOp=new Ko(this),this.stencilTest=new EA(this),this.depthRange=new IA(this),this.depthTest=new Yy(this),this.depthFunc=new hu(this),this.blend=new Vp(this),this.blendFunc=new $p(this),this.blendColor=new zd(this),this.blendEquation=new jp(this),this.cullFace=new PA(this),this.cullFaceSide=new vh(this),this.frontFace=new Ah(this),this.program=new BA(this),this.activeTexture=new Zy(this),this.viewport=new jr(this),this.bindFramebuffer=new Gp(this),this.bindRenderbuffer=new B2(this),this.bindTexture=new MA(this),this.bindVertexBuffer=new Vd(this),this.bindElementBuffer=new M2(this),this.bindVertexArray=new R2(this),this.pixelStoreUnpack=new RA(this),this.pixelStoreUnpackPremultiplyAlpha=new k2(this),this.pixelStoreUnpackFlipY=new Qy(this),this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE),Wo(c)){this.HALF_FLOAT=c.HALF_FLOAT;const v=c.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(p=c.RGBA16F)!==null&&p!==void 0?p:v?.RGBA16F_EXT,this.RGB16F=(b=c.RGB16F)!==null&&b!==void 0?b:v?.RGB16F_EXT,c.getExtension("EXT_color_buffer_float")}else{c.getExtension("EXT_color_buffer_half_float"),c.getExtension("OES_texture_half_float_linear");const v=c.getExtension("OES_texture_half_float");this.HALF_FLOAT=v?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(c,p){return new I2(this,c,p)}createVertexBuffer(c,p,b){return new P2(this,c,p,b)}createRenderbuffer(c,p,b){const v=this.gl,S=v.createRenderbuffer();return this.bindRenderbuffer.set(S),v.renderbufferStorage(v.RENDERBUFFER,c,p,b),this.bindRenderbuffer.set(null),S}createFramebuffer(c,p,b,v){return new Wp(this,c,p,b,v)}clear({color:c,depth:p,stencil:b}){const v=this.gl;let S=0;c&&(S|=v.COLOR_BUFFER_BIT,this.clearColor.set(c),this.colorMask.set([!0,!0,!0,!0])),p!==void 0&&(S|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(p),this.depthMask.set(!0)),b!==void 0&&(S|=v.STENCIL_BUFFER_BIT,this.clearStencil.set(b),this.stencilMask.set(255)),v.clear(S)}setCullFace(c){c.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))}setDepthMode(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)}setStencilMode(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)}setColorMode(c){o.bR(c.blendFunction,Un.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)}createVertexArray(){var c;return Wo(this.gl)?this.gl.createVertexArray():(c=this.gl.getExtension("OES_vertex_array_object"))===null||c===void 0?void 0:c.createVertexArrayOES()}deleteVertexArray(c){var p;return Wo(this.gl)?this.gl.deleteVertexArray(c):(p=this.gl.getExtension("OES_vertex_array_object"))===null||p===void 0?void 0:p.deleteVertexArrayOES(c)}unbindVAO(){this.bindVertexArray.set(null)}}let mc;function du(T,c,p,b,v){const S=T.context,P=T.transform,R=S.gl,L=T.useProgram("collisionBox"),F=[];let j=0,J=0;for(let me=0;me<b.length;me++){const we=b[me],De=c.getTile(we).getBucket(p);if(!De)continue;const Ae=v?De.textCollisionBox:De.iconCollisionBox,Re=De.collisionCircleArray;Re.length>0&&(F.push({circleArray:Re,circleOffset:J,coord:we}),j+=Re.length/4,J=j),Ae&&L.draw(S,R.LINES,zr.disabled,on.disabled,T.colorModeForRenderPass(),en.disabled,lu(T.transform),T.style.map.terrain&&T.style.map.terrain.getTerrainData(we),P.getProjectionData({overscaledTileID:we,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),p.id,Ae.layoutVertexBuffer,Ae.indexBuffer,Ae.segments,null,T.transform.zoom,null,null,Ae.collisionVertexBuffer)}if(!v||!F.length)return;const X=T.useProgram("collisionCircle"),Q=new o.ca;Q.resize(4*j),Q._trim();let ae=0;for(const me of F)for(let we=0;we<me.circleArray.length/4;we++){const De=4*we,Ae=me.circleArray[De+0],Re=me.circleArray[De+1],Le=me.circleArray[De+2],Pe=me.circleArray[De+3];Q.emplace(ae++,Ae,Re,Le,Pe,0),Q.emplace(ae++,Ae,Re,Le,Pe,1),Q.emplace(ae++,Ae,Re,Le,Pe,2),Q.emplace(ae++,Ae,Re,Le,Pe,3)}(!mc||mc.length<2*j)&&(mc=function(me){const we=2*me,De=new o.cc;De.resize(we),De._trim();for(let Ae=0;Ae<we;Ae++){const Re=6*Ae;De.uint16[Re+0]=4*Ae+0,De.uint16[Re+1]=4*Ae+1,De.uint16[Re+2]=4*Ae+2,De.uint16[Re+3]=4*Ae+2,De.uint16[Re+4]=4*Ae+3,De.uint16[Re+5]=4*Ae+0}return De}(j));const ge=S.createIndexBuffer(mc,!0),ye=S.createVertexBuffer(Q,o.cb.members,!0);for(const me of F){const we=vA(T.transform);X.draw(S,R.TRIANGLES,zr.disabled,on.disabled,T.colorModeForRenderPass(),en.disabled,we,T.style.map.terrain&&T.style.map.terrain.getTerrainData(me.coord),null,p.id,ye,ge,o.aX.simpleSegment(0,2*me.circleOffset,me.circleArray.length,me.circleArray.length/2),null,T.transform.zoom,null,null,null)}ye.destroy(),ge.destroy()}const rb=o.ar(new Float32Array(16));function O2(T,c,p,b,v,S){const{horizontalAlign:P,verticalAlign:R}=o.aS(T);return new o.P((-(P-.5)*c/v+b[0])*S,(-(R-.5)*p/v+b[1])*S)}function jd(T,c,p,b,v,S){const P=c.tileAnchorPoint.add(new o.P(c.translation[0],c.translation[1]));if(c.pitchWithMap){let R=b.mult(S);p||(R=R.rotate(-v));const L=P.add(R);return Lr(L.x,L.y,c.pitchedLabelPlaneMatrix,c.getElevation).point}if(p){const R=gn(c.tileAnchorPoint.x+1,c.tileAnchorPoint.y,c).point.sub(T),L=Math.atan(R.y/R.x)+(R.x<0?Math.PI:0);return T.add(b.rotate(L))}return T.add(b)}function D2(T,c,p,b,v,S,P,R,L,F,j,J){const X=T.text.placedSymbolArray,Q=T.text.dynamicLayoutVertexArray,ae=T.icon.dynamicLayoutVertexArray,ge={};Q.clear();for(let ye=0;ye<X.length;ye++){const me=X.get(ye),we=me.hidden||!me.crossTileID||T.allowVerticalPlacement&&!me.placedOrientation?null:b[me.crossTileID];if(we){const De=new o.P(me.anchorX,me.anchorY),Ae={getElevation:J,width:v.width,height:v.height,pitchedLabelPlaneMatrix:S,pitchWithMap:p,transform:v,tileAnchorPoint:De,translation:F,unwrappedTileID:j},Re=p?Cl(De.x,De.y,Ae):gn(De.x,De.y,Ae),Le=Qc(v.cameraToCenterDistance,Re.signedDistanceFromCamera);let Pe=o.aA(T.textSizeData,R,me)*Le/o.aM;p&&(Pe*=T.tilePixelRatio/P);const{width:$e,height:ct,anchor:tt,textOffset:it,textBoxScale:st}=we,Ot=O2(tt,$e,ct,it,st,Pe),Lt=v.getPitchedTextCorrection(De.x+F[0],De.y+F[1],j),St=jd(Re.point,Ae,c,Ot,-v.bearingInRadians,Lt),Ht=T.allowVerticalPlacement&&me.placedOrientation===o.az.vertical?Math.PI/2:0;for(let Or=0;Or<me.numGlyphs;Or++)o.aG(Q,St,Ht);L&&me.associatedIconIndex>=0&&(ge[me.associatedIconIndex]={shiftedAnchor:St,angle:Ht})}else ie(me.numGlyphs,Q)}if(L){ae.clear();const ye=T.icon.placedSymbolArray;for(let me=0;me<ye.length;me++){const we=ye.get(me);if(we.hidden)ie(we.numGlyphs,ae);else{const De=ge[me];if(De)for(let Ae=0;Ae<we.numGlyphs;Ae++)o.aG(ae,De.shiftedAnchor,De.angle);else ie(we.numGlyphs,ae)}}T.icon.dynamicLayoutVertexBuffer.updateData(ae)}T.text.dynamicLayoutVertexBuffer.updateData(Q)}function kA(T,c,p){return p.iconsInText&&c?"symbolTextAndIcon":T?"symbolSDF":"symbolIcon"}function Gd(T,c,p,b,v,S,P,R,L,F,j,J,X){const Q=T.context,ae=Q.gl,ge=T.transform,ye=R==="map",me=L==="map",we=R!=="viewport"&&p.layout.get("symbol-placement")!=="point",De=ye&&!me&&!we,Ae=!p.layout.get("symbol-sort-key").isConstant();let Re=!1;const Le=T.getDepthModeForSublayer(0,zr.ReadOnly),Pe=p._unevaluatedLayout.hasValue("text-variable-anchor")||p._unevaluatedLayout.hasValue("text-variable-anchor-offset"),$e=[],ct=ge.getCircleRadiusCorrection();for(const tt of b){const it=c.getTile(tt),st=it.getBucket(p);if(!st)continue;const Ot=v?st.text:st.icon;if(!Ot||!Ot.segments.get().length||!Ot.hasVisibleVertices)continue;const Lt=Ot.programConfigurations.get(p.id),St=v||st.sdfIcons,Ht=v?st.textSizeData:st.iconSizeData,Or=me||ge.pitch!==0,bn=T.useProgram(kA(St,v,st),Lt),qn=o.ay(Ht,ge.zoom),zn=T.style.map.terrain&&T.style.map.terrain.getTerrainData(tt);let si,Vn,bi,oi,as=[0,0],ki=null;if(v)Vn=it.glyphAtlasTexture,bi=ae.LINEAR,si=it.glyphAtlasTexture.size,st.iconsInText&&(as=it.imageAtlasTexture.size,ki=it.imageAtlasTexture,oi=Or||T.options.rotating||T.options.zooming||Ht.kind==="composite"||Ht.kind==="camera"?ae.LINEAR:ae.NEAREST);else{const Hn=p.layout.get("icon-size").constantOr(0)!==1||st.iconsNeedLinear;Vn=it.imageAtlasTexture,bi=St||T.options.rotating||T.options.zooming||Hn||Or?ae.LINEAR:ae.NEAREST,si=it.imageAtlasTexture.size}const Si=o.aN(it,1,T.transform.zoom),Ts=Ws(ye,T.transform,Si),Ac=o.N();o.aB(Ac,Ts);const Il=ih(me,ye,T.transform,Si),tl=o.aO(ge,it,S,P),co=ge.getProjectionData({overscaledTileID:tt,applyGlobeMatrix:!X,applyTerrainMatrix:!0}),bu=Pe&&st.hasTextData(),hf=p.layout.get("icon-text-fit")!=="none"&&bu&&st.hasIconData();if(we){const Hn=T.style.map.terrain?(qi,Yi)=>T.style.map.terrain.getElevation(tt,qi,Yi):null,$n=p.layout.get("text-rotation-alignment")==="map";tu(st,T,v,Ts,Ac,me,F,$n,tt.toUnwrapped(),ge.width,ge.height,tl,Hn)}const _u=v&&Pe||hf,qo=we||_u?rb:me?Ts:T.transform.clipSpaceToPixelsMatrix,rl=St&&p.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let wa;wa=St?st.iconsInText?cu(Ht.kind,qn,De,me,we,_u,T,qo,Il,tl,si,as,ct):Np(Ht.kind,qn,De,me,we,_u,T,qo,Il,tl,v,si,0,ct):Xy(Ht.kind,qn,De,me,we,_u,T,qo,Il,tl,v,si,ct);const Ca={program:bn,buffers:Ot,uniformValues:wa,projectionData:co,atlasTexture:Vn,atlasTextureIcon:ki,atlasInterpolation:bi,atlasInterpolationIcon:oi,isSDF:St,hasHalo:rl};if(Ae&&st.canOverlap){Re=!0;const Hn=Ot.segments.get();for(const $n of Hn)$e.push({segments:new o.aX([$n]),sortKey:$n.sortKey,state:Ca,terrainData:zn})}else $e.push({segments:Ot.segments,sortKey:0,state:Ca,terrainData:zn})}Re&&$e.sort((tt,it)=>tt.sortKey-it.sortKey);for(const tt of $e){const it=tt.state;if(Q.activeTexture.set(ae.TEXTURE0),it.atlasTexture.bind(it.atlasInterpolation,ae.CLAMP_TO_EDGE),it.atlasTextureIcon&&(Q.activeTexture.set(ae.TEXTURE1),it.atlasTextureIcon&&it.atlasTextureIcon.bind(it.atlasInterpolationIcon,ae.CLAMP_TO_EDGE)),it.isSDF){const st=it.uniformValues;it.hasHalo&&(st.u_is_halo=1,Xp(it.buffers,tt.segments,p,T,it.program,Le,j,J,st,it.projectionData,tt.terrainData)),st.u_is_halo=0}Xp(it.buffers,tt.segments,p,T,it.program,Le,j,J,it.uniformValues,it.projectionData,tt.terrainData)}}function Xp(T,c,p,b,v,S,P,R,L,F,j){const J=b.context;v.draw(J,J.gl.TRIANGLES,S,P,R,en.backCCW,L,j,F,p.id,T.layoutVertexBuffer,T.indexBuffer,c,p.paint,b.transform.zoom,T.programConfigurations.get(p.id),T.dynamicLayoutVertexBuffer,T.opacityVertexBuffer)}function OA(T,c,p,b,v){const S=T.context,P=S.gl,R=on.disabled,L=new Un([P.ONE,P.ONE],o.bp.transparent,[!0,!0,!0,!0]),F=c.getBucket(p);if(!F)return;const j=b.key;let J=p.heatmapFbos.get(j);J||(J=Hd(S,c.tileSize,c.tileSize),p.heatmapFbos.set(j,J)),S.bindFramebuffer.set(J.framebuffer),S.viewport.set([0,0,c.tileSize,c.tileSize]),S.clear({color:o.bp.transparent});const X=F.programConfigurations.get(p.id),Q=T.useProgram("heatmap",X,!v),ae=T.transform.getProjectionData({overscaledTileID:c.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ge=T.style.map.terrain.getTerrainData(b);Q.draw(S,P.TRIANGLES,zr.disabled,R,L,en.disabled,bh(c,T.transform.zoom,p.paint.get("heatmap-intensity"),1),ge,ae,p.id,F.layoutVertexBuffer,F.indexBuffer,F.segments,p.paint,T.transform.zoom,X)}function DA(T,c,p,b,v){const S=T.context,P=S.gl,R=T.transform;S.setColorMode(T.colorModeForRenderPass());const L=Jp(S,c),F=p.key,j=c.heatmapFbos.get(F);if(!j)return;S.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,j.colorAttachment.get()),S.activeTexture.set(P.TEXTURE1),L.bind(P.LINEAR,P.CLAMP_TO_EDGE);const J=R.getProjectionData({overscaledTileID:p,applyTerrainMatrix:v,applyGlobeMatrix:!b});T.useProgram("heatmapTexture").draw(S,P.TRIANGLES,zr.disabled,on.disabled,T.colorModeForRenderPass(),en.disabled,AA(T,c,0,1),null,J,c.id,T.rasterBoundsBuffer,T.quadTriangleIndexBuffer,T.rasterBoundsSegments,c.paint,R.zoom),j.destroy(),c.heatmapFbos.delete(F)}function Hd(T,c,p){var b,v;const S=T.gl,P=S.createTexture();S.bindTexture(S.TEXTURE_2D,P),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_S,S.CLAMP_TO_EDGE),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_T,S.CLAMP_TO_EDGE),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MIN_FILTER,S.LINEAR),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MAG_FILTER,S.LINEAR);const R=(b=T.HALF_FLOAT)!==null&&b!==void 0?b:S.UNSIGNED_BYTE,L=(v=T.RGBA16F)!==null&&v!==void 0?v:S.RGBA;S.texImage2D(S.TEXTURE_2D,0,L,c,p,0,S.RGBA,R,null);const F=T.createFramebuffer(c,p,!1,!1);return F.colorAttachment.set(P),F}function Jp(T,c){return c.colorRampTexture||(c.colorRampTexture=new o.T(T,c.colorRamp,T.gl.RGBA)),c.colorRampTexture}function LA(T,c,p,b,v,S,P,R){let L=256;if(v.stepInterpolant){const F=c.getSource().maxzoom,j=P.canonical.z===F?Math.ceil(1<<T.transform.maxZoom-P.canonical.z):1;L=o.an(o.ce(S.maxLineLength/o.a5*1024*j),256,p.maxTextureSize)}return R.gradient=o.cf({expression:v.gradientExpression(),evaluationKey:"lineProgress",resolution:L,image:R.gradient||void 0,clips:S.lineClipsArray}),R.texture?R.texture.update(R.gradient):R.texture=new o.T(p,R.gradient,b.RGBA),R.version=v.gradientVersion,R.texture}function NA(T,c,p,b,v){T.activeTexture.set(c.TEXTURE0),p.imageAtlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE),b.updatePaintBuffers(v)}function Ci(T,c,p,b,v,S){(v||T.lineAtlas.dirty)&&(c.activeTexture.set(p.TEXTURE0),T.lineAtlas.bind(c)),b.updatePaintBuffers(S)}function fu(T,c,p,b,v,S,P){const R=S.gradients[v.id];let L=R.texture;v.gradientVersion!==R.version&&(L=LA(T,c,p,b,v,S,P,R)),p.activeTexture.set(b.TEXTURE0),L.bind(v.stepInterpolant?b.NEAREST:b.LINEAR,b.CLAMP_TO_EDGE)}function Po(T,c,p,b,v,S,P,R,L){const F=S.gradients[v.id];let j=F.texture;v.gradientVersion!==F.version&&(j=LA(T,c,p,b,v,S,P,F)),p.activeTexture.set(b.TEXTURE0),j.bind(v.stepInterpolant?b.NEAREST:b.LINEAR,b.CLAMP_TO_EDGE),p.activeTexture.set(b.TEXTURE1),T.lineAtlas.bind(p),R.updatePaintBuffers(L)}function qp(T,c,p,b,v){if(!p||!b||!b.imageAtlas)return;const S=b.imageAtlas.patternPositions;let P=S[p.to.toString()],R=S[p.from.toString()];if(!P&&R&&(P=R),!R&&P&&(R=P),!P||!R){const L=v.getPaintProperty(c);P=S[L],R=S[L]}P&&R&&T.setConstantPatternPositions(P,R)}function Wd(T,c,p,b,v,S,P,R){const L=T.context.gl,F="fill-pattern",j=p.paint.get(F),J=j&&j.constantOr(1),X=p.getCrossfadeParameters();let Q,ae,ge,ye,me;const we=T.transform,De=p.paint.get("fill-translate"),Ae=p.paint.get("fill-translate-anchor");P?(ae=J&&!p.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Q=L.LINES):(ae=J?"fillPattern":"fill",Q=L.TRIANGLES);const Re=j.constantOr(null);for(const Le of b){const Pe=c.getTile(Le);if(J&&!Pe.patternsLoaded())continue;const $e=Pe.getBucket(p);if(!$e)continue;const ct=$e.programConfigurations.get(p.id),tt=T.useProgram(ae,ct),it=T.style.map.terrain&&T.style.map.terrain.getTerrainData(Le);J&&(T.context.activeTexture.set(L.TEXTURE0),Pe.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),ct.updatePaintBuffers(X)),qp(ct,F,Re,Pe,p);const st=we.getProjectionData({overscaledTileID:Le,applyGlobeMatrix:!R,applyTerrainMatrix:!0}),Ot=o.aO(we,Pe,De,Ae);if(P){ye=$e.indexBuffer2,me=$e.segments2;const St=[L.drawingBufferWidth,L.drawingBufferHeight];ge=ae==="fillOutlinePattern"&&J?bA(T,X,Pe,St,Ot):yA(St,Ot)}else ye=$e.indexBuffer,me=$e.segments,ge=J?jy(T,X,Pe,Ot):{u_fill_translate:Ot};const Lt=T.stencilModeForClipping(Le);tt.draw(T.context,Q,v,Lt,S,en.backCCW,ge,it,st,p.id,$e.layoutVertexBuffer,ye,me,p.paint,T.transform.zoom,ct)}}function Yp(T,c,p,b,v,S,P,R){const L=T.context,F=L.gl,j="fill-extrusion-pattern",J=p.paint.get(j),X=J.constantOr(1),Q=p.getCrossfadeParameters(),ae=p.paint.get("fill-extrusion-opacity"),ge=J.constantOr(null),ye=T.transform;for(const me of b){const we=c.getTile(me),De=we.getBucket(p);if(!De)continue;const Ae=T.style.map.terrain&&T.style.map.terrain.getTerrainData(me),Re=De.programConfigurations.get(p.id),Le=T.useProgram(X?"fillExtrusionPattern":"fillExtrusion",Re);X&&(T.context.activeTexture.set(F.TEXTURE0),we.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),Re.updatePaintBuffers(Q));const Pe=ye.getProjectionData({overscaledTileID:me,applyGlobeMatrix:!R,applyTerrainMatrix:!0});qp(Re,j,ge,we,p);const $e=o.aO(ye,we,p.paint.get("fill-extrusion-translate"),p.paint.get("fill-extrusion-translate-anchor")),ct=p.paint.get("fill-extrusion-vertical-gradient"),tt=X?$y(T,ct,ae,$e,me,Q,we):Vy(T,ct,ae,$e);Le.draw(L,L.gl.TRIANGLES,v,S,P,en.backCCW,tt,Ae,Pe,p.id,De.layoutVertexBuffer,De.indexBuffer,De.segments,p.paint,T.transform.zoom,Re,T.style.map.terrain&&De.centroidVertexBuffer)}}function yc(T,c,p,b,v,S,P,R,L){var F;const j=T.style.projection,J=T.context,X=T.transform,Q=J.gl,ae=[`#define NUM_ILLUMINATION_SOURCES ${p.paint.get("hillshade-highlight-color").values.length}`],ge=T.useProgram("hillshade",null,!1,ae),ye=!T.options.moving;for(const me of b){const we=c.getTile(me),De=we.fbo;if(!De)continue;const Ae=j.getMeshFromTileID(J,me.canonical,R,!0,"raster"),Re=(F=T.style.map.terrain)===null||F===void 0?void 0:F.getTerrainData(me);J.activeTexture.set(Q.TEXTURE0),Q.bindTexture(Q.TEXTURE_2D,De.colorAttachment.get());const Le=X.getProjectionData({overscaledTileID:me,aligned:ye,applyGlobeMatrix:!L,applyTerrainMatrix:!0});ge.draw(J,Q.TRIANGLES,S,v[me.overscaledZ],P,en.backCCW,Op(T,we,p),Re,Le,p.id,Ae.vertexBuffer,Ae.indexBuffer,Ae.segments)}}function Kd(T,c,p,b,v,S,P,R,L){var F;const j=T.style.projection,J=T.context,X=T.transform,Q=J.gl,ae=T.useProgram("colorRelief"),ge=!T.options.moving;let ye=!0,me=0;for(const we of b){const De=c.getTile(we),Ae=De.dem;if(ye){const tt=Q.getParameter(Q.MAX_TEXTURE_SIZE),{elevationTexture:it,colorTexture:st}=p.getColorRampTextures(J,tt,Ae.getUnpackVector());J.activeTexture.set(Q.TEXTURE1),it.bind(Q.NEAREST,Q.CLAMP_TO_EDGE),J.activeTexture.set(Q.TEXTURE4),st.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),ye=!1,me=it.size[0]}if(!Ae||!Ae.data)continue;const Re=Ae.stride,Le=Ae.getPixels();if(J.activeTexture.set(Q.TEXTURE0),J.pixelStoreUnpackPremultiplyAlpha.set(!1),De.demTexture=De.demTexture||T.getTileTexture(Re),De.demTexture){const tt=De.demTexture;tt.update(Le,{premultiply:!1}),tt.bind(Q.LINEAR,Q.CLAMP_TO_EDGE)}else De.demTexture=new o.T(J,Le,Q.RGBA,{premultiply:!1}),De.demTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE);const Pe=j.getMeshFromTileID(J,we.canonical,R,!0,"raster"),$e=(F=T.style.map.terrain)===null||F===void 0?void 0:F.getTerrainData(we),ct=X.getProjectionData({overscaledTileID:we,aligned:ge,applyGlobeMatrix:!L,applyTerrainMatrix:!0});ae.draw(J,Q.TRIANGLES,S,v[we.overscaledZ],P,en.backCCW,xA(p,De.dem,me),$e,ct,p.id,Pe.vertexBuffer,Pe.indexBuffer,Pe.segments)}}const pu=[new o.P(0,0),new o.P(o.a5,0),new o.P(o.a5,o.a5),new o.P(0,o.a5)];function wh(T,c,p,b,v,S,P,R,L=!1,F=!1){const j=b[b.length-1].overscaledZ,J=T.context,X=J.gl,Q=T.useProgram("raster"),ae=T.transform,ge=T.style.projection,ye=T.colorModeForRenderPass(),me=!T.options.moving,we=p.paint.get("raster-opacity"),De=p.paint.get("raster-resampling"),Ae=p.paint.get("raster-fade-duration"),Re=!!T.style.map.terrain;for(const Le of b){const Pe=T.getDepthModeForSublayer(Le.overscaledZ-j,we===1?zr.ReadWrite:zr.ReadOnly,X.LESS),$e=c.getTile(Le),ct=De==="nearest"?X.NEAREST:X.LINEAR;J.activeTexture.set(X.TEXTURE0),$e.texture.bind(ct,X.CLAMP_TO_EDGE,X.LINEAR_MIPMAP_NEAREST),J.activeTexture.set(X.TEXTURE1);const{parentTile:tt,parentScaleBy:it,parentTopLeft:st,fadeValues:Ot}=FA($e,c,Ae,Re);$e.fadeOpacity=Ot.tileOpacity,tt?(tt.fadeOpacity=Ot.parentTileOpacity,tt.texture.bind(ct,X.CLAMP_TO_EDGE,X.LINEAR_MIPMAP_NEAREST)):$e.texture.bind(ct,X.CLAMP_TO_EDGE,X.LINEAR_MIPMAP_NEAREST),$e.texture.useMipmap&&J.extTextureFilterAnisotropic&&T.transform.pitch>20&&X.texParameterf(X.TEXTURE_2D,J.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,J.extTextureFilterAnisotropicMax);const Lt=T.style.map.terrain&&T.style.map.terrain.getTerrainData(Le),St=ae.getProjectionData({overscaledTileID:Le,aligned:me,applyGlobeMatrix:!F,applyTerrainMatrix:!0}),Ht=Wy(st,it,Ot.fadeMix,p,R),Or=ge.getMeshFromTileID(J,Le.canonical,S,P,"raster");Q.draw(J,X.TRIANGLES,Pe,v?v[Le.overscaledZ]:on.disabled,ye,L?en.frontCCW:en.backCCW,Ht,Lt,St,p.id,Or.vertexBuffer,Or.indexBuffer,Or.segments)}}function FA(T,c,p,b){const v={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(p===0||b)return v;if(T.fadingParentID){const S=c.getLoadedTile(T.fadingParentID);if(!S)return v;const P=Math.pow(2,S.tileID.overscaledZ-T.tileID.overscaledZ),R=[T.tileID.canonical.x*P%1,T.tileID.canonical.y*P%1],L=function(F,j,J){const X=k(),Q=(X-j.timeAdded)/J,ae=F.fadingDirection===nt.Incoming,ge=o.an((X-F.timeAdded)/J,0,1),ye=o.an(1-Q,0,1),me=ae?ge:ye;return{tileOpacity:me,parentTileOpacity:ae?ye:ge,fadeMix:{opacity:1,mix:1-me}}}(T,S,p);return{parentTile:S,parentScaleBy:P,parentTopLeft:R,fadeValues:L}}if(T.selfFading){const S=function(P,R){const L=(k()-P.timeAdded)/R,F=o.an(L,0,1);return{tileOpacity:F,fadeMix:{opacity:F,mix:0}}}(T,p);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:S}}return v}const UA=new o.bp(1,0,0,1),zA=new o.bp(0,1,0,1),VA=new o.bp(0,0,1,1),$A=new o.bp(1,0,1,1),bc=new o.bp(0,1,1,1);function nb(T,c,p,b){Xd(T,0,c+p/2,T.transform.width,p,b)}function ib(T,c,p,b){Xd(T,c-p/2,0,p,T.transform.height,b)}function Xd(T,c,p,b,v,S){const P=T.context,R=P.gl;R.enable(R.SCISSOR_TEST),R.scissor(c*T.pixelRatio,p*T.pixelRatio,b*T.pixelRatio,v*T.pixelRatio),P.clear({color:S}),R.disable(R.SCISSOR_TEST)}function jA(T,c,p){const b=T.context,v=b.gl,S=T.useProgram("debug"),P=zr.disabled,R=on.disabled,L=T.colorModeForRenderPass(),F="$debug",j=T.style.map.terrain&&T.style.map.terrain.getTerrainData(p);b.activeTexture.set(v.TEXTURE0);const J=c.getTileByID(p.key).latestRawTileData,X=Math.floor((J&&J.byteLength||0)/1024),Q=c.getTile(p).tileSize,ae=512/Math.min(Q,512)*(p.overscaledZ/T.transform.zoom)*.5;let ge=p.canonical.toString();p.overscaledZ!==p.canonical.z&&(ge+=` => ${p.overscaledZ}`),function(me,we){me.initDebugOverlayCanvas();const De=me.debugOverlayCanvas,Ae=me.context.gl,Re=me.debugOverlayCanvas.getContext("2d");Re.clearRect(0,0,De.width,De.height),Re.shadowColor="white",Re.shadowBlur=2,Re.lineWidth=1.5,Re.strokeStyle="white",Re.textBaseline="top",Re.font="bold 36px Open Sans, sans-serif",Re.fillText(we,5,5),Re.strokeText(we,5,5),me.debugOverlayTexture.update(De),me.debugOverlayTexture.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE)}(T,`${ge} ${X}kB`);const ye=T.transform.getProjectionData({overscaledTileID:p,applyGlobeMatrix:!0,applyTerrainMatrix:!0});S.draw(b,v.TRIANGLES,P,R,Un.alphaBlended,en.disabled,Gy(o.bp.transparent,ae),null,ye,F,T.debugBuffer,T.quadTriangleIndexBuffer,T.debugSegments),S.draw(b,v.LINE_STRIP,P,R,L,en.disabled,Gy(o.bp.red),j,ye,F,T.debugBuffer,T.tileBorderIndexBuffer,T.debugSegments)}function sb(T,c,p,b){const{isRenderingGlobe:v}=b,S=T.context,P=S.gl,R=T.transform,L=T.colorModeForRenderPass(),F=T.getDepthModeFor3D(),j=T.useProgram("terrain");S.bindFramebuffer.set(null),S.viewport.set([0,0,T.width,T.height]);for(const J of p){const X=c.getTerrainMesh(J.tileID),Q=T.renderToTexture.getTexture(J),ae=c.getTerrainData(J.tileID);S.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,Q.texture);const ge=c.getMeshFrameDelta(R.zoom),ye=R.calculateFogMatrix(J.tileID.toUnwrapped()),me=w2(ge,ye,T.style.sky,R.pitch,v),we=R.getProjectionData({overscaledTileID:J.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});j.draw(S,P.TRIANGLES,F,on.disabled,L,en.backCCW,me,ae,we,"terrain",X.vertexBuffer,X.indexBuffer,X.segments)}}function ob(T,c){if(!c.mesh){const p=new o.aW;p.emplaceBack(-1,-1),p.emplaceBack(1,-1),p.emplaceBack(1,1),p.emplaceBack(-1,1);const b=new o.aY;b.emplaceBack(0,1,2),b.emplaceBack(0,2,3),c.mesh=new dn(T.createVertexBuffer(p,ya.members),T.createIndexBuffer(b),o.aX.simpleSegment(0,0,p.length,b.length))}return c.mesh}class GA{constructor(c,p){this.context=new Kp(c),this.transform=p,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.ar(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Hs.maxOverzooming+Hs.maxUnderzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Cs}resize(c,p,b){if(this.width=Math.floor(c*b),this.height=Math.floor(p*b),this.pixelRatio=b,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const v of this.style._order)this.style._layers[v].resize()}setup(){const c=this.context,p=new o.aW;p.emplaceBack(0,0),p.emplaceBack(o.a5,0),p.emplaceBack(0,o.a5),p.emplaceBack(o.a5,o.a5),this.tileExtentBuffer=c.createVertexBuffer(p,ya.members),this.tileExtentSegments=o.aX.simpleSegment(0,0,4,2);const b=new o.aW;b.emplaceBack(0,0),b.emplaceBack(o.a5,0),b.emplaceBack(0,o.a5),b.emplaceBack(o.a5,o.a5),this.debugBuffer=c.createVertexBuffer(b,ya.members),this.debugSegments=o.aX.simpleSegment(0,0,4,5);const v=new o.ch;v.emplaceBack(0,0,0,0),v.emplaceBack(o.a5,0,o.a5,0),v.emplaceBack(0,o.a5,0,o.a5),v.emplaceBack(o.a5,o.a5,o.a5,o.a5),this.rasterBoundsBuffer=c.createVertexBuffer(v,x2.members),this.rasterBoundsSegments=o.aX.simpleSegment(0,0,4,2);const S=new o.aW;S.emplaceBack(0,0),S.emplaceBack(o.a5,0),S.emplaceBack(0,o.a5),S.emplaceBack(o.a5,o.a5),this.rasterBoundsBufferPosOnly=c.createVertexBuffer(S,ya.members),this.rasterBoundsSegmentsPosOnly=o.aX.simpleSegment(0,0,4,5);const P=new o.aW;P.emplaceBack(0,0),P.emplaceBack(1,0),P.emplaceBack(0,1),P.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(P,ya.members),this.viewportSegments=o.aX.simpleSegment(0,0,4,2);const R=new o.ci;R.emplaceBack(0),R.emplaceBack(1),R.emplaceBack(3),R.emplaceBack(2),R.emplaceBack(0),this.tileBorderIndexBuffer=c.createIndexBuffer(R);const L=new o.aY;L.emplaceBack(1,0,2),L.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(L);const F=this.context.gl;this.stencilClearMode=new on({func:F.ALWAYS,mask:0},0,255,F.ZERO,F.ZERO,F.ZERO),this.tileExtentMesh=new dn(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const c=this.context,p=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const b=o.N();o.c7(b,0,this.width,this.height,0,0,1),o.Q(b,b,[p.drawingBufferWidth,p.drawingBufferHeight,0]);const v={mainMatrix:b,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:b};this.useProgram("clippingMask",null,!0).draw(c,p.TRIANGLES,zr.disabled,this.stencilClearMode,Un.disabled,en.disabled,null,null,v,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(c,p,b){if(this.currentStencilSource===c.source||!c.isTileClipped()||!p||!p.length)return;this.currentStencilSource=c.source,this.nextStencilID+p.length>256&&this.clearStencil();const v=this.context;v.setColorMode(Un.disabled),v.setDepthMode(zr.disabled);const S={};for(const P of p)S[P.key]=this.nextStencilID++;this._renderTileMasks(S,p,b,!0),this._renderTileMasks(S,p,b,!1),this._tileClippingMaskIDs=S}_renderTileMasks(c,p,b,v){const S=this.context,P=S.gl,R=this.style.projection,L=this.transform,F=this.useProgram("clippingMask");for(const j of p){const J=c[j.key],X=this.style.map.terrain&&this.style.map.terrain.getTerrainData(j),Q=R.getMeshFromTileID(this.context,j.canonical,v,!0,"stencil"),ae=L.getProjectionData({overscaledTileID:j,applyGlobeMatrix:!b,applyTerrainMatrix:!0});F.draw(S,P.TRIANGLES,zr.disabled,new on({func:P.ALWAYS,mask:0},J,255,P.KEEP,P.KEEP,P.REPLACE),Un.disabled,b?en.disabled:en.backCCW,null,X,ae,"$clipping",Q.vertexBuffer,Q.indexBuffer,Q.segments)}}_renderTilesDepthBuffer(){const c=this.context,p=c.gl,b=this.style.projection,v=this.transform,S=this.useProgram("depth"),P=this.getDepthModeFor3D(),R=nn(v,{tileSize:v.tileSize});for(const L of R){const F=this.style.map.terrain&&this.style.map.terrain.getTerrainData(L),j=b.getMeshFromTileID(this.context,L.canonical,!0,!0,"raster"),J=v.getProjectionData({overscaledTileID:L,applyGlobeMatrix:!0,applyTerrainMatrix:!0});S.draw(c,p.TRIANGLES,P,on.disabled,Un.disabled,en.backCCW,null,F,J,"$clipping",j.vertexBuffer,j.indexBuffer,j.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const c=this.nextStencilID++,p=this.context.gl;return new on({func:p.NOTEQUAL,mask:255},c,255,p.KEEP,p.KEEP,p.REPLACE)}stencilModeForClipping(c){const p=this.context.gl;return new on({func:p.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,p.KEEP,p.KEEP,p.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(c){const p=this.context.gl,b=c.sort((P,R)=>R.overscaledZ-P.overscaledZ),v=b[b.length-1].overscaledZ,S=b[0].overscaledZ-v+1;if(S>1){this.currentStencilSource=void 0,this.nextStencilID+S>256&&this.clearStencil();const P={};for(let R=0;R<S;R++)P[R+v]=new on({func:p.GEQUAL,mask:255},R+this.nextStencilID,255,p.KEEP,p.KEEP,p.REPLACE);return this.nextStencilID+=S,[P,b]}return[{[v]:on.disabled},b]}stencilConfigForOverlapTwoPass(c){const p=this.context.gl,b=c.sort((P,R)=>R.overscaledZ-P.overscaledZ),v=b[b.length-1].overscaledZ,S=b[0].overscaledZ-v+1;if(this.clearStencil(),S>1){const P={},R={};for(let L=0;L<S;L++)P[L+v]=new on({func:p.GREATER,mask:255},S+1+L,255,p.KEEP,p.KEEP,p.REPLACE),R[L+v]=new on({func:p.GREATER,mask:255},1+L,255,p.KEEP,p.KEEP,p.REPLACE);return this.nextStencilID=2*S+1,[P,R,b]}return this.nextStencilID=3,[{[v]:new on({func:p.GREATER,mask:255},2,255,p.KEEP,p.KEEP,p.REPLACE)},{[v]:new on({func:p.GREATER,mask:255},1,255,p.KEEP,p.KEEP,p.REPLACE)},b]}colorModeForRenderPass(){const c=this.context.gl;return this._showOverdrawInspector?new Un([c.CONSTANT_COLOR,c.ONE],new o.bp(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Un.unblended:Un.alphaBlended}getDepthModeForSublayer(c,p,b){if(!this.opaquePassEnabledForLayer())return zr.disabled;const v=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new zr(b||this.context.gl.LEQUAL,p,[v,v])}getDepthModeFor3D(){return new zr(this.context.gl.LEQUAL,zr.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(c,p){var b,v;this.style=c,this.options=p,this.lineAtlas=c.lineAtlas,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(k()),this.imageManager.beginFrame();const S=this.style._order,P=this.style.tileManagers,R={},L={},F={},j={isRenderingToTexture:!1,isRenderingGlobe:((b=c.projection)===null||b===void 0?void 0:b.transitionState)>0};for(const X in P){const Q=P[X];Q.used&&Q.prepare(this.context),R[X]=Q.getVisibleCoordinates(!1),L[X]=R[X].slice().reverse(),F[X]=Q.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let X=0;X<S.length;X++)if(this.style._layers[S[X]].is3D()){this.opaquePassCutoff=X;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const X of S){const Q=this.style._layers[X];if(!Q.hasOffscreenPass()||Q.isHidden(this.transform.zoom))continue;const ae=L[Q.source];(Q.type==="custom"||ae.length)&&this.renderLayer(this,P[Q.source],Q,ae,j)}if((v=this.style.projection)===null||v===void 0||v.updateGPUdependent({context:this.context,useProgram:X=>this.useProgram(X)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:p.showOverdrawInspector?o.bp.black:o.bp.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(X,Q){const ae=X.context,ge=ae.gl,ye=((Le,Pe,$e)=>{const ct=Math.cos(Pe.rollInRadians),tt=Math.sin(Pe.rollInRadians),it=Cn(Pe),st=Pe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Le.properties.get("sky-color"),u_horizon_color:Le.properties.get("horizon-color"),u_horizon:[(Pe.width/2-it*tt)*$e,(Pe.height/2+it*ct)*$e],u_horizon_normal:[-tt,ct],u_sky_horizon_blend:Le.properties.get("sky-horizon-blend")*Pe.height/2*$e,u_sky_blend:st}})(Q,X.style.map.transform,X.pixelRatio),me=new zr(ge.LEQUAL,zr.ReadWrite,[0,1]),we=on.disabled,De=X.colorModeForRenderPass(),Ae=X.useProgram("sky"),Re=ob(ae,Q);Ae.draw(ae,ge.TRIANGLES,me,we,De,en.disabled,ye,null,void 0,"sky",Re.vertexBuffer,Re.indexBuffer,Re.segments)}(this,this.style.sky),this._showOverdrawInspector=p.showOverdrawInspector,this.depthRangeFor3D=[0,1-(c._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=S.length-1;this.currentLayer>=0;this.currentLayer--){const X=this.style._layers[S[this.currentLayer]],Q=P[X.source],ae=R[X.source];this._renderTileClippingMasks(X,ae,!1),this.renderLayer(this,Q,X,ae,j)}this.renderPass="translucent";let J=!1;for(this.currentLayer=0;this.currentLayer<S.length;this.currentLayer++){const X=this.style._layers[S[this.currentLayer]],Q=P[X.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(X,j))continue;this.opaquePassEnabledForLayer()||J||(J=!0,j.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const ae=(X.type==="symbol"?F:L)[X.source];this._renderTileClippingMasks(X,R[X.source],!!this.renderToTexture),this.renderLayer(this,Q,X,ae,j)}if(j.isRenderingGlobe&&function(X,Q,ae){const ge=X.context,ye=ge.gl,me=X.useProgram("atmosphere"),we=new zr(ye.LEQUAL,zr.ReadOnly,[0,1]),De=X.transform,Ae=function(st,Ot){const Lt=st.properties.get("position"),St=[-Lt.x,-Lt.y,-Lt.z],Ht=o.ar(new Float64Array(16));return st.properties.get("anchor")==="map"&&(o.bg(Ht,Ht,Ot.rollInRadians),o.bh(Ht,Ht,-Ot.pitchInRadians),o.bg(Ht,Ht,Ot.bearingInRadians),o.bh(Ht,Ht,Ot.center.lat*Math.PI/180),o.bJ(Ht,Ht,-Ot.center.lng*Math.PI/180)),o.cg(St,St,Ht),St}(ae,X.transform),Re=De.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Le=Q.properties.get("atmosphere-blend")*Re.projectionTransition;if(Le===0)return;const Pe=ou(De.worldSize,De.center.lat),$e=De.inverseProjectionMatrix,ct=new Float64Array(4);ct[3]=1,o.aH(ct,ct,De.modelViewProjectionMatrix),ct[0]/=ct[3],ct[1]/=ct[3],ct[2]/=ct[3],ct[3]=1,o.aH(ct,ct,$e),ct[0]/=ct[3],ct[1]/=ct[3],ct[2]/=ct[3],ct[3]=1;const tt=((st,Ot,Lt,St,Ht)=>({u_sun_pos:st,u_atmosphere_blend:Ot,u_globe_position:Lt,u_globe_radius:St,u_inv_proj_matrix:Ht}))(Ae,Le,[ct[0],ct[1],ct[2]],Pe,$e),it=ob(ge,Q);me.draw(ge,ye.TRIANGLES,we,on.disabled,Un.alphaBlended,en.disabled,tt,null,null,"atmosphere",it.vertexBuffer,it.indexBuffer,it.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const X=function(Q,ae){let ge=null;const ye=Object.values(Q._layers).flatMap(Ae=>Ae.source&&!Ae.isHidden(ae)?[Q.tileManagers[Ae.source]]:[]),me=ye.filter(Ae=>Ae.getSource().type==="vector"),we=ye.filter(Ae=>Ae.getSource().type!=="vector"),De=Ae=>{(!ge||ge.getSource().maxzoom<Ae.getSource().maxzoom)&&(ge=Ae)};return me.forEach(Ae=>De(Ae)),ge||we.forEach(Ae=>De(Ae)),ge}(this.style,this.transform.zoom);X&&function(Q,ae,ge){for(let ye=0;ye<ge.length;ye++)jA(Q,ae,ge[ye])}(this,X,X.getVisibleCoordinates())}this.options.showPadding&&function(X){const Q=X.transform.padding;nb(X,X.transform.height-(Q.top||0),3,UA),nb(X,Q.bottom||0,3,zA),ib(X,Q.left||0,3,VA),ib(X,X.transform.width-(Q.right||0),3,$A);const ae=X.transform.centerPoint;(function(ge,ye,me,we){Xd(ge,ye-1,me-10,2,20,we),Xd(ge,ye-10,me-1,20,2,we)})(X,ae.x,X.transform.height-ae.y,bc)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(c){if(!this.style||!this.style.map||!this.style.map.terrain)return;const p=this.terrainFacilitator.matrix,b=this.transform.modelViewProjectionMatrix;let v=this.terrainFacilitator.dirty;v||(v=c?!o.cj(p,b):!o.ck(p,b)),v||(v=this.style.map.terrain.tileManager.anyTilesAfterTime(this.terrainFacilitator.renderTime)),v&&(o.cl(p,b),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(S,P){const R=S.context,L=R.gl,F=S.transform,j=Un.unblended,J=new zr(L.LEQUAL,zr.ReadWrite,[0,1]),X=P.tileManager.getRenderableTiles(),Q=S.useProgram("terrainDepth");R.bindFramebuffer.set(P.getFramebuffer("depth").framebuffer),R.viewport.set([0,0,S.width/devicePixelRatio,S.height/devicePixelRatio]),R.clear({color:o.bp.transparent,depth:1});for(const ae of X){const ge=P.getTerrainMesh(ae.tileID),ye=P.getTerrainData(ae.tileID),me=F.getProjectionData({overscaledTileID:ae.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),we={u_ele_delta:P.getMeshFrameDelta(F.zoom)};Q.draw(R,L.TRIANGLES,J,on.disabled,j,en.backCCW,we,ye,me,"terrain",ge.vertexBuffer,ge.indexBuffer,ge.segments)}R.bindFramebuffer.set(null),R.viewport.set([0,0,S.width,S.height])}(this,this.style.map.terrain),function(S,P){const R=S.context,L=R.gl,F=S.transform,j=Un.unblended,J=new zr(L.LEQUAL,zr.ReadWrite,[0,1]),X=P.getCoordsTexture(),Q=P.tileManager.getRenderableTiles(),ae=S.useProgram("terrainCoords");R.bindFramebuffer.set(P.getFramebuffer("coords").framebuffer),R.viewport.set([0,0,S.width/devicePixelRatio,S.height/devicePixelRatio]),R.clear({color:o.bp.transparent,depth:1}),P.coordsIndex=[];for(const ge of Q){const ye=P.getTerrainMesh(ge.tileID),me=P.getTerrainData(ge.tileID);R.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,X.texture);const we={u_terrain_coords_id:(255-P.coordsIndex.length)/255,u_texture:0,u_ele_delta:P.getMeshFrameDelta(F.zoom)},De=F.getProjectionData({overscaledTileID:ge.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});ae.draw(R,L.TRIANGLES,J,on.disabled,j,en.backCCW,we,me,De,"terrain",ye.vertexBuffer,ye.indexBuffer,ye.segments),P.coordsIndex.push(ge.tileID.key)}R.bindFramebuffer.set(null),R.viewport.set([0,0,S.width,S.height])}(this,this.style.map.terrain))}renderLayer(c,p,b,v,S){b.isHidden(this.transform.zoom)||(b.type==="background"||b.type==="custom"||(v||[]).length)&&(this.id=b.id,o.cm(b)?function(P,R,L,F,j,J){if(P.renderPass!=="translucent")return;const{isRenderingToTexture:X}=J,Q=on.disabled,ae=P.colorModeForRenderPass();(L._unevaluatedLayout.hasValue("text-variable-anchor")||L._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ge,ye,me,we,De,Ae,Re,Le,Pe){const $e=ye.transform,ct=ye.style.map.terrain,tt=De==="map",it=Ae==="map";for(const st of ge){const Ot=we.getTile(st),Lt=Ot.getBucket(me);if(!Lt||!Lt.text||!Lt.text.segments.get().length)continue;const St=o.ay(Lt.textSizeData,$e.zoom),Ht=o.aN(Ot,1,ye.transform.zoom),Or=Ws(tt,ye.transform,Ht),bn=me.layout.get("icon-text-fit")!=="none"&&Lt.hasIconData();if(St){const qn=Math.pow(2,$e.zoom-Ot.tileID.overscaledZ),zn=ct?(si,Vn)=>ct.getElevation(st,si,Vn):null;D2(Lt,tt,it,Pe,$e,Or,qn,St,bn,o.aO($e,Ot,Re,Le),st.toUnwrapped(),zn)}}}(F,P,L,R,L.layout.get("text-rotation-alignment"),L.layout.get("text-pitch-alignment"),L.paint.get("text-translate"),L.paint.get("text-translate-anchor"),j),L.paint.get("icon-opacity").constantOr(1)!==0&&Gd(P,R,L,F,!1,L.paint.get("icon-translate"),L.paint.get("icon-translate-anchor"),L.layout.get("icon-rotation-alignment"),L.layout.get("icon-pitch-alignment"),L.layout.get("icon-keep-upright"),Q,ae,X),L.paint.get("text-opacity").constantOr(1)!==0&&Gd(P,R,L,F,!0,L.paint.get("text-translate"),L.paint.get("text-translate-anchor"),L.layout.get("text-rotation-alignment"),L.layout.get("text-pitch-alignment"),L.layout.get("text-keep-upright"),Q,ae,X),R.map.showCollisionBoxes&&(du(P,R,L,F,!0),du(P,R,L,F,!1))}(c,p,b,v,this.style.placement.variableOffsets,S):o.cn(b)?function(P,R,L,F,j){if(P.renderPass!=="translucent")return;const{isRenderingToTexture:J}=j,X=L.paint.get("circle-opacity"),Q=L.paint.get("circle-stroke-width"),ae=L.paint.get("circle-stroke-opacity"),ge=!L.layout.get("circle-sort-key").isConstant();if(X.constantOr(1)===0&&(Q.constantOr(1)===0||ae.constantOr(1)===0))return;const ye=P.context,me=ye.gl,we=P.transform,De=P.getDepthModeForSublayer(0,zr.ReadOnly),Ae=on.disabled,Re=P.colorModeForRenderPass(),Le=[],Pe=we.getCircleRadiusCorrection();for(let $e=0;$e<F.length;$e++){const ct=F[$e],tt=R.getTile(ct),it=tt.getBucket(L);if(!it)continue;const st=L.paint.get("circle-translate"),Ot=L.paint.get("circle-translate-anchor"),Lt=o.aO(we,tt,st,Ot),St=it.programConfigurations.get(L.id),Ht=P.useProgram("circle",St),Or=it.layoutVertexBuffer,bn=it.indexBuffer,qn=P.style.map.terrain&&P.style.map.terrain.getTerrainData(ct),zn={programConfiguration:St,program:Ht,layoutVertexBuffer:Or,indexBuffer:bn,uniformValues:_A(P,tt,L,Lt,Pe),terrainData:qn,projectionData:we.getProjectionData({overscaledTileID:ct,applyGlobeMatrix:!J,applyTerrainMatrix:!0})};if(ge){const si=it.segments.get();for(const Vn of si)Le.push({segments:new o.aX([Vn]),sortKey:Vn.sortKey,state:zn})}else Le.push({segments:it.segments,sortKey:0,state:zn})}ge&&Le.sort(($e,ct)=>$e.sortKey-ct.sortKey);for(const $e of Le){const{programConfiguration:ct,program:tt,layoutVertexBuffer:it,indexBuffer:st,uniformValues:Ot,terrainData:Lt,projectionData:St}=$e.state;tt.draw(ye,me.TRIANGLES,De,Ae,Re,en.backCCW,Ot,Lt,St,L.id,it,st,$e.segments,L.paint,P.transform.zoom,ct)}}(c,p,b,v,S):o.co(b)?function(P,R,L,F,j){if(L.paint.get("heatmap-opacity")===0)return;const J=P.context,{isRenderingToTexture:X,isRenderingGlobe:Q}=j;if(P.style.map.terrain){for(const ae of F){const ge=R.getTile(ae);R.hasRenderableParent(ae)||(P.renderPass==="offscreen"?OA(P,ge,L,ae,Q):P.renderPass==="translucent"&&DA(P,L,ae,X,Q))}J.viewport.set([0,0,P.width,P.height])}else P.renderPass==="offscreen"?function(ae,ge,ye,me){const we=ae.context,De=we.gl,Ae=ae.transform,Re=on.disabled,Le=new Un([De.ONE,De.ONE],o.bp.transparent,[!0,!0,!0,!0]);(function(Pe,$e,ct){const tt=Pe.gl;Pe.activeTexture.set(tt.TEXTURE1),Pe.viewport.set([0,0,$e.width/4,$e.height/4]);let it=ct.heatmapFbos.get(o.cd);it?(tt.bindTexture(tt.TEXTURE_2D,it.colorAttachment.get()),Pe.bindFramebuffer.set(it.framebuffer)):(it=Hd(Pe,$e.width/4,$e.height/4),ct.heatmapFbos.set(o.cd,it))})(we,ae,ye),we.clear({color:o.bp.transparent});for(let Pe=0;Pe<me.length;Pe++){const $e=me[Pe];if(ge.hasRenderableParent($e))continue;const ct=ge.getTile($e),tt=ct.getBucket(ye);if(!tt)continue;const it=tt.programConfigurations.get(ye.id),st=ae.useProgram("heatmap",it),Ot=Ae.getProjectionData({overscaledTileID:$e,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Lt=Ae.getCircleRadiusCorrection();st.draw(we,De.TRIANGLES,zr.disabled,Re,Le,en.backCCW,bh(ct,Ae.zoom,ye.paint.get("heatmap-intensity"),Lt),null,Ot,ye.id,tt.layoutVertexBuffer,tt.indexBuffer,tt.segments,ye.paint,Ae.zoom,it)}we.viewport.set([0,0,ae.width,ae.height])}(P,R,L,F):P.renderPass==="translucent"&&function(ae,ge){const ye=ae.context,me=ye.gl;ye.setColorMode(ae.colorModeForRenderPass());const we=ge.heatmapFbos.get(o.cd);we&&(ye.activeTexture.set(me.TEXTURE0),me.bindTexture(me.TEXTURE_2D,we.colorAttachment.get()),ye.activeTexture.set(me.TEXTURE1),Jp(ye,ge).bind(me.LINEAR,me.CLAMP_TO_EDGE),ae.useProgram("heatmapTexture").draw(ye,me.TRIANGLES,zr.disabled,on.disabled,ae.colorModeForRenderPass(),en.disabled,AA(ae,ge,0,1),null,null,ge.id,ae.viewportBuffer,ae.quadTriangleIndexBuffer,ae.viewportSegments,ge.paint,ae.transform.zoom))}(P,L)}(c,p,b,v,S):o.cp(b)?function(P,R,L,F,j){if(P.renderPass!=="translucent")return;const{isRenderingToTexture:J}=j,X=L.paint.get("line-opacity"),Q=L.paint.get("line-width");if(X.constantOr(1)===0||Q.constantOr(1)===0)return;const ae=P.getDepthModeForSublayer(0,zr.ReadOnly),ge=P.colorModeForRenderPass(),ye=L.paint.get("line-dasharray"),me=ye.constantOr(1),we=L.paint.get("line-pattern"),De=we.constantOr(1),Ae=L.paint.get("line-gradient"),Re=L.getCrossfadeParameters();let Le;Le=De?"linePattern":me&&Ae?"lineGradientSDF":me?"lineSDF":Ae?"lineGradient":"line";const Pe=P.context,$e=Pe.gl,ct=P.transform;let tt=!0;for(const it of F){const st=R.getTile(it);if(De&&!st.patternsLoaded())continue;const Ot=st.getBucket(L);if(!Ot)continue;const Lt=Ot.programConfigurations.get(L.id),St=P.context.program.get(),Ht=P.useProgram(Le,Lt),Or=tt||Ht.program!==St,bn=P.style.map.terrain&&P.style.map.terrain.getTerrainData(it),qn=we.constantOr(null),zn=ye&&ye.constantOr(null);if(qn&&st.imageAtlas){const as=st.imageAtlas,ki=as.patternPositions[qn.to.toString()],Si=as.patternPositions[qn.from.toString()];ki&&Si&&Lt.setConstantPatternPositions(ki,Si)}else if(zn){const as=L.layout.get("line-cap")==="round",ki=P.lineAtlas.getDash(zn.to,as),Si=P.lineAtlas.getDash(zn.from,as);Lt.setConstantDashPositions(ki,Si)}const si=ct.getProjectionData({overscaledTileID:it,applyGlobeMatrix:!J,applyTerrainMatrix:!0}),Vn=ct.getPixelScale();let bi;De?(bi=Hy(P,st,L,Vn,Re),NA(Pe,$e,st,Lt,Re)):me&&Ae?(bi=Dp(P,st,L,Vn,Re,Ot.lineClipsArray.length),Po(P,R,Pe,$e,L,Ot,it,Lt,Re)):me?(bi=CA(P,st,L,Vn,Re),Ci(P,Pe,$e,Lt,Or,Re)):Ae?(bi=wA(P,st,L,Vn,Ot.lineClipsArray.length),fu(P,R,Pe,$e,L,Ot,it)):bi=Fd(P,st,L,Vn);const oi=P.stencilModeForClipping(it);Ht.draw(Pe,$e.TRIANGLES,ae,oi,ge,en.disabled,bi,bn,si,L.id,Ot.layoutVertexBuffer,Ot.indexBuffer,Ot.segments,L.paint,P.transform.zoom,Lt,Ot.layoutVertexBuffer2),tt=!1}}(c,p,b,v,S):o.cq(b)?function(P,R,L,F,j){const J=L.paint.get("fill-color"),X=L.paint.get("fill-opacity");if(X.constantOr(1)===0)return;const{isRenderingToTexture:Q}=j,ae=P.colorModeForRenderPass(),ge=L.paint.get("fill-pattern"),ye=P.opaquePassEnabledForLayer()&&!ge.constantOr(1)&&J.constantOr(o.bp.transparent).a===1&&X.constantOr(0)===1?"opaque":"translucent";if(P.renderPass===ye){const me=P.getDepthModeForSublayer(1,P.renderPass==="opaque"?zr.ReadWrite:zr.ReadOnly);Wd(P,R,L,F,me,ae,!1,Q)}if(P.renderPass==="translucent"&&L.paint.get("fill-antialias")){const me=P.getDepthModeForSublayer(L.getPaintProperty("fill-outline-color")?2:0,zr.ReadOnly);Wd(P,R,L,F,me,ae,!0,Q)}}(c,p,b,v,S):o.cr(b)?function(P,R,L,F,j){const J=L.paint.get("fill-extrusion-opacity");if(J===0)return;const{isRenderingToTexture:X}=j;if(P.renderPass==="translucent"){const Q=new zr(P.context.gl.LEQUAL,zr.ReadWrite,P.depthRangeFor3D);if(J!==1||L.paint.get("fill-extrusion-pattern").constantOr(1))Yp(P,R,L,F,Q,on.disabled,Un.disabled,X),Yp(P,R,L,F,Q,P.stencilModeFor3D(),P.colorModeForRenderPass(),X);else{const ae=P.colorModeForRenderPass();Yp(P,R,L,F,Q,on.disabled,ae,X)}}}(c,p,b,v,S):o.cs(b)?function(P,R,L,F,j){if(P.renderPass!=="offscreen"&&P.renderPass!=="translucent")return;const{isRenderingToTexture:J}=j,X=P.context,Q=P.style.projection.useSubdivision,ae=P.getDepthModeForSublayer(0,zr.ReadOnly),ge=P.colorModeForRenderPass();if(P.renderPass==="offscreen")(function(ye,me,we,De,Ae,Re,Le){const Pe=ye.context,$e=Pe.gl;for(const ct of we){const tt=me.getTile(ct),it=tt.dem;if(!it||!it.data||!tt.needsHillshadePrepare)continue;const st=it.dim,Ot=it.stride,Lt=it.getPixels();if(Pe.activeTexture.set($e.TEXTURE1),Pe.pixelStoreUnpackPremultiplyAlpha.set(!1),tt.demTexture=tt.demTexture||ye.getTileTexture(Ot),tt.demTexture){const Ht=tt.demTexture;Ht.update(Lt,{premultiply:!1}),Ht.bind($e.NEAREST,$e.CLAMP_TO_EDGE)}else tt.demTexture=new o.T(Pe,Lt,$e.RGBA,{premultiply:!1}),tt.demTexture.bind($e.NEAREST,$e.CLAMP_TO_EDGE);Pe.activeTexture.set($e.TEXTURE0);let St=tt.fbo;if(!St){const Ht=new o.T(Pe,{width:st,height:st,data:null},$e.RGBA);Ht.bind($e.LINEAR,$e.CLAMP_TO_EDGE),St=tt.fbo=Pe.createFramebuffer(st,st,!0,!1),St.colorAttachment.set(Ht.texture)}Pe.bindFramebuffer.set(St.framebuffer),Pe.viewport.set([0,0,st,st]),ye.useProgram("hillshadePrepare").draw(Pe,$e.TRIANGLES,Ae,Re,Le,en.disabled,C2(tt.tileID,it),null,null,De.id,ye.rasterBoundsBuffer,ye.quadTriangleIndexBuffer,ye.rasterBoundsSegments),tt.needsHillshadePrepare=!1}})(P,R,F,L,ae,on.disabled,ge),X.viewport.set([0,0,P.width,P.height]);else if(P.renderPass==="translucent")if(Q){const[ye,me,we]=P.stencilConfigForOverlapTwoPass(F);yc(P,R,L,we,ye,ae,ge,!1,J),yc(P,R,L,we,me,ae,ge,!0,J)}else{const[ye,me]=P.getStencilConfigForOverlapAndUpdateStencilID(F);yc(P,R,L,me,ye,ae,ge,!1,J)}}(c,p,b,v,S):o.ct(b)?function(P,R,L,F,j){if(P.renderPass!=="translucent"||!F.length)return;const{isRenderingToTexture:J}=j,X=P.style.projection.useSubdivision,Q=P.getDepthModeForSublayer(0,zr.ReadOnly),ae=P.colorModeForRenderPass();if(X){const[ge,ye,me]=P.stencilConfigForOverlapTwoPass(F);Kd(P,R,L,me,ge,Q,ae,!1,J),Kd(P,R,L,me,ye,Q,ae,!0,J)}else{const[ge,ye]=P.getStencilConfigForOverlapAndUpdateStencilID(F);Kd(P,R,L,ye,ge,Q,ae,!1,J)}}(c,p,b,v,S):o.bU(b)?function(P,R,L,F,j){if(P.renderPass!=="translucent"||L.paint.get("raster-opacity")===0||!F.length)return;const{isRenderingToTexture:J}=j,X=R.getSource(),Q=P.style.projection.useSubdivision;if(X instanceof cr)wh(P,R,L,F,null,!1,!1,X.tileCoords,X.flippedWindingOrder,J);else if(Q){const[ae,ge,ye]=P.stencilConfigForOverlapTwoPass(F);wh(P,R,L,ye,ae,!1,!0,pu,!1,J),wh(P,R,L,ye,ge,!0,!0,pu,!1,J)}else{const[ae,ge]=P.getStencilConfigForOverlapAndUpdateStencilID(F);wh(P,R,L,ge,ae,!1,!0,pu,!1,J)}}(c,p,b,v,S):o.cu(b)?function(P,R,L,F,j){const J=L.paint.get("background-color"),X=L.paint.get("background-opacity");if(X===0)return;const{isRenderingToTexture:Q}=j,ae=P.context,ge=ae.gl,ye=P.style.projection,me=P.transform,we=me.tileSize,De=L.paint.get("background-pattern");if(P.isPatternMissing(De))return;const Ae=!De&&J.a===1&&X===1&&P.opaquePassEnabledForLayer()?"opaque":"translucent";if(P.renderPass!==Ae)return;const Re=on.disabled,Le=P.getDepthModeForSublayer(0,Ae==="opaque"?zr.ReadWrite:zr.ReadOnly),Pe=P.colorModeForRenderPass(),$e=P.useProgram(De?"backgroundPattern":"background"),ct=F||nn(me,{tileSize:we,terrain:P.style.map.terrain});De&&(ae.activeTexture.set(ge.TEXTURE0),P.imageManager.bind(P.context));const tt=L.getCrossfadeParameters();for(const it of ct){const st=me.getProjectionData({overscaledTileID:it,applyGlobeMatrix:!Q,applyTerrainMatrix:!0}),Ot=De?S2(X,P,De,{tileID:it,tileSize:we},tt):Jy(X,J),Lt=P.style.map.terrain&&P.style.map.terrain.getTerrainData(it),St=ye.getMeshFromTileID(ae,it.canonical,!1,!0,"raster");$e.draw(ae,ge.TRIANGLES,Le,Re,Pe,en.backCCW,Ot,Lt,st,L.id,St.vertexBuffer,St.indexBuffer,St.segments)}}(c,0,b,v,S):o.cv(b)&&function(P,R,L,F){const{isRenderingGlobe:j}=F,J=P.context,X=L.implementation,Q=P.style.projection,ae=P.transform,ge=ae.getProjectionDataForCustomLayer(j),ye={farZ:ae.farZ,nearZ:ae.nearZ,fov:ae.fov*Math.PI/180,modelViewProjectionMatrix:ae.modelViewProjectionMatrix,projectionMatrix:ae.projectionMatrix,shaderData:{variantName:Q.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${Q.shaderPreludeCode.vertexSource}`,define:Q.shaderDefine},defaultProjectionData:ge},me=X.renderingMode?X.renderingMode:"2d";if(P.renderPass==="offscreen"){const we=X.prerender;we&&(P.setCustomLayerDefaults(),J.setColorMode(P.colorModeForRenderPass()),we.call(X,J.gl,ye),J.setDirty(),P.setBaseState())}else if(P.renderPass==="translucent"){P.setCustomLayerDefaults(),J.setColorMode(P.colorModeForRenderPass()),J.setStencilMode(on.disabled);const we=me==="3d"?P.getDepthModeFor3D():P.getDepthModeForSublayer(0,zr.ReadOnly);J.setDepthMode(we),X.render(J.gl,ye),J.setDirty(),P.setBaseState(),J.bindFramebuffer.set(null)}}(c,0,b,S))}saveTileTexture(c){const p=this._tileTextures[c.size[0]];p?p.push(c):this._tileTextures[c.size[0]]=[c]}getTileTexture(c){const p=this._tileTextures[c];return p&&p.length>0?p.pop():null}isPatternMissing(c){if(!c)return!1;if(!c.from||!c.to)return!0;const p=this.imageManager.getPattern(c.from.toString()),b=this.imageManager.getPattern(c.to.toString());return!p||!b}useProgram(c,p,b=!1,v=[]){this.cache=this.cache||{};const S=!!this.style.map.terrain,P=this.style.projection,R=b?Zr.projectionMercator:P.shaderPreludeCode,L=b?Ks:P.shaderDefine,F=c+(p?p.cacheKey:"")+`/${b?Io:P.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(S?"/terrain":"")+(v?`/${v.join("/")}`:"");return this.cache[F]||(this.cache[F]=new gA(this.context,Zr[c],p,E2[c],this._showOverdrawInspector,S,R,L,v)),this.cache[F]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){var c,p;if(this._tileTextures){for(const b in this._tileTextures){const v=this._tileTextures[b];if(v)for(const S of v)S.destroy()}this._tileTextures={}}if(this.tileExtentBuffer&&this.tileExtentBuffer.destroy(),this.debugBuffer&&this.debugBuffer.destroy(),this.rasterBoundsBuffer&&this.rasterBoundsBuffer.destroy(),this.rasterBoundsBufferPosOnly&&this.rasterBoundsBufferPosOnly.destroy(),this.viewportBuffer&&this.viewportBuffer.destroy(),this.tileBorderIndexBuffer&&this.tileBorderIndexBuffer.destroy(),this.quadTriangleIndexBuffer&&this.quadTriangleIndexBuffer.destroy(),this.tileExtentMesh&&((c=this.tileExtentMesh.vertexBuffer)===null||c===void 0||c.destroy()),this.tileExtentMesh&&((p=this.tileExtentMesh.indexBuffer)===null||p===void 0||p.destroy()),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.cache){for(const b in this.cache){const v=this.cache[b];v&&v.program&&this.context.gl.deleteProgram(v.program)}this.cache={}}this.context&&this.context.setDefault()}overLimit(){const{drawingBufferWidth:c,drawingBufferHeight:p}=this.context.gl;return this.width!==c||this.height!==p}}function ab(T,c){let p,b=!1,v=null,S=null;const P=()=>{v=null,b&&(T.apply(S,p),v=setTimeout(P,c),b=!1)};return(...R)=>(b=!0,S=this,p=R,v||P(),v)}class lb{constructor(c){this._getCurrentHash=()=>{const p=window.location.hash.replace("#","");if(this._hashName){let b;return p.split("&").map(v=>v.split("=")).forEach(v=>{v[0]===this._hashName&&(b=v)}),(b&&b[1]||"").split("/")}return p.split("/")},this._onHashChange=()=>{const p=this._getCurrentHash();if(!this._isValidHash(p))return!1;const b=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(p[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+p[2],+p[1]],zoom:+p[0],bearing:b,pitch:+(p[4]||0)}),!0},this._updateHashUnthrottled=()=>{const p=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,p)},this._removeHash=()=>{const p=this._getCurrentHash();if(p.length===0)return;const b=p.join("/");let v=b;v.split("&").length>0&&(v=v.split("&")[0]),this._hashName&&(v=`${this._hashName}=${b}`);let S=window.location.hash.replace(v,"");S.startsWith("#&")?S=S.slice(0,1)+S.slice(2):S==="#"&&(S="");let P=window.location.href.replace(/(#.+)?$/,S);P=P.replace("&&","&"),window.history.replaceState(window.history.state,null,P)},this._updateHash=ab(this._updateHashUnthrottled,300),this._hashName=c&&encodeURIComponent(c)}addTo(c){return this._map=c,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(c){const p=this._map.getCenter(),b=Math.round(100*this._map.getZoom())/100,v=Math.ceil((b*Math.LN2+Math.log(512/360/.5))/Math.LN10),S=Math.pow(10,v),P=Math.round(p.lng*S)/S,R=Math.round(p.lat*S)/S,L=this._map.getBearing(),F=this._map.getPitch();let j="";if(j+=c?`/${P}/${R}/${b}`:`${b}/${R}/${P}`,(L||F)&&(j+="/"+Math.round(10*L)/10),F&&(j+=`/${Math.round(F)}`),this._hashName){const J=this._hashName;let X=!1;const Q=window.location.hash.slice(1).split("&").map(ae=>{const ge=ae.split("=")[0];return ge===J?(X=!0,`${ge}=${j}`):ae}).filter(ae=>ae);return X||Q.push(`${J}=${j}`),`#${Q.join("&")}`}return`#${j}`}_isValidHash(c){if(c.length<3||c.some(isNaN))return!1;try{new o.V(+c[2],+c[1])}catch{return!1}const p=+c[0],b=+(c[3]||0),v=+(c[4]||0);return p>=this._map.getMinZoom()&&p<=this._map.getMaxZoom()&&b>=-180&&b<=180&&v>=this._map.getMinPitch()&&v<=this._map.getMaxPitch()}}const _c={linearity:.3,easing:o.cw(0,0,.3,1)},HA=o.e({deceleration:2500,maxSpeed:1400},_c),Xo=o.e({deceleration:20,maxSpeed:1400},_c),_a=o.e({deceleration:1e3,maxSpeed:360},_c),WA=o.e({deceleration:1e3,maxSpeed:90},_c),va=o.e({deceleration:1e3,maxSpeed:360},_c);class L2{constructor(c){this._map=c,this.clear()}clear(){this._inertiaBuffer=[]}record(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:k(),settings:c})}_drainInertiaBuffer(){const c=this._inertiaBuffer,p=k();for(;c.length>0&&p-c[0].time>160;)c.shift()}_onMoveEnd(c){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const p={zoom:0,bearing:0,pitch:0,roll:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:S}of this._inertiaBuffer)p.zoom+=S.zoomDelta||0,p.bearing+=S.bearingDelta||0,p.pitch+=S.pitchDelta||0,p.roll+=S.rollDelta||0,S.panDelta&&p.pan._add(S.panDelta),S.around&&(p.around=S.around),S.pinchAround&&(p.pinchAround=S.pinchAround);const b=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(p.pan.mag()){const S=qd(p.pan.mag(),b,o.e({},HA,c||{})),P=p.pan.mult(S.amount/p.pan.mag()),R=this._map.cameraHelper.handlePanInertia(P,this._map.transform);v.center=R.easingCenter,v.offset=R.easingOffset,Jd(v,S)}if(p.zoom){const S=qd(p.zoom,b,Xo);v.zoom=this._map.transform.zoom+S.amount,Jd(v,S)}if(p.bearing){const S=qd(p.bearing,b,_a);v.bearing=this._map.transform.bearing+o.an(S.amount,-179,179),Jd(v,S)}if(p.pitch){const S=qd(p.pitch,b,WA);v.pitch=this._map.transform.pitch+S.amount,Jd(v,S)}if(p.roll){const S=qd(p.roll,b,va);v.roll=this._map.transform.roll+o.an(S.amount,-179,179),Jd(v,S)}if(v.zoom||v.bearing){const S=p.pinchAround===void 0?p.around:p.pinchAround;v.around=S?this._map.unproject(S):this._map.getCenter()}return this.clear(),o.e(v,{noMoveStart:!0})}}function Jd(T,c){(!T.duration||T.duration<c.duration)&&(T.duration=c.duration,T.easing=c.easing)}function qd(T,c,p){const{maxSpeed:b,linearity:v,deceleration:S}=p,P=o.an(T*v/(c/1e3),-b,b),R=Math.abs(P)/(S*v);return{easing:p.easing,duration:1e3*R,amount:P*(R/2)}}class os extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,p,b,v={}){b=b instanceof MouseEvent?b:new MouseEvent(c,b);const S=D.mousePos(p.getCanvas(),b),P=p.unproject(S);super(c,o.e({point:S,lngLat:P,originalEvent:b},v)),this._defaultPrevented=!1,this.target=p}}class Yd extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,p,b){const v=c==="touchend"?b.changedTouches:b.touches,S=D.touchPos(p.getCanvasContainer(),v),P=S.map(L=>p.unproject(L)),R=S.reduce((L,F,j,J)=>L.add(F.div(J.length)),new o.P(0,0));super(c,{points:S,point:R,lngLats:P,lngLat:p.unproject(R),originalEvent:b}),this._defaultPrevented=!1}}class KA extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,p,b){super(c,{originalEvent:b}),this._defaultPrevented=!1}}class N2{constructor(c,p){this._map=c,this._clickTolerance=p.clickTolerance}reset(){delete this._mousedownPos}wheel(c){return this._firePreventable(new KA(c.type,this._map,c))}mousedown(c,p){return this._mousedownPos=p,this._firePreventable(new os(c.type,this._map,c))}mouseup(c){this._map.fire(new os(c.type,this._map,c))}click(c,p){this._mousedownPos&&this._mousedownPos.dist(p)>=this._clickTolerance||this._map.fire(new os(c.type,this._map,c))}dblclick(c){return this._firePreventable(new os(c.type,this._map,c))}mouseover(c){this._map.fire(new os(c.type,this._map,c))}mouseout(c){this._map.fire(new os(c.type,this._map,c))}touchstart(c){return this._firePreventable(new Yd(c.type,this._map,c))}touchmove(c){this._map.fire(new Yd(c.type,this._map,c))}touchend(c){this._map.fire(new Yd(c.type,this._map,c))}touchcancel(c){this._map.fire(new Yd(c.type,this._map,c))}_firePreventable(c){if(this._map.fire(c),c.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class F2{constructor(c){this._map=c}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(c){this._map.fire(new os(c.type,this._map,c))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new os("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(c){this._delayContextMenu?this._contextMenuEvent=c:this._ignoreContextMenu||this._map.fire(new os(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ch{constructor(c){this._map=c}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(c){return this.transform.screenPointToLocation(o.P.convert(c),this._map.terrain)}}class Th{constructor(c,p){this._map=c,this._tr=new Ch(c),this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=p.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(c,p){this.isEnabled()&&c.shiftKey&&c.button===0&&(D.disableDrag(),this._startPos=this._lastPos=p,this._active=!0)}mousemoveWindow(c,p){if(!this._active)return;const b=p;if(this._lastPos.equals(b)||!this._box&&b.dist(this._startPos)<this._clickTolerance)return;const v=this._startPos;this._lastPos=b,this._box||(this._box=D.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",c));const S=Math.min(v.x,b.x),P=Math.max(v.x,b.x),R=Math.min(v.y,b.y),L=Math.max(v.y,b.y);D.setTransform(this._box,`translate(${S}px,${R}px)`),this._box.style.width=P-S+"px",this._box.style.height=L-R+"px"}mouseupWindow(c,p){if(!this._active||c.button!==0)return;const b=this._startPos,v=p;if(this.reset(),D.suppressClick(),b.x!==v.x||b.y!==v.y)return this._map.fire(new o.l("boxzoomend",{originalEvent:c})),{cameraAnimation:S=>S.fitScreenCoordinates(b,v,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",c)}keydown(c){this._active&&c.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",c))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(D.remove(this._box),this._box=null),D.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(c,p){return this._map.fire(new o.l(c,{originalEvent:p}))}}function Aa(T,c){if(T.length!==c.length)throw new Error(`The number of touches and points are not equal - touches ${T.length}, points ${c.length}`);const p={};for(let b=0;b<T.length;b++)p[T[b].identifier]=c[b];return p}class er{constructor(c){this.reset(),this.numTouches=c.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(c,p,b){(this.centroid||b.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=c.timeStamp),b.length===this.numTouches&&(this.centroid=function(v){const S=new o.P(0,0);for(const P of v)S._add(P);return S.div(v.length)}(p),this.touches=Aa(b,p)))}touchmove(c,p,b){if(this.aborted||!this.centroid)return;const v=Aa(b,p);for(const S in this.touches){const P=v[S];(!P||P.dist(this.touches[S])>30)&&(this.aborted=!0)}}touchend(c,p,b){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),b.length===0){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class Zp{constructor(c){this.singleTap=new er(c),this.numTaps=c.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(c,p,b){this.singleTap.touchstart(c,p,b)}touchmove(c,p,b){this.singleTap.touchmove(c,p,b)}touchend(c,p,b){const v=this.singleTap.touchend(c,p,b);if(v){const S=c.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(v)<30;if(S&&P||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class cb{constructor(c){this._tr=new Ch(c),this._zoomIn=new Zp({numTouches:1,numTaps:2}),this._zoomOut=new Zp({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(c,p,b){this._zoomIn.touchstart(c,p,b),this._zoomOut.touchstart(c,p,b)}touchmove(c,p,b){this._zoomIn.touchmove(c,p,b),this._zoomOut.touchmove(c,p,b)}touchend(c,p,b){const v=this._zoomIn.touchend(c,p,b),S=this._zoomOut.touchend(c,p,b),P=this._tr;return v?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:P.zoom+1,around:P.unproject(v)},{originalEvent:c})}):S?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:P.zoom-1,around:P.unproject(S)},{originalEvent:c})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Sh{constructor(c){this._enabled=!!c.enable,this._moveStateManager=c.moveStateManager,this._clickTolerance=c.clickTolerance||1,this._moveFunction=c.move,this._activateOnStart=!!c.activateOnStart,c.assignEvents(this),this.reset()}reset(c){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(c)}_move(...c){const p=this._moveFunction(...c);if(p.bearingDelta||p.pitchDelta||p.rollDelta||p.around||p.panDelta)return this._active=!0,p}dragStart(c,p){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(c)&&(this._moveStateManager.startMove(c),this._lastPoint=Array.isArray(p)?p[0]:p,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(c,p){if(!this.isEnabled())return;const b=this._lastPoint;if(!b)return;if(c.preventDefault(),!this._moveStateManager.isValidMoveEvent(c))return void this.reset(c);const v=Array.isArray(p)?p[0]:p;return!this._moved&&v.dist(b)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=v,this._move(b,v))}dragEnd(c){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(c)&&(this._moved&&D.suppressClick(),this.reset(c))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Zd=0,Qd=2,ub={[Zd]:1,[Qd]:2};class ef{constructor(c){this._correctEvent=c.checkCorrectEvent}startMove(c){const p=D.mouseButton(c);this._eventButton=p}endMove(c){delete this._eventButton}isValidStartEvent(c){return this._correctEvent(c)}isValidMoveEvent(c){return!function(p,b){const v=ub[b];return p.buttons===void 0||(p.buttons&v)!==v}(c,this._eventButton)}isValidEndEvent(c){return D.mouseButton(c)===this._eventButton}}class hb{constructor(){this._firstTouch=void 0}_isOneFingerTouch(c){return c.targetTouches.length===1}_isSameTouchEvent(c){return c.targetTouches[0].identifier===this._firstTouch}startMove(c){this._firstTouch=c.targetTouches[0].identifier}endMove(c){delete this._firstTouch}isValidStartEvent(c){return this._isOneFingerTouch(c)}isValidMoveEvent(c){return this._isOneFingerTouch(c)&&this._isSameTouchEvent(c)}isValidEndEvent(c){return this._isOneFingerTouch(c)&&this._isSameTouchEvent(c)}}class XA{constructor(c=new ef({checkCorrectEvent:()=>!0}),p=new hb){this.mouseMoveStateManager=c,this.oneFingerTouchMoveStateManager=p}_executeRelevantHandler(c,p,b){return c instanceof MouseEvent?p(c):typeof TouchEvent<"u"&&c instanceof TouchEvent?b(c):void 0}startMove(c){this._executeRelevantHandler(c,p=>this.mouseMoveStateManager.startMove(p),p=>this.oneFingerTouchMoveStateManager.startMove(p))}endMove(c){this._executeRelevantHandler(c,p=>this.mouseMoveStateManager.endMove(p),p=>this.oneFingerTouchMoveStateManager.endMove(p))}isValidStartEvent(c){return this._executeRelevantHandler(c,p=>this.mouseMoveStateManager.isValidStartEvent(p),p=>this.oneFingerTouchMoveStateManager.isValidStartEvent(p))}isValidMoveEvent(c){return this._executeRelevantHandler(c,p=>this.mouseMoveStateManager.isValidMoveEvent(p),p=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(p))}isValidEndEvent(c){return this._executeRelevantHandler(c,p=>this.mouseMoveStateManager.isValidEndEvent(p),p=>this.oneFingerTouchMoveStateManager.isValidEndEvent(p))}}const Eh=T=>{T.mousedown=T.dragStart,T.mousemoveWindow=T.dragMove,T.mouseup=T.dragEnd,T.contextmenu=c=>{c.preventDefault()}};class U2{constructor(c,p){this._clickTolerance=c.clickTolerance||1,this._map=p,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}_shouldBePrevented(c){return c<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(c,p,b){return this._calculateTransform(c,p,b)}touchmove(c,p,b){if(this._active){if(!this._shouldBePrevented(b.length))return c.preventDefault(),this._calculateTransform(c,p,b);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",c)}}touchend(c,p,b){this._calculateTransform(c,p,b),this._active&&this._shouldBePrevented(b.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(c,p,b){b.length>0&&(this._active=!0);const v=Aa(b,p),S=new o.P(0,0),P=new o.P(0,0);let R=0;for(const F in v){const j=v[F],J=this._touches[F];J&&(S._add(j),P._add(j.sub(J)),R++,v[F]=j)}if(this._touches=v,this._shouldBePrevented(R)||!P.mag())return;const L=P.div(R);return this._sum._add(L),this._sum.mag()<this._clickTolerance?void 0:{around:S.div(R),panDelta:L}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Qp{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(c,p,b){this._firstTwoTouches||b.length<2||(this._firstTwoTouches=[b[0].identifier,b[1].identifier],this._start([p[0],p[1]]))}touchmove(c,p,b){if(!this._firstTwoTouches)return;c.preventDefault();const[v,S]=this._firstTwoTouches,P=eg(b,p,v),R=eg(b,p,S);if(!P||!R)return;const L=this._aroundCenter?null:P.add(R).div(2);return this._move([P,R],L,c)}touchend(c,p,b){if(!this._firstTwoTouches)return;const[v,S]=this._firstTwoTouches,P=eg(b,p,v),R=eg(b,p,S);P&&R||(this._active&&D.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(c){this._enabled=!0,this._aroundCenter=!!c&&c.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function eg(T,c,p){for(let b=0;b<T.length;b++)if(T[b].identifier===p)return c[b]}function JA(T,c){return Math.log(T/c)/Math.LN2}class db extends Qp{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(c){this._startDistance=this._distance=c[0].dist(c[1])}_move(c,p){const b=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(JA(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:JA(this._distance,b),pinchAround:p}}}function qA(T,c){return 180*T.angleWith(c)/Math.PI}class fb extends Qp{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])}_move(c,p,b){const v=this._vector;if(this._vector=c[0].sub(c[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:qA(this._vector,v),pinchAround:p}}_isBelowThreshold(c){this._minDiameter=Math.min(this._minDiameter,c.mag());const p=25/(Math.PI*this._minDiameter)*360,b=qA(c,this._startVector);return Math.abs(b)<p}}function pb(T){return Math.abs(T.y)>Math.abs(T.x)}class YA extends Qp{constructor(c){super(),this._currentTouchCount=0,this._map=c}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(c,p,b){super.touchstart(c,p,b),this._currentTouchCount=b.length}_start(c){this._lastPoints=c,pb(c[0].sub(c[1]))&&(this._valid=!1)}_move(c,p,b){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const v=c[0].sub(this._lastPoints[0]),S=c[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(v,S,b.timeStamp),this._valid?(this._lastPoints=c,this._active=!0,{pitchDelta:(v.y+S.y)/2*-.5}):void 0}gestureBeginsVertically(c,p,b){if(this._valid!==void 0)return this._valid;const v=c.mag()>=2,S=p.mag()>=2;if(!v&&!S)return;if(!v||!S)return this._firstMove===void 0&&(this._firstMove=b),b-this._firstMove<100&&void 0;const P=c.y>0==p.y>0;return pb(c)&&pb(p)&&P}}const vc={panStep:100,bearingStep:15,pitchStep:10};class kn{constructor(c){this._tr=new Ch(c);const p=vc;this._panStep=p.panStep,this._bearingStep=p.bearingStep,this._pitchStep=p.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(c){if(c.altKey||c.ctrlKey||c.metaKey)return;let p=0,b=0,v=0,S=0,P=0;switch(c.keyCode){case 61:case 107:case 171:case 187:p=1;break;case 189:case 109:case 173:p=-1;break;case 37:c.shiftKey?b=-1:(c.preventDefault(),S=-1);break;case 39:c.shiftKey?b=1:(c.preventDefault(),S=1);break;case 38:c.shiftKey?v=1:(c.preventDefault(),P=-1);break;case 40:c.shiftKey?v=-1:(c.preventDefault(),P=1);break;default:return}return this._rotationDisabled&&(b=0,v=0),{cameraAnimation:R=>{const L=this._tr;R.easeTo({duration:300,easeId:"keyboardHandler",easing:z2,zoom:p?Math.round(L.zoom)+p*(c.shiftKey?2:1):L.zoom,bearing:L.bearing+b*this._bearingStep,pitch:L.pitch+v*this._pitchStep,offset:[-S*this._panStep,-P*this._panStep],center:L.center},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function z2(T){return T*(2-T)}const tf=4.000244140625,tg=1/450;class rg{constructor(c,p){this._onTimeout=b=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(b)},this._map=c,this._tr=new Ch(c),this._triggerRenderFrame=p,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=tg}setZoomRate(c){this._defaultZoomRate=c}setWheelZoomRate(c){this._wheelZoomRate=c}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!c&&c.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(c){return!!this._map.cooperativeGestures.isEnabled()&&!(c.ctrlKey||this._map.cooperativeGestures.isBypassed(c))}wheel(c){if(!this.isEnabled())return;if(this._shouldBePrevented(c))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",c);let p=c.deltaMode===WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY;const b=k(),v=b-(this._lastWheelEventTime||0);this._lastWheelEventTime=b,p!==0&&p%tf==0?this._type="wheel":p!==0&&Math.abs(p)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=p,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(v*p)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,p+=this._lastValue)),c.shiftKey&&p&&(p/=4),this._type&&(this._lastWheelEvent=c,this._delta-=p,this._active||this._start(c)),c.preventDefault()}_start(c){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const p=D.mousePos(this._map.getCanvas(),c),b=this._tr;this._aroundPoint=this._aroundCenter?b.transform.locationToScreenPoint(o.V.convert(b.center)):p,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const c=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const R=c.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=R),typeof this._targetZoom=="number"&&(this._targetZoom+=R)}if(this._delta!==0){const R=this._type==="wheel"&&Math.abs(this._delta)>tf?this._wheelZoomRate:this._defaultZoomRate;let L=2/(1+Math.exp(-Math.abs(this._delta*R)));this._delta<0&&L!==0&&(L=1/L);const F=typeof this._targetZoom!="number"?c.scale:o.aq(this._targetZoom);this._targetZoom=c.applyConstrain(c.getCameraLngLat(),o.at(F*L)).zoom,this._type==="wheel"&&(this._startZoom=c.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const p=typeof this._targetZoom!="number"?c.zoom:this._targetZoom,b=this._startZoom,v=this._easing;let S,P=!1;if(this._type==="wheel"&&b&&v){const R=k()-this._lastWheelEventTime,L=Math.min((R+5)/200,1),F=v(L);S=o.G.number(b,p,F),L<1?this._frameId||(this._frameId=!0):P=!0}else S=p,P=!0;return this._active=!0,P&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=S,{noInertia:!0,needsRenderFrame:!P,zoomDelta:S-c.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(c){let p=o.cy;if(this._prevEase){const b=this._prevEase,v=(k()-b.start)/b.duration,S=b.easing(v+.01)-b.easing(v),P=.27/Math.sqrt(S*S+1e-4)*.01,R=Math.sqrt(.0729-P*P);p=o.cw(P,R,.25,1)}return this._prevEase={start:k(),duration:c,easing:p},p}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class gb{constructor(c,p){this._clickZoom=c,this._tapZoom=p}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ZA{constructor(c){this._tr=new Ch(c),this.reset()}reset(){this._active=!1}dblclick(c,p){return c.preventDefault(),{cameraAnimation:b=>{b.easeTo({duration:300,zoom:this._tr.zoom+(c.shiftKey?-1:1),around:this._tr.unproject(p)},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class QA{constructor(){this._tap=new Zp({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(c,p,b){if(!this._swipePoint)if(this._tapTime){const v=p[0],S=c.timeStamp-this._tapTime<500,P=this._tapPoint.dist(v)<30;S&&P?b.length>0&&(this._swipePoint=v,this._swipeTouch=b[0].identifier):this.reset()}else this._tap.touchstart(c,p,b)}touchmove(c,p,b){if(this._tapTime){if(this._swipePoint){if(b[0].identifier!==this._swipeTouch)return;const v=p[0],S=v.y-this._swipePoint.y;return this._swipePoint=v,c.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(c,p,b)}touchend(c,p,b){if(this._tapTime)this._swipePoint&&b.length===0&&this.reset();else{const v=this._tap.touchend(c,p,b);v&&(this._tapTime=c.timeStamp,this._tapPoint=v)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class e1{constructor(c,p,b){this._el=c,this._mousePan=p,this._touchPan=b}enable(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class xa{constructor(c,p,b,v){this._pitchWithRotate=c.pitchWithRotate,this._rollEnabled=c.rollEnabled,this._mouseRotate=p,this._mousePitch=b,this._mouseRoll=v}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class rf{constructor(c,p,b,v){this._el=c,this._touchZoom=p,this._touchRotate=b,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class hr{constructor(c,p){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=c,this._options=p,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const c=this._map.getCanvasContainer();c.classList.add("maplibregl-cooperative-gestures"),this._container=D.create("div","maplibregl-cooperative-gesture-screen",c);let p=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(p=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const b=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),v=document.createElement("div");v.className="maplibregl-desktop-message",v.textContent=p,this._container.appendChild(v);const S=document.createElement("div");S.className="maplibregl-mobile-message",S.textContent=b,this._container.appendChild(S),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(D.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(c){return c[this._bypassKey]}notifyGestureBlocked(c,p){this._enabled&&(this._map.fire(new o.l("cooperativegestureprevented",{gestureType:c,originalEvent:p})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Ar=T=>T.zoom||T.drag||T.roll||T.pitch||T.rotate;class nf extends o.l{}function ng(T){return T.panDelta&&T.panDelta.mag()||T.zoomDelta||T.bearingDelta||T.pitchDelta||T.rollDelta}class ig{constructor(c,p){this.handleWindowEvent=v=>{this.handleEvent(v,`${v.type}Window`)},this.handleEvent=(v,S)=>{if(v.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const P=v.type==="renderFrame"?void 0:v,R={needsRenderFrame:!1},L={},F={};for(const{handlerName:X,handler:Q,allowed:ae}of this._handlers){if(!Q.isEnabled())continue;let ge;if(this._blockedByActive(F,ae,X))Q.reset();else if(Q[S||v.type]){if(o.cz(v,S||v.type)){const ye=D.mousePos(this._map.getCanvas(),v);ge=Q[S||v.type](v,ye)}else if(o.cA(v,S||v.type)){const ye=this._getMapTouches(v.touches),me=D.touchPos(this._map.getCanvas(),ye);ge=Q[S||v.type](v,me,ye)}else o.cB(S||v.type)||(ge=Q[S||v.type](v));this.mergeHandlerResult(R,L,ge,X,P),ge&&ge.needsRenderFrame&&this._triggerRenderFrame()}(ge||Q.isActive())&&(F[X]=Q)}const j={};for(const X in this._previousActiveHandlers)F[X]||(j[X]=P);this._previousActiveHandlers=F,(Object.keys(j).length||ng(R))&&(this._changes.push([R,L,j]),this._triggerRenderFrame()),(Object.keys(F).length||ng(R))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:J}=R;J&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],J(this._map))},this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new L2(c),this._bearingSnap=p.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(p);const b=this._el;this._listeners=[[b,"touchstart",{passive:!0}],[b,"touchmove",{passive:!1}],[b,"touchend",void 0],[b,"touchcancel",void 0],[b,"mousedown",void 0],[b,"mousemove",void 0],[b,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[b,"mouseover",void 0],[b,"mouseout",void 0],[b,"dblclick",void 0],[b,"click",void 0],[b,"keydown",{capture:!1}],[b,"keyup",void 0],[b,"wheel",{passive:!1}],[b,"contextmenu",void 0],[window,"blur",void 0]];for(const[v,S,P]of this._listeners)D.addEventListener(v,S,v===document?this.handleWindowEvent:this.handleEvent,P)}destroy(){for(const[c,p,b]of this._listeners)D.removeEventListener(c,p,c===document?this.handleWindowEvent:this.handleEvent,b)}_addDefaultHandlers(c){const p=this._map,b=p.getCanvasContainer();this._add("mapEvent",new N2(p,c));const v=p.boxZoom=new Th(p,c);this._add("boxZoom",v),c.interactive&&c.boxZoom&&v.enable();const S=p.cooperativeGestures=new hr(p,c.cooperativeGestures);this._add("cooperativeGestures",S),c.cooperativeGestures&&S.enable();const P=new cb(p),R=new ZA(p);p.doubleClickZoom=new gb(R,P),this._add("tapZoom",P),this._add("clickZoom",R),c.interactive&&c.doubleClickZoom&&p.doubleClickZoom.enable();const L=new QA;this._add("tapDragZoom",L);const F=p.touchPitch=new YA(p);this._add("touchPitch",F),c.interactive&&c.touchPitch&&p.touchPitch.enable(c.touchPitch);const j=()=>p.project(p.getCenter()),J=function({enable:Ae,clickTolerance:Re,aroundCenter:Le=!0,minPixelCenterThreshold:Pe=100,rotateDegreesPerPixelMoved:$e=.8},ct){const tt=new ef({checkCorrectEvent:it=>D.mouseButton(it)===0&&it.ctrlKey||D.mouseButton(it)===2&&!it.ctrlKey});return new Sh({clickTolerance:Re,move:(it,st)=>{const Ot=ct();if(Le&&Math.abs(Ot.y-it.y)>Pe)return{bearingDelta:o.cx(new o.P(it.x,st.y),st,Ot)};let Lt=(st.x-it.x)*$e;return Le&&st.y<Ot.y&&(Lt=-Lt),{bearingDelta:Lt}},moveStateManager:tt,enable:Ae,assignEvents:Eh})}(c,j),X=function({enable:Ae,clickTolerance:Re,pitchDegreesPerPixelMoved:Le=-.5}){const Pe=new ef({checkCorrectEvent:$e=>D.mouseButton($e)===0&&$e.ctrlKey||D.mouseButton($e)===2});return new Sh({clickTolerance:Re,move:($e,ct)=>({pitchDelta:(ct.y-$e.y)*Le}),moveStateManager:Pe,enable:Ae,assignEvents:Eh})}(c),Q=function({enable:Ae,clickTolerance:Re,rollDegreesPerPixelMoved:Le=.3},Pe){const $e=new ef({checkCorrectEvent:ct=>D.mouseButton(ct)===2&&ct.ctrlKey});return new Sh({clickTolerance:Re,move:(ct,tt)=>{const it=Pe();let st=(tt.x-ct.x)*Le;return tt.y<it.y&&(st=-st),{rollDelta:st}},moveStateManager:$e,enable:Ae,assignEvents:Eh})}(c,j);p.dragRotate=new xa(c,J,X,Q),this._add("mouseRotate",J,["mousePitch"]),this._add("mousePitch",X,["mouseRotate","mouseRoll"]),this._add("mouseRoll",Q,["mousePitch"]),c.interactive&&c.dragRotate&&p.dragRotate.enable();const ae=function({enable:Ae,clickTolerance:Re}){const Le=new ef({checkCorrectEvent:Pe=>D.mouseButton(Pe)===0&&!Pe.ctrlKey});return new Sh({clickTolerance:Re,move:(Pe,$e)=>({around:$e,panDelta:$e.sub(Pe)}),activateOnStart:!0,moveStateManager:Le,enable:Ae,assignEvents:Eh})}(c),ge=new U2(c,p);p.dragPan=new e1(b,ae,ge),this._add("mousePan",ae),this._add("touchPan",ge,["touchZoom","touchRotate"]),c.interactive&&c.dragPan&&p.dragPan.enable(c.dragPan);const ye=new fb,me=new db;p.touchZoomRotate=new rf(b,me,ye,L),this._add("touchRotate",ye,["touchPan","touchZoom"]),this._add("touchZoom",me,["touchPan","touchRotate"]),c.interactive&&c.touchZoomRotate&&p.touchZoomRotate.enable(c.touchZoomRotate),this._add("blockableMapEvent",new F2(p));const we=p.scrollZoom=new rg(p,()=>this._triggerRenderFrame());this._add("scrollZoom",we,["mousePan"]),c.interactive&&c.scrollZoom&&p.scrollZoom.enable(c.scrollZoom);const De=p.keyboard=new kn(p);this._add("keyboard",De),c.interactive&&c.keyboard&&p.keyboard.enable()}_add(c,p,b){this._handlers.push({handlerName:c,handler:p,allowed:b}),this._handlersById[c]=p}stop(c){if(!this._updatingCamera){for(const{handler:p}of this._handlers)p.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}}isActive(){for(const{handler:c}of this._handlers)if(c.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ar(this._eventsInProgress)||this.isZooming()}_blockedByActive(c,p,b){for(const v in c)if(v!==b&&(!p||p.indexOf(v)<0))return!0;return!1}_getMapTouches(c){const p=[];for(const b of c)this._el.contains(b.target)&&p.push(b);return p}mergeHandlerResult(c,p,b,v,S){if(!b)return;o.e(c,b);const P={handlerName:v,originalEvent:b.originalEvent||S};b.zoomDelta!==void 0&&(p.zoom=P),b.panDelta!==void 0&&(p.drag=P),b.rollDelta!==void 0&&(p.roll=P),b.pitchDelta!==void 0&&(p.pitch=P),b.bearingDelta!==void 0&&(p.rotate=P)}_applyChanges(){const c={},p={},b={};for(const[v,S,P]of this._changes)v.panDelta&&(c.panDelta=(c.panDelta||new o.P(0,0))._add(v.panDelta)),v.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+v.pitchDelta),v.rollDelta&&(c.rollDelta=(c.rollDelta||0)+v.rollDelta),v.around!==void 0&&(c.around=v.around),v.pinchAround!==void 0&&(c.pinchAround=v.pinchAround),v.noInertia&&(c.noInertia=v.noInertia),o.e(p,S),o.e(b,P);this._updateMapTransform(c,p,b),this._changes=[]}_updateMapTransform(c,p,b){const v=this._map,S=v._getTransformForUpdate(),P=v.terrain;if(!(ng(c)||P&&this._terrainMovement))return this._fireEvents(p,b,!0);v._stop(!0);let{panDelta:R,zoomDelta:L,bearingDelta:F,pitchDelta:j,rollDelta:J,around:X,pinchAround:Q}=c;Q!==void 0&&(X=Q),X=X||v.transform.centerPoint,P&&!S.isPointOnMapSurface(X)&&(X=S.centerPoint);const ae={panDelta:R,zoomDelta:L,rollDelta:J,pitchDelta:j,bearingDelta:F,around:X};this._map.cameraHelper.useGlobeControls&&!S.isPointOnMapSurface(X)&&(X=S.centerPoint);const ge=X.distSqr(S.centerPoint)<.01?S.center:S.screenPointToLocation(R?X.sub(R):X);this._handleMapControls({terrain:P,tr:S,deltasForHelper:ae,preZoomAroundLoc:ge,combinedEventsInProgress:p,panDelta:R}),v._applyUpdatedTransform(S),this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(p,b,!0)}_handleMapControls({terrain:c,tr:p,deltasForHelper:b,preZoomAroundLoc:v,combinedEventsInProgress:S,panDelta:P}){const R=this._map.cameraHelper;if(R.handleMapControlsRollPitchBearingZoom(b,p),c)return R.useGlobeControls?(this._terrainMovement||!S.drag&&!S.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void R.handleMapControlsPan(b,p,v)):this._terrainMovement||!S.drag&&!S.zoom?void(S.drag&&this._terrainMovement&&P?p.setCenter(p.screenPointToLocation(p.centerPoint.sub(P))):R.handleMapControlsPan(b,p,v)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void R.handleMapControlsPan(b,p,v));R.handleMapControlsPan(b,p,v)}_fireEvents(c,p,b){const v=Ar(this._eventsInProgress),S=Ar(c),P={};for(const J in c){const{originalEvent:X}=c[J];this._eventsInProgress[J]||(P[`${J}start`]=X),this._eventsInProgress[J]=c[J]}!v&&S&&this._fireEvent("movestart",S.originalEvent);for(const J in P)this._fireEvent(J,P[J]);S&&this._fireEvent("move",S.originalEvent);for(const J in c){const{originalEvent:X}=c[J];this._fireEvent(J,X)}const R={};let L;for(const J in this._eventsInProgress){const{handlerName:X,originalEvent:Q}=this._eventsInProgress[J];this._handlersById[X].isActive()||(delete this._eventsInProgress[J],L=p[X]||Q,R[`${J}end`]=L)}for(const J in R)this._fireEvent(J,R[J]);const F=Ar(this._eventsInProgress),j=(v||S)&&!F;if(j&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const J=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&J.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(J)}if(b&&j){this._updatingCamera=!0;const J=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),X=Q=>Q!==0&&-this._bearingSnap<Q&&Q<this._bearingSnap;!J||!J.essential&&C.prefersReducedMotion?(this._map.fire(new o.l("moveend",{originalEvent:L})),X(this._map.getBearing())&&this._map.resetNorth()):(X(J.bearing||this._map.getBearing())&&(J.bearing=0),J.freezeElevation=!0,this._map.easeTo(J,{originalEvent:L})),this._updatingCamera=!1}}_fireEvent(c,p){this._map.fire(new o.l(c,p?{originalEvent:p}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(c=>{delete this._frameId,this.handleEvent(new nf("renderFrame",{timeStamp:c})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class qs extends o.E{constructor(c,p,b){super(),this._renderFrameCallback=()=>{const v=Math.min((k()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(v)),v<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=b.bearingSnap,this.cameraHelper=p,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(c,p){c.apply(this.transform),this.transform=c,this.cameraHelper=p}getCenter(){return new o.V(this.transform.center.lng,this.transform.center.lat)}setCenter(c,p){return this.jumpTo({center:c},p)}getCenterElevation(){return this.transform.elevation}setCenterElevation(c,p){return this.jumpTo({elevation:c},p),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(c){this._centerClampedToGround=c}panBy(c,p,b){return c=o.P.convert(c).mult(-1),this.panTo(this.transform.center,o.e({offset:c},p),b)}panTo(c,p,b){return this.easeTo(o.e({center:c},p),b)}getZoom(){return this.transform.zoom}setZoom(c,p){return this.jumpTo({zoom:c},p),this}zoomTo(c,p,b){return this.easeTo(o.e({zoom:c},p),b)}zoomIn(c,p){return this.zoomTo(this.getZoom()+1,c,p),this}zoomOut(c,p){return this.zoomTo(this.getZoom()-1,c,p),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(c,p){return c!=this.transform.fov&&(this.transform.setFov(c),this.fire(new o.l("movestart",p)).fire(new o.l("move",p)).fire(new o.l("moveend",p))),this}getBearing(){return this.transform.bearing}setBearing(c,p){return this.jumpTo({bearing:c},p),this}getPadding(){return this.transform.padding}setPadding(c,p){return this.jumpTo({padding:c},p),this}rotateTo(c,p,b){return this.easeTo(o.e({bearing:c},p),b)}resetNorth(c,p){return this.rotateTo(0,o.e({duration:1e3},c),p),this}resetNorthPitch(c,p){return this.easeTo(o.e({bearing:0,pitch:0,roll:0,duration:1e3},c),p),this}snapToNorth(c,p){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,p):this}getPitch(){return this.transform.pitch}setPitch(c,p){return this.jumpTo({pitch:c},p),this}getRoll(){return this.transform.roll}setRoll(c,p){return this.jumpTo({roll:c},p),this}cameraForBounds(c,p){c=Qe.convert(c).adjustAntiMeridian();const b=p&&p.bearing||0;return this._cameraForBoxAndBearing(c.getNorthWest(),c.getSouthEast(),b,p)}_cameraForBoxAndBearing(c,p,b,v){const S={top:0,bottom:0,right:0,left:0};if(typeof(v=o.e({padding:S,offset:[0,0],maxZoom:this.transform.maxZoom},v)).padding=="number"){const F=v.padding;v.padding={top:F,bottom:F,right:F,left:F}}const P=o.e(S,v.padding);v.padding=P;const R=this.transform,L=new Qe(c,p);return this.cameraHelper.cameraForBoxAndBearing(v,P,L,b,R)}fitBounds(c,p,b){return this._fitInternal(this.cameraForBounds(c,p),p,b)}fitScreenCoordinates(c,p,b,v,S){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(o.P.convert(c)),this.transform.screenPointToLocation(o.P.convert(p)),b,v),v,S)}_fitInternal(c,p,b){return c?(delete(p=o.e(c,p)).padding,p.linear?this.easeTo(p,b):this.flyTo(p,b)):this}jumpTo(c,p){this.stop();const b=this._getTransformForUpdate();let v=!1,S=!1,P=!1;const R=b.zoom;this.cameraHelper.handleJumpToCenterZoom(b,c);const L=b.zoom!==R;return"elevation"in c&&b.elevation!==+c.elevation&&b.setElevation(+c.elevation),"bearing"in c&&b.bearing!==+c.bearing&&(v=!0,b.setBearing(+c.bearing)),"pitch"in c&&b.pitch!==+c.pitch&&(S=!0,b.setPitch(+c.pitch)),"roll"in c&&b.roll!==+c.roll&&(P=!0,b.setRoll(+c.roll)),c.padding==null||b.isPaddingEqual(c.padding)||b.setPadding(c.padding),this._applyUpdatedTransform(b),this.fire(new o.l("movestart",p)).fire(new o.l("move",p)),L&&this.fire(new o.l("zoomstart",p)).fire(new o.l("zoom",p)).fire(new o.l("zoomend",p)),v&&this.fire(new o.l("rotatestart",p)).fire(new o.l("rotate",p)).fire(new o.l("rotateend",p)),S&&this.fire(new o.l("pitchstart",p)).fire(new o.l("pitch",p)).fire(new o.l("pitchend",p)),P&&this.fire(new o.l("rollstart",p)).fire(new o.l("roll",p)).fire(new o.l("rollend",p)),this.fire(new o.l("moveend",p))}calculateCameraOptionsFromTo(c,p,b,v=0){const S=o.a9.fromLngLat(c,p),P=o.a9.fromLngLat(b,v),R=P.x-S.x,L=P.y-S.y,F=P.z-S.z,j=Math.hypot(R,L,F);if(j===0)throw new Error("Can't calculate camera options with same From and To");const J=Math.hypot(R,L),X=o.at(this.transform.cameraToCenterDistance/j/this.transform.tileSize),Q=180*Math.atan2(R,-L)/Math.PI;let ae=180*Math.acos(J/j)/Math.PI;return ae=F<0?90-ae:90+ae,{center:P.toLngLat(),elevation:v,zoom:X,pitch:ae,bearing:Q}}calculateCameraOptionsFromCameraLngLatAltRotation(c,p,b,v,S){const P=this.transform.calculateCenterFromCameraLngLatAlt(c,p,b,v);return{center:P.center,elevation:P.elevation,zoom:P.zoom,bearing:b,pitch:v,roll:S}}easeTo(c,p){this._stop(!1,c.easeId),((c=o.e({offset:[0,0],duration:500,easing:o.cy},c)).animate===!1||!c.essential&&C.prefersReducedMotion)&&(c.duration=0);const b=this._getTransformForUpdate(),v=this.getBearing(),S=b.pitch,P=b.roll,R="bearing"in c?this._normalizeBearing(c.bearing,v):v,L="pitch"in c?+c.pitch:S,F="roll"in c?this._normalizeBearing(c.roll,P):P,j="padding"in c?c.padding:b.padding,J=o.P.convert(c.offset);let X,Q;c.around&&(X=o.V.convert(c.around),Q=b.locationToScreenPoint(X));const ae={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ge=this.cameraHelper.handleEaseTo(b,{bearing:R,pitch:L,roll:F,padding:j,around:X,aroundPoint:Q,offsetAsPoint:J,offset:c.offset,zoom:c.zoom,center:c.center});return this._rotating=this._rotating||v!==R,this._pitching=this._pitching||L!==S,this._rolling=this._rolling||F!==P,this._padding=!b.isPaddingEqual(j),this._zooming=this._zooming||ge.isZooming,this._easeId=c.easeId,this._prepareEase(p,c.noMoveStart,ae),this.terrain&&this._prepareElevation(ge.elevationCenter),this._ease(ye=>{ge.easeFunc(ye),this.terrain&&!c.freezeElevation&&this._updateElevation(ye),this._applyUpdatedTransform(b),this._fireMoveEvents(p)},ye=>{this.terrain&&c.freezeElevation&&this._finalizeElevation(),this._afterEase(p,ye)},c),this}_prepareEase(c,p,b={}){this._moving=!0,p||b.moving||this.fire(new o.l("movestart",c)),this._zooming&&!b.zooming&&this.fire(new o.l("zoomstart",c)),this._rotating&&!b.rotating&&this.fire(new o.l("rotatestart",c)),this._pitching&&!b.pitching&&this.fire(new o.l("pitchstart",c)),this._rolling&&!b.rolling&&this.fire(new o.l("rollstart",c))}_prepareElevation(c){this._elevationCenter=c,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(c,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(c){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const p=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(c<1&&p!==this._elevationTarget){const b=this._elevationTarget-this._elevationStart;this._elevationStart+=c*(b-(p-(b*c+this._elevationStart))/(1-c)),this._elevationTarget=p}this.transform.setElevation(o.G.number(this._elevationStart,this._elevationTarget,c))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(c){if(!this.terrain&&c.elevation>=0&&c.pitch<=90)return{};const p=c.getCameraLngLat(),b=c.getCameraAltitude(),v=this.terrain?this.terrain.getElevationForLngLatZoom(p,c.zoom):0;if(b<v){const S=this.calculateCameraOptionsFromTo(p,v,c.center,c.elevation);return{pitch:S.pitch,zoom:S.zoom}}return{}}_applyUpdatedTransform(c){const p=[];if(p.push(v=>this._elevateCameraIfInsideTerrain(v)),this.transformCameraUpdate&&p.push(v=>this.transformCameraUpdate(v)),!p.length)return;const b=c.clone();for(const v of p){const S=b.clone(),{center:P,zoom:R,roll:L,pitch:F,bearing:j,elevation:J}=v(S);P&&S.setCenter(P),J!==void 0&&S.setElevation(J),R!==void 0&&S.setZoom(R),L!==void 0&&S.setRoll(L),F!==void 0&&S.setPitch(F),j!==void 0&&S.setBearing(j),b.apply(S)}this.transform.apply(b)}_fireMoveEvents(c){this.fire(new o.l("move",c)),this._zooming&&this.fire(new o.l("zoom",c)),this._rotating&&this.fire(new o.l("rotate",c)),this._pitching&&this.fire(new o.l("pitch",c)),this._rolling&&this.fire(new o.l("roll",c))}_afterEase(c,p){if(this._easeId&&p&&this._easeId===p)return;delete this._easeId;const b=this._zooming,v=this._rotating,S=this._pitching,P=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,b&&this.fire(new o.l("zoomend",c)),v&&this.fire(new o.l("rotateend",c)),S&&this.fire(new o.l("pitchend",c)),P&&this.fire(new o.l("rollend",c)),this.fire(new o.l("moveend",c))}flyTo(c,p){if(!c.essential&&C.prefersReducedMotion){const st=o.U(c,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo(st,p)}this.stop(),c=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.cy},c);const b=this._getTransformForUpdate(),v=b.bearing,S=b.pitch,P=b.roll,R=b.padding,L="bearing"in c?this._normalizeBearing(c.bearing,v):v,F="pitch"in c?+c.pitch:S,j="roll"in c?this._normalizeBearing(c.roll,P):P,J="padding"in c?c.padding:b.padding,X=o.P.convert(c.offset);let Q=b.centerPoint.add(X);const ae=b.screenPointToLocation(Q),ge=this.cameraHelper.handleFlyTo(b,{bearing:L,pitch:F,roll:j,padding:J,locationAtOffset:ae,offsetAsPoint:X,center:c.center,minZoom:c.minZoom,zoom:c.zoom});let ye=c.curve;const me=Math.max(b.width,b.height),we=me/ge.scaleOfZoom,De=ge.pixelPathLength;typeof ge.scaleOfMinZoom=="number"&&(ye=Math.sqrt(me/ge.scaleOfMinZoom/De*2));const Ae=ye*ye;function Re(st){const Ot=(we*we-me*me+(st?-1:1)*Ae*Ae*De*De)/(2*(st?we:me)*Ae*De);return Math.log(Math.sqrt(Ot*Ot+1)-Ot)}function Le(st){return(Math.exp(st)-Math.exp(-st))/2}function Pe(st){return(Math.exp(st)+Math.exp(-st))/2}const $e=Re(!1);let ct=function(st){return Pe($e)/Pe($e+ye*st)},tt=function(st){return me*((Pe($e)*(Le(Ot=$e+ye*st)/Pe(Ot))-Le($e))/Ae)/De;var Ot},it=(Re(!0)-$e)/ye;if(Math.abs(De)<2e-6||!isFinite(it)){if(Math.abs(me-we)<1e-6)return this.easeTo(c,p);const st=we<me?-1:1;it=Math.abs(Math.log(we/me))/ye,tt=()=>0,ct=Ot=>Math.exp(st*ye*Ot)}return c.duration="duration"in c?+c.duration:1e3*it/("screenSpeed"in c?+c.screenSpeed/ye:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0),this._zooming=!0,this._rotating=v!==L,this._pitching=F!==S,this._rolling=j!==P,this._padding=!b.isPaddingEqual(J),this._prepareEase(p,!1),this.terrain&&this._prepareElevation(ge.targetCenter),this._ease(st=>{const Ot=st*it,Lt=1/ct(Ot),St=tt(Ot);this._rotating&&b.setBearing(o.G.number(v,L,st)),this._pitching&&b.setPitch(o.G.number(S,F,st)),this._rolling&&b.setRoll(o.G.number(P,j,st)),this._padding&&(b.interpolatePadding(R,J,st),Q=b.centerPoint.add(X)),ge.easeFunc(st,Lt,St,Q),this.terrain&&!c.freezeElevation&&this._updateElevation(st),this._applyUpdatedTransform(b),this._fireMoveEvents(p)},()=>{this.terrain&&c.freezeElevation&&this._finalizeElevation(),this._afterEase(p)},c),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(c,p){var b;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const v=this._onEaseEnd;delete this._onEaseEnd,v.call(this,p)}return c||(b=this.handlers)===null||b===void 0||b.stop(!1),this}_ease(c,p,b){b.animate===!1||b.duration===0?(c(1),p()):(this._easeStart=k(),this._easeOptions=b,this._onEaseFrame=c,this._onEaseEnd=p,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(c,p){c=o.W(c,-180,180);const b=Math.abs(c-p);return Math.abs(c-360-p)<b&&(c-=360),Math.abs(c+360-p)<b&&(c+=360),c}queryTerrainElevation(c){return this.terrain?this.terrain.getElevationForLngLat(o.V.convert(c),this.transform):null}}const Jo={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class mb{constructor(c=Jo){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=p=>{!p||p.sourceDataType!=="metadata"&&p.sourceDataType!=="visibility"&&p.dataType!=="style"&&p.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=c}getDefaultPosition(){return"bottom-right"}onAdd(c){return this._map=c,this._compact=this.options.compact,this._container=D.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=D.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=D.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){D.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(c,p){const b=this._map._getUIString(`AttributionControl.${p}`);c.title=b,c.setAttribute("aria-label",b)}_updateAttributions(){if(!this._map.style)return;let c=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=c.concat(this.options.customAttribution.map(v=>typeof v!="string"?"":v)):typeof this.options.customAttribution=="string"&&c.push(this.options.customAttribution)),this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const p=this._map.style.tileManagers;for(const v in p){const S=p[v];if(S.used||S.usedForTerrain){const P=S.getSource();P.attribution&&c.indexOf(P.attribution)<0&&c.push(P.attribution)}}c=c.filter(v=>String(v).trim()),c.sort((v,S)=>v.length-S.length),c=c.filter((v,S)=>{for(let P=S+1;P<c.length;P++)if(c[P].indexOf(v)>=0)return!1;return!0});const b=c.join(" | ");b!==this._attribHTML&&(this._attribHTML=b,c.length?(this._innerContainer.innerHTML=D.sanitize(b),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class t1{constructor(c={}){this._updateCompact=()=>{const p=this._container.children;if(p.length){const b=p[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&b.classList.add("maplibregl-compact"):b.classList.remove("maplibregl-compact")}},this.options=c}getDefaultPosition(){return"bottom-left"}onAdd(c){this._map=c,this._compact=this.options&&this.options.compact,this._container=D.create("div","maplibregl-ctrl");const p=D.create("a","maplibregl-ctrl-logo");return p.target="_blank",p.rel="noopener nofollow",p.href="https://maplibre.org/",p.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),p.setAttribute("rel","noopener nofollow"),this._container.appendChild(p),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){D.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class V2{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(c){const p=++this._id;return this._queue.push({callback:c,id:p,cancelled:!1}),p}remove(c){const p=this._currentlyRunning,b=p?this._queue.concat(p):this._queue;for(const v of b)if(v.id===c)return void(v.cancelled=!0)}run(c=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const p=this._currentlyRunning=this._queue;this._queue=[];for(const b of p)if(!b.cancelled&&(b.callback(c),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var $2=o.aU([{name:"a_pos3d",type:"Int16",components:3}]);class sf extends o.E{constructor(c){super(),this._lastTilesetChange=k(),this.tileManager=c,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=c._source.tileSize*2**this.deltaZoom,c.usedForTerrain=!0,c.tileSize=this.tileSize}destruct(){this.tileManager.usedForTerrain=!1,this.tileManager.tileSize=null}getSource(){return this.tileManager._source}update(c,p){this.tileManager.update(c,p),this._renderableTilesKeys=[];const b={};for(const v of nn(c,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:p,calculateTileZoom:this.tileManager._source.calculateTileZoom}))b[v.key]=!0,this._renderableTilesKeys.push(v.key),this._tiles[v.key]||(v.terrainRttPosMatrix32f=new Float64Array(16),o.c7(v.terrainRttPosMatrix32f,0,o.a5,o.a5,0,0,1),this._tiles[v.key]=new vt(v,this.tileSize),this._lastTilesetChange=k());for(const v in this._tiles)b[v]||delete this._tiles[v]}freeRtt(c){for(const p in this._tiles){const b=this._tiles[p];(!c||b.tileID.equals(c)||b.tileID.isChildOf(c)||c.isChildOf(b.tileID))&&(b.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(c=>this.getTileByID(c))}getTileByID(c){return this._tiles[c]}getTerrainCoords(c,p){return p?this._getTerrainCoordsForTileRanges(c,p):this._getTerrainCoordsForRegularTile(c)}_getTerrainCoordsForRegularTile(c){const p={};for(const b of this._renderableTilesKeys){const v=this._tiles[b].tileID,S=c.clone(),P=o.bk();if(v.canonical.equals(c.canonical))o.c7(P,0,o.a5,o.a5,0,0,1);else if(v.canonical.isChildOf(c.canonical)){const R=v.canonical.z-c.canonical.z,L=v.canonical.x-(v.canonical.x>>R<<R),F=v.canonical.y-(v.canonical.y>>R<<R),j=o.a5>>R;o.c7(P,0,j,j,0,0,1),o.O(P,P,[-L*j,-F*j,0])}else{if(!c.canonical.isChildOf(v.canonical))continue;{const R=c.canonical.z-v.canonical.z,L=c.canonical.x-(c.canonical.x>>R<<R),F=c.canonical.y-(c.canonical.y>>R<<R),j=o.a5>>R;o.c7(P,0,o.a5,o.a5,0,0,1),o.O(P,P,[L*j,F*j,0]),o.Q(P,P,[1/2**R,1/2**R,0])}}S.terrainRttPosMatrix32f=new Float32Array(P),p[b]=S}return p}_getTerrainCoordsForTileRanges(c,p){const b={};for(const v of this._renderableTilesKeys){const S=this._tiles[v].tileID;if(!this._isWithinTileRanges(S,p))continue;const P=c.clone(),R=o.bk();if(S.canonical.z===c.canonical.z){const L=c.canonical.x-S.canonical.x,F=c.canonical.y-S.canonical.y;o.c7(R,0,o.a5,o.a5,0,0,1),o.O(R,R,[L*o.a5,F*o.a5,0])}else if(S.canonical.z>c.canonical.z){const L=S.canonical.z-c.canonical.z,F=S.canonical.x-(S.canonical.x>>L<<L),j=S.canonical.y-(S.canonical.y>>L<<L),J=c.canonical.x-(S.canonical.x>>L),X=c.canonical.y-(S.canonical.y>>L),Q=o.a5>>L;o.c7(R,0,Q,Q,0,0,1),o.O(R,R,[-F*Q+J*o.a5,-j*Q+X*o.a5,0])}else{const L=c.canonical.z-S.canonical.z,F=c.canonical.x-(c.canonical.x>>L<<L),j=c.canonical.y-(c.canonical.y>>L<<L),J=(c.canonical.x>>L)-S.canonical.x,X=(c.canonical.y>>L)-S.canonical.y,Q=o.a5<<L;o.c7(R,0,Q,Q,0,0,1),o.O(R,R,[F*o.a5+J*Q,j*o.a5+X*Q,0])}P.terrainRttPosMatrix32f=new Float32Array(R),b[v]=P}return b}getSourceTile(c,p){const b=this.tileManager._source;let v=c.overscaledZ-this.deltaZoom;if(v>b.maxzoom&&(v=b.maxzoom),v<b.minzoom)return;this._sourceTileCache[c.key]||(this._sourceTileCache[c.key]=c.scaledTo(v).key);let S=this.findTileInCaches(this._sourceTileCache[c.key]);if(!S?.dem&&p)for(;v>=b.minzoom&&!S?.dem;)S=this.findTileInCaches(c.scaledTo(v--).key);return S}findTileInCaches(c){let p=this.tileManager.getTileByID(c);return p||(p=this.tileManager._outOfViewCache.getByKey(c),p)}anyTilesAfterTime(c=Date.now()){return this._lastTilesetChange>=c}_isWithinTileRanges(c,p){return p[c.canonical.z]&&c.canonical.x>=p[c.canonical.z].minTileX&&c.canonical.x<=p[c.canonical.z].maxTileX&&c.canonical.y>=p[c.canonical.z].minTileY&&c.canonical.y<=p[c.canonical.z].maxTileY}}class di{constructor(c,p,b){this._meshCache={},this.painter=c,this.tileManager=new sf(p),this.options=b,this.exaggeration=typeof b.exaggeration=="number"?b.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(c,p,b,v=o.a5){var S;if(!(p>=0&&p<v&&b>=0&&b<v))return 0;const P=this.getTerrainData(c),R=(S=P.tile)===null||S===void 0?void 0:S.dem;if(!R)return 0;const L=o.cC([],[p/v*o.a5,b/v*o.a5],P.u_terrain_matrix),F=[L[0]*R.dim,L[1]*R.dim],j=Math.floor(F[0]),J=Math.floor(F[1]),X=F[0]-j,Q=F[1]-J;return R.get(j,J)*(1-X)*(1-Q)+R.get(j+1,J)*X*(1-Q)+R.get(j,J+1)*(1-X)*Q+R.get(j+1,J+1)*X*Q}getElevationForLngLatZoom(c,p){if(!o.cD(p,c.wrap()))return 0;const{tileID:b,mercatorX:v,mercatorY:S}=this._getOverscaledTileIDFromLngLatZoom(c,p);return this.getElevation(b,v%o.a5,S%o.a5,o.a5)}getElevationForLngLat(c,p){const b=nn(p,{maxzoom:this.tileManager.maxzoom,minzoom:this.tileManager.minzoom,tileSize:512,terrain:this});let v=0;for(const S of b)S.canonical.z>v&&(v=Math.min(S.canonical.z,this.tileManager.maxzoom));return this.getElevationForLngLatZoom(c,v)}getElevation(c,p,b,v=o.a5){return this.getDEMElevation(c,p,b,v)*this.exaggeration}getTerrainData(c){if(!this._emptyDemTexture){const v=this.painter.context,S=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new o.T(v,S,v.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new o.T(v,new o.R({width:1,height:1}),v.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.ar([])}const p=this.tileManager.getSourceTile(c,!0);if(p&&p.dem&&(!p.demTexture||p.needsTerrainPrepare)){const v=this.painter.context;p.demTexture=this.painter.getTileTexture(p.dem.stride),p.demTexture?p.demTexture.update(p.dem.getPixels(),{premultiply:!1}):p.demTexture=new o.T(v,p.dem.getPixels(),v.gl.RGBA,{premultiply:!1}),p.demTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),p.needsTerrainPrepare=!1}const b=p&&p.toString()+p.tileID.key+c.key;if(b&&!this._demMatrixCache[b]){const v=this.tileManager.getSource().maxzoom;let S=c.canonical.z-p.tileID.canonical.z;c.overscaledZ>c.canonical.z&&(c.canonical.z>=v?S=c.canonical.z-v:o.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const P=c.canonical.x-(c.canonical.x>>S<<S),R=c.canonical.y-(c.canonical.y>>S<<S),L=o.cE(new Float64Array(16),[1/(o.a5<<S),1/(o.a5<<S),0]);o.O(L,L,[P*o.a5,R*o.a5,0]),this._demMatrixCache[c.key]={matrix:L,coord:c}}return{u_depth:2,u_terrain:3,u_terrain_dim:p&&p.dem&&p.dem.dim||1,u_terrain_matrix:b?this._demMatrixCache[c.key].matrix:this._emptyDemMatrix,u_terrain_unpack:p&&p.dem&&p.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(p&&p.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:p}}getFramebuffer(c){const p=this.painter,b=p.width/devicePixelRatio,v=p.height/devicePixelRatio;return!this._fbo||this._fbo.width===b&&this._fbo.height===v||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new o.T(p.context,{width:b,height:v,data:null},p.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(p.context.gl.NEAREST,p.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new o.T(p.context,{width:b,height:v,data:null},p.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(p.context.gl.NEAREST,p.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=p.context.createFramebuffer(b,v,!0,!1),this._fbo.depthAttachment.set(p.context.createRenderbuffer(p.context.gl.DEPTH_COMPONENT16,b,v))),this._fbo.colorAttachment.set(c==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const c=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const p=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let S=0,P=0;S<this._coordsTextureSize;S++)for(let R=0;R<this._coordsTextureSize;R++,P+=4)p[P+0]=255&R,p[P+1]=255&S,p[P+2]=R>>8<<4|S>>8,p[P+3]=0;const b=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(p.buffer)),v=new o.T(c,b,c.gl.RGBA,{premultiply:!1});return v.bind(c.gl.NEAREST,c.gl.CLAMP_TO_EDGE),this._coordsTexture=v,v}pointCoordinate(c){this.painter.maybeDrawDepthAndCoords(!0);const p=new Uint8Array(4),b=this.painter.context,v=b.gl,S=Math.round(c.x*this.painter.pixelRatio/devicePixelRatio),P=Math.round(c.y*this.painter.pixelRatio/devicePixelRatio),R=Math.round(this.painter.height/devicePixelRatio);b.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),v.readPixels(S,R-P-1,1,1,v.RGBA,v.UNSIGNED_BYTE,p),b.bindFramebuffer.set(null);const L=p[0]+(p[2]>>4<<8),F=p[1]+((15&p[2])<<8),j=this.coordsIndex[255-p[3]],J=j&&this.tileManager.getTileByID(j);if(!J)return null;const X=this._coordsTextureSize,Q=(1<<J.tileID.canonical.z)*X;return new o.a9((J.tileID.canonical.x*X+L)/Q+J.tileID.wrap,(J.tileID.canonical.y*X+F)/Q,this.getElevation(J.tileID,L,F,X))}depthAtPoint(c){const p=new Uint8Array(4),b=this.painter.context,v=b.gl;return b.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),v.readPixels(c.x,this.painter.height/devicePixelRatio-c.y-1,1,1,v.RGBA,v.UNSIGNED_BYTE,p),b.bindFramebuffer.set(null),(p[0]/16777216+p[1]/65536+p[2]/256+p[3])/256}getTerrainMesh(c){var p;const b=((p=this.painter.style.projection)===null||p===void 0?void 0:p.transitionState)>0,v=b&&c.canonical.y===0,S=b&&c.canonical.y===(1<<c.canonical.z)-1,P=`m_${v?"n":""}_${S?"s":""}`;if(this._meshCache[P])return this._meshCache[P];const R=this.painter.context,L=new o.cF,F=new o.aY,j=this.meshSize,J=o.a5/j,X=j*j;for(let Pe=0;Pe<=j;Pe++)for(let $e=0;$e<=j;$e++)L.emplaceBack($e*J,Pe*J,0);for(let Pe=0;Pe<X;Pe+=j+1)for(let $e=0;$e<j;$e++)F.emplaceBack($e+Pe,j+$e+Pe+1,j+$e+Pe+2),F.emplaceBack($e+Pe,j+$e+Pe+2,$e+Pe+1);const Q=L.length,ae=Q+(j+1),ge=(j+1)*j,ye=v?o.br:0,me=v?0:1,we=S?o.bs:o.a5,De=S?0:1;for(let Pe=0;Pe<=j;Pe++)L.emplaceBack(Pe*J,ye,me);for(let Pe=0;Pe<=j;Pe++)L.emplaceBack(Pe*J,we,De);for(let Pe=0;Pe<j;Pe++)F.emplaceBack(ge+Pe,ae+Pe,ae+Pe+1),F.emplaceBack(ge+Pe,ae+Pe+1,ge+Pe+1),F.emplaceBack(0+Pe,Q+Pe+1,Q+Pe),F.emplaceBack(0+Pe,0+Pe+1,Q+Pe+1);const Ae=L.length,Re=Ae+2*(j+1);for(const Pe of[0,1])for(let $e=0;$e<=j;$e++)for(const ct of[0,1])L.emplaceBack(Pe*o.a5,$e*J,ct);for(let Pe=0;Pe<2*j;Pe+=2)F.emplaceBack(Ae+Pe,Ae+Pe+1,Ae+Pe+3),F.emplaceBack(Ae+Pe,Ae+Pe+3,Ae+Pe+2),F.emplaceBack(Re+Pe,Re+Pe+3,Re+Pe+1),F.emplaceBack(Re+Pe,Re+Pe+2,Re+Pe+3);const Le=new dn(R.createVertexBuffer(L,$2.members),R.createIndexBuffer(F),o.aX.simpleSegment(0,0,L.length,F.length));return this._meshCache[P]=Le,Le}getMeshFrameDelta(c){return 2*Math.PI*o.bE/Math.pow(2,Math.max(c,0))/5}getMinTileElevationForLngLatZoom(c,p){var b;if(!o.cD(p,c.wrap()))return 0;const{tileID:v}=this._getOverscaledTileIDFromLngLatZoom(c,p);return(b=this.getMinMaxElevation(v).minElevation)!==null&&b!==void 0?b:0}getMinMaxElevation(c){const p=this.getTerrainData(c).tile,b={minElevation:null,maxElevation:null};return p&&p.dem&&(b.minElevation=p.dem.min*this.exaggeration,b.maxElevation=p.dem.max*this.exaggeration),b}_getOverscaledTileIDFromLngLatZoom(c,p){const b=o.a9.fromLngLat(c.wrap()),v=(1<<p)*o.a5,S=b.x*v,P=b.y*v,R=Math.floor(S/o.a5),L=Math.floor(P/o.a5);return{tileID:new o.a2(p,0,p,R,L),mercatorX:S,mercatorY:P}}}class Ti{constructor(c,p,b){this._context=c,this._size=p,this._tileSize=b,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const c of this._objects)c.texture.destroy(),c.fbo.destroy()}_createObject(c){const p=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),b=new o.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return b.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),p.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),p.colorAttachment.set(b.texture),{id:c,fbo:p,texture:b,stamp:-1,inUse:!1}}getObjectForId(c){return this._objects[c]}useObject(c){c.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(p=>c.id!==p),this._recentlyUsed.push(c.id)}stampObject(c){c.stamp=++this._stamp}getOrCreateFreeObject(){for(const p of this._recentlyUsed)if(!this._objects[p].inUse)return this._objects[p];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const c=this._createObject(this._objects.length);return this._objects.push(c),c}freeObject(c){c.inUse=!1}freeAllObjects(){for(const c of this._objects)this.freeObject(c)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(c=>!c.inUse)===!1}}const gu={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class of{constructor(c,p){this.painter=c,this.terrain=p,this.pool=new Ti(c.context,30,p.tileManager.tileSize*p.qualityFactor)}destruct(){this.pool.destruct()}getTexture(c){return this.pool.getObjectForId(c.rtt[this._stacks.length-1].id).texture}prepareForRender(c,p){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.tileManager.getRenderableTiles(),this._renderableLayerIds=c._order.filter(b=>!c._layers[b].isHidden(p)),this._coordsAscending={};for(const b in c.tileManagers){this._coordsAscending[b]={};const v=c.tileManagers[b].getVisibleCoordinates(),S=c.tileManagers[b].getSource(),P=S instanceof cr?S.terrainTileRanges:null;for(const R of v){const L=this.terrain.tileManager.getTerrainCoords(R,P);for(const F in L)this._coordsAscending[b][F]||(this._coordsAscending[b][F]=[]),this._coordsAscending[b][F].push(L[F])}}this._coordsAscendingStr={};for(const b of c._order){const v=c._layers[b],S=v.source;if(gu[v.type]&&!this._coordsAscendingStr[S]){this._coordsAscendingStr[S]={};for(const P in this._coordsAscending[S])this._coordsAscendingStr[S][P]=this._coordsAscending[S][P].map(R=>R.key).sort().join()}}for(const b of this._renderableTiles)for(const v in this._coordsAscendingStr){const S=this._coordsAscendingStr[v][b.tileID.key];S&&S!==b.rttCoords[v]&&(b.rtt=[])}}renderLayer(c,p){if(c.isHidden(this.painter.transform.zoom))return!1;const b=Object.assign(Object.assign({},p),{isRenderingToTexture:!0}),v=c.type,S=this.painter,P=this._renderableLayerIds[this._renderableLayerIds.length-1]===c.id;if(gu[v]&&(this._prevType&&gu[this._prevType]||this._stacks.push([]),this._prevType=v,this._stacks[this._stacks.length-1].push(c.id),!P))return!0;if(gu[this._prevType]||gu[v]&&P){this._prevType=v;const R=this._stacks.length-1,L=this._stacks[R]||[];for(const F of this._renderableTiles){if(this.pool.isFull()&&(sb(this.painter,this.terrain,this._rttTiles,b),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(F),F.rtt[R]){const J=this.pool.getObjectForId(F.rtt[R].id);if(J.stamp===F.rtt[R].stamp){this.pool.useObject(J);continue}}const j=this.pool.getOrCreateFreeObject();this.pool.useObject(j),this.pool.stampObject(j),F.rtt[R]={id:j.id,stamp:j.stamp},S.context.bindFramebuffer.set(j.fbo.framebuffer),S.context.clear({color:o.bp.transparent,stencil:0}),S.currentStencilSource=void 0;for(let J=0;J<L.length;J++){const X=S.style._layers[L[J]],Q=X.source?this._coordsAscending[X.source][F.tileID.key]:[F.tileID];S.context.viewport.set([0,0,j.fbo.width,j.fbo.height]),S._renderTileClippingMasks(X,Q,!0),S.renderLayer(S,S.style.tileManagers[X.source],X,Q,b),X.source&&(F.rttCoords[X.source]=this._coordsAscendingStr[X.source][F.tileID.key])}}return sb(this.painter,this.terrain,this._rttTiles,b),this._rttTiles=[],this.pool.freeAllObjects(),gu[v]}return!1}}const sg={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},yb=u,og={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Jo,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.c.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,reduceMotion:void 0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0,experimentalZoomLevelsToOverscale:void 0},bb={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class af{constructor(c,p,b=!1){this.mousedown=S=>{this.startMove(S,D.mousePos(this.element,S)),D.addEventListener(window,"mousemove",this.mousemove),D.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=S=>{this.move(S,D.mousePos(this.element,S))},this.mouseup=S=>{this._rotatePitchHandler.dragEnd(S),this.offTemp()},this.touchstart=S=>{S.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=D.touchPos(this.element,S.targetTouches)[0],this.startMove(S,this._startPos),D.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),D.addEventListener(window,"touchend",this.touchend))},this.touchmove=S=>{S.targetTouches.length!==1?this.reset():(this._lastPos=D.touchPos(this.element,S.targetTouches)[0],this.move(S,this._lastPos))},this.touchend=S=>{S.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=p;const v=new XA;this._rotatePitchHandler=new Sh({clickTolerance:3,move:(S,P)=>{const R=p.getBoundingClientRect(),L=new o.P((R.bottom-R.top)/2,(R.right-R.left)/2);return{bearingDelta:o.cx(new o.P(S.x,P.y),P,L),pitchDelta:b?-.5*(P.y-S.y):void 0}},moveStateManager:v,enable:!0,assignEvents:()=>{}}),this.map=c,D.addEventListener(p,"mousedown",this.mousedown),D.addEventListener(p,"touchstart",this.touchstart,{passive:!1}),D.addEventListener(p,"touchcancel",this.reset)}startMove(c,p){this._rotatePitchHandler.dragStart(c,p),D.disableDrag()}move(c,p){const b=this.map,{bearingDelta:v,pitchDelta:S}=this._rotatePitchHandler.dragMove(c,p)||{};v&&b.setBearing(b.getBearing()+v),S&&b.setPitch(b.getPitch()+S)}off(){const c=this.element;D.removeEventListener(c,"mousedown",this.mousedown),D.removeEventListener(c,"touchstart",this.touchstart,{passive:!1}),D.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),D.removeEventListener(window,"touchend",this.touchend),D.removeEventListener(c,"touchcancel",this.reset),this.offTemp()}offTemp(){D.enableDrag(),D.removeEventListener(window,"mousemove",this.mousemove),D.removeEventListener(window,"mouseup",this.mouseup),D.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),D.removeEventListener(window,"touchend",this.touchend)}}let El;function ag(T,c,p,b=!1){if(b||!p.getCoveringTilesDetailsProvider().allowWorldCopies())return T?.wrap();const v=new o.V(T.lng,T.lat);if(T=new o.V(T.lng,T.lat),c){const S=new o.V(T.lng-360,T.lat),P=new o.V(T.lng+360,T.lat),R=p.locationToScreenPoint(T).distSqr(c);p.locationToScreenPoint(S).distSqr(c)<R?T=S:p.locationToScreenPoint(P).distSqr(c)<R&&(T=P)}for(;Math.abs(T.lng-p.center.lng)>180;){const S=p.locationToScreenPoint(T);if(S.x>=0&&S.y>=0&&S.x<=p.width&&S.y<=p.height)break;T.lng>p.center.lng?T.lng-=360:T.lng+=360}return T.lng!==v.lng&&p.isPointOnMapSurface(p.locationToScreenPoint(T))?T:v}const lf={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function lg(T,c,p){const b=T.classList;for(const v in lf)b.remove(`maplibregl-${p}-anchor-${v}`);b.add(`maplibregl-${p}-anchor-${c}`)}class cf extends o.E{constructor(c){if(super(),this._onKeyPress=p=>{const b=p.code,v=p.charCode||p.keyCode;b!=="Space"&&b!=="Enter"&&v!==32&&v!==13||this.togglePopup()},this._onMapClick=p=>{const b=p.originalEvent.target,v=this._element;this._popup&&(b===v||v.contains(b))&&this.togglePopup()},this._update=p=>{if(!this._map)return;const b=this._map.loaded()&&!this._map.isMoving();(p?.type==="terrain"||p?.type==="render"&&!b)&&this._map.once("render",this._update),this._lngLat=ag(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let v="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?v=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(v=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let S="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?S="rotateX(0deg)":this._pitchAlignment==="map"&&(S=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||p&&p.type!=="moveend"||(this._pos=this._pos.round()),D.setTransform(this._element,`${lf[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${S} ${v}`),C.frameAsync(new AbortController).then(()=>{this._updateOpacity(p&&p.type==="moveend")}).catch(()=>{})},this._onMove=p=>{if(!this._isDragging){const b=this._clickTolerance||this._map._clickTolerance;this._isDragging=p.point.dist(this._pointerdownPos)>=b}this._isDragging&&(this._pos=p.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.l("dragstart"))),this.fire(new o.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.l("dragend")),this._state="inactive"},this._addDragHandler=p=>{this._element.contains(p.originalEvent.target)&&(p.preventDefault(),this._positionDelta=p.point.sub(this._pos).add(this._offset),this._pointerdownPos=p.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._subpixelPositioning=c&&c.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&c.pitchAlignment!=="auto"?c.pitchAlignment:this._rotationAlignment,this.setOpacity(c?.opacity,c?.opacityWhenCovered),c&&c.element)this._element=c.element,this._offset=o.P.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=D.create("div");const p=D.createNS("http://www.w3.org/2000/svg","svg"),b=41,v=27;p.setAttributeNS(null,"display","block"),p.setAttributeNS(null,"height",`${b}px`),p.setAttributeNS(null,"width",`${v}px`),p.setAttributeNS(null,"viewBox",`0 0 ${v} ${b}`);const S=D.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"stroke","none"),S.setAttributeNS(null,"stroke-width","1"),S.setAttributeNS(null,"fill","none"),S.setAttributeNS(null,"fill-rule","evenodd");const P=D.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"fill-rule","nonzero");const R=D.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"transform","translate(3.0, 29.0)"),R.setAttributeNS(null,"fill","#000000");const L=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const me of L){const we=D.createNS("http://www.w3.org/2000/svg","ellipse");we.setAttributeNS(null,"opacity","0.04"),we.setAttributeNS(null,"cx","10.5"),we.setAttributeNS(null,"cy","5.80029008"),we.setAttributeNS(null,"rx",me.rx),we.setAttributeNS(null,"ry",me.ry),R.appendChild(we)}const F=D.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"fill",this._color);const j=D.createNS("http://www.w3.org/2000/svg","path");j.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),F.appendChild(j);const J=D.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"opacity","0.25"),J.setAttributeNS(null,"fill","#000000");const X=D.createNS("http://www.w3.org/2000/svg","path");X.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),J.appendChild(X);const Q=D.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Q.setAttributeNS(null,"fill","#FFFFFF");const ae=D.createNS("http://www.w3.org/2000/svg","g");ae.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ge=D.createNS("http://www.w3.org/2000/svg","circle");ge.setAttributeNS(null,"fill","#000000"),ge.setAttributeNS(null,"opacity","0.25"),ge.setAttributeNS(null,"cx","5.5"),ge.setAttributeNS(null,"cy","5.5"),ge.setAttributeNS(null,"r","5.4999962");const ye=D.createNS("http://www.w3.org/2000/svg","circle");ye.setAttributeNS(null,"fill","#FFFFFF"),ye.setAttributeNS(null,"cx","5.5"),ye.setAttributeNS(null,"cy","5.5"),ye.setAttributeNS(null,"r","5.4999962"),ae.appendChild(ge),ae.appendChild(ye),P.appendChild(R),P.appendChild(F),P.appendChild(J),P.appendChild(Q),P.appendChild(ae),p.appendChild(P),p.setAttributeNS(null,"height",b*this._scale+"px"),p.setAttributeNS(null,"width",v*this._scale+"px"),this._element.appendChild(p),this._offset=o.P.convert(c&&c.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",p=>{p.preventDefault()}),this._element.addEventListener("mousedown",p=>{p.preventDefault()}),lg(this._element,this._anchor,"marker"),c&&c.className)for(const p of c.className.split(" "))this._element.classList.add(p);this._popup=null}addTo(c){return this.remove(),this._map=c,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",c._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),c.getCanvasContainer().appendChild(this._element),c.on("move",this._update),c.on("moveend",this._update),c.on("terrain",this._update),c.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),D.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(c){return this._lngLat=o.V.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){const v=Math.abs(13.5)/Math.SQRT2;c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(38.1-13.5+v)],"bottom-right":[-v,-1*(38.1-13.5+v)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=c,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(c){return this._subpixelPositioning=c,this}getPopup(){return this._popup}togglePopup(){const c=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:c?(c.isOpen()?c.remove():(c.setLngLat(this._lngLat),c.addTo(this._map)),this):this}_updateOpacity(c=!1){var p,b;const v=(p=this._map)===null||p===void 0?void 0:p.terrain,S=this._map.transform.isLocationOccluded(this._lngLat);if(!v||S){const Q=S?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==Q&&(this._element.style.opacity=Q))}if(c)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const P=this._map,R=P.terrain.depthAtPoint(this._pos),L=P.terrain.getElevationForLngLat(this._lngLat,P.transform);if(P.transform.lngLatToCameraDepth(this._lngLat,L)-R<.006)return void(this._element.style.opacity=this._opacity);const F=-this._offset.y/P.transform.pixelsPerMeter,j=Math.sin(P.getPitch()*Math.PI/180)*F,J=P.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),X=P.transform.lngLatToCameraDepth(this._lngLat,L+j)-J>.006;!((b=this._popup)===null||b===void 0)&&b.isOpen()&&X&&this._popup.remove(),this._element.style.opacity=X?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(c){return this._offset=o.P.convert(c),this._update(),this}addClassName(c){this._element.classList.add(c)}removeClassName(c){this._element.classList.remove(c)}toggleClassName(c){return this._element.classList.toggle(c)}setDraggable(c){return this._draggable=!!c,this._map&&(c?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(c){return this._rotation=c||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(c){return this._rotationAlignment=c||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(c){return this._pitchAlignment=c&&c!=="auto"?c:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(c,p){return(this._opacity===void 0||c===void 0&&p===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),c!==void 0&&(this._opacity=c),p!==void 0&&(this._opacityWhenCovered=p),this._map&&this._updateOpacity(!0),this}}const _b={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Ih=0,mu=!1;const vb={maxWidth:100,unit:"metric"};function uf(T,c,p){const b=p&&p.maxWidth||100,v=T._container.clientHeight/2,S=T._container.clientWidth/2,P=T.unproject([S-b/2,v]),R=T.unproject([S+b/2,v]),L=Math.round(T.project(R).x-T.project(P).x),F=Math.min(b,L,T._container.clientWidth),j=P.distanceTo(R);if(p&&p.unit==="imperial"){const J=3.2808*j;J>5280?yu(c,F,J/5280,T._getUIString("ScaleControl.Miles")):yu(c,F,J,T._getUIString("ScaleControl.Feet"))}else p&&p.unit==="nautical"?yu(c,F,j/1852,T._getUIString("ScaleControl.NauticalMiles")):j>=1e3?yu(c,F,j/1e3,T._getUIString("ScaleControl.Kilometers")):yu(c,F,j,T._getUIString("ScaleControl.Meters"))}function yu(T,c,p,b){const v=function(S){const P=Math.pow(10,`${Math.floor(S)}`.length-1);let R=S/P;return R=R>=10?10:R>=5?5:R>=3?3:R>=2?2:R>=1?1:function(L){const F=Math.pow(10,Math.ceil(-Math.log(L)/Math.LN10));return Math.round(L*F)/F}(R),P*R}(p);T.style.width=c*(v/p)+"px",T.innerHTML=`${v}&nbsp;${b}`}const Ab={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},cg=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ug(T){if(T){if(typeof T=="number"){const c=Math.round(Math.abs(T)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,T),"top-left":new o.P(c,c),"top-right":new o.P(-c,c),bottom:new o.P(0,-T),"bottom-left":new o.P(c,-c),"bottom-right":new o.P(-c,-c),left:new o.P(T,0),right:new o.P(-T,0)}}if(T instanceof o.P||Array.isArray(T)){const c=o.P.convert(T);return{center:c,top:c,"top-left":c,"top-right":c,bottom:c,"bottom-left":c,"bottom-right":c,left:c,right:c}}return{center:o.P.convert(T.center||[0,0]),top:o.P.convert(T.top||[0,0]),"top-left":o.P.convert(T["top-left"]||[0,0]),"top-right":o.P.convert(T["top-right"]||[0,0]),bottom:o.P.convert(T.bottom||[0,0]),"bottom-left":o.P.convert(T["bottom-left"]||[0,0]),"bottom-right":o.P.convert(T["bottom-right"]||[0,0]),left:o.P.convert(T.left||[0,0]),right:o.P.convert(T.right||[0,0])}}return ug(new o.P(0,0))}const xb=u;a.AJAXError=o.cI,a.Event=o.l,a.Evented=o.E,a.LngLat=o.V,a.MercatorCoordinate=o.a9,a.Point=o.P,a.addProtocol=o.cJ,a.config=o.c,a.removeProtocol=o.cK,a.AttributionControl=mb,a.BoxZoomHandler=Th,a.CanvasSource=re,a.CooperativeGesturesHandler=hr,a.DoubleClickZoomHandler=gb,a.DragPanHandler=e1,a.DragRotateHandler=xa,a.EdgeInsets=lh,a.FullscreenControl=class extends o.E{constructor(T={}){super(),this._onFullscreenChange=()=>{var c;let p=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((c=p?.shadowRoot)===null||c===void 0)&&c.fullscreenElement;)p=p.shadowRoot.fullscreenElement;p===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,T&&T.container&&(T.container instanceof HTMLElement?this._container=T.container:o.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(T){return this._map=T,this._container||(this._container=this._map.getContainer()),this._controlContainer=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){D.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const T=this._fullscreenButton=D.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);D.create("span","maplibregl-ctrl-icon",T).setAttribute("aria-hidden","true"),T.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const T=this._getTitle();this._fullscreenButton.setAttribute("aria-label",T),this._fullscreenButton.title=T}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new o.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},a.GeoJSONSource=Qt,a.GeolocateControl=class extends o.E{constructor(T){super(),this._onSuccess=c=>{if(this._map){if(this._isOutOfMapMaxBounds(c))return this._setErrorState(),this.fire(new o.l("outofmaxbounds",c)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=c,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(c),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(c),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new o.l("geolocate",c)),this._finish()}},this._updateCamera=c=>{const p=new o.V(c.coords.longitude,c.coords.latitude),b=c.coords.accuracy,v=this._map.getBearing(),S=o.e({bearing:v},this.options.fitBoundsOptions),P=Qe.fromLngLat(p,b);this._map.fitBounds(P,S,{geolocateSource:!0})},this._updateMarker=c=>{if(c){const p=new o.V(c.coords.longitude,c.coords.latitude);this._accuracyCircleMarker.setLngLat(p).addTo(this._map),this._userLocationDotMarker.setLngLat(p).addTo(this._map),this._accuracy=c.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=c=>{if(this._map){if(c.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const p=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=p,this._geolocateButton.setAttribute("aria-label",p),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(c.code===3&&mu)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new o.l("error",c)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",c=>c.preventDefault()),this._geolocateButton=D.create("button","maplibregl-ctrl-geolocate",this._container),D.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=c=>{if(this._map){if(c===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");const p=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=p,this._geolocateButton.setAttribute("aria-label",p)}else{const p=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=p,this._geolocateButton.setAttribute("aria-label",p)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=D.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new cf({element:this._dotElement}),this._circleElement=D.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new cf({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",p=>{const b=p?.[0]instanceof ResizeObserverEntry;p.geolocateSource||this._watchState!=="ACTIVE_LOCK"||b||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new o.l("trackuserlocationend")),this.fire(new o.l("userlocationlostfocus")))})}},this.options=o.e({},_b,T)}onAdd(T){return this._map=T,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return o._(this,arguments,void 0,function*(c=!1){if(El!==void 0&&!c)return El;if(window.navigator.permissions===void 0)return El=!!window.navigator.geolocation,El;try{El=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{El=!!window.navigator.geolocation}return El})}().then(c=>this._finishSetupUI(c)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),D.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,Ih=0,mu=!1}_isOutOfMapMaxBounds(T){const c=this._map.getMaxBounds(),p=T.coords;return c&&(p.longitude<c.getWest()||p.longitude>c.getEast()||p.latitude<c.getSouth()||p.latitude>c.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const T=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&T))return;const c=this._map.project(T),p=this._map.unproject([c.x+100,c.y]),b=T.distanceTo(p)/100,v=2*this._accuracy/b;this._circleElement.style.width=`${v.toFixed(2)}px`,this._circleElement.style.height=`${v.toFixed(2)}px`}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ih--,mu=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new o.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.l("trackuserlocationstart")),this.fire(new o.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let T;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ih++,Ih>1?(T={maximumAge:6e5,timeout:0},mu=!0):(T=this.options.positionOptions,mu=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,T)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},a.GlobeControl=class{constructor(){this._toggleProjection=()=>{var T;const c=(T=this._map.getProjection())===null||T===void 0?void 0:T.type;this._map.setProjection(c!=="mercator"&&c?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var T;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((T=this._map.getProjection())===null||T===void 0?void 0:T.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(T){return this._map=T,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=D.create("button","maplibregl-ctrl-globe",this._container),D.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){D.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},a.Hash=lb,a.ImageSource=cr,a.KeyboardHandler=kn,a.LngLatBounds=Qe,a.LogoControl=t1,a.Map=class extends qs{constructor(T){var c,p;o.cG.mark(o.cH.create);const b=Object.assign(Object.assign(Object.assign({},og),T),{canvasContextAttributes:Object.assign(Object.assign({},og.canvasContextAttributes),T.canvasContextAttributes)});if(b.minZoom!=null&&b.maxZoom!=null&&b.minZoom>b.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(b.minPitch!=null&&b.maxPitch!=null&&b.minPitch>b.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(b.minPitch!=null&&b.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(b.maxPitch!=null&&b.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const v=new iu,S=new su;if(b.minZoom!==void 0&&v.setMinZoom(b.minZoom),b.maxZoom!==void 0&&v.setMaxZoom(b.maxZoom),b.minPitch!==void 0&&v.setMinPitch(b.minPitch),b.maxPitch!==void 0&&v.setMaxPitch(b.maxPitch),b.renderWorldCopies!==void 0&&v.setRenderWorldCopies(b.renderWorldCopies),b.transformConstrain!==null&&v.setConstrainOverride(b.transformConstrain),super(v,S,{bearingSnap:b.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new V2,this._controls=[],this._mapId=o.af(),this._lostContextStyle={style:null,images:null},this._contextLost=R=>{R.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.painter.destroy();for(const L of Object.values(this.style._layers))if(L.type==="custom"&&console.warn(`Custom layer with id '${L.id}' cannot be restored after WebGL context loss. You will need to re-add it manually after context restoration.`),L._listeners)for(const[F]of Object.entries(L._listeners))console.warn(`Custom layer with id '${L.id}' had event listeners for event '${F}' which cannot be restored after WebGL context loss. You will need to re-add them manually after context restoration.`);this._lostContextStyle=this._getStyleAndImages(),this.style.destroy(),this.style=null,this.fire(new o.l("webglcontextlost",{originalEvent:R}))},this._contextRestored=R=>{this._lostContextStyle.style&&this.setStyle(this._lostContextStyle.style,{diff:!1}),this._lostContextStyle.images&&(this.style.imageManager.images=this._lostContextStyle.images),this._setupPainter(),this.resize(),this._update(),this.fire(new o.l("webglcontextrestored",{originalEvent:R}))},this._onMapScroll=R=>{if(R.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=b.interactive,this._maxTileCacheSize=b.maxTileCacheSize,this._maxTileCacheZoomLevels=b.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},b.canvasContextAttributes),this._trackResize=b.trackResize===!0,this._bearingSnap=b.bearingSnap,this._centerClampedToGround=b.centerClampedToGround,this._refreshExpiredTiles=b.refreshExpiredTiles===!0,this._fadeDuration=b.fadeDuration,this._crossSourceCollisions=b.crossSourceCollisions===!0,this._collectResourceTiming=b.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},sg),b.locale),this._clickTolerance=b.clickTolerance,this._overridePixelRatio=b.pixelRatio,this._maxCanvasSize=b.maxCanvasSize,this._zoomLevelsToOverscale=b.experimentalZoomLevelsToOverscale,this.transformCameraUpdate=b.transformCameraUpdate,this.transformConstrain=b.transformConstrain,this.cancelPendingTileRequestsWhileZooming=b.cancelPendingTileRequestsWhileZooming===!0,b.reduceMotion!==void 0&&(C.prefersReducedMotion=b.reduceMotion),this._imageQueueHandle=_e.addThrottleControl(()=>this.isMoving()),this._requestManager=new se(b.transformRequest),typeof b.container=="string"){if(this._container=document.getElementById(b.container),!this._container)throw new Error(`Container '${b.container}' not found.`)}else{if(!(b.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=b.container}if(b.maxBounds&&this.setMaxBounds(b.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let R=!1;const L=ab(F=>{this._trackResize&&!this._removed&&(this.resize(F),this.redraw())},50);this._resizeObserver=new ResizeObserver(F=>{R?L(F):R=!0}),this._resizeObserver.observe(this._container)}this.handlers=new ig(this,b),this._hash=b.hash&&new lb(typeof b.hash=="string"&&b.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:b.center,elevation:b.elevation,zoom:b.zoom,bearing:b.bearing,pitch:b.pitch,roll:b.roll}),b.bounds&&(this.resize(),this.fitBounds(b.bounds,o.e({},b.fitBoundsOptions,{duration:0}))));const P=typeof b.style=="string"||((p=(c=b.style)===null||c===void 0?void 0:c.projection)===null||p===void 0?void 0:p.type)!=="globe";this.resize(null,P),this._localIdeographFontFamily=b.localIdeographFontFamily,this._validateStyle=b.validateStyle,b.style&&this.setStyle(b.style,{localIdeographFontFamily:b.localIdeographFontFamily}),b.attributionControl&&this.addControl(new mb(typeof b.attributionControl=="boolean"?void 0:b.attributionControl)),b.maplibreLogo&&this.addControl(new t1,b.logoPosition),this.on("style.load",()=>{if(P||this._resizeTransform(),this.transform.unmodified){const R=o.U(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(R)}}),this.on("data",R=>{this._update(R.dataType==="style"),this.fire(new o.l(`${R.dataType}data`,R))}),this.on("dataloading",R=>{this.fire(new o.l(`${R.dataType}dataloading`,R))}),this.on("dataabort",R=>{this.fire(new o.l("sourcedataabort",R))})}_getMapId(){return this._mapId}setGlobalStateProperty(T,c){return this.style.setGlobalStateProperty(T,c),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(T,c){if(c===void 0&&(c=T.getDefaultPosition?T.getDefaultPosition():"top-right"),!T||!T.onAdd)return this.fire(new o.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const p=T.onAdd(this);this._controls.push(T);const b=this._controlPositions[c];return c.indexOf("bottom")!==-1?b.insertBefore(p,b.firstChild):b.appendChild(p),this}removeControl(T){if(!T||!T.onRemove)return this.fire(new o.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const c=this._controls.indexOf(T);return c>-1&&this._controls.splice(c,1),T.onRemove(this),this}hasControl(T){return this._controls.indexOf(T)>-1}coveringTiles(T){return nn(this.transform,T)}calculateCameraOptionsFromTo(T,c,p,b){return b==null&&this.terrain&&(b=this.terrain.getElevationForLngLat(p,this.transform)),super.calculateCameraOptionsFromTo(T,c,p,b)}resize(T,c=!0){const[p,b]=this._containerDimensions(),v=this._getClampedPixelRatio(p,b);if(this._resizeCanvas(p,b,v),this.painter.resize(p,b,v),this.painter.overLimit()){const P=this.painter.context.gl;this._maxCanvasSize=[P.drawingBufferWidth,P.drawingBufferHeight];const R=this._getClampedPixelRatio(p,b);this._resizeCanvas(p,b,R),this.painter.resize(p,b,R)}this._resizeTransform(c);const S=!this._moving;return S&&(this.stop(),this.fire(new o.l("movestart",T)).fire(new o.l("move",T))),this.fire(new o.l("resize",T)),S&&this.fire(new o.l("moveend",T)),this}_resizeTransform(T=!0){var c;const[p,b]=this._containerDimensions();this.transform.resize(p,b,T),(c=this._requestedCameraState)===null||c===void 0||c.resize(p,b,T)}_getClampedPixelRatio(T,c){const{0:p,1:b}=this._maxCanvasSize,v=this.getPixelRatio(),S=T*v,P=c*v;return Math.min(S>p?p/S:1,P>b?b/P:1)*v}getPixelRatio(){var T;return(T=this._overridePixelRatio)!==null&&T!==void 0?T:devicePixelRatio}setPixelRatio(T){this._overridePixelRatio=T,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(T){return this.transform.setMaxBounds(Qe.convert(T)),this._update()}setMinZoom(T){if((T=T??-2)>=-2&&T<=this.transform.maxZoom){const c=this._getTransformForUpdate();return c.setMinZoom(T),this._applyUpdatedTransform(c),this._update(),this}throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(T){if((T=T??22)>=this.transform.minZoom){const c=this._getTransformForUpdate();return c.setMaxZoom(T),this._applyUpdatedTransform(c),this._update(),this}throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(T){if((T=T??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(T>=0&&T<=this.transform.maxPitch)return this.transform.setMinPitch(T),this._update(),this.getPitch()<T&&this.setPitch(T),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(T){if((T=T??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(T>=this.transform.minPitch)return this.transform.setMaxPitch(T),this._update(),this.getPitch()>T&&this.setPitch(T),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(T){return this.transform.setRenderWorldCopies(T),this._update()}setTransformConstrain(T){return this.transform.setConstrainOverride(T),this._update()}project(T){return this.transform.locationToScreenPoint(o.V.convert(T),this.style&&this.terrain)}unproject(T){return this.transform.screenPointToLocation(o.P.convert(T),this.terrain)}isMoving(){var T;return this._moving||((T=this.handlers)===null||T===void 0?void 0:T.isMoving())}isZooming(){var T;return this._zooming||((T=this.handlers)===null||T===void 0?void 0:T.isZooming())}isRotating(){var T;return this._rotating||((T=this.handlers)===null||T===void 0?void 0:T.isRotating())}_createDelegatedListener(T,c,p){if(T==="mouseenter"||T==="mouseover"){let b=!1;return{layers:c,listener:p,delegates:{mousemove:S=>{const P=c.filter(L=>this.getLayer(L)),R=P.length!==0?this.queryRenderedFeatures(S.point,{layers:P}):[];R.length?b||(b=!0,p.call(this,new os(T,this,S.originalEvent,{features:R}))):b=!1},mouseout:()=>{b=!1}}}}if(T==="mouseleave"||T==="mouseout"){let b=!1;return{layers:c,listener:p,delegates:{mousemove:P=>{const R=c.filter(L=>this.getLayer(L));(R.length!==0?this.queryRenderedFeatures(P.point,{layers:R}):[]).length?b=!0:b&&(b=!1,p.call(this,new os(T,this,P.originalEvent)))},mouseout:P=>{b&&(b=!1,p.call(this,new os(T,this,P.originalEvent)))}}}}{const b=v=>{const S=c.filter(R=>this.getLayer(R)),P=S.length!==0?this.queryRenderedFeatures(v.point,{layers:S}):[];P.length&&(v.features=P,p.call(this,v),delete v.features)};return{layers:c,listener:p,delegates:{[T]:b}}}}_saveDelegatedListener(T,c){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[T]=this._delegatedListeners[T]||[],this._delegatedListeners[T].push(c)}_removeDelegatedListener(T,c,p){if(!this._delegatedListeners||!this._delegatedListeners[T])return;const b=this._delegatedListeners[T];for(let v=0;v<b.length;v++){const S=b[v];if(S.listener===p&&S.layers.length===c.length&&S.layers.every(P=>c.includes(P))){for(const P in S.delegates)this.off(P,S.delegates[P]);return void b.splice(v,1)}}}on(T,c,p){if(p===void 0)return super.on(T,c);const b=typeof c=="string"?[c]:c,v=this._createDelegatedListener(T,b,p);this._saveDelegatedListener(T,v);for(const S in v.delegates)this.on(S,v.delegates[S]);return{unsubscribe:()=>{this._removeDelegatedListener(T,b,p)}}}once(T,c,p){if(p===void 0)return super.once(T,c);const b=typeof c=="string"?[c]:c,v=this._createDelegatedListener(T,b,p);for(const S in v.delegates){const P=v.delegates[S];v.delegates[S]=(...R)=>{this._removeDelegatedListener(T,b,p),P(...R)}}this._saveDelegatedListener(T,v);for(const S in v.delegates)this.once(S,v.delegates[S]);return this}off(T,c,p){return p===void 0?super.off(T,c):(this._removeDelegatedListener(T,typeof c=="string"?[c]:c,p),this)}queryRenderedFeatures(T,c){if(!this.style)return[];let p;const b=T instanceof o.P||Array.isArray(T),v=b?T:[[0,0],[this.transform.width,this.transform.height]];if(c=c||(b?{}:T)||{},v instanceof o.P||typeof v[0]=="number")p=[o.P.convert(v)];else{const S=o.P.convert(v[0]),P=o.P.convert(v[1]);p=[S,new o.P(P.x,S.y),P,new o.P(S.x,P.y),S]}return this.style.queryRenderedFeatures(p,c,this.transform)}querySourceFeatures(T,c){return this.style.querySourceFeatures(T,c)}setStyle(T,c){return(c=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},c)).diff!==!1&&c.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&T?(this._diffStyle(T,c),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._updateStyle(T,c))}setTransformRequest(T){return this._requestManager.setTransformRequest(T),this}_getUIString(T){const c=this._locale[T];if(c==null)throw new Error(`Missing UI string '${T}'`);return c}_updateStyle(T,c){var p,b;if(c.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(T,c));const v=this.style&&c.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!T)),T?(this.style=new au(this,c||{}),this.style.setEventedParent(this,{style:this.style}),typeof T=="string"?this.style.loadURL(T,c,v):this.style.loadJSON(T,c,v),this):((b=(p=this.style)===null||p===void 0?void 0:p.projection)===null||b===void 0||b.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new au(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(T,c){if(typeof T=="string"){const p=this._requestManager.transformRequest(T,"Style");o.j(p,new AbortController).then(b=>{this._updateDiff(b.data,c)}).catch(b=>{b&&this.fire(new o.k(b))})}else typeof T=="object"&&this._updateDiff(T,c)}_updateDiff(T,c){try{this.style.setState(T,c)&&this._update(!0)}catch(p){o.w(`Unable to perform style diff: ${p.message||p.error||p}.  Rebuilding the style from scratch.`),this._updateStyle(T,c)}}getStyle(){if(this.style)return this.style.serialize()}_getStyleAndImages(){return this.style?{style:this.style.serialize(),images:this.style.imageManager.cloneImages()}:{style:null,images:{}}}isStyleLoaded(){return this.style?this.style.loaded():o.w("There is no style added to the map.")}addSource(T,c){return this._lazyInitEmptyStyle(),this.style.addSource(T,c),this._update(!0)}isSourceLoaded(T){const c=this.style&&this.style.tileManagers[T];if(c!==void 0)return c.loaded();this.fire(new o.k(new Error(`There is no tile manager with ID '${T}'`)))}setTerrain(T){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),T){const c=this.style.tileManagers[T.source];if(!c)throw new Error(`cannot load terrain, because there exists no source with ID: ${T.source}`);this.terrain===null&&c.reload();for(const p in this.style._layers){const b=this.style._layers[p];b.type==="hillshade"&&b.source===T.source&&o.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),b.type==="color-relief"&&b.source===T.source&&o.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new di(this.painter,c,T),this.painter.renderToTexture=new of(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=p=>{var b;p.dataType==="style"?this.terrain.tileManager.freeRtt():p.dataType==="source"&&p.tile&&(p.sourceId!==T.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((b=p.source)===null||b===void 0?void 0:b.type)==="image"?this.terrain.tileManager.freeRtt():this.terrain.tileManager.freeRtt(p.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.tileManager.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new o.l("terrain",{terrain:T})),this}getTerrain(){var T,c;return(c=(T=this.terrain)===null||T===void 0?void 0:T.options)!==null&&c!==void 0?c:null}areTilesLoaded(){const T=this.style&&this.style.tileManagers;for(const c of Object.values(T))if(!c.areTilesLoaded())return!1;return!0}removeSource(T){return this.style.removeSource(T),this._update(!0)}getSource(T){return this.style.getSource(T)}setSourceTileLodParams(T,c,p){if(p){const b=this.getSource(p);if(!b)throw new Error(`There is no source with ID "${p}", cannot set LOD parameters`);b.calculateTileZoom=qr(Math.max(1,T),Math.max(1,c))}else for(const b in this.style.tileManagers)this.style.tileManagers[b].getSource().calculateTileZoom=qr(Math.max(1,T),Math.max(1,c));return this._update(!0),this}refreshTiles(T,c){const p=this.style.tileManagers[T];if(!p)throw new Error(`There is no tile manager with ID "${T}", cannot refresh tile`);c===void 0?p.reload(!0):p.refreshTiles(c.map(b=>new o.ac(b.z,b.x,b.y)))}addImage(T,c,p={}){const{pixelRatio:b=1,sdf:v=!1,stretchX:S,stretchY:P,content:R,textFitWidth:L,textFitHeight:F}=p;if(this._lazyInitEmptyStyle(),!(c instanceof HTMLImageElement||o.b(c))){if(c.width===void 0||c.height===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:j,height:J,data:X}=c,Q=c;return this.style.addImage(T,{data:new o.R({width:j,height:J},new Uint8Array(X)),pixelRatio:b,stretchX:S,stretchY:P,content:R,textFitWidth:L,textFitHeight:F,sdf:v,version:0,userImage:Q}),Q.onAdd&&Q.onAdd(this,T),this}}{const{width:j,height:J,data:X}=C.getImageData(c);this.style.addImage(T,{data:new o.R({width:j,height:J},X),pixelRatio:b,stretchX:S,stretchY:P,content:R,textFitWidth:L,textFitHeight:F,sdf:v,version:0})}}updateImage(T,c){const p=this.style.getImage(T);if(!p)return this.fire(new o.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const b=c instanceof HTMLImageElement||o.b(c)?C.getImageData(c):c,{width:v,height:S,data:P}=b;if(v===void 0||S===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(v!==p.data.width||S!==p.data.height)return this.fire(new o.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const R=!(c instanceof HTMLImageElement||o.b(c));return p.data.replace(P,R),this.style.updateImage(T,p),this}getImage(T){return this.style.getImage(T)}hasImage(T){return T?!!this.style.getImage(T):(this.fire(new o.k(new Error("Missing required image id"))),!1)}removeImage(T){this.style.removeImage(T)}loadImage(T){return _e.getImage(this._requestManager.transformRequest(T,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(T,c){return this._lazyInitEmptyStyle(),this.style.addLayer(T,c),this._update(!0)}moveLayer(T,c){return this.style.moveLayer(T,c),this._update(!0)}removeLayer(T){return this.style.removeLayer(T),this._update(!0)}getLayer(T){return this.style.getLayer(T)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(T,c,p){return this.style.setLayerZoomRange(T,c,p),this._update(!0)}setFilter(T,c,p={}){return this.style.setFilter(T,c,p),this._update(!0)}getFilter(T){return this.style.getFilter(T)}setPaintProperty(T,c,p,b={}){return this.style.setPaintProperty(T,c,p,b),this._update(!0)}getPaintProperty(T,c){return this.style.getPaintProperty(T,c)}setLayoutProperty(T,c,p,b={}){return this.style.setLayoutProperty(T,c,p,b),this._update(!0)}getLayoutProperty(T,c){return this.style.getLayoutProperty(T,c)}setGlyphs(T,c={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(T,c),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(T,c,p={}){return this._lazyInitEmptyStyle(),this.style.addSprite(T,c,p,b=>{b||this._update(!0)}),this}removeSprite(T){return this._lazyInitEmptyStyle(),this.style.removeSprite(T),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(T,c={}){return this._lazyInitEmptyStyle(),this.style.setSprite(T,c,p=>{p||this._update(!0)}),this}setLight(T,c={}){return this._lazyInitEmptyStyle(),this.style.setLight(T,c),this._update(!0)}getLight(){return this.style.getLight()}setSky(T,c={}){return this._lazyInitEmptyStyle(),this.style.setSky(T,c),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(T,c){return this.style.setFeatureState(T,c),this._update()}removeFeatureState(T,c){return this.style.removeFeatureState(T,c),this._update()}getFeatureState(T){return this.style.getFeatureState(T)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let T=0,c=0;return this._container&&(T=this._container.clientWidth||400,c=this._container.clientHeight||300),[T,c]}_setupContainer(){const T=this._container;T.classList.add("maplibregl-map");const c=this._canvasContainer=D.create("div","maplibregl-canvas-container",T);this._interactive&&c.classList.add("maplibregl-interactive"),this._canvas=D.create("canvas","maplibregl-canvas",c),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const p=this._containerDimensions(),b=this._getClampedPixelRatio(p[0],p[1]);this._resizeCanvas(p[0],p[1],b);const v=this._controlContainer=D.create("div","maplibregl-control-container",T),S=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(P=>{S[P]=D.create("div",`maplibregl-ctrl-${P} `,v)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(T,c,p){this._canvas.width=Math.floor(p*T),this._canvas.height=Math.floor(p*c),this._canvas.style.width=`${T}px`,this._canvas.style.height=`${c}px`}_setupPainter(){const T=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let c=null;this._canvas.addEventListener("webglcontextcreationerror",b=>{c={requestedAttributes:T},b&&(c.statusMessage=b.statusMessage,c.type=b.type)},{once:!0});let p=null;if(p=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,T):this._canvas.getContext("webgl2",T)||this._canvas.getContext("webgl",T),!p){const b="Failed to initialize WebGL";throw c?(c.message=b,new Error(JSON.stringify(c))):new Error(b)}this.painter=new GA(p,this.transform),V.testSupport(p)}migrateProjection(T,c){super.migrateProjection(T,c),this.painter.transform=T,this.fire(new o.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(T){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||T,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(T){return this._update(),this._renderTaskQueue.add(T)}_cancelRenderFrame(T){this._renderTaskQueue.remove(T)}_render(T){var c,p,b,v,S;const P=this._idleTriggered?this._fadeDuration:0,R=((c=this.style.projection)===null||c===void 0?void 0:c.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(T),this._removed)return;let L=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const J=this.transform.zoom,X=k();this.style.zoomHistory.update(J,X);const Q=new o.H(J,{now:X,fadeDuration:P,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ae=Q.crossFadingFactor();ae===1&&ae===this._crossFadingFactor||(L=!0,this._crossFadingFactor=ae),this.style.update(Q)}const F=((p=this.style.projection)===null||p===void 0?void 0:p.transitionState)>0!==R;(b=this.style.projection)===null||b===void 0||b.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((v=this.style.projection)===null||v===void 0?void 0:v.transitionState,(S=this.style.projection)===null||S===void 0?void 0:S.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||F)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.tileManager.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,P,this._crossSourceCollisions,F),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:P,showPadding:this.showPadding}),this.fire(new o.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.cG.mark(o.cH.load),this.fire(new o.l("load"))),this.style&&(this.style.hasTransitions()||L)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const j=this._sourcesDirty||this._styleDirty||this._placementDirty;return j||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.l("idle")),!this._loaded||this._fullyLoaded||j||(this._fullyLoaded=!0,o.cG.mark(o.cH.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var T;this._hash&&this._hash.remove();for(const p of this._controls)p.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),_e.removeThrottleControl(this._imageQueueHandle),(T=this._resizeObserver)===null||T===void 0||T.disconnect();const c=this.painter.context.gl.getExtension("WEBGL_lose_context");c?.loseContext&&c.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),D.remove(this._canvasContainer),D.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),o.cG.clearMetrics(),this._removed=!0,this.fire(new o.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,C.frame(this._frameRequest,T=>{o.cG.frame(T),this._frameRequest=null;try{this._render(T)}catch(c){if(!o.Z(c)&&!function(p){return p.message===tb}(c))throw c}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(T){this._showTileBoundaries!==T&&(this._showTileBoundaries=T,this._update())}get showPadding(){return!!this._showPadding}set showPadding(T){this._showPadding!==T&&(this._showPadding=T,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(T){this._showCollisionBoxes!==T&&(this._showCollisionBoxes=T,T?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(T){this._showOverdrawInspector!==T&&(this._showOverdrawInspector=T,this._update())}get repaint(){return!!this._repaint}set repaint(T){this._repaint!==T&&(this._repaint=T,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(T){this._vertices=T,this._update()}get version(){return yb}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(T){return this._lazyInitEmptyStyle(),this.style.setProjection(T),this._update(!0)}},a.MapMouseEvent=os,a.MapTouchEvent=Yd,a.MapWheelEvent=KA,a.Marker=cf,a.NavigationControl=class{constructor(T){this._updateZoomButtons=()=>{const c=this._map.getZoom(),p=c===this._map.getMaxZoom(),b=c===this._map.getMinZoom();this._zoomInButton.disabled=p,this._zoomOutButton.disabled=b,this._zoomInButton.setAttribute("aria-disabled",p.toString()),this._zoomOutButton.setAttribute("aria-disabled",b.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(c,p)=>{const b=this._map._getUIString(`NavigationControl.${p}`);c.title=b,c.setAttribute("aria-label",b)},this.options=o.e({},bb,T),this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",c=>c.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",c=>this._map.zoomIn({},{originalEvent:c})),D.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",c=>this._map.zoomOut({},{originalEvent:c})),D.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",c=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:c}):this._map.resetNorth({},{originalEvent:c})}),this._compassIcon=D.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(T){return this._map=T,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new af(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){D.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(T,c){const p=D.create("button",T,this._container);return p.type="button",p.addEventListener("click",c),p}},a.Popup=class extends o.E{constructor(T){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&D.remove(this._content),this._container&&(D.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new o.l("close"))),this),this._onMouseUp=c=>{this._update(c.point)},this._onMouseMove=c=>{this._update(c.point)},this._onDrag=c=>{this._update(c.point)},this._update=c=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=D.create("div","maplibregl-popup",this._map.getContainer()),this._tip=D.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const P of this.options.className.split(" "))this._container.classList.add(P);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=ag(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!c)return;const p=this._flatPos=this._pos=this._trackPointer&&c?c:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&c?c:this._map.transform.locationToScreenPoint(this._lngLat));let b=this.options.anchor;const v=ug(this.options.offset);if(!b){const P=this._container.offsetWidth,R=this._container.offsetHeight;let L;L=p.y+v.bottom.y<R?["top"]:p.y>this._map.transform.height-R?["bottom"]:[],p.x<P/2?L.push("left"):p.x>this._map.transform.width-P/2&&L.push("right"),b=L.length===0?"bottom":L.join("-")}let S=p.add(v[b]);this.options.subpixelPositioning||(S=S.round()),D.setTransform(this._container,`${lf[b]} translate(${S.x}px,${S.y}px)`),lg(this._container,b,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(Ab),T)}addTo(T){return this._map&&this.remove(),this._map=T,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new o.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(T){return this._lngLat=o.V.convert(T),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(T){return this.setDOMContent(document.createTextNode(T))}setHTML(T){const c=document.createDocumentFragment(),p=document.createElement("body");let b;for(p.innerHTML=T;b=p.firstChild,b;)c.appendChild(b);return this.setDOMContent(c)}getMaxWidth(){var T;return(T=this._container)===null||T===void 0?void 0:T.style.maxWidth}setMaxWidth(T){return this.options.maxWidth=T,this._update(),this}setDOMContent(T){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=D.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(T),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(T){return this._container&&this._container.classList.add(T),this}removeClassName(T){return this._container&&this._container.classList.remove(T),this}setOffset(T){return this.options.offset=T,this._update(),this}toggleClassName(T){if(this._container)return this._container.classList.toggle(T)}setSubpixelPositioning(T){this.options.subpixelPositioning=T}_createCloseButton(){this.options.closeButton&&(this._closeButton=D.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const T=this._container.querySelector(cg);T&&T.focus()}},a.RasterDEMTileSource=Nt,a.RasterTileSource=Dt,a.ScaleControl=class{constructor(T){this._onMove=()=>{uf(this._map,this._container,this.options)},this.setUnit=c=>{this.options.unit=c,uf(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},vb),T)}getDefaultPosition(){return"bottom-left"}onAdd(T){return this._map=T,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-scale",T.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){D.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},a.ScrollZoomHandler=rg,a.Style=au,a.TerrainControl=class{constructor(T){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=T}onAdd(T){return this._map=T,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=D.create("button","maplibregl-ctrl-terrain",this._container),D.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){D.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},a.TwoFingersTouchPitchHandler=YA,a.TwoFingersTouchRotateHandler=fb,a.TwoFingersTouchZoomHandler=db,a.TwoFingersTouchZoomRotateHandler=rf,a.VectorTileSource=$t,a.VideoSource=Fe,a.addSourceType=(T,c)=>o._(void 0,void 0,void 0,function*(){if(he(T))throw new Error(`A source type called "${T}" already exists.`);((p,b)=>{ne[p]=b})(T,c)}),a.clearPrewarmedResources=function(){const T=Jn;T&&(T.isPreloaded()&&T.numActive()===1?(T.release(mi),Jn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},a.createTileMesh=uA,a.getMaxParallelImageRequests=function(){return o.c.MAX_PARALLEL_IMAGE_REQUESTS},a.getRTLTextPluginStatus=function(){return Ge().getRTLTextPluginStatus()},a.getVersion=function(){return xb},a.getWorkerCount=function(){return Pn.workerCount},a.getWorkerUrl=function(){return o.c.WORKER_URL},a.importScriptInWorkers=function(T){return nr().broadcast("IS",T)},a.isTimeFrozen=function(){return M.isFrozen()},a.now=k,a.prewarm=function(){_t().acquire(mi)},a.restoreNow=function(){M.restoreNow()},a.setMaxParallelImageRequests=function(T){o.c.MAX_PARALLEL_IMAGE_REQUESTS=T},a.setNow=function(T){M.setNow(T)},a.setRTLTextPlugin=function(T,c){return Ge().setRTLTextPlugin(T,c)},a.setWorkerCount=function(T){Pn.workerCount=T},a.setWorkerUrl=function(T){o.c.WORKER_URL=T}});var s=t;return s})})(RH);var Fue=RH.exports;const OH=R$(Fue);async function Wv(r,e,t,n){return n._parse(r,e,t,n)}function ci(r,e){if(!r)throw new Error(e||"loader assertion failed.")}const kS=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),K4=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);K4&&parseFloat(K4[1]);const X4=globalThis,J4=globalThis.process||{},Uue=globalThis.navigator||{};function DH(r){if(typeof window<"u"&&window.process?.type==="renderer"||typeof process<"u"&&process.versions?.electron)return!0;const t=typeof navigator<"u"&&navigator.userAgent;return!!(t&&t.indexOf("Electron")>=0)}function _p(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process?.browser)||DH()}function zue(r){return _p()?DH()?"Electron":(Uue.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown":"Node"}const LH="4.1.0";function Vue(r){try{const e=window[r],t="__storage_test__";return e.setItem(t,t),e.removeItem(t),e}catch{return null}}class $ue{constructor(e,t,n="sessionStorage"){this.storage=Vue(n),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function jue(r){let e;return r<10?e=`${r.toFixed(2)}ms`:r<100?e=`${r.toFixed(1)}ms`:r<1e3?e=`${r.toFixed(0)}ms`:e=`${(r/1e3).toFixed(2)}s`,e}function Gue(r,e=8){const t=Math.max(e-r.length,0);return`${" ".repeat(t)}${r}`}var CC;(function(r){r[r.BLACK=30]="BLACK",r[r.RED=31]="RED",r[r.GREEN=32]="GREEN",r[r.YELLOW=33]="YELLOW",r[r.BLUE=34]="BLUE",r[r.MAGENTA=35]="MAGENTA",r[r.CYAN=36]="CYAN",r[r.WHITE=37]="WHITE",r[r.BRIGHT_BLACK=90]="BRIGHT_BLACK",r[r.BRIGHT_RED=91]="BRIGHT_RED",r[r.BRIGHT_GREEN=92]="BRIGHT_GREEN",r[r.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",r[r.BRIGHT_BLUE=94]="BRIGHT_BLUE",r[r.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",r[r.BRIGHT_CYAN=96]="BRIGHT_CYAN",r[r.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(CC||(CC={}));const Hue=10;function q4(r){return typeof r!="string"?r:(r=r.toUpperCase(),CC[r]||CC.WHITE)}function Wue(r,e,t){return!_p&&typeof r=="string"&&(e&&(r=`\x1B[${q4(e)}m${r}\x1B[39m`),t&&(r=`\x1B[${q4(t)+Hue}m${r}\x1B[49m`)),r}function Kue(r,e=["constructor"]){const t=Object.getPrototypeOf(r),n=Object.getOwnPropertyNames(t),i=r;for(const s of n){const a=i[s];typeof a=="function"&&(e.find(o=>s===o)||(i[s]=a.bind(r)))}}function Nk(r,e){if(!r)throw new Error("Assertion failed")}function Rg(){let r;if(_p()&&X4.performance)r=X4?.performance?.now?.();else if("hrtime"in J4){const e=J4?.hrtime?.();r=e[0]*1e3+e[1]/1e6}else r=Date.now();return r}const kg={debug:_p()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Xue={enabled:!0,level:0};function Og(){}const Y4={},Z4={once:!0};class Ey{constructor({id:e}={id:""}){this.VERSION=LH,this._startTs=Rg(),this._deltaTs=Rg(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new $ue(`__probe-${this.id}__`,Xue),this.timeStamp(`${this.id} started`),Kue(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Rg()-this._startTs).toPrecision(10))}getDelta(){return Number((Rg()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){if(!e)throw new Error(t||"Assertion failed")}warn(e){return this._getLogFunction(0,e,kg.warn,arguments,Z4)}error(e){return this._getLogFunction(0,e,kg.error,arguments)}deprecated(e,t){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${t}\` instead`)}removed(e,t){return this.error(`\`${e}\` has been removed. Use \`${t}\` instead`)}probe(e,t){return this._getLogFunction(e,t,kg.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,kg.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){return this._getLogFunction(e,t,kg.debug||kg.info,arguments,Z4)}table(e,t,n){return t?this._getLogFunction(e,t,console.table||Og,n&&[n],{tag:que(t)}):Og}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||Og)}group(e,t,n={collapsed:!1}){const i=Q4({logLevel:e,message:t,opts:n}),{collapsed:s}=n;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,t,n={}){return this.group(e,t,Object.assign({},n,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Og)}withGroup(e,t,n){this.group(e,t)();try{n()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=NH(e)}_getLogFunction(e,t,n,i,s){if(this._shouldLog(e)){s=Q4({logLevel:e,message:t,args:i,opts:s}),n=n||s.method,Nk(n),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Rg();const a=s.tag||s.message;if(s.once&&a)if(!Y4[a])Y4[a]=Rg();else return Og;return t=Jue(this.id,s.message,s),n.bind(console,t,...s.args)}return Og}}Ey.VERSION=LH;function NH(r){if(!r)return 0;let e;switch(typeof r){case"number":e=r;break;case"object":e=r.logLevel||r.priority||0;break;default:return 0}return Nk(Number.isFinite(e)&&e>=0),e}function Q4(r){const{logLevel:e,message:t}=r;r.logLevel=NH(e);const n=r.args?Array.from(r.args):[];for(;n.length&&n.shift()!==t;);switch(typeof e){case"string":case"function":t!==void 0&&n.unshift(t),r.message=e;break;case"object":Object.assign(r,e);break}typeof r.message=="function"&&(r.message=r.message());const i=typeof r.message;return Nk(i==="string"||i==="object"),Object.assign(r,{args:n},r.opts)}function Jue(r,e,t){if(typeof e=="string"){const n=t.time?Gue(jue(t.total)):"";e=t.time?`${r}: ${n}  ${e}`:`${r}: ${e}`,e=Wue(e,t.color,t.background)}return e}function que(r){for(const e in r)for(const t in r[e])return t||"untitled";return"empty"}globalThis.probe={};const FH=new Ey({id:"@probe.gl/log"}),cI="4.3.3",Yue=cI[0]>="0"&&cI[0]<="9"?`v${cI}`:"";function Zue(){const r=new Ey({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=r,globalThis.loaders.version=Yue,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=r,r}const Que=Zue();function UH(r,e){return zH(r||{},e)}function zH(r,e,t=0){if(t>3)return e;const n={...r};for(const[i,s]of Object.entries(e))s&&typeof s=="object"&&!Array.isArray(s)?n[i]=zH(n[i]||{},e[i],t+1):n[i]=e[i];return n}function ehe(r){var e;globalThis.loaders||(globalThis.loaders={}),(e=globalThis.loaders).modules||(e.modules={}),Object.assign(globalThis.loaders.modules,r)}function the(r){return globalThis.loaders?.modules?.[r]||null}const rhe="latest";function nhe(){return globalThis._loadersgl_?.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.3"),globalThis._loadersgl_.version}const VH=nhe();function qu(r,e){if(!r)throw new Error(e||"loaders.gl assertion failed.")}const pl=typeof process!="object"||String(process)!=="[object process]"||process.browser,Fk=typeof importScripts=="function",ihe=typeof window<"u"&&typeof window.orientation<"u",e6=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);e6&&parseFloat(e6[1]);class she{constructor(e,t){H(this,"name");H(this,"workerThread");H(this,"isRunning",!0);H(this,"result");H(this,"_resolve",()=>{});H(this,"_reject",()=>{});this.name=e,this.workerThread=t,this.result=new Promise((n,i)=>{this._resolve=n,this._reject=i})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){qu(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){qu(this.isRunning),this.isRunning=!1,this._reject(e)}}const uI=Vte.Worker,hI=new Map;function ohe(r){qu(r.source&&!r.url||!r.source&&r.url);let e=hI.get(r.source||r.url);return e||(r.url&&(e=ahe(r.url),hI.set(r.url,e)),r.source&&(e=$H(r.source),hI.set(r.source,e))),qu(e),e}function ahe(r){if(!r.startsWith("http"))return r;const e=lhe(r);return $H(e)}function $H(r){const e=new Blob([r],{type:"application/javascript"});return URL.createObjectURL(e)}function lhe(r){return`try {
  importScripts('${r}');
} catch (error) {
  console.error(error);
  throw error;
}`}function jH(r,e=!0,t){const n=t||new Set;if(r){if(t6(r))n.add(r);else if(t6(r.buffer))n.add(r.buffer);else if(!ArrayBuffer.isView(r)){if(e&&typeof r=="object")for(const i in r)jH(r[i],e,n)}}return t===void 0?Array.from(n):[]}function t6(r){return r?r instanceof ArrayBuffer||typeof MessagePort<"u"&&r instanceof MessagePort||typeof ImageBitmap<"u"&&r instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas:!1}const dI=()=>{};class H3{constructor(e){H(this,"name");H(this,"source");H(this,"url");H(this,"terminated",!1);H(this,"worker");H(this,"onMessage");H(this,"onError");H(this,"_loadableURL","");const{name:t,source:n,url:i}=e;qu(n||i),this.name=t,this.source=n,this.url=i,this.onMessage=dI,this.onError=s=>console.log(s),this.worker=pl?this._createBrowserWorker():this._createNodeWorker()}static isSupported(){return typeof Worker<"u"&&pl||typeof uI<"u"&&!pl}destroy(){this.onMessage=dI,this.onError=dI,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,t){t=t||jH(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+=`worker ${this.name} from ${this.url}. `,e.message&&(t+=`${e.message} in `),e.lineno&&(t+=`:${e.lineno}:${e.colno}`),new Error(t)}_createBrowserWorker(){this._loadableURL=ohe({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},e.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},e.onmessageerror=t=>console.error(t),e}_createNodeWorker(){let e;if(this.url){const n=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new uI(n,{eval:!1})}else if(this.source)e=new uI(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",t=>{this.onMessage(t)}),e.on("error",t=>{this.onError(t)}),e.on("exit",t=>{}),e}}class che{constructor(e){H(this,"name","unnamed");H(this,"source");H(this,"url");H(this,"maxConcurrency",1);H(this,"maxMobileConcurrency",1);H(this,"onDebug",()=>{});H(this,"reuseWorkers",!0);H(this,"props",{});H(this,"jobQueue",[]);H(this,"idleQueue",[]);H(this,"count",0);H(this,"isDestroyed",!1);this.source=e.source,this.url=e.url,this.setProps(e)}static isSupported(){return H3.isSupported()}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,t=(i,s,a)=>i.done(a),n=(i,s)=>i.error(s)){const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:t,onError:n,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:"Starting job",name:t.name,workerThread:e,backlog:this.jobQueue.length});const n=new she(t.name,e);e.onMessage=i=>t.onMessage(n,i.type,i.payload),e.onError=i=>t.onError(n,i),t.onStart(n);try{await n.result}catch(i){console.error(`Worker exception: ${i}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!pl||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new H3({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return ihe?this.maxMobileConcurrency:this.maxConcurrency}}const uhe={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}},ed=class ed{constructor(e){H(this,"props");H(this,"workerPools",new Map);this.props={...uhe},this.setProps(e),this.workerPools=new Map}static isSupported(){return H3.isSupported()}static getWorkerFarm(e={}){return ed._workerFarm=ed._workerFarm||new ed({}),ed._workerFarm.setProps(e),ed._workerFarm}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:n,url:i}=e;let s=this.workerPools.get(t);return s||(s=new che({name:t,source:n,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}};H(ed,"_workerFarm");let TC=ed;function hhe(r,e={}){const t=e[r.id]||{},n=pl?`${r.id}-worker.js`:`${r.id}-worker-node.js`;let i=t.workerUrl;if(!i&&r.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(pl?i=`modules/${r.module}/dist/${n}`:i=`modules/${r.module}/src/workers/${r.id}-worker-node.ts`),!i){let s=r.version;s==="latest"&&(s=rhe);const a=s?`@${s}`:"";i=`https://unpkg.com/@loaders.gl/${r.module}${a}/dist/${n}`}return qu(i),i}function dhe(r,e=VH){qu(r,"no worker provided");const t=r.version;return!(!e||!t)}const fI={};async function Xf(r,e=null,t={},n=null){return e&&(r=fhe(r,e,t,n)),fI[r]=fI[r]||phe(r),await fI[r]}function fhe(r,e,t={},n=null){if(!t.useLocalLibraries&&r.startsWith("http"))return r;n=n||r;const i=t.modules||{};return i[n]?i[n]:pl?t.CDN?(qu(t.CDN.startsWith("http")),`${t.CDN}/${e}@${VH}/dist/libs/${n}`):Fk?`../src/libs/${n}`:`modules/${e}/src/libs/${n}`:`modules/${e}/dist/libs/${n}`}async function phe(r){if(r.endsWith("wasm"))return await mhe(r);if(!pl)try{const{requireFromFile:t}=globalThis.loaders||{};return await t?.(r)}catch(t){return console.error(t),null}if(Fk)return importScripts(r);const e=await yhe(r);return ghe(e,r)}function ghe(r,e){if(!pl){const{requireFromString:n}=globalThis.loaders||{};return n?.(r,e)}if(Fk)return eval.call(globalThis,r),null;const t=document.createElement("script");t.id=e;try{t.appendChild(document.createTextNode(r))}catch{t.text=r}return document.body.appendChild(t),null}async function mhe(r){const{readFileAsArrayBuffer:e}=globalThis.loaders||{};return pl||!e||r.startsWith("http")?await(await fetch(r)).arrayBuffer():await e(r)}async function yhe(r){const{readFileAsText:e}=globalThis.loaders||{};return pl||!e||r.startsWith("http")?await(await fetch(r)).text():await e(r)}function bhe(r,e){return!TC.isSupported()||!pl&&!e?._nodeWorkers?!1:r.worker&&e?.worker}async function _he(r,e,t,n,i){const s=r.id,a=hhe(r,t),u=TC.getWorkerFarm(t).getWorkerPool({name:s,url:a});t=JSON.parse(JSON.stringify(t)),n=JSON.parse(JSON.stringify(n||{}));const f=await u.startJob("process-on-worker",vhe.bind(null,i));return f.postMessage("process",{input:e,options:t,context:n}),await(await f.result).result}async function vhe(r,e,t,n){switch(t){case"done":e.done(n);break;case"error":e.error(new Error(n.error));break;case"process":const{id:i,input:s,options:a}=n;try{const o=await r(s,a);e.postMessage("done",{id:i,result:o})}catch(o){const u=o instanceof Error?o.message:"unknown error";e.postMessage("error",{id:i,error:u})}break;default:console.warn(`parse-with-worker unknown message ${t}`)}}function Ahe(r,e=5){return typeof r=="string"?r.slice(0,e):ArrayBuffer.isView(r)?r6(r.buffer,r.byteOffset,e):r instanceof ArrayBuffer?r6(r,0,e):""}function r6(r,e,t){if(r.byteLength<=e+t)return"";const n=new DataView(r);let i="";for(let s=0;s<t;s++)i+=String.fromCharCode(n.getUint8(e+s));return i}function xhe(r){try{return JSON.parse(r)}catch{throw new Error(`Failed to parse JSON from data starting with "${Ahe(r)}"`)}}function whe(r,e,t){if(t=t||r.byteLength,r.byteLength<t||e.byteLength<t)return!1;const n=new Uint8Array(r),i=new Uint8Array(e);for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}function Che(...r){return The(r)}function The(r){const e=r.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),t=e.reduce((s,a)=>s+a.byteLength,0),n=new Uint8Array(t);let i=0;for(const s of e)n.set(s,i),i+=s.byteLength;return n.buffer}function Uk(r,e,t){const n=t!==void 0?new Uint8Array(r).subarray(e,e+t):new Uint8Array(r).subarray(e);return new Uint8Array(n).buffer}function Kv(r,e){return ci(r>=0),ci(e>0),r+(e-1)&-4}function She(r,e,t){let n;if(r instanceof ArrayBuffer)n=new Uint8Array(r);else{const i=r.byteOffset,s=r.byteLength;n=new Uint8Array(r.buffer||r.arrayBuffer,i,s)}return e.set(n,t),t+Kv(n.byteLength,4)}async function Ehe(r){const e=[];for await(const t of r)e.push(t);return Che(...e)}function n6(){let r;if(typeof window<"u"&&window.performance)r=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();r=e[0]*1e3+e[1]/1e6}else r=Date.now();return r}class i6{constructor(e,t){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=t,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=n6(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(n6()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class Iy{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e,t="count"){return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const t of Object.values(this.stats))e(t)}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(t=>this._getOrCreate(t))}_getOrCreate(e){const{name:t,type:n}=e;let i=this.stats[t];return i||(e instanceof i6?i=e:i=new i6(t,n),this.stats[t]=i),i}}const Ihe="Queued Requests",Phe="Active Requests",Bhe="Cancelled Requests",Mhe="Queued Requests Ever",Rhe="Active Requests Ever",khe={id:"request-scheduler",throttleRequests:!0,maxRequests:6,debounceTime:0};class GH{constructor(e={}){H(this,"props");H(this,"stats");H(this,"activeRequestCount",0);H(this,"requestQueue",[]);H(this,"requestMap",new Map);H(this,"updateTimer",null);this.props={...khe,...e},this.stats=new Iy({id:this.props.id}),this.stats.get(Ihe),this.stats.get(Phe),this.stats.get(Bhe),this.stats.get(Mhe),this.stats.get(Rhe)}scheduleRequest(e,t=()=>0){if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const n={handle:e,priority:0,getPriority:t},i=new Promise(s=>(n.resolve=s,n));return this.requestQueue.push(n),this.requestMap.set(e,i),this._issueNewRequests(),i}_issueRequest(e){const{handle:t,resolve:n}=e;let i=!1;const s=()=>{i||(i=!0,this.requestMap.delete(t),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,n?n({done:s}):Promise.resolve({done:s})}_issueNewRequests(){this.updateTimer!==null&&clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>this._issueNewRequestsAsync(),this.props.debounceTime)}_issueNewRequestsAsync(){this.updateTimer!==null&&clearTimeout(this.updateTimer),this.updateTimer=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(e!==0){this._updateAllRequests();for(let t=0;t<e;++t){const n=this.requestQueue.shift();n&&this._issueRequest(n)}}}_updateAllRequests(){const e=this.requestQueue;for(let t=0;t<e.length;++t){const n=e[t];this._updateRequest(n)||(e.splice(t,1),this.requestMap.delete(n.handle),t--)}e.sort((t,n)=>t.priority-n.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),e.priority<0?(e.resolve(null),!1):!0}}let Ohe="";const s6={};function Dhe(r){for(const e in s6)if(r.startsWith(e)){const t=s6[e];r=r.replace(e,t)}return!r.startsWith("http://")&&!r.startsWith("https://")&&(r=`${Ohe}${r}`),r}function Lhe(r){return Buffer.isBuffer(r)?new Uint8Array(r.buffer,r.byteOffset,r.length).slice().buffer:r}function Nhe(r){return r&&typeof r=="object"&&r.isBuffer}function HH(r){if(Nhe(r))return Lhe(r);if(r instanceof ArrayBuffer)return r;if(ArrayBuffer.isView(r))return r.byteOffset===0&&r.byteLength===r.buffer.byteLength?r.buffer:r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength);if(typeof r=="string"){const e=r;return new TextEncoder().encode(e).buffer}if(r&&typeof r=="object"&&r._toArrayBuffer)return r._toArrayBuffer();throw new Error("toArrayBuffer")}function Fhe(){if(typeof process<"u"&&typeof process.cwd<"u")return process.cwd();const r=window.location?.pathname;return r?.slice(0,r.lastIndexOf("/")+1)||""}function WH(r){const e=r?r.lastIndexOf("/"):-1;return e>=0?r.substr(e+1):""}function zk(r){const e=r?r.lastIndexOf("/"):-1;return e>=0?r.substr(0,e):""}function Uhe(...r){const e=[];for(let s=0;s<r.length;s++)e[s]=r[s];let t="",n=!1,i;for(let s=e.length-1;s>=-1&&!n;s--){let a;s>=0?a=e[s]:(i===void 0&&(i=Fhe()),a=i),a.length!==0&&(t=`${a}/${t}`,n=a.charCodeAt(0)===w0)}return t=zhe(t,!n),n?`/${t}`:t.length>0?t:"."}const w0=47,pI=46;function zhe(r,e){let t="",n=-1,i=0,s,a=!1;for(let o=0;o<=r.length;++o){if(o<r.length)s=r.charCodeAt(o);else{if(s===w0)break;s=w0}if(s===w0){if(!(n===o-1||i===1))if(n!==o-1&&i===2){if(t.length<2||!a||t.charCodeAt(t.length-1)!==pI||t.charCodeAt(t.length-2)!==pI){if(t.length>2){const u=t.length-1;let f=u;for(;f>=0&&t.charCodeAt(f)!==w0;--f);if(f!==u){t=f===-1?"":t.slice(0,f),n=o,i=0,a=!1;continue}}else if(t.length===2||t.length===1){t="",n=o,i=0,a=!1;continue}}e&&(t.length>0?t+="/..":t="..",a=!0)}else{const u=r.slice(n+1,o);t.length>0?t+=`/${u}`:t=u,a=!1}n=o,i=0}else s===pI&&i!==-1?++i:i=-1}return t}class Vhe{constructor(e){H(this,"fetch");H(this,"loadOptions");H(this,"_needsRefresh",!0);H(this,"props");this.props={...e},this.loadOptions={...e.loadOptions},this.fetch=$he(this.loadOptions)}setProps(e){this.props=Object.assign(this.props,e),this.setNeedsRefresh()}setNeedsRefresh(){this._needsRefresh=!0}getNeedsRefresh(e=!0){const t=this._needsRefresh;return e&&(this._needsRefresh=!1),t}}function $he(r){const e=r?.fetch;if(e&&typeof e=="function")return(n,i)=>e(n,i);const t=r?.fetch;return t&&typeof t!="function"?n=>fetch(n,t):n=>fetch(n)}class V_ extends Vhe{}H(V_,"type","template"),H(V_,"testURL",e=>!1);const jhe=r=>typeof r=="boolean",X0=r=>typeof r=="function",Xv=r=>r!==null&&typeof r=="object",o6=r=>Xv(r)&&r.constructor==={}.constructor,Ghe=r=>!!r&&typeof r[Symbol.iterator]=="function",Hhe=r=>r&&typeof r[Symbol.asyncIterator]=="function",vp=r=>typeof Response<"u"&&r instanceof Response||r&&r.arrayBuffer&&r.text&&r.json,Ap=r=>typeof Blob<"u"&&r instanceof Blob,Whe=r=>r&&typeof r=="object"&&r.isBuffer,Khe=r=>typeof ReadableStream<"u"&&r instanceof ReadableStream||Xv(r)&&X0(r.tee)&&X0(r.cancel)&&X0(r.getReader),Xhe=r=>Xv(r)&&X0(r.read)&&X0(r.pipe)&&jhe(r.readable),KH=r=>Khe(r)||Xhe(r);class Jhe extends Error{constructor(t,n){super(t);H(this,"reason");H(this,"url");H(this,"response");this.reason=n.reason,this.url=n.url,this.response=n.response}}const qhe=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Yhe=/^([-\w.]+\/[-\w.+]+)/;function a6(r,e){return r.toLowerCase()===e.toLowerCase()}function Zhe(r){const e=Yhe.exec(r);return e?e[1]:r}function l6(r){const e=qhe.exec(r);return e?e[1]:""}const XH=/\?.*/;function Qhe(r){const e=r.match(XH);return e&&e[0]}function Vk(r){return r.replace(XH,"")}function ede(r){if(r.length<50)return r;const e=r.slice(r.length-15);return`${r.substr(0,32)}...${e}`}function OS(r){return vp(r)?r.url:Ap(r)?r.name||"":typeof r=="string"?r:""}function $k(r){if(vp(r)){const e=r,t=e.headers.get("content-type")||"",n=Vk(e.url);return Zhe(t)||l6(n)}return Ap(r)?r.type||"":typeof r=="string"?l6(r):""}function tde(r){return vp(r)?r.headers["content-length"]||-1:Ap(r)?r.size:typeof r=="string"?r.length:r instanceof ArrayBuffer||ArrayBuffer.isView(r)?r.byteLength:-1}async function JH(r){if(vp(r))return r;const e={},t=tde(r);t>=0&&(e["content-length"]=String(t));const n=OS(r),i=$k(r);i&&(e["content-type"]=i);const s=await ide(r);s&&(e["x-first-bytes"]=s),typeof r=="string"&&(r=new TextEncoder().encode(r));const a=new Response(r,{headers:e});return Object.defineProperty(a,"url",{value:n}),a}async function rde(r){if(!r.ok)throw await nde(r)}async function nde(r){const e=ede(r.url);let t=`Failed to fetch resource (${r.status}) ${r.statusText}: ${e}`;t=t.length>100?`${t.slice(0,100)}...`:t;const n={reason:r.statusText,url:r.url,response:r};try{const i=r.headers.get("Content-Type");n.reason=!r.bodyUsed&&i?.includes("application/json")?await r.json():await r.text()}catch{}return new Jhe(t,n)}async function ide(r){if(typeof r=="string")return`data:,${r.slice(0,5)}`;if(r instanceof Blob){const t=r.slice(0,5);return await new Promise(n=>{const i=new FileReader;i.onload=s=>n(s?.target?.result),i.readAsDataURL(t)})}if(r instanceof ArrayBuffer){const t=r.slice(0,5);return`data:base64,${sde(t)}`}return null}function sde(r){let e="";const t=new Uint8Array(r);for(let n=0;n<t.byteLength;n++)e+=String.fromCharCode(t[n]);return btoa(e)}function ode(r){return!ade(r)&&!lde(r)}function ade(r){return r.startsWith("http:")||r.startsWith("https:")}function lde(r){return r.startsWith("data:")}async function c6(r,e){if(typeof r=="string"){const t=Dhe(r);return ode(t)&&globalThis.loaders?.fetchNode?globalThis.loaders?.fetchNode(t,e):await fetch(t,e)}return await JH(r)}const u6=new Ey({id:"loaders.gl"});class cde{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class ude{constructor(){H(this,"console");this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}}const qH={fetch:null,mimeType:void 0,nothrow:!1,log:new ude,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:kS,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},hde={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function YH(){globalThis.loaders=globalThis.loaders||{};const{loaders:r}=globalThis;return r._state||(r._state={}),r._state}function ZH(){const r=YH();return r.globalOptions=r.globalOptions||{...qH},r.globalOptions}function dde(r,e,t,n){return t=t||[],t=Array.isArray(t)?t:[t],fde(r,t),gde(e,r,n)}function fde(r,e){h6(r,null,qH,hde,e);for(const t of e){const n=r&&r[t.id]||{},i=t.options&&t.options[t.id]||{},s=t.deprecatedOptions&&t.deprecatedOptions[t.id]||{};h6(n,t.id,i,s,e)}}function h6(r,e,t,n,i){const s=e||"Top level",a=e?`${e}.`:"";for(const o in r){const u=!e&&Xv(r[o]),f=o==="baseUri"&&!e,g=o==="workerUrl"&&e;if(!(o in t)&&!f&&!g){if(o in n)u6.warn(`${s} loader option '${a}${o}' no longer supported, use '${n[o]}'`)();else if(!u){const y=pde(o,i);u6.warn(`${s} loader option '${a}${o}' not recognized. ${y}`)()}}}}function pde(r,e){const t=r.toLowerCase();let n="";for(const i of e)for(const s in i.options){if(r===s)return`Did you mean '${i.id}.${s}'?`;const a=s.toLowerCase();(t.startsWith(a)||a.startsWith(t))&&(n=n||`Did you mean '${i.id}.${s}'?`)}return n}function gde(r,e,t){const i={...r.options||{}};return mde(i,t),i.log===null&&(i.log=new cde),d6(i,ZH()),d6(i,e),i}function d6(r,e){for(const t in e)if(t in e){const n=e[t];o6(n)&&o6(r[t])?r[t]={...r[t],...e[t]}:r[t]=e[t]}}function mde(r,e){e&&!("baseUri"in r)&&(r.baseUri=e)}function jk(r){return r?(Array.isArray(r)&&(r=r[0]),Array.isArray(r?.extensions)):!1}function Gk(r){ci(r,"null loader"),ci(jk(r),"invalid loader");let e;return Array.isArray(r)&&(e=r[1],r=r[0],r={...r,options:{...r.options,...e}}),(r?.parseTextSync||r?.parseText)&&(r.text=!0),r.text||(r.binary=!0),r}const QH=()=>{const r=YH();return r.loaderRegistry=r.loaderRegistry||[],r.loaderRegistry};function yde(r){const e=QH();r=Array.isArray(r)?r:[r];for(const t of r){const n=Gk(t);e.find(i=>n===i)||e.unshift(n)}}function bde(){return QH()}const _de=/\.([^.]+)$/;async function vde(r,e=[],t,n){if(!eW(r))return null;let i=f6(r,e,{...t,nothrow:!0},n);if(i)return i;if(Ap(r)&&(r=await r.slice(0,10).arrayBuffer(),i=f6(r,e,t,n)),!i&&!t?.nothrow)throw new Error(tW(r));return i}function f6(r,e=[],t,n){if(!eW(r))return null;if(e&&!Array.isArray(e))return Gk(e);let i=[];e&&(i=i.concat(e)),t?.ignoreRegisteredLoaders||i.push(...bde()),xde(i);const s=Ade(r,i,t,n);if(!s&&!t?.nothrow)throw new Error(tW(r));return s}function Ade(r,e,t,n){const i=OS(r),s=$k(r),a=Vk(i)||n?.url;let o=null,u="";return t?.mimeType&&(o=gI(e,t?.mimeType),u=`match forced by supplied MIME type ${t?.mimeType}`),o=o||wde(e,a),u=u||(o?`matched url ${a}`:""),o=o||gI(e,s),u=u||(o?`matched MIME type ${s}`:""),o=o||Tde(e,r),u=u||(o?`matched initial data ${rW(r)}`:""),t?.fallbackMimeType&&(o=o||gI(e,t?.fallbackMimeType),u=u||(o?`matched fallback MIME type ${s}`:"")),u&&Que.log(1,`selectLoader selected ${o?.name}: ${u}.`),o}function eW(r){return!(r instanceof Response&&r.status===204)}function tW(r){const e=OS(r),t=$k(r);let n="No valid loader found (";n+=e?`${WH(e)}, `:"no url provided, ",n+=`MIME type: ${t?`"${t}"`:"not provided"}, `;const i=r?rW(r):"";return n+=i?` first bytes: "${i}"`:"first bytes: not available",n+=")",n}function xde(r){for(const e of r)Gk(e)}function wde(r,e){const t=e&&_de.exec(e),n=t&&t[1];return n?Cde(r,n):null}function Cde(r,e){e=e.toLowerCase();for(const t of r)for(const n of t.extensions)if(n.toLowerCase()===e)return t;return null}function gI(r,e){for(const t of r)if(t.mimeTypes?.some(n=>a6(e,n))||a6(e,`application/x.${t.id}`))return t;return null}function Tde(r,e){if(!e)return null;for(const t of r)if(typeof e=="string"){if(Sde(e,t))return t}else if(ArrayBuffer.isView(e)){if(p6(e.buffer,e.byteOffset,t))return t}else if(e instanceof ArrayBuffer&&p6(e,0,t))return t;return null}function Sde(r,e){return e.testText?e.testText(r):(Array.isArray(e.tests)?e.tests:[e.tests]).some(n=>r.startsWith(n))}function p6(r,e,t){return(Array.isArray(t.tests)?t.tests:[t.tests]).some(i=>Ede(r,e,t,i))}function Ede(r,e,t,n){if(n instanceof ArrayBuffer)return whe(n,r,n.byteLength);switch(typeof n){case"function":return n(r);case"string":const i=W3(r,e,n.length);return n===i;default:return!1}}function rW(r,e=5){return typeof r=="string"?r.slice(0,e):ArrayBuffer.isView(r)?W3(r.buffer,r.byteOffset,e):r instanceof ArrayBuffer?W3(r,0,e):""}function W3(r,e,t){if(r.byteLength<e+t)return"";const n=new DataView(r);let i="";for(let s=0;s<t;s++)i+=String.fromCharCode(n.getUint8(e+s));return i}const Ide=256*1024;function*Pde(r,e){const t=e?.chunkSize||Ide;let n=0;const i=new TextEncoder;for(;n<r.length;){const s=Math.min(r.length-n,t),a=r.slice(n,n+s);n+=s,yield i.encode(a)}}const Bde=256*1024;function*Mde(r,e={}){const{chunkSize:t=Bde}=e;let n=0;for(;n<r.byteLength;){const i=Math.min(r.byteLength-n,t),s=new ArrayBuffer(i),a=new Uint8Array(r,n,i);new Uint8Array(s).set(a),n+=i,yield s}}const Rde=1024*1024;async function*kde(r,e){const t=e?.chunkSize||Rde;let n=0;for(;n<r.size;){const i=n+t,s=await r.slice(n,i).arrayBuffer();n=i,yield s}}function g6(r,e){return kS?Ode(r,e):Dde(r)}async function*Ode(r,e){const t=r.getReader();let n;try{for(;;){const i=n||t.read();e?._streamReadAhead&&(n=t.read());const{done:s,value:a}=await i;if(s)return;yield HH(a)}}catch{t.releaseLock()}}async function*Dde(r,e){for await(const t of r)yield HH(t)}function Lde(r,e){if(typeof r=="string")return Pde(r,e);if(r instanceof ArrayBuffer)return Mde(r,e);if(Ap(r))return kde(r,e);if(KH(r))return g6(r,e);if(vp(r))return g6(r.body,e);throw new Error("makeIterator")}const nW="Cannot convert supplied data type";function Nde(r,e,t){if(e.text&&typeof r=="string")return r;if(Whe(r)&&(r=r.buffer),r instanceof ArrayBuffer){const n=r;return e.text&&!e.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(r)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(r);let n=r.buffer;const i=r.byteLength||r.length;return(r.byteOffset!==0||i!==n.byteLength)&&(n=n.slice(r.byteOffset,r.byteOffset+i)),n}throw new Error(nW)}async function Fde(r,e,t){const n=r instanceof ArrayBuffer||ArrayBuffer.isView(r);if(typeof r=="string"||n)return Nde(r,e);if(Ap(r)&&(r=await JH(r)),vp(r)){const i=r;return await rde(i),e.binary?await i.arrayBuffer():await i.text()}if(KH(r)&&(r=Lde(r,t)),Ghe(r)||Hhe(r))return Ehe(r);throw new Error(nW)}function iW(r,e){const t=ZH(),n=r||t;return typeof n.fetch=="function"?n.fetch:Xv(n.fetch)?i=>c6(i,n.fetch):e?.fetch?e?.fetch:c6}function Ude(r,e,t){if(t)return t;const n={fetch:iW(e,r),...r};if(n.url){const i=Vk(n.url);n.baseUrl=i,n.queryString=Qhe(n.url),n.filename=WH(i),n.baseUrl=zk(i)}return Array.isArray(n.loaders)||(n.loaders=null),n}function zde(r,e){if(r&&!Array.isArray(r))return r;let t;if(r&&(t=Array.isArray(r)?r:[r]),e&&e.loaders){const n=Array.isArray(e.loaders)?e.loaders:[e.loaders];t=t?[...t,...n]:n}return t&&t.length?t:void 0}async function SC(r,e,t,n){e&&!Array.isArray(e)&&!jk(e)&&(n=void 0,t=e,e=void 0),r=await r,t=t||{};const i=OS(r),a=zde(e,n),o=await vde(r,a,t);return o?(t=dde(t,o,a,i),n=Ude({url:i,_parse:SC,loaders:a},t,n||null),await Vde(o,r,t,n)):null}async function Vde(r,e,t,n){if(dhe(r),t=UH(r.options,t),vp(e)){const s=e,{ok:a,redirected:o,status:u,statusText:f,type:g,url:y}=s,A=Object.fromEntries(s.headers.entries());n.response={headers:A,ok:a,redirected:o,status:u,statusText:f,type:g,url:y}}e=await Fde(e,r,t);const i=r;if(i.parseTextSync&&typeof e=="string")return i.parseTextSync(e,t,n);if(bhe(r,t))return await _he(r,e,t,n,SC);if(i.parseText&&typeof e=="string")return await i.parseText(e,t,n);if(i.parse)return await i.parse(e,t,n);throw qu(!i.parseSync),new Error(`${r.id} loader - no parser found and worker is disabled`)}function $de(r){switch(r.constructor){case Int8Array:return"int8";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int16Array:return"int16";case Uint16Array:return"uint16";case Int32Array:return"int32";case Uint32Array:return"uint32";case Float32Array:return"float32";case Float64Array:return"float64";default:return"null"}}function sW(r){let e=1/0,t=1/0,n=1/0,i=-1/0,s=-1/0,a=-1/0;const o=r.POSITION?r.POSITION.value:[],u=o&&o.length;for(let f=0;f<u;f+=3){const g=o[f],y=o[f+1],A=o[f+2];e=g<e?g:e,t=y<t?y:t,n=A<n?A:n,i=g>i?g:i,s=y>s?y:s,a=A>a?A:a}return[[e,t,n],[i,s,a]]}function jde(r,e,t){const n=$de(e.value),i=t||Gde(e);return{name:r,type:{type:"fixed-size-list",listSize:e.size,children:[{name:"value",type:n}]},nullable:!1,metadata:i}}function Gde(r){const e={};return"byteOffset"in r&&(e.byteOffset=r.byteOffset.toString(10)),"byteStride"in r&&(e.byteStride=r.byteStride.toString(10)),"normalized"in r&&(e.normalized=r.normalized.toString()),e}async function Yu(r,e,t,n){let i,s;!Array.isArray(e)&&!jk(e)?(i=[],s=e):(i=e,s=t);const a=iW(s);let o=r;return typeof r=="string"&&(o=await a(r)),Ap(r)&&(o=await a(r)),Array.isArray(i)?await SC(o,i,s):await SC(o,i,s)}const Hde="4.3.3",Wde=globalThis.loaders?.parseImageNode,K3=typeof Image<"u",X3=typeof ImageBitmap<"u",Kde=!!Wde,J3=kS?!0:Kde;function Xde(r){switch(r){case"auto":return X3||K3||J3;case"imagebitmap":return X3;case"image":return K3;case"data":return J3;default:throw new Error(`@loaders.gl/images: image ${r} not supported in this environment`)}}function Jde(){if(X3)return"imagebitmap";if(K3)return"image";if(J3)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function qde(r){const e=Yde(r);if(!e)throw new Error("Not an image");return e}function oW(r){switch(qde(r)){case"data":return r;case"image":case"imagebitmap":const e=document.createElement("canvas"),t=e.getContext("2d");if(!t)throw new Error("getImageData");return e.width=r.width,e.height=r.height,t.drawImage(r,0,0),t.getImageData(0,0,r.width,r.height);default:throw new Error("getImageData")}}function Yde(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&r instanceof Image?"image":r&&typeof r=="object"&&r.data&&r.width&&r.height?"data":null}const Zde=/^data:image\/svg\+xml/,Qde=/\.svg((\?|#).*)?$/;function Hk(r){return r&&(Zde.test(r)||Qde.test(r))}function efe(r,e){if(Hk(e)){let n=new TextDecoder().decode(r);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(n=unescape(encodeURIComponent(n)))}catch(s){throw new Error(s.message)}return`data:image/svg+xml;base64,${btoa(n)}`}return aW(r,e)}function aW(r,e){if(Hk(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(r)])}async function lW(r,e,t){const n=efe(r,t),i=self.URL||self.webkitURL,s=typeof n!="string"&&i.createObjectURL(n);try{return await tfe(s||n,e)}finally{s&&i.revokeObjectURL(s)}}async function tfe(r,e){const t=new Image;return t.src=r,e.image&&e.image.decode&&t.decode?(await t.decode(),t):await new Promise((n,i)=>{try{t.onload=()=>n(t),t.onerror=s=>{const a=s instanceof Error?s.message:"error";i(new Error(a))}}catch(s){i(s)}})}const rfe={};let m6=!0;async function nfe(r,e,t){let n;Hk(t)?n=await lW(r,e,t):n=aW(r,t);const i=e&&e.imagebitmap;return await ife(n,i)}async function ife(r,e=null){if((sfe(e)||!m6)&&(e=null),e)try{return await createImageBitmap(r,e)}catch(t){console.warn(t),m6=!1}return await createImageBitmap(r)}function sfe(r){for(const e in r||rfe)return!1;return!0}function ofe(r){return!ufe(r,"ftyp",4)||!(r[8]&96)?null:afe(r)}function afe(r){switch(lfe(r,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function lfe(r,e,t){return String.fromCharCode(...r.slice(e,t))}function cfe(r){return[...r].map(e=>e.charCodeAt(0))}function ufe(r,e,t=0){const n=cfe(e);for(let i=0;i<n.length;++i)if(n[i]!==r[i+t])return!1;return!0}const Lc=!1,J0=!0;function Wk(r){const e=Jv(r);return dfe(e)||gfe(e)||ffe(e)||pfe(e)||hfe(e)}function hfe(r){const e=new Uint8Array(r instanceof DataView?r.buffer:r),t=ofe(e);return t?{mimeType:t.mimeType,width:0,height:0}:null}function dfe(r){const e=Jv(r);return e.byteLength>=24&&e.getUint32(0,Lc)===2303741511?{mimeType:"image/png",width:e.getUint32(16,Lc),height:e.getUint32(20,Lc)}:null}function ffe(r){const e=Jv(r);return e.byteLength>=10&&e.getUint32(0,Lc)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,J0),height:e.getUint16(8,J0)}:null}function pfe(r){const e=Jv(r);return e.byteLength>=14&&e.getUint16(0,Lc)===16973&&e.getUint32(2,J0)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,J0),height:e.getUint32(22,J0)}:null}function gfe(r){const e=Jv(r);if(!(e.byteLength>=3&&e.getUint16(0,Lc)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:n,sofMarkers:i}=mfe();let s=2;for(;s+9<e.byteLength;){const a=e.getUint16(s,Lc);if(i.has(a))return{mimeType:"image/jpeg",height:e.getUint16(s+5,Lc),width:e.getUint16(s+7,Lc)};if(!n.has(a))return null;s+=2,s+=e.getUint16(s,Lc)}return null}function mfe(){const r=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)r.add(t);return{tableMarkers:r,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Jv(r){if(r instanceof DataView)return r;if(ArrayBuffer.isView(r))return new DataView(r.buffer);if(r instanceof ArrayBuffer)return new DataView(r);throw new Error("toDataView")}async function yfe(r,e){const{mimeType:t}=Wk(r)||{},n=globalThis.loaders?.parseImageNode;return ci(n),await n(r,t)}async function bfe(r,e,t){e=e||{};const i=(e.image||{}).type||"auto",{url:s}=t||{},a=_fe(i);let o;switch(a){case"imagebitmap":o=await nfe(r,e,s);break;case"image":o=await lW(r,e,s);break;case"data":o=await yfe(r);break;default:ci(!1)}return i==="data"&&(o=oW(o)),o}function _fe(r){switch(r){case"auto":case"data":return Jde();default:return Xde(r),r}}const vfe=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],Afe=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],xfe={image:{type:"auto",decode:!0}},EC={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:Hde,mimeTypes:Afe,extensions:vfe,parse:bfe,tests:[r=>!!Wk(new DataView(r))],options:xfe},mI={};function wfe(r){if(mI[r]===void 0){const e=kS?Tfe(r):Cfe(r);mI[r]=e}return mI[r]}function Cfe(r){const e=["image/png","image/jpeg","image/gif"],t=globalThis.loaders?.imageFormatsNode||e;return!!globalThis.loaders?.parseImageNode&&t.includes(r)}function Tfe(r){switch(r){case"image/avif":case"image/webp":return Sfe(r);default:return!0}}function Sfe(r){try{return document.createElement("canvas").toDataURL(r).indexOf(`data:${r}`)===0}catch{return!1}}const Rr=new Ey({id:"deck"}),Uh={attributeUpdateStart:-1,attributeManagerUpdateStart:-1,attributeUpdateMessages:[]},yI=1,qb=2,bI=3,_I=4,Efe=2,Ife=r=>({"layer.changeFlag":(e,t,n)=>{r.log(bI,`${e.id} ${t}: `,n[t])()},"layer.initialize":e=>{r.log(yI,`Initializing ${e}`)()},"layer.update":(e,t)=>{if(t){const n=e.getChangeFlags();r.log(qb,`Updating ${e} because: ${Object.keys(n).filter(i=>n[i]).join(", ")}`)()}else r.log(_I,`${e} does not need update`)()},"layer.matched":(e,t)=>{t&&r.log(_I,`Matched ${e}, state transfered`)()},"layer.finalize":e=>{r.log(yI,`Finalizing ${e}`)()},"compositeLayer.renderLayers":(e,t,n)=>{t?r.log(qb,`Composite layer rendered new subLayers ${e}`,n)():r.log(_I,`Composite layer reused subLayers ${e}`,n)()},"layerManager.setLayers":(e,t,n)=>{t&&r.log(qb,`Updating ${n.length} deck layers`)()},"layerManager.activateViewport":(e,t)=>{r.log(bI,"Viewport changed",t)()},"attributeManager.invalidate":(e,t,n)=>{r.log(yI,n?`invalidated attributes ${n} (${t}) for ${e.id}`:`invalidated all attributes for ${e.id}`)()},"attributeManager.updateStart":e=>{Uh.attributeUpdateMessages.length=0,Uh.attributeManagerUpdateStart=Date.now()},"attributeManager.updateEnd":(e,t)=>{const n=Math.round(Date.now()-Uh.attributeManagerUpdateStart);r.groupCollapsed(qb,`Updated attributes for ${t} instances in ${e.id} in ${n}ms`)();for(const i of Uh.attributeUpdateMessages)r.log(bI,i)();r.groupEnd(qb)()},"attribute.updateStart":e=>{Uh.attributeUpdateStart=Date.now()},"attribute.allocate":(e,t)=>{const n=`${e.id} allocated ${t}`;Uh.attributeUpdateMessages.push(n)},"attribute.updateEnd":(e,t)=>{const n=Math.round(Date.now()-Uh.attributeUpdateStart),i=`${e.id} updated ${t} in ${n}ms`;Uh.attributeUpdateMessages.push(i)},"deckRenderer.renderLayers":(e,t,n)=>{const{pass:i,redrawReason:s,stats:a}=n;for(const o of t){const{totalCount:u,visibleCount:f,compositeCount:g,pickableCount:y}=o,C=u-g-f;r.log(Efe,`RENDER #${e.renderCount}   ${f} (of ${u} layers) to ${i} because ${s}   (${C} hidden, ${g} composite ${y} pickable)`)(),a&&a.get("Redraw Layers").add(f)}}});let IC={};process.env.NODE_ENV!=="production"&&(IC=Ife(Rr));function Pfe(r){IC=r}function bo(r,e,t,n){Rr.level>0&&IC[r]&&IC[r].call(null,e,t,n)}function Bfe(r){const e=r[0],t=r[r.length-1];return e==="{"&&t==="}"||e==="["&&t==="]"}const Mfe={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:Bfe,parseTextSync:JSON.parse};function Rfe(){const r="9.2.5",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==r)throw new Error(`deck.gl - multiple versions detected: ${e} vs ${r}`);return e||(Rr.log(1,`deck.gl ${r}`)(),globalThis.deck={...globalThis.deck,VERSION:r,version:r,log:Rr,_registerLoggers:Pfe},yde([Mfe,[EC,{imagebitmap:{premultiplyAlpha:"none"}}]])),r}const kfe=Rfe();function Kk(r,e){if(!r)throw new Error(e||"shadertools: assertion failed.")}const vI={number:{type:"number",validate(r,e){return Number.isFinite(r)&&typeof e=="object"&&(e.max===void 0||r<=e.max)&&(e.min===void 0||r>=e.min)}},array:{type:"array",validate(r,e){return Array.isArray(r)||ArrayBuffer.isView(r)}}};function Ofe(r){const e={};for(const[t,n]of Object.entries(r))e[t]=Dfe(n);return e}function Dfe(r){let e=y6(r);if(e!=="object")return{value:r,...vI[e],type:e};if(typeof r=="object")return r?r.type!==void 0?{...r,...vI[r.type],type:r.type}:r.value===void 0?{type:"object",value:r}:(e=y6(r.value),{...r,...vI[e],type:e}):{type:"object",value:null};throw new Error("props")}function y6(r){return Array.isArray(r)||ArrayBuffer.isView(r)?"array":typeof r}const Lfe=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,Nfe=`#ifdef MODULE_MATERIAL
  fragColor = material_filterColor(fragColor);
#endif

#ifdef MODULE_LIGHTING
  fragColor = lighting_filterColor(fragColor);
#endif

#ifdef MODULE_FOG
  fragColor = fog_filterColor(fragColor);
#endif

#ifdef MODULE_PICKING
  fragColor = picking_filterHighlightColor(fragColor);
  fragColor = picking_filterPickingColor(fragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,Ffe={vertex:Lfe,fragment:Nfe},b6=/void\s+main\s*\([^)]*\)\s*\{\n?/,_6=/}\n?[^{}]*$/,AI=[],bw="__LUMA_INJECT_DECLARATIONS__";function Ufe(r){const e={vertex:{},fragment:{}};for(const t in r){let n=r[t];const i=zfe(t);typeof n=="string"&&(n={order:0,injection:n}),e[i][t]=n}return e}function zfe(r){const e=r.slice(0,2);switch(e){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(e)}}function PC(r,e,t,n=!1){const i=e==="vertex";for(const s in t){const a=t[s];a.sort((u,f)=>u.order-f.order),AI.length=a.length;for(let u=0,f=a.length;u<f;++u)AI[u]=a[u].injection;const o=`${AI.join(`
`)}
`;switch(s){case"vs:#decl":i&&(r=r.replace(bw,o));break;case"vs:#main-start":i&&(r=r.replace(b6,u=>u+o));break;case"vs:#main-end":i&&(r=r.replace(_6,u=>o+u));break;case"fs:#decl":i||(r=r.replace(bw,o));break;case"fs:#main-start":i||(r=r.replace(b6,u=>u+o));break;case"fs:#main-end":i||(r=r.replace(_6,u=>o+u));break;default:r=r.replace(s,u=>u+o)}}return r=r.replace(bw,""),n&&(r=r.replace(/\}\s*$/,s=>s+Ffe[e])),r}function BC(r){r.map(e=>Vfe(e))}function Vfe(r){if(r.instance)return;BC(r.dependencies||[]);const{propTypes:e={},deprecations:t=[],inject:n={}}=r,i={normalizedInjections:Ufe(n),parsedDeprecations:$fe(t)};e&&(i.propValidators=Ofe(e)),r.instance=i;let s={};e&&(s=Object.entries(e).reduce((a,[o,u])=>{const f=u?.value;return f&&(a[o]=f),a},{})),r.defaultUniforms={...r.defaultUniforms,...s}}function cW(r,e,t){r.deprecations?.forEach(n=>{n.regex?.test(e)&&(n.deprecated?t.deprecated(n.old,n.new)():t.removed(n.old,n.new)())})}function $fe(r){return r.forEach(e=>{switch(e.type){case"function":e.regex=new RegExp(`\\b${e.old}\\(`);break;default:e.regex=new RegExp(`${e.type} ${e.old};`)}}),r}function Xk(r){BC(r);const e={},t={};uW({modules:r,level:0,moduleMap:e,moduleDepth:t});const n=Object.keys(t).sort((i,s)=>t[s]-t[i]).map(i=>e[i]);return BC(n),n}function uW(r){const{modules:e,level:t,moduleMap:n,moduleDepth:i}=r;if(t>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)n[s.name]=s,(i[s.name]===void 0||i[s.name]<t)&&(i[s.name]=t);for(const s of e)s.dependencies&&uW({modules:s.dependencies,level:t+1,moduleMap:n,moduleDepth:i})}function jfe(r){switch(r?.gpu.toLowerCase()){case"apple":return`#define APPLE_GPU
// Apple optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Headless Chrome's software shader 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// If the GPU doesn't have full 32 bits precision, will causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function Gfe(r,e){if(Number(r.match(/^#version[ \t]+(\d+)/m)?.[1]||100)!==300)throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(e){case"vertex":return r=v6(r,Hfe),r;case"fragment":return r=v6(r,Wfe),r;default:throw new Error(e)}}const hW=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Hfe=[...hW,[q3("attribute"),"in $1"],[q3("varying"),"out $1"]],Wfe=[...hW,[q3("varying"),"in $1"]];function v6(r,e){for(const[t,n]of e)r=r.replace(t,n);return r}function q3(r){return new RegExp(`\\b${r}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function dW(r,e){let t="";for(const n in r){const i=r[n];if(t+=`void ${i.signature} {
`,i.header&&(t+=`  ${i.header}`),e[n]){const s=e[n];s.sort((a,o)=>a.order-o.order);for(const a of s)t+=`  ${a.injection}
`}i.footer&&(t+=`  ${i.footer}`),t+=`}
`}return t}function fW(r){const e={vertex:{},fragment:{}};for(const t of r){let n,i;typeof t!="string"?(n=t,i=n.hook):(n={},i=t),i=i.trim();const[s,a]=i.split(":"),o=i.replace(/\(.+/,""),u=Object.assign(n,{signature:a});switch(s){case"vs":e.vertex[o]=u;break;case"fs":e.fragment[o]=u;break;default:throw new Error(s)}}return e}function Kfe(r,e){return{name:Xfe(r,e),language:"glsl",version:Jfe(r)}}function Xfe(r,e="unnamed"){const n=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(r);return n?n[1]:e}function Jfe(r){let e=100;const t=r.match(/[^\s]+/g);if(t&&t.length>=2&&t[0]==="#version"){const n=parseInt(t[1],10);Number.isFinite(n)&&(e=n)}if(e!==100&&e!==300)throw new Error(`Invalid GLSL version ${e}`);return e}const pW=`

${bw}
`,qfe=`precision highp float;
`;function Yfe(r){const e=Xk(r.modules||[]);return{source:Qfe(r.platformInfo,{...r,source:r.source,stage:"vertex",modules:e}),getUniforms:gW(e)}}function Zfe(r){const{vs:e,fs:t}=r,n=Xk(r.modules||[]);return{vs:A6(r.platformInfo,{...r,source:e,stage:"vertex",modules:n}),fs:A6(r.platformInfo,{...r,source:t,stage:"fragment",modules:n}),getUniforms:gW(n)}}function Qfe(r,e){const{source:t,stage:n,modules:i,hookFunctions:s=[],inject:a={},log:o}=e;Kk(typeof t=="string","shader source must be a string");const u=t;let f="";const g=fW(s),y={},A={},C={};for(const k in a){const D=typeof a[k]=="string"?{injection:a[k],order:0}:a[k],V=/^(v|f)s:(#)?([\w-]+)$/.exec(k);if(V){const W=V[2],z=V[3];W?z==="decl"?A[k]=[D]:C[k]=[D]:y[k]=[D]}else C[k]=[D]}const M=i;for(const k of M){o&&cW(k,u,o);const D=mW(k,"wgsl");f+=D;const V=k.injections?.[n]||{};for(const W in V){const z=/^(v|f)s:#([\w-]+)$/.exec(W);if(z){const te=z[2]==="decl"?A:C;te[W]=te[W]||[],te[W].push(V[W])}else y[W]=y[W]||[],y[W].push(V[W])}}return f+=pW,f=PC(f,n,A),f+=dW(g[n],y),f+=u,f=PC(f,n,C),f}function A6(r,e){const{source:t,stage:n,language:i="glsl",modules:s,defines:a={},hookFunctions:o=[],inject:u={},prologue:f=!0,log:g}=e;Kk(typeof t=="string","shader source must be a string");const y=i==="glsl"?Kfe(t).version:-1,A=r.shaderLanguageVersion,C=y===100?"#version 100":"#version 300 es",k=t.split(`
`).slice(1).join(`
`),D={};s.forEach(le=>{Object.assign(D,le.defines)}),Object.assign(D,a);let V="";switch(i){case"wgsl":break;case"glsl":V=f?`${C}

// ----- PROLOGUE -------------------------
${`#define SHADER_TYPE_${n.toUpperCase()}`}

${jfe(r)}
${n==="fragment"?qfe:""}

// ----- APPLICATION DEFINES -------------------------

${epe(D)}

`:`${C}
`;break}const W=fW(o),z={},$={},te={};for(const le in u){const _e=typeof u[le]=="string"?{injection:u[le],order:0}:u[le],se=/^(v|f)s:(#)?([\w-]+)$/.exec(le);if(se){const Y=se[2],ce=se[3];Y?ce==="decl"?$[le]=[_e]:te[le]=[_e]:z[le]=[_e]}else te[le]=[_e]}for(const le of s){g&&cW(le,k,g);const _e=mW(le,n);V+=_e;const se=le.instance?.normalizedInjections[n]||{};for(const Y in se){const ce=/^(v|f)s:#([\w-]+)$/.exec(Y);if(ce){const Me=ce[2]==="decl"?$:te;Me[Y]=Me[Y]||[],Me[Y].push(se[Y])}else z[Y]=z[Y]||[],z[Y].push(se[Y])}}return V+="// ----- MAIN SHADER SOURCE -------------------------",V+=pW,V=PC(V,n,$),V+=dW(W[n],z),V+=k,V=PC(V,n,te),i==="glsl"&&y!==A&&(V=Gfe(V,n)),V.trim()}function gW(r){return function(t){const n={};for(const i of r){const s=i.getUniforms?.(t,n);Object.assign(n,s)}return n}}function epe(r={}){let e="";for(const t in r){const n=r[t];(n||Number.isFinite(n))&&(e+=`#define ${t.toUpperCase()} ${r[t]}
`)}return e}function mW(r,e){let t;switch(e){case"vertex":t=r.vs||"";break;case"fragment":t=r.fs||"";break;case"wgsl":t=r.source||"";break;default:Kk(!1)}if(!r.name)throw new Error("Shader module must have a name");const n=r.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");let i=`// ----- MODULE ${r.name} ---------------

`;return e!=="wgsl"&&(i+=`#define MODULE_${n}
`),i+=`${t}
`,i}const tpe=/^\s*\#\s*ifdef\s*([a-zA-Z_]+)\s*$/,rpe=/^\s*\#\s*endif\s*$/;function npe(r,e){const t=r.split(`
`),n=[];let i=!0,s=null;for(const a of t){const o=a.match(tpe),u=a.match(rpe);o?(s=o[1],i=!!e?.defines?.[s]):u?i=!0:i&&n.push(a)}return n.join(`
`)}const Lf=class Lf{constructor(){H(this,"_hookFunctions",[]);H(this,"_defaultModules",[])}static getDefaultShaderAssembler(){return Lf.defaultShaderAssembler=Lf.defaultShaderAssembler||new Lf,Lf.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find(t=>t.name===(typeof e=="string"?e:e.name))||this._defaultModules.push(e)}removeDefaultModule(e){const t=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(n=>n.name!==t)}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e)}assembleWGSLShader(e){const t=this._getModuleList(e.modules),n=this._hookFunctions,{source:i,getUniforms:s}=Yfe({...e,source:e.source,modules:t,hookFunctions:n});return{source:e.platformInfo.shaderLanguage==="wgsl"?npe(i):i,getUniforms:s,modules:t}}assembleGLSLShaderPair(e){const t=this._getModuleList(e.modules),n=this._hookFunctions;return{...Zfe({...e,vs:e.vs,fs:e.fs,modules:t,hookFunctions:n}),modules:t}}_getModuleList(e=[]){const t=new Array(this._defaultModules.length+e.length),n={};let i=0;for(let s=0,a=this._defaultModules.length;s<a;++s){const o=this._defaultModules[s],u=o.name;t[i++]=o,n[u]=!0}for(let s=0,a=e.length;s<a;++s){const o=e[s],u=o.name;n[u]||(t[i++]=o,n[u]=!0)}return t.length=i,BC(t),t}};H(Lf,"defaultShaderAssembler");let MC=Lf;const ipe=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,spe=`#version 300 es
${ipe}`;function yW(r){const{input:e,inputChannels:t,output:n}=r||{};if(!e)return spe;if(!t)throw new Error("inputChannels");const i=ope(t),s=ape(e,t);return`#version 300 es
in ${i} ${e};
out vec4 ${n};
void main() {
  ${n} = ${s};
}`}function ope(r){switch(r){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${r}`)}}function ape(r,e){switch(e){case 1:return`vec4(${r}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${r}, 0.0, 1.0)`;case 3:return`vec4(${r}, 1.0)`;case 4:return r;default:throw new Error(`invalid channels: ${e}`)}}class lpe{constructor(){H(this,"stats",new Map)}getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new Iy({id:e})),this.stats.get(e)}}const bW=new lpe,Bt=new Ey({id:"luma.gl"}),xI={};function DS(r="id"){xI[r]=xI[r]||1;const e=xI[r]++;return`${r}-${e}`}var h3;let ri=(h3=class{constructor(e,t,n){H(this,"id");H(this,"props");H(this,"userData",{});H(this,"_device");H(this,"destroyed",!1);H(this,"allocatedBytes",0);H(this,"_attachedResources",new Set);if(!e)throw new Error("no device");this._device=e,this.props=cpe(t,n);const i=this.props.id!=="undefined"?this.props.id:DS(this[Symbol.toStringTag]);this.props.id=i,this.id=i,this.userData=this.props.userData||{},this.addStats()}toString(){return`${this[Symbol.toStringTag]||this.constructor.name}:"${this.id}"`}destroy(){this.destroyResource()}delete(){return this.destroy(),this}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get(`${t}s Active`).decrementCount()}trackAllocatedMemory(e,t=this[Symbol.toStringTag]){const n=this._device.statsManager.getStats("Resource Counts");n.get("GPU Memory").addCount(e),n.get(`${t} Memory`).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(e=this[Symbol.toStringTag]){const t=this._device.statsManager.getStats("Resource Counts");t.get("GPU Memory").subtractCount(this.allocatedBytes),t.get(`${e} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get(`${t}s Created`).incrementCount(),e.get(`${t}s Active`).incrementCount()}},H(h3,"defaultProps",{id:"undefined",handle:void 0,userData:void 0}),h3);function cpe(r,e){const t={...e};for(const n in r)r[n]!==void 0&&(t[n]=r[n]);return t}var ps;let Li=(ps=class extends ri{constructor(t,n){const i={...n};(n.usage||0)&ps.INDEX&&!n.indexType&&(n.data instanceof Uint32Array?i.indexType="uint32":n.data instanceof Uint16Array&&(i.indexType="uint16")),delete i.data;super(t,i,ps.defaultProps);H(this,"usage");H(this,"indexType");H(this,"updateTimestamp");H(this,"debugData",new ArrayBuffer(0));this.usage=i.usage||0,this.indexType=i.indexType,this.updateTimestamp=t.incrementTimestamp()}get[Symbol.toStringTag](){return"Buffer"}clone(t){return this.device.createBuffer({...this.props,...t})}_setDebugData(t,n,i){const s=ArrayBuffer.isView(t)?t.buffer:t,a=Math.min(t?t.byteLength:i,ps.DEBUG_DATA_MAX_LENGTH);s===null?this.debugData=new ArrayBuffer(a):n===0&&i===s.byteLength?this.debugData=s.slice(0,a):this.debugData=s.slice(n,n+a)}},H(ps,"INDEX",16),H(ps,"VERTEX",32),H(ps,"UNIFORM",64),H(ps,"STORAGE",128),H(ps,"INDIRECT",256),H(ps,"QUERY_RESOLVE",512),H(ps,"MAP_READ",1),H(ps,"MAP_WRITE",2),H(ps,"COPY_SRC",4),H(ps,"COPY_DST",8),H(ps,"DEBUG_DATA_MAX_LENGTH",32),H(ps,"defaultProps",{...ri.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",onMapped:void 0}),ps);function _W(r){const[e,t,n]=Yk[r],i=r.includes("norm"),s=!i&&!r.startsWith("float"),a=r.startsWith("s");return{signedType:e,primitiveType:t,byteLength:n,normalized:i,integer:s,signed:a}}function upe(r){const e=r;switch(e){case"uint8":return"unorm8";case"sint8":return"snorm8";case"uint16":return"unorm16";case"sint16":return"snorm16";default:return e}}function hpe(r,e){switch(e){case 1:return r;case 2:return r+r%2;default:return r+(4-r%4)%4}}function Jk(r){const e=ArrayBuffer.isView(r)?r.constructor:r;if(e===Uint8ClampedArray)return"uint8";const t=Object.values(Yk).find(n=>e===n[4]);if(!t)throw new Error(e.name);return t[0]}function qk(r){const[,,,,e]=Yk[r];return e}const Yk={uint8:["uint8","u32",1,!1,Uint8Array],sint8:["sint8","i32",1,!1,Int8Array],unorm8:["uint8","f32",1,!0,Uint8Array],snorm8:["sint8","f32",1,!0,Int8Array],uint16:["uint16","u32",2,!1,Uint16Array],sint16:["sint16","i32",2,!1,Int16Array],unorm16:["uint16","u32",2,!0,Uint16Array],snorm16:["sint16","i32",2,!0,Int16Array],float16:["float16","f16",2,!1,Uint16Array],float32:["float32","f32",4,!1,Float32Array],uint32:["uint32","u32",4,!1,Uint32Array],sint32:["sint32","i32",4,!1,Int32Array]};function Zk(r){let e;r.endsWith("-webgl")&&(r.replace("-webgl",""),e=!0);const[t,n]=r.split("x"),i=t,s=n?parseInt(n):1,a=_W(i),o={type:i,components:s,byteLength:a.byteLength*s,integer:a.integer,signed:a.signed,normalized:a.normalized};return e&&(o.webglOnly=!0),o}function dpe(r,e,t){const n=t?upe(r):r;switch(n){case"unorm8":return e===1?"unorm8":e===3?"unorm8x3-webgl":`${n}x${e}`;case"snorm8":case"uint8":case"sint8":case"uint16":case"sint16":case"unorm16":case"snorm16":case"float16":if(e===1||e===3)throw new Error(`size: ${e}`);return`${n}x${e}`;default:return e===1?n:`${n}x${e}`}}function fpe(r,e,t){if(!e||e>4)throw new Error(`size ${e}`);const n=e,i=Jk(r);return dpe(i,n,t)}function ppe(r){let e;switch(r.primitiveType){case"f32":e="float32";break;case"i32":e="sint32";break;case"u32":e="uint32";break;case"f16":return r.components<=2?"float16x2":"float16x4"}return r.components===1?e:`${e}x${r.components}`}const fo="texture-compression-bc",Zn="texture-compression-astc",Sc="texture-compression-etc2",gpe="texture-compression-etc1-webgl",G1="texture-compression-pvrtc-webgl",wI="texture-compression-atc-webgl",H1="float32-renderable-webgl",CI="float16-renderable-webgl",mpe="rgb9e5ufloat-renderable-webgl",TI="snorm8-renderable-webgl",Yb="norm16-renderable-webgl",SI="snorm16-renderable-webgl",W1="float32-filterable",x6="float16-filterable-webgl";function vW(r){const e=_pe[r];if(!e)throw new Error(`Unsupported texture format ${r}`);return e}const ype={r8unorm:{},rg8unorm:{},"rgb8unorm-webgl":{},rgba8unorm:{},"rgba8unorm-srgb":{},r8snorm:{render:TI},rg8snorm:{render:TI},"rgb8snorm-webgl":{},rgba8snorm:{render:TI},r8uint:{},rg8uint:{},rgba8uint:{},r8sint:{},rg8sint:{},rgba8sint:{},bgra8unorm:{},"bgra8unorm-srgb":{},r16unorm:{f:Yb},rg16unorm:{render:Yb},"rgb16unorm-webgl":{f:Yb},rgba16unorm:{render:Yb},r16snorm:{f:SI},rg16snorm:{render:SI},"rgb16snorm-webgl":{f:Yb},rgba16snorm:{render:SI},r16uint:{},rg16uint:{},rgba16uint:{},r16sint:{},rg16sint:{},rgba16sint:{},r16float:{render:CI,filter:"float16-filterable-webgl"},rg16float:{render:CI,filter:x6},rgba16float:{render:CI,filter:x6},r32uint:{},rg32uint:{},rgba32uint:{},r32sint:{},rg32sint:{},rgba32sint:{},r32float:{render:H1,filter:W1},rg32float:{render:!1,filter:W1},"rgb32float-webgl":{render:H1,filter:W1},rgba32float:{render:H1,filter:W1},"rgba4unorm-webgl":{channels:"rgba",bitsPerChannel:[4,4,4,4],packed:!0},"rgb565unorm-webgl":{channels:"rgb",bitsPerChannel:[5,6,5,0],packed:!0},"rgb5a1unorm-webgl":{channels:"rgba",bitsPerChannel:[5,5,5,1],packed:!0},rgb9e5ufloat:{channels:"rgb",packed:!0,render:mpe},rg11b10ufloat:{channels:"rgb",bitsPerChannel:[11,11,10,0],packed:!0,p:1,render:H1},rgb10a2unorm:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},rgb10a2uint:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},stencil8:{attachment:"stencil",bitsPerChannel:[8,0,0,0],dataType:"uint8"},depth16unorm:{attachment:"depth",bitsPerChannel:[16,0,0,0],dataType:"uint16"},depth24plus:{attachment:"depth",bitsPerChannel:[24,0,0,0],dataType:"uint32"},depth32float:{attachment:"depth",bitsPerChannel:[32,0,0,0],dataType:"float32"},"depth24plus-stencil8":{attachment:"depth-stencil",bitsPerChannel:[24,8,0,0],packed:!0},"depth32float-stencil8":{attachment:"depth-stencil",bitsPerChannel:[32,8,0,0],packed:!0}},bpe={"bc1-rgb-unorm-webgl":{f:fo},"bc1-rgb-unorm-srgb-webgl":{f:fo},"bc1-rgba-unorm":{f:fo},"bc1-rgba-unorm-srgb":{f:fo},"bc2-rgba-unorm":{f:fo},"bc2-rgba-unorm-srgb":{f:fo},"bc3-rgba-unorm":{f:fo},"bc3-rgba-unorm-srgb":{f:fo},"bc4-r-unorm":{f:fo},"bc4-r-snorm":{f:fo},"bc5-rg-unorm":{f:fo},"bc5-rg-snorm":{f:fo},"bc6h-rgb-ufloat":{f:fo},"bc6h-rgb-float":{f:fo},"bc7-rgba-unorm":{f:fo},"bc7-rgba-unorm-srgb":{f:fo},"etc2-rgb8unorm":{f:Sc},"etc2-rgb8unorm-srgb":{f:Sc},"etc2-rgb8a1unorm":{f:Sc},"etc2-rgb8a1unorm-srgb":{f:Sc},"etc2-rgba8unorm":{f:Sc},"etc2-rgba8unorm-srgb":{f:Sc},"eac-r11unorm":{f:Sc},"eac-r11snorm":{f:Sc},"eac-rg11unorm":{f:Sc},"eac-rg11snorm":{f:Sc},"astc-4x4-unorm":{f:Zn},"astc-4x4-unorm-srgb":{f:Zn},"astc-5x4-unorm":{f:Zn},"astc-5x4-unorm-srgb":{f:Zn},"astc-5x5-unorm":{f:Zn},"astc-5x5-unorm-srgb":{f:Zn},"astc-6x5-unorm":{f:Zn},"astc-6x5-unorm-srgb":{f:Zn},"astc-6x6-unorm":{f:Zn},"astc-6x6-unorm-srgb":{f:Zn},"astc-8x5-unorm":{f:Zn},"astc-8x5-unorm-srgb":{f:Zn},"astc-8x6-unorm":{f:Zn},"astc-8x6-unorm-srgb":{f:Zn},"astc-8x8-unorm":{f:Zn},"astc-8x8-unorm-srgb":{f:Zn},"astc-10x5-unorm":{f:Zn},"astc-10x5-unorm-srgb":{f:Zn},"astc-10x6-unorm":{f:Zn},"astc-10x6-unorm-srgb":{f:Zn},"astc-10x8-unorm":{f:Zn},"astc-10x8-unorm-srgb":{f:Zn},"astc-10x10-unorm":{f:Zn},"astc-10x10-unorm-srgb":{f:Zn},"astc-12x10-unorm":{f:Zn},"astc-12x10-unorm-srgb":{f:Zn},"astc-12x12-unorm":{f:Zn},"astc-12x12-unorm-srgb":{f:Zn},"pvrtc-rgb4unorm-webgl":{f:G1},"pvrtc-rgba4unorm-webgl":{f:G1},"pvrtc-rbg2unorm-webgl":{f:G1},"pvrtc-rgba2unorm-webgl":{f:G1},"etc1-rbg-unorm-webgl":{f:gpe},"atc-rgb-unorm-webgl":{f:wI},"atc-rgba-unorm-webgl":{f:wI},"atc-rgbai-unorm-webgl":{f:wI}},_pe={...ype,...bpe},vpe=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],Ape=/^(r|rg|rgb|rgba|bgra)([0-9]*)([a-z]*)(-srgb)?(-webgl)?$/;class xpe{getInfo(e){return w6(e)}isColor(e){return e.startsWith("rgba")||e.startsWith("bgra")||e.startsWith("rgb")}isDepthStencil(e){return e.startsWith("depth")||e.startsWith("stencil")}isCompressed(e){return vpe.some(t=>e.startsWith(t))}getCapabilities(e){const t=vW(e),n={format:e,create:t.f??!0,render:t.render??!0,filter:t.filter??!0,blend:t.blend??!0,store:t.store??!0},i=w6(e),s=e.startsWith("depth")||e.startsWith("stencil"),a=i?.signed,o=i?.integer,u=i?.webgl;return n.render&&(n.render=!a),n.filter&&(n.filter=!s&&!a&&!o&&!u),n}}const Dm=new xpe;function w6(r){let e=wpe(r);if(Dm.isCompressed(r)){e.channels="rgb",e.components=3,e.bytesPerPixel=1,e.srgb=!1,e.compressed=!0;const n=Cpe(r);n&&(e.blockWidth=n.blockWidth,e.blockHeight=n.blockHeight)}const t=Ape.exec(r);if(t){const[,n,i,s,a,o]=t,u=`${s}${i}`,f=_W(u),g=f.byteLength*8,y=n.length,A=[g,y>=2?g:0,y>=3?g:0,y>=4?g:0];e={format:r,attachment:e.attachment,dataType:f.signedType,components:y,channels:n,integer:f.integer,signed:f.signed,normalized:f.normalized,bitsPerChannel:A,bytesPerPixel:f.byteLength*n.length,packed:e.packed,srgb:e.srgb},o==="-webgl"&&(e.webgl=!0),a==="-srgb"&&(e.srgb=!0)}return r.endsWith("-webgl")&&(e.webgl=!0),r.endsWith("-srgb")&&(e.srgb=!0),e}function wpe(r){const e=vW(r),t=e.bytesPerPixel||1,n=e.bitsPerChannel||[8,8,8,8];return delete e.bitsPerChannel,delete e.bytesPerPixel,delete e.f,delete e.render,delete e.filter,delete e.blend,delete e.store,{...e,format:r,attachment:e.attachment||"color",channels:e.channels||"r",components:e.components||e.channels?.length||1,bytesPerPixel:t,bitsPerChannel:n,dataType:e.dataType||"uint8",srgb:e.srgb??!1,packed:e.packed??!1,webgl:e.webgl??!1,integer:e.integer??!1,signed:e.signed??!1,normalized:e.normalized??!1,compressed:e.compressed??!1}}function Cpe(r){const t=/.*-(\d+)x(\d+)-.*/.exec(r);if(t){const[,n,i]=t;return{blockWidth:Number(n),blockHeight:Number(i)}}return null}function Tpe(r){return typeof ImageData<"u"&&r instanceof ImageData||typeof ImageBitmap<"u"&&r instanceof ImageBitmap||typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement||typeof VideoFrame<"u"&&r instanceof VideoFrame||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas}function Spe(r){if(typeof ImageData<"u"&&r instanceof ImageData||typeof ImageBitmap<"u"&&r instanceof ImageBitmap||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas)return{width:r.width,height:r.height};if(typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement)return{width:r.naturalWidth,height:r.naturalHeight};if(typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement)return{width:r.videoWidth,height:r.videoHeight};if(typeof VideoFrame<"u"&&r instanceof VideoFrame)return{width:r.displayWidth,height:r.displayHeight};throw new Error("Unknown image type")}class Epe{}class Ipe{constructor(e=[],t){H(this,"features");H(this,"disabledFeatures");this.features=new Set(e),this.disabledFeatures=t||{}}*[Symbol.iterator](){yield*this.features}has(e){return!this.disabledFeatures?.[e]&&this.features.has(e)}}const TT=class TT{constructor(e){H(this,"id");H(this,"props");H(this,"userData",{});H(this,"statsManager",bW);H(this,"timestamp",0);H(this,"_reused",!1);H(this,"_lumaData",{});H(this,"_textureCaps",{});this.props={...TT.defaultProps,...e},this.id=this.props.id||DS(this[Symbol.toStringTag].toLowerCase())}get[Symbol.toStringTag](){return"Device"}toString(){return`Device(${this.id})`}getVertexFormatInfo(e){return Zk(e)}isVertexFormatSupported(e){return!0}getTextureFormatInfo(e){return Dm.getInfo(e)}getTextureFormatCapabilities(e){let t=this._textureCaps[e];if(!t){const n=this._getDeviceTextureFormatCapabilities(e);t=this._getDeviceSpecificTextureFormatCapabilities(n),this._textureCaps[e]=t}return t}getMipLevelCount(e,t,n=1){const i=Math.max(e,t,n);return 1+Math.floor(Math.log2(i))}isExternalImage(e){return Tpe(e)}getExternalImageSize(e){return Spe(e)}isTextureFormatSupported(e){return this.getTextureFormatCapabilities(e).create}isTextureFormatFilterable(e){return this.getTextureFormatCapabilities(e).filter}isTextureFormatRenderable(e){return this.getTextureFormatCapabilities(e).render}isTextureFormatCompressed(e){return Dm.isCompressed(e)}pushDebugGroup(e){this.commandEncoder.pushDebugGroup(e)}popDebugGroup(){this.commandEncoder?.popDebugGroup()}insertDebugMarker(e){this.commandEncoder?.insertDebugMarker(e)}loseDevice(){return!1}incrementTimestamp(){return this.timestamp++}reportError(e,t,...n){return this.props.onError(e,t)?()=>{}:Bt.error(e.message,t,...n)}debug(){if(this.props.debug)debugger;else Bt.once(0,`'Type luma.log.set({debug: true}) in console to enable debug breakpoints',
or create a device with the 'debug: true' prop.`)()}getDefaultCanvasContext(){if(!this.canvasContext)throw new Error("Device has no default CanvasContext. See props.createCanvasContext");return this.canvasContext}beginRenderPass(e){return this.commandEncoder.beginRenderPass(e)}beginComputePass(e){return this.commandEncoder.beginComputePass(e)}getCanvasContext(){return this.getDefaultCanvasContext()}readPixelsToArrayWebGL(e,t){throw new Error("not implemented")}readPixelsToBufferWebGL(e,t){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,t){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}static _getCanvasContextProps(e){return e.createCanvasContext===!0?{}:e.createCanvasContext}_getDeviceTextureFormatCapabilities(e){const t=Dm.getCapabilities(e),n=s=>(typeof s=="string"?this.features.has(s):s)??!0,i=n(t.create);return{format:e,create:i,render:i&&n(t.render),filter:i&&n(t.filter),blend:i&&n(t.blend),store:i&&n(t.store)}}_normalizeBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const t={...e};if((e.usage||0)&Li.INDEX&&(e.indexType||(e.data instanceof Uint32Array?t.indexType="uint32":e.data instanceof Uint16Array&&(t.indexType="uint16")),!t.indexType))throw new Error("indices buffer content must be of type uint16 or uint32");return t}};H(TT,"defaultProps",{id:null,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,createCanvasContext:void 0,webgl:{},onError:(e,t)=>{},onResize:(e,t)=>{const[n,i]=e.getDevicePixelSize();Bt.log(1,`${e} resized => ${n}x${i}px`)()},onPositionChange:(e,t)=>{const[n,i]=e.getPosition();Bt.log(1,`${e} repositioned => ${n},${i}`)()},onVisibilityChange:e=>Bt.log(1,`${e} Visibility changed ${e.isVisible}`)(),onDevicePixelRatioChange:(e,t)=>Bt.log(1,`${e} DPR changed ${t.oldRatio} => ${e.devicePixelRatio}`)(),debug:Bt.get("debug")||void 0,debugShaders:Bt.get("debug-shaders")||void 0,debugFramebuffers:!!Bt.get("debug-framebuffers"),debugFactories:!!Bt.get("debug-factories"),debugWebGL:!!Bt.get("debug-webgl"),debugSpectorJS:void 0,debugSpectorJSUrl:void 0,_reuseDevices:!1,_requestMaxLimits:!0,_cacheShaders:!1,_cachePipelines:!1,_cacheDestroyPolicy:"unused",_initializeFeatures:!0,_disabledFeatures:{"compilation-status-async-webgl":!0},_handle:void 0});let hp=TT;const Ppe="set luma.log.level=1 (or higher) to trace rendering",C6="No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.",f_=class f_{constructor(){H(this,"stats",bW);H(this,"log",Bt);H(this,"VERSION","9.2.5");H(this,"spector");H(this,"preregisteredAdapters",new Map);if(globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw Bt.error(`Found luma.gl ${globalThis.luma.VERSION} while initialzing ${this.VERSION}`)(),Bt.error("'yarn why @luma.gl/core' can help identify the source of the conflict")(),new Error("luma.gl - multiple versions detected: see console log");Bt.error("This version of luma.gl has already been initialized")()}Bt.log(1,`${this.VERSION} - ${Ppe}`)(),globalThis.luma=this}async createDevice(e={}){const t={...f_.defaultProps,...e},n=this.selectAdapter(t.type,t.adapters);if(!n)throw new Error(C6);return t.waitForPageLoad&&await n.pageLoaded,await n.create(t)}async attachDevice(e,t){const n=this._getTypeFromHandle(e,t.adapters),i=n&&this.selectAdapter(n,t.adapters);if(!i)throw new Error(C6);return await i?.attach?.(e,t)}registerAdapters(e){for(const t of e)this.preregisteredAdapters.set(t.type,t)}getSupportedAdapters(e=[]){const t=this._getAdapterMap(e);return Array.from(t).map(([,n])=>n).filter(n=>n.isSupported?.()).map(n=>n.type)}getBestAvailableAdapterType(e=[]){const t=["webgpu","webgl","null"],n=this._getAdapterMap(e);for(const i of t)if(n.get(i)?.isSupported?.())return i;return null}selectAdapter(e,t=[]){let n=e;e==="best-available"&&(n=this.getBestAvailableAdapterType(t));const i=this._getAdapterMap(t);return n&&i.get(n)||null}enforceWebGL2(e=!0,t=[]){const i=this._getAdapterMap(t).get("webgl");i||Bt.warn("enforceWebGL2: webgl adapter not found")(),i?.enforceWebGL2?.(e)}setDefaultDeviceProps(e){Object.assign(f_.defaultProps,e)}_getAdapterMap(e=[]){const t=new Map(this.preregisteredAdapters);for(const n of e)t.set(n.type,n);return t}_getTypeFromHandle(e,t=[]){return e instanceof WebGL2RenderingContext?"webgl":typeof GPUDevice<"u"&&e instanceof GPUDevice||e?.queue?"webgpu":e===null?"null":(e instanceof WebGLRenderingContext?Bt.warn("WebGL1 is not supported",e)():Bt.warn("Unknown handle type",e)(),null)}};H(f_,"defaultProps",{...hp.defaultProps,type:"best-available",adapters:void 0,waitForPageLoad:!0});let Y3=f_;const Z3=new Y3;class Bpe{get pageLoaded(){return kpe()}}const Mpe=_p()&&typeof document<"u",Rpe=()=>Mpe&&document.readyState==="complete";let K1=null;function kpe(){return K1||(Rpe()||typeof window>"u"?K1=Promise.resolve():K1=new Promise(r=>window.addEventListener("load",()=>r()))),K1}function Ope(){let r,e;return{promise:new Promise((n,i)=>{r=n,e=i}),resolve:r,reject:e}}const Nf=class Nf{constructor(e){H(this,"id");H(this,"props");H(this,"canvas");H(this,"htmlCanvas");H(this,"offscreenCanvas");H(this,"type");H(this,"initialized");H(this,"isInitialized",!1);H(this,"isVisible",!0);H(this,"cssWidth");H(this,"cssHeight");H(this,"devicePixelRatio");H(this,"devicePixelWidth");H(this,"devicePixelHeight");H(this,"drawingBufferWidth");H(this,"drawingBufferHeight");H(this,"_initializedResolvers",Ope());H(this,"_resizeObserver");H(this,"_intersectionObserver");H(this,"_position");H(this,"destroyed",!1);if(this.props={...Nf.defaultProps,...e},e=this.props,this.initialized=this._initializedResolvers.promise,_p()?e.canvas?typeof e.canvas=="string"?this.canvas=Lpe(e.canvas):this.canvas=e.canvas:this.canvas=Npe(e):this.canvas={width:e.width||1,height:e.height||1},Nf.isHTMLCanvas(this.canvas)?(this.id=e.id||this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):Nf.isOffscreenCanvas(this.canvas)?(this.id=e.id||"offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas):(this.id=e.id||"node-canvas-context",this.type="node"),this.cssWidth=this.htmlCanvas?.clientWidth||this.canvas.width,this.cssHeight=this.htmlCanvas?.clientHeight||this.canvas.height,this.devicePixelWidth=this.canvas.width,this.devicePixelHeight=this.canvas.height,this.drawingBufferWidth=this.canvas.width,this.drawingBufferHeight=this.canvas.height,this.devicePixelRatio=globalThis.devicePixelRatio||1,this._position=[0,0],Nf.isHTMLCanvas(this.canvas)){this._intersectionObserver=new IntersectionObserver(t=>this._handleIntersection(t)),this._intersectionObserver.observe(this.canvas),this._resizeObserver=new ResizeObserver(t=>this._handleResize(t));try{this._resizeObserver.observe(this.canvas,{box:"device-pixel-content-box"})}catch{this._resizeObserver.observe(this.canvas,{box:"content-box"})}setTimeout(()=>this._observeDevicePixelRatio(),0),this.props.trackPosition&&this._trackPosition()}}static isHTMLCanvas(e){return typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement}static isOffscreenCanvas(e){return typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas}toString(){return`${this[Symbol.toStringTag]}(${this.id})`}destroy(){this.destroyed=!0}setProps(e){return"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1,this._updateDrawingBufferSize()),this}getCSSSize(){return[this.cssWidth,this.cssHeight]}getPosition(){return this._position}getDevicePixelSize(){return[this.devicePixelWidth,this.devicePixelHeight]}getDrawingBufferSize(){return[this.drawingBufferWidth,this.drawingBufferHeight]}getMaxDrawingBufferSize(){const e=this.device.limits.maxTextureDimension2D;return[e,e]}setDrawingBufferSize(e,t){this.canvas.width=e,this.canvas.height=t,this.drawingBufferWidth=e,this.drawingBufferHeight=t}getDevicePixelRatio(){return typeof window<"u"&&window.devicePixelRatio||1}cssToDevicePixels(e,t=!0){const n=this.cssToDeviceRatio(),[i,s]=this.getDrawingBufferSize();return Fpe(e,n,i,s,t)}getPixelSize(){return this.getDevicePixelSize()}getAspect(){const[e,t]=this.getDevicePixelSize();return e/t}cssToDeviceRatio(){try{const[e]=this.getDrawingBufferSize(),[t]=this.getCSSSize();return t?e/t:1}catch{return 1}}resize(e){this.setDrawingBufferSize(e.width,e.height)}_setAutoCreatedCanvasId(e){this.htmlCanvas?.id==="lumagl-auto-created-canvas"&&(this.htmlCanvas.id=e)}_handleIntersection(e){const t=e.find(i=>i.target===this.canvas);if(!t)return;const n=t.isIntersecting;this.isVisible!==n&&(this.isVisible=n,this.device.props.onVisibilityChange(this))}_handleResize(e){const t=e.find(u=>u.target===this.canvas);if(!t)return;this.cssWidth=t.contentBoxSize[0].inlineSize,this.cssHeight=t.contentBoxSize[0].blockSize;const n=this.getDevicePixelSize(),i=t.devicePixelContentBoxSize?.[0].inlineSize||t.contentBoxSize[0].inlineSize*devicePixelRatio,s=t.devicePixelContentBoxSize?.[0].blockSize||t.contentBoxSize[0].blockSize*devicePixelRatio,[a,o]=this.getMaxDrawingBufferSize();this.devicePixelWidth=Math.max(1,Math.min(i,a)),this.devicePixelHeight=Math.max(1,Math.min(s,o)),this._updateDrawingBufferSize(),this.device.props.onResize(this,{oldPixelSize:n})}_updateDrawingBufferSize(){if(this.props.autoResize){if(typeof this.props.useDevicePixels=="number"){const e=this.props.useDevicePixels;this.setDrawingBufferSize(this.cssWidth*e,this.cssHeight*e)}else this.props.useDevicePixels?this.setDrawingBufferSize(this.devicePixelWidth,this.devicePixelHeight):this.setDrawingBufferSize(this.cssWidth,this.cssHeight);this._updateDevice()}this._initializedResolvers.resolve(),this.isInitialized=!0,this.updatePosition()}_observeDevicePixelRatio(){const e=this.devicePixelRatio;this.devicePixelRatio=window.devicePixelRatio,this.updatePosition(),this.device.props.onDevicePixelRatioChange(this,{oldRatio:e}),matchMedia(`(resolution: ${this.devicePixelRatio}dppx)`).addEventListener("change",()=>this._observeDevicePixelRatio(),{once:!0})}_trackPosition(e=100){const t=setInterval(()=>{this.destroyed?clearInterval(t):this.updatePosition()},e)}updatePosition(){const e=this.htmlCanvas?.getBoundingClientRect();if(e){const t=[e.left,e.top];if(this._position??(this._position=t),t[0]!==this._position[0]||t[1]!==this._position[1]){const i=this._position;this._position=t,this.device.props.onPositionChange?.(this,{oldPosition:i})}}}};H(Nf,"defaultProps",{id:void 0,canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:"opaque",colorSpace:"srgb",trackPosition:!1});let RC=Nf;function Dpe(r){if(typeof r=="string"){const e=document.getElementById(r);if(!e)throw new Error(`${r} is not an HTML element`);return e}return r||document.body}function Lpe(r){const e=document.getElementById(r);if(!RC.isHTMLCanvas(e))throw new Error("Object is not a canvas element");return e}function Npe(r){const{width:e,height:t}=r,n=document.createElement("canvas");n.id=DS("lumagl-auto-created-canvas"),n.width=e||1,n.height=t||1,n.style.width=Number.isFinite(e)?`${e}px`:"100%",n.style.height=Number.isFinite(t)?`${t}px`:"100%",r?.visible||(n.style.visibility="hidden");const i=Dpe(r?.container||null);return i.insertBefore(n,i.firstChild),n}function Fpe(r,e,t,n,i){const s=r,a=T6(s[0],e,t);let o=S6(s[1],e,n,i),u=T6(s[0]+1,e,t);const f=u===t-1?u:u-1;u=S6(s[1]+1,e,n,i);let g;return i?(u=u===0?u:u+1,g=o,o=u):g=u===n-1?u:u-1,{x:a,y:o,width:Math.max(f-a+1,1),height:Math.max(g-o+1,1)}}function T6(r,e,t){return Math.min(Math.round(r*e),t-1)}function S6(r,e,t,n){return n?Math.max(0,t-1-Math.round(r*e)):Math.min(Math.round(r*e),t-1)}const p_=class p_ extends ri{get[Symbol.toStringTag](){return"Sampler"}constructor(e,t){t=p_.normalizeProps(e,t),super(e,t,p_.defaultProps)}static normalizeProps(e,t){return t}};H(p_,"defaultProps",{...ri.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1});let ey=p_;const Upe={"1d":"1d","2d":"2d","2d-array":"2d",cube:"2d","cube-array":"2d","3d":"3d"},Es=class Es extends ri{constructor(t,n){n=Es.normalizeProps(t,n);super(t,n,Es.defaultProps);H(this,"dimension");H(this,"baseDimension");H(this,"format");H(this,"width");H(this,"height");H(this,"depth");H(this,"mipLevels");H(this,"updateTimestamp");if(this.dimension=this.props.dimension,this.baseDimension=Upe[this.dimension],this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.mipLevels=this.props.mipLevels,this.props.width===void 0||this.props.height===void 0)if(t.isExternalImage(n.data)){const i=t.getExternalImageSize(n.data);this.width=i?.width||1,this.height=i?.height||1}else this.width=1,this.height=1,(this.props.width===void 0||this.props.height===void 0)&&Bt.warn(`${this} created with undefined width or height. This is deprecated. Use AsyncTexture instead.`)();this.updateTimestamp=t.incrementTimestamp()}get[Symbol.toStringTag](){return"Texture"}toString(){return`Texture(${this.id},${this.format},${this.width}x${this.height})`}setSampler(t){this.sampler=t instanceof ey?t:this.device.createSampler(t)}clone(t){return this.device.createTexture({...this.props,...t})}static normalizeProps(t,n){const i={...n},{width:s,height:a}=i;return typeof s=="number"&&(i.width=Math.max(1,Math.ceil(s))),typeof a=="number"&&(i.height=Math.max(1,Math.ceil(a))),i}_initializeData(t){this.device.isExternalImage(t)?this.copyExternalImage({image:t,width:this.width,height:this.height,depth:this.depth,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1}):t&&this.copyImageData({data:t,mipLevel:0,x:0,y:0,z:0,aspect:"all"})}_normalizeCopyImageDataOptions(t){const{width:n,height:i,depth:s}=this,a={...Es.defaultCopyDataOptions,width:n,height:i,depth:s,...t},o=this.device.getTextureFormatInfo(this.format);if(!t.bytesPerRow&&!o.bytesPerPixel)throw new Error(`bytesPerRow must be provided for texture format ${this.format}`);return a.bytesPerRow=t.bytesPerRow||n*(o.bytesPerPixel||4),a.rowsPerImage=t.rowsPerImage||i,a}_normalizeCopyExternalImageOptions(t){const n=this.device.getExternalImageSize(t.image),i={...Es.defaultCopyExternalImageOptions,...n,...t};return i.width=Math.min(i.width,this.width-i.x),i.height=Math.min(i.height,this.height-i.y),i}};H(Es,"SAMPLE",4),H(Es,"STORAGE",8),H(Es,"RENDER",16),H(Es,"COPY_SRC",1),H(Es,"COPY_DST",2),H(Es,"TEXTURE",4),H(Es,"RENDER_ATTACHMENT",16),H(Es,"defaultProps",{...ri.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",usage:Es.TEXTURE|Es.RENDER_ATTACHMENT|Es.COPY_DST,width:void 0,height:void 0,depth:1,mipLevels:1,samples:void 0,sampler:{},view:void 0}),H(Es,"defaultCopyDataOptions",{data:void 0,byteOffset:0,bytesPerRow:void 0,rowsPerImage:void 0,mipLevel:0,x:0,y:0,z:0,aspect:"all"}),H(Es,"defaultCopyExternalImageOptions",{image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1});let ca=Es;const ST=class ST extends ri{get[Symbol.toStringTag](){return"TextureView"}constructor(e,t){super(e,t,ST.defaultProps)}};H(ST,"defaultProps",{...ri.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0});let kC=ST;function zpe(r,e,t){let n="";const i=e.split(/\r?\n/),s=r.slice().sort((a,o)=>a.lineNum-o.lineNum);switch(t?.showSourceCode||"no"){case"all":let a=0;for(let o=1;o<=i.length;o++)for(n+=AW(i[o-1],o,t);s.length>a&&s[a].lineNum===o;){const u=s[a++];n+=EI(u,i,u.lineNum,{...t,inlineSource:!1})}for(;s.length>a;){const o=s[a++];n+=EI(o,[],0,{...t,inlineSource:!1})}return n;case"issues":case"no":for(const o of r)n+=EI(o,i,o.lineNum,{inlineSource:t?.showSourceCode!=="no"});return n}}function EI(r,e,t,n){if(n?.inlineSource){const s=Vpe(e,t),a=r.linePos>0?`${" ".repeat(r.linePos+5)}^^^
`:"";return`
${s}${a}${r.type.toUpperCase()}: ${r.message}

`}const i=r.type==="error"?"red":"#8B4000";return n?.html?`<div class='luma-compiler-log-error' style="color:${i};"><b> ${r.type.toUpperCase()}: ${r.message}</b></div>`:`${r.type.toUpperCase()}: ${r.message}`}function Vpe(r,e,t){let n="";for(let i=e-2;i<=e;i++){const s=r[i-1];s!==void 0&&(n+=AW(s,e,t))}return n}function AW(r,e,t){const n=t?.html?jpe(r):r;return`${$pe(String(e),4)}: ${n}${t?.html?"<br/>":`
`}`}function $pe(r,e){let t="";for(let n=r.length;n<e;++n)t+=" ";return t+r}function jpe(r){return r.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}const ET=class ET extends ri{constructor(t,n){n={...n,debugShaders:n.debugShaders||t.props.debugShaders||"errors"};super(t,{id:Gpe(n),...n},ET.defaultProps);H(this,"stage");H(this,"source");H(this,"compilationStatus","pending");this.stage=this.props.stage,this.source=this.props.source}get[Symbol.toStringTag](){return"Shader"}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){const t=this.props.debugShaders;switch(t){case"never":return;case"errors":if(this.compilationStatus==="success")return;break}const n=await this.getCompilationInfo();t==="warnings"&&n?.length===0||this._displayShaderLog(n,this.id)}_displayShaderLog(t,n){if(typeof document>"u"||!document?.createElement)return;const i=n,s=`${this.stage} shader "${i}"`;let a=zpe(t,this.source,{showSourceCode:"all",html:!0});const o=this.getTranslatedSource();o&&(a+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${o}</pre></code>`);const u=document.createElement("Button");u.innerHTML=`
<h1>Compilation error in ${s}</h1><br /><br />
<code style="user-select:text;"><pre>
${a}
</pre></code>`,u.style.top="10px",u.style.left="10px",u.style.position="absolute",u.style.zIndex="9999",u.style.width="100%",u.style.textAlign="left",document.body.appendChild(u),document.getElementsByClassName("luma-compiler-log-error")[0]?.scrollIntoView(),u.onclick=()=>{const g=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(g)}}};H(ET,"defaultProps",{...ri.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0});let OC=ET;function Gpe(r){return Hpe(r.source)||r.id||DS(`unnamed ${r.stage}-shader`)}function Hpe(r,e="unnamed"){const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(r);return n?n[1]:e}const IT=class IT extends ri{constructor(t,n={}){super(t,n,IT.defaultProps);H(this,"width");H(this,"height");this.width=this.props.width,this.height=this.props.height}get[Symbol.toStringTag](){return"Framebuffer"}clone(t){const n=this.colorAttachments.map(s=>s.texture.clone(t)),i=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone(t);return this.device.createFramebuffer({...this.props,colorAttachments:n,depthStencilAttachment:i})}resize(t){let n=!t;if(t){const[i,s]=Array.isArray(t)?t:[t.width,t.height];n=n||s!==this.height||i!==this.width,this.width=i,this.height=s}n&&(Bt.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(this.props.colorAttachments.length===0&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map((n,i)=>{if(typeof n=="string"){const s=this.createColorTexture(n,i);return this.attachResource(s),s.view}return n instanceof ca?n.view:n});const t=this.props.depthStencilAttachment;if(t)if(typeof t=="string"){const n=this.createDepthStencilTexture(t);this.attachResource(n),this.depthStencilAttachment=n.view}else t instanceof ca?this.depthStencilAttachment=t.view:this.depthStencilAttachment=t}createColorTexture(t,n){return this.device.createTexture({id:`${this.id}-color-attachment-${n}`,usage:ca.RENDER_ATTACHMENT,format:t,width:this.width,height:this.height,sampler:{magFilter:"linear",minFilter:"linear"}})}createDepthStencilTexture(t){return this.device.createTexture({id:`${this.id}-depth-stencil-attachment`,usage:ca.RENDER_ATTACHMENT,format:t,width:this.width,height:this.height})}resizeAttachments(t,n){for(let i=0;i<this.colorAttachments.length;++i)if(this.colorAttachments[i]){const s=this.colorAttachments[i].texture.clone({width:t,height:n});this.destroyAttachedResource(this.colorAttachments[i]),this.colorAttachments[i]=s.view,this.attachResource(s.view)}if(this.depthStencilAttachment){const i=this.depthStencilAttachment.texture.clone({width:t,height:n});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=i.view,this.attachResource(i)}this.updateAttachments()}};H(IT,"defaultProps",{...ri.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null});let DC=IT;const PT=class PT extends ri{constructor(t,n){super(t,n,PT.defaultProps);H(this,"shaderLayout");H(this,"bufferLayout");H(this,"linkStatus","pending");H(this,"hash","");this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}get[Symbol.toStringTag](){return"RenderPipeline"}};H(PT,"defaultProps",{...ri.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",colorAttachmentFormats:void 0,depthStencilAttachmentFormat:void 0,parameters:{},bindings:{},uniforms:{}});let Jf=PT;const Ul=class Ul extends ri{get[Symbol.toStringTag](){return"RenderPass"}constructor(e,t){t=Ul.normalizeProps(e,t),super(e,t,Ul.defaultProps)}static normalizeProps(e,t){return t}};H(Ul,"defaultClearColor",[0,0,0,1]),H(Ul,"defaultClearDepth",1),H(Ul,"defaultClearStencil",0),H(Ul,"defaultProps",{...ri.defaultProps,framebuffer:null,parameters:void 0,clearColor:Ul.defaultClearColor,clearColors:void 0,clearDepth:Ul.defaultClearDepth,clearStencil:Ul.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0});let Q3=Ul;const BT=class BT extends ri{constructor(t,n){super(t,n,BT.defaultProps);H(this,"hash","");H(this,"shaderLayout");this.shaderLayout=n.shaderLayout}get[Symbol.toStringTag](){return"ComputePipeline"}};H(BT,"defaultProps",{...ri.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0});let LC=BT;const MT=class MT extends ri{get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,t){super(e,t,MT.defaultProps)}};H(MT,"defaultProps",{...ri.defaultProps,measureExecutionTime:void 0});let eB=MT;const RT=class RT extends ri{get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,t){super(e,t,RT.defaultProps)}};H(RT,"defaultProps",{...ri.defaultProps});let tB=RT;function xW(r){return Jpe[r]}function Wpe(r){const[e,t]=Xpe[r],n=e==="i32"||e==="u32",i=e!=="u32",s=Kpe[e]*t;return{primitiveType:e,components:t,byteLength:s,integer:n,signed:i}}const Kpe={f32:4,f16:2,i32:4,u32:4},Xpe={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},Jpe={f32:{type:"f32",components:1},f16:{type:"f16",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<f16>":{type:"f16",components:2},"vec3<f16>":{type:"f16",components:3},"vec4<f16>":{type:"f16",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16},"mat2x2<f16>":{type:"f16",components:4},"mat2x3<f16>":{type:"f16",components:6},"mat2x4<f16>":{type:"f16",components:8},"mat3x2<f16>":{type:"f16",components:6},"mat3x3<f16>":{type:"f16",components:9},"mat3x4<f16>":{type:"f16",components:12},"mat4x2<f16>":{type:"f16",components:8},"mat4x3<f16>":{type:"f16",components:12},"mat4x4<f16>":{type:"f16",components:16},"mat2x2<i32>":{type:"i32",components:4},"mat2x3<i32>":{type:"i32",components:6},"mat2x4<i32>":{type:"i32",components:8},"mat3x2<i32>":{type:"i32",components:6},"mat3x3<i32>":{type:"i32",components:9},"mat3x4<i32>":{type:"i32",components:12},"mat4x2<i32>":{type:"i32",components:8},"mat4x3<i32>":{type:"i32",components:12},"mat4x4<i32>":{type:"i32",components:16},"mat2x2<u32>":{type:"u32",components:4},"mat2x3<u32>":{type:"u32",components:6},"mat2x4<u32>":{type:"u32",components:8},"mat3x2<u32>":{type:"u32",components:6},"mat3x3<u32>":{type:"u32",components:9},"mat3x4<u32>":{type:"u32",components:12},"mat4x2<u32>":{type:"u32",components:8},"mat4x3<u32>":{type:"u32",components:12},"mat4x4<u32>":{type:"u32",components:16}};function wW(r,e){const t={};for(const n of r.attributes){const i=Ype(r,e,n.name);i&&(t[n.name]=i)}return t}function qpe(r,e,t=16){const n=wW(r,e),i=new Array(t).fill(null);for(const s of Object.values(n))i[s.location]=s;return i}function Ype(r,e,t){const n=Zpe(r,t),i=Qpe(e,t);if(!n)return null;const s=Wpe(n.type),a=ppe(s),o=i?.vertexFormat||a,u=Zk(o);return{attributeName:i?.attributeName||n.name,bufferName:i?.bufferName||n.name,location:n.location,shaderType:n.type,primitiveType:s.primitiveType,shaderComponents:s.components,vertexFormat:o,bufferDataType:u.type,bufferComponents:u.components,normalized:u.normalized,integer:s.integer,stepMode:i?.stepMode||n.stepMode||"vertex",byteOffset:i?.byteOffset||0,byteStride:i?.byteStride||0}}function Zpe(r,e){const t=r.attributes.find(n=>n.name===e);return t||Bt.warn(`shader layout attribute "${e}" not present in shader`),t||null}function Qpe(r,e){ege(r);let t=tge(r,e);return t||(t=rge(r,e),t)?t:(Bt.warn(`layout for attribute "${e}" not present in buffer layout`),null)}function ege(r){for(const e of r)(e.attributes&&e.format||!e.attributes&&!e.format)&&Bt.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}function tge(r,e){for(const t of r)if(t.format&&t.name===e)return{attributeName:t.name,bufferName:e,stepMode:t.stepMode,vertexFormat:t.format,byteOffset:0,byteStride:t.byteStride||0};return null}function rge(r,e){for(const t of r){let n=t.byteStride;if(typeof t.byteStride!="number")for(const s of t.attributes||[]){const a=Zk(s.format);n+=a.byteLength}const i=t.attributes?.find(s=>s.attribute===e);if(i)return{attributeName:i.attribute,bufferName:t.name,stepMode:t.stepMode,vertexFormat:i.format,byteOffset:i.byteOffset,byteStride:n}}return null}const kT=class kT extends ri{constructor(t,n){super(t,n,kT.defaultProps);H(this,"maxVertexAttributes");H(this,"attributeInfos");H(this,"indexBuffer",null);H(this,"attributes");this.maxVertexAttributes=t.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null),this.attributeInfos=qpe(n.shaderLayout,n.bufferLayout,this.maxVertexAttributes)}get[Symbol.toStringTag](){return"VertexArray"}setConstantWebGL(t,n){this.device.reportError(new Error("constant attributes not supported"),this)()}};H(kT,"defaultProps",{...ri.defaultProps,shaderLayout:void 0,bufferLayout:[]});let rB=kT;const OT=class OT extends ri{get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,t){super(e,t,OT.defaultProps)}};H(OT,"defaultProps",{...ri.defaultProps,layout:void 0,buffers:{}});let nB=OT;const DT=class DT extends ri{get[Symbol.toStringTag](){return"QuerySet"}constructor(e,t){super(e,t,DT.defaultProps)}};H(DT,"defaultProps",{...ri.defaultProps,type:void 0,count:void 0});let iB=DT,X1;function CW(r){return(!X1||X1.byteLength<r)&&(X1=new ArrayBuffer(r)),X1}function nge(r,e){const t=CW(r.BYTES_PER_ELEMENT*e);return new r(t,0,e)}function ige(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function NC(r){return Array.isArray(r)?r.length===0||typeof r[0]=="number":ige(r)}const sge=1024;class oge{constructor(e,t={}){H(this,"layout",{});H(this,"byteLength");let n=0;for(const[s,a]of Object.entries(e)){const o=xW(a),{type:u,components:f}=o,g=f*(t?.[s]??1);n=hpe(n,g);const y=n;n+=g,this.layout[s]={type:u,size:g,offset:y}}n+=(4-n%4)%4;const i=n*4;this.byteLength=Math.max(i,sge)}getData(e){const t=CW(this.byteLength),n={i32:new Int32Array(t),u32:new Uint32Array(t),f32:new Float32Array(t),f16:new Uint16Array(t)};for(const[i,s]of Object.entries(e)){const a=this.layout[i];if(!a){Bt.warn(`Supplied uniform value ${i} not present in uniform block layout`)();continue}const{type:o,size:u,offset:f}=a,g=n[o];if(u===1){if(typeof s!="number"&&typeof s!="boolean"){Bt.warn(`Supplied value for single component uniform ${i} is not a number: ${s}`)();continue}g[f]=Number(s)}else{if(!NC(s)){Bt.warn(`Supplied value for multi component / array uniform ${i} is not a numeric array: ${s}`)();continue}g.set(s,f)}}return new Uint8Array(t,0,this.byteLength)}has(e){return!!this.layout[e]}get(e){return this.layout[e]}}function age(r,e,t=16){if(r!==e)return!1;const n=r,i=e;if(!NC(n))return!1;if(NC(i)&&n.length===i.length){for(let s=0;s<n.length;++s)if(i[s]!==n[s])return!1}return!0}function lge(r){return NC(r)?r.slice():r}class cge{constructor(e){H(this,"name");H(this,"uniforms",{});H(this,"modifiedUniforms",{});H(this,"modified",!0);H(this,"bindingLayout",{});H(this,"needsRedraw","initialized");if(this.name=e?.name||"unnamed",e?.name&&e?.shaderLayout){const t=e?.shaderLayout.bindings?.find(i=>i.type==="uniform"&&i.name===e?.name);if(!t)throw new Error(e?.name);const n=t;for(const i of n.uniforms||[])this.bindingLayout[i.name]=i}}setUniforms(e){for(const[t,n]of Object.entries(e))this._setUniform(t,n),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${t}=${n}`)}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,t){age(this.uniforms[e],t)||(this.uniforms[e]=lge(t),this.modifiedUniforms[e]=!0,this.modified=!0)}}class uge{constructor(e){H(this,"uniformBlocks",new Map);H(this,"uniformBufferLayouts",new Map);H(this,"uniformBuffers",new Map);for(const[t,n]of Object.entries(e)){const i=t,s=new oge(n.uniformTypes??{},n.uniformSizes??{});this.uniformBufferLayouts.set(i,s);const a=new cge({name:t});a.setUniforms(n.defaultUniforms||{}),this.uniformBlocks.set(i,a)}}destroy(){for(const e of this.uniformBuffers.values())e.destroy()}setUniforms(e){for(const[t,n]of Object.entries(e))this.uniformBlocks.get(t)?.setUniforms(n);this.updateUniformBuffers()}getUniformBufferByteLength(e){return this.uniformBufferLayouts.get(e)?.byteLength||0}getUniformBufferData(e){const t=this.uniformBlocks.get(e)?.getAllUniforms()||{};return this.uniformBufferLayouts.get(e)?.getData(t)}createUniformBuffer(e,t,n){n&&this.setUniforms(n);const i=this.getUniformBufferByteLength(t),s=e.createBuffer({usage:Li.UNIFORM|Li.COPY_DST,byteLength:i}),a=this.getUniformBufferData(t);return s.write(a),s}getManagedUniformBuffer(e,t){if(!this.uniformBuffers.get(t)){const n=this.getUniformBufferByteLength(t),i=e.createBuffer({usage:Li.UNIFORM|Li.COPY_DST,byteLength:n});this.uniformBuffers.set(t,i)}return this.uniformBuffers.get(t)}updateUniformBuffers(){let e=!1;for(const t of this.uniformBlocks.keys()){const n=this.updateUniformBuffer(t);e||(e=n)}return e&&Bt.log(3,`UniformStore.updateUniformBuffers(): ${e}`)(),e}updateUniformBuffer(e){const t=this.uniformBlocks.get(e);let n=this.uniformBuffers.get(e),i=!1;if(n&&t?.needsRedraw){i||(i=t.needsRedraw);const s=this.getUniformBufferData(e);n=this.uniformBuffers.get(e),n?.write(s);const a=this.uniformBlocks.get(e)?.getAllUniforms();Bt.log(4,`Writing to uniform buffer ${String(e)}`,s,a)()}return i}}let gl=class{constructor(e,t){this.name=e,this.attributes=t,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}get isPointer(){return!1}getTypeName(){return this.name}},E6=class{constructor(e,t,n){this.name=e,this.type=t,this.attributes=n,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}},sd=class extends gl{constructor(e,t){super(e,t),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}},yd=class extends gl{constructor(e,t){super(e,t),this.count=0,this.stride=0}get isArray(){return!0}getTypeName(){return`array<${this.format.getTypeName()}, ${this.count}>`}},sB=class extends gl{constructor(e,t,n){super(e,n),this.format=t}get isPointer(){return!0}getTypeName(){return`&${this.format.getTypeName()}`}},dp=class extends gl{constructor(e,t,n,i){super(e,n),this.format=t,this.access=i}get isTemplate(){return!0}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}};var Qh;(r=>{r[r.Uniform=0]="Uniform",r[r.Storage=1]="Storage",r[r.Texture=2]="Texture",r[r.Sampler=3]="Sampler",r[r.StorageTexture=4]="StorageTexture"})(Qh||(Qh={}));let J1=class{constructor(e,t,n,i,s,a,o){this.name=e,this.type=t,this.group=n,this.binding=i,this.attributes=s,this.resourceType=a,this.access=o}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}},hge=class{constructor(e,t){this.name=e,this.type=t}},dge=class{constructor(e,t,n,i){this.name=e,this.type=t,this.locationType=n,this.location=i,this.interpolation=null}},I6=class{constructor(e,t,n,i){this.name=e,this.type=t,this.locationType=n,this.location=i}},fge=class{constructor(e,t,n,i){this.name=e,this.type=t,this.attributes=n,this.id=i}},pge=class{constructor(e,t,n){this.name=e,this.type=t,this.attributes=n}},gge=class{constructor(e,t=null,n){this.stage=null,this.inputs=[],this.outputs=[],this.arguments=[],this.returnType=null,this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=t,this.attributes=n}},mge=class{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}};function yge(r){var e=(32768&r)>>15,t=(31744&r)>>10,n=1023&r;return t==0?(e?-1:1)*Math.pow(2,-14)*(n/Math.pow(2,10)):t==31?n?NaN:1/0*(e?-1:1):(e?-1:1)*Math.pow(2,t-15)*(1+n/Math.pow(2,10))}const TW=new Float32Array(1),bge=new Int32Array(TW.buffer),po=new Uint16Array(1);function _ge(r){TW[0]=r;const e=bge[0],t=e>>31&1;let n=e>>23&255,i=8388607&e;if(n===255)return po[0]=t<<15|31744|(i!==0?512:0),po[0];if(n===0){if(i===0)return po[0]=t<<15,po[0];i|=8388608;let s=113;for(;!(8388608&i);)i<<=1,s--;return n=127-s,i&=8388607,n>0?(i=(i>>126-n)+(i>>127-n&1),po[0]=t<<15|n<<10|i>>13,po[0]):(po[0]=t<<15,po[0])}return n=n-127+15,n>=31?(po[0]=t<<15|31744,po[0]):n<=0?n<-10?(po[0]=t<<15,po[0]):(i=(8388608|i)>>1-n,po[0]=t<<15|i>>13,po[0]):(i>>=13,po[0]=t<<15|n<<10|i,po[0])}const Qk=new Uint32Array(1),SW=new Float32Array(Qk.buffer,0,1);function P6(r){const e=112+(r>>6&31)<<23|(63&r)<<17;return Qk[0]=e,SW[0]}function vge(r,e,t,n,i,s,a,o,u){const f=n*(a>>=i)*(s>>=i)+t*a+e*o;switch(u){case"r8unorm":return[On(r,f,"8unorm",1)[0]];case"r8snorm":return[On(r,f,"8snorm",1)[0]];case"r8uint":return[On(r,f,"8uint",1)[0]];case"r8sint":return[On(r,f,"8sint",1)[0]];case"rg8unorm":{const g=On(r,f,"8unorm",2);return[g[0],g[1]]}case"rg8snorm":{const g=On(r,f,"8snorm",2);return[g[0],g[1]]}case"rg8uint":{const g=On(r,f,"8uint",2);return[g[0],g[1]]}case"rg8sint":{const g=On(r,f,"8sint",2);return[g[0],g[1]]}case"rgba8unorm-srgb":case"rgba8unorm":{const g=On(r,f,"8unorm",4);return[g[0],g[1],g[2],g[3]]}case"rgba8snorm":{const g=On(r,f,"8snorm",4);return[g[0],g[1],g[2],g[3]]}case"rgba8uint":{const g=On(r,f,"8uint",4);return[g[0],g[1],g[2],g[3]]}case"rgba8sint":{const g=On(r,f,"8sint",4);return[g[0],g[1],g[2],g[3]]}case"bgra8unorm-srgb":case"bgra8unorm":{const g=On(r,f,"8unorm",4);return[g[2],g[1],g[0],g[3]]}case"r16uint":return[On(r,f,"16uint",1)[0]];case"r16sint":return[On(r,f,"16sint",1)[0]];case"r16float":return[On(r,f,"16float",1)[0]];case"rg16uint":{const g=On(r,f,"16uint",2);return[g[0],g[1]]}case"rg16sint":{const g=On(r,f,"16sint",2);return[g[0],g[1]]}case"rg16float":{const g=On(r,f,"16float",2);return[g[0],g[1]]}case"rgba16uint":{const g=On(r,f,"16uint",4);return[g[0],g[1],g[2],g[3]]}case"rgba16sint":{const g=On(r,f,"16sint",4);return[g[0],g[1],g[2],g[3]]}case"rgba16float":{const g=On(r,f,"16float",4);return[g[0],g[1],g[2],g[3]]}case"r32uint":return[On(r,f,"32uint",1)[0]];case"r32sint":return[On(r,f,"32sint",1)[0]];case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return[On(r,f,"32float",1)[0]];case"rg32uint":{const g=On(r,f,"32uint",2);return[g[0],g[1]]}case"rg32sint":{const g=On(r,f,"32sint",2);return[g[0],g[1]]}case"rg32float":{const g=On(r,f,"32float",2);return[g[0],g[1]]}case"rgba32uint":{const g=On(r,f,"32uint",4);return[g[0],g[1],g[2],g[3]]}case"rgba32sint":{const g=On(r,f,"32sint",4);return[g[0],g[1],g[2],g[3]]}case"rgba32float":{const g=On(r,f,"32float",4);return[g[0],g[1],g[2],g[3]]}case"rg11b10ufloat":{const g=new Uint32Array(r.buffer,f,1)[0],y=(4192256&g)>>11,A=(4290772992&g)>>22;return[P6(2047&g),P6(y),function(C){const M=112+(C>>5&31)<<23|(31&C)<<18;return Qk[0]=M,SW[0]}(A),1]}}return null}function On(r,e,t,n){const i=[0,0,0,0];for(let s=0;s<n;++s)switch(t){case"8unorm":i[s]=r[e]/255,e++;break;case"8snorm":i[s]=r[e]/255*2-1,e++;break;case"8uint":i[s]=r[e],e++;break;case"8sint":i[s]=r[e]-127,e++;break;case"16uint":i[s]=r[e]|r[e+1]<<8,e+=2;break;case"16sint":i[s]=(r[e]|r[e+1]<<8)-32768,e+=2;break;case"16float":i[s]=yge(r[e]|r[e+1]<<8),e+=2;break;case"32uint":case"32sint":i[s]=r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24,e+=4;break;case"32float":i[s]=new Float32Array(r.buffer,e,1)[0],e+=4}return i}function jn(r,e,t,n,i){for(let s=0;s<n;++s)switch(t){case"8unorm":r[e]=255*i[s],e++;break;case"8snorm":r[e]=.5*(i[s]+1)*255,e++;break;case"8uint":r[e]=i[s],e++;break;case"8sint":r[e]=i[s]+127,e++;break;case"16uint":new Uint16Array(r.buffer,e,1)[0]=i[s],e+=2;break;case"16sint":new Int16Array(r.buffer,e,1)[0]=i[s],e+=2;break;case"16float":{const a=_ge(i[s]);new Uint16Array(r.buffer,e,1)[0]=a,e+=2;break}case"32uint":new Uint32Array(r.buffer,e,1)[0]=i[s],e+=4;break;case"32sint":new Int32Array(r.buffer,e,1)[0]=i[s],e+=4;break;case"32float":new Float32Array(r.buffer,e,1)[0]=i[s],e+=4}return i}const II={r8unorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8snorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8uint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8sint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg8unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8snorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"rgba8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8snorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},bgra8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bgra8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r16uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16float:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg16uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba16uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r32uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg32uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba32uint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32sint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32float:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rg11b10ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},stencil8:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!1,hasStencil:!0,channels:1},depth16unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},depth24plus:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,depthOnlyFormat:"depth32float",channels:1},"depth24plus-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,depthOnlyFormat:"depth32float",channels:1},depth32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},"depth32float-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,stencilOnlyFormat:"depth32float",channels:1},rgb9e5ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bc1-rgba-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc1-rgba-unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc4-r-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc4-r-snorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc5-rg-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc5-rg-snorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc6h-rgb-ufloat":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc6h-rgb-float":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"eac-r11unorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-r11snorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-rg11unorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"eac-rg11snorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"astc-4x4-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-4x4-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x5-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-5x5-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x6-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-6x6-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-8x5-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x5-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x6-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x6-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x8-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-8x8-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-10x5-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x5-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x6-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x6-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x8-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x8-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x10-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-10x10-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x12-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4},"astc-12x12-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4}};let Yc=class EW{constructor(){this.id=EW._id++,this.line=0}get isAstNode(){return!0}get astNodeType(){return""}search(e){e(this)}searchBlock(e,t){if(e){t(FC.instance);for(const n of e)n instanceof Array?this.searchBlock(n,t):n.search(t);t(UC.instance)}}constEvaluate(e,t){throw new Error("Cannot evaluate node")}constEvaluateString(e){return this.constEvaluate(e).toString()}};Yc._id=0;let FC=class extends Yc{};FC.instance=new FC;let UC=class extends Yc{};UC.instance=new UC;const IW=new Set(["all","all","any","select","arrayLength","abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","clamp","cos","cosh","countLeadingZeros","countOneBits","countTrailingZeros","cross","degrees","determinant","distance","dot","dot4U8Packed","dot4I8Packed","exp","exp2","extractBits","faceForward","firstLeadingBit","firstTrailingBit","floor","fma","fract","frexp","insertBits","inverseSqrt","ldexp","length","log","log2","max","min","mix","modf","normalize","pow","quantizeToF16","radians","reflect","refract","reverseBits","round","saturate","sign","sin","sinh","smoothStep","sqrt","step","tan","tanh","transpose","trunc","dpdx","dpdxCoarse","dpdxFine","dpdy","dpdyCoarse","dpdyFine","fwidth","fwidthCoarse","fwidthFine","textureDimensions","textureGather","textureGatherCompare","textureLoad","textureNumLayers","textureNumLevels","textureNumSamples","textureSample","textureSampleBias","textureSampleCompare","textureSampleCompareLevel","textureSampleGrad","textureSampleLevel","textureSampleBaseClampToEdge","textureStore","atomicLoad","atomicStore","atomicAdd","atomicSub","atomicMax","atomicMin","atomicAnd","atomicOr","atomicXor","atomicExchange","atomicCompareExchangeWeak","pack4x8snorm","pack4x8unorm","pack4xI8","pack4xU8","pack4x8Clamp","pack4xU8Clamp","pack2x16snorm","pack2x16unorm","pack2x16float","unpack4x8snorm","unpack4x8unorm","unpack4xI8","unpack4xU8","unpack2x16snorm","unpack2x16unorm","unpack2x16float","storageBarrier","textureBarrier","workgroupBarrier","workgroupUniformLoad","subgroupAdd","subgroupExclusiveAdd","subgroupInclusiveAdd","subgroupAll","subgroupAnd","subgroupAny","subgroupBallot","subgroupBroadcast","subgroupBroadcastFirst","subgroupElect","subgroupMax","subgroupMin","subgroupMul","subgroupExclusiveMul","subgroupInclusiveMul","subgroupOr","subgroupShuffle","subgroupShuffleDown","subgroupShuffleUp","subgroupShuffleXor","subgroupXor","quadBroadcast","quadSwapDiagonal","quadSwapX","quadSwapY"]);let Ri=class extends Yc{constructor(){super()}},$_=class extends Ri{constructor(e,t,n,i,s,a){super(),this.calls=new Set,this.name=e,this.args=t,this.returnType=n,this.body=i,this.startLine=s,this.endLine=a}get astNodeType(){return"function"}search(e){if(this.attributes)for(const t of this.attributes)e(t);e(this);for(const t of this.args)e(t);this.searchBlock(this.body,e)}},Age=class extends Ri{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}},PW=class extends Ri{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}},oB=class extends Ri{constructor(e,t){super(),this.body=e,this.loopId=t}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}},BW=class extends Ri{constructor(e,t,n,i){super(),this.init=e,this.condition=t,this.increment=n,this.body=i}get astNodeType(){return"for"}search(e){var t,n,i;(t=this.init)===null||t===void 0||t.search(e),(n=this.condition)===null||n===void 0||n.search(e),(i=this.increment)===null||i===void 0||i.search(e),this.searchBlock(this.body,e)}},Fu=class extends Ri{constructor(e,t,n,i,s){super(),this.attributes=null,this.name=e,this.type=t,this.storage=n,this.access=i,this.value=s}get astNodeType(){return"var"}search(e){var t;e(this),(t=this.value)===null||t===void 0||t.search(e)}},eO=class extends Ri{constructor(e,t,n){super(),this.attributes=null,this.name=e,this.type=t,this.value=n}get astNodeType(){return"override"}search(e){var t;(t=this.value)===null||t===void 0||t.search(e)}},q0=class extends Ri{constructor(e,t,n,i,s){super(),this.attributes=null,this.name=e,this.type=t,this.storage=n,this.access=i,this.value=s}get astNodeType(){return"let"}search(e){var t;e(this),(t=this.value)===null||t===void 0||t.search(e)}},_w=class extends Ri{constructor(e,t,n,i,s){super(),this.attributes=null,this.name=e,this.type=t,this.storage=n,this.access=i,this.value=s}get astNodeType(){return"const"}constEvaluate(e,t){return this.value.constEvaluate(e,t)}search(e){var t;e(this),(t=this.value)===null||t===void 0||t.search(e)}};var pm,C0,ot,We;(r=>{r.increment="++",r.decrement="--"})(pm||(pm={})),(r=>{r.parse=function(e){const t=e;if(t=="parse")throw new Error("Invalid value for IncrementOperator");return r[t]}})(pm||(pm={}));let MW=class extends Ri{constructor(e,t){super(),this.operator=e,this.variable=t}get astNodeType(){return"increment"}search(e){this.variable.search(e)}};(r=>{r.assign="=",r.addAssign="+=",r.subtractAssin="-=",r.multiplyAssign="*=",r.divideAssign="/=",r.moduloAssign="%=",r.andAssign="&=",r.orAssign="|=",r.xorAssign="^=",r.shiftLeftAssign="<<=",r.shiftRightAssign=">>="})(C0||(C0={})),(r=>{r.parse=function(e){const t=e;if(t=="parse")throw new Error("Invalid value for AssignOperator");return t}})(C0||(C0={}));let RW=class extends Ri{constructor(e,t,n){super(),this.operator=e,this.variable=t,this.value=n}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}},tO=class extends Ri{constructor(e,t){super(),this.name=e,this.args=t}get astNodeType(){return"call"}isBuiltin(){return IW.has(this.name)}search(e){for(const t of this.args)t.search(e);e(this)}},kW=class extends Ri{constructor(e,t){super(),this.body=e,this.continuing=t}get astNodeType(){return"loop"}search(e){var t;this.searchBlock(this.body,e),(t=this.continuing)===null||t===void 0||t.search(e)}},OW=class extends Ri{constructor(e,t){super(),this.condition=e,this.cases=t}get astNodeType(){return"switch"}search(e){e(this);for(const t of this.cases)t.search(e)}},DW=class extends Ri{constructor(e,t,n,i){super(),this.condition=e,this.body=t,this.elseif=n,this.else=i}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}},LW=class extends Ri{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var t;(t=this.value)===null||t===void 0||t.search(e)}},xge=class extends Ri{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}},wge=class extends Ri{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}},NW=class extends Ri{constructor(e,t){super(),this.severity=e,this.rule=t}get astNodeType(){return"diagnostic"}},rO=class extends Ri{constructor(e,t){super(),this.name=e,this.type=t}get astNodeType(){return"alias"}},Cge=class extends Ri{constructor(){super()}get astNodeType(){return"discard"}},FW=class extends Ri{constructor(){super(),this.condition=null,this.loopId=-1}get astNodeType(){return"break"}},UW=class extends Ri{constructor(){super(),this.loopId=-1}get astNodeType(){return"continue"}},Mt=class vw extends Ri{constructor(e){super(),this.attributes=null,this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}static maxFormatType(e){let t=e[0];if(t.name==="f32")return t;for(let n=1;n<e.length;++n){const i=vw._priority.get(t.name);vw._priority.get(e[n].name)<i&&(t=e[n])}return t.name==="x32"?vw.i32:t}getTypeName(){return this.name}};Mt.x32=new Mt("x32"),Mt.f32=new Mt("f32"),Mt.i32=new Mt("i32"),Mt.u32=new Mt("u32"),Mt.f16=new Mt("f16"),Mt.bool=new Mt("bool"),Mt.void=new Mt("void"),Mt._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);let B6=class extends Mt{constructor(e){super(e)}},Ou=class extends Mt{constructor(e,t,n,i){super(e),this.members=t,this.startLine=n,this.endLine=i}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let t=0;t<this.members.length;t++)if(this.members[t].name==e)return t;return-1}search(e){for(const t of this.members)e(t)}},Ye=class extends Mt{constructor(e,t,n){super(e),this.format=t,this.access=n}get astNodeType(){return"template"}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}};Ye.vec2f=new Ye("vec2",Mt.f32,null),Ye.vec3f=new Ye("vec3",Mt.f32,null),Ye.vec4f=new Ye("vec4",Mt.f32,null),Ye.vec2i=new Ye("vec2",Mt.i32,null),Ye.vec3i=new Ye("vec3",Mt.i32,null),Ye.vec4i=new Ye("vec4",Mt.i32,null),Ye.vec2u=new Ye("vec2",Mt.u32,null),Ye.vec3u=new Ye("vec3",Mt.u32,null),Ye.vec4u=new Ye("vec4",Mt.u32,null),Ye.vec2h=new Ye("vec2",Mt.f16,null),Ye.vec3h=new Ye("vec3",Mt.f16,null),Ye.vec4h=new Ye("vec4",Mt.f16,null),Ye.vec2b=new Ye("vec2",Mt.bool,null),Ye.vec3b=new Ye("vec3",Mt.bool,null),Ye.vec4b=new Ye("vec4",Mt.bool,null),Ye.mat2x2f=new Ye("mat2x2",Mt.f32,null),Ye.mat2x3f=new Ye("mat2x3",Mt.f32,null),Ye.mat2x4f=new Ye("mat2x4",Mt.f32,null),Ye.mat3x2f=new Ye("mat3x2",Mt.f32,null),Ye.mat3x3f=new Ye("mat3x3",Mt.f32,null),Ye.mat3x4f=new Ye("mat3x4",Mt.f32,null),Ye.mat4x2f=new Ye("mat4x2",Mt.f32,null),Ye.mat4x3f=new Ye("mat4x3",Mt.f32,null),Ye.mat4x4f=new Ye("mat4x4",Mt.f32,null),Ye.mat2x2h=new Ye("mat2x2",Mt.f16,null),Ye.mat2x3h=new Ye("mat2x3",Mt.f16,null),Ye.mat2x4h=new Ye("mat2x4",Mt.f16,null),Ye.mat3x2h=new Ye("mat3x2",Mt.f16,null),Ye.mat3x3h=new Ye("mat3x3",Mt.f16,null),Ye.mat3x4h=new Ye("mat3x4",Mt.f16,null),Ye.mat4x2h=new Ye("mat4x2",Mt.f16,null),Ye.mat4x3h=new Ye("mat4x3",Mt.f16,null),Ye.mat4x4h=new Ye("mat4x4",Mt.f16,null),Ye.mat2x2i=new Ye("mat2x2",Mt.i32,null),Ye.mat2x3i=new Ye("mat2x3",Mt.i32,null),Ye.mat2x4i=new Ye("mat2x4",Mt.i32,null),Ye.mat3x2i=new Ye("mat3x2",Mt.i32,null),Ye.mat3x3i=new Ye("mat3x3",Mt.i32,null),Ye.mat3x4i=new Ye("mat3x4",Mt.i32,null),Ye.mat4x2i=new Ye("mat4x2",Mt.i32,null),Ye.mat4x3i=new Ye("mat4x3",Mt.i32,null),Ye.mat4x4i=new Ye("mat4x4",Mt.i32,null),Ye.mat2x2u=new Ye("mat2x2",Mt.u32,null),Ye.mat2x3u=new Ye("mat2x3",Mt.u32,null),Ye.mat2x4u=new Ye("mat2x4",Mt.u32,null),Ye.mat3x2u=new Ye("mat3x2",Mt.u32,null),Ye.mat3x3u=new Ye("mat3x3",Mt.u32,null),Ye.mat3x4u=new Ye("mat3x4",Mt.u32,null),Ye.mat4x2u=new Ye("mat4x2",Mt.u32,null),Ye.mat4x3u=new Ye("mat4x3",Mt.u32,null),Ye.mat4x4u=new Ye("mat4x4",Mt.u32,null);let Aw=class extends Mt{constructor(e,t,n,i){super(e),this.storage=t,this.type=n,this.access=i}get astNodeType(){return"pointer"}},Y0=class extends Mt{constructor(e,t,n,i){super(e),this.attributes=t,this.format=n,this.count=i}get astNodeType(){return"array"}get isArray(){return!0}},T0=class extends Mt{constructor(e,t,n){super(e),this.format=t,this.access=n}get astNodeType(){return"sampler"}},sc=class extends Yc{constructor(){super(),this.postfix=null}},fp=class extends sc{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}constEvaluateString(){return this.value}},kc=class extends sc{constructor(e,t){super(),this.type=e,this.args=t}get astNodeType(){return"createExpr"}search(e){if(e(this),this.args)for(const t of this.args)t.search(e)}constEvaluate(e,t){return t&&(t[0]=this.type),e.evalExpression(this,e.context)}},nO=class extends sc{constructor(e,t){super(),this.cachedReturnValue=null,this.name=e,this.args=t}get astNodeType(){return"callExpr"}setCachedReturnValue(e){this.cachedReturnValue=e}get isBuiltin(){return IW.has(this.name)}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){for(const t of this.args)t.search(e);e(this)}};class La extends sc{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}constEvaluate(e,t){return e.evalExpression(this,e.context)}}let zW=class extends sc{constructor(e,t){super(),this.name=e,this.initializer=t}get astNodeType(){return"constExpr"}constEvaluate(e,t){if(this.initializer){const n=e.evalExpression(this.initializer,e.context);return n!==null&&this.postfix?n.getSubData(e,this.postfix,e.context):n}return null}search(e){this.initializer.search(e)}},Is=class extends sc{constructor(e,t){super(),this.value=e,this.type=t}get astNodeType(){return"literalExpr"}constEvaluate(e,t){return t!==void 0&&(t[0]=this.type),this.value}get isScalar(){return this.value instanceof Je}get isVector(){return this.value instanceof Se||this.value instanceof Vr}get scalarValue(){return this.value instanceof Je?this.value.value:(console.error("Value is not scalar."),0)}get vectorValue(){return this.value instanceof Se||this.value instanceof Vr?this.value.data:(console.error("Value is not a vector or matrix."),new Float32Array(0))}},VW=class extends sc{constructor(e,t){super(),this.type=e,this.value=t}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}},ty=class extends sc{constructor(e){super(),this.index=e}search(e){this.index.search(e)}},$W=class extends sc{constructor(){super()}},ms=class extends $W{constructor(e,t){super(),this.operator=e,this.right=t}get astNodeType(){return"unaryOp"}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){this.right.search(e)}},Fl=class extends $W{constructor(e,t,n){super(),this.operator=e,this.left=t,this.right=n}get astNodeType(){return"binaryOp"}_getPromotedType(e,t){return e.name===t.name?e:e.name==="f32"||t.name==="f32"?Mt.f32:e.name==="u32"||t.name==="u32"?Mt.u32:Mt.i32}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){this.left.search(e),this.right.search(e)}},jW=class extends Yc{constructor(e){super(),this.body=e}search(e){e(this),this.searchBlock(this.body,e)}},xw=class extends sc{constructor(){super()}get astNodeType(){return"default"}},GW=class extends jW{constructor(e,t){super(t),this.selectors=e}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}},HW=class extends jW{constructor(e){super(e)}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}},M6=class extends Yc{constructor(e,t,n){super(),this.name=e,this.type=t,this.attributes=n}get astNodeType(){return"argument"}},Tge=class extends Yc{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}},R6=class extends Yc{constructor(e,t,n){super(),this.name=e,this.type=t,this.attributes=n}get astNodeType(){return"member"}},WW=class extends Yc{constructor(e,t){super(),this.name=e,this.value=t}get astNodeType(){return"attribute"}},Xc=class KW{constructor(e,t){this.parent=null,this.typeInfo=e,this.parent=t,this.id=KW._id++}clone(){throw`Clone: Not implemented for ${this.constructor.name}`}setDataValue(e,t,n,i){console.error(`SetDataValue: Not implemented for ${this.constructor.name}`)}getSubData(e,t,n){return console.error(`GetDataValue: Not implemented for ${this.constructor.name}`),null}toString(){return`<${this.typeInfo.getTypeName()}>`}};Xc._id=0;let aB=class extends Xc{constructor(){super(new gl("void",null),null)}toString(){return"void"}};aB.void=new aB;let Dg=class extends Xc{constructor(e){super(new sB("pointer",e.typeInfo,null),null),this.reference=e}clone(){return this}setDataValue(e,t,n,i){this.reference.setDataValue(e,t,n,i)}getSubData(e,t,n){return t?this.reference.getSubData(e,t,n):this}toString(){return`&${this.reference.toString()}`}},Je=class S0 extends Xc{constructor(e,t,n=null){super(t,n),e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array?this.data=e:this.typeInfo.name==="x32"?e-Math.floor(e)!==0?this.data=new Float32Array([e]):this.data=e>=0?new Uint32Array([e]):new Int32Array([e]):this.typeInfo.name==="i32"||this.typeInfo.name==="bool"?this.data=new Int32Array([e]):this.typeInfo.name==="u32"?this.data=new Uint32Array([e]):this.typeInfo.name==="f32"||this.typeInfo.name==="f16"?this.data=new Float32Array([e]):console.error("ScalarData2: Invalid type",t)}clone(){if(this.data instanceof Float32Array)return new S0(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new S0(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new S0(new Uint32Array(this.data),this.typeInfo,null);throw"ScalarData: Invalid data type"}get value(){return this.data[0]}set value(e){this.data[0]=e}setDataValue(e,t,n,i){if(n)return void console.error("SetDataValue: Scalar data does not support postfix",n);if(!(t instanceof S0))return void console.error("SetDataValue: Invalid value",t);let s=t.data[0];this.typeInfo.name==="i32"||this.typeInfo.name==="u32"?s=Math.floor(s):this.typeInfo.name==="bool"&&(s=s?1:0),this.data[0]=s}getSubData(e,t,n){return t?(console.error("getSubData: Scalar data does not support postfix",t),null):this}toString(){return`${this.value}`}};function Sge(r,e,t){const n=e.length;return n===2?t==="f32"?new Se(new Float32Array(e),r.getTypeInfo("vec2f")):t==="i32"||t==="bool"?new Se(new Int32Array(e),r.getTypeInfo("vec2i")):t==="u32"?new Se(new Uint32Array(e),r.getTypeInfo("vec2u")):t==="f16"?new Se(new Float32Array(e),r.getTypeInfo("vec2h")):(console.error(`getSubData: Unknown format ${t}`),null):n===3?t==="f32"?new Se(new Float32Array(e),r.getTypeInfo("vec3f")):t==="i32"||t==="bool"?new Se(new Int32Array(e),r.getTypeInfo("vec3i")):t==="u32"?new Se(new Uint32Array(e),r.getTypeInfo("vec3u")):t==="f16"?new Se(new Float32Array(e),r.getTypeInfo("vec3h")):(console.error(`getSubData: Unknown format ${t}`),null):n===4?t==="f32"?new Se(new Float32Array(e),r.getTypeInfo("vec4f")):t==="i32"||t==="bool"?new Se(new Int32Array(e),r.getTypeInfo("vec4i")):t==="u32"?new Se(new Uint32Array(e),r.getTypeInfo("vec4u")):t==="f16"?new Se(new Float32Array(e),r.getTypeInfo("vec4h")):(console.error(`getSubData: Unknown format ${t}`),null):(console.error(`getSubData: Invalid vector size ${e.length}`),null)}let Se=class E0 extends Xc{constructor(e,t,n=null){if(super(t,n),e instanceof Float32Array||e instanceof Uint32Array||e instanceof Int32Array)this.data=e;else{const i=this.typeInfo.name;i==="vec2f"||i==="vec3f"||i==="vec4f"?this.data=new Float32Array(e):i==="vec2i"||i==="vec3i"||i==="vec4i"?this.data=new Int32Array(e):i==="vec2u"||i==="vec3u"||i==="vec4u"?this.data=new Uint32Array(e):i==="vec2h"||i==="vec3h"||i==="vec4h"?this.data=new Float32Array(e):i==="vec2b"||i==="vec3b"||i==="vec4b"?this.data=new Int32Array(e):i==="vec2"||i==="vec3"||i==="vec4"?this.data=new Float32Array(e):console.error(`VectorData: Invalid type ${i}`)}}clone(){if(this.data instanceof Float32Array)return new E0(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new E0(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new E0(new Uint32Array(this.data),this.typeInfo,null);throw"VectorData: Invalid data type"}setDataValue(e,t,n,i){n instanceof fp?console.error("TODO: Set vector postfix"):t instanceof E0?this.data=t.data:console.error("SetDataValue: Invalid value",t)}getSubData(e,t,n){if(t===null)return this;let i=e.getTypeInfo("f32");if(this.typeInfo instanceof dp)i=this.typeInfo.format||i;else{const a=this.typeInfo.name;a==="vec2f"||a==="vec3f"||a==="vec4f"?i=e.getTypeInfo("f32"):a==="vec2i"||a==="vec3i"||a==="vec4i"?i=e.getTypeInfo("i32"):a==="vec2b"||a==="vec3b"||a==="vec4b"?i=e.getTypeInfo("bool"):a==="vec2u"||a==="vec3u"||a==="vec4u"?i=e.getTypeInfo("u32"):a==="vec2h"||a==="vec3h"||a==="vec4h"?i=e.getTypeInfo("f16"):console.error(`GetSubData: Unknown type ${a}`)}let s=this;for(;t!==null&&s!==null;){if(t instanceof ty){const a=t.index;let o=-1;if(a instanceof Is){if(!(a.value instanceof Je))return console.error(`GetSubData: Invalid array index ${a.value}`),null;o=a.value.value}else{const u=e.evalExpression(a,n);if(!(u instanceof Je))return console.error("GetSubData: Unknown index type",a),null;o=u.value}if(o<0||o>=s.data.length)return console.error("GetSubData: Index out of range",o),null;if(s.data instanceof Float32Array){const u=new Float32Array(s.data.buffer,s.data.byteOffset+4*o,1);return new Je(u,i)}if(s.data instanceof Int32Array){const u=new Int32Array(s.data.buffer,s.data.byteOffset+4*o,1);return new Je(u,i)}if(s.data instanceof Uint32Array){const u=new Uint32Array(s.data.buffer,s.data.byteOffset+4*o,1);return new Je(u,i)}throw"GetSubData: Invalid data type"}if(!(t instanceof fp))return console.error("GetSubData: Unknown postfix",t),null;{const a=t.value.toLowerCase();if(a.length===1){let u=0;if(a==="x"||a==="r")u=0;else if(a==="y"||a==="g")u=1;else if(a==="z"||a==="b")u=2;else{if(a!=="w"&&a!=="a")return console.error(`GetSubData: Unknown member ${a}`),null;u=3}if(this.data instanceof Float32Array){let f=new Float32Array(this.data.buffer,this.data.byteOffset+4*u,1);return new Je(f,i,this)}if(this.data instanceof Int32Array){let f=new Int32Array(this.data.buffer,this.data.byteOffset+4*u,1);return new Je(f,i,this)}if(this.data instanceof Uint32Array){let f=new Uint32Array(this.data.buffer,this.data.byteOffset+4*u,1);return new Je(f,i,this)}}const o=[];for(const u of a)u==="x"||u==="r"?o.push(this.data[0]):u==="y"||u==="g"?o.push(this.data[1]):u==="z"||u==="b"?o.push(this.data[2]):u==="w"||u==="a"?o.push(this.data[3]):console.error(`GetDataValue: Unknown member ${u}`);s=Sge(e,o,i.name)}t=t.postfix}return s}toString(){let e=`${this.data[0]}`;for(let t=1;t<this.data.length;++t)e+=`, ${this.data[t]}`;return e}},Vr=class lB extends Xc{constructor(e,t,n=null){super(t,n),e instanceof Float32Array?this.data=e:this.data=new Float32Array(e)}clone(){return new lB(new Float32Array(this.data),this.typeInfo,null)}setDataValue(e,t,n,i){n instanceof fp?console.error("TODO: Set matrix postfix"):t instanceof lB?this.data=t.data:console.error("SetDataValue: Invalid value",t)}getSubData(e,t,n){if(t===null)return this;const i=this.typeInfo.name;if(e.getTypeInfo("f32"),this.typeInfo instanceof dp)this.typeInfo.format;else if(i.endsWith("f"))e.getTypeInfo("f32");else if(i.endsWith("i"))e.getTypeInfo("i32");else if(i.endsWith("u"))e.getTypeInfo("u32");else{if(!i.endsWith("h"))return console.error(`GetDataValue: Unknown type ${i}`),null;e.getTypeInfo("f16")}if(t instanceof ty){const s=t.index;let a=-1;if(s instanceof Is){if(!(s.value instanceof Je))return console.error(`GetDataValue: Invalid array index ${s.value}`),null;a=s.value.value}else{const f=e.evalExpression(s,n);if(!(f instanceof Je))return console.error("GetDataValue: Unknown index type",s),null;a=f.value}if(a<0||a>=this.data.length)return console.error("GetDataValue: Index out of range",a),null;const o=i.endsWith("h")?"h":"f";let u;if(i==="mat2x2"||i==="mat2x2f"||i==="mat2x2h"||i==="mat3x2"||i==="mat3x2f"||i==="mat3x2h"||i==="mat4x2"||i==="mat4x2f"||i==="mat4x2h")u=new Se(new Float32Array(this.data.buffer,this.data.byteOffset+2*a*4,2),e.getTypeInfo(`vec2${o}`));else if(i==="mat2x3"||i==="mat2x3f"||i==="mat2x3h"||i==="mat3x3"||i==="mat3x3f"||i==="mat3x3h"||i==="mat4x3"||i==="mat4x3f"||i==="mat4x3h")u=new Se(new Float32Array(this.data.buffer,this.data.byteOffset+3*a*4,3),e.getTypeInfo(`vec3${o}`));else{if(i!=="mat2x4"&&i!=="mat2x4f"&&i!=="mat2x4h"&&i!=="mat3x4"&&i!=="mat3x4f"&&i!=="mat3x4h"&&i!=="mat4x4"&&i!=="mat4x4f"&&i!=="mat4x4h")return console.error(`GetDataValue: Unknown type ${i}`),null;u=new Se(new Float32Array(this.data.buffer,this.data.byteOffset+4*a*4,4),e.getTypeInfo(`vec4${o}`))}return t.postfix?u.getSubData(e,t.postfix,n):u}return console.error("GetDataValue: Invalid postfix",t),null}toString(){let e=`${this.data[0]}`;for(let t=1;t<this.data.length;++t)e+=`, ${this.data[t]}`;return e}},Vs=class ww extends Xc{constructor(e,t,n=0,i=null){super(t,i),this.buffer=e instanceof ArrayBuffer?e:e.buffer,this.offset=n}clone(){const e=new Uint8Array(new Uint8Array(this.buffer,this.offset,this.typeInfo.size));return new ww(e.buffer,this.typeInfo,0,null)}setDataValue(e,t,n,i){if(t===null)return void console.log("setDataValue: NULL data.");let s=this.offset,a=this.typeInfo;for(;n;){if(n instanceof ty)if(a instanceof yd){const o=n.index;if(o instanceof Is){if(!(o.value instanceof Je))return void console.error(`SetDataValue: Invalid index type ${o.value}`);s+=o.value.value*a.stride}else{const u=e.evalExpression(o,i);if(!(u instanceof Je))return void console.error("SetDataValue: Unknown index type",o);s+=u.value*a.stride}a=a.format}else console.error(`SetDataValue: Type ${a.getTypeName()} is not an array`);else{if(!(n instanceof fp))return void console.error("SetDataValue: Unknown postfix type",n);{const o=n.value;if(a instanceof sd){let u=!1;for(const f of a.members)if(f.name===o){s+=f.offset,a=f.type,u=!0;break}if(!u)return void console.error(`SetDataValue: Member ${o} not found`)}else if(a instanceof gl){const u=a.getTypeName();let f=0;if(o==="x"||o==="r")f=0;else if(o==="y"||o==="g")f=1;else if(o==="z"||o==="b")f=2;else{if(o!=="w"&&o!=="a")return void console.error(`SetDataValue: Unknown member ${o}`);f=3}if(!(t instanceof Je))return void console.error("SetDataValue: Invalid value",t);const g=t.value;return u==="vec2f"?void(new Float32Array(this.buffer,s,2)[f]=g):u==="vec3f"?void(new Float32Array(this.buffer,s,3)[f]=g):u==="vec4f"?void(new Float32Array(this.buffer,s,4)[f]=g):u==="vec2i"?void(new Int32Array(this.buffer,s,2)[f]=g):u==="vec3i"?void(new Int32Array(this.buffer,s,3)[f]=g):u==="vec4i"?void(new Int32Array(this.buffer,s,4)[f]=g):u==="vec2u"?void(new Uint32Array(this.buffer,s,2)[f]=g):u==="vec3u"?void(new Uint32Array(this.buffer,s,3)[f]=g):u==="vec4u"?void(new Uint32Array(this.buffer,s,4)[f]=g):void console.error(`SetDataValue: Type ${u} is not a struct`)}}}n=n.postfix}this.setData(e,t,a,s,i)}setData(e,t,n,i,s){const a=n.getTypeName();if(a!=="f32"&&a!=="f16")if(a!=="i32"&&a!=="atomic<i32>"&&a!=="x32")if(a!=="u32"&&a!=="atomic<u32>")if(a!=="bool"){if(a==="vec2f"||a==="vec2h"){const o=new Float32Array(this.buffer,i,2);return void(t instanceof Se?(o[0]=t.data[0],o[1]=t.data[1]):(o[0]=t[0],o[1]=t[1]))}if(a==="vec3f"||a==="vec3h"){const o=new Float32Array(this.buffer,i,3);return void(t instanceof Se?(o[0]=t.data[0],o[1]=t.data[1],o[2]=t.data[2]):(o[0]=t[0],o[1]=t[1],o[2]=t[2]))}if(a==="vec4f"||a==="vec4h"){const o=new Float32Array(this.buffer,i,4);return void(t instanceof Se?(o[0]=t.data[0],o[1]=t.data[1],o[2]=t.data[2],o[3]=t.data[3]):(o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3]))}if(a==="vec2i"){const o=new Int32Array(this.buffer,i,2);return void(t instanceof Se?(o[0]=t.data[0],o[1]=t.data[1]):(o[0]=t[0],o[1]=t[1]))}if(a==="vec3i"){const o=new Int32Array(this.buffer,i,3);return void(t instanceof Se?(o[0]=t.data[0],o[1]=t.data[1],o[2]=t.data[2]):(o[0]=t[0],o[1]=t[1],o[2]=t[2]))}if(a==="vec4i"){const o=new Int32Array(this.buffer,i,4);return void(t instanceof Se?(o[0]=t.data[0],o[1]=t.data[1],o[2]=t.data[2],o[3]=t.data[3]):(o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3]))}if(a==="vec2u"){const o=new Uint32Array(this.buffer,i,2);return void(t instanceof Se?(o[0]=t.data[0],o[1]=t.data[1]):(o[0]=t[0],o[1]=t[1]))}if(a==="vec3u"){const o=new Uint32Array(this.buffer,i,3);return void(t instanceof Se?(o[0]=t.data[0],o[1]=t.data[1],o[2]=t.data[2]):(o[0]=t[0],o[1]=t[1],o[2]=t[2]))}if(a==="vec4u"){const o=new Uint32Array(this.buffer,i,4);return void(t instanceof Se?(o[0]=t.data[0],o[1]=t.data[1],o[2]=t.data[2],o[3]=t.data[3]):(o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3]))}if(a==="vec2b"){const o=new Uint32Array(this.buffer,i,2);return void(t instanceof Se?(o[0]=t.data[0],o[1]=t.data[1]):(o[0]=t[0],o[1]=t[1]))}if(a==="vec3b"){const o=new Uint32Array(this.buffer,i,3);return void(t instanceof Se?(o[0]=t.data[0],o[1]=t.data[1],o[2]=t.data[2]):(o[0]=t[0],o[1]=t[1],o[2]=t[2]))}if(a==="vec4b"){const o=new Uint32Array(this.buffer,i,4);return void(t instanceof Se?(o[0]=t.data[0],o[1]=t.data[1],o[2]=t.data[2],o[3]=t.data[3]):(o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3]))}if(a==="mat2x2f"||a==="mat2x2h"){const o=new Float32Array(this.buffer,i,4);return void(t instanceof Vr?(o[0]=t.data[0],o[1]=t.data[1],o[2]=t.data[2],o[3]=t.data[3]):(o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3]))}if(a==="mat2x3f"||a==="mat2x3h"){const o=new Float32Array(this.buffer,i,6);return void(t instanceof Vr?(o[0]=t.data[0],o[1]=t.data[1],o[2]=t.data[2],o[3]=t.data[3],o[4]=t.data[4],o[5]=t.data[5]):(o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[4]=t[4],o[5]=t[5]))}if(a==="mat2x4f"||a==="mat2x4h"){const o=new Float32Array(this.buffer,i,8);return void(t instanceof Vr?(o[0]=t.data[0],o[1]=t.data[1],o[2]=t.data[2],o[3]=t.data[3],o[4]=t.data[4],o[5]=t.data[5],o[6]=t.data[6],o[7]=t.data[7]):(o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[4]=t[4],o[5]=t[5],o[6]=t[6],o[7]=t[7]))}if(a==="mat3x2f"||a==="mat3x2h"){const o=new Float32Array(this.buffer,i,6);return void(t instanceof Vr?(o[0]=t.data[0],o[1]=t.data[1],o[2]=t.data[2],o[3]=t.data[3],o[4]=t.data[4],o[5]=t.data[5]):(o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[4]=t[4],o[5]=t[5]))}if(a==="mat3x3f"||a==="mat3x3h"){const o=new Float32Array(this.buffer,i,9);return void(t instanceof Vr?(o[0]=t.data[0],o[1]=t.data[1],o[2]=t.data[2],o[3]=t.data[3],o[4]=t.data[4],o[5]=t.data[5],o[6]=t.data[6],o[7]=t.data[7],o[8]=t.data[8]):(o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[4]=t[4],o[5]=t[5],o[6]=t[6],o[7]=t[7],o[8]=t[8]))}if(a==="mat3x4f"||a==="mat3x4h"){const o=new Float32Array(this.buffer,i,12);return void(t instanceof Vr?(o[0]=t.data[0],o[1]=t.data[1],o[2]=t.data[2],o[3]=t.data[3],o[4]=t.data[4],o[5]=t.data[5],o[6]=t.data[6],o[7]=t.data[7],o[8]=t.data[8],o[9]=t.data[9],o[10]=t.data[10],o[11]=t.data[11]):(o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[4]=t[4],o[5]=t[5],o[6]=t[6],o[7]=t[7],o[8]=t[8],o[9]=t[9],o[10]=t[10],o[11]=t[11]))}if(a==="mat4x2f"||a==="mat4x2h"){const o=new Float32Array(this.buffer,i,8);return void(t instanceof Vr?(o[0]=t.data[0],o[1]=t.data[1],o[2]=t.data[2],o[3]=t.data[3],o[4]=t.data[4],o[5]=t.data[5],o[6]=t.data[6],o[7]=t.data[7]):(o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[4]=t[4],o[5]=t[5],o[6]=t[6],o[7]=t[7]))}if(a==="mat4x3f"||a==="mat4x3h"){const o=new Float32Array(this.buffer,i,12);return void(t instanceof Vr?(o[0]=t.data[0],o[1]=t.data[1],o[2]=t.data[2],o[3]=t.data[3],o[4]=t.data[4],o[5]=t.data[5],o[6]=t.data[6],o[7]=t.data[7],o[8]=t.data[8],o[9]=t.data[9],o[10]=t.data[10],o[11]=t.data[11]):(o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[4]=t[4],o[5]=t[5],o[6]=t[6],o[7]=t[7],o[8]=t[8],o[9]=t[9],o[10]=t[10],o[11]=t[11]))}if(a==="mat4x4f"||a==="mat4x4h"){const o=new Float32Array(this.buffer,i,16);return void(t instanceof Vr?(o[0]=t.data[0],o[1]=t.data[1],o[2]=t.data[2],o[3]=t.data[3],o[4]=t.data[4],o[5]=t.data[5],o[6]=t.data[6],o[7]=t.data[7],o[8]=t.data[8],o[9]=t.data[9],o[10]=t.data[10],o[11]=t.data[11],o[12]=t.data[12],o[13]=t.data[13],o[14]=t.data[14],o[15]=t.data[15]):(o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[4]=t[4],o[5]=t[5],o[6]=t[6],o[7]=t[7],o[8]=t[8],o[9]=t[9],o[10]=t[10],o[11]=t[11],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15]))}if(t instanceof ww){if(n===t.typeInfo)return void new Uint8Array(this.buffer,i,t.buffer.byteLength).set(new Uint8Array(t.buffer));console.error("SetDataValue: Type mismatch",a,t.typeInfo.getTypeName())}else console.error(`SetData: Unknown type ${a}`)}else t instanceof Je&&(new Int32Array(this.buffer,i,1)[0]=t.value);else t instanceof Je&&(new Uint32Array(this.buffer,i,1)[0]=t.value);else t instanceof Je&&(new Int32Array(this.buffer,i,1)[0]=t.value);else t instanceof Je&&(new Float32Array(this.buffer,i,1)[0]=t.value)}getSubData(e,t,n){var i,s,a;if(t===null)return this;let o=this.offset,u=this.typeInfo;for(;t;){if(t instanceof ty){const g=t.index,y=g instanceof sc?e.evalExpression(g,n):g;let A=0;if(y instanceof Je?A=y.value:typeof y=="number"?A=y:console.error("GetDataValue: Invalid index type",g),u instanceof yd)o+=A*u.stride,u=u.format;else{const C=u.getTypeName();C==="mat4x4"||C==="mat4x4f"||C==="mat4x4h"?(o+=16*A,u=e.getTypeInfo("vec4f")):console.error(`getDataValue: Type ${u.getTypeName()} is not an array`)}}else{if(!(t instanceof fp))return console.error("GetDataValue: Unknown postfix type",t),null;{const g=t.value;if(u instanceof sd){let y=!1;for(const A of u.members)if(A.name===g){o+=A.offset,u=A.type,y=!0;break}if(!y)return console.error(`GetDataValue: Member ${g} not found`),null}else if(u instanceof gl){const y=u.getTypeName();if(y==="vec2f"||y==="vec3f"||y==="vec4f"||y==="vec2i"||y==="vec3i"||y==="vec4i"||y==="vec2u"||y==="vec3u"||y==="vec4u"||y==="vec2b"||y==="vec3b"||y==="vec4b"||y==="vec2h"||y==="vec3h"||y==="vec4h"||y==="vec2"||y==="vec3"||y==="vec4"){if(g.length>0&&g.length<5){let A="f";const C=[];for(let M=0;M<g.length;++M){const k=g[M].toLowerCase();let D=0;if(k==="x"||k==="r")D=0;else if(k==="y"||k==="g")D=1;else if(k==="z"||k==="b")D=2;else{if(k!=="w"&&k!=="a")return console.error(`Unknown member ${g}`),null;D=3}if(g.length===1){if(y.endsWith("f"))return this.buffer.byteLength<o+4*D+4?(console.log("Insufficient buffer data"),null):new Je(new Float32Array(this.buffer,o+4*D,1),e.getTypeInfo("f32"),this);if(y.endsWith("h"))return new Je(new Float32Array(this.buffer,o+4*D,1),e.getTypeInfo("f16"),this);if(y.endsWith("i"))return new Je(new Int32Array(this.buffer,o+4*D,1),e.getTypeInfo("i32"),this);if(y.endsWith("b"))return new Je(new Int32Array(this.buffer,o+4*D,1),e.getTypeInfo("bool"),this);if(y.endsWith("u"))return new Je(new Uint32Array(this.buffer,o+4*D,1),e.getTypeInfo("i32"),this)}if(y==="vec2f")C.push(new Float32Array(this.buffer,o,2)[D]);else if(y==="vec3f"){if(o+12>=this.buffer.byteLength)return console.log("Insufficient buffer data"),null;const V=new Float32Array(this.buffer,o,3);C.push(V[D])}else if(y==="vec4f")C.push(new Float32Array(this.buffer,o,4)[D]);else if(y==="vec2i")A="i",C.push(new Int32Array(this.buffer,o,2)[D]);else if(y==="vec3i")A="i",C.push(new Int32Array(this.buffer,o,3)[D]);else if(y==="vec4i")A="i",C.push(new Int32Array(this.buffer,o,4)[D]);else if(y==="vec2u"){A="u";const V=new Uint32Array(this.buffer,o,2);C.push(V[D])}else y==="vec3u"?(A="u",C.push(new Uint32Array(this.buffer,o,3)[D])):y==="vec4u"&&(A="u",C.push(new Uint32Array(this.buffer,o,4)[D]))}return C.length===2?u=e.getTypeInfo(`vec2${A}`):C.length===3?u=e.getTypeInfo(`vec3${A}`):C.length===4?u=e.getTypeInfo(`vec4${A}`):console.error(`GetDataValue: Invalid vector length ${C.length}`),new Se(C,u,null)}return console.error(`GetDataValue: Unknown member ${g}`),null}return console.error(`GetDataValue: Type ${y} is not a struct`),null}}}t=t.postfix}const f=u.getTypeName();return f==="f32"?new Je(new Float32Array(this.buffer,o,1),u,this):f==="i32"?new Je(new Int32Array(this.buffer,o,1),u,this):f==="u32"?new Je(new Uint32Array(this.buffer,o,1),u,this):f==="vec2f"?new Se(new Float32Array(this.buffer,o,2),u,this):f==="vec3f"?new Se(new Float32Array(this.buffer,o,3),u,this):f==="vec4f"?new Se(new Float32Array(this.buffer,o,4),u,this):f==="vec2i"?new Se(new Int32Array(this.buffer,o,2),u,this):f==="vec3i"?new Se(new Int32Array(this.buffer,o,3),u,this):f==="vec4i"?new Se(new Int32Array(this.buffer,o,4),u,this):f==="vec2u"?new Se(new Uint32Array(this.buffer,o,2),u,this):f==="vec3u"?new Se(new Uint32Array(this.buffer,o,3),u,this):f==="vec4u"?new Se(new Uint32Array(this.buffer,o,4),u,this):u instanceof dp&&u.name==="atomic"?((i=u.format)===null||i===void 0?void 0:i.name)==="u32"?new Je(new Uint32Array(this.buffer,o,1)[0],u.format,this):((s=u.format)===null||s===void 0?void 0:s.name)==="i32"?new Je(new Int32Array(this.buffer,o,1)[0],u.format,this):(console.error(`GetDataValue: Invalid atomic format ${(a=u.format)===null||a===void 0?void 0:a.name}`),null):new ww(this.buffer,u,o,this)}toString(){let e="";if(this.typeInfo instanceof yd)if(this.typeInfo.format.name==="f32"){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let n=1;n<t.length;++n)e+=`, ${t[n]}`}else if(this.typeInfo.format.name==="i32"){const t=new Int32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let n=1;n<t.length;++n)e+=`, ${t[n]}`}else if(this.typeInfo.format.name==="u32"){const t=new Uint32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let n=1;n<t.length;++n)e+=`, ${t[n]}`}else if(this.typeInfo.format.name==="vec2f"){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}]`;for(let n=1;n<t.length/2;++n)e+=`, [${t[2*n]}, ${t[2*n+1]}]`}else if(this.typeInfo.format.name==="vec3f"){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}, ${t[2]}]`;for(let n=4;n<t.length;n+=4)e+=`, [${t[n]}, ${t[n+1]}, ${t[n+2]}]`}else if(this.typeInfo.format.name==="vec4f"){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}, ${t[2]}, ${t[3]}]`;for(let n=4;n<t.length;n+=4)e+=`, [${t[n]}, ${t[n+1]}, ${t[n+2]}, ${t[n+3]}]`}else e="[...]";else this.typeInfo instanceof sd?e+="{...}":e="[...]";return e}};class Du extends Xc{constructor(e,t,n,i){super(t,null),this.data=e,this.descriptor=n,this.view=i}clone(){return new Du(this.data,this.typeInfo,this.descriptor,this.view)}get width(){var e,t;const n=this.descriptor.size;return n instanceof Array&&n.length>0?(e=n[0])!==null&&e!==void 0?e:0:n instanceof Object&&(t=n.width)!==null&&t!==void 0?t:0}get height(){var e,t;const n=this.descriptor.size;return n instanceof Array&&n.length>1?(e=n[1])!==null&&e!==void 0?e:0:n instanceof Object&&(t=n.height)!==null&&t!==void 0?t:0}get depthOrArrayLayers(){var e,t;const n=this.descriptor.size;return n instanceof Array&&n.length>2?(e=n[2])!==null&&e!==void 0?e:0:n instanceof Object&&(t=n.depthOrArrayLayers)!==null&&t!==void 0?t:0}get format(){var e;return this.descriptor&&(e=this.descriptor.format)!==null&&e!==void 0?e:"rgba8unorm"}get sampleCount(){var e;return this.descriptor&&(e=this.descriptor.sampleCount)!==null&&e!==void 0?e:1}get mipLevelCount(){var e;return this.descriptor&&(e=this.descriptor.mipLevelCount)!==null&&e!==void 0?e:1}get dimension(){var e;return this.descriptor&&(e=this.descriptor.dimension)!==null&&e!==void 0?e:"2d"}getMipLevelSize(e){if(e>=this.mipLevelCount)return[0,0,0];const t=[this.width,this.height,this.depthOrArrayLayers];for(let n=0;n<t.length;++n)t[n]=Math.max(1,t[n]>>e);return t}get texelByteSize(){const e=this.format,t=II[e];return t?t.isDepthStencil?4:t.bytesPerBlock:0}get bytesPerRow(){return this.width*this.texelByteSize}get isDepthStencil(){const e=this.format,t=II[e];return!!t&&t.isDepthStencil}getGpuSize(){const e=this.format,t=II[e],n=this.width;if(!e||n<=0||!t)return-1;const i=this.height,s=this.depthOrArrayLayers,a=this.dimension;return n/t.blockWidth*(a==="1d"?1:i/t.blockHeight)*t.bytesPerBlock*s}getPixel(e,t,n=0,i=0){const s=this.texelByteSize,a=this.bytesPerRow,o=this.height,u=this.data[i];return vge(new Uint8Array(u),e,t,n,i,o,a,s,this.format)}setPixel(e,t,n,i,s){const a=this.texelByteSize,o=this.bytesPerRow,u=this.height,f=this.data[i];(function(g,y,A,C,M,k,D,V,W,z){const $=C*(D>>=M)*(k>>=M)+A*D+y*V;switch(W){case"r8unorm":return void jn(g,$,"8unorm",1,z);case"r8snorm":return void jn(g,$,"8snorm",1,z);case"r8uint":return void jn(g,$,"8uint",1,z);case"r8sint":return void jn(g,$,"8sint",1,z);case"rg8unorm":return void jn(g,$,"8unorm",2,z);case"rg8snorm":return void jn(g,$,"8snorm",2,z);case"rg8uint":return void jn(g,$,"8uint",2,z);case"rg8sint":return void jn(g,$,"8sint",2,z);case"rgba8unorm-srgb":case"rgba8unorm":case"bgra8unorm-srgb":case"bgra8unorm":return void jn(g,$,"8unorm",4,z);case"rgba8snorm":return void jn(g,$,"8snorm",4,z);case"rgba8uint":return void jn(g,$,"8uint",4,z);case"rgba8sint":return void jn(g,$,"8sint",4,z);case"r16uint":return void jn(g,$,"16uint",1,z);case"r16sint":return void jn(g,$,"16sint",1,z);case"r16float":return void jn(g,$,"16float",1,z);case"rg16uint":return void jn(g,$,"16uint",2,z);case"rg16sint":return void jn(g,$,"16sint",2,z);case"rg16float":return void jn(g,$,"16float",2,z);case"rgba16uint":return void jn(g,$,"16uint",4,z);case"rgba16sint":return void jn(g,$,"16sint",4,z);case"rgba16float":return void jn(g,$,"16float",4,z);case"r32uint":return void jn(g,$,"32uint",1,z);case"r32sint":return void jn(g,$,"32sint",1,z);case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return void jn(g,$,"32float",1,z);case"rg32uint":return void jn(g,$,"32uint",2,z);case"rg32sint":return void jn(g,$,"32sint",2,z);case"rg32float":return void jn(g,$,"32float",2,z);case"rgba32uint":return void jn(g,$,"32uint",4,z);case"rgba32sint":return void jn(g,$,"32sint",4,z);case"rgba32float":return void jn(g,$,"32float",4,z);case"rg11b10ufloat":console.error("TODO: rg11b10ufloat not supported for writing")}})(new Uint8Array(f),e,t,n,i,u,o,a,this.format,s)}}(r=>{r[r.token=0]="token",r[r.keyword=1]="keyword",r[r.reserved=2]="reserved"})(We||(We={}));let Xe=class{constructor(e,t,n){this.name=e,this.type=t,this.rule=n}toString(){return this.name}},be=class{};ot=be,be.none=new Xe("",We.reserved,""),be.eof=new Xe("EOF",We.token,""),be.reserved={asm:new Xe("asm",We.reserved,"asm"),bf16:new Xe("bf16",We.reserved,"bf16"),do:new Xe("do",We.reserved,"do"),enum:new Xe("enum",We.reserved,"enum"),f16:new Xe("f16",We.reserved,"f16"),f64:new Xe("f64",We.reserved,"f64"),handle:new Xe("handle",We.reserved,"handle"),i8:new Xe("i8",We.reserved,"i8"),i16:new Xe("i16",We.reserved,"i16"),i64:new Xe("i64",We.reserved,"i64"),mat:new Xe("mat",We.reserved,"mat"),premerge:new Xe("premerge",We.reserved,"premerge"),regardless:new Xe("regardless",We.reserved,"regardless"),typedef:new Xe("typedef",We.reserved,"typedef"),u8:new Xe("u8",We.reserved,"u8"),u16:new Xe("u16",We.reserved,"u16"),u64:new Xe("u64",We.reserved,"u64"),unless:new Xe("unless",We.reserved,"unless"),using:new Xe("using",We.reserved,"using"),vec:new Xe("vec",We.reserved,"vec"),void:new Xe("void",We.reserved,"void")},be.keywords={array:new Xe("array",We.keyword,"array"),atomic:new Xe("atomic",We.keyword,"atomic"),bool:new Xe("bool",We.keyword,"bool"),f32:new Xe("f32",We.keyword,"f32"),i32:new Xe("i32",We.keyword,"i32"),mat2x2:new Xe("mat2x2",We.keyword,"mat2x2"),mat2x3:new Xe("mat2x3",We.keyword,"mat2x3"),mat2x4:new Xe("mat2x4",We.keyword,"mat2x4"),mat3x2:new Xe("mat3x2",We.keyword,"mat3x2"),mat3x3:new Xe("mat3x3",We.keyword,"mat3x3"),mat3x4:new Xe("mat3x4",We.keyword,"mat3x4"),mat4x2:new Xe("mat4x2",We.keyword,"mat4x2"),mat4x3:new Xe("mat4x3",We.keyword,"mat4x3"),mat4x4:new Xe("mat4x4",We.keyword,"mat4x4"),ptr:new Xe("ptr",We.keyword,"ptr"),sampler:new Xe("sampler",We.keyword,"sampler"),sampler_comparison:new Xe("sampler_comparison",We.keyword,"sampler_comparison"),struct:new Xe("struct",We.keyword,"struct"),texture_1d:new Xe("texture_1d",We.keyword,"texture_1d"),texture_2d:new Xe("texture_2d",We.keyword,"texture_2d"),texture_2d_array:new Xe("texture_2d_array",We.keyword,"texture_2d_array"),texture_3d:new Xe("texture_3d",We.keyword,"texture_3d"),texture_cube:new Xe("texture_cube",We.keyword,"texture_cube"),texture_cube_array:new Xe("texture_cube_array",We.keyword,"texture_cube_array"),texture_multisampled_2d:new Xe("texture_multisampled_2d",We.keyword,"texture_multisampled_2d"),texture_storage_1d:new Xe("texture_storage_1d",We.keyword,"texture_storage_1d"),texture_storage_2d:new Xe("texture_storage_2d",We.keyword,"texture_storage_2d"),texture_storage_2d_array:new Xe("texture_storage_2d_array",We.keyword,"texture_storage_2d_array"),texture_storage_3d:new Xe("texture_storage_3d",We.keyword,"texture_storage_3d"),texture_depth_2d:new Xe("texture_depth_2d",We.keyword,"texture_depth_2d"),texture_depth_2d_array:new Xe("texture_depth_2d_array",We.keyword,"texture_depth_2d_array"),texture_depth_cube:new Xe("texture_depth_cube",We.keyword,"texture_depth_cube"),texture_depth_cube_array:new Xe("texture_depth_cube_array",We.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new Xe("texture_depth_multisampled_2d",We.keyword,"texture_depth_multisampled_2d"),texture_external:new Xe("texture_external",We.keyword,"texture_external"),u32:new Xe("u32",We.keyword,"u32"),vec2:new Xe("vec2",We.keyword,"vec2"),vec3:new Xe("vec3",We.keyword,"vec3"),vec4:new Xe("vec4",We.keyword,"vec4"),bitcast:new Xe("bitcast",We.keyword,"bitcast"),block:new Xe("block",We.keyword,"block"),break:new Xe("break",We.keyword,"break"),case:new Xe("case",We.keyword,"case"),continue:new Xe("continue",We.keyword,"continue"),continuing:new Xe("continuing",We.keyword,"continuing"),default:new Xe("default",We.keyword,"default"),diagnostic:new Xe("diagnostic",We.keyword,"diagnostic"),discard:new Xe("discard",We.keyword,"discard"),else:new Xe("else",We.keyword,"else"),enable:new Xe("enable",We.keyword,"enable"),fallthrough:new Xe("fallthrough",We.keyword,"fallthrough"),false:new Xe("false",We.keyword,"false"),fn:new Xe("fn",We.keyword,"fn"),for:new Xe("for",We.keyword,"for"),function:new Xe("function",We.keyword,"function"),if:new Xe("if",We.keyword,"if"),let:new Xe("let",We.keyword,"let"),const:new Xe("const",We.keyword,"const"),loop:new Xe("loop",We.keyword,"loop"),while:new Xe("while",We.keyword,"while"),private:new Xe("private",We.keyword,"private"),read:new Xe("read",We.keyword,"read"),read_write:new Xe("read_write",We.keyword,"read_write"),return:new Xe("return",We.keyword,"return"),requires:new Xe("requires",We.keyword,"requires"),storage:new Xe("storage",We.keyword,"storage"),switch:new Xe("switch",We.keyword,"switch"),true:new Xe("true",We.keyword,"true"),alias:new Xe("alias",We.keyword,"alias"),type:new Xe("type",We.keyword,"type"),uniform:new Xe("uniform",We.keyword,"uniform"),var:new Xe("var",We.keyword,"var"),override:new Xe("override",We.keyword,"override"),workgroup:new Xe("workgroup",We.keyword,"workgroup"),write:new Xe("write",We.keyword,"write"),r8unorm:new Xe("r8unorm",We.keyword,"r8unorm"),r8snorm:new Xe("r8snorm",We.keyword,"r8snorm"),r8uint:new Xe("r8uint",We.keyword,"r8uint"),r8sint:new Xe("r8sint",We.keyword,"r8sint"),r16uint:new Xe("r16uint",We.keyword,"r16uint"),r16sint:new Xe("r16sint",We.keyword,"r16sint"),r16float:new Xe("r16float",We.keyword,"r16float"),rg8unorm:new Xe("rg8unorm",We.keyword,"rg8unorm"),rg8snorm:new Xe("rg8snorm",We.keyword,"rg8snorm"),rg8uint:new Xe("rg8uint",We.keyword,"rg8uint"),rg8sint:new Xe("rg8sint",We.keyword,"rg8sint"),r32uint:new Xe("r32uint",We.keyword,"r32uint"),r32sint:new Xe("r32sint",We.keyword,"r32sint"),r32float:new Xe("r32float",We.keyword,"r32float"),rg16uint:new Xe("rg16uint",We.keyword,"rg16uint"),rg16sint:new Xe("rg16sint",We.keyword,"rg16sint"),rg16float:new Xe("rg16float",We.keyword,"rg16float"),rgba8unorm:new Xe("rgba8unorm",We.keyword,"rgba8unorm"),rgba8unorm_srgb:new Xe("rgba8unorm_srgb",We.keyword,"rgba8unorm_srgb"),rgba8snorm:new Xe("rgba8snorm",We.keyword,"rgba8snorm"),rgba8uint:new Xe("rgba8uint",We.keyword,"rgba8uint"),rgba8sint:new Xe("rgba8sint",We.keyword,"rgba8sint"),bgra8unorm:new Xe("bgra8unorm",We.keyword,"bgra8unorm"),bgra8unorm_srgb:new Xe("bgra8unorm_srgb",We.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new Xe("rgb10a2unorm",We.keyword,"rgb10a2unorm"),rg11b10float:new Xe("rg11b10float",We.keyword,"rg11b10float"),rg32uint:new Xe("rg32uint",We.keyword,"rg32uint"),rg32sint:new Xe("rg32sint",We.keyword,"rg32sint"),rg32float:new Xe("rg32float",We.keyword,"rg32float"),rgba16uint:new Xe("rgba16uint",We.keyword,"rgba16uint"),rgba16sint:new Xe("rgba16sint",We.keyword,"rgba16sint"),rgba16float:new Xe("rgba16float",We.keyword,"rgba16float"),rgba32uint:new Xe("rgba32uint",We.keyword,"rgba32uint"),rgba32sint:new Xe("rgba32sint",We.keyword,"rgba32sint"),rgba32float:new Xe("rgba32float",We.keyword,"rgba32float"),static_assert:new Xe("static_assert",We.keyword,"static_assert")},be.tokens={decimal_float_literal:new Xe("decimal_float_literal",We.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?[fh]?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+[fh]?)|(-?[0-9]+[fh])/),hex_float_literal:new Xe("hex_float_literal",We.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+[fh]?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+[fh]?))/),int_literal:new Xe("int_literal",We.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new Xe("uint_literal",We.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),name:new Xe("name",We.token,/([_\p{XID_Start}][\p{XID_Continue}]+)|([\p{XID_Start}])/u),ident:new Xe("ident",We.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new Xe("and",We.token,"&"),and_and:new Xe("and_and",We.token,"&&"),arrow:new Xe("arrow ",We.token,"->"),attr:new Xe("attr",We.token,"@"),forward_slash:new Xe("forward_slash",We.token,"/"),bang:new Xe("bang",We.token,"!"),bracket_left:new Xe("bracket_left",We.token,"["),bracket_right:new Xe("bracket_right",We.token,"]"),brace_left:new Xe("brace_left",We.token,"{"),brace_right:new Xe("brace_right",We.token,"}"),colon:new Xe("colon",We.token,":"),comma:new Xe("comma",We.token,","),equal:new Xe("equal",We.token,"="),equal_equal:new Xe("equal_equal",We.token,"=="),not_equal:new Xe("not_equal",We.token,"!="),greater_than:new Xe("greater_than",We.token,">"),greater_than_equal:new Xe("greater_than_equal",We.token,">="),shift_right:new Xe("shift_right",We.token,">>"),less_than:new Xe("less_than",We.token,"<"),less_than_equal:new Xe("less_than_equal",We.token,"<="),shift_left:new Xe("shift_left",We.token,"<<"),modulo:new Xe("modulo",We.token,"%"),minus:new Xe("minus",We.token,"-"),minus_minus:new Xe("minus_minus",We.token,"--"),period:new Xe("period",We.token,"."),plus:new Xe("plus",We.token,"+"),plus_plus:new Xe("plus_plus",We.token,"++"),or:new Xe("or",We.token,"|"),or_or:new Xe("or_or",We.token,"||"),paren_left:new Xe("paren_left",We.token,"("),paren_right:new Xe("paren_right",We.token,")"),semicolon:new Xe("semicolon",We.token,";"),star:new Xe("star",We.token,"*"),tilde:new Xe("tilde",We.token,"~"),underscore:new Xe("underscore",We.token,"_"),xor:new Xe("xor",We.token,"^"),plus_equal:new Xe("plus_equal",We.token,"+="),minus_equal:new Xe("minus_equal",We.token,"-="),times_equal:new Xe("times_equal",We.token,"*="),division_equal:new Xe("division_equal",We.token,"/="),modulo_equal:new Xe("modulo_equal",We.token,"%="),and_equal:new Xe("and_equal",We.token,"&="),or_equal:new Xe("or_equal",We.token,"|="),xor_equal:new Xe("xor_equal",We.token,"^="),shift_right_equal:new Xe("shift_right_equal",We.token,">>="),shift_left_equal:new Xe("shift_left_equal",We.token,"<<=")},be.simpleTokens={"@":ot.tokens.attr,"{":ot.tokens.brace_left,"}":ot.tokens.brace_right,":":ot.tokens.colon,",":ot.tokens.comma,"(":ot.tokens.paren_left,")":ot.tokens.paren_right,";":ot.tokens.semicolon},be.literalTokens={"&":ot.tokens.and,"&&":ot.tokens.and_and,"->":ot.tokens.arrow,"/":ot.tokens.forward_slash,"!":ot.tokens.bang,"[":ot.tokens.bracket_left,"]":ot.tokens.bracket_right,"=":ot.tokens.equal,"==":ot.tokens.equal_equal,"!=":ot.tokens.not_equal,">":ot.tokens.greater_than,">=":ot.tokens.greater_than_equal,">>":ot.tokens.shift_right,"<":ot.tokens.less_than,"<=":ot.tokens.less_than_equal,"<<":ot.tokens.shift_left,"%":ot.tokens.modulo,"-":ot.tokens.minus,"--":ot.tokens.minus_minus,".":ot.tokens.period,"+":ot.tokens.plus,"++":ot.tokens.plus_plus,"|":ot.tokens.or,"||":ot.tokens.or_or,"*":ot.tokens.star,"~":ot.tokens.tilde,_:ot.tokens.underscore,"^":ot.tokens.xor,"+=":ot.tokens.plus_equal,"-=":ot.tokens.minus_equal,"*=":ot.tokens.times_equal,"/=":ot.tokens.division_equal,"%=":ot.tokens.modulo_equal,"&=":ot.tokens.and_equal,"|=":ot.tokens.or_equal,"^=":ot.tokens.xor_equal,">>=":ot.tokens.shift_right_equal,"<<=":ot.tokens.shift_left_equal},be.regexTokens={decimal_float_literal:ot.tokens.decimal_float_literal,hex_float_literal:ot.tokens.hex_float_literal,int_literal:ot.tokens.int_literal,uint_literal:ot.tokens.uint_literal,ident:ot.tokens.ident},be.storage_class=[ot.keywords.function,ot.keywords.private,ot.keywords.workgroup,ot.keywords.uniform,ot.keywords.storage],be.access_mode=[ot.keywords.read,ot.keywords.write,ot.keywords.read_write],be.sampler_type=[ot.keywords.sampler,ot.keywords.sampler_comparison],be.sampled_texture_type=[ot.keywords.texture_1d,ot.keywords.texture_2d,ot.keywords.texture_2d_array,ot.keywords.texture_3d,ot.keywords.texture_cube,ot.keywords.texture_cube_array],be.multisampled_texture_type=[ot.keywords.texture_multisampled_2d],be.storage_texture_type=[ot.keywords.texture_storage_1d,ot.keywords.texture_storage_2d,ot.keywords.texture_storage_2d_array,ot.keywords.texture_storage_3d],be.depth_texture_type=[ot.keywords.texture_depth_2d,ot.keywords.texture_depth_2d_array,ot.keywords.texture_depth_cube,ot.keywords.texture_depth_cube_array,ot.keywords.texture_depth_multisampled_2d],be.texture_external_type=[ot.keywords.texture_external],be.any_texture_type=[...ot.sampled_texture_type,...ot.multisampled_texture_type,...ot.storage_texture_type,...ot.depth_texture_type,...ot.texture_external_type],be.texel_format=[ot.keywords.r8unorm,ot.keywords.r8snorm,ot.keywords.r8uint,ot.keywords.r8sint,ot.keywords.r16uint,ot.keywords.r16sint,ot.keywords.r16float,ot.keywords.rg8unorm,ot.keywords.rg8snorm,ot.keywords.rg8uint,ot.keywords.rg8sint,ot.keywords.r32uint,ot.keywords.r32sint,ot.keywords.r32float,ot.keywords.rg16uint,ot.keywords.rg16sint,ot.keywords.rg16float,ot.keywords.rgba8unorm,ot.keywords.rgba8unorm_srgb,ot.keywords.rgba8snorm,ot.keywords.rgba8uint,ot.keywords.rgba8sint,ot.keywords.bgra8unorm,ot.keywords.bgra8unorm_srgb,ot.keywords.rgb10a2unorm,ot.keywords.rg11b10float,ot.keywords.rg32uint,ot.keywords.rg32sint,ot.keywords.rg32float,ot.keywords.rgba16uint,ot.keywords.rgba16sint,ot.keywords.rgba16float,ot.keywords.rgba32uint,ot.keywords.rgba32sint,ot.keywords.rgba32float],be.const_literal=[ot.tokens.int_literal,ot.tokens.uint_literal,ot.tokens.decimal_float_literal,ot.tokens.hex_float_literal,ot.keywords.true,ot.keywords.false],be.literal_or_ident=[ot.tokens.ident,ot.tokens.int_literal,ot.tokens.uint_literal,ot.tokens.decimal_float_literal,ot.tokens.hex_float_literal,ot.tokens.name],be.element_count_expression=[ot.tokens.int_literal,ot.tokens.uint_literal,ot.tokens.ident],be.template_types=[ot.keywords.vec2,ot.keywords.vec3,ot.keywords.vec4,ot.keywords.mat2x2,ot.keywords.mat2x3,ot.keywords.mat2x4,ot.keywords.mat3x2,ot.keywords.mat3x3,ot.keywords.mat3x4,ot.keywords.mat4x2,ot.keywords.mat4x3,ot.keywords.mat4x4,ot.keywords.atomic,ot.keywords.bitcast,...ot.any_texture_type],be.attribute_name=[ot.tokens.ident,ot.keywords.block,ot.keywords.diagnostic],be.assignment_operators=[ot.tokens.equal,ot.tokens.plus_equal,ot.tokens.minus_equal,ot.tokens.times_equal,ot.tokens.division_equal,ot.tokens.modulo_equal,ot.tokens.and_equal,ot.tokens.or_equal,ot.tokens.xor_equal,ot.tokens.shift_right_equal,ot.tokens.shift_left_equal],be.increment_operators=[ot.tokens.plus_plus,ot.tokens.minus_minus];let k6=class{constructor(e,t,n,i,s){this.type=e,this.lexeme=t,this.line=n,this.start=i,this.end=s}toString(){return this.lexeme}isTemplateType(){return be.template_types.indexOf(this.type)!=-1}isArrayType(){return this.type==be.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}},Ege=class{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=e??""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new k6(be.eof,"",this._line,this._current,this._current)),this._tokens}scanToken(){let e=this._advance();if(e==`
`)return this._line++,!0;if(this._isWhitespace(e))return!0;if(e=="/"){if(this._peekAhead()=="/"){for(;e!=`
`;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}if(this._peekAhead()=="*"){this._advance();let a=1;for(;a>0;){if(this._isAtEnd())return!0;if(e=this._advance(),e==`
`)this._line++;else if(e=="*"){if(this._peekAhead()=="/"&&(this._advance(),a--,a==0))return!0}else e=="/"&&this._peekAhead()=="*"&&(this._advance(),a++)}return!0}}const t=be.simpleTokens[e];if(t)return this._addToken(t),!0;let n=be.none;const i=this._isAlpha(e),s=e==="_";if(this._isAlphaNumeric(e)){let a=this._peekAhead();for(;this._isAlphaNumeric(a);)e+=this._advance(),a=this._peekAhead()}if(i){const a=be.keywords[e];if(a)return this._addToken(a),!0}if(i||s)return this._addToken(be.tokens.ident),!0;for(;;){let a=this._findType(e);const o=this._peekAhead();if(e=="-"&&this._tokens.length>0){if(o=="=")return this._current++,e+=o,this._addToken(be.tokens.minus_equal),!0;if(o=="-")return this._current++,e+=o,this._addToken(be.tokens.minus_minus),!0;const u=this._tokens.length-1;if((be.literal_or_ident.indexOf(this._tokens[u].type)!=-1||this._tokens[u].type==be.tokens.paren_right)&&o!=">")return this._addToken(a),!0}if(e==">"&&(o==">"||o=="=")){let u=!1,f=this._tokens.length-1;for(let g=0;g<5&&f>=0&&be.assignment_operators.indexOf(this._tokens[f].type)===-1;++g,--f)if(this._tokens[f].type===be.tokens.less_than){f>0&&this._tokens[f-1].isArrayOrTemplateType()&&(u=!0);break}if(u)return this._addToken(a),!0}if(a===be.none){let u=e,f=0;const g=2;for(let y=0;y<g;++y)if(u+=this._peekAhead(y),a=this._findType(u),a!==be.none){f=y;break}if(a===be.none)return n!==be.none&&(this._current--,this._addToken(n),!0);e=u,this._current+=f+1}if(n=a,this._isAtEnd())break;e+=this._advance()}return n!==be.none&&(this._addToken(n),!0)}_findType(e){for(const n in be.regexTokens){const i=be.regexTokens[n];if(this._match(e,i.rule))return i}return be.literalTokens[e]||be.none}_match(e,t){const n=t.exec(e);return n&&n.index==0&&n[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return!this._isNumeric(e)&&!this._isWhitespace(e)&&e!=="_"&&e!=="."&&e!=="("&&e!==")"&&e!=="["&&e!=="]"&&e!=="{"&&e!=="}"&&e!==","&&e!==";"&&e!==":"&&e!=="="&&e!=="!"&&e!=="<"&&e!==">"&&e!=="+"&&e!=="-"&&e!=="*"&&e!=="/"&&e!=="%"&&e!=="&"&&e!=="|"&&e!=="^"&&e!=="~"&&e!=="@"&&e!=="#"&&e!=="?"&&e!=="'"&&e!=="`"&&e!=='"'&&e!=="\\"&&e!==`
`&&e!=="\r"&&e!=="	"&&e!=="\0"}_isNumeric(e){return e>="0"&&e<="9"}_isAlphaNumeric(e){return this._isAlpha(e)||this._isNumeric(e)||e==="_"}_isWhitespace(e){return e==" "||e=="	"||e=="\r"}_advance(e=0){let t=this._source[this._current];return e=e||0,e++,this._current+=e,t}_peekAhead(e=0){return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){const t=this._source.substring(this._start,this._current);this._tokens.push(new k6(e,t,this._line,this._start,this._current))}};function lr(r){return Array.isArray(r)||r?.buffer instanceof ArrayBuffer}const zC=new Float32Array(1),Ige=new Uint32Array(zC.buffer),Pge=new Uint32Array(zC.buffer),VC=new Int32Array(1),Bge=new Float32Array(VC.buffer),Mge=new Uint32Array(VC.buffer),$C=new Uint32Array(1),Rge=new Float32Array($C.buffer),kge=new Int32Array($C.buffer);function O6(r,e,t){if(e===t)return r;if(e==="f32"){if(t==="i32"||t==="x32")return zC[0]=r,Ige[0];if(t==="u32")return zC[0]=r,Pge[0]}else if(e==="i32"||e==="x32"){if(t==="f32")return VC[0]=r,Bge[0];if(t==="u32")return VC[0]=r,Mge[0]}else if(e==="u32"){if(t==="f32")return $C[0]=r,Rge[0];if(t==="i32"||t==="x32")return $C[0]=r,kge[0]}return console.error(`Unsupported cast from ${e} to ${t}`),r}let Oge=class{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}},q1=class{constructor(e,t){this.align=e,this.size=t}},Z0=class I0{constructor(){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new mge,this.functions=[],this._types=new Map,this._functions=new Map}_isStorageTexture(e){return e.name=="texture_storage_1d"||e.name=="texture_storage_2d"||e.name=="texture_storage_2d_array"||e.name=="texture_storage_3d"}updateAST(e){for(const t of e)t instanceof $_&&this._functions.set(t.name,new Oge(t));for(const t of e)if(t instanceof Ou){const n=this.getTypeInfo(t,null);n instanceof sd&&this.structs.push(n)}for(const t of e)if(t instanceof rO)this.aliases.push(this._getAliasInfo(t));else{if(t instanceof eO){const n=t,i=this._getAttributeNum(n.attributes,"id",0),s=n.type!=null?this.getTypeInfo(n.type,n.attributes):null;this.overrides.push(new fge(n.name,s,n.attributes,i));continue}if(this._isUniformVar(t)){const n=t,i=this._getAttributeNum(n.attributes,"group",0),s=this._getAttributeNum(n.attributes,"binding",0),a=this.getTypeInfo(n.type,n.attributes),o=new J1(n.name,a,i,s,n.attributes,Qh.Uniform,n.access);o.access||(o.access="read"),this.uniforms.push(o);continue}if(this._isStorageVar(t)){const n=t,i=this._getAttributeNum(n.attributes,"group",0),s=this._getAttributeNum(n.attributes,"binding",0),a=this.getTypeInfo(n.type,n.attributes),o=this._isStorageTexture(a),u=new J1(n.name,a,i,s,n.attributes,o?Qh.StorageTexture:Qh.Storage,n.access);u.access||(u.access="read"),this.storage.push(u);continue}if(this._isTextureVar(t)){const n=t,i=this._getAttributeNum(n.attributes,"group",0),s=this._getAttributeNum(n.attributes,"binding",0),a=this.getTypeInfo(n.type,n.attributes),o=this._isStorageTexture(a),u=new J1(n.name,a,i,s,n.attributes,o?Qh.StorageTexture:Qh.Texture,n.access);u.access||(u.access="read"),o?this.storage.push(u):this.textures.push(u);continue}if(this._isSamplerVar(t)){const n=t,i=this._getAttributeNum(n.attributes,"group",0),s=this._getAttributeNum(n.attributes,"binding",0),a=this.getTypeInfo(n.type,n.attributes),o=new J1(n.name,a,i,s,n.attributes,Qh.Sampler,n.access);this.samplers.push(o);continue}}for(const t of e)if(t instanceof $_){const n=this._getAttribute(t,"vertex"),i=this._getAttribute(t,"fragment"),s=this._getAttribute(t,"compute"),a=n||i||s,o=new gge(t.name,a?.name,t.attributes);o.attributes=t.attributes,o.startLine=t.startLine,o.endLine=t.endLine,this.functions.push(o),this._functions.get(t.name).info=o,a&&(this._functions.get(t.name).inUse=!0,o.inUse=!0,o.resources=this._findResources(t,!!a),o.inputs=this._getInputs(t.args),o.outputs=this._getOutputs(t.returnType),this.entry[a.name].push(o)),o.arguments=t.args.map(u=>new pge(u.name,this.getTypeInfo(u.type,u.attributes),u.attributes)),o.returnType=t.returnType?this.getTypeInfo(t.returnType,t.attributes):null;continue}for(const t of this._functions.values())t.info&&(t.info.inUse=t.inUse,this._addCalls(t.node,t.info.calls));for(const t of this._functions.values())t.node.search(n=>{var i,s,a;if(n instanceof WW){if(n.value)if(lr(n.value))for(const o of n.value)for(const u of this.overrides)o===u.name&&((i=t.info)===null||i===void 0||i.overrides.push(u));else for(const o of this.overrides)n.value===o.name&&((s=t.info)===null||s===void 0||s.overrides.push(o))}else if(n instanceof La)for(const o of this.overrides)n.name===o.name&&((a=t.info)===null||a===void 0||a.overrides.push(o))});for(const t of this.uniforms)this._markStructsInUse(t.type);for(const t of this.storage)this._markStructsInUse(t.type)}getFunctionInfo(e){for(const t of this.functions)if(t.name==e)return t;return null}getStructInfo(e){for(const t of this.structs)if(t.name==e)return t;return null}getOverrideInfo(e){for(const t of this.overrides)if(t.name==e)return t;return null}_markStructsInUse(e){if(e)if(e.isStruct){if(e.inUse=!0,e.members)for(const t of e.members)this._markStructsInUse(t.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)e.format&&this._markStructsInUse(e.format);else{const t=this._getAlias(e.name);t&&this._markStructsInUse(t)}}_addCalls(e,t){var n;for(const i of e.calls){const s=(n=this._functions.get(i.name))===null||n===void 0?void 0:n.info;s&&t.add(s)}}findResource(e,t,n){if(n){for(const i of this.entry.compute)if(i.name===n){for(const s of i.resources)if(s.group==e&&s.binding==t)return s}for(const i of this.entry.vertex)if(i.name===n){for(const s of i.resources)if(s.group==e&&s.binding==t)return s}for(const i of this.entry.fragment)if(i.name===n){for(const s of i.resources)if(s.group==e&&s.binding==t)return s}}for(const i of this.uniforms)if(i.group==e&&i.binding==t)return i;for(const i of this.storage)if(i.group==e&&i.binding==t)return i;for(const i of this.textures)if(i.group==e&&i.binding==t)return i;for(const i of this.samplers)if(i.group==e&&i.binding==t)return i;return null}_findResource(e){for(const t of this.uniforms)if(t.name==e)return t;for(const t of this.storage)if(t.name==e)return t;for(const t of this.textures)if(t.name==e)return t;for(const t of this.samplers)if(t.name==e)return t;return null}_markStructsFromAST(e){const t=this.getTypeInfo(e,null);this._markStructsInUse(t)}_findResources(e,t){const n=[],i=this,s=[];return e.search(a=>{if(a instanceof FC)s.push({});else if(a instanceof UC)s.pop();else if(a instanceof Fu){const o=a;t&&o.type!==null&&this._markStructsFromAST(o.type),s.length>0&&(s[s.length-1][o.name]=o)}else if(a instanceof kc){const o=a;t&&o.type!==null&&this._markStructsFromAST(o.type)}else if(a instanceof q0){const o=a;t&&o.type!==null&&this._markStructsFromAST(o.type),s.length>0&&(s[s.length-1][o.name]=o)}else if(a instanceof La){const o=a;if(s.length>0&&s[s.length-1][o.name])return;const u=i._findResource(o.name);u&&n.push(u)}else if(a instanceof nO){const o=a,u=i._functions.get(o.name);u&&(t&&(u.inUse=!0),e.calls.add(u.node),u.resources===null&&(u.resources=i._findResources(u.node,t)),n.push(...u.resources))}else if(a instanceof tO){const o=a,u=i._functions.get(o.name);u&&(t&&(u.inUse=!0),e.calls.add(u.node),u.resources===null&&(u.resources=i._findResources(u.node,t)),n.push(...u.resources))}}),[...new Map(n.map(a=>[a.name,a])).values()]}getBindGroups(){const e=[];function t(n,i){n>=e.length&&(e.length=n+1),e[n]===void 0&&(e[n]=[]),i>=e[n].length&&(e[n].length=i+1)}for(const n of this.uniforms)t(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.storage)t(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.textures)t(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.samplers)t(n.group,n.binding),e[n.group][n.binding]=n;return e}_getOutputs(e,t=void 0){if(t===void 0&&(t=[]),e instanceof Ou)this._getStructOutputs(e,t);else{const n=this._getOutputInfo(e);n!==null&&t.push(n)}return t}_getStructOutputs(e,t){for(const n of e.members)if(n.type instanceof Ou)this._getStructOutputs(n.type,t);else{const i=this._getAttribute(n,"location")||this._getAttribute(n,"builtin");if(i!==null){const s=this.getTypeInfo(n.type,n.type.attributes),a=this._parseInt(i.value),o=new I6(n.name,s,i.name,a);t.push(o)}}}_getOutputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(t!==null){const n=this.getTypeInfo(e,e.attributes),i=this._parseInt(t.value);return new I6("",n,t.name,i)}return null}_getInputs(e,t=void 0){t===void 0&&(t=[]);for(const n of e)if(n.type instanceof Ou)this._getStructInputs(n.type,t);else{const i=this._getInputInfo(n);i!==null&&t.push(i)}return t}_getStructInputs(e,t){for(const n of e.members)if(n.type instanceof Ou)this._getStructInputs(n.type,t);else{const i=this._getInputInfo(n);i!==null&&t.push(i)}}_getInputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(t!==null){const n=this._getAttribute(e,"interpolation"),i=this.getTypeInfo(e.type,e.attributes),s=this._parseInt(t.value),a=new dge(e.name,i,t.name,s);return n!==null&&(a.interpolation=this._parseString(n.value)),a}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);const t=parseInt(e);return isNaN(t)?e:t}_getAlias(e){for(const t of this.aliases)if(t.name==e)return t.type;return null}_getAliasInfo(e){return new hge(e.name,this.getTypeInfo(e.type,null))}getTypeInfoByName(e){for(const t of this.structs)if(t.name==e)return t;for(const t of this.aliases)if(t.name==e)return t.type;return null}getTypeInfo(e,t=null){if(this._types.has(e))return this._types.get(e);if(e instanceof Aw){const i=e.type?this.getTypeInfo(e.type,e.attributes):null,s=new sB(e.name,i,t);return this._types.set(e,s),this._updateTypeInfo(s),s}if(e instanceof Y0){const i=e,s=i.format?this.getTypeInfo(i.format,i.attributes):null,a=new yd(i.name,t);return a.format=s,a.count=i.count,this._types.set(e,a),this._updateTypeInfo(a),a}if(e instanceof Ou){const i=e,s=new sd(i.name,t);s.startLine=i.startLine,s.endLine=i.endLine;for(const a of i.members){const o=this.getTypeInfo(a.type,a.attributes);s.members.push(new E6(a.name,o,a.attributes))}return this._types.set(e,s),this._updateTypeInfo(s),s}if(e instanceof T0){const i=e,s=i.format instanceof Mt,a=i.format?s?this.getTypeInfo(i.format,null):new gl(i.format,null):null,o=new dp(i.name,a,t,i.access);return this._types.set(e,o),this._updateTypeInfo(o),o}if(e instanceof Ye){const i=e,s=i.format?this.getTypeInfo(i.format,null):null,a=new dp(i.name,s,t,i.access);return this._types.set(e,a),this._updateTypeInfo(a),a}const n=new gl(e.name,t);return this._types.set(e,n),this._updateTypeInfo(n),n}_updateTypeInfo(e){var t,n,i;const s=this._getTypeSize(e);if(e.size=(t=s?.size)!==null&&t!==void 0?t:0,e instanceof yd&&e.format){const a=this._getTypeSize(e.format);e.stride=Math.max((n=a?.size)!==null&&n!==void 0?n:0,(i=a?.align)!==null&&i!==void 0?i:0),this._updateTypeInfo(e.format)}e instanceof sB&&this._updateTypeInfo(e.format),e instanceof sd&&this._updateStructInfo(e)}_updateStructInfo(e){var t;let n=0,i=0,s=0,a=0;for(let o=0,u=e.members.length;o<u;++o){const f=e.members[o],g=this._getTypeSize(f);if(!g)continue;(t=this._getAlias(f.type.name))!==null&&t!==void 0||f.type;const y=g.align,A=g.size;n=this._roundUp(y,n+i),i=A,s=n,a=Math.max(a,y),f.offset=n,f.size=A,this._updateTypeInfo(f.type)}e.size=this._roundUp(a,s+i),e.align=a}_getTypeSize(e){var t,n;if(e==null)return null;const i=this._getAttributeNum(e.attributes,"size",0),s=this._getAttributeNum(e.attributes,"align",0);if(e instanceof E6&&(e=e.type),e instanceof gl){const a=this._getAlias(e.name);a!==null&&(e=a)}{const a=I0._typeInfo[e.name];if(a!==void 0){const o=((t=e.format)===null||t===void 0?void 0:t.name)==="f16"?2:1;return new q1(Math.max(s,a.align/o),Math.max(i,a.size/o))}}{const a=I0._typeInfo[e.name.substring(0,e.name.length-1)];if(a){const o=e.name[e.name.length-1]==="h"?2:1;return new q1(Math.max(s,a.align/o),Math.max(i,a.size/o))}}if(e instanceof yd){let a=e,o=8,u=8;const f=this._getTypeSize(a.format);return f!==null&&(u=f.size,o=f.align),u=a.count*this._getAttributeNum((n=e?.attributes)!==null&&n!==void 0?n:null,"stride",this._roundUp(o,u)),i&&(u=i),new q1(Math.max(s,o),Math.max(i,u))}if(e instanceof sd){let a=0,o=0,u=0,f=0,g=0;for(const y of e.members){const A=this._getTypeSize(y.type);A!==null&&(a=Math.max(A.align,a),u=this._roundUp(A.align,u+f),f=A.size,g=u)}return o=this._roundUp(a,g+f),new q1(Math.max(s,a),Math.max(i,o))}return null}_isUniformVar(e){return e instanceof Fu&&e.storage=="uniform"}_isStorageVar(e){return e instanceof Fu&&e.storage=="storage"}_isTextureVar(e){return e instanceof Fu&&e.type!==null&&I0._textureTypes.indexOf(e.type.name)!=-1}_isSamplerVar(e){return e instanceof Fu&&e.type!==null&&I0._samplerTypes.indexOf(e.type.name)!=-1}_getAttribute(e,t){const n=e;if(!n||!n.attributes)return null;const i=n.attributes;for(let s of i)if(s.name==t)return s;return null}_getAttributeNum(e,t,n){if(e===null)return n;for(let i of e)if(i.name==t){let s=i!==null&&i.value!==null?i.value:n;return s instanceof Array&&(s=s[0]),typeof s=="number"?s:typeof s=="string"?parseInt(s):n}return n}_roundUp(e,t){return Math.ceil(t/e)*e}};Z0._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},Z0._textureTypes=be.any_texture_type.map(r=>r.name),Z0._samplerTypes=be.sampler_type.map(r=>r.name);let iO=0,Dge=class XW{constructor(e,t,n){this.id=iO++,this.name=e,this.value=t,this.node=n}clone(){return new XW(this.name,this.value,this.node)}};class sO{constructor(e){this.id=iO++,this.name=e.name,this.node=e}clone(){return new sO(this.node)}}let Lge=class JW{constructor(e){this.parent=null,this.variables=new Map,this.functions=new Map,this.currentFunctionName="",this.id=iO++,e&&(this.parent=e,this.currentFunctionName=e.currentFunctionName)}getVariable(e){var t;return this.variables.has(e)?(t=this.variables.get(e))!==null&&t!==void 0?t:null:this.parent?this.parent.getVariable(e):null}getFunction(e){var t;return this.functions.has(e)?(t=this.functions.get(e))!==null&&t!==void 0?t:null:this.parent?this.parent.getFunction(e):null}createVariable(e,t,n){this.variables.set(e,new Dge(e,t,n??null))}setVariable(e,t,n){const i=this.getVariable(e);i!==null?i.value=t:this.createVariable(e,t,n)}getVariableValue(e){var t;const n=this.getVariable(e);return(t=n?.value)!==null&&t!==void 0?t:null}clone(){return new JW(this)}};class Nge{evalExpression(e,t){return null}getTypeInfo(e){return null}getVariableName(e,t){return""}}let Fge=class{constructor(e){this.exec=e}getTypeInfo(e){return this.exec.getTypeInfo(e)}All(e,t){const n=this.exec.evalExpression(e.args[0],t);let i=!0;if(n instanceof Se)return n.data.forEach(s=>{s||(i=!1)}),new Je(i?1:0,this.getTypeInfo("bool"));throw new Error(`All() expects a vector argument. Line ${e.line}`)}Any(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se){const i=n.data.some(s=>s);return new Je(i?1:0,this.getTypeInfo("bool"))}throw new Error(`Any() expects a vector argument. Line ${e.line}`)}Select(e,t){const n=this.exec.evalExpression(e.args[2],t);if(!(n instanceof Je))throw new Error(`Select() expects a bool condition. Line ${e.line}`);return n.value?this.exec.evalExpression(e.args[1],t):this.exec.evalExpression(e.args[0],t)}ArrayLength(e,t){let n=e.args[0];n instanceof ms&&(n=n.right);const i=this.exec.evalExpression(n,t);if(i instanceof Vs&&i.typeInfo.size===0){const s=i.typeInfo,a=i.buffer.byteLength/s.stride;return new Je(a,this.getTypeInfo("u32"))}return new Je(i.typeInfo.size,this.getTypeInfo("u32"))}Abs(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.abs(s)),n.typeInfo);const i=n;return new Je(Math.abs(i.value),i.typeInfo)}Acos(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.acos(s)),n.typeInfo);const i=n;return new Je(Math.acos(i.value),n.typeInfo)}Acosh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.acosh(s)),n.typeInfo);const i=n;return new Je(Math.acosh(i.value),n.typeInfo)}Asin(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.asin(s)),n.typeInfo);const i=n;return new Je(Math.asin(i.value),n.typeInfo)}Asinh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.asinh(s)),n.typeInfo);const i=n;return new Je(Math.asinh(i.value),n.typeInfo)}Atan(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.atan(s)),n.typeInfo);const i=n;return new Je(Math.atan(i.value),n.typeInfo)}Atanh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.atanh(s)),n.typeInfo);const i=n;return new Je(Math.atanh(i.value),n.typeInfo)}Atan2(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(n instanceof Se&&i instanceof Se)return new Se(n.data.map((o,u)=>Math.atan2(o,i.data[u])),n.typeInfo);const s=n,a=i;return new Je(Math.atan2(s.value,a.value),n.typeInfo)}Ceil(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.ceil(s)),n.typeInfo);const i=n;return new Je(Math.ceil(i.value),n.typeInfo)}_clamp(e,t,n){return Math.min(Math.max(e,t),n)}Clamp(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t);if(n instanceof Se&&i instanceof Se&&s instanceof Se)return new Se(n.data.map((f,g)=>this._clamp(f,i.data[g],s.data[g])),n.typeInfo);const a=n,o=i,u=s;return new Je(this._clamp(a.value,o.value,u.value),n.typeInfo)}Cos(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.cos(s)),n.typeInfo);const i=n;return new Je(Math.cos(i.value),n.typeInfo)}Cosh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.cosh(s)),n.typeInfo);const i=n;return new Je(Math.cos(i.value),n.typeInfo)}CountLeadingZeros(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.clz32(s)),n.typeInfo);const i=n;return new Je(Math.clz32(i.value),n.typeInfo)}_countOneBits(e){let t=0;for(;e!==0;)1&e&&t++,e>>=1;return t}CountOneBits(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>this._countOneBits(s)),n.typeInfo);const i=n;return new Je(this._countOneBits(i.value),n.typeInfo)}_countTrailingZeros(e){if(e===0)return 32;let t=0;for(;!(1&e);)e>>=1,t++;return t}CountTrailingZeros(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>this._countTrailingZeros(s)),n.typeInfo);const i=n;return new Je(this._countTrailingZeros(i.value),n.typeInfo)}Cross(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(n instanceof Se&&i instanceof Se){if(n.data.length!==3||i.data.length!==3)return console.error(`Cross() expects 3D vectors. Line ${e.line}`),null;const s=n.data,a=i.data;return new Se([s[1]*a[2]-a[1]*s[2],s[2]*a[0]-a[2]*s[0],s[0]*a[1]-a[0]*s[1]],n.typeInfo)}return console.error(`Cross() expects vector arguments. Line ${e.line}`),null}Degrees(e,t){const n=this.exec.evalExpression(e.args[0],t),i=180/Math.PI;return n instanceof Se?new Se(n.data.map(s=>s*i),n.typeInfo):new Je(n.value*i,this.getTypeInfo("f32"))}Determinant(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Vr){const i=n.data,s=n.typeInfo.getTypeName(),a=s.endsWith("h")?this.getTypeInfo("f16"):this.getTypeInfo("f32");if(s==="mat2x2"||s==="mat2x2f"||s==="mat2x2h")return new Je(i[0]*i[3]-i[1]*i[2],a);if(s==="mat2x3"||s==="mat2x3f"||s==="mat2x3h")return new Je(i[0]*(i[4]*i[8]-i[5]*i[7])-i[1]*(i[3]*i[8]-i[5]*i[6])+i[2]*(i[3]*i[7]-i[4]*i[6]),a);if(s==="mat2x4"||s==="mat2x4f"||s==="mat2x4h")console.error(`TODO: Determinant for ${s}`);else if(s==="mat3x2"||s==="mat3x2f"||s==="mat3x2h")console.error(`TODO: Determinant for ${s}`);else{if(s==="mat3x3"||s==="mat3x3f"||s==="mat3x3h")return new Je(i[0]*(i[4]*i[8]-i[5]*i[7])-i[1]*(i[3]*i[8]-i[5]*i[6])+i[2]*(i[3]*i[7]-i[4]*i[6]),a);s==="mat3x4"||s==="mat3x4f"||s==="mat3x4h"||s==="mat4x2"||s==="mat4x2f"||s==="mat4x2h"||s==="mat4x3"||s==="mat4x3f"||s==="mat4x3h"?console.error(`TODO: Determinant for ${s}`):s!=="mat4x4"&&s!=="mat4x4f"&&s!=="mat4x4h"||console.error(`TODO: Determinant for ${s}`)}}return console.error(`Determinant expects a matrix argument. Line ${e.line}`),null}Distance(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(n instanceof Se&&i instanceof Se){let o=0;for(let u=0;u<n.data.length;++u)o+=(n.data[u]-i.data[u])*(n.data[u]-i.data[u]);return new Je(Math.sqrt(o),this.getTypeInfo("f32"))}const s=n,a=i;return new Je(Math.abs(s.value-a.value),n.typeInfo)}_dot(e,t){let n=0;for(let i=0;i<e.length;++i)n+=t[i]*e[i];return n}Dot(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);return n instanceof Se&&i instanceof Se?new Je(this._dot(n.data,i.data),this.getTypeInfo("f32")):(console.error(`Dot() expects vector arguments. Line ${e.line}`),null)}Dot4U8Packed(e,t){return console.error(`TODO: dot4U8Packed. Line ${e.line}`),null}Dot4I8Packed(e,t){return console.error(`TODO: dot4I8Packed. Line ${e.line}`),null}Exp(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.exp(s)),n.typeInfo);const i=n;return new Je(Math.exp(i.value),n.typeInfo)}Exp2(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.pow(2,s)),n.typeInfo);const i=n;return new Je(Math.pow(2,i.value),n.typeInfo)}ExtractBits(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t);if(i.typeInfo.name!=="u32"&&i.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 offset argument. Line ${e.line}`),null;if(s.typeInfo.name!=="u32"&&s.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 count argument. Line ${e.line}`),null;const a=i.value,o=s.value;if(n instanceof Se)return new Se(n.data.map(f=>f>>a&(1<<o)-1),n.typeInfo);if(n.typeInfo.name!=="i32"&&n.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 argument. Line ${e.line}`),null;const u=n.value;return new Je(u>>a&(1<<o)-1,this.getTypeInfo("i32"))}FaceForward(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t);if(n instanceof Se&&i instanceof Se&&s instanceof Se){const a=this._dot(i.data,s.data);return new Se(a<0?Array.from(n.data):n.data.map(o=>-o),n.typeInfo)}return console.error(`FaceForward() expects vector arguments. Line ${e.line}`),null}_firstLeadingBit(e){return e===0?-1:31-Math.clz32(e)}FirstLeadingBit(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>this._firstLeadingBit(s)),n.typeInfo);const i=n;return new Je(this._firstLeadingBit(i.value),n.typeInfo)}_firstTrailingBit(e){return e===0?-1:Math.log2(e&-e)}FirstTrailingBit(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>this._firstTrailingBit(s)),n.typeInfo);const i=n;return new Je(this._firstTrailingBit(i.value),n.typeInfo)}Floor(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.floor(s)),n.typeInfo);const i=n;return new Je(Math.floor(i.value),n.typeInfo)}Fma(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t);if(n instanceof Se&&i instanceof Se&&s instanceof Se)return n.data.length!==i.data.length||n.data.length!==s.data.length?(console.error(`Fma() expects vectors of the same length. Line ${e.line}`),null):new Se(n.data.map((f,g)=>f*i.data[g]+s.data[g]),n.typeInfo);const a=n,o=i,u=s;return new Je(a.value*o.value+u.value,a.typeInfo)}Fract(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>s-Math.floor(s)),n.typeInfo);const i=n;return new Je(i.value-Math.floor(i.value),n.typeInfo)}Frexp(e,t){return console.error(`TODO: frexp. Line ${e.line}`),null}InsertBits(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t),a=this.exec.evalExpression(e.args[3],t);if(s.typeInfo.name!=="u32"&&s.typeInfo.name!=="x32")return console.error(`InsertBits() expects an i32 offset argument. Line ${e.line}`),null;const o=s.value,u=(1<<a.value)-1<<o,f=~u;if(n instanceof Se&&i instanceof Se)return new Se(n.data.map((A,C)=>A&f|i.data[C]<<o&u),n.typeInfo);const g=n.value,y=i.value;return new Je(g&f|y<<o&u,n.typeInfo)}InverseSqrt(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>1/Math.sqrt(s)),n.typeInfo);const i=n;return new Je(1/Math.sqrt(i.value),n.typeInfo)}Ldexp(e,t){return console.error(`TODO: ldexp. Line ${e.line}`),null}Length(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se){let s=0;return n.data.forEach(a=>{s+=a*a}),new Je(Math.sqrt(s),this.getTypeInfo("f32"))}const i=n;return new Je(Math.abs(i.value),n.typeInfo)}Log(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.log(s)),n.typeInfo);const i=n;return new Je(Math.log(i.value),n.typeInfo)}Log2(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.log2(s)),n.typeInfo);const i=n;return new Je(Math.log2(i.value),n.typeInfo)}Max(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(n instanceof Se&&i instanceof Se)return new Se(n.data.map((o,u)=>Math.max(o,i.data[u])),n.typeInfo);const s=n,a=i;return new Je(Math.max(s.value,a.value),n.typeInfo)}Min(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(n instanceof Se&&i instanceof Se)return new Se(n.data.map((o,u)=>Math.min(o,i.data[u])),n.typeInfo);const s=n,a=i;return new Je(Math.min(s.value,a.value),n.typeInfo)}Mix(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t);if(n instanceof Se&&i instanceof Se&&s instanceof Se)return new Se(n.data.map((u,f)=>n.data[f]*(1-s.data[f])+i.data[f]*s.data[f]),n.typeInfo);const a=i,o=s;return new Je(n.value*(1-o.value)+a.value*o.value,n.typeInfo)}Modf(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(n instanceof Se&&i instanceof Se)return new Se(n.data.map((a,o)=>a%i.data[o]),n.typeInfo);const s=i;return new Je(n.value%s.value,n.typeInfo)}Normalize(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se){const i=this.Length(e,t).value;return new Se(n.data.map(s=>s/i),n.typeInfo)}return console.error(`Normalize() expects a vector argument. Line ${e.line}`),null}Pow(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(n instanceof Se&&i instanceof Se)return new Se(n.data.map((o,u)=>Math.pow(o,i.data[u])),n.typeInfo);const s=n,a=i;return new Je(Math.pow(s.value,a.value),n.typeInfo)}QuantizeToF16(e,t){const n=this.exec.evalExpression(e.args[0],t);return n instanceof Se?new Se(n.data.map(i=>i),n.typeInfo):new Je(n.value,n.typeInfo)}Radians(e,t){const n=this.exec.evalExpression(e.args[0],t);return n instanceof Se?new Se(n.data.map(i=>i*Math.PI/180),n.typeInfo):new Je(n.value*Math.PI/180,this.getTypeInfo("f32"))}Reflect(e,t){let n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(n instanceof Se&&i instanceof Se){const s=this._dot(n.data,i.data);return new Se(n.data.map((a,o)=>a-2*s*i.data[o]),n.typeInfo)}return console.error(`Reflect() expects vector arguments. Line ${e.line}`),null}Refract(e,t){let n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t);if(n instanceof Se&&i instanceof Se&&s instanceof Je){const a=this._dot(i.data,n.data);return new Se(n.data.map((o,u)=>{const f=1-s.value*s.value*(1-a*a);if(f<0)return 0;const g=Math.sqrt(f);return s.value*o-(s.value*a+g)*i.data[u]}),n.typeInfo)}return console.error(`Refract() expects vector arguments and a scalar argument. Line ${e.line}`),null}ReverseBits(e,t){return console.error(`TODO: reverseBits. Line ${e.line}`),null}Round(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.round(s)),n.typeInfo);const i=n;return new Je(Math.round(i.value),n.typeInfo)}Saturate(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.min(Math.max(s,0),1)),n.typeInfo);const i=n;return new Je(Math.min(Math.max(i.value,0),1),n.typeInfo)}Sign(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.sign(s)),n.typeInfo);const i=n;return new Je(Math.sign(i.value),n.typeInfo)}Sin(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.sin(s)),n.typeInfo);const i=n;return new Je(Math.sin(i.value),n.typeInfo)}Sinh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.sinh(s)),n.typeInfo);const i=n;return new Je(Math.sinh(i.value),n.typeInfo)}_smoothstep(e,t,n){const i=Math.min(Math.max((n-e)/(t-e),0),1);return i*i*(3-2*i)}SmoothStep(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),s=this.exec.evalExpression(e.args[2],t);if(s instanceof Se&&n instanceof Se&&i instanceof Se)return new Se(s.data.map((f,g)=>this._smoothstep(n.data[g],i.data[g],f)),s.typeInfo);const a=n,o=i,u=s;return new Je(this._smoothstep(a.value,o.value,u.value),s.typeInfo)}Sqrt(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.sqrt(s)),n.typeInfo);const i=n;return new Je(Math.sqrt(i.value),n.typeInfo)}Step(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(i instanceof Se&&n instanceof Se)return new Se(i.data.map((a,o)=>a<n.data[o]?0:1),i.typeInfo);const s=n;return new Je(i.value<s.value?0:1,s.typeInfo)}Tan(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.tan(s)),n.typeInfo);const i=n;return new Je(Math.tan(i.value),n.typeInfo)}Tanh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.tanh(s)),n.typeInfo);const i=n;return new Je(Math.tanh(i.value),n.typeInfo)}_getTransposeType(e){const t=e.getTypeName();return t==="mat2x2f"||t==="mat2x2h"?e:t==="mat2x3f"?this.getTypeInfo("mat3x2f"):t==="mat2x3h"?this.getTypeInfo("mat3x2h"):t==="mat2x4f"?this.getTypeInfo("mat4x2f"):t==="mat2x4h"?this.getTypeInfo("mat4x2h"):t==="mat3x2f"?this.getTypeInfo("mat2x3f"):t==="mat3x2h"?this.getTypeInfo("mat2x3h"):t==="mat3x3f"||t==="mat3x3h"?e:t==="mat3x4f"?this.getTypeInfo("mat4x3f"):t==="mat3x4h"?this.getTypeInfo("mat4x3h"):t==="mat4x2f"?this.getTypeInfo("mat2x4f"):t==="mat4x2h"?this.getTypeInfo("mat2x4h"):t==="mat4x3f"?this.getTypeInfo("mat3x4f"):t==="mat4x3h"?this.getTypeInfo("mat3x4h"):(t==="mat4x4f"||t==="mat4x4h"||console.error(`Invalid matrix type ${t}`),e)}Transpose(e,t){const n=this.exec.evalExpression(e.args[0],t);if(!(n instanceof Vr))return console.error(`Transpose() expects a matrix argument. Line ${e.line}`),null;const i=this._getTransposeType(n.typeInfo);if(n.typeInfo.name==="mat2x2"||n.typeInfo.name==="mat2x2f"||n.typeInfo.name==="mat2x2h"){const s=n.data;return new Vr([s[0],s[2],s[1],s[3]],i)}if(n.typeInfo.name==="mat2x3"||n.typeInfo.name==="mat2x3f"||n.typeInfo.name==="mat2x3h"){const s=n.data;return new Vr([s[0],s[3],s[6],s[1],s[4],s[7]],i)}if(n.typeInfo.name==="mat2x4"||n.typeInfo.name==="mat2x4f"||n.typeInfo.name==="mat2x4h"){const s=n.data;return new Vr([s[0],s[4],s[8],s[12],s[1],s[5],s[9],s[13]],i)}if(n.typeInfo.name==="mat3x2"||n.typeInfo.name==="mat3x2f"||n.typeInfo.name==="mat3x2h"){const s=n.data;return new Vr([s[0],s[3],s[1],s[4],s[2],s[5]],i)}if(n.typeInfo.name==="mat3x3"||n.typeInfo.name==="mat3x3f"||n.typeInfo.name==="mat3x3h"){const s=n.data;return new Vr([s[0],s[3],s[6],s[1],s[4],s[7],s[2],s[5],s[8]],i)}if(n.typeInfo.name==="mat3x4"||n.typeInfo.name==="mat3x4f"||n.typeInfo.name==="mat3x4h"){const s=n.data;return new Vr([s[0],s[4],s[8],s[12],s[1],s[5],s[9],s[13],s[2],s[6],s[10],s[14]],i)}if(n.typeInfo.name==="mat4x2"||n.typeInfo.name==="mat4x2f"||n.typeInfo.name==="mat4x2h"){const s=n.data;return new Vr([s[0],s[4],s[1],s[5],s[2],s[6]],i)}if(n.typeInfo.name==="mat4x3"||n.typeInfo.name==="mat4x3f"||n.typeInfo.name==="mat4x3h"){const s=n.data;return new Vr([s[0],s[4],s[8],s[1],s[5],s[9],s[2],s[6],s[10]],i)}if(n.typeInfo.name==="mat4x4"||n.typeInfo.name==="mat4x4f"||n.typeInfo.name==="mat4x4h"){const s=n.data;return new Vr([s[0],s[4],s[8],s[12],s[1],s[5],s[9],s[13],s[2],s[6],s[10],s[14],s[3],s[7],s[11],s[15]],i)}return console.error(`Invalid matrix type ${n.typeInfo.name}`),null}Trunc(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Se)return new Se(n.data.map(s=>Math.trunc(s)),n.typeInfo);const i=n;return new Je(Math.trunc(i.value),n.typeInfo)}Dpdx(e,t){return console.error(`TODO: dpdx. Line ${e.line}`),null}DpdxCoarse(e,t){return console.error(`TODO: dpdxCoarse. Line ${e.line}`),null}DpdxFine(e,t){return console.error("TODO: dpdxFine"),null}Dpdy(e,t){return console.error("TODO: dpdy"),null}DpdyCoarse(e,t){return console.error("TODO: dpdyCoarse"),null}DpdyFine(e,t){return console.error("TODO: dpdyFine"),null}Fwidth(e,t){return console.error("TODO: fwidth"),null}FwidthCoarse(e,t){return console.error("TODO: fwidthCoarse"),null}FwidthFine(e,t){return console.error("TODO: fwidthFine"),null}TextureDimensions(e,t){const n=e.args[0],i=e.args.length>1?this.exec.evalExpression(e.args[1],t).value:0;if(n instanceof La){const s=n.name,a=t.getVariableValue(s);if(a instanceof Du){if(i<0||i>=a.mipLevelCount)return console.error(`Invalid mip level for textureDimensions. Line ${e.line}`),null;const o=a.getMipLevelSize(i),u=a.dimension;return u==="1d"?new Je(o[0],this.getTypeInfo("u32")):u==="3d"?new Se(o,this.getTypeInfo("vec3u")):u==="2d"?new Se(o.slice(0,2),this.getTypeInfo("vec2u")):(console.error(`Invalid texture dimension ${u} not found. Line ${e.line}`),null)}return console.error(`Texture ${s} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureDimensions. Line ${e.line}`),null}TextureGather(e,t){return console.error("TODO: textureGather"),null}TextureGatherCompare(e,t){return console.error("TODO: textureGatherCompare"),null}TextureLoad(e,t){const n=e.args[0],i=this.exec.evalExpression(e.args[1],t),s=e.args.length>2?this.exec.evalExpression(e.args[2],t).value:0;if(!(i instanceof Se)||i.data.length!==2)return console.error(`Invalid UV argument for textureLoad. Line ${e.line}`),null;if(n instanceof La){const a=n.name,o=t.getVariableValue(a);if(o instanceof Du){const u=Math.floor(i.data[0]),f=Math.floor(i.data[1]);if(u<0||u>=o.width||f<0||f>=o.height)return console.error(`Texture ${a} out of bounds. Line ${e.line}`),null;const g=o.getPixel(u,f,0,s);return g===null?(console.error(`Invalid texture format for textureLoad. Line ${e.line}`),null):new Se(g,this.getTypeInfo("vec4f"))}return console.error(`Texture ${a} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureLoad. Line ${e.line}`),null}TextureNumLayers(e,t){const n=e.args[0];if(n instanceof La){const i=n.name,s=t.getVariableValue(i);return s instanceof Du?new Je(s.depthOrArrayLayers,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLayers. Line ${e.line}`),null}TextureNumLevels(e,t){const n=e.args[0];if(n instanceof La){const i=n.name,s=t.getVariableValue(i);return s instanceof Du?new Je(s.mipLevelCount,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLevels. Line ${e.line}`),null}TextureNumSamples(e,t){const n=e.args[0];if(n instanceof La){const i=n.name,s=t.getVariableValue(i);return s instanceof Du?new Je(s.sampleCount,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumSamples. Line ${e.line}`),null}TextureSample(e,t){return console.error("TODO: textureSample"),null}TextureSampleBias(e,t){return console.error("TODO: textureSampleBias"),null}TextureSampleCompare(e,t){return console.error("TODO: textureSampleCompare"),null}TextureSampleCompareLevel(e,t){return console.error("TODO: textureSampleCompareLevel"),null}TextureSampleGrad(e,t){return console.error("TODO: textureSampleGrad"),null}TextureSampleLevel(e,t){return console.error("TODO: textureSampleLevel"),null}TextureSampleBaseClampToEdge(e,t){return console.error("TODO: textureSampleBaseClampToEdge"),null}TextureStore(e,t){const n=e.args[0],i=this.exec.evalExpression(e.args[1],t),s=e.args.length===4?this.exec.evalExpression(e.args[2],t).value:0,a=e.args.length===4?this.exec.evalExpression(e.args[3],t).data:this.exec.evalExpression(e.args[2],t).data;if(a.length!==4)return console.error(`Invalid value argument for textureStore. Line ${e.line}`),null;if(!(i instanceof Se)||i.data.length!==2)return console.error(`Invalid UV argument for textureStore. Line ${e.line}`),null;if(n instanceof La){const o=n.name,u=t.getVariableValue(o);if(u instanceof Du){const f=u.getMipLevelSize(0),g=Math.floor(i.data[0]),y=Math.floor(i.data[1]);return g<0||g>=f[0]||y<0||y>=f[1]?(console.error(`Texture ${o} out of bounds. Line ${e.line}`),null):(u.setPixel(g,y,0,s,Array.from(a)),null)}return console.error(`Texture ${o} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureStore. Line ${e.line}`),null}AtomicLoad(e,t){let n=e.args[0];n instanceof ms&&(n=n.right);const i=this.exec.getVariableName(n,t);return t.getVariable(i).value.getSubData(this.exec,n.postfix,t)}AtomicStore(e,t){let n=e.args[0];n instanceof ms&&(n=n.right);const i=this.exec.getVariableName(n,t),s=t.getVariable(i);let a=e.args[1];const o=this.exec.evalExpression(a,t),u=s.value.getSubData(this.exec,n.postfix,t);return u instanceof Je&&o instanceof Je&&(u.value=o.value),s.value instanceof Vs&&s.value.setDataValue(this.exec,u,n.postfix,t),null}AtomicAdd(e,t){let n=e.args[0];n instanceof ms&&(n=n.right);const i=this.exec.getVariableName(n,t),s=t.getVariable(i);let a=e.args[1];const o=this.exec.evalExpression(a,t),u=s.value.getSubData(this.exec,n.postfix,t),f=new Je(u.value,u.typeInfo);return u instanceof Je&&o instanceof Je&&(u.value+=o.value),s.value instanceof Vs&&s.value.setDataValue(this.exec,u,n.postfix,t),f}AtomicSub(e,t){let n=e.args[0];n instanceof ms&&(n=n.right);const i=this.exec.getVariableName(n,t),s=t.getVariable(i);let a=e.args[1];const o=this.exec.evalExpression(a,t),u=s.value.getSubData(this.exec,n.postfix,t),f=new Je(u.value,u.typeInfo);return u instanceof Je&&o instanceof Je&&(u.value-=o.value),s.value instanceof Vs&&s.value.setDataValue(this.exec,u,n.postfix,t),f}AtomicMax(e,t){let n=e.args[0];n instanceof ms&&(n=n.right);const i=this.exec.getVariableName(n,t),s=t.getVariable(i);let a=e.args[1];const o=this.exec.evalExpression(a,t),u=s.value.getSubData(this.exec,n.postfix,t),f=new Je(u.value,u.typeInfo);return u instanceof Je&&o instanceof Je&&(u.value=Math.max(u.value,o.value)),s.value instanceof Vs&&s.value.setDataValue(this.exec,u,n.postfix,t),f}AtomicMin(e,t){let n=e.args[0];n instanceof ms&&(n=n.right);const i=this.exec.getVariableName(n,t),s=t.getVariable(i);let a=e.args[1];const o=this.exec.evalExpression(a,t),u=s.value.getSubData(this.exec,n.postfix,t),f=new Je(u.value,u.typeInfo);return u instanceof Je&&o instanceof Je&&(u.value=Math.min(u.value,o.value)),s.value instanceof Vs&&s.value.setDataValue(this.exec,u,n.postfix,t),f}AtomicAnd(e,t){let n=e.args[0];n instanceof ms&&(n=n.right);const i=this.exec.getVariableName(n,t),s=t.getVariable(i);let a=e.args[1];const o=this.exec.evalExpression(a,t),u=s.value.getSubData(this.exec,n.postfix,t),f=new Je(u.value,u.typeInfo);return u instanceof Je&&o instanceof Je&&(u.value=u.value&o.value),s.value instanceof Vs&&s.value.setDataValue(this.exec,u,n.postfix,t),f}AtomicOr(e,t){let n=e.args[0];n instanceof ms&&(n=n.right);const i=this.exec.getVariableName(n,t),s=t.getVariable(i);let a=e.args[1];const o=this.exec.evalExpression(a,t),u=s.value.getSubData(this.exec,n.postfix,t),f=new Je(u.value,u.typeInfo);return u instanceof Je&&o instanceof Je&&(u.value=u.value|o.value),s.value instanceof Vs&&s.value.setDataValue(this.exec,u,n.postfix,t),f}AtomicXor(e,t){let n=e.args[0];n instanceof ms&&(n=n.right);const i=this.exec.getVariableName(n,t),s=t.getVariable(i);let a=e.args[1];const o=this.exec.evalExpression(a,t),u=s.value.getSubData(this.exec,n.postfix,t),f=new Je(u.value,u.typeInfo);return u instanceof Je&&o instanceof Je&&(u.value=u.value^o.value),s.value instanceof Vs&&s.value.setDataValue(this.exec,u,n.postfix,t),f}AtomicExchange(e,t){let n=e.args[0];n instanceof ms&&(n=n.right);const i=this.exec.getVariableName(n,t),s=t.getVariable(i);let a=e.args[1];const o=this.exec.evalExpression(a,t),u=s.value.getSubData(this.exec,n.postfix,t),f=new Je(u.value,u.typeInfo);return u instanceof Je&&o instanceof Je&&(u.value=o.value),s.value instanceof Vs&&s.value.setDataValue(this.exec,u,n.postfix,t),f}AtomicCompareExchangeWeak(e,t){return console.error("TODO: atomicCompareExchangeWeak"),null}Pack4x8snorm(e,t){return console.error("TODO: pack4x8snorm"),null}Pack4x8unorm(e,t){return console.error("TODO: pack4x8unorm"),null}Pack4xI8(e,t){return console.error("TODO: pack4xI8"),null}Pack4xU8(e,t){return console.error("TODO: pack4xU8"),null}Pack4x8Clamp(e,t){return console.error("TODO: pack4x8Clamp"),null}Pack4xU8Clamp(e,t){return console.error("TODO: pack4xU8Clamp"),null}Pack2x16snorm(e,t){return console.error("TODO: pack2x16snorm"),null}Pack2x16unorm(e,t){return console.error("TODO: pack2x16unorm"),null}Pack2x16float(e,t){return console.error("TODO: pack2x16float"),null}Unpack4x8snorm(e,t){return console.error("TODO: unpack4x8snorm"),null}Unpack4x8unorm(e,t){return console.error("TODO: unpack4x8unorm"),null}Unpack4xI8(e,t){return console.error("TODO: unpack4xI8"),null}Unpack4xU8(e,t){return console.error("TODO: unpack4xU8"),null}Unpack2x16snorm(e,t){return console.error("TODO: unpack2x16snorm"),null}Unpack2x16unorm(e,t){return console.error("TODO: unpack2x16unorm"),null}Unpack2x16float(e,t){return console.error("TODO: unpack2x16float"),null}StorageBarrier(e,t){return null}TextureBarrier(e,t){return null}WorkgroupBarrier(e,t){return null}WorkgroupUniformLoad(e,t){return null}SubgroupAdd(e,t){return console.error("TODO: subgroupAdd"),null}SubgroupExclusiveAdd(e,t){return console.error("TODO: subgroupExclusiveAdd"),null}SubgroupInclusiveAdd(e,t){return console.error("TODO: subgroupInclusiveAdd"),null}SubgroupAll(e,t){return console.error("TODO: subgroupAll"),null}SubgroupAnd(e,t){return console.error("TODO: subgroupAnd"),null}SubgroupAny(e,t){return console.error("TODO: subgroupAny"),null}SubgroupBallot(e,t){return console.error("TODO: subgroupBallot"),null}SubgroupBroadcast(e,t){return console.error("TODO: subgroupBroadcast"),null}SubgroupBroadcastFirst(e,t){return console.error("TODO: subgroupBroadcastFirst"),null}SubgroupElect(e,t){return console.error("TODO: subgroupElect"),null}SubgroupMax(e,t){return console.error("TODO: subgroupMax"),null}SubgroupMin(e,t){return console.error("TODO: subgroupMin"),null}SubgroupMul(e,t){return console.error("TODO: subgroupMul"),null}SubgroupExclusiveMul(e,t){return console.error("TODO: subgroupExclusiveMul"),null}SubgroupInclusiveMul(e,t){return console.error("TODO: subgroupInclusiveMul"),null}SubgroupOr(e,t){return console.error("TODO: subgroupOr"),null}SubgroupShuffle(e,t){return console.error("TODO: subgroupShuffle"),null}SubgroupShuffleDown(e,t){return console.error("TODO: subgroupShuffleDown"),null}SubgroupShuffleUp(e,t){return console.error("TODO: subgroupShuffleUp"),null}SubgroupShuffleXor(e,t){return console.error("TODO: subgroupShuffleXor"),null}SubgroupXor(e,t){return console.error("TODO: subgroupXor"),null}QuadBroadcast(e,t){return console.error("TODO: quadBroadcast"),null}QuadSwapDiagonal(e,t){return console.error("TODO: quadSwapDiagonal"),null}QuadSwapX(e,t){return console.error("TODO: quadSwapX"),null}QuadSwapY(e,t){return console.error("TODO: quadSwapY"),null}};const PI={vec2:2,vec2f:2,vec2i:2,vec2u:2,vec2b:2,vec2h:2,vec3:3,vec3f:3,vec3i:3,vec3u:3,vec3b:3,vec3h:3,vec4:4,vec4f:4,vec4i:4,vec4u:4,vec4b:4,vec4h:4},Oo={mat2x2:[2,2,4],mat2x2f:[2,2,4],mat2x2h:[2,2,4],mat2x3:[2,3,6],mat2x3f:[2,3,6],mat2x3h:[2,3,6],mat2x4:[2,4,8],mat2x4f:[2,4,8],mat2x4h:[2,4,8],mat3x2:[3,2,6],mat3x2f:[3,2,6],mat3x2h:[3,2,6],mat3x3:[3,3,9],mat3x3f:[3,3,9],mat3x3h:[3,3,9],mat3x4:[3,4,12],mat3x4f:[3,4,12],mat3x4h:[3,4,12],mat4x2:[4,2,8],mat4x2f:[4,2,8],mat4x2h:[4,2,8],mat4x3:[4,3,12],mat4x3f:[4,3,12],mat4x3h:[4,3,12],mat4x4:[4,4,16],mat4x4f:[4,4,16],mat4x4h:[4,4,16]};let Cw=class al extends Nge{constructor(e,t){var n;super(),this.ast=e??[],this.reflection=new Z0,this.reflection.updateAST(this.ast),this.context=(n=t?.clone())!==null&&n!==void 0?n:new Lge,this.builtins=new Fge(this),this.typeInfo={bool:this.getTypeInfo(Mt.bool),i32:this.getTypeInfo(Mt.i32),u32:this.getTypeInfo(Mt.u32),f32:this.getTypeInfo(Mt.f32),f16:this.getTypeInfo(Mt.f16),vec2f:this.getTypeInfo(Ye.vec2f),vec2u:this.getTypeInfo(Ye.vec2u),vec2i:this.getTypeInfo(Ye.vec2i),vec2h:this.getTypeInfo(Ye.vec2h),vec3f:this.getTypeInfo(Ye.vec3f),vec3u:this.getTypeInfo(Ye.vec3u),vec3i:this.getTypeInfo(Ye.vec3i),vec3h:this.getTypeInfo(Ye.vec3h),vec4f:this.getTypeInfo(Ye.vec4f),vec4u:this.getTypeInfo(Ye.vec4u),vec4i:this.getTypeInfo(Ye.vec4i),vec4h:this.getTypeInfo(Ye.vec4h),mat2x2f:this.getTypeInfo(Ye.mat2x2f),mat2x3f:this.getTypeInfo(Ye.mat2x3f),mat2x4f:this.getTypeInfo(Ye.mat2x4f),mat3x2f:this.getTypeInfo(Ye.mat3x2f),mat3x3f:this.getTypeInfo(Ye.mat3x3f),mat3x4f:this.getTypeInfo(Ye.mat3x4f),mat4x2f:this.getTypeInfo(Ye.mat4x2f),mat4x3f:this.getTypeInfo(Ye.mat4x3f),mat4x4f:this.getTypeInfo(Ye.mat4x4f)}}getVariableValue(e){var t,n;const i=(n=(t=this.context.getVariable(e))===null||t===void 0?void 0:t.value)!==null&&n!==void 0?n:null;if(i===null)return null;if(i instanceof Je)return i.value;if(i instanceof Se||i instanceof Vr)return Array.from(i.data);if(i instanceof Vs&&i.typeInfo instanceof yd){if(i.typeInfo.format.name==="u32")return Array.from(new Uint32Array(i.buffer,i.offset,i.typeInfo.count));if(i.typeInfo.format.name==="i32")return Array.from(new Int32Array(i.buffer,i.offset,i.typeInfo.count));if(i.typeInfo.format.name==="f32")return Array.from(new Float32Array(i.buffer,i.offset,i.typeInfo.count))}return console.error(`Unsupported return variable type ${i.typeInfo.name}`),null}execute(e){(e=e??{}).constants&&this._setOverrides(e.constants,this.context),this._execStatements(this.ast,this.context)}dispatchWorkgroups(e,t,n,i){const s=this.context.clone();(i=i??{}).constants&&this._setOverrides(i.constants,s),this._execStatements(this.ast,s);const a=s.getFunction(e);if(!a)return void console.error(`Function ${e} not found`);if(typeof t=="number")t=[t,1,1];else{if(t.length===0)return void console.error("Invalid dispatch count");t.length===1?t=[t[0],1,1]:t.length===2?t=[t[0],t[1],1]:t.length>3&&(t=[t[0],t[1],t[2]])}const o=t[0],u=t[1],f=t[2],g=this.getTypeInfo("vec3u");s.setVariable("@num_workgroups",new Se(t,g));const y=this.reflection.getFunctionInfo(e);y===null&&console.error(`Function ${e} not found in reflection data`);for(const A in n)for(const C in n[A]){const M=n[A][C];s.variables.forEach(k=>{var D;const V=k.node;if(V?.attributes){let W=null,z=null;for(const $ of V.attributes)$.name==="binding"?W=$.value:$.name==="group"&&(z=$.value);if(C==W&&A==z){let $=!1;for(const te of y.resources)if(te.name===k.name&&te.group===parseInt(A)&&te.binding===parseInt(C)){$=!0;break}if($)if(M.texture!==void 0&&M.descriptor!==void 0){const te=new Du(M.texture,this.getTypeInfo(V.type),M.descriptor,(D=M.texture.view)!==null&&D!==void 0?D:null);k.value=te}else M.uniform!==void 0?k.value=new Vs(M.uniform,this.getTypeInfo(V.type)):k.value=new Vs(M,this.getTypeInfo(V.type))}}})}for(let A=0;A<f;++A)for(let C=0;C<u;++C)for(let M=0;M<o;++M)s.setVariable("@workgroup_id",new Se([M,C,A],this.getTypeInfo("vec3u"))),this._dispatchWorkgroup(a,[M,C,A],s)}execStatement(e,t){if(e instanceof LW)return this.evalExpression(e.value,t);if(e instanceof FW){if(e.condition){const n=this.evalExpression(e.condition,t);if(!(n instanceof Je))throw new Error("Invalid break-if condition");if(!n.value)return null}return al._breakObj}if(e instanceof UW)return al._continueObj;if(e instanceof q0)this._let(e,t);else if(e instanceof Fu)this._var(e,t);else if(e instanceof _w)this._const(e,t);else if(e instanceof $_)this._function(e,t);else{if(e instanceof DW)return this._if(e,t);if(e instanceof OW)return this._switch(e,t);if(e instanceof BW)return this._for(e,t);if(e instanceof PW)return this._while(e,t);if(e instanceof kW)return this._loop(e,t);if(e instanceof oB){const n=t.clone();return n.currentFunctionName=t.currentFunctionName,this._execStatements(e.body,n)}if(e instanceof RW)this._assign(e,t);else if(e instanceof MW)this._increment(e,t);else{if(e instanceof Ou)return null;if(e instanceof eO){const n=e.name;t.getVariable(n)===null&&t.setVariable(n,new Je(0,this.getTypeInfo("u32")))}else if(e instanceof tO)this._call(e,t);else{if(e instanceof NW||e instanceof rO)return null;console.error("Invalid statement type.",e,`Line ${e.line}`)}}}return null}evalExpression(e,t){return e instanceof Fl?this._evalBinaryOp(e,t):e instanceof Is?this._evalLiteral(e,t):e instanceof La?this._evalVariable(e,t):e instanceof nO?this._evalCall(e,t):e instanceof kc?this._evalCreate(e,t):e instanceof zW?this._evalConst(e,t):e instanceof VW?this._evalBitcast(e,t):e instanceof ms?this._evalUnaryOp(e,t):(console.error("Invalid expression type",e,`Line ${e.line}`),null)}getTypeInfo(e){var t;if(e instanceof Mt){const i=this.reflection.getTypeInfo(e);if(i!==null)return i}let n=(t=this.typeInfo[e])!==null&&t!==void 0?t:null;return n!==null||(n=this.reflection.getTypeInfoByName(e)),n}_setOverrides(e,t){for(const n in e){const i=e[n],s=this.reflection.getOverrideInfo(n);s!==null?(s.type===null&&(s.type=this.getTypeInfo("u32")),s.type.name==="u32"||s.type.name==="i32"||s.type.name==="f32"||s.type.name==="f16"?t.setVariable(n,new Je(i,s.type)):s.type.name==="bool"?t.setVariable(n,new Je(i?1:0,s.type)):s.type.name==="vec2"||s.type.name==="vec3"||s.type.name==="vec4"||s.type.name==="vec2f"||s.type.name==="vec3f"||s.type.name==="vec4f"||s.type.name==="vec2i"||s.type.name==="vec3i"||s.type.name==="vec4i"||s.type.name==="vec2u"||s.type.name==="vec3u"||s.type.name==="vec4u"||s.type.name==="vec2h"||s.type.name==="vec3h"||s.type.name==="vec4h"?t.setVariable(n,new Se(i,s.type)):console.error(`Invalid constant type for ${n}`)):console.error(`Override ${n} does not exist in the shader.`)}}_dispatchWorkgroup(e,t,n){const i=[1,1,1];for(const g of e.node.attributes)if(g.name==="workgroup_size"){if(g.value.length>0){const y=n.getVariableValue(g.value[0]);i[0]=y instanceof Je?y.value:parseInt(g.value[0])}if(g.value.length>1){const y=n.getVariableValue(g.value[1]);i[1]=y instanceof Je?y.value:parseInt(g.value[1])}if(g.value.length>2){const y=n.getVariableValue(g.value[2]);i[2]=y instanceof Je?y.value:parseInt(g.value[2])}}const s=this.getTypeInfo("vec3u"),a=this.getTypeInfo("u32");n.setVariable("@workgroup_size",new Se(i,s));const o=i[0],u=i[1],f=i[2];for(let g=0,y=0;g<f;++g)for(let A=0;A<u;++A)for(let C=0;C<o;++C,++y){const M=[C,A,g],k=[C+t[0]*i[0],A+t[1]*i[1],g+t[2]*i[2]];n.setVariable("@local_invocation_id",new Se(M,s)),n.setVariable("@global_invocation_id",new Se(k,s)),n.setVariable("@local_invocation_index",new Je(y,a)),this._dispatchExec(e,n)}}_dispatchExec(e,t){for(const n of e.node.args)for(const i of n.attributes)if(i.name==="builtin"){const s=`@${i.value}`,a=t.getVariable(s);a!==void 0&&t.variables.set(n.name,a)}this._execStatements(e.node.body,t)}getVariableName(e,t){for(;e instanceof ms;)e=e.right;return e instanceof La?e.name:(console.error("Unknown variable type",e,"Line",e.line),null)}_execStatements(e,t){for(const n of e){if(n instanceof Array){const s=t.clone(),a=this._execStatements(n,s);if(a)return a;continue}const i=this.execStatement(n,t);if(i)return i}return null}_call(e,t){const n=t.clone();n.currentFunctionName=e.name;const i=t.getFunction(e.name);if(i){for(let s=0;s<i.node.args.length;++s){const a=i.node.args[s],o=this.evalExpression(e.args[s],n);n.setVariable(a.name,o,a)}this._execStatements(i.node.body,n)}else e.isBuiltin?this._callBuiltinFunction(e,n):this.getTypeInfo(e.name)&&this._evalCreate(e,t)}_increment(e,t){const n=this.getVariableName(e.variable,t),i=t.getVariable(n);i?e.operator==="++"?i.value instanceof Je?i.value.value++:console.error(`Variable ${n} is not a scalar. Line ${e.line}`):e.operator==="--"?i.value instanceof Je?i.value.value--:console.error(`Variable ${n} is not a scalar. Line ${e.line}`):console.error(`Unknown increment operator ${e.operator}. Line ${e.line}`):console.error(`Variable ${n} not found. Line ${e.line}`)}_getVariableData(e,t){if(e instanceof La){const n=this.getVariableName(e,t),i=t.getVariable(n);return i===null?(console.error(`Variable ${n} not found. Line ${e.line}`),null):i.value.getSubData(this,e.postfix,t)}if(e instanceof ms){if(e.operator==="*"){const n=this._getVariableData(e.right,t);return n instanceof Dg?n.reference.getSubData(this,e.postfix,t):(console.error(`Variable ${e.right} is not a pointer. Line ${e.line}`),null)}if(e.operator==="&"){const n=this._getVariableData(e.right,t);return new Dg(n)}}return null}_assign(e,t){let n=null,i="<var>",s=null;if(e.variable instanceof ms){const u=this._getVariableData(e.variable,t),f=this.evalExpression(e.value,t),g=e.operator;if(g==="="){if(u instanceof Je||u instanceof Se||u instanceof Vr){if(f instanceof Je||f instanceof Se||f instanceof Vr&&u.data.length===f.data.length)return void u.data.set(f.data);console.error(`Invalid assignment. Line ${e.line}`)}else if(u instanceof Vs&&f instanceof Vs&&u.buffer.byteLength-u.offset>=f.buffer.byteLength-f.offset)return void(u.buffer.byteLength%4==0?new Uint32Array(u.buffer,u.offset,u.typeInfo.size/4).set(new Uint32Array(f.buffer,f.offset,f.typeInfo.size/4)):new Uint8Array(u.buffer,u.offset,u.typeInfo.size).set(new Uint8Array(f.buffer,f.offset,f.typeInfo.size)));return console.error(`Invalid assignment. Line ${e.line}`),null}if(g==="+=")return u instanceof Je||u instanceof Se||u instanceof Vr?f instanceof Je||f instanceof Se||f instanceof Vr?void u.data.set(f.data.map((y,A)=>u.data[A]+y)):void console.error(`Invalid assignment . Line ${e.line}`):void console.error(`Invalid assignment. Line ${e.line}`);if(g==="-=")return(u instanceof Je||u instanceof Se||u instanceof Vr)&&(f instanceof Je||f instanceof Se||f instanceof Vr)?void u.data.set(f.data.map((y,A)=>u.data[A]-y)):void console.error(`Invalid assignment. Line ${e.line}`)}if(e.variable instanceof ms){if(e.variable.operator==="*"){i=this.getVariableName(e.variable.right,t);const u=t.getVariable(i);if(!(u&&u.value instanceof Dg))return void console.error(`Variable ${i} is not a pointer. Line ${e.line}`);n=u.value.reference;let f=e.variable.postfix;if(!f){let g=e.variable.right;for(;g instanceof ms;){if(g.postfix){f=g.postfix;break}g=g.right}}f&&(n=n.getSubData(this,f,t))}}else{s=e.variable.postfix,i=this.getVariableName(e.variable,t);const u=t.getVariable(i);if(u===null)return void console.error(`Variable ${i} not found. Line ${e.line}`);n=u.value}if(n instanceof Dg&&(n=n.reference),n===null)return void console.error(`Variable ${i} not found. Line ${e.line}`);const a=this.evalExpression(e.value,t),o=e.operator;if(o!=="="){const u=n.getSubData(this,s,t);if(u instanceof Se&&a instanceof Je){const f=u.data,g=a.value;if(o==="+=")for(let y=0;y<f.length;++y)f[y]+=g;else if(o==="-=")for(let y=0;y<f.length;++y)f[y]-=g;else if(o==="*=")for(let y=0;y<f.length;++y)f[y]*=g;else if(o==="/=")for(let y=0;y<f.length;++y)f[y]/=g;else if(o==="%=")for(let y=0;y<f.length;++y)f[y]%=g;else if(o==="&=")for(let y=0;y<f.length;++y)f[y]&=g;else if(o==="|=")for(let y=0;y<f.length;++y)f[y]|=g;else if(o==="^=")for(let y=0;y<f.length;++y)f[y]^=g;else if(o==="<<=")for(let y=0;y<f.length;++y)f[y]<<=g;else if(o===">>=")for(let y=0;y<f.length;++y)f[y]>>=g;else console.error(`Invalid operator ${o}. Line ${e.line}`)}else if(u instanceof Se&&a instanceof Se){const f=u.data,g=a.data;if(f.length!==g.length)return void console.error(`Vector length mismatch. Line ${e.line}`);if(o==="+=")for(let y=0;y<f.length;++y)f[y]+=g[y];else if(o==="-=")for(let y=0;y<f.length;++y)f[y]-=g[y];else if(o==="*=")for(let y=0;y<f.length;++y)f[y]*=g[y];else if(o==="/=")for(let y=0;y<f.length;++y)f[y]/=g[y];else if(o==="%=")for(let y=0;y<f.length;++y)f[y]%=g[y];else if(o==="&=")for(let y=0;y<f.length;++y)f[y]&=g[y];else if(o==="|=")for(let y=0;y<f.length;++y)f[y]|=g[y];else if(o==="^=")for(let y=0;y<f.length;++y)f[y]^=g[y];else if(o==="<<=")for(let y=0;y<f.length;++y)f[y]<<=g[y];else if(o===">>=")for(let y=0;y<f.length;++y)f[y]>>=g[y];else console.error(`Invalid operator ${o}. Line ${e.line}`)}else{if(!(u instanceof Je&&a instanceof Je))return void console.error(`Invalid type for ${e.operator} operator. Line ${e.line}`);o==="+="?u.value+=a.value:o==="-="?u.value-=a.value:o==="*="?u.value*=a.value:o==="/="?u.value/=a.value:o==="%="?u.value%=a.value:o==="&="?u.value&=a.value:o==="|="?u.value|=a.value:o==="^="?u.value^=a.value:o==="<<="?u.value<<=a.value:o===">>="?u.value>>=a.value:console.error(`Invalid operator ${o}. Line ${e.line}`)}return void(n instanceof Vs&&n.setDataValue(this,u,s,t))}if(n instanceof Vs)n.setDataValue(this,a,s,t);else if(s){if(!(n instanceof Se||n instanceof Vr))return void console.error(`Variable ${i} is not a vector or matrix. Line ${e.line}`);if(s instanceof ty){const u=this.evalExpression(s.index,t).value;if(n instanceof Se){if(!(a instanceof Je))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[u]=a.value}else{if(!(n instanceof Vr))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);{const f=this.evalExpression(s.index,t).value;if(f<0)return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(!(a instanceof Se))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);{const g=n.typeInfo.getTypeName();if(g==="mat2x2"||g==="mat2x2f"||g==="mat2x2h"){if(!(f<2&&a.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[2*f]=a.data[0],n.data[2*f+1]=a.data[1]}else if(g==="mat2x3"||g==="mat2x3f"||g==="mat2x3h"){if(!(f<2&&a.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[3*f]=a.data[0],n.data[3*f+1]=a.data[1],n.data[3*f+2]=a.data[2]}else if(g==="mat2x4"||g==="mat2x4f"||g==="mat2x4h"){if(!(f<2&&a.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[4*f]=a.data[0],n.data[4*f+1]=a.data[1],n.data[4*f+2]=a.data[2],n.data[4*f+3]=a.data[3]}else if(g==="mat3x2"||g==="mat3x2f"||g==="mat3x2h"){if(!(f<3&&a.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[2*f]=a.data[0],n.data[2*f+1]=a.data[1]}else if(g==="mat3x3"||g==="mat3x3f"||g==="mat3x3h"){if(!(f<3&&a.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[3*f]=a.data[0],n.data[3*f+1]=a.data[1],n.data[3*f+2]=a.data[2]}else if(g==="mat3x4"||g==="mat3x4f"||g==="mat3x4h"){if(!(f<3&&a.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[4*f]=a.data[0],n.data[4*f+1]=a.data[1],n.data[4*f+2]=a.data[2],n.data[4*f+3]=a.data[3]}else if(g==="mat4x2"||g==="mat4x2f"||g==="mat4x2h"){if(!(f<4&&a.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[2*f]=a.data[0],n.data[2*f+1]=a.data[1]}else if(g==="mat4x3"||g==="mat4x3f"||g==="mat4x3h"){if(!(f<4&&a.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[3*f]=a.data[0],n.data[3*f+1]=a.data[1],n.data[3*f+2]=a.data[2]}else{if(g!=="mat4x4"&&g!=="mat4x4f"&&g!=="mat4x4h")return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(!(f<4&&a.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);n.data[4*f]=a.data[0],n.data[4*f+1]=a.data[1],n.data[4*f+2]=a.data[2],n.data[4*f+3]=a.data[3]}}}}}else if(s instanceof fp){const u=s.value;if(!(n instanceof Se))return void console.error(`Invalid assignment to ${u}. Variable ${i} is not a vector. Line ${e.line}`);if(a instanceof Je){if(u.length>1)return void console.error(`Invalid assignment to ${u} for variable ${i}. Line ${e.line}`);if(u==="x")n.data[0]=a.value;else if(u==="y"){if(n.data.length<2)return void console.error(`Invalid assignment to ${u} for variable ${i}. Line ${e.line}`);n.data[1]=a.value}else if(u==="z"){if(n.data.length<3)return void console.error(`Invalid assignment to ${u} for variable ${i}. Line ${e.line}`);n.data[2]=a.value}else if(u==="w"){if(n.data.length<4)return void console.error(`Invalid assignment to ${u} for variable ${i}. Line ${e.line}`);n.data[3]=a.value}}else{if(!(a instanceof Se))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(u.length!==a.data.length)return void console.error(`Invalid assignment to ${u} for variable ${i}. Line ${e.line}`);for(let f=0;f<u.length;++f){const g=u[f];if(g==="x"||g==="r")n.data[0]=a.data[f];else if(g==="y"||g==="g"){if(a.data.length<2)return void console.error(`Invalid assignment to ${g} for variable ${i}. Line ${e.line}`);n.data[1]=a.data[f]}else if(g==="z"||g==="b"){if(a.data.length<3)return void console.error(`Invalid assignment to ${g} for variable ${i}. Line ${e.line}`);n.data[2]=a.data[f]}else{if(g!=="w"&&g!=="a")return void console.error(`Invalid assignment to ${g} for variable ${i}. Line ${e.line}`);if(a.data.length<4)return void console.error(`Invalid assignment to ${g} for variable ${i}. Line ${e.line}`);n.data[3]=a.data[f]}}}}}else n instanceof Je&&a instanceof Je?n.value=a.value:n instanceof Se&&a instanceof Se||n instanceof Vr&&a instanceof Vr?n.data.set(a.data):console.error(`Invalid assignment to ${i}. Line ${e.line}`)}_function(e,t){const n=new sO(e);t.functions.set(e.name,n)}_const(e,t){let n=null;e.value!==null&&(n=this.evalExpression(e.value,t)),t.createVariable(e.name,n,e)}_let(e,t){let n=null;if(e.value!==null){if(n=this.evalExpression(e.value,t),n===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof ms||(n=n.clone())}else{const i=e.type.name;if(i==="f32"||i==="i32"||i==="u32"||i==="bool"||i==="f16"||i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2b"||i==="vec3b"||i==="vec4b"||i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"||i==="array"){const s=new kc(e.type,[]);n=this._evalCreate(s,t)}}t.createVariable(e.name,n,e)}_var(e,t){let n=null;if(e.value!==null){if(n=this.evalExpression(e.value,t),n===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof ms||(n=n.clone())}else{if(e.type===null)return void console.error(`Variable ${e.name} has no type. Line ${e.line}`);const i=e.type.name;if(i==="f32"||i==="i32"||i==="u32"||i==="bool"||i==="f16"||i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2b"||i==="vec3b"||i==="vec4b"||i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"||e.type instanceof Y0||e.type instanceof Ou||e.type instanceof Ye){const s=new kc(e.type,[]);n=this._evalCreate(s,t)}}t.createVariable(e.name,n,e)}_switch(e,t){t=t.clone();const n=this.evalExpression(e.condition,t);if(!(n instanceof Je))return console.error(`Invalid if condition. Line ${e.line}`),null;let i=null;for(const s of e.cases)if(s instanceof GW)for(const a of s.selectors){if(a instanceof xw){i=s;continue}const o=this.evalExpression(a,t);if(!(o instanceof Je))return console.error(`Invalid case selector. Line ${e.line}`),null;if(o.value===n.value)return this._execStatements(s.body,t)}else s instanceof HW&&(i=s);return i?this._execStatements(i.body,t):null}_if(e,t){t=t.clone();const n=this.evalExpression(e.condition,t);if(!(n instanceof Je))return console.error(`Invalid if condition. Line ${e.line}`),null;if(n.value)return this._execStatements(e.body,t);for(const i of e.elseif){const s=this.evalExpression(i.condition,t);if(!(s instanceof Je))return console.error(`Invalid if condition. Line ${e.line}`),null;if(s.value)return this._execStatements(i.body,t)}return e.else?this._execStatements(e.else,t):null}_getScalarValue(e){return e instanceof Je?e.value:(console.error("Expected scalar value.",e),0)}_for(e,t){for(t=t.clone(),this.execStatement(e.init,t);this._getScalarValue(this.evalExpression(e.condition,t));){const n=this._execStatements(e.body,t);if(n===al._breakObj)break;if(n!==null&&n!==al._continueObj)return n;this.execStatement(e.increment,t)}return null}_loop(e,t){for(t=t.clone();;){const n=this._execStatements(e.body,t);if(n===al._breakObj)break;if(n===al._continueObj){if(e.continuing&&this._execStatements(e.continuing.body,t)===al._breakObj)break}else if(n!==null)return n}return null}_while(e,t){for(t=t.clone();this._getScalarValue(this.evalExpression(e.condition,t));){const n=this._execStatements(e.body,t);if(n===al._breakObj)break;if(n!==al._continueObj&&n!==null)return n}return null}_evalBitcast(e,t){const n=this.evalExpression(e.value,t),i=e.type;if(n instanceof Je){const s=O6(n.value,n.typeInfo.name,i.name);return new Je(s,this.getTypeInfo(i))}if(n instanceof Se){const s=n.typeInfo.getTypeName();let a="";if(s.endsWith("f"))a="f32";else if(s.endsWith("i"))a="i32";else if(s.endsWith("u"))a="u32";else if(s.endsWith("b"))a="bool";else{if(!s.endsWith("h"))return console.error(`Unknown vector type ${s}. Line ${e.line}`),null;a="f16"}const o=i.getTypeName();let u="";if(o.endsWith("f"))u="f32";else if(o.endsWith("i"))u="i32";else if(o.endsWith("u"))u="u32";else if(o.endsWith("b"))u="bool";else{if(!o.endsWith("h"))return console.error(`Unknown vector type ${u}. Line ${e.line}`),null;u="f16"}const f=function(g,y,A){if(y===A)return g;const C=new Array(g.length);for(let M=0;M<g.length;M++)C[M]=O6(g[M],y,A);return C}(Array.from(n.data),a,u);return new Se(f,this.getTypeInfo(i))}return console.error(`TODO: bitcast for ${n.typeInfo.name}. Line ${e.line}`),null}_evalConst(e,t){return t.getVariableValue(e.name).clone().getSubData(this,e.postfix,t)}_evalCreate(e,t){var n;if(e instanceof kc){if(e.type===null)return aB.void;switch(e.type.getTypeName()){case"bool":case"i32":case"u32":case"f32":case"f16":return this._callConstructorValue(e,t);case"vec2":case"vec3":case"vec4":case"vec2f":case"vec3f":case"vec4f":case"vec2h":case"vec3h":case"vec4h":case"vec2i":case"vec3i":case"vec4i":case"vec2u":case"vec3u":case"vec4u":case"vec2b":case"vec3b":case"vec4b":return this._callConstructorVec(e,t);case"mat2x2":case"mat2x2f":case"mat2x2h":case"mat2x3":case"mat2x3f":case"mat2x3h":case"mat2x4":case"mat2x4f":case"mat2x4h":case"mat3x2":case"mat3x2f":case"mat3x2h":case"mat3x3":case"mat3x3f":case"mat3x3h":case"mat3x4":case"mat3x4f":case"mat3x4h":case"mat4x2":case"mat4x2f":case"mat4x2h":case"mat4x3":case"mat4x3f":case"mat4x3h":case"mat4x4":case"mat4x4f":case"mat4x4h":return this._callConstructorMatrix(e,t)}}const i=e instanceof kc?e.type.name:e.name,s=e instanceof kc?this.getTypeInfo(e.type):this.getTypeInfo(e.name);if(s===null)return console.error(`Unknown type ${i}. Line ${e.line}`),null;if(s.size===0)return null;const a=new Vs(new ArrayBuffer(s.size),s,0);if(s instanceof sd){if(e.args)for(let o=0;o<e.args.length;++o){const u=s.members[o],f=e.args[o],g=this.evalExpression(f,t);a.setData(this,g,u.type,u.offset,t)}}else if(s instanceof yd){let o=0;if(e.args)for(let u=0;u<e.args.length;++u){const f=e.args[u],g=this.evalExpression(f,t);s.format===null&&(((n=g.typeInfo)===null||n===void 0?void 0:n.name)==="x32"?s.format=this.getTypeInfo("i32"):s.format=g.typeInfo),a.setData(this,g,s.format,o,t),o+=s.stride}}else console.error(`Unknown type "${i}". Line ${e.line}`);return e instanceof kc?a.getSubData(this,e.postfix,t):a}_evalLiteral(e,t){const n=this.getTypeInfo(e.type),i=n.name;return i==="x32"||i==="u32"||i==="f32"||i==="f16"||i==="i32"||i==="bool"?new Je(e.scalarValue,n):i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"?this._callConstructorVec(e,t):i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"?this._callConstructorMatrix(e,t):e.value}_evalVariable(e,t){const n=t.getVariableValue(e.name);return n===null?n:n.getSubData(this,e.postfix,t)}_maxFormatTypeInfo(e){let t=e[0];if(t.name==="f32")return t;for(let n=1;n<e.length;++n){const i=al._priority.get(t.name);al._priority.get(e[n].name)<i&&(t=e[n])}return t.name==="x32"?this.getTypeInfo("i32"):t}_evalUnaryOp(e,t){const n=this.evalExpression(e.right,t);if(e.operator==="&")return new Dg(n);if(e.operator==="*")return n instanceof Dg?n.reference.getSubData(this,e.postfix,t):(console.error(`Invalid dereference. Line ${e.line}`),null);const i=n instanceof Je?n.value:n instanceof Se?Array.from(n.data):null;switch(e.operator){case"+":{if(lr(i)){const o=i.map((u,f)=>+u);return new Se(o,n.typeInfo)}const s=i,a=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new Je(+s,a)}case"-":{if(lr(i)){const o=i.map((u,f)=>-u);return new Se(o,n.typeInfo)}const s=i,a=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new Je(-s,a)}case"!":{if(lr(i)){const o=i.map((u,f)=>u?0:1);return new Se(o,n.typeInfo)}const s=i,a=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new Je(s?0:1,a)}case"~":{if(lr(i)){const o=i.map((u,f)=>~u);return new Se(o,n.typeInfo)}const s=i,a=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new Je(~s,a)}}return console.error(`Invalid unary operator ${e.operator}. Line ${e.line}`),null}_evalBinaryOp(e,t){const n=this.evalExpression(e.left,t),i=this.evalExpression(e.right,t),s=n instanceof Je?n.value:n instanceof Se||n instanceof Vr?Array.from(n.data):null,a=i instanceof Je?i.value:i instanceof Se||i instanceof Vr?Array.from(i.data):null;switch(e.operator){case"+":{if(lr(s)&&lr(a)){const g=s,y=a;if(g.length!==y.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const A=g.map((C,M)=>C+y[M]);return new Se(A,n.typeInfo)}if(lr(s)){const g=a,y=s.map((A,C)=>A+g);return new Se(y,n.typeInfo)}if(lr(a)){const g=s,y=a.map((A,C)=>g+A);return new Se(y,i.typeInfo)}const o=s,u=a,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new Je(o+u,f)}case"-":{if(lr(s)&&lr(a)){const g=s,y=a;if(g.length!==y.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const A=g.map((C,M)=>C-y[M]);return new Se(A,n.typeInfo)}if(lr(s)){const g=a,y=s.map((A,C)=>A-g);return new Se(y,n.typeInfo)}if(lr(a)){const g=s,y=a.map((A,C)=>g-A);return new Se(y,i.typeInfo)}const o=s,u=a,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new Je(o-u,f)}case"*":{if(lr(s)&&lr(a)){const g=s,y=a;if(n instanceof Vr&&i instanceof Vr){const A=function(D,V,W,z){if(Oo[V.name]===void 0||Oo[z.name]===void 0)return null;const $=Oo[V.name][0],te=Oo[V.name][1],le=Oo[z.name][0];if($!==Oo[z.name][1])return null;const _e=new Array(le*te);for(let se=0;se<te;se++)for(let Y=0;Y<le;Y++){let ce=0;for(let oe=0;oe<$;oe++)ce+=D[oe*te+se]*W[Y*$+oe];_e[se*le+Y]=ce}return _e}(g,n.typeInfo,y,i.typeInfo);if(A===null)return console.error(`Matrix multiplication failed. Line ${e.line}.`),null;const C=Oo[i.typeInfo.name][0],M=Oo[n.typeInfo.name][1],k=this.getTypeInfo(`mat${C}x${M}f`);return new Vr(A,k)}if(n instanceof Vr&&i instanceof Se){const A=function(C,M,k,D){if(Oo[M.name]===void 0||PI[D.name]===void 0)return null;const V=Oo[M.name][0],W=Oo[M.name][1];if(V!==k.length)return null;const z=new Array(W);for(let $=0;$<W;$++){let te=0;for(let le=0;le<V;le++)te+=C[le*W+$]*k[le];z[$]=te}return z}(g,n.typeInfo,y,i.typeInfo);return A===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new Se(A,i.typeInfo)}if(n instanceof Se&&i instanceof Vr){const A=function(C,M,k,D){if(PI[M.name]===void 0||Oo[D.name]===void 0)return null;const V=Oo[D.name][0],W=Oo[D.name][1];if(W!==C.length)return null;const z=[];for(let $=0;$<V;$++){let te=0;for(let le=0;le<W;le++)te+=C[le]*k[le*V+$];z[$]=te}return z}(g,n.typeInfo,y,i.typeInfo);return A===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new Se(A,n.typeInfo)}{if(g.length!==y.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const A=g.map((C,M)=>C*y[M]);return new Se(A,n.typeInfo)}}if(lr(s)){const g=a,y=s.map((A,C)=>A*g);return n instanceof Vr?new Vr(y,n.typeInfo):new Se(y,n.typeInfo)}if(lr(a)){const g=s,y=a.map((A,C)=>g*A);return i instanceof Vr?new Vr(y,i.typeInfo):new Se(y,i.typeInfo)}const o=s,u=a,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new Je(o*u,f)}case"%":{if(lr(s)&&lr(a)){const g=s,y=a;if(g.length!==y.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const A=g.map((C,M)=>C%y[M]);return new Se(A,n.typeInfo)}if(lr(s)){const g=a,y=s.map((A,C)=>A%g);return new Se(y,n.typeInfo)}if(lr(a)){const g=s,y=a.map((A,C)=>g%A);return new Se(y,i.typeInfo)}const o=s,u=a,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new Je(o%u,f)}case"/":{if(lr(s)&&lr(a)){const g=s,y=a;if(g.length!==y.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const A=g.map((C,M)=>C/y[M]);return new Se(A,n.typeInfo)}if(lr(s)){const g=a,y=s.map((A,C)=>A/g);return new Se(y,n.typeInfo)}if(lr(a)){const g=s,y=a.map((A,C)=>g/A);return new Se(y,i.typeInfo)}const o=s,u=a,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new Je(o/u,f)}case"&":{if(lr(s)&&lr(a)){const g=s,y=a;if(g.length!==y.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const A=g.map((C,M)=>C&y[M]);return new Se(A,n.typeInfo)}if(lr(s)){const g=a,y=s.map((A,C)=>A&g);return new Se(y,n.typeInfo)}if(lr(a)){const g=s,y=a.map((A,C)=>g&A);return new Se(y,i.typeInfo)}const o=s,u=a,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new Je(o&u,f)}case"|":{if(lr(s)&&lr(a)){const g=s,y=a;if(g.length!==y.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const A=g.map((C,M)=>C|y[M]);return new Se(A,n.typeInfo)}if(lr(s)){const g=a,y=s.map((A,C)=>A|g);return new Se(y,n.typeInfo)}if(lr(a)){const g=s,y=a.map((A,C)=>g|A);return new Se(y,i.typeInfo)}const o=s,u=a,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new Je(o|u,f)}case"^":{if(lr(s)&&lr(a)){const g=s,y=a;if(g.length!==y.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const A=g.map((C,M)=>C^y[M]);return new Se(A,n.typeInfo)}if(lr(s)){const g=a,y=s.map((A,C)=>A^g);return new Se(y,n.typeInfo)}if(lr(a)){const g=s,y=a.map((A,C)=>g^A);return new Se(y,i.typeInfo)}const o=s,u=a,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new Je(o^u,f)}case"<<":{if(lr(s)&&lr(a)){const g=s,y=a;if(g.length!==y.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const A=g.map((C,M)=>C<<y[M]);return new Se(A,n.typeInfo)}if(lr(s)){const g=a,y=s.map((A,C)=>A<<g);return new Se(y,n.typeInfo)}if(lr(a)){const g=s,y=a.map((A,C)=>g<<A);return new Se(y,i.typeInfo)}const o=s,u=a,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new Je(o<<u,f)}case">>":{if(lr(s)&&lr(a)){const g=s,y=a;if(g.length!==y.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const A=g.map((C,M)=>C>>y[M]);return new Se(A,n.typeInfo)}if(lr(s)){const g=a,y=s.map((A,C)=>A>>g);return new Se(y,n.typeInfo)}if(lr(a)){const g=s,y=a.map((A,C)=>g>>A);return new Se(y,i.typeInfo)}const o=s,u=a,f=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new Je(o>>u,f)}case">":if(lr(s)&&lr(a)){const o=s,u=a;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((g,y)=>g>u[y]?1:0);return new Se(f,n.typeInfo)}if(lr(s)){const o=a,u=s.map((f,g)=>f>o?1:0);return new Se(u,n.typeInfo)}if(lr(a)){const o=s,u=a.map((f,g)=>o>f?1:0);return new Se(u,i.typeInfo)}return new Je(s>a?1:0,this.getTypeInfo("bool"));case"<":if(lr(s)&&lr(a)){const o=s,u=a;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((g,y)=>g<u[y]?1:0);return new Se(f,n.typeInfo)}if(lr(s)){const o=a,u=s.map((f,g)=>f<o?1:0);return new Se(u,n.typeInfo)}if(lr(a)){const o=s,u=a.map((f,g)=>o<f?1:0);return new Se(u,i.typeInfo)}return new Je(s<a?1:0,this.getTypeInfo("bool"));case"==":if(lr(s)&&lr(a)){const o=s,u=a;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((g,y)=>g===u[y]?1:0);return new Se(f,n.typeInfo)}if(lr(s)){const o=a,u=s.map((f,g)=>f==o?1:0);return new Se(u,n.typeInfo)}if(lr(a)){const o=s,u=a.map((f,g)=>o==f?1:0);return new Se(u,i.typeInfo)}return new Je(s===a?1:0,this.getTypeInfo("bool"));case"!=":if(lr(s)&&lr(a)){const o=s,u=a;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((g,y)=>g!==u[y]?1:0);return new Se(f,n.typeInfo)}if(lr(s)){const o=a,u=s.map((f,g)=>f!==o?1:0);return new Se(u,n.typeInfo)}if(lr(a)){const o=s,u=a.map((f,g)=>o!==f?1:0);return new Se(u,i.typeInfo)}return new Je(s!==a?1:0,this.getTypeInfo("bool"));case">=":if(lr(s)&&lr(a)){const o=s,u=a;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((g,y)=>g>=u[y]?1:0);return new Se(f,n.typeInfo)}if(lr(s)){const o=a,u=s.map((f,g)=>f>=o?1:0);return new Se(u,n.typeInfo)}if(lr(a)){const o=s,u=a.map((f,g)=>o>=f?1:0);return new Se(u,i.typeInfo)}return new Je(s>=a?1:0,this.getTypeInfo("bool"));case"<=":if(lr(s)&&lr(a)){const o=s,u=a;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((g,y)=>g<=u[y]?1:0);return new Se(f,n.typeInfo)}if(lr(s)){const o=a,u=s.map((f,g)=>f<=o?1:0);return new Se(u,n.typeInfo)}if(lr(a)){const o=s,u=a.map((f,g)=>o<=f?1:0);return new Se(u,i.typeInfo)}return new Je(s<=a?1:0,this.getTypeInfo("bool"));case"&&":if(lr(s)&&lr(a)){const o=s,u=a;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((g,y)=>g&&u[y]?1:0);return new Se(f,n.typeInfo)}if(lr(s)){const o=a,u=s.map((f,g)=>f&&o?1:0);return new Se(u,n.typeInfo)}if(lr(a)){const o=s,u=a.map((f,g)=>o&&f?1:0);return new Se(u,i.typeInfo)}return new Je(s&&a?1:0,this.getTypeInfo("bool"));case"||":if(lr(s)&&lr(a)){const o=s,u=a;if(o.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=o.map((g,y)=>g||u[y]?1:0);return new Se(f,n.typeInfo)}if(lr(s)){const o=a,u=s.map((f,g)=>f||o?1:0);return new Se(u,n.typeInfo)}if(lr(a)){const o=s,u=a.map((f,g)=>o||f?1:0);return new Se(u,i.typeInfo)}return new Je(s||a?1:0,this.getTypeInfo("bool"))}return console.error(`Unknown operator ${e.operator}. Line ${e.line}`),null}_evalCall(e,t){if(e.cachedReturnValue!==null)return e.cachedReturnValue;const n=t.clone();n.currentFunctionName=e.name;const i=t.getFunction(e.name);if(!i)return e.isBuiltin?this._callBuiltinFunction(e,n):this.getTypeInfo(e.name)?this._evalCreate(e,t):(console.error(`Unknown function "${e.name}". Line ${e.line}`),null);for(let s=0;s<i.node.args.length;++s){const a=i.node.args[s],o=this.evalExpression(e.args[s],n);n.createVariable(a.name,o,a)}return this._execStatements(i.node.body,n)}_callBuiltinFunction(e,t){switch(e.name){case"all":return this.builtins.All(e,t);case"any":return this.builtins.Any(e,t);case"select":return this.builtins.Select(e,t);case"arrayLength":return this.builtins.ArrayLength(e,t);case"abs":return this.builtins.Abs(e,t);case"acos":return this.builtins.Acos(e,t);case"acosh":return this.builtins.Acosh(e,t);case"asin":return this.builtins.Asin(e,t);case"asinh":return this.builtins.Asinh(e,t);case"atan":return this.builtins.Atan(e,t);case"atanh":return this.builtins.Atanh(e,t);case"atan2":return this.builtins.Atan2(e,t);case"ceil":return this.builtins.Ceil(e,t);case"clamp":return this.builtins.Clamp(e,t);case"cos":return this.builtins.Cos(e,t);case"cosh":return this.builtins.Cosh(e,t);case"countLeadingZeros":return this.builtins.CountLeadingZeros(e,t);case"countOneBits":return this.builtins.CountOneBits(e,t);case"countTrailingZeros":return this.builtins.CountTrailingZeros(e,t);case"cross":return this.builtins.Cross(e,t);case"degrees":return this.builtins.Degrees(e,t);case"determinant":return this.builtins.Determinant(e,t);case"distance":return this.builtins.Distance(e,t);case"dot":return this.builtins.Dot(e,t);case"dot4U8Packed":return this.builtins.Dot4U8Packed(e,t);case"dot4I8Packed":return this.builtins.Dot4I8Packed(e,t);case"exp":return this.builtins.Exp(e,t);case"exp2":return this.builtins.Exp2(e,t);case"extractBits":return this.builtins.ExtractBits(e,t);case"faceForward":return this.builtins.FaceForward(e,t);case"firstLeadingBit":return this.builtins.FirstLeadingBit(e,t);case"firstTrailingBit":return this.builtins.FirstTrailingBit(e,t);case"floor":return this.builtins.Floor(e,t);case"fma":return this.builtins.Fma(e,t);case"fract":return this.builtins.Fract(e,t);case"frexp":return this.builtins.Frexp(e,t);case"insertBits":return this.builtins.InsertBits(e,t);case"inverseSqrt":return this.builtins.InverseSqrt(e,t);case"ldexp":return this.builtins.Ldexp(e,t);case"length":return this.builtins.Length(e,t);case"log":return this.builtins.Log(e,t);case"log2":return this.builtins.Log2(e,t);case"max":return this.builtins.Max(e,t);case"min":return this.builtins.Min(e,t);case"mix":return this.builtins.Mix(e,t);case"modf":return this.builtins.Modf(e,t);case"normalize":return this.builtins.Normalize(e,t);case"pow":return this.builtins.Pow(e,t);case"quantizeToF16":return this.builtins.QuantizeToF16(e,t);case"radians":return this.builtins.Radians(e,t);case"reflect":return this.builtins.Reflect(e,t);case"refract":return this.builtins.Refract(e,t);case"reverseBits":return this.builtins.ReverseBits(e,t);case"round":return this.builtins.Round(e,t);case"saturate":return this.builtins.Saturate(e,t);case"sign":return this.builtins.Sign(e,t);case"sin":return this.builtins.Sin(e,t);case"sinh":return this.builtins.Sinh(e,t);case"smoothstep":return this.builtins.SmoothStep(e,t);case"sqrt":return this.builtins.Sqrt(e,t);case"step":return this.builtins.Step(e,t);case"tan":return this.builtins.Tan(e,t);case"tanh":return this.builtins.Tanh(e,t);case"transpose":return this.builtins.Transpose(e,t);case"trunc":return this.builtins.Trunc(e,t);case"dpdx":return this.builtins.Dpdx(e,t);case"dpdxCoarse":return this.builtins.DpdxCoarse(e,t);case"dpdxFine":return this.builtins.DpdxFine(e,t);case"dpdy":return this.builtins.Dpdy(e,t);case"dpdyCoarse":return this.builtins.DpdyCoarse(e,t);case"dpdyFine":return this.builtins.DpdyFine(e,t);case"fwidth":return this.builtins.Fwidth(e,t);case"fwidthCoarse":return this.builtins.FwidthCoarse(e,t);case"fwidthFine":return this.builtins.FwidthFine(e,t);case"textureDimensions":return this.builtins.TextureDimensions(e,t);case"textureGather":return this.builtins.TextureGather(e,t);case"textureGatherCompare":return this.builtins.TextureGatherCompare(e,t);case"textureLoad":return this.builtins.TextureLoad(e,t);case"textureNumLayers":return this.builtins.TextureNumLayers(e,t);case"textureNumLevels":return this.builtins.TextureNumLevels(e,t);case"textureNumSamples":return this.builtins.TextureNumSamples(e,t);case"textureSample":return this.builtins.TextureSample(e,t);case"textureSampleBias":return this.builtins.TextureSampleBias(e,t);case"textureSampleCompare":return this.builtins.TextureSampleCompare(e,t);case"textureSampleCompareLevel":return this.builtins.TextureSampleCompareLevel(e,t);case"textureSampleGrad":return this.builtins.TextureSampleGrad(e,t);case"textureSampleLevel":return this.builtins.TextureSampleLevel(e,t);case"textureSampleBaseClampToEdge":return this.builtins.TextureSampleBaseClampToEdge(e,t);case"textureStore":return this.builtins.TextureStore(e,t);case"atomicLoad":return this.builtins.AtomicLoad(e,t);case"atomicStore":return this.builtins.AtomicStore(e,t);case"atomicAdd":return this.builtins.AtomicAdd(e,t);case"atomicSub":return this.builtins.AtomicSub(e,t);case"atomicMax":return this.builtins.AtomicMax(e,t);case"atomicMin":return this.builtins.AtomicMin(e,t);case"atomicAnd":return this.builtins.AtomicAnd(e,t);case"atomicOr":return this.builtins.AtomicOr(e,t);case"atomicXor":return this.builtins.AtomicXor(e,t);case"atomicExchange":return this.builtins.AtomicExchange(e,t);case"atomicCompareExchangeWeak":return this.builtins.AtomicCompareExchangeWeak(e,t);case"pack4x8snorm":return this.builtins.Pack4x8snorm(e,t);case"pack4x8unorm":return this.builtins.Pack4x8unorm(e,t);case"pack4xI8":return this.builtins.Pack4xI8(e,t);case"pack4xU8":return this.builtins.Pack4xU8(e,t);case"pack4x8Clamp":return this.builtins.Pack4x8Clamp(e,t);case"pack4xU8Clamp":return this.builtins.Pack4xU8Clamp(e,t);case"pack2x16snorm":return this.builtins.Pack2x16snorm(e,t);case"pack2x16unorm":return this.builtins.Pack2x16unorm(e,t);case"pack2x16float":return this.builtins.Pack2x16float(e,t);case"unpack4x8snorm":return this.builtins.Unpack4x8snorm(e,t);case"unpack4x8unorm":return this.builtins.Unpack4x8unorm(e,t);case"unpack4xI8":return this.builtins.Unpack4xI8(e,t);case"unpack4xU8":return this.builtins.Unpack4xU8(e,t);case"unpack2x16snorm":return this.builtins.Unpack2x16snorm(e,t);case"unpack2x16unorm":return this.builtins.Unpack2x16unorm(e,t);case"unpack2x16float":return this.builtins.Unpack2x16float(e,t);case"storageBarrier":return this.builtins.StorageBarrier(e,t);case"textureBarrier":return this.builtins.TextureBarrier(e,t);case"workgroupBarrier":return this.builtins.WorkgroupBarrier(e,t);case"workgroupUniformLoad":return this.builtins.WorkgroupUniformLoad(e,t);case"subgroupAdd":return this.builtins.SubgroupAdd(e,t);case"subgroupExclusiveAdd":return this.builtins.SubgroupExclusiveAdd(e,t);case"subgroupInclusiveAdd":return this.builtins.SubgroupInclusiveAdd(e,t);case"subgroupAll":return this.builtins.SubgroupAll(e,t);case"subgroupAnd":return this.builtins.SubgroupAnd(e,t);case"subgroupAny":return this.builtins.SubgroupAny(e,t);case"subgroupBallot":return this.builtins.SubgroupBallot(e,t);case"subgroupBroadcast":return this.builtins.SubgroupBroadcast(e,t);case"subgroupBroadcastFirst":return this.builtins.SubgroupBroadcastFirst(e,t);case"subgroupElect":return this.builtins.SubgroupElect(e,t);case"subgroupMax":return this.builtins.SubgroupMax(e,t);case"subgroupMin":return this.builtins.SubgroupMin(e,t);case"subgroupMul":return this.builtins.SubgroupMul(e,t);case"subgroupExclusiveMul":return this.builtins.SubgroupExclusiveMul(e,t);case"subgroupInclusiveMul":return this.builtins.SubgroupInclusiveMul(e,t);case"subgroupOr":return this.builtins.SubgroupOr(e,t);case"subgroupShuffle":return this.builtins.SubgroupShuffle(e,t);case"subgroupShuffleDown":return this.builtins.SubgroupShuffleDown(e,t);case"subgroupShuffleUp":return this.builtins.SubgroupShuffleUp(e,t);case"subgroupShuffleXor":return this.builtins.SubgroupShuffleXor(e,t);case"subgroupXor":return this.builtins.SubgroupXor(e,t);case"quadBroadcast":return this.builtins.QuadBroadcast(e,t);case"quadSwapDiagonal":return this.builtins.QuadSwapDiagonal(e,t);case"quadSwapX":return this.builtins.QuadSwapX(e,t);case"quadSwapY":return this.builtins.QuadSwapY(e,t)}const n=t.getFunction(e.name);if(n){const i=t.clone();for(let s=0;s<n.node.args.length;++s){const a=n.node.args[s],o=this.evalExpression(e.args[s],i);i.setVariable(a.name,o,a)}return this._execStatements(n.node.body,i)}return null}_callConstructorValue(e,t){if(!e.args||e.args.length===0)return new Je(0,this.getTypeInfo(e.type));const n=this.evalExpression(e.args[0],t);return n.typeInfo=this.getTypeInfo(e.type),n.getSubData(this,e.postfix,t).clone()}_callConstructorVec(e,t){const n=this.getTypeInfo(e.type),i=e.type.getTypeName(),s=PI[i];if(s===void 0)return console.error(`Invalid vec constructor ${i}. Line ${e.line}`),null;const a=[];if(e instanceof Is)if(e.isVector){const o=e.vectorValue;for(const u of o)a.push(u)}else a.push(e.scalarValue);else if(e.args)for(const o of e.args){const u=this.evalExpression(o,t);if(u instanceof Se){const f=u.data;for(let g=0;g<f.length;++g){let y=f[g];a.push(y)}}else if(u instanceof Je){let f=u.value;a.push(f)}}if(e.type instanceof Ye&&e.type.format===null&&(e.type.format=Ye.f32),a.length===0){const o=new Array(s).fill(0);return new Se(o,n).getSubData(this,e.postfix,t)}if(a.length===1)for(;a.length<s;)a.push(a[0]);return a.length<s?(console.error(`Invalid vec constructor. Line ${e.line}`),null):new Se(a.length>s?a.slice(0,s):a,n).getSubData(this,e.postfix,t)}_callConstructorMatrix(e,t){const n=this.getTypeInfo(e.type),i=e.type.getTypeName(),s=Oo[i];if(s===void 0)return console.error(`Invalid matrix constructor ${i}. Line ${e.line}`),null;const a=[];if(e instanceof Is)if(e.isVector){const o=e.vectorValue;for(const u of o)a.push(u)}else a.push(e.scalarValue);else if(e.args)for(const o of e.args){const u=this.evalExpression(o,t);u instanceof Se?a.push(...u.data):u instanceof Je?a.push(u.value):u instanceof Vr&&a.push(...u.data)}if(n instanceof dp&&n.format===null&&(n.format=this.getTypeInfo("f32")),a.length===0){const o=new Array(s[2]).fill(0);return new Vr(o,n).getSubData(this,e.postfix,t)}return a.length!==s[2]?(console.error(`Invalid matrix constructor. Line ${e.line}`),null):new Vr(a,n).getSubData(this,e.postfix,t)}};Cw._breakObj=new Xc(new gl("BREAK",null),null),Cw._continueObj=new Xc(new gl("CONTINUE",null),null),Cw._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);let Uge=class{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}},zge=class{constructor(){this._tokens=[],this._current=0,this._currentLine=1,this._deferArrayCountEval=[],this._currentLoop=[],this._context=new Uge,this._exec=new Cw,this._forwardTypeCount=0}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;const t=[];for(;!this._isAtEnd();){const n=this._global_decl_or_directive();if(!n)break;t.push(n)}if(this._deferArrayCountEval.length>0){for(const n of this._deferArrayCountEval){const i=n.arrayType,s=n.countNode;if(s instanceof La){const a=s.name,o=this._context.constants.get(a);if(o)try{const u=o.constEvaluate(this._exec);i.count=u}catch{}}}this._deferArrayCountEval.length=0}if(this._forwardTypeCount>0)for(const n of t)n.search(i=>{i instanceof R6||i instanceof Aw?i.type=this._forwardType(i.type):i instanceof Y0?i.format=this._forwardType(i.format):i instanceof Fu||i instanceof q0||i instanceof _w?i.type=this._forwardType(i.type):i instanceof $_?i.returnType=this._forwardType(i.returnType):i instanceof M6&&(i.type=this._forwardType(i.type))});return t}_forwardType(e){if(e instanceof B6){const t=this._getType(e.name);if(t)return t}else e instanceof Aw?e.type=this._forwardType(e.type):e instanceof Y0&&(e.format=this._forwardType(e.format));return e}_initialize(e){if(e)if(typeof e=="string"){const t=new Ege(e);this._tokens=t.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_updateNode(e,t){return e.line=t??this._currentLine,e}_error(e,t){return{token:e,message:t,toString:()=>`${t}`}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==be.eof}_match(e){if(e instanceof Xe)return!!this._check(e)&&(this._advance(),!0);for(let t=0,n=e.length;t<n;++t){const i=e[t];if(this._check(i))return this._advance(),!0}return!1}_consume(e,t){if(this._check(e))return this._advance();throw this._error(this._peek(),`${t}. Line:${this._currentLine}`)}_check(e){if(this._isAtEnd())return!1;const t=this._peek();if(e instanceof Array){const n=t.type;let i=!1;for(const s of e){if(n===s)return!0;s===be.tokens.name&&(i=!0)}if(i){const s=be.tokens.name.rule.exec(t.lexeme);if(s&&s.index==0&&s[0]==t.lexeme)return!0}return!1}if(t.type===e)return!0;if(e===be.tokens.name){const n=be.tokens.name.rule.exec(t.lexeme);return n&&n.index==0&&n[0]==t.lexeme}return!1}_advance(){var e,t;return this._currentLine=(t=(e=this._peek())===null||e===void 0?void 0:e.line)!==null&&t!==void 0?t:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(be.tokens.semicolon)&&!this._isAtEnd(););if(this._match(be.keywords.alias)){const t=this._type_alias();return this._consume(be.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([t]),t}if(this._match(be.keywords.diagnostic)){const t=this._diagnostic();return this._consume(be.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([t]),t}if(this._match(be.keywords.requires)){const t=this._requires_directive();return this._consume(be.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([t]),t}if(this._match(be.keywords.enable)){const t=this._enable_directive();return this._consume(be.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([t]),t}const e=this._attribute();if(this._check(be.keywords.var)){const t=this._global_variable_decl();return t!=null&&(t.attributes=e),this._consume(be.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(be.keywords.override)){const t=this._override_variable_decl();return t!=null&&(t.attributes=e),this._consume(be.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(be.keywords.let)){const t=this._global_let_decl();return t!=null&&(t.attributes=e),this._consume(be.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(be.keywords.const)){const t=this._global_const_decl();return t!=null&&(t.attributes=e),this._consume(be.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(be.keywords.struct)){const t=this._struct_decl();return t!=null&&(t.attributes=e),this._exec.reflection.updateAST([t]),t}if(this._check(be.keywords.fn)){const t=this._function_decl();return t!=null&&(t.attributes=e),this._exec.reflection.updateAST([t]),t}return null}_function_decl(){if(!this._match(be.keywords.fn))return null;const e=this._currentLine,t=this._consume(be.tokens.ident,"Expected function name.").toString();this._consume(be.tokens.paren_left,"Expected '(' for function arguments.");const n=[];if(!this._check(be.tokens.paren_right))do{if(this._check(be.tokens.paren_right))break;const o=this._attribute(),u=this._consume(be.tokens.name,"Expected argument name.").toString();this._consume(be.tokens.colon,"Expected ':' for argument type.");const f=this._attribute(),g=this._type_decl();g!=null&&(g.attributes=f,n.push(this._updateNode(new M6(u,g,o))))}while(this._match(be.tokens.comma));this._consume(be.tokens.paren_right,"Expected ')' after function arguments.");let i=null;if(this._match(be.tokens.arrow)){const o=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=o)}const s=this._compound_statement(),a=this._currentLine;return this._updateNode(new $_(t,n,i,s,e,a),e)}_compound_statement(){const e=[];for(this._consume(be.tokens.brace_left,"Expected '{' for block.");!this._check(be.tokens.brace_right);){const t=this._statement();t!==null&&e.push(t)}return this._consume(be.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(be.tokens.semicolon)&&!this._isAtEnd(););if(this._check(be.tokens.attr)&&this._attribute(),this._check(be.keywords.if))return this._if_statement();if(this._check(be.keywords.switch))return this._switch_statement();if(this._check(be.keywords.loop))return this._loop_statement();if(this._check(be.keywords.for))return this._for_statement();if(this._check(be.keywords.while))return this._while_statement();if(this._check(be.keywords.continuing))return this._continuing_statement();if(this._check(be.keywords.static_assert))return this._static_assert_statement();if(this._check(be.tokens.brace_left))return this._compound_statement();let e=null;if(this._check(be.keywords.return))e=this._return_statement();else if(this._check([be.keywords.var,be.keywords.let,be.keywords.const]))e=this._variable_statement();else if(this._match(be.keywords.discard))e=this._updateNode(new Cge);else if(this._match(be.keywords.break)){const t=this._updateNode(new FW);if(this._currentLoop.length>0){const n=this._currentLoop[this._currentLoop.length-1];t.loopId=n.id}e=t,this._check(be.keywords.if)&&(this._advance(),t.condition=this._optional_paren_expression())}else if(this._match(be.keywords.continue)){const t=this._updateNode(new UW);if(!(this._currentLoop.length>0))throw this._error(this._peek(),`Continue statement must be inside a loop. Line: ${t.line}`);{const n=this._currentLoop[this._currentLoop.length-1];t.loopId=n.id}e=t}else e=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement();return e!=null&&this._consume(be.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(be.keywords.static_assert))return null;const e=this._currentLine,t=this._optional_paren_expression();return this._updateNode(new Age(t),e)}_while_statement(){if(!this._match(be.keywords.while))return null;const e=this._updateNode(new PW(null,null));return this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(be.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_continuing_statement(){const e=this._currentLoop.length>0?this._currentLoop[this._currentLoop.length-1].id:-1;if(!this._match(be.keywords.continuing))return null;const t=this._currentLine,n=this._compound_statement();return this._updateNode(new oB(n,e),t)}_for_statement(){if(!this._match(be.keywords.for))return null;this._consume(be.tokens.paren_left,"Expected '('.");const e=this._updateNode(new BW(null,null,null,null));return this._currentLoop.push(e),e.init=this._check(be.tokens.semicolon)?null:this._for_init(),this._consume(be.tokens.semicolon,"Expected ';'."),e.condition=this._check(be.tokens.semicolon)?null:this._short_circuit_or_expression(),this._consume(be.tokens.semicolon,"Expected ';'."),e.increment=this._check(be.tokens.paren_right)?null:this._for_increment(),this._consume(be.tokens.paren_right,"Expected ')'."),this._check(be.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(be.keywords.var)){const e=this._variable_decl();if(e===null)throw this._error(this._peek(),"Variable declaration expected.");let t=null;return this._match(be.tokens.equal)&&(t=this._short_circuit_or_expression()),this._updateNode(new Fu(e.name,e.type,e.storage,e.access,t),e.line)}if(this._match(be.keywords.let)){const e=this._currentLine,t=this._consume(be.tokens.name,"Expected name for let.").toString();let n=null;if(this._match(be.tokens.colon)){const s=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=s)}this._consume(be.tokens.equal,"Expected '=' for let.");const i=this._short_circuit_or_expression();return this._updateNode(new q0(t,n,null,null,i),e)}if(this._match(be.keywords.const)){const e=this._currentLine,t=this._consume(be.tokens.name,"Expected name for const.").toString();let n=null;if(this._match(be.tokens.colon)){const s=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=s)}this._consume(be.tokens.equal,"Expected '=' for const.");const i=this._short_circuit_or_expression();return n===null&&i instanceof Is&&(n=i.type),this._updateNode(new _w(t,n,null,null,i),e)}return null}_increment_decrement_statement(){const e=this._current,t=this._unary_expression();if(t==null)return null;if(!this._check(be.increment_operators))return this._current=e,null;const n=this._consume(be.increment_operators,"Expected increment operator");return this._updateNode(new MW(n.type===be.tokens.plus_plus?pm.increment:pm.decrement,t))}_assignment_statement(){let e=null;const t=this._currentLine;if(this._check(be.tokens.brace_right))return null;let n=this._match(be.tokens.underscore);if(n||(e=this._unary_expression()),!n&&e==null)return null;const i=this._consume(be.assignment_operators,"Expected assignment operator."),s=this._short_circuit_or_expression();return this._updateNode(new RW(C0.parse(i.lexeme),e,s),t)}_func_call_statement(){if(!this._check(be.tokens.ident))return null;const e=this._currentLine,t=this._current,n=this._consume(be.tokens.ident,"Expected function name."),i=this._argument_expression_list();return i===null?(this._current=t,null):this._updateNode(new tO(n.lexeme,i),e)}_loop_statement(){if(!this._match(be.keywords.loop))return null;this._check(be.tokens.attr)&&this._attribute(),this._consume(be.tokens.brace_left,"Expected '{' for loop.");const e=this._updateNode(new kW([],null));this._currentLoop.push(e);let t=this._statement();for(;t!==null;){if(Array.isArray(t))for(let n of t)e.body.push(n);else e.body.push(t);if(t instanceof oB){e.continuing=t;break}t=this._statement()}return this._currentLoop.pop(),this._consume(be.tokens.brace_right,"Expected '}' for loop."),e}_switch_statement(){if(!this._match(be.keywords.switch))return null;const e=this._updateNode(new OW(null,[]));if(this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(be.tokens.attr)&&this._attribute(),this._consume(be.tokens.brace_left,"Expected '{' for switch."),e.cases=this._switch_body(),e.cases==null||e.cases.length==0)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(be.tokens.brace_right,"Expected '}' for switch."),this._currentLoop.pop(),e}_switch_body(){const e=[];let t=!1;for(;this._check([be.keywords.default,be.keywords.case]);){if(this._match(be.keywords.case)){const n=this._case_selectors();for(const s of n)if(s instanceof xw){if(t)throw this._error(this._previous(),"Multiple default cases in switch statement.");t=!0;break}this._match(be.tokens.colon),this._check(be.tokens.attr)&&this._attribute(),this._consume(be.tokens.brace_left,"Exected '{' for switch case.");const i=this._case_body();this._consume(be.tokens.brace_right,"Exected '}' for switch case."),e.push(this._updateNode(new GW(n,i)))}if(this._match(be.keywords.default)){if(t)throw this._error(this._previous(),"Multiple default cases in switch statement.");this._match(be.tokens.colon),this._check(be.tokens.attr)&&this._attribute(),this._consume(be.tokens.brace_left,"Exected '{' for switch default.");const n=this._case_body();this._consume(be.tokens.brace_right,"Exected '}' for switch default."),e.push(this._updateNode(new HW(n)))}}return e}_case_selectors(){const e=[];for(this._match(be.keywords.default)?e.push(this._updateNode(new xw)):e.push(this._shift_expression());this._match(be.tokens.comma);)this._match(be.keywords.default)?e.push(this._updateNode(new xw)):e.push(this._shift_expression());return e}_case_body(){if(this._match(be.keywords.fallthrough))return this._consume(be.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(e==null)return[];e instanceof Array||(e=[e]);const t=this._case_body();return t.length==0?e:[...e,t[0]]}_if_statement(){if(!this._match(be.keywords.if))return null;const e=this._currentLine,t=this._optional_paren_expression();this._check(be.tokens.attr)&&this._attribute();const n=this._compound_statement();let i=[];this._match_elseif()&&(this._check(be.tokens.attr)&&this._attribute(),i=this._elseif_statement(i));let s=null;return this._match(be.keywords.else)&&(this._check(be.tokens.attr)&&this._attribute(),s=this._compound_statement()),this._updateNode(new DW(t,n,i,s),e)}_match_elseif(){return this._tokens[this._current].type===be.keywords.else&&this._tokens[this._current+1].type===be.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(e=[]){const t=this._optional_paren_expression(),n=this._compound_statement();return e.push(this._updateNode(new Tge(t,n))),this._match_elseif()&&(this._check(be.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(be.keywords.return))return null;const e=this._short_circuit_or_expression();return this._updateNode(new LW(e))}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(be.tokens.or_or);)e=this._updateNode(new Fl(this._previous().toString(),e,this._short_circuit_and_expr()));return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(be.tokens.and_and);)e=this._updateNode(new Fl(this._previous().toString(),e,this._inclusive_or_expression()));return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(be.tokens.or);)e=this._updateNode(new Fl(this._previous().toString(),e,this._exclusive_or_expression()));return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(be.tokens.xor);)e=this._updateNode(new Fl(this._previous().toString(),e,this._and_expression()));return e}_and_expression(){let e=this._equality_expression();for(;this._match(be.tokens.and);)e=this._updateNode(new Fl(this._previous().toString(),e,this._equality_expression()));return e}_equality_expression(){const e=this._relational_expression();return this._match([be.tokens.equal_equal,be.tokens.not_equal])?this._updateNode(new Fl(this._previous().toString(),e,this._relational_expression())):e}_relational_expression(){let e=this._shift_expression();for(;this._match([be.tokens.less_than,be.tokens.greater_than,be.tokens.less_than_equal,be.tokens.greater_than_equal]);)e=this._updateNode(new Fl(this._previous().toString(),e,this._shift_expression()));return e}_shift_expression(){let e=this._additive_expression();for(;this._match([be.tokens.shift_left,be.tokens.shift_right]);)e=this._updateNode(new Fl(this._previous().toString(),e,this._additive_expression()));return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([be.tokens.plus,be.tokens.minus]);)e=this._updateNode(new Fl(this._previous().toString(),e,this._multiplicative_expression()));return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([be.tokens.star,be.tokens.forward_slash,be.tokens.modulo]);)e=this._updateNode(new Fl(this._previous().toString(),e,this._unary_expression()));return e}_unary_expression(){return this._match([be.tokens.minus,be.tokens.bang,be.tokens.tilde,be.tokens.star,be.tokens.and])?this._updateNode(new ms(this._previous().toString(),this._unary_expression())):this._singular_expression()}_singular_expression(){const e=this._primary_expression(),t=this._postfix_expression();return t&&(e.postfix=t),e}_postfix_expression(){if(this._match(be.tokens.bracket_left)){const e=this._short_circuit_or_expression();this._consume(be.tokens.bracket_right,"Expected ']'.");const t=this._updateNode(new ty(e)),n=this._postfix_expression();return n&&(t.postfix=n),t}if(this._match(be.tokens.period)){const e=this._consume(be.tokens.name,"Expected member name."),t=this._postfix_expression(),n=this._updateNode(new fp(e.lexeme));return t&&(n.postfix=t),n}return null}_getStruct(e){return this._context.aliases.has(e)?this._context.aliases.get(e).type:this._context.structs.has(e)?this._context.structs.get(e):null}_getType(e){const t=this._getStruct(e);if(t!==null)return t;switch(e){case"void":return Mt.void;case"bool":return Mt.bool;case"i32":return Mt.i32;case"u32":return Mt.u32;case"f32":return Mt.f32;case"f16":return Mt.f16;case"vec2f":return Ye.vec2f;case"vec3f":return Ye.vec3f;case"vec4f":return Ye.vec4f;case"vec2i":return Ye.vec2i;case"vec3i":return Ye.vec3i;case"vec4i":return Ye.vec4i;case"vec2u":return Ye.vec2u;case"vec3u":return Ye.vec3u;case"vec4u":return Ye.vec4u;case"vec2h":return Ye.vec2h;case"vec3h":return Ye.vec3h;case"vec4h":return Ye.vec4h;case"mat2x2f":return Ye.mat2x2f;case"mat2x3f":return Ye.mat2x3f;case"mat2x4f":return Ye.mat2x4f;case"mat3x2f":return Ye.mat3x2f;case"mat3x3f":return Ye.mat3x3f;case"mat3x4f":return Ye.mat3x4f;case"mat4x2f":return Ye.mat4x2f;case"mat4x3f":return Ye.mat4x3f;case"mat4x4f":return Ye.mat4x4f;case"mat2x2h":return Ye.mat2x2h;case"mat2x3h":return Ye.mat2x3h;case"mat2x4h":return Ye.mat2x4h;case"mat3x2h":return Ye.mat3x2h;case"mat3x3h":return Ye.mat3x3h;case"mat3x4h":return Ye.mat3x4h;case"mat4x2h":return Ye.mat4x2h;case"mat4x3h":return Ye.mat4x3h;case"mat4x4h":return Ye.mat4x4h;case"mat2x2i":return Ye.mat2x2i;case"mat2x3i":return Ye.mat2x3i;case"mat2x4i":return Ye.mat2x4i;case"mat3x2i":return Ye.mat3x2i;case"mat3x3i":return Ye.mat3x3i;case"mat3x4i":return Ye.mat3x4i;case"mat4x2i":return Ye.mat4x2i;case"mat4x3i":return Ye.mat4x3i;case"mat4x4i":return Ye.mat4x4i;case"mat2x2u":return Ye.mat2x2u;case"mat2x3u":return Ye.mat2x3u;case"mat2x4u":return Ye.mat2x4u;case"mat3x2u":return Ye.mat3x2u;case"mat3x3u":return Ye.mat3x3u;case"mat3x4u":return Ye.mat3x4u;case"mat4x2u":return Ye.mat4x2u;case"mat4x3u":return Ye.mat4x3u;case"mat4x4u":return Ye.mat4x4u}return null}_validateTypeRange(e,t){if(t.name==="i32"){if(e<-2147483648||e>2147483647)throw this._error(this._previous(),`Value out of range for i32: ${e}. Line: ${this._currentLine}.`)}else if(t.name==="u32"&&(e<0||e>4294967295))throw this._error(this._previous(),`Value out of range for u32: ${e}. Line: ${this._currentLine}.`)}_primary_expression(){if(this._match(be.tokens.ident)){const n=this._previous().toString();if(this._check(be.tokens.paren_left)){const i=this._argument_expression_list(),s=this._getType(n);return s!==null?this._updateNode(new kc(s,i)):this._updateNode(new nO(n,i))}if(this._context.constants.has(n)){const i=this._context.constants.get(n);return this._updateNode(new zW(n,i.value))}return this._updateNode(new La(n))}if(this._match(be.tokens.int_literal)){const n=this._previous().toString();let i=n.endsWith("i")||n.endsWith("i")?Mt.i32:n.endsWith("u")||n.endsWith("U")?Mt.u32:Mt.x32;const s=parseInt(n);return this._validateTypeRange(s,i),this._updateNode(new Is(new Je(s,this._exec.getTypeInfo(i)),i))}if(this._match(be.tokens.uint_literal)){const n=parseInt(this._previous().toString());return this._validateTypeRange(n,Mt.u32),this._updateNode(new Is(new Je(n,this._exec.getTypeInfo(Mt.u32)),Mt.u32))}if(this._match([be.tokens.decimal_float_literal,be.tokens.hex_float_literal])){let n=this._previous().toString(),i=n.endsWith("h");i&&(n=n.substring(0,n.length-1));const s=parseFloat(n);this._validateTypeRange(s,i?Mt.f16:Mt.f32);const a=i?Mt.f16:Mt.f32;return this._updateNode(new Is(new Je(s,this._exec.getTypeInfo(a)),a))}if(this._match([be.keywords.true,be.keywords.false])){let n=this._previous().toString()===be.keywords.true.rule;return this._updateNode(new Is(new Je(n?1:0,this._exec.getTypeInfo(Mt.bool)),Mt.bool))}if(this._check(be.tokens.paren_left))return this._paren_expression();if(this._match(be.keywords.bitcast)){this._consume(be.tokens.less_than,"Expected '<'.");const n=this._type_decl();this._consume(be.tokens.greater_than,"Expected '>'.");const i=this._paren_expression();return this._updateNode(new VW(n,i))}const e=this._type_decl(),t=this._argument_expression_list();return this._updateNode(new kc(e,t))}_argument_expression_list(){if(!this._match(be.tokens.paren_left))return null;const e=[];do{if(this._check(be.tokens.paren_right))break;const t=this._short_circuit_or_expression();e.push(t)}while(this._match(be.tokens.comma));return this._consume(be.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(be.tokens.paren_left);const e=this._short_circuit_or_expression();return this._match(be.tokens.paren_right),e}_paren_expression(){this._consume(be.tokens.paren_left,"Expected '('.");const e=this._short_circuit_or_expression();return this._consume(be.tokens.paren_right,"Expected ')'."),e}_struct_decl(){if(!this._match(be.keywords.struct))return null;const e=this._currentLine,t=this._consume(be.tokens.ident,"Expected name for struct.").toString();this._consume(be.tokens.brace_left,"Expected '{' for struct body.");const n=[];for(;!this._check(be.tokens.brace_right);){const a=this._attribute(),o=this._consume(be.tokens.name,"Expected variable name.").toString();this._consume(be.tokens.colon,"Expected ':' for struct member type.");const u=this._attribute(),f=this._type_decl();f!=null&&(f.attributes=u),this._check(be.tokens.brace_right)?this._match(be.tokens.comma):this._consume(be.tokens.comma,"Expected ',' for struct member."),n.push(this._updateNode(new R6(o,f,a)))}this._consume(be.tokens.brace_right,"Expected '}' after struct body.");const i=this._currentLine,s=this._updateNode(new Ou(t,n,e,i),e);return this._context.structs.set(t,s),s}_global_variable_decl(){const e=this._variable_decl();if(!e)return null;if(this._match(be.tokens.equal)){const t=this._const_expression();e.value=t}if(e.type!==null&&e.value instanceof Is){if(e.value.type.name!=="x32"&&e.type.getTypeName()!==e.value.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${e.value.type.name} to ${e.type.name}. Line:${this._currentLine}`);e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type),e.value.type=e.type}else e.type===null&&e.value instanceof Is&&(e.type=e.value.type.name==="x32"?Mt.i32:e.value.type,e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type));return e}_override_variable_decl(){const e=this._override_decl();return e&&this._match(be.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){var e;if(!this._match(be.keywords.const))return null;const t=this._consume(be.tokens.name,"Expected variable name"),n=this._currentLine;let i=null;if(this._match(be.tokens.colon)){const u=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=u)}let s=null;this._consume(be.tokens.equal,"const declarations require an assignment");const a=this._short_circuit_or_expression();try{let u=[Mt.f32],f=a.constEvaluate(this._exec,u);f instanceof Je&&this._validateTypeRange(f.value,u[0]),u[0]instanceof Ye&&u[0].format===null&&f.typeInfo instanceof dp&&f.typeInfo.format!==null&&(f.typeInfo.format.name==="f16"?u[0].format=Mt.f16:f.typeInfo.format.name==="f32"?u[0].format=Mt.f32:f.typeInfo.format.name==="i32"?u[0].format=Mt.i32:f.typeInfo.format.name==="u32"?u[0].format=Mt.u32:f.typeInfo.format.name==="bool"?u[0].format=Mt.bool:console.error(`TODO: impelement template format type ${f.typeInfo.format.name}`)),s=this._updateNode(new Is(f,u[0])),this._exec.context.setVariable(t.toString(),f)}catch{s=a}if(i!==null&&s instanceof Is){if(s.type.name!=="x32"&&i.getTypeName()!==s.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${s.type.name} to ${i.name}. Line:${this._currentLine}`);s.type=i,s.isScalar&&this._validateTypeRange(s.scalarValue,s.type)}else i===null&&s instanceof Is&&(i=(e=s?.type)!==null&&e!==void 0?e:Mt.f32,i===Mt.x32&&(i=Mt.i32));const o=this._updateNode(new _w(t.toString(),i,"","",s),n);return this._context.constants.set(o.name,o),o}_global_let_decl(){if(!this._match(be.keywords.let))return null;const e=this._currentLine,t=this._consume(be.tokens.name,"Expected variable name");let n=null;if(this._match(be.tokens.colon)){const s=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=s)}let i=null;if(this._match(be.tokens.equal)&&(i=this._const_expression()),n!==null&&i instanceof Is){if(i.type.name!=="x32"&&n.getTypeName()!==i.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${i.type.name} to ${n.name}. Line:${this._currentLine}`);i.type=n}else n===null&&i instanceof Is&&(n=i.type.name==="x32"?Mt.i32:i.type);return i instanceof Is&&i.isScalar&&this._validateTypeRange(i.scalarValue,n),this._updateNode(new q0(t.toString(),n,"","",i),e)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(be.keywords.var))return null;const e=this._currentLine;let t="",n="";this._match(be.tokens.less_than)&&(t=this._consume(be.storage_class,"Expected storage_class.").toString(),this._match(be.tokens.comma)&&(n=this._consume(be.access_mode,"Expected access_mode.").toString()),this._consume(be.tokens.greater_than,"Expected '>'."));const i=this._consume(be.tokens.name,"Expected variable name");let s=null;if(this._match(be.tokens.colon)){const a=this._attribute();s=this._type_decl(),s!=null&&(s.attributes=a)}return this._updateNode(new Fu(i.toString(),s,t,n,null),e)}_override_decl(){if(!this._match(be.keywords.override))return null;const e=this._consume(be.tokens.name,"Expected variable name");let t=null;if(this._match(be.tokens.colon)){const n=this._attribute();t=this._type_decl(),t!=null&&(t.attributes=n)}return this._updateNode(new eO(e.toString(),t,null))}_diagnostic(){this._consume(be.tokens.paren_left,"Expected '('");const e=this._consume(be.tokens.ident,"Expected severity control name.");this._consume(be.tokens.comma,"Expected ','");let t=this._consume(be.tokens.ident,"Expected diagnostic rule name.").toString();return this._match(be.tokens.period)&&(t+=`.${this._consume(be.tokens.ident,"Expected diagnostic message.").toString()}`),this._consume(be.tokens.paren_right,"Expected ')'"),this._updateNode(new NW(e.toString(),t))}_enable_directive(){const e=this._consume(be.tokens.ident,"identity expected.");return this._updateNode(new xge(e.toString()))}_requires_directive(){const e=[this._consume(be.tokens.ident,"identity expected.").toString()];for(;this._match(be.tokens.comma);){const t=this._consume(be.tokens.ident,"identity expected.");e.push(t.toString())}return this._updateNode(new wge(e))}_type_alias(){const e=this._consume(be.tokens.ident,"identity expected.");this._consume(be.tokens.equal,"Expected '=' for type alias.");let t=this._type_decl();if(t===null)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(t.name)&&(t=this._context.aliases.get(t.name).type);const n=this._updateNode(new rO(e.toString(),t));return this._context.aliases.set(n.name,n),n}_type_decl(){if(this._check([be.tokens.ident,...be.texel_format,be.keywords.bool,be.keywords.f32,be.keywords.i32,be.keywords.u32])){const n=this._advance().toString();if(this._context.structs.has(n))return this._context.structs.get(n);if(this._context.aliases.has(n))return this._context.aliases.get(n).type;if(!this._getType(n)){const i=this._updateNode(new B6(n));return this._forwardTypeCount++,i}return this._updateNode(new Mt(n))}let e=this._texture_sampler_types();if(e)return e;if(this._check(be.template_types)){let n=this._advance().toString(),i=null,s=null;return this._match(be.tokens.less_than)&&(i=this._type_decl(),s=null,this._match(be.tokens.comma)&&(s=this._consume(be.access_mode,"Expected access_mode for pointer").toString()),this._consume(be.tokens.greater_than,"Expected '>' for type.")),this._updateNode(new Ye(n,i,s))}if(this._match(be.keywords.ptr)){let n=this._previous().toString();this._consume(be.tokens.less_than,"Expected '<' for pointer.");const i=this._consume(be.storage_class,"Expected storage_class for pointer");this._consume(be.tokens.comma,"Expected ',' for pointer.");const s=this._type_decl();let a=null;return this._match(be.tokens.comma)&&(a=this._consume(be.access_mode,"Expected access_mode for pointer").toString()),this._consume(be.tokens.greater_than,"Expected '>' for pointer."),this._updateNode(new Aw(n,i.toString(),s,a))}const t=this._attribute();if(this._match(be.keywords.array)){let n=null,i=-1;const s=this._previous();let a=null;if(this._match(be.tokens.less_than)){n=this._type_decl(),this._context.aliases.has(n.name)&&(n=this._context.aliases.get(n.name).type);let u="";if(this._match(be.tokens.comma)){a=this._shift_expression();try{u=a.constEvaluate(this._exec).toString(),a=null}catch{u="1"}}this._consume(be.tokens.greater_than,"Expected '>' for array."),i=u?parseInt(u):0}const o=this._updateNode(new Y0(s.toString(),t,n,i));return a&&this._deferArrayCountEval.push({arrayType:o,countNode:a}),o}return null}_texture_sampler_types(){if(this._match(be.sampler_type))return this._updateNode(new T0(this._previous().toString(),null,null));if(this._match(be.depth_texture_type))return this._updateNode(new T0(this._previous().toString(),null,null));if(this._match(be.sampled_texture_type)||this._match(be.multisampled_texture_type)){const e=this._previous();this._consume(be.tokens.less_than,"Expected '<' for sampler type.");const t=this._type_decl();return this._consume(be.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new T0(e.toString(),t,null))}if(this._match(be.storage_texture_type)){const e=this._previous();this._consume(be.tokens.less_than,"Expected '<' for sampler type.");const t=this._consume(be.texel_format,"Invalid texel format.").toString();this._consume(be.tokens.comma,"Expected ',' after texel format.");const n=this._consume(be.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(be.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new T0(e.toString(),t,n))}return null}_attribute(){let e=[];for(;this._match(be.tokens.attr);){const t=this._consume(be.attribute_name,"Expected attribute name"),n=this._updateNode(new WW(t.toString(),null));if(this._match(be.tokens.paren_left)){if(n.value=this._consume(be.literal_or_ident,"Expected attribute value").toString(),this._check(be.tokens.comma)){this._advance();do{const i=this._consume(be.literal_or_ident,"Expected attribute value").toString();n.value instanceof Array||(n.value=[n.value]),n.value.push(i)}while(this._match(be.tokens.comma))}this._consume(be.tokens.paren_right,"Expected ')'")}e.push(n)}return e.length==0?null:e}},Vge=class extends Z0{constructor(e){super(),e&&this.update(e)}update(e){const t=new zge().parse(e);this.updateAST(t)}};function $ge(r){const e={attributes:[],bindings:[]};let t;try{t=jge(r)}catch(s){return Bt.error(s.message)(),e}for(const s of t.uniforms){const a=[];for(const o of s.type?.members||[])a.push({name:o.name,type:D6(o.type)});e.bindings.push({type:"uniform",name:s.name,group:s.group,location:s.binding,members:a})}for(const s of t.textures)e.bindings.push({type:"texture",name:s.name,group:s.group,location:s.binding});for(const s of t.samplers)e.bindings.push({type:"sampler",name:s.name,group:s.group,location:s.binding});const n=t.entry.vertex[0],i=n?.inputs.length||0;for(let s=0;s<i;s++){const a=n.inputs[s];if(a.locationType==="location"){const o=D6(a.type);e.attributes.push({name:a.name,location:Number(a.location),type:o})}}return e}function D6(r){return r?.format?`${r.name}<${r.format.name}>`:r.name}function jge(r){try{return new Vge(r)}catch(e){if(e instanceof Error)throw e;let t="WGSL parse error";throw typeof e=="object"&&e?.message&&(t+=`: ${e.message} `),typeof e=="object"&&e?.token&&(t+=e.token.line||""),new Error(t,{cause:e})}}const Gge=1/Math.PI*180,Hge=1/180*Math.PI,Wge={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...Wge}};const Bs=globalThis.mathgl.config;function Kge(r,{precision:e=Bs.precision}={}){return r=Yge(r),`${parseFloat(r.toPrecision(e))}`}function Ad(r){return Array.isArray(r)||ArrayBuffer.isView(r)&&!(r instanceof DataView)}function Xge(r){return qge(r)}function Jge(r){return zl(r)}function qge(r,e){return oO(r,t=>t*Hge,e)}function zl(r,e){return oO(r,t=>t*Gge,e)}function Xl(r,e,t){return oO(r,n=>Math.max(e,Math.min(t,n)))}function Hu(r,e,t){return Ad(r)?r.map((n,i)=>Hu(n,e[i],t)):t*e+(1-t)*r}function ml(r,e,t){const n=Bs.EPSILON;t&&(Bs.EPSILON=t);try{if(r===e)return!0;if(Ad(r)&&Ad(e)){if(r.length!==e.length)return!1;for(let i=0;i<r.length;++i)if(!ml(r[i],e[i]))return!1;return!0}return r&&r.equals?r.equals(e):e&&e.equals?e.equals(r):typeof r=="number"&&typeof e=="number"?Math.abs(r-e)<=Bs.EPSILON*Math.max(1,Math.abs(r),Math.abs(e)):!1}finally{Bs.EPSILON=n}}function Yge(r){return Math.round(r/Bs.EPSILON)*Bs.EPSILON}function Zge(r){return r.clone?r.clone():new Array(r.length)}function oO(r,e,t){if(Ad(r)){const n=r;t=t||Zge(n);for(let i=0;i<t.length&&i<n.length;++i){const s=typeof r=="number"?r:r[i];t[i]=e(s,i,t)}return t}return e(r)}class aO extends Array{clone(){return new this.constructor().copy(this)}fromArray(e,t=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=e[n+t];return this.check()}toArray(e=[],t=0){for(let n=0;n<this.ELEMENTS;++n)e[t+n]=this[n];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:Ad(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Bs)}formatString(e){let t="";for(let n=0;n<this.ELEMENTS;++n)t+=(n>0?", ":"")+Kge(this[n],e);return`${e.printTypes?this.constructor.name:""}[${t}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!ml(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,n){if(n===void 0)return this.lerp(this,e,t);for(let i=0;i<this.ELEMENTS;++i){const s=e[i],a=typeof t=="number"?t:t[i];this[i]=s+n*(a-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e[n]),t[n]);return this.check()}add(...e){for(const t of e)for(let n=0;n<this.ELEMENTS;++n)this[n]+=t[n];return this.check()}subtract(...e){for(const t of e)for(let n=0;n<this.ELEMENTS;++n)this[n]-=t[n];return this.check()}scale(e){if(typeof e=="number")for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;else for(let t=0;t<this.ELEMENTS&&t<e.length;++t)this[t]*=e[t];return this.check()}multiplyByScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}check(){if(Bs.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e),t);return this.check()}get elements(){return this}}function Qge(r,e){if(r.length!==e)return!1;for(let t=0;t<r.length;++t)if(!Number.isFinite(r[t]))return!1;return!0}function Ln(r){if(!Number.isFinite(r))throw new Error(`Invalid number ${JSON.stringify(r)}`);return r}function Q0(r,e,t=""){if(Bs.debug&&!Qge(r,e))throw new Error(`math.gl: ${t} some fields set to invalid numbers'`);return r}function Hl(r,e){if(!r)throw new Error(`math.gl assertion ${e}`)}class lO extends aO{get x(){return this[0]}set x(e){this[0]=Ln(e)}get y(){return this[1]}set y(e){this[1]=Ln(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let n=0;n<this.ELEMENTS;++n){const i=this[n]-e[n];t+=i*i}return Ln(t)}dot(e){let t=0;for(let n=0;n<this.ELEMENTS;++n)t+=this[n]*e[n];return Ln(t)}normalize(){const e=this.magnitude();if(e!==0)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let n=0;n<this.ELEMENTS;++n)this[n]*=t[n];return this.check()}divide(...e){for(const t of e)for(let n=0;n<this.ELEMENTS;++n)this[n]/=t[n];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Hl(e>=0&&e<this.ELEMENTS,"index is out of range"),Ln(this[e])}setComponent(e,t){return Hl(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}const e_=1e-6;let rc=typeof Float32Array<"u"?Float32Array:Array;function eme(){const r=new rc(2);return rc!=Float32Array&&(r[0]=0,r[1]=0),r}function L6(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r}function tme(r,e){return r[0]=-e[0],r[1]=-e[1],r}function qW(r,e,t,n){const i=e[0],s=e[1];return r[0]=i+n*(t[0]-i),r[1]=s+n*(t[1]-s),r}function rme(r,e,t){const n=e[0],i=e[1];return r[0]=t[0]*n+t[2]*i,r[1]=t[1]*n+t[3]*i,r}function nme(r,e,t){const n=e[0],i=e[1];return r[0]=t[0]*n+t[2]*i+t[4],r[1]=t[1]*n+t[3]*i+t[5],r}function YW(r,e,t){const n=e[0],i=e[1];return r[0]=t[0]*n+t[3]*i+t[6],r[1]=t[1]*n+t[4]*i+t[7],r}function ZW(r,e,t){const n=e[0],i=e[1];return r[0]=t[0]*n+t[4]*i+t[12],r[1]=t[1]*n+t[5]*i+t[13],r}(function(){const r=eme();return function(e,t,n,i,s,a){let o,u;for(t||(t=2),n||(n=0),i?u=Math.min(i*t+n,e.length):u=e.length,o=n;o<u;o+=t)r[0]=e[o],r[1]=e[o+1],s(r,r,a),e[o]=r[0],e[o+1]=r[1];return e}})();function QW(r,e,t){const n=e[0],i=e[1],s=t[3]*n+t[7]*i||1;return r[0]=(t[0]*n+t[4]*i)/s,r[1]=(t[1]*n+t[5]*i)/s,r}function eK(r,e,t){const n=e[0],i=e[1],s=e[2],a=t[3]*n+t[7]*i+t[11]*s||1;return r[0]=(t[0]*n+t[4]*i+t[8]*s)/a,r[1]=(t[1]*n+t[5]*i+t[9]*s)/a,r[2]=(t[2]*n+t[6]*i+t[10]*s)/a,r}function ime(r,e,t){const n=e[0],i=e[1];return r[0]=t[0]*n+t[2]*i,r[1]=t[1]*n+t[3]*i,r[2]=e[2],r}function sme(r,e,t){const n=e[0],i=e[1];return r[0]=t[0]*n+t[2]*i,r[1]=t[1]*n+t[3]*i,r[2]=e[2],r[3]=e[3],r}function tK(r,e,t){const n=e[0],i=e[1],s=e[2];return r[0]=t[0]*n+t[3]*i+t[6]*s,r[1]=t[1]*n+t[4]*i+t[7]*s,r[2]=t[2]*n+t[5]*i+t[8]*s,r[3]=e[3],r}class cO extends lO{constructor(e=0,t=0){super(2),Ad(e)&&arguments.length===1?this.copy(e):(Bs.debug&&(Ln(e),Ln(t)),this[0]=e,this[1]=t)}set(e,t){return this[0]=e,this[1]=t,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this.check()}fromObject(e){return Bs.debug&&(Ln(e.x),Ln(e.y)),this[0]=e.x,this[1]=e.y,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return ZW(this,this,e),this.check()}transformAsVector(e){return QW(this,this,e),this.check()}transformByMatrix3(e){return YW(this,this,e),this.check()}transformByMatrix2x3(e){return nme(this,this,e),this.check()}transformByMatrix2(e){return rme(this,this,e),this.check()}}function rK(){const r=new rc(3);return rc!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function nK(r){const e=r[0],t=r[1],n=r[2];return Math.sqrt(e*e+t*t+n*n)}function N6(r,e,t){const n=new rc(3);return n[0]=r,n[1]=e,n[2]=t,n}function ome(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r}function ame(r){const e=r[0],t=r[1],n=r[2];return e*e+t*t+n*n}function lme(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r}function cme(r,e){const t=e[0],n=e[1],i=e[2];let s=t*t+n*n+i*i;return s>0&&(s=1/Math.sqrt(s)),r[0]=e[0]*s,r[1]=e[1]*s,r[2]=e[2]*s,r}function uO(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]}function Tw(r,e,t){const n=e[0],i=e[1],s=e[2],a=t[0],o=t[1],u=t[2];return r[0]=i*u-s*o,r[1]=s*a-n*u,r[2]=n*o-i*a,r}function ume(r,e,t,n){const i=e[0],s=e[1],a=e[2];return r[0]=i+n*(t[0]-i),r[1]=s+n*(t[1]-s),r[2]=a+n*(t[2]-a),r}function hO(r,e,t){const n=e[0],i=e[1],s=e[2];let a=t[3]*n+t[7]*i+t[11]*s+t[15];return a=a||1,r[0]=(t[0]*n+t[4]*i+t[8]*s+t[12])/a,r[1]=(t[1]*n+t[5]*i+t[9]*s+t[13])/a,r[2]=(t[2]*n+t[6]*i+t[10]*s+t[14])/a,r}function iK(r,e,t){const n=e[0],i=e[1],s=e[2];return r[0]=n*t[0]+i*t[3]+s*t[6],r[1]=n*t[1]+i*t[4]+s*t[7],r[2]=n*t[2]+i*t[5]+s*t[8],r}function sK(r,e,t){const n=t[0],i=t[1],s=t[2],a=t[3],o=e[0],u=e[1],f=e[2];let g=i*f-s*u,y=s*o-n*f,A=n*u-i*o,C=i*A-s*y,M=s*g-n*A,k=n*y-i*g;const D=a*2;return g*=D,y*=D,A*=D,C*=2,M*=2,k*=2,r[0]=o+g+C,r[1]=u+y+M,r[2]=f+A+k,r}function hme(r,e,t,n){const i=[],s=[];return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],s[0]=i[0],s[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),s[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),r[0]=s[0]+t[0],r[1]=s[1]+t[1],r[2]=s[2]+t[2],r}function dme(r,e,t,n){const i=[],s=[];return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],s[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),s[1]=i[1],s[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),r[0]=s[0]+t[0],r[1]=s[1]+t[1],r[2]=s[2]+t[2],r}function fme(r,e,t,n){const i=[],s=[];return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],s[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),s[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),s[2]=i[2],r[0]=s[0]+t[0],r[1]=s[1]+t[1],r[2]=s[2]+t[2],r}function pme(r,e){const t=r[0],n=r[1],i=r[2],s=e[0],a=e[1],o=e[2],u=Math.sqrt((t*t+n*n+i*i)*(s*s+a*a+o*o)),f=u&&uO(r,e)/u;return Math.acos(Math.min(Math.max(f,-1),1))}const oK=ome,aK=nK,BI=ame;(function(){const r=rK();return function(e,t,n,i,s,a){let o,u;for(t||(t=3),n||(n=0),i?u=Math.min(i*t+n,e.length):u=e.length,o=n;o<u;o+=t)r[0]=e[o],r[1]=e[o+1],r[2]=e[o+2],s(r,r,a),e[o]=r[0],e[o+1]=r[1],e[o+2]=r[2];return e}})();const MI=[0,0,0];let Y1;class rt extends lO{static get ZERO(){return Y1||(Y1=new rt(0,0,0),Object.freeze(Y1)),Y1}constructor(e=0,t=0,n=0){super(-0,-0,-0),arguments.length===1&&Ad(e)?this.copy(e):(Bs.debug&&(Ln(e),Ln(t),Ln(n)),this[0]=e,this[1]=t,this[2]=n)}set(e,t,n){return this[0]=e,this[1]=t,this[2]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Bs.debug&&(Ln(e.x),Ln(e.y),Ln(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Ln(e)}angle(e){return pme(this,e)}cross(e){return Tw(this,this,e),this.check()}rotateX({radians:e,origin:t=MI}){return hme(this,this,t,e),this.check()}rotateY({radians:e,origin:t=MI}){return dme(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=MI}){return fme(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return hO(this,this,e),this.check()}transformAsVector(e){return eK(this,this,e),this.check()}transformByMatrix3(e){return iK(this,this,e),this.check()}transformByMatrix2(e){return ime(this,this,e),this.check()}transformByQuaternion(e){return sK(this,this,e),this.check()}}let Z1;class dO extends lO{static get ZERO(){return Z1||(Z1=new dO(0,0,0,0),Object.freeze(Z1)),Z1}constructor(e=0,t=0,n=0,i=0){super(-0,-0,-0,-0),Ad(e)&&arguments.length===1?this.copy(e):(Bs.debug&&(Ln(e),Ln(t),Ln(n),Ln(i)),this[0]=e,this[1]=t,this[2]=n,this[3]=i)}set(e,t,n,i){return this[0]=e,this[1]=t,this[2]=n,this[3]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return Bs.debug&&(Ln(e.x),Ln(e.y),Ln(e.z),Ln(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=Ln(e)}get w(){return this[3]}set w(e){this[3]=Ln(e)}transform(e){return hO(this,this,e),this.check()}transformByMatrix3(e){return tK(this,this,e),this.check()}transformByMatrix2(e){return sme(this,this,e),this.check()}transformByQuaternion(e){return sK(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}class lK extends aO{toString(){let e="[";if(Bs.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let n=0;n<this.RANK;++n)e+=` ${this[n*this.RANK+t]}`}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=` ${this[t]}`}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,n){return this[t*this.RANK+e]=Ln(n),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const n=e*this.RANK;for(let i=0;i<this.RANK;++i)t[i]=this[n+i];return t}setColumn(e,t){const n=e*this.RANK;for(let i=0;i<this.RANK;++i)this[n+i]=t[i];return this}}function gme(){const r=new rc(9);return rc!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function mme(r,e){if(r===e){const t=e[1],n=e[2],i=e[5];r[1]=e[3],r[2]=e[6],r[3]=t,r[5]=e[7],r[6]=n,r[7]=i}else r[0]=e[0],r[1]=e[3],r[2]=e[6],r[3]=e[1],r[4]=e[4],r[5]=e[7],r[6]=e[2],r[7]=e[5],r[8]=e[8];return r}function yme(r,e){const t=e[0],n=e[1],i=e[2],s=e[3],a=e[4],o=e[5],u=e[6],f=e[7],g=e[8],y=g*a-o*f,A=-g*s+o*u,C=f*s-a*u;let M=t*y+n*A+i*C;return M?(M=1/M,r[0]=y*M,r[1]=(-g*n+i*f)*M,r[2]=(o*n-i*a)*M,r[3]=A*M,r[4]=(g*t-i*u)*M,r[5]=(-o*t+i*s)*M,r[6]=C*M,r[7]=(-f*t+n*u)*M,r[8]=(a*t-n*s)*M,r):null}function bme(r){const e=r[0],t=r[1],n=r[2],i=r[3],s=r[4],a=r[5],o=r[6],u=r[7],f=r[8];return e*(f*s-a*u)+t*(-f*i+a*o)+n*(u*i-s*o)}function F6(r,e,t){const n=e[0],i=e[1],s=e[2],a=e[3],o=e[4],u=e[5],f=e[6],g=e[7],y=e[8],A=t[0],C=t[1],M=t[2],k=t[3],D=t[4],V=t[5],W=t[6],z=t[7],$=t[8];return r[0]=A*n+C*a+M*f,r[1]=A*i+C*o+M*g,r[2]=A*s+C*u+M*y,r[3]=k*n+D*a+V*f,r[4]=k*i+D*o+V*g,r[5]=k*s+D*u+V*y,r[6]=W*n+z*a+$*f,r[7]=W*i+z*o+$*g,r[8]=W*s+z*u+$*y,r}function _me(r,e,t){const n=e[0],i=e[1],s=e[2],a=e[3],o=e[4],u=e[5],f=e[6],g=e[7],y=e[8],A=t[0],C=t[1];return r[0]=n,r[1]=i,r[2]=s,r[3]=a,r[4]=o,r[5]=u,r[6]=A*n+C*a+f,r[7]=A*i+C*o+g,r[8]=A*s+C*u+y,r}function vme(r,e,t){const n=e[0],i=e[1],s=e[2],a=e[3],o=e[4],u=e[5],f=e[6],g=e[7],y=e[8],A=Math.sin(t),C=Math.cos(t);return r[0]=C*n+A*a,r[1]=C*i+A*o,r[2]=C*s+A*u,r[3]=C*a-A*n,r[4]=C*o-A*i,r[5]=C*u-A*s,r[6]=f,r[7]=g,r[8]=y,r}function U6(r,e,t){const n=t[0],i=t[1];return r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=i*e[3],r[4]=i*e[4],r[5]=i*e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function Ame(r,e){const t=e[0],n=e[1],i=e[2],s=e[3],a=t+t,o=n+n,u=i+i,f=t*a,g=n*a,y=n*o,A=i*a,C=i*o,M=i*u,k=s*a,D=s*o,V=s*u;return r[0]=1-y-M,r[3]=g-V,r[6]=A+D,r[1]=g+V,r[4]=1-f-M,r[7]=C-k,r[2]=A-D,r[5]=C+k,r[8]=1-f-y,r}var cB;(function(r){r[r.COL0ROW0=0]="COL0ROW0",r[r.COL0ROW1=1]="COL0ROW1",r[r.COL0ROW2=2]="COL0ROW2",r[r.COL1ROW0=3]="COL1ROW0",r[r.COL1ROW1=4]="COL1ROW1",r[r.COL1ROW2=5]="COL1ROW2",r[r.COL2ROW0=6]="COL2ROW0",r[r.COL2ROW1=7]="COL2ROW1",r[r.COL2ROW2=8]="COL2ROW2"})(cB||(cB={}));const xme=Object.freeze([1,0,0,0,1,0,0,0,1]);class Hi extends lK{static get IDENTITY(){return Cme()}static get ZERO(){return wme()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return cB}constructor(e,...t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):t.length>0?this.copy([e,...t]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(xme)}fromObject(e){return this.check()}fromQuaternion(e){return Ame(this,e),this.check()}set(e,t,n,i,s,a,o,u,f){return this[0]=e,this[1]=t,this[2]=n,this[3]=i,this[4]=s,this[5]=a,this[6]=o,this[7]=u,this[8]=f,this.check()}setRowMajor(e,t,n,i,s,a,o,u,f){return this[0]=e,this[1]=i,this[2]=o,this[3]=t,this[4]=s,this[5]=u,this[6]=n,this[7]=a,this[8]=f,this.check()}determinant(){return bme(this)}transpose(){return mme(this,this),this.check()}invert(){return yme(this,this),this.check()}multiplyLeft(e){return F6(this,e,this),this.check()}multiplyRight(e){return F6(this,this,e),this.check()}rotate(e){return vme(this,this,e),this.check()}scale(e){return Array.isArray(e)?U6(this,this,e):U6(this,this,[e,e]),this.check()}translate(e){return _me(this,this,e),this.check()}transform(e,t){let n;switch(e.length){case 2:n=YW(t||[-0,-0],e,this);break;case 3:n=iK(t||[-0,-0,-0],e,this);break;case 4:n=tK(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Q0(n,e.length),n}transformVector(e,t){return this.transform(e,t)}transformVector2(e,t){return this.transform(e,t)}transformVector3(e,t){return this.transform(e,t)}}let Q1,ex=null;function wme(){return Q1||(Q1=new Hi([0,0,0,0,0,0,0,0,0]),Object.freeze(Q1)),Q1}function Cme(){return ex||(ex=new Hi,Object.freeze(ex)),ex}function Tme(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Sme(r,e){if(r===e){const t=e[1],n=e[2],i=e[3],s=e[6],a=e[7],o=e[11];r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=t,r[6]=e[9],r[7]=e[13],r[8]=n,r[9]=s,r[11]=e[14],r[12]=i,r[13]=a,r[14]=o}else r[0]=e[0],r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=e[1],r[5]=e[5],r[6]=e[9],r[7]=e[13],r[8]=e[2],r[9]=e[6],r[10]=e[10],r[11]=e[14],r[12]=e[3],r[13]=e[7],r[14]=e[11],r[15]=e[15];return r}function uB(r,e){const t=e[0],n=e[1],i=e[2],s=e[3],a=e[4],o=e[5],u=e[6],f=e[7],g=e[8],y=e[9],A=e[10],C=e[11],M=e[12],k=e[13],D=e[14],V=e[15],W=t*o-n*a,z=t*u-i*a,$=t*f-s*a,te=n*u-i*o,le=n*f-s*o,_e=i*f-s*u,se=g*k-y*M,Y=g*D-A*M,ce=g*V-C*M,oe=y*D-A*k,Me=y*V-C*k,ze=A*V-C*D;let Ve=W*ze-z*Me+$*oe+te*ce-le*Y+_e*se;return Ve?(Ve=1/Ve,r[0]=(o*ze-u*Me+f*oe)*Ve,r[1]=(i*Me-n*ze-s*oe)*Ve,r[2]=(k*_e-D*le+V*te)*Ve,r[3]=(A*le-y*_e-C*te)*Ve,r[4]=(u*ce-a*ze-f*Y)*Ve,r[5]=(t*ze-i*ce+s*Y)*Ve,r[6]=(D*$-M*_e-V*z)*Ve,r[7]=(g*_e-A*$+C*z)*Ve,r[8]=(a*Me-o*ce+f*se)*Ve,r[9]=(n*ce-t*Me-s*se)*Ve,r[10]=(M*le-k*$+V*W)*Ve,r[11]=(y*$-g*le-C*W)*Ve,r[12]=(o*Y-a*oe-u*se)*Ve,r[13]=(t*oe-n*Y+i*se)*Ve,r[14]=(k*z-M*te-D*W)*Ve,r[15]=(g*te-y*z+A*W)*Ve,r):null}function Eme(r){const e=r[0],t=r[1],n=r[2],i=r[3],s=r[4],a=r[5],o=r[6],u=r[7],f=r[8],g=r[9],y=r[10],A=r[11],C=r[12],M=r[13],k=r[14],D=r[15],V=e*a-t*s,W=e*o-n*s,z=t*o-n*a,$=f*M-g*C,te=f*k-y*C,le=g*k-y*M,_e=e*le-t*te+n*$,se=s*le-a*te+o*$,Y=f*z-g*W+y*V,ce=C*z-M*W+k*V;return u*_e-i*se+D*Y-A*ce}function qf(r,e,t){const n=e[0],i=e[1],s=e[2],a=e[3],o=e[4],u=e[5],f=e[6],g=e[7],y=e[8],A=e[9],C=e[10],M=e[11],k=e[12],D=e[13],V=e[14],W=e[15];let z=t[0],$=t[1],te=t[2],le=t[3];return r[0]=z*n+$*o+te*y+le*k,r[1]=z*i+$*u+te*A+le*D,r[2]=z*s+$*f+te*C+le*V,r[3]=z*a+$*g+te*M+le*W,z=t[4],$=t[5],te=t[6],le=t[7],r[4]=z*n+$*o+te*y+le*k,r[5]=z*i+$*u+te*A+le*D,r[6]=z*s+$*f+te*C+le*V,r[7]=z*a+$*g+te*M+le*W,z=t[8],$=t[9],te=t[10],le=t[11],r[8]=z*n+$*o+te*y+le*k,r[9]=z*i+$*u+te*A+le*D,r[10]=z*s+$*f+te*C+le*V,r[11]=z*a+$*g+te*M+le*W,z=t[12],$=t[13],te=t[14],le=t[15],r[12]=z*n+$*o+te*y+le*k,r[13]=z*i+$*u+te*A+le*D,r[14]=z*s+$*f+te*C+le*V,r[15]=z*a+$*g+te*M+le*W,r}function jC(r,e,t){const n=t[0],i=t[1],s=t[2];let a,o,u,f,g,y,A,C,M,k,D,V;return e===r?(r[12]=e[0]*n+e[4]*i+e[8]*s+e[12],r[13]=e[1]*n+e[5]*i+e[9]*s+e[13],r[14]=e[2]*n+e[6]*i+e[10]*s+e[14],r[15]=e[3]*n+e[7]*i+e[11]*s+e[15]):(a=e[0],o=e[1],u=e[2],f=e[3],g=e[4],y=e[5],A=e[6],C=e[7],M=e[8],k=e[9],D=e[10],V=e[11],r[0]=a,r[1]=o,r[2]=u,r[3]=f,r[4]=g,r[5]=y,r[6]=A,r[7]=C,r[8]=M,r[9]=k,r[10]=D,r[11]=V,r[12]=a*n+g*i+M*s+e[12],r[13]=o*n+y*i+k*s+e[13],r[14]=u*n+A*i+D*s+e[14],r[15]=f*n+C*i+V*s+e[15]),r}function fO(r,e,t){const n=t[0],i=t[1],s=t[2];return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r[4]=e[4]*i,r[5]=e[5]*i,r[6]=e[6]*i,r[7]=e[7]*i,r[8]=e[8]*s,r[9]=e[9]*s,r[10]=e[10]*s,r[11]=e[11]*s,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function Ime(r,e,t,n){let i=n[0],s=n[1],a=n[2],o=Math.sqrt(i*i+s*s+a*a),u,f,g,y,A,C,M,k,D,V,W,z,$,te,le,_e,se,Y,ce,oe,Me,ze,Ve,lt;return o<e_?null:(o=1/o,i*=o,s*=o,a*=o,f=Math.sin(t),u=Math.cos(t),g=1-u,y=e[0],A=e[1],C=e[2],M=e[3],k=e[4],D=e[5],V=e[6],W=e[7],z=e[8],$=e[9],te=e[10],le=e[11],_e=i*i*g+u,se=s*i*g+a*f,Y=a*i*g-s*f,ce=i*s*g-a*f,oe=s*s*g+u,Me=a*s*g+i*f,ze=i*a*g+s*f,Ve=s*a*g-i*f,lt=a*a*g+u,r[0]=y*_e+k*se+z*Y,r[1]=A*_e+D*se+$*Y,r[2]=C*_e+V*se+te*Y,r[3]=M*_e+W*se+le*Y,r[4]=y*ce+k*oe+z*Me,r[5]=A*ce+D*oe+$*Me,r[6]=C*ce+V*oe+te*Me,r[7]=M*ce+W*oe+le*Me,r[8]=y*ze+k*Ve+z*lt,r[9]=A*ze+D*Ve+$*lt,r[10]=C*ze+V*Ve+te*lt,r[11]=M*ze+W*Ve+le*lt,e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r)}function cK(r,e,t){const n=Math.sin(t),i=Math.cos(t),s=e[4],a=e[5],o=e[6],u=e[7],f=e[8],g=e[9],y=e[10],A=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=s*i+f*n,r[5]=a*i+g*n,r[6]=o*i+y*n,r[7]=u*i+A*n,r[8]=f*i-s*n,r[9]=g*i-a*n,r[10]=y*i-o*n,r[11]=A*i-u*n,r}function Pme(r,e,t){const n=Math.sin(t),i=Math.cos(t),s=e[0],a=e[1],o=e[2],u=e[3],f=e[8],g=e[9],y=e[10],A=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=s*i-f*n,r[1]=a*i-g*n,r[2]=o*i-y*n,r[3]=u*i-A*n,r[8]=s*n+f*i,r[9]=a*n+g*i,r[10]=o*n+y*i,r[11]=u*n+A*i,r}function uK(r,e,t){const n=Math.sin(t),i=Math.cos(t),s=e[0],a=e[1],o=e[2],u=e[3],f=e[4],g=e[5],y=e[6],A=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=s*i+f*n,r[1]=a*i+g*n,r[2]=o*i+y*n,r[3]=u*i+A*n,r[4]=f*i-s*n,r[5]=g*i-a*n,r[6]=y*i-o*n,r[7]=A*i-u*n,r}function Bme(r,e){const t=e[0],n=e[1],i=e[2],s=e[4],a=e[5],o=e[6],u=e[8],f=e[9],g=e[10];return r[0]=Math.sqrt(t*t+n*n+i*i),r[1]=Math.sqrt(s*s+a*a+o*o),r[2]=Math.sqrt(u*u+f*f+g*g),r}function Mme(r,e){const t=e[0],n=e[1],i=e[2],s=e[3],a=t+t,o=n+n,u=i+i,f=t*a,g=n*a,y=n*o,A=i*a,C=i*o,M=i*u,k=s*a,D=s*o,V=s*u;return r[0]=1-y-M,r[1]=g+V,r[2]=A-D,r[3]=0,r[4]=g-V,r[5]=1-f-M,r[6]=C+k,r[7]=0,r[8]=A+D,r[9]=C-k,r[10]=1-f-y,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Rme(r,e,t,n,i,s,a){const o=1/(t-e),u=1/(i-n),f=1/(s-a);return r[0]=s*2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s*2*u,r[6]=0,r[7]=0,r[8]=(t+e)*o,r[9]=(i+n)*u,r[10]=(a+s)*f,r[11]=-1,r[12]=0,r[13]=0,r[14]=a*s*2*f,r[15]=0,r}function kme(r,e,t,n,i){const s=1/Math.tan(e/2);if(r[0]=s/t,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0){const a=1/(n-i);r[10]=(i+n)*a,r[14]=2*i*n*a}else r[10]=-1,r[14]=-2*n;return r}const Ome=kme;function Dme(r,e,t,n,i,s,a){const o=1/(e-t),u=1/(n-i),f=1/(s-a);return r[0]=-2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*u,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*f,r[11]=0,r[12]=(e+t)*o,r[13]=(i+n)*u,r[14]=(a+s)*f,r[15]=1,r}const Lme=Dme;function Nme(r,e,t,n){let i,s,a,o,u,f,g,y,A,C;const M=e[0],k=e[1],D=e[2],V=n[0],W=n[1],z=n[2],$=t[0],te=t[1],le=t[2];return Math.abs(M-$)<e_&&Math.abs(k-te)<e_&&Math.abs(D-le)<e_?Tme(r):(y=M-$,A=k-te,C=D-le,i=1/Math.sqrt(y*y+A*A+C*C),y*=i,A*=i,C*=i,s=W*C-z*A,a=z*y-V*C,o=V*A-W*y,i=Math.sqrt(s*s+a*a+o*o),i?(i=1/i,s*=i,a*=i,o*=i):(s=0,a=0,o=0),u=A*o-C*a,f=C*s-y*o,g=y*a-A*s,i=Math.sqrt(u*u+f*f+g*g),i?(i=1/i,u*=i,f*=i,g*=i):(u=0,f=0,g=0),r[0]=s,r[1]=u,r[2]=y,r[3]=0,r[4]=a,r[5]=f,r[6]=A,r[7]=0,r[8]=o,r[9]=g,r[10]=C,r[11]=0,r[12]=-(s*M+a*k+o*D),r[13]=-(u*M+f*k+g*D),r[14]=-(y*M+A*k+C*D),r[15]=1,r)}function Fme(){const r=new rc(4);return rc!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function Ume(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r}function pO(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r}function zme(r){const e=r[0],t=r[1],n=r[2],i=r[3];return Math.sqrt(e*e+t*t+n*n+i*i)}function Vme(r){const e=r[0],t=r[1],n=r[2],i=r[3];return e*e+t*t+n*n+i*i}function $me(r,e){const t=e[0],n=e[1],i=e[2],s=e[3];let a=t*t+n*n+i*i+s*s;return a>0&&(a=1/Math.sqrt(a)),r[0]=t*a,r[1]=n*a,r[2]=i*a,r[3]=s*a,r}function jme(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]*e[3]}function Gme(r,e,t,n){const i=e[0],s=e[1],a=e[2],o=e[3];return r[0]=i+n*(t[0]-i),r[1]=s+n*(t[1]-s),r[2]=a+n*(t[2]-a),r[3]=o+n*(t[3]-o),r}function Py(r,e,t){const n=e[0],i=e[1],s=e[2],a=e[3];return r[0]=t[0]*n+t[4]*i+t[8]*s+t[12]*a,r[1]=t[1]*n+t[5]*i+t[9]*s+t[13]*a,r[2]=t[2]*n+t[6]*i+t[10]*s+t[14]*a,r[3]=t[3]*n+t[7]*i+t[11]*s+t[15]*a,r}function Hme(r,e,t){const n=e[0],i=e[1],s=e[2],a=t[0],o=t[1],u=t[2],f=t[3],g=f*n+o*s-u*i,y=f*i+u*n-a*s,A=f*s+a*i-o*n,C=-a*n-o*i-u*s;return r[0]=g*f+C*-a+y*-u-A*-o,r[1]=y*f+C*-o+A*-a-g*-u,r[2]=A*f+C*-u+g*-o-y*-a,r[3]=e[3],r}(function(){const r=Fme();return function(e,t,n,i,s,a){let o,u;for(t||(t=4),n||(n=0),i?u=Math.min(i*t+n,e.length):u=e.length,o=n;o<u;o+=t)r[0]=e[o],r[1]=e[o+1],r[2]=e[o+2],r[3]=e[o+3],s(r,r,a),e[o]=r[0],e[o+1]=r[1],e[o+2]=r[2],e[o+3]=r[3];return e}})();var hB;(function(r){r[r.COL0ROW0=0]="COL0ROW0",r[r.COL0ROW1=1]="COL0ROW1",r[r.COL0ROW2=2]="COL0ROW2",r[r.COL0ROW3=3]="COL0ROW3",r[r.COL1ROW0=4]="COL1ROW0",r[r.COL1ROW1=5]="COL1ROW1",r[r.COL1ROW2=6]="COL1ROW2",r[r.COL1ROW3=7]="COL1ROW3",r[r.COL2ROW0=8]="COL2ROW0",r[r.COL2ROW1=9]="COL2ROW1",r[r.COL2ROW2=10]="COL2ROW2",r[r.COL2ROW3=11]="COL2ROW3",r[r.COL3ROW0=12]="COL3ROW0",r[r.COL3ROW1=13]="COL3ROW1",r[r.COL3ROW2=14]="COL3ROW2",r[r.COL3ROW3=15]="COL3ROW3"})(hB||(hB={}));const Wme=45*Math.PI/180,Kme=1,RI=.1,kI=500,Xme=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class $r extends lK{static get IDENTITY(){return qme()}static get ZERO(){return Jme()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return hB}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,n,i,s,a,o,u,f,g,y,A,C,M,k,D){return this[0]=e,this[1]=t,this[2]=n,this[3]=i,this[4]=s,this[5]=a,this[6]=o,this[7]=u,this[8]=f,this[9]=g,this[10]=y,this[11]=A,this[12]=C,this[13]=M,this[14]=k,this[15]=D,this.check()}setRowMajor(e,t,n,i,s,a,o,u,f,g,y,A,C,M,k,D){return this[0]=e,this[1]=s,this[2]=f,this[3]=C,this[4]=t,this[5]=a,this[6]=g,this[7]=M,this[8]=n,this[9]=o,this[10]=y,this[11]=k,this[12]=i,this[13]=u,this[14]=A,this[15]=D,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(Xme)}fromObject(e){return this.check()}fromQuaternion(e){return Mme(this,e),this.check()}frustum(e){const{left:t,right:n,bottom:i,top:s,near:a=RI,far:o=kI}=e;return o===1/0?Yme(this,t,n,i,s,a):Rme(this,t,n,i,s,a,o),this.check()}lookAt(e){const{eye:t,center:n=[0,0,0],up:i=[0,1,0]}=e;return Nme(this,t,n,i),this.check()}ortho(e){const{left:t,right:n,bottom:i,top:s,near:a=RI,far:o=kI}=e;return Lme(this,t,n,i,s,a,o),this.check()}orthographic(e){const{fovy:t=Wme,aspect:n=Kme,focalDistance:i=1,near:s=RI,far:a=kI}=e;z6(t);const o=t/2,u=i*Math.tan(o),f=u*n;return this.ortho({left:-f,right:f,bottom:-u,top:u,near:s,far:a})}perspective(e){const{fovy:t=45*Math.PI/180,aspect:n=1,near:i=.1,far:s=500}=e;return z6(t),Ome(this,t,n,i,s),this.check()}determinant(){return Eme(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const n=this.getScale(t),i=1/n[0],s=1/n[1],a=1/n[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*a,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*a,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const n=this.getScale(t),i=1/n[0],s=1/n[1],a=1/n[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*a,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*a,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*a,e}transpose(){return Sme(this,this),this.check()}invert(){return uB(this,this),this.check()}multiplyLeft(e){return qf(this,e,this),this.check()}multiplyRight(e){return qf(this,this,e),this.check()}rotateX(e){return cK(this,this,e),this.check()}rotateY(e){return Pme(this,this,e),this.check()}rotateZ(e){return uK(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,t){return Ime(this,this,e,t),this.check()}scale(e){return fO(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return jC(this,this,e),this.check()}transform(e,t){return e.length===4?(t=Py(t||[-0,-0,-0,-0],e,this),Q0(t,4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:n}=e;let i;switch(n){case 2:i=ZW(t||[-0,-0],e,this);break;case 3:i=hO(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Q0(i,e.length),i}transformAsVector(e,t){let n;switch(e.length){case 2:n=QW(t||[-0,-0],e,this);break;case 3:n=eK(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Q0(n,e.length),n}transformPoint(e,t){return this.transformAsPoint(e,t)}transformVector(e,t){return this.transformAsPoint(e,t)}transformDirection(e,t){return this.transformAsVector(e,t)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,n){return this.identity().translate([e,t,n])}}let tx,rx;function Jme(){return tx||(tx=new $r([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(tx)),tx}function qme(){return rx||(rx=new $r,Object.freeze(rx)),rx}function z6(r){if(r>Math.PI*2)throw Error("expected radians")}function Yme(r,e,t,n,i,s){const a=2*s/(t-e),o=2*s/(i-n),u=(t+e)/(t-e),f=(i+n)/(i-n),g=-1,y=-1,A=-2*s;return r[0]=a,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=o,r[6]=0,r[7]=0,r[8]=u,r[9]=f,r[10]=g,r[11]=y,r[12]=0,r[13]=0,r[14]=A,r[15]=0,r}function V6(){const r=new rc(4);return rc!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function Zme(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r}function hK(r,e,t){t=t*.5;const n=Math.sin(t);return r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=Math.cos(t),r}function $6(r,e,t){const n=e[0],i=e[1],s=e[2],a=e[3],o=t[0],u=t[1],f=t[2],g=t[3];return r[0]=n*g+a*o+i*f-s*u,r[1]=i*g+a*u+s*o-n*f,r[2]=s*g+a*f+n*u-i*o,r[3]=a*g-n*o-i*u-s*f,r}function Qme(r,e,t){t*=.5;const n=e[0],i=e[1],s=e[2],a=e[3],o=Math.sin(t),u=Math.cos(t);return r[0]=n*u+a*o,r[1]=i*u+s*o,r[2]=s*u-i*o,r[3]=a*u-n*o,r}function eye(r,e,t){t*=.5;const n=e[0],i=e[1],s=e[2],a=e[3],o=Math.sin(t),u=Math.cos(t);return r[0]=n*u-s*o,r[1]=i*u+a*o,r[2]=s*u+n*o,r[3]=a*u-i*o,r}function tye(r,e,t){t*=.5;const n=e[0],i=e[1],s=e[2],a=e[3],o=Math.sin(t),u=Math.cos(t);return r[0]=n*u+i*o,r[1]=i*u-n*o,r[2]=s*u+a*o,r[3]=a*u-s*o,r}function rye(r,e){const t=e[0],n=e[1],i=e[2];return r[0]=t,r[1]=n,r[2]=i,r[3]=Math.sqrt(Math.abs(1-t*t-n*n-i*i)),r}function Sw(r,e,t,n){const i=e[0],s=e[1],a=e[2],o=e[3];let u=t[0],f=t[1],g=t[2],y=t[3],A,C,M,k,D;return A=i*u+s*f+a*g+o*y,A<0&&(A=-A,u=-u,f=-f,g=-g,y=-y),1-A>e_?(C=Math.acos(A),D=Math.sin(C),M=Math.sin((1-n)*C)/D,k=Math.sin(n*C)/D):(M=1-n,k=n),r[0]=M*i+k*u,r[1]=M*s+k*f,r[2]=M*a+k*g,r[3]=M*o+k*y,r}function nye(r,e){const t=e[0],n=e[1],i=e[2],s=e[3],a=t*t+n*n+i*i+s*s,o=a?1/a:0;return r[0]=-t*o,r[1]=-n*o,r[2]=-i*o,r[3]=s*o,r}function iye(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=e[3],r}function dK(r,e){const t=e[0]+e[4]+e[8];let n;if(t>0)n=Math.sqrt(t+1),r[3]=.5*n,n=.5/n,r[0]=(e[5]-e[7])*n,r[1]=(e[6]-e[2])*n,r[2]=(e[1]-e[3])*n;else{let i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);const s=(i+1)%3,a=(i+2)%3;n=Math.sqrt(e[i*3+i]-e[s*3+s]-e[a*3+a]+1),r[i]=.5*n,n=.5/n,r[3]=(e[s*3+a]-e[a*3+s])*n,r[s]=(e[s*3+i]+e[i*3+s])*n,r[a]=(e[a*3+i]+e[i*3+a])*n}return r}const sye=Ume,oye=pO,aye=jme,lye=Gme,cye=zme,uye=Vme,fK=$me,hye=function(){const r=rK(),e=N6(1,0,0),t=N6(0,1,0);return function(n,i,s){const a=uO(i,s);return a<-.999999?(Tw(r,e,i),aK(r)<1e-6&&Tw(r,t,i),cme(r,r),hK(n,r,Math.PI),n):a>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(Tw(r,i,s),n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=1+a,fK(n,n))}}();(function(){const r=V6(),e=V6();return function(t,n,i,s,a,o){return Sw(r,n,a,o),Sw(e,i,s,o),Sw(t,r,e,2*o*(1-o)),t}})();(function(){const r=gme();return function(e,t,n,i){return r[0]=n[0],r[3]=n[1],r[6]=n[2],r[1]=i[0],r[4]=i[1],r[7]=i[2],r[2]=-t[0],r[5]=-t[1],r[8]=-t[2],fK(e,dK(e,r))}})();const dye=[0,0,0,1];class j_ extends aO{constructor(e=0,t=0,n=0,i=1){super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,t,n,i)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,n,i){return this[0]=e,this[1]=t,this[2]=n,this[3]=i,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return dK(this,e),this.check()}fromAxisRotation(e,t){return hK(this,e,t),this.check()}identity(){return Zme(this),this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=Ln(e)}get y(){return this[1]}set y(e){this[1]=Ln(e)}get z(){return this[2]}set z(e){this[2]=Ln(e)}get w(){return this[3]}set w(e){this[3]=Ln(e)}len(){return cye(this)}lengthSquared(){return uye(this)}dot(e){return aye(this,e)}rotationTo(e,t){return hye(this,e,t),this.check()}add(e){return sye(this,this,e),this.check()}calculateW(){return rye(this,this),this.check()}conjugate(){return iye(this,this),this.check()}invert(){return nye(this,this),this.check()}lerp(e,t,n){return n===void 0?this.lerp(this,e,t):(lye(this,e,t,n),this.check())}multiplyRight(e){return $6(this,this,e),this.check()}multiplyLeft(e){return $6(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,e===0&&(this[3]=1),this.check()}rotateX(e){return Qme(this,this,e),this.check()}rotateY(e){return eye(this,this,e),this.check()}rotateZ(e){return tye(this,this,e),this.check()}scale(e){return oye(this,this,e),this.check()}slerp(e,t,n){let i,s,a;switch(arguments.length){case 1:({start:i=dye,target:s,ratio:a}=e);break;case 2:i=this,s=e,a=t;break;default:i=e,s=t,a=n}return Sw(this,i,s,a),this.check()}transformVector4(e,t=new dO){return Hme(t,e,this),Q0(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}const fye=.1,pye=1e-12,pK=1e-15,gye=1e-20;function gK(r,e=[],t=0){const n=Math.fround(r),i=r-n;return e[t]=n,e[t+1]=i,e}function mye(r){return r-Math.fround(r)}function yye(r){const e=new Float32Array(32);for(let t=0;t<4;++t)for(let n=0;n<4;++n){const i=t*4+n;gK(r[n*4+t],e,i*2)}return e}const bye=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND

// All these functions are for substituting tan() function from Intel GPU only
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01; // 1/3!
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03; // 1/5!
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04; // 1/7!
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06; // 1/9!

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }

    // 2pi range reduction
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,_ye={name:"fp32",vs:bye},vye=`
uniform fp64arithmeticUniforms {
  uniform float ONE;
} fp64;

/*
About LUMA_FP64_CODE_ELIMINATION_WORKAROUND

The purpose of this workaround is to prevent shader compilers from
optimizing away necessary arithmetic operations by swapping their sequences
or transform the equation to some 'equivalent' form.

The method is to multiply an artifical variable, ONE, which will be known to
the compiler to be 1 only at runtime. The whole expression is then represented
as a polynomial with respective to ONE. In the coefficients of all terms, only one a
and one b should appear

err = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE
*/

// Divide float number to high and low floats to extend fraction bits
vec2 split(float a) {
  const float SPLIT = 4097.0;
  float t = a * SPLIT;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float a_hi = t * fp64.ONE - (t - a);
  float a_lo = a * fp64.ONE - a_hi;
#else
  float a_hi = t - (t - a);
  float a_lo = a - a_hi;
#endif
  return vec2(a_hi, a_lo);
}

// Divide float number again when high float uses too many fraction bits
vec2 split2(vec2 a) {
  vec2 b = split(a.x);
  b.y += a.y;
  return b;
}

// Special sum operation when a > b
vec2 quickTwoSum(float a, float b) {
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float sum = (a + b) * fp64.ONE;
  float err = b - (sum - a) * fp64.ONE;
#else
  float sum = a + b;
  float err = b - (sum - a);
#endif
  return vec2(sum, err);
}

// General sum operation
vec2 twoSum(float a, float b) {
  float s = (a + b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE + (b - v);
#else
  float v = s - a;
  float err = (a - (s - v)) + (b - v);
#endif
  return vec2(s, err);
}

vec2 twoSub(float a, float b) {
  float s = (a - b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE - (b + v);
#else
  float v = s - a;
  float err = (a - (s - v)) - (b + v);
#endif
  return vec2(s, err);
}

vec2 twoSqr(float a) {
  float prod = a * a;
  vec2 a_fp64 = split(a);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float err = ((a_fp64.x * a_fp64.x - prod) * fp64.ONE + 2.0 * a_fp64.x *
    a_fp64.y * fp64.ONE * fp64.ONE) + a_fp64.y * a_fp64.y * fp64.ONE * fp64.ONE * fp64.ONE;
#else
  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;
#endif
  return vec2(prod, err);
}

vec2 twoProd(float a, float b) {
  float prod = a * b;
  vec2 a_fp64 = split(a);
  vec2 b_fp64 = split(b);
  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +
    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;
  return vec2(prod, err);
}

vec2 sum_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSum(a.x, b.x);
  t = twoSum(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 sub_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSub(a.x, b.x);
  t = twoSub(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 mul_fp64(vec2 a, vec2 b) {
  vec2 prod = twoProd(a.x, b.x);
  // y component is for the error
  prod.y += a.x * b.y;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  prod.y += a.y * b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  return prod;
}

vec2 div_fp64(vec2 a, vec2 b) {
  float xn = 1.0 / b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  vec2 yn = mul_fp64(a, vec2(xn, 0));
#else
  vec2 yn = a * xn;
#endif
  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;
  vec2 prod = twoProd(xn, diff);
  return sum_fp64(yn, prod);
}

vec2 sqrt_fp64(vec2 a) {
  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);
  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);

  float x = 1.0 / sqrt(a.x);
  float yn = a.x * x;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  vec2 yn_sqr = twoSqr(yn) * fp64.ONE;
#else
  vec2 yn_sqr = twoSqr(yn);
#endif
  float diff = sub_fp64(a, yn_sqr).x;
  vec2 prod = twoProd(x * 0.5, diff);
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  return sum_fp64(split(yn), prod);
#else
  return sum_fp64(vec2(yn, 0.0), prod);
#endif
}
`,Aye={ONE:1},xye={name:"fp64arithmetic",vs:vye,defaultUniforms:Aye,uniformTypes:{ONE:"f32"},fp64ify:gK,fp64LowPart:mye,fp64ifyMatrix4:yye},wye=[0,1,1,1],Cye=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

out vec4 picking_vRGBcolor_Avalid;

// Normalize unsigned byte color to 0-1 range
vec3 picking_normalizeColor(vec3 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

// Normalize unsigned byte color to 0-1 range
vec4 picking_normalizeColor(vec4 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

bool picking_isColorZero(vec3 color) {
  return dot(color, vec3(1.0)) < 0.00001;
}

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.00001;
}

// Check if this vertex is highlighted 
bool isVertexHighlighted(vec3 vertexColor) {
  vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);
  return
    bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));
}

// Set the current picking color
void picking_setPickingColor(vec3 pickingColor) {
  pickingColor = picking_normalizeColor(pickingColor);

  if (bool(picking.isActive)) {
    // Use alpha as the validity flag. If pickingColor is [0, 0, 0] fragment is non-pickable
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!bool(picking.isAttribute)) {
      // Stores the picking color so that the fragment shader can render it during picking
      picking_vRGBcolor_Avalid.rgb = pickingColor;
    }
  } else {
    // Do the comparison with selected item color in vertex shader as it should mean fewer compares
    picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.r = value;
  }
}

void picking_setPickingAttribute(vec2 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}

void picking_setPickingAttribute(vec3 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,Tye=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

in vec4 picking_vRGBcolor_Avalid;

/*
 * Returns highlight color if this item is selected.
 */
vec4 picking_filterHighlightColor(vec4 color) {
  // If we are still picking, we don't highlight
  if (picking.isActive > 0.5) {
    return color;
  }

  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    // Blend in highlight color based on its alpha value
    float highLightAlpha = picking.highlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 picking_filterPickingColor(vec4 color) {
  if (bool(picking.isActive)) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 picking_filterColor(vec4 color) {
  vec4 highlightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highlightColor);
}
`,j6={props:{},uniforms:{},name:"picking",uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:wye},vs:Cye,fs:Tye,getUniforms:Sye};function Sye(r={},e){const t={};if(r.highlightedObjectColor!==void 0)if(r.highlightedObjectColor===null)t.isHighlightActive=!1;else{t.isHighlightActive=!0;const n=r.highlightedObjectColor.slice(0,3);t.highlightedObjectColor=n}if(r.highlightColor){const n=Array.from(r.highlightColor,i=>i/255);Number.isFinite(n[3])||(n[3]=1),t.highlightColor=n}return r.isActive!==void 0&&(t.isActive=!!r.isActive,t.isAttribute=!!r.isAttribute),r.useFloatColors!==void 0&&(t.useFloatColors=!!r.useFloatColors),t}const G6=`precision highp int;

// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
  vec3 color;
};

struct PointLight {
  vec3 color;
  vec3 position;
  vec3 attenuation; // 2nd order x:Constant-y:Linear-z:Exponential
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform lightingUniforms {
  int enabled;
  int lightType;

  int directionalLightCount;
  int pointLightCount;

  vec3 ambientColor;

  vec3 lightColor0;
  vec3 lightPosition0;
  vec3 lightDirection0;
  vec3 lightAttenuation0;

  vec3 lightColor1;
  vec3 lightPosition1;
  vec3 lightDirection1;
  vec3 lightAttenuation1;

  vec3 lightColor2;
  vec3 lightPosition2;
  vec3 lightDirection2;
  vec3 lightAttenuation2;
} lighting;

PointLight lighting_getPointLight(int index) {
  switch (index) {
    case 0:
      return PointLight(lighting.lightColor0, lighting.lightPosition0, lighting.lightAttenuation0);
    case 1:
      return PointLight(lighting.lightColor1, lighting.lightPosition1, lighting.lightAttenuation1);
    case 2:
    default:  
      return PointLight(lighting.lightColor2, lighting.lightPosition2, lighting.lightAttenuation2);
  }
}

DirectionalLight lighting_getDirectionalLight(int index) {
  switch (index) {
    case 0:
      return DirectionalLight(lighting.lightColor0, lighting.lightDirection0);
    case 1:
      return DirectionalLight(lighting.lightColor1, lighting.lightDirection1);
    case 2:
    default:   
      return DirectionalLight(lighting.lightColor2, lighting.lightDirection2);
  }
} 

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

// #endif
`,Eye=`// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
  color: vec3<f32>,
};

struct PointLight {
  color: vec3<f32>,
  position: vec3<f32>,
  attenuation: vec3<f32>, // 2nd order x:Constant-y:Linear-z:Exponential
};

struct DirectionalLight {
  color: vec3<f32>,
  direction: vec3<f32>,
};

struct lightingUniforms {
  enabled: i32,
  pointLightCount: i32,
  directionalLightCount: i32,

  ambientColor: vec3<f32>,

  // TODO - support multiple lights by uncommenting arrays below
  lightType: i32,
  lightColor: vec3<f32>,
  lightDirection: vec3<f32>,
  lightPosition: vec3<f32>,
  lightAttenuation: vec3<f32>,

  // AmbientLight ambientLight;
  // PointLight pointLight[MAX_LIGHTS];
  // DirectionalLight directionalLight[MAX_LIGHTS];
};

// Binding 0:1 is reserved for lighting (Note: could go into separate bind group as it is stable across draw calls)
@binding(1) @group(0) var<uniform> lighting : lightingUniforms;

fn lighting_getPointLight(index: i32) -> PointLight {
  return PointLight(lighting.lightColor, lighting.lightPosition, lighting.lightAttenuation);
}

fn lighting_getDirectionalLight(index: i32) -> DirectionalLight {
  return DirectionalLight(lighting.lightColor, lighting.lightDirection);
} 

fn getPointLightAttenuation(pointLight: PointLight, distance: f32) -> f32 {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}
`,Iye=5,Pye=255;var G_;(function(r){r[r.POINT=0]="POINT",r[r.DIRECTIONAL=1]="DIRECTIONAL"})(G_||(G_={}));const Lm={props:{},uniforms:{},name:"lighting",defines:{},uniformTypes:{enabled:"i32",lightType:"i32",directionalLightCount:"i32",pointLightCount:"i32",ambientColor:"vec3<f32>",lightColor0:"vec3<f32>",lightPosition0:"vec3<f32>",lightDirection0:"vec3<f32>",lightAttenuation0:"vec3<f32>",lightColor1:"vec3<f32>",lightPosition1:"vec3<f32>",lightDirection1:"vec3<f32>",lightAttenuation1:"vec3<f32>",lightColor2:"vec3<f32>",lightPosition2:"vec3<f32>",lightDirection2:"vec3<f32>",lightAttenuation2:"vec3<f32>"},defaultUniforms:{enabled:1,lightType:G_.POINT,directionalLightCount:0,pointLightCount:0,ambientColor:[.1,.1,.1],lightColor0:[1,1,1],lightPosition0:[1,1,2],lightDirection0:[1,1,1],lightAttenuation0:[1,0,0],lightColor1:[1,1,1],lightPosition1:[1,1,2],lightDirection1:[1,1,1],lightAttenuation1:[1,0,0],lightColor2:[1,1,1],lightPosition2:[1,1,2],lightDirection2:[1,1,1],lightAttenuation2:[1,0,0]},source:Eye,vs:G6,fs:G6,getUniforms:Bye};function Bye(r,e={}){if(r=r&&{...r},!r)return{...Lm.defaultUniforms};r.lights&&(r={...r,...Rye(r.lights),lights:void 0});const{ambientLight:t,pointLights:n,directionalLights:i}=r||{};if(!(t||n&&n.length>0||i&&i.length>0))return{...Lm.defaultUniforms,enabled:0};const a={...Lm.defaultUniforms,...e,...Mye({ambientLight:t,pointLights:n,directionalLights:i})};return r.enabled!==void 0&&(a.enabled=r.enabled?1:0),a}function Mye({ambientLight:r,pointLights:e=[],directionalLights:t=[]}){const n={};n.ambientColor=OI(r);let i=0;for(const s of e){n.lightType=G_.POINT;const a=i;n[`lightColor${a}`]=OI(s),n[`lightPosition${a}`]=s.position,n[`lightAttenuation${a}`]=s.attenuation||[1,0,0],i++}for(const s of t){n.lightType=G_.DIRECTIONAL;const a=i;n[`lightColor${a}`]=OI(s),n[`lightDirection${a}`]=s.direction,i++}return i>Iye&&Bt.warn("MAX_LIGHTS exceeded")(),n.directionalLightCount=t.length,n.pointLightCount=e.length,n}function Rye(r){const e={pointLights:[],directionalLights:[]};for(const t of r||[])switch(t.type){case"ambient":e.ambientLight=t;break;case"directional":e.directionalLights?.push(t);break;case"point":e.pointLights?.push(t);break}return e}function OI(r={}){const{color:e=[0,0,0],intensity:t=1}=r;return e.map(n=>n*t/Pye)}const mK=`uniform phongMaterialUniforms {
  uniform float ambient;
  uniform float diffuse;
  uniform float shininess;
  uniform vec3  specularColor;
} material;
`,yK=`#define MAX_LIGHTS 3

uniform phongMaterialUniforms {
  uniform float ambient;
  uniform float diffuse;
  uniform float shininess;
  uniform vec3  specularColor;
} material;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
  vec3 halfway_direction = normalize(light_direction + view_direction);
  float lambertian = dot(light_direction, normal_worldspace);
  float specular = 0.0;
  if (lambertian > 0.0) {
    float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
    specular = pow(specular_angle, material.shininess);
  }
  lambertian = max(lambertian, 0.0);
  return (lambertian * material.diffuse * surfaceColor + specular * material.specularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting.enabled == 0) {
    return lightColor;
  }

  vec3 view_direction = normalize(cameraPosition - position_worldspace);
  lightColor = material.ambient * surfaceColor * lighting.ambientColor;

  for (int i = 0; i < lighting.pointLightCount; i++) {
    PointLight pointLight = lighting_getPointLight(i);
    vec3 light_position_worldspace = pointLight.position;
    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
    float light_attenuation = getPointLightAttenuation(pointLight, distance(light_position_worldspace, position_worldspace));
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color / light_attenuation);
  }

  int totalLights = min(MAX_LIGHTS, lighting.pointLightCount + lighting.directionalLightCount);
  for (int i = lighting.pointLightCount; i < totalLights; i++) {
    DirectionalLight directionalLight = lighting_getDirectionalLight(i);
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  
  return lightColor;
}
`,bK=`struct phongMaterialUniforms {
  ambient: f32,
  diffuse: f32,
  shininess: f32,
  specularColor: vec3<f32>,
};

@binding(2) @group(0) var<uniform> phongMaterial : phongMaterialUniforms;

fn lighting_getLightColor(surfaceColor: vec3<f32>, light_direction: vec3<f32>, view_direction: vec3<f32>, normal_worldspace: vec3<f32>, color: vec3<f32>) -> vec3<f32> {
  let halfway_direction: vec3<f32> = normalize(light_direction + view_direction);
  var lambertian: f32 = dot(light_direction, normal_worldspace);
  var specular: f32 = 0.0;
  if (lambertian > 0.0) {
    let specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
    specular = pow(specular_angle, phongMaterial.shininess);
  }
  lambertian = max(lambertian, 0.0);
  return (lambertian * phongMaterial.diffuse * surfaceColor + specular * phongMaterial.specularColor) * color;
}

fn lighting_getLightColor2(surfaceColor: vec3<f32>, cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32> {
  var lightColor: vec3<f32> = surfaceColor;

  if (lighting.enabled == 0) {
    return lightColor;
  }

  let view_direction: vec3<f32> = normalize(cameraPosition - position_worldspace);
  lightColor = phongMaterial.ambient * surfaceColor * lighting.ambientColor;

  if (lighting.lightType == 0) {
    let pointLight: PointLight  = lighting_getPointLight(0);
    let light_position_worldspace: vec3<f32> = pointLight.position;
    let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
  } else if (lighting.lightType == 1) {
    var directionalLight: DirectionalLight = lighting_getDirectionalLight(0);
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  
  return lightColor;
  /*
  for (int i = 0; i < MAX_LIGHTS; i++) {
    if (i >= lighting.pointLightCount) {
      break;
    }
    PointLight pointLight = lighting.pointLight[i];
    vec3 light_position_worldspace = pointLight.position;
    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
  }

  for (int i = 0; i < MAX_LIGHTS; i++) {
    if (i >= lighting.directionalLightCount) {
      break;
    }
    DirectionalLight directionalLight = lighting.directionalLight[i];
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  */
}

fn lighting_getSpecularLightColor(cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32>{
  var lightColor = vec3<f32>(0, 0, 0);
  let surfaceColor = vec3<f32>(0, 0, 0);

  if (lighting.enabled == 0) {
    let view_direction = normalize(cameraPosition - position_worldspace);

    switch (lighting.lightType) {
      case 0, default: {
        let pointLight: PointLight = lighting_getPointLight(0);
        let light_position_worldspace: vec3<f32> = pointLight.position;
        let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);
        lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
      }
      case 1: {
        let directionalLight: DirectionalLight = lighting_getDirectionalLight(0);
        lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
      }
    }
  }
  return lightColor;
}
`,LS={props:{},name:"gouraudMaterial",vs:yK.replace("phongMaterial","gouraudMaterial"),fs:mK.replace("phongMaterial","gouraudMaterial"),source:bK.replaceAll("phongMaterial","gouraudMaterial"),defines:{LIGHTING_VERTEX:!0},dependencies:[Lm],uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(r){const e={...r};return e.specularColor&&(e.specularColor=e.specularColor.map(t=>t/255)),{...LS.defaultUniforms,...e}}},gO={name:"phongMaterial",dependencies:[Lm],source:bK,vs:mK,fs:yK,defines:{LIGHTING_FRAGMENT:!0},uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(r){const e={...r};return e.specularColor&&(e.specularColor=e.specularColor.map(t=>t/255)),{...gO.defaultUniforms,...e}}},kye=`out vec3 pbr_vPosition;
out vec2 pbr_vUV;

#ifdef HAS_NORMALS
# ifdef HAS_TANGENTS
out mat3 pbr_vTBN;
# else
out vec3 pbr_vNormal;
# endif
#endif

void pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)
{
  vec4 pos = pbrProjection.modelMatrix * position;
  pbr_vPosition = vec3(pos.xyz) / pos.w;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
  vec3 normalW = normalize(vec3(pbrProjection.normalMatrix * vec4(normal.xyz, 0.0)));
  vec3 tangentW = normalize(vec3(pbrProjection.modelMatrix * vec4(tangent.xyz, 0.0)));
  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;
  pbr_vTBN = mat3(tangentW, bitangentW, normalW);
#else // HAS_TANGENTS != 1
  pbr_vNormal = normalize(vec3(pbrProjection.modelMatrix * vec4(normal.xyz, 0.0)));
#endif
#endif

#ifdef HAS_UV
  pbr_vUV = uv;
#else
  pbr_vUV = vec2(0.,0.);
#endif
}
`,Oye=`precision highp float;

uniform pbrMaterialUniforms {
  // Material is unlit
  bool unlit;

  // Base color map
  bool baseColorMapEnabled;
  vec4 baseColorFactor;

  bool normalMapEnabled;  
  float normalScale; // #ifdef HAS_NORMALMAP

  bool emissiveMapEnabled;
  vec3 emissiveFactor; // #ifdef HAS_EMISSIVEMAP

  vec2 metallicRoughnessValues;
  bool metallicRoughnessMapEnabled;

  bool occlusionMapEnabled;
  float occlusionStrength; // #ifdef HAS_OCCLUSIONMAP
  
  bool alphaCutoffEnabled;
  float alphaCutoff; // #ifdef ALPHA_CUTOFF
  
  // IBL
  bool IBLenabled;
  vec2 scaleIBLAmbient; // #ifdef USE_IBL
  
  // debugging flags used for shader output of intermediate PBR variables
  // #ifdef PBR_DEBUG
  vec4 scaleDiffBaseMR;
  vec4 scaleFGDSpec;
  // #endif
} pbrMaterial;

// Samplers
#ifdef HAS_BASECOLORMAP
uniform sampler2D pbr_baseColorSampler;
#endif
#ifdef HAS_NORMALMAP
uniform sampler2D pbr_normalSampler;
#endif
#ifdef HAS_EMISSIVEMAP
uniform sampler2D pbr_emissiveSampler;
#endif
#ifdef HAS_METALROUGHNESSMAP
uniform sampler2D pbr_metallicRoughnessSampler;
#endif
#ifdef HAS_OCCLUSIONMAP
uniform sampler2D pbr_occlusionSampler;
#endif
#ifdef USE_IBL
uniform samplerCube pbr_diffuseEnvSampler;
uniform samplerCube pbr_specularEnvSampler;
uniform sampler2D pbr_brdfLUT;
#endif

// Inputs from vertex shader

in vec3 pbr_vPosition;
in vec2 pbr_vUV;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
in mat3 pbr_vTBN;
#else
in vec3 pbr_vNormal;
#endif
#endif

// Encapsulate the various inputs used by the various functions in the shading equation
// We store values in this struct to simplify the integration of alternative implementations
// of the shading terms, outlined in the Readme.MD Appendix.
struct PBRInfo {
  float NdotL;                  // cos angle between normal and light direction
  float NdotV;                  // cos angle between normal and view direction
  float NdotH;                  // cos angle between normal and half vector
  float LdotH;                  // cos angle between light direction and half vector
  float VdotH;                  // cos angle between view direction and half vector
  float perceptualRoughness;    // roughness value, as authored by the model creator (input to shader)
  float metalness;              // metallic value at the surface
  vec3 reflectance0;            // full reflectance color (normal incidence angle)
  vec3 reflectance90;           // reflectance color at grazing angle
  float alphaRoughness;         // roughness mapped to a more linear change in the roughness (proposed by [2])
  vec3 diffuseColor;            // color contribution from diffuse lighting
  vec3 specularColor;           // color contribution from specular lighting
  vec3 n;                       // normal at surface point
  vec3 v;                       // vector from surface point to camera
};

const float M_PI = 3.141592653589793;
const float c_MinRoughness = 0.04;

vec4 SRGBtoLINEAR(vec4 srgbIn)
{
#ifdef MANUAL_SRGB
#ifdef SRGB_FAST_APPROXIMATION
  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));
#else // SRGB_FAST_APPROXIMATION
  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);
  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );
#endif //SRGB_FAST_APPROXIMATION
  return vec4(linOut,srgbIn.w);;
#else //MANUAL_SRGB
  return srgbIn;
#endif //MANUAL_SRGB
}

// Find the normal for this fragment, pulling either from a predefined normal map
// or from the interpolated mesh normal and tangent attributes.
vec3 getNormal()
{
  // Retrieve the tangent space matrix
#ifndef HAS_TANGENTS
  vec3 pos_dx = dFdx(pbr_vPosition);
  vec3 pos_dy = dFdy(pbr_vPosition);
  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));
  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));
  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);

#ifdef HAS_NORMALS
  vec3 ng = normalize(pbr_vNormal);
#else
  vec3 ng = cross(pos_dx, pos_dy);
#endif

  t = normalize(t - ng * dot(ng, t));
  vec3 b = normalize(cross(ng, t));
  mat3 tbn = mat3(t, b, ng);
#else // HAS_TANGENTS
  mat3 tbn = pbr_vTBN;
#endif

#ifdef HAS_NORMALMAP
  vec3 n = texture(pbr_normalSampler, pbr_vUV).rgb;
  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(pbrMaterial.normalScale, pbrMaterial.normalScale, 1.0)));
#else
  // The tbn matrix is linearly interpolated, so we need to re-normalize
  vec3 n = normalize(tbn[2].xyz);
#endif

  return n;
}

// Calculation of the lighting contribution from an optional Image Based Light source.
// Precomputed Environment Maps are required uniform inputs and are computed as outlined in [1].
// See our README.md on Environment Maps [3] for additional discussion.
#ifdef USE_IBL
vec3 getIBLContribution(PBRInfo pbrInfo, vec3 n, vec3 reflection)
{
  float mipCount = 9.0; // resolution of 512x512
  float lod = (pbrInfo.perceptualRoughness * mipCount);
  // retrieve a scale and bias to F0. See [1], Figure 3
  vec3 brdf = SRGBtoLINEAR(texture(pbr_brdfLUT,
    vec2(pbrInfo.NdotV, 1.0 - pbrInfo.perceptualRoughness))).rgb;
  vec3 diffuseLight = SRGBtoLINEAR(texture(pbr_diffuseEnvSampler, n)).rgb;

#ifdef USE_TEX_LOD
  vec3 specularLight = SRGBtoLINEAR(texture(pbr_specularEnvSampler, reflection, lod)).rgb;
#else
  vec3 specularLight = SRGBtoLINEAR(texture(pbr_specularEnvSampler, reflection)).rgb;
#endif

  vec3 diffuse = diffuseLight * pbrInfo.diffuseColor;
  vec3 specular = specularLight * (pbrInfo.specularColor * brdf.x + brdf.y);

  // For presentation, this allows us to disable IBL terms
  diffuse *= pbrMaterial.scaleIBLAmbient.x;
  specular *= pbrMaterial.scaleIBLAmbient.y;

  return diffuse + specular;
}
#endif

// Basic Lambertian diffuse
// Implementation from Lambert's Photometria https://archive.org/details/lambertsphotome00lambgoog
// See also [1], Equation 1
vec3 diffuse(PBRInfo pbrInfo)
{
  return pbrInfo.diffuseColor / M_PI;
}

// The following equation models the Fresnel reflectance term of the spec equation (aka F())
// Implementation of fresnel from [4], Equation 15
vec3 specularReflection(PBRInfo pbrInfo)
{
  return pbrInfo.reflectance0 +
    (pbrInfo.reflectance90 - pbrInfo.reflectance0) *
    pow(clamp(1.0 - pbrInfo.VdotH, 0.0, 1.0), 5.0);
}

// This calculates the specular geometric attenuation (aka G()),
// where rougher material will reflect less light back to the viewer.
// This implementation is based on [1] Equation 4, and we adopt their modifications to
// alphaRoughness as input as originally proposed in [2].
float geometricOcclusion(PBRInfo pbrInfo)
{
  float NdotL = pbrInfo.NdotL;
  float NdotV = pbrInfo.NdotV;
  float r = pbrInfo.alphaRoughness;

  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));
  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));
  return attenuationL * attenuationV;
}

// The following equation(s) model the distribution of microfacet normals across
// the area being drawn (aka D())
// Implementation from "Average Irregularity Representation of a Roughened Surface
// for Ray Reflection" by T. S. Trowbridge, and K. P. Reitz
// Follows the distribution function recommended in the SIGGRAPH 2013 course notes
// from EPIC Games [1], Equation 3.
float microfacetDistribution(PBRInfo pbrInfo)
{
  float roughnessSq = pbrInfo.alphaRoughness * pbrInfo.alphaRoughness;
  float f = (pbrInfo.NdotH * roughnessSq - pbrInfo.NdotH) * pbrInfo.NdotH + 1.0;
  return roughnessSq / (M_PI * f * f);
}

void PBRInfo_setAmbientLight(inout PBRInfo pbrInfo) {
  pbrInfo.NdotL = 1.0;
  pbrInfo.NdotH = 0.0;
  pbrInfo.LdotH = 0.0;
  pbrInfo.VdotH = 1.0;
}

void PBRInfo_setDirectionalLight(inout PBRInfo pbrInfo, vec3 lightDirection) {
  vec3 n = pbrInfo.n;
  vec3 v = pbrInfo.v;
  vec3 l = normalize(lightDirection);             // Vector from surface point to light
  vec3 h = normalize(l+v);                        // Half vector between both l and v

  pbrInfo.NdotL = clamp(dot(n, l), 0.001, 1.0);
  pbrInfo.NdotH = clamp(dot(n, h), 0.0, 1.0);
  pbrInfo.LdotH = clamp(dot(l, h), 0.0, 1.0);
  pbrInfo.VdotH = clamp(dot(v, h), 0.0, 1.0);
}

void PBRInfo_setPointLight(inout PBRInfo pbrInfo, PointLight pointLight) {
  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);
  PBRInfo_setDirectionalLight(pbrInfo, light_direction);
}

vec3 calculateFinalColor(PBRInfo pbrInfo, vec3 lightColor) {
  // Calculate the shading terms for the microfacet specular shading model
  vec3 F = specularReflection(pbrInfo);
  float G = geometricOcclusion(pbrInfo);
  float D = microfacetDistribution(pbrInfo);

  // Calculation of analytical lighting contribution
  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInfo);
  vec3 specContrib = F * G * D / (4.0 * pbrInfo.NdotL * pbrInfo.NdotV);
  // Obtain final intensity as reflectance (BRDF) scaled by the energy of the light (cosine law)
  return pbrInfo.NdotL * lightColor * (diffuseContrib + specContrib);
}

vec4 pbr_filterColor(vec4 colorUnused)
{
  // The albedo may be defined from a base texture or a flat color
#ifdef HAS_BASECOLORMAP
  vec4 baseColor = SRGBtoLINEAR(texture(pbr_baseColorSampler, pbr_vUV)) * pbrMaterial.baseColorFactor;
#else
  vec4 baseColor = pbrMaterial.baseColorFactor;
#endif

#ifdef ALPHA_CUTOFF
  if (baseColor.a < pbrMaterial.alphaCutoff) {
    discard;
  }
#endif

  vec3 color = vec3(0, 0, 0);

  if(pbrMaterial.unlit){
    color.rgb = baseColor.rgb;
  }
  else{
    // Metallic and Roughness material properties are packed together
    // In glTF, these factors can be specified by fixed scalar values
    // or from a metallic-roughness map
    float perceptualRoughness = pbrMaterial.metallicRoughnessValues.y;
    float metallic = pbrMaterial.metallicRoughnessValues.x;
#ifdef HAS_METALROUGHNESSMAP
    // Roughness is stored in the 'g' channel, metallic is stored in the 'b' channel.
    // This layout intentionally reserves the 'r' channel for (optional) occlusion map data
    vec4 mrSample = texture(pbr_metallicRoughnessSampler, pbr_vUV);
    perceptualRoughness = mrSample.g * perceptualRoughness;
    metallic = mrSample.b * metallic;
#endif
    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);
    metallic = clamp(metallic, 0.0, 1.0);
    // Roughness is authored as perceptual roughness; as is convention,
    // convert to material roughness by squaring the perceptual roughness [2].
    float alphaRoughness = perceptualRoughness * perceptualRoughness;

    vec3 f0 = vec3(0.04);
    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);
    diffuseColor *= 1.0 - metallic;
    vec3 specularColor = mix(f0, baseColor.rgb, metallic);

    // Compute reflectance.
    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);

    // For typical incident reflectance range (between 4% to 100%) set the grazing
    // reflectance to 100% for typical fresnel effect.
    // For very low reflectance range on highly diffuse objects (below 4%),
    // incrementally reduce grazing reflecance to 0%.
    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);
    vec3 specularEnvironmentR0 = specularColor.rgb;
    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;

    vec3 n = getNormal();                          // normal at surface point
    vec3 v = normalize(pbrProjection.camera - pbr_vPosition);  // Vector from surface point to camera

    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);
    vec3 reflection = -normalize(reflect(v, n));

    PBRInfo pbrInfo = PBRInfo(
      0.0, // NdotL
      NdotV,
      0.0, // NdotH
      0.0, // LdotH
      0.0, // VdotH
      perceptualRoughness,
      metallic,
      specularEnvironmentR0,
      specularEnvironmentR90,
      alphaRoughness,
      diffuseColor,
      specularColor,
      n,
      v
    );


#ifdef USE_LIGHTS
    // Apply ambient light
    PBRInfo_setAmbientLight(pbrInfo);
    color += calculateFinalColor(pbrInfo, lighting.ambientColor);

    // Apply directional light
    for(int i = 0; i < lighting.directionalLightCount; i++) {
      if (i < lighting.directionalLightCount) {
        PBRInfo_setDirectionalLight(pbrInfo, lighting_getDirectionalLight(i).direction);
        color += calculateFinalColor(pbrInfo, lighting_getDirectionalLight(i).color);
      }
    }

    // Apply point light
    for(int i = 0; i < lighting.pointLightCount; i++) {
      if (i < lighting.pointLightCount) {
        PBRInfo_setPointLight(pbrInfo, lighting_getPointLight(i));
        float attenuation = getPointLightAttenuation(lighting_getPointLight(i), distance(lighting_getPointLight(i).position, pbr_vPosition));
        color += calculateFinalColor(pbrInfo, lighting_getPointLight(i).color / attenuation);
      }
    }
#endif

    // Calculate lighting contribution from image based lighting source (IBL)
#ifdef USE_IBL
    if (pbrMaterial.IBLenabled) {
      color += getIBLContribution(pbrInfo, n, reflection);
    }
#endif

 // Apply optional PBR terms for additional (optional) shading
#ifdef HAS_OCCLUSIONMAP
    if (pbrMaterial.occlusionMapEnabled) {
      float ao = texture(pbr_occlusionSampler, pbr_vUV).r;
      color = mix(color, color * ao, pbrMaterial.occlusionStrength);
    }
#endif

#ifdef HAS_EMISSIVEMAP
    if (pbrMaterial.emissiveMapEnabled) {
      vec3 emissive = SRGBtoLINEAR(texture(pbr_emissiveSampler, pbr_vUV)).rgb * pbrMaterial.emissiveFactor;
      color += emissive;
    }
#endif

    // This section uses mix to override final color for reference app visualization
    // of various parameters in the lighting equation.
#ifdef PBR_DEBUG
    // TODO: Figure out how to debug multiple lights

    // color = mix(color, F, pbr_scaleFGDSpec.x);
    // color = mix(color, vec3(G), pbr_scaleFGDSpec.y);
    // color = mix(color, vec3(D), pbr_scaleFGDSpec.z);
    // color = mix(color, specContrib, pbr_scaleFGDSpec.w);

    // color = mix(color, diffuseContrib, pbr_scaleDiffBaseMR.x);
    color = mix(color, baseColor.rgb, pbrMaterial.scaleDiffBaseMR.y);
    color = mix(color, vec3(metallic), pbrMaterial.scaleDiffBaseMR.z);
    color = mix(color, vec3(perceptualRoughness), pbrMaterial.scaleDiffBaseMR.w);
#endif

  }

  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);
}
`,Dye=`struct PBRFragmentInputs {
  pbr_vPosition: vec3f,
  pbr_vUV: vec2f,
  pbr_vTBN: mat3f,
  pbr_vNormal: vec3f
};

var fragmentInputs: PBRFragmentInputs;

fn pbr_setPositionNormalTangentUV(position: vec4f, normal: vec4f, tangent: vec4f, uv: vec2f)
{
  var pos: vec4f = pbrProjection.modelMatrix * position;
  pbr_vPosition = vec3(pos.xyz) / pos.w;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
  let normalW: vec3f = normalize(vec3(pbrProjection.normalMatrix * vec4(normal.xyz, 0.0)));
  let tangentW: vec3f = normalize(vec3(pbrProjection.modelMatrix * vec4(tangent.xyz, 0.0)));
  let bitangentW: vec3f = cross(normalW, tangentW) * tangent.w;
  fragmentInputs,pbr_vTBN = mat3(tangentW, bitangentW, normalW);
#else // HAS_TANGENTS != 1
  fragmentInputs.pbr_vNormal = normalize(vec3(pbrProjection.modelMatrix * vec4(normal.xyz, 0.0)));
#endif
#endif

#ifdef HAS_UV
  pbr_vUV = uv;
#else
  pbr_vUV = vec2(0.,0.);
#endif
}

struct pbrMaterialUniforms {
  // Material is unlit
  unlit: uint32,

  // Base color map
  baseColorMapEnabled: uint32,
  baseColorFactor: vec4f,

  normalMapEnabled : uint32,
  normalScale: f32,  // #ifdef HAS_NORMALMAP

  emissiveMapEnabled: uint32,
  emissiveFactor: vec3f, // #ifdef HAS_EMISSIVEMAP

  metallicRoughnessValues: vec2f,
  metallicRoughnessMapEnabled: uint32,

  occlusionMapEnabled: i32,
  occlusionStrength: f32, // #ifdef HAS_OCCLUSIONMAP
  
  alphaCutoffEnabled: i32,
  alphaCutoff: f32, // #ifdef ALPHA_CUTOFF
  
  // IBL
  IBLenabled: i32,
  scaleIBLAmbient: vec2f, // #ifdef USE_IBL
  
  // debugging flags used for shader output of intermediate PBR variables
  // #ifdef PBR_DEBUG
  scaleDiffBaseMR: vec4f,
  scaleFGDSpec: vec4f
  // #endif
} 
  
@binding(2) @group(0) var<uniform> material : pbrMaterialUniforms;

// Samplers
#ifdef HAS_BASECOLORMAP
uniform sampler2D pbr_baseColorSampler;
#endif
#ifdef HAS_NORMALMAP
uniform sampler2D pbr_normalSampler;
#endif
#ifdef HAS_EMISSIVEMAP
uniform sampler2D pbr_emissiveSampler;
#endif
#ifdef HAS_METALROUGHNESSMAP
uniform sampler2D pbr_metallicRoughnessSampler;
#endif
#ifdef HAS_OCCLUSIONMAP
uniform sampler2D pbr_occlusionSampler;
#endif
#ifdef USE_IBL
uniform samplerCube pbr_diffuseEnvSampler;
uniform samplerCube pbr_specularEnvSampler;
uniform sampler2D pbr_brdfLUT;
#endif

// Encapsulate the various inputs used by the various functions in the shading equation
// We store values in this struct to simplify the integration of alternative implementations
// of the shading terms, outlined in the Readme.MD Appendix.
struct PBRInfo {
  NdotL: f32,                  // cos angle between normal and light direction
  NdotV: f32,                  // cos angle between normal and view direction
  NdotH: f32,                  // cos angle between normal and half vector
  LdotH: f32,                  // cos angle between light direction and half vector
  VdotH: f32,                  // cos angle between view direction and half vector
  perceptualRoughness: f32,    // roughness value, as authored by the model creator (input to shader)
  metalness: f32,              // metallic value at the surface
  reflectance0: vec3f,            // full reflectance color (normal incidence angle)
  reflectance90: vec3f,           // reflectance color at grazing angle
  alphaRoughness: f32,         // roughness mapped to a more linear change in the roughness (proposed by [2])
  diffuseColor: vec3f,            // color contribution from diffuse lighting
  specularColor: vec3f,           // color contribution from specular lighting
  n: vec3f,                       // normal at surface point
  v: vec3f,                       // vector from surface point to camera
};

const M_PI = 3.141592653589793;
const c_MinRoughness = 0.04;

fn SRGBtoLINEAR(srgbIn: vec4f ) -> vec4f
{
#ifdef MANUAL_SRGB
#ifdef SRGB_FAST_APPROXIMATION
  var linOut: vec3f = pow(srgbIn.xyz,vec3(2.2));
#else // SRGB_FAST_APPROXIMATION
  var bLess: vec3f = step(vec3(0.04045),srgbIn.xyz);
  var linOut: vec3f = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );
#endif //SRGB_FAST_APPROXIMATION
  return vec4f(linOut,srgbIn.w);;
#else //MANUAL_SRGB
  return srgbIn;
#endif //MANUAL_SRGB
}

// Find the normal for this fragment, pulling either from a predefined normal map
// or from the interpolated mesh normal and tangent attributes.
fn getNormal() -> vec3f
{
  // Retrieve the tangent space matrix
#ifndef HAS_TANGENTS
  var pos_dx: vec3f = dFdx(pbr_vPosition);
  var pos_dy: vec3f = dFdy(pbr_vPosition);
  var tex_dx: vec3f = dFdx(vec3(pbr_vUV, 0.0));
  var tex_dy: vec3f = dFdy(vec3(pbr_vUV, 0.0));
  var t: vec3f = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);

#ifdef HAS_NORMALS
  var ng: vec3f = normalize(pbr_vNormal);
#else
  var ng: vec3f = cross(pos_dx, pos_dy);
#endif

  t = normalize(t - ng * dot(ng, t));
  var b: vec3f = normalize(cross(ng, t));
  var tbn: mat3f = mat3f(t, b, ng);
#else // HAS_TANGENTS
  var tbn: mat3f = pbr_vTBN;
#endif

#ifdef HAS_NORMALMAP
  vec3 n = texture(pbr_normalSampler, pbr_vUV).rgb;
  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(pbrMaterial.normalScale, pbrMaterial.normalScale, 1.0)));
#else
  // The tbn matrix is linearly interpolated, so we need to re-normalize
  vec3 n = normalize(tbn[2].xyz);
#endif

  return n;
}

// Calculation of the lighting contribution from an optional Image Based Light source.
// Precomputed Environment Maps are required uniform inputs and are computed as outlined in [1].
// See our README.md on Environment Maps [3] for additional discussion.
#ifdef USE_IBL
fn getIBLContribution(PBRInfo pbrInfo, vec3 n, vec3 reflection) -> vec3f
{
  float mipCount = 9.0; // resolution of 512x512
  float lod = (pbrInfo.perceptualRoughness * mipCount);
  // retrieve a scale and bias to F0. See [1], Figure 3
  vec3 brdf = SRGBtoLINEAR(texture(pbr_brdfLUT,
    vec2(pbrInfo.NdotV, 1.0 - pbrInfo.perceptualRoughness))).rgb;
  vec3 diffuseLight = SRGBtoLINEAR(texture(pbr_diffuseEnvSampler, n)).rgb;

#ifdef USE_TEX_LOD
  vec3 specularLight = SRGBtoLINEAR(texture(pbr_specularEnvSampler, reflection, lod)).rgb;
#else
  vec3 specularLight = SRGBtoLINEAR(texture(pbr_specularEnvSampler, reflection)).rgb;
#endif

  vec3 diffuse = diffuseLight * pbrInfo.diffuseColor;
  vec3 specular = specularLight * (pbrInfo.specularColor * brdf.x + brdf.y);

  // For presentation, this allows us to disable IBL terms
  diffuse *= pbrMaterial.scaleIBLAmbient.x;
  specular *= pbrMaterial.scaleIBLAmbient.y;

  return diffuse + specular;
}
#endif

// Basic Lambertian diffuse
// Implementation from Lambert's Photometria https://archive.org/details/lambertsphotome00lambgoog
// See also [1], Equation 1
fn diffuse(pbrInfo: PBRInfo) -> vec3<f32> {
  return pbrInfo.diffuseColor / PI;
}

// The following equation models the Fresnel reflectance term of the spec equation (aka F())
// Implementation of fresnel from [4], Equation 15
fn specularReflection(pbrInfo: PBRInfo) -> vec3<f32> {
  return pbrInfo.reflectance0 +
    (pbrInfo.reflectance90 - pbrInfo.reflectance0) *
    pow(clamp(1.0 - pbrInfo.VdotH, 0.0, 1.0), 5.0);
}

// This calculates the specular geometric attenuation (aka G()),
// where rougher material will reflect less light back to the viewer.
// This implementation is based on [1] Equation 4, and we adopt their modifications to
// alphaRoughness as input as originally proposed in [2].
fn geometricOcclusion(pbrInfo: PBRInfo) -> f32 {
  let NdotL: f32 = pbrInfo.NdotL;
  let NdotV: f32 = pbrInfo.NdotV;
  let r: f32 = pbrInfo.alphaRoughness;

  let attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));
  let attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));
  return attenuationL * attenuationV;
}

// The following equation(s) model the distribution of microfacet normals across
// the area being drawn (aka D())
// Implementation from "Average Irregularity Representation of a Roughened Surface
// for Ray Reflection" by T. S. Trowbridge, and K. P. Reitz
// Follows the distribution function recommended in the SIGGRAPH 2013 course notes
// from EPIC Games [1], Equation 3.
fn microfacetDistribution(pbrInfo: PBRInfo) -> f32 {
  let roughnessSq = pbrInfo.alphaRoughness * pbrInfo.alphaRoughness;
  let f = (pbrInfo.NdotH * roughnessSq - pbrInfo.NdotH) * pbrInfo.NdotH + 1.0;
  return roughnessSq / (PI * f * f);
}

fn PBRInfo_setAmbientLight(pbrInfo: ptr<function, PBRInfo>) {
  (*pbrInfo).NdotL = 1.0;
  (*pbrInfo).NdotH = 0.0;
  (*pbrInfo).LdotH = 0.0;
  (*pbrInfo).VdotH = 1.0;
}

fn PBRInfo_setDirectionalLight(pbrInfo: ptr<function, PBRInfo>, lightDirection: vec3<f32>) {
  let n = (*pbrInfo).n;
  let v = (*pbrInfo).v;
  let l = normalize(lightDirection);             // Vector from surface point to light
  let h = normalize(l + v);                      // Half vector between both l and v

  (*pbrInfo).NdotL = clamp(dot(n, l), 0.001, 1.0);
  (*pbrInfo).NdotH = clamp(dot(n, h), 0.0, 1.0);
  (*pbrInfo).LdotH = clamp(dot(l, h), 0.0, 1.0);
  (*pbrInfo).VdotH = clamp(dot(v, h), 0.0, 1.0);
}

fn PBRInfo_setPointLight(pbrInfo: ptr<function, PBRInfo>, pointLight: PointLight) {
  let light_direction = normalize(pointLight.position - pbr_vPosition);
  PBRInfo_setDirectionalLight(pbrInfo, light_direction);
}

fn calculateFinalColor(pbrInfo: PBRInfo, lightColor: vec3<f32>) -> vec3<f32> {
  // Calculate the shading terms for the microfacet specular shading model
  let F = specularReflection(pbrInfo);
  let G = geometricOcclusion(pbrInfo);
  let D = microfacetDistribution(pbrInfo);

  // Calculation of analytical lighting contribution
  let diffuseContrib = (1.0 - F) * diffuse(pbrInfo);
  let specContrib = F * G * D / (4.0 * pbrInfo.NdotL * pbrInfo.NdotV);
  // Obtain final intensity as reflectance (BRDF) scaled by the energy of the light (cosine law)
  return pbrInfo.NdotL * lightColor * (diffuseContrib + specContrib);
}

fn pbr_filterColor(colorUnused: vec4<f32>) -> vec4<f32> {
  // The albedo may be defined from a base texture or a flat color
  var baseColor: vec4<f32>;
  #ifdef HAS_BASECOLORMAP
  baseColor = SRGBtoLINEAR(textureSample(pbr_baseColorSampler, pbr_baseColorSampler, pbr_vUV)) * pbrMaterial.baseColorFactor;
  #else
  baseColor = pbrMaterial.baseColorFactor;
  #endif

  #ifdef ALPHA_CUTOFF
  if (baseColor.a < pbrMaterial.alphaCutoff) {
    discard;
  }
  #endif

  var color = vec3<f32>(0.0, 0.0, 0.0);

  if (pbrMaterial.unlit) {
    color = baseColor.rgb;
  } else {
    // Metallic and Roughness material properties are packed together
    // In glTF, these factors can be specified by fixed scalar values
    // or from a metallic-roughness map
    var perceptualRoughness = pbrMaterial.metallicRoughnessValues.y;
    var metallic = pbrMaterial.metallicRoughnessValues.x;
    #ifdef HAS_METALROUGHNESSMAP
    // Roughness is stored in the 'g' channel, metallic is stored in the 'b' channel.
    // This layout intentionally reserves the 'r' channel for (optional) occlusion map data
    let mrSample = textureSample(pbr_metallicRoughnessSampler, pbr_metallicRoughnessSampler, pbr_vUV);
    perceptualRoughness = mrSample.g * perceptualRoughness;
    metallic = mrSample.b * metallic;
    #endif
    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);
    metallic = clamp(metallic, 0.0, 1.0);
    // Roughness is authored as perceptual roughness; as is convention,
    // convert to material roughness by squaring the perceptual roughness [2].
    let alphaRoughness = perceptualRoughness * perceptualRoughness;

    let f0 = vec3<f32>(0.04);
    var diffuseColor = baseColor.rgb * (vec3<f32>(1.0) - f0);
    diffuseColor *= 1.0 - metallic;
    let specularColor = mix(f0, baseColor.rgb, metallic);

    // Compute reflectance.
    let reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);

    // For typical incident reflectance range (between 4% to 100%) set the grazing
    // reflectance to 100% for typical fresnel effect.
    // For very low reflectance range on highly diffuse objects (below 4%),
    // incrementally reduce grazing reflectance to 0%.
    let reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);
    let specularEnvironmentR0 = specularColor;
    let specularEnvironmentR90 = vec3<f32>(1.0, 1.0, 1.0) * reflectance90;

    let n = getNormal();                          // normal at surface point
    let v = normalize(pbrProjection.camera - pbr_vPosition);  // Vector from surface point to camera

    let NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);
    let reflection = -normalize(reflect(v, n));

    var pbrInfo = PBRInfo(
      0.0, // NdotL
      NdotV,
      0.0, // NdotH
      0.0, // LdotH
      0.0, // VdotH
      perceptualRoughness,
      metallic,
      specularEnvironmentR0,
      specularEnvironmentR90,
      alphaRoughness,
      diffuseColor,
      specularColor,
      n,
      v
    );

    #ifdef USE_LIGHTS
    // Apply ambient light
    PBRInfo_setAmbientLight(&pbrInfo);
    color += calculateFinalColor(pbrInfo, lighting.ambientColor);

    // Apply directional light
    for (var i = 0; i < lighting.directionalLightCount; i++) {
      if (i < lighting.directionalLightCount) {
        PBRInfo_setDirectionalLight(&pbrInfo, lighting_getDirectionalLight(i).direction);
        color += calculateFinalColor(pbrInfo, lighting_getDirectionalLight(i).color);
      }
    }

    // Apply point light
    for (var i = 0; i < lighting.pointLightCount; i++) {
      if (i < lighting.pointLightCount) {
        PBRInfo_setPointLight(&pbrInfo, lighting_getPointLight(i));
        let attenuation = getPointLightAttenuation(lighting_getPointLight(i), distance(lighting_getPointLight(i).position, pbr_vPosition));
        color += calculateFinalColor(pbrInfo, lighting_getPointLight(i).color / attenuation);
      }
    }
    #endif

    // Calculate lighting contribution from image based lighting source (IBL)
    #ifdef USE_IBL
    if (pbrMaterial.IBLenabled) {
      color += getIBLContribution(pbrInfo, n, reflection);
    }
    #endif

    // Apply optional PBR terms for additional (optional) shading
    #ifdef HAS_OCCLUSIONMAP
    if (pbrMaterial.occlusionMapEnabled) {
      let ao = textureSample(pbr_occlusionSampler, pbr_occlusionSampler, pbr_vUV).r;
      color = mix(color, color * ao, pbrMaterial.occlusionStrength);
    }
    #endif

    #ifdef HAS_EMISSIVEMAP
    if (pbrMaterial.emissiveMapEnabled) {
      let emissive = SRGBtoLINEAR(textureSample(pbr_emissiveSampler, pbr_emissiveSampler, pbr_vUV)).rgb * pbrMaterial.emissiveFactor;
      color += emissive;
    }
    #endif

    // This section uses mix to override final color for reference app visualization
    // of various parameters in the lighting equation.
    #ifdef PBR_DEBUG
    // TODO: Figure out how to debug multiple lights

    // color = mix(color, F, pbr_scaleFGDSpec.x);
    // color = mix(color, vec3(G), pbr_scaleFGDSpec.y);
    // color = mix(color, vec3(D), pbr_scaleFGDSpec.z);
    // color = mix(color, specContrib, pbr_scaleFGDSpec.w);

    // color = mix(color, diffuseContrib, pbr_scaleDiffBaseMR.x);
    color = mix(color, baseColor.rgb, pbrMaterial.scaleDiffBaseMR.y);
    color = mix(color, vec3<f32>(metallic), pbrMaterial.scaleDiffBaseMR.z);
    color = mix(color, vec3<f32>(perceptualRoughness), pbrMaterial.scaleDiffBaseMR.w);
    #endif
  }

  return vec4<f32>(pow(color, vec3<f32>(1.0 / 2.2)), baseColor.a);
}
`,H6=`uniform pbrProjectionUniforms {
  mat4 modelViewProjectionMatrix;
  mat4 modelMatrix;
  mat4 normalMatrix;
  vec3 camera;
} pbrProjection;
`,Lye={name:"pbrProjection",vs:H6,fs:H6,getUniforms:r=>r,uniformTypes:{modelViewProjectionMatrix:"mat4x4<f32>",modelMatrix:"mat4x4<f32>",normalMatrix:"mat4x4<f32>",camera:"vec3<i32>"}},mO={props:{},uniforms:{},name:"pbrMaterial",dependencies:[Lm,Lye],source:Dye,vs:kye,fs:Oye,defines:{LIGHTING_FRAGMENT:!0,HAS_NORMALMAP:!1,HAS_EMISSIVEMAP:!1,HAS_OCCLUSIONMAP:!1,HAS_BASECOLORMAP:!1,HAS_METALROUGHNESSMAP:!1,ALPHA_CUTOFF:!1,USE_IBL:!1,PBR_DEBUG:!1},getUniforms:r=>r,uniformTypes:{unlit:"i32",baseColorMapEnabled:"i32",baseColorFactor:"vec4<f32>",normalMapEnabled:"i32",normalScale:"f32",emissiveMapEnabled:"i32",emissiveFactor:"vec3<f32>",metallicRoughnessValues:"vec2<f32>",metallicRoughnessMapEnabled:"i32",occlusionMapEnabled:"i32",occlusionStrength:"f32",alphaCutoffEnabled:"i32",alphaCutoff:"f32",IBLenabled:"i32",scaleIBLAmbient:"vec2<f32>",scaleDiffBaseMR:"vec4<f32>",scaleFGDSpec:"vec4<f32>"}},W6=`uniform layerUniforms {
  uniform float opacity;
} layer;
`,Nye={name:"layer",vs:W6,fs:W6,getUniforms:r=>({opacity:Math.pow(r.opacity,1/2.2)}),uniformTypes:{opacity:"f32"}},Fye=`

struct ColorUniforms {
  opacity: f32,
};

var<private> color: ColorUniforms = ColorUniforms(1.0);
// TODO (kaapp) avoiding binding index collisions to handle layer opacity 
// requires some thought.
// @group(0) @binding(0) var<uniform> color: ColorUniforms;

@must_use
fn deckgl_premultiplied_alpha(fragColor: vec4<f32>) -> vec4<f32> {
    return vec4(fragColor.rgb * fragColor.a, fragColor.a); 
};
`,yO={name:"color",dependencies:[],source:Fye,getUniforms:r=>({}),uniformTypes:{opacity:"f32"}},Uye=`const SMOOTH_EDGE_RADIUS: f32 = 0.5;

struct VertexGeometry {
  position: vec4<f32>,
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  normal: vec3<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

var<private> geometry_: VertexGeometry = VertexGeometry(
  vec4<f32>(0.0, 0.0, 1.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec2<f32>(0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0)
);

struct FragmentGeometry {
  uv: vec2<f32>,
};

var<private> fragmentGeometry: FragmentGeometry;

fn smoothedge(edge: f32, x: f32) -> f32 {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,_K="#define SMOOTH_EDGE_RADIUS 0.5",zye=`${_K}

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`,Vye=`${_K}

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,vK={name:"geometry",source:Uye,vs:zye,fs:Vye},$ye=25;var As;(function(r){r[r.Start=1]="Start",r[r.Move=2]="Move",r[r.End=4]="End",r[r.Cancel=8]="Cancel"})(As||(As={}));var Ps;(function(r){r[r.None=0]="None",r[r.Left=1]="Left",r[r.Right=2]="Right",r[r.Up=4]="Up",r[r.Down=8]="Down",r[r.Horizontal=3]="Horizontal",r[r.Vertical=12]="Vertical",r[r.All=15]="All"})(Ps||(Ps={}));var Hr;(function(r){r[r.Possible=1]="Possible",r[r.Began=2]="Began",r[r.Changed=4]="Changed",r[r.Ended=8]="Ended",r[r.Recognized=8]="Recognized",r[r.Cancelled=16]="Cancelled",r[r.Failed=32]="Failed"})(Hr||(Hr={}));const jye="compute",Gye="auto",dB="manipulation",Ew="none",fB="pan-x",pB="pan-y";function Hye(r){if(r.includes(Ew))return Ew;const e=r.includes(fB),t=r.includes(pB);return e&&t?Ew:e||t?e?fB:pB:r.includes(dB)?dB:Gye}class Wye{constructor(e,t){this.actions="",this.manager=e,this.set(t)}set(e){e===jye&&(e=this.compute()),this.manager.element&&(this.manager.element.style.touchAction=e,this.actions=e)}update(){this.set(this.manager.options.touchAction)}compute(){let e=[];for(const t of this.manager.recognizers)t.options.enable&&(e=e.concat(t.getTouchAction()));return Hye(e.join(" "))}}function GC(r){return r.trim().split(/\s+/g)}function DI(r,e,t){if(r)for(const n of GC(e))r.addEventListener(n,t,!1)}function LI(r,e,t){if(r)for(const n of GC(e))r.removeEventListener(n,t,!1)}function K6(r){return(r.ownerDocument||r).defaultView}function Kye(r,e){let t=r;for(;t;){if(t===e)return!0;t=t.parentNode}return!1}function AK(r){const e=r.length;if(e===1)return{x:Math.round(r[0].clientX),y:Math.round(r[0].clientY)};let t=0,n=0,i=0;for(;i<e;)t+=r[i].clientX,n+=r[i].clientY,i++;return{x:Math.round(t/e),y:Math.round(n/e)}}function X6(r){const e=[];let t=0;for(;t<r.pointers.length;)e[t]={clientX:Math.round(r.pointers[t].clientX),clientY:Math.round(r.pointers[t].clientY)},t++;return{timeStamp:Date.now(),pointers:e,center:AK(e),deltaX:r.deltaX,deltaY:r.deltaY}}function xK(r,e){const t=e.x-r.x,n=e.y-r.y;return Math.sqrt(t*t+n*n)}function J6(r,e){const t=e.clientX-r.clientX,n=e.clientY-r.clientY;return Math.sqrt(t*t+n*n)}function Xye(r,e){const t=e.x-r.x,n=e.y-r.y;return Math.atan2(n,t)*180/Math.PI}function q6(r,e){const t=e.clientX-r.clientX,n=e.clientY-r.clientY;return Math.atan2(n,t)*180/Math.PI}function wK(r,e){return r===e?Ps.None:Math.abs(r)>=Math.abs(e)?r<0?Ps.Left:Ps.Right:e<0?Ps.Up:Ps.Down}function Jye(r,e){const t=e.center;let n=r.offsetDelta,i=r.prevDelta;const s=r.prevInput;return(e.eventType===As.Start||s?.eventType===As.End)&&(i=r.prevDelta={x:s?.deltaX||0,y:s?.deltaY||0},n=r.offsetDelta={x:t.x,y:t.y}),{deltaX:i.x+(t.x-n.x),deltaY:i.y+(t.y-n.y)}}function CK(r,e,t){return{x:e/r||0,y:t/r||0}}function qye(r,e){return J6(e[0],e[1])/J6(r[0],r[1])}function Yye(r,e){return q6(e[1],e[0])-q6(r[1],r[0])}function Zye(r,e){const t=r.lastInterval||e,n=e.timeStamp-t.timeStamp;let i,s,a,o;if(e.eventType!==As.Cancel&&(n>$ye||t.velocity===void 0)){const u=e.deltaX-t.deltaX,f=e.deltaY-t.deltaY,g=CK(n,u,f);s=g.x,a=g.y,i=Math.abs(g.x)>Math.abs(g.y)?g.x:g.y,o=wK(u,f),r.lastInterval=e}else i=t.velocity,s=t.velocityX,a=t.velocityY,o=t.direction;e.velocity=i,e.velocityX=s,e.velocityY=a,e.direction=o}function Qye(r,e){const{session:t}=r,{pointers:n}=e,{length:i}=n;t.firstInput||(t.firstInput=X6(e)),i>1&&!t.firstMultiple?t.firstMultiple=X6(e):i===1&&(t.firstMultiple=!1);const{firstInput:s,firstMultiple:a}=t,o=a?a.center:s.center,u=e.center=AK(n);e.timeStamp=Date.now(),e.deltaTime=e.timeStamp-s.timeStamp,e.angle=Xye(o,u),e.distance=xK(o,u);const{deltaX:f,deltaY:g}=Jye(t,e);e.deltaX=f,e.deltaY=g,e.offsetDirection=wK(e.deltaX,e.deltaY);const y=CK(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=y.x,e.overallVelocityY=y.y,e.overallVelocity=Math.abs(y.x)>Math.abs(y.y)?y.x:y.y,e.scale=a?qye(a.pointers,n):1,e.rotation=a?Yye(a.pointers,n):0,e.maxPointers=t.prevInput?e.pointers.length>t.prevInput.maxPointers?e.pointers.length:t.prevInput.maxPointers:e.pointers.length;let A=r.element;return Kye(e.srcEvent.target,A)&&(A=e.srcEvent.target),e.target=A,Zye(t,e),e}function ebe(r,e,t){const n=t.pointers.length,i=t.changedPointers.length,s=e&As.Start&&n-i===0,a=e&(As.End|As.Cancel)&&n-i===0;t.isFirst=!!s,t.isFinal=!!a,s&&(r.session={}),t.eventType=e;const o=Qye(r,t);r.emit("hammer.input",o),r.recognize(o),r.session.prevInput=o}let tbe=class{constructor(e){this.evEl="",this.evWin="",this.evTarget="",this.domHandler=t=>{this.manager.options.enable&&this.handler(t)},this.manager=e,this.element=e.element,this.target=e.options.inputTarget||e.element}callback(e,t){ebe(this.manager,e,t)}init(){DI(this.element,this.evEl,this.domHandler),DI(this.target,this.evTarget,this.domHandler),DI(K6(this.element),this.evWin,this.domHandler)}destroy(){LI(this.element,this.evEl,this.domHandler),LI(this.target,this.evTarget,this.domHandler),LI(K6(this.element),this.evWin,this.domHandler)}};const rbe={pointerdown:As.Start,pointermove:As.Move,pointerup:As.End,pointercancel:As.Cancel,pointerout:As.Cancel},nbe="pointerdown",ibe="pointermove pointerup pointercancel";class sbe extends tbe{constructor(e){super(e),this.evEl=nbe,this.evWin=ibe,this.store=this.manager.session.pointerEvents=[],this.init()}handler(e){const{store:t}=this;let n=!1;const i=rbe[e.type],s=e.pointerType,a=s==="touch";let o=t.findIndex(u=>u.pointerId===e.pointerId);i&As.Start&&(e.buttons||a)?o<0&&(t.push(e),o=t.length-1):i&(As.End|As.Cancel)&&(n=!0),!(o<0)&&(t[o]=e,this.callback(i,{pointers:t,changedPointers:[e],eventType:i,pointerType:s,srcEvent:e}),n&&t.splice(o,1))}}const obe=["","webkit","Moz","MS","ms","o"];function abe(r,e){const t=e[0].toUpperCase()+e.slice(1);for(const n of obe){const i=n?n+t:e;if(i in r)return i}}const lbe=1,Y6=2,Z6={touchAction:"compute",enable:!0,inputTarget:null,cssProps:{userSelect:"none",userDrag:"none",touchCallout:"none",tapHighlightColor:"rgba(0,0,0,0)"}};class cbe{constructor(e,t){this.options={...Z6,...t,cssProps:{...Z6.cssProps,...t.cssProps},inputTarget:t.inputTarget||e},this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new sbe(this),this.touchAction=new Wye(this,this.options.touchAction),this.toggleCssProps(!0)}set(e){return Object.assign(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this}stop(e){this.session.stopped=e?Y6:lbe}recognize(e){const{session:t}=this;if(t.stopped)return;this.session.prevented&&e.srcEvent.preventDefault();let n;const{recognizers:i}=this;let{curRecognizer:s}=t;(!s||s&&s.state&Hr.Recognized)&&(s=t.curRecognizer=null);let a=0;for(;a<i.length;)n=i[a],t.stopped!==Y6&&(!s||n===s||n.canRecognizeWith(s))?n.recognize(e):n.reset(),!s&&n.state&(Hr.Began|Hr.Changed|Hr.Ended)&&(s=t.curRecognizer=n),a++}get(e){const{recognizers:t}=this;for(let n=0;n<t.length;n++)if(t[n].options.event===e)return t[n];return null}add(e){if(Array.isArray(e)){for(const n of e)this.add(n);return this}const t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e}remove(e){if(Array.isArray(e)){for(const n of e)this.remove(n);return this}const t=typeof e=="string"?this.get(e):e;if(t){const{recognizers:n}=this,i=n.indexOf(t);i!==-1&&(n.splice(i,1),this.touchAction.update())}return this}on(e,t){if(!e||!t)return;const{handlers:n}=this;for(const i of GC(e))n[i]=n[i]||[],n[i].push(t)}off(e,t){if(!e)return;const{handlers:n}=this;for(const i of GC(e))t?n[i]&&n[i].splice(n[i].indexOf(t),1):delete n[i]}emit(e,t){const n=this.handlers[e]&&this.handlers[e].slice();if(!n||!n.length)return;const i=t;i.type=e,i.preventDefault=function(){t.srcEvent.preventDefault()};let s=0;for(;s<n.length;)n[s](i),s++}destroy(){this.toggleCssProps(!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}toggleCssProps(e){const{element:t}=this;if(t){for(const[n,i]of Object.entries(this.options.cssProps)){const s=abe(t.style,n);e?(this.oldCssProps[s]=t.style[s],t.style[s]=i):t.style[s]=this.oldCssProps[s]||""}e||(this.oldCssProps={})}}}let ube=1;function hbe(){return ube++}function Q6(r){return r&Hr.Cancelled?"cancel":r&Hr.Ended?"end":r&Hr.Changed?"move":r&Hr.Began?"start":""}class TK{constructor(e){this.options=e,this.id=hbe(),this.state=Hr.Possible,this.simultaneous={},this.requireFail=[]}set(e){return Object.assign(this.options,e),this.manager.touchAction.update(),this}recognizeWith(e){if(Array.isArray(e)){for(const i of e)this.recognizeWith(i);return this}let t;if(typeof e=="string"){if(t=this.manager.get(e),!t)throw new Error(`Cannot find recognizer ${e}`)}else t=e;const{simultaneous:n}=this;return n[t.id]||(n[t.id]=t,t.recognizeWith(this)),this}dropRecognizeWith(e){if(Array.isArray(e)){for(const n of e)this.dropRecognizeWith(n);return this}let t;return typeof e=="string"?t=this.manager.get(e):t=e,t&&delete this.simultaneous[t.id],this}requireFailure(e){if(Array.isArray(e)){for(const i of e)this.requireFailure(i);return this}let t;if(typeof e=="string"){if(t=this.manager.get(e),!t)throw new Error(`Cannot find recognizer ${e}`)}else t=e;const{requireFail:n}=this;return n.indexOf(t)===-1&&(n.push(t),t.requireFailure(this)),this}dropRequireFailure(e){if(Array.isArray(e)){for(const n of e)this.dropRequireFailure(n);return this}let t;if(typeof e=="string"?t=this.manager.get(e):t=e,t){const n=this.requireFail.indexOf(t);n>-1&&this.requireFail.splice(n,1)}return this}hasRequireFailures(){return!!this.requireFail.find(e=>e.options.enable)}canRecognizeWith(e){return!!this.simultaneous[e.id]}emit(e){if(!e)return;const{state:t}=this;t<Hr.Ended&&this.manager.emit(this.options.event+Q6(t),e),this.manager.emit(this.options.event,e),e.additionalEvent&&this.manager.emit(e.additionalEvent,e),t>=Hr.Ended&&this.manager.emit(this.options.event+Q6(t),e)}tryEmit(e){this.canEmit()?this.emit(e):this.state=Hr.Failed}canEmit(){let e=0;for(;e<this.requireFail.length;){if(!(this.requireFail[e].state&(Hr.Failed|Hr.Possible)))return!1;e++}return!0}recognize(e){const t={...e};if(!this.options.enable){this.reset(),this.state=Hr.Failed;return}this.state&(Hr.Recognized|Hr.Cancelled|Hr.Failed)&&(this.state=Hr.Possible),this.state=this.process(t),this.state&(Hr.Began|Hr.Changed|Hr.Ended|Hr.Cancelled)&&this.tryEmit(t)}getEventNames(){return[this.options.event]}reset(){}}class SK extends TK{attrTest(e){const t=this.options.pointers;return t===0||e.pointers.length===t}process(e){const{state:t}=this,{eventType:n}=e,i=t&(Hr.Began|Hr.Changed),s=this.attrTest(e);return i&&(n&As.Cancel||!s)?t|Hr.Cancelled:i||s?n&As.End?t|Hr.Ended:t&Hr.Began?t|Hr.Changed:Hr.Began:Hr.Failed}}class e5 extends TK{constructor(e={}){super({enable:!0,event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10,...e}),this.pTime=null,this.pCenter=null,this._timer=null,this._input=null,this.count=0}getTouchAction(){return[dB]}process(e){const{options:t}=this,n=e.pointers.length===t.pointers,i=e.distance<t.threshold,s=e.deltaTime<t.time;if(this.reset(),e.eventType&As.Start&&this.count===0)return this.failTimeout();if(i&&s&&n){if(e.eventType!==As.End)return this.failTimeout();const a=this.pTime?e.timeStamp-this.pTime<t.interval:!0,o=!this.pCenter||xK(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,!o||!a?this.count=1:this.count+=1,this._input=e,this.count%t.taps===0)return this.hasRequireFailures()?(this._timer=setTimeout(()=>{this.state=Hr.Recognized,this.tryEmit(this._input)},t.interval),Hr.Began):Hr.Recognized}return Hr.Failed}failTimeout(){return this._timer=setTimeout(()=>{this.state=Hr.Failed},this.options.interval),Hr.Failed}reset(){clearTimeout(this._timer)}emit(e){this.state===Hr.Recognized&&(e.tapCount=this.count,this.manager.emit(this.options.event,e))}}const dbe=["","start","move","end","cancel","up","down","left","right"];class t5 extends SK{constructor(e={}){super({enable:!0,pointers:1,event:"pan",threshold:10,direction:Ps.All,...e}),this.pX=null,this.pY=null}getTouchAction(){const{options:{direction:e}}=this,t=[];return e&Ps.Horizontal&&t.push(pB),e&Ps.Vertical&&t.push(fB),t}getEventNames(){return dbe.map(e=>this.options.event+e)}directionTest(e){const{options:t}=this;let n=!0,{distance:i}=e,{direction:s}=e;const a=e.deltaX,o=e.deltaY;return s&t.direction||(t.direction&Ps.Horizontal?(s=a===0?Ps.None:a<0?Ps.Left:Ps.Right,n=a!==this.pX,i=Math.abs(e.deltaX)):(s=o===0?Ps.None:o<0?Ps.Up:Ps.Down,n=o!==this.pY,i=Math.abs(e.deltaY))),e.direction=s,n&&i>t.threshold&&!!(s&t.direction)}attrTest(e){return super.attrTest(e)&&(!!(this.state&Hr.Began)||!(this.state&Hr.Began)&&this.directionTest(e))}emit(e){this.pX=e.deltaX,this.pY=e.deltaY;const t=Ps[e.direction].toLowerCase();t&&(e.additionalEvent=this.options.event+t),super.emit(e)}}const fbe=["","start","move","end","cancel","in","out"];class pbe extends SK{constructor(e={}){super({enable:!0,event:"pinch",threshold:0,pointers:2,...e})}getTouchAction(){return[Ew]}getEventNames(){return fbe.map(e=>this.options.event+e)}attrTest(e){return super.attrTest(e)&&(Math.abs(e.scale-1)>this.options.threshold||!!(this.state&Hr.Began))}emit(e){if(e.scale!==1){const t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}super.emit(e)}}class NS{constructor(e,t,n){this.element=e,this.callback=t,this.options=n}}const gbe=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",mbe=gbe.indexOf("firefox")!==-1,r5=4.000244140625,ybe=40,bbe=.25;class _be extends NS{constructor(e,t,n){super(e,t,{enable:!0,...n}),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;globalThis.WheelEvent&&(mbe&&i.deltaMode===globalThis.WheelEvent.DOM_DELTA_PIXEL&&(s/=globalThis.devicePixelRatio),i.deltaMode===globalThis.WheelEvent.DOM_DELTA_LINE&&(s*=ybe)),s!==0&&s%r5===0&&(s=Math.floor(s/r5)),i.shiftKey&&s&&(s=s*bbe),this.callback({type:"wheel",center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("wheel",this.handleEvent,{passive:!1})}destroy(){this.element.removeEventListener("wheel",this.handleEvent)}enableEventType(e,t){e==="wheel"&&(this.options.enable=t)}}const n5=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"];class vbe extends NS{constructor(e,t,n){super(e,t,{enable:!0,...n}),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,n5.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){n5.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){switch(e){case"pointermove":this.enableMoveEvent=t;break;case"pointerover":this.enableOverEvent=t;break;case"pointerout":this.enableOutEvent=t;break;case"pointerenter":this.enableEnterEvent=t;break;case"pointerleave":this.enableLeaveEvent=t;break}}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit("pointerover",e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit("pointerout",e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit("pointerenter",e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit("pointerleave",e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.buttons===0&&(this.pressed=!1),this.pressed||this._emit("pointermove",e);break;case"mouseup":this.pressed=!1;break}}_emit(e,t){this.callback({type:e,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const i5=["keydown","keyup"];class Abe extends NS{constructor(e,t,n){super(e,t,{enable:!0,tabIndex:0,...n}),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:"keydown",srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:"keyup",srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,e.tabIndex=this.options.tabIndex,e.style.outline="none",i5.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){i5.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e==="keydown"&&(this.enableDownEvent=t),e==="keyup"&&(this.enableUpEvent=t)}}class xbe extends NS{constructor(e,t,n){super(e,t,n),this.handleEvent=i=>{this.options.enable&&this.callback({type:"contextmenu",center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e==="contextmenu"&&(this.options.enable=t)}}const s5=1,gB=2,o5=4,wbe={pointerdown:s5,pointermove:gB,pointerup:o5,mousedown:s5,mousemove:gB,mouseup:o5},Cbe=0,Tbe=1,Sbe=2,Ebe=1,Ibe=2,Pbe=4;function Bbe(r){const e=wbe[r.srcEvent.type];if(!e)return null;const{buttons:t,button:n}=r.srcEvent;let i=!1,s=!1,a=!1;return e===gB?(i=!!(t&Ebe),s=!!(t&Pbe),a=!!(t&Ibe)):(i=n===Cbe,s=n===Tbe,a=n===Sbe),{leftButton:i,middleButton:s,rightButton:a}}function Mbe(r,e){const t=r.center;if(!t)return null;const n=e.getBoundingClientRect(),i=n.width/e.offsetWidth||1,s=n.height/e.offsetHeight||1,a={x:(t.x-n.left-e.clientLeft)/i,y:(t.y-n.top-e.clientTop)/s};return{center:t,offsetCenter:a}}const Rbe={srcElement:"root",priority:0};class kbe{constructor(e,t){this.handleEvent=n=>{if(this.isEmpty())return;const i=this._normalizeEvent(n);let s=n.srcEvent.target;for(;s&&s!==i.rootElement;){if(this._emit(i,s),i.handled)return;s=s.parentNode}this._emit(i,"root")},this.eventManager=e,this.recognizerName=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,t,n,i=!1,s=!1){const{handlers:a,handlersByElement:o}=this,u={...Rbe,...n};let f=o.get(u.srcElement);f||(f=[],o.set(u.srcElement,f));const g={type:e,handler:t,srcElement:u.srcElement,priority:u.priority};i&&(g.once=!0),s&&(g.passive=!0),a.push(g),this._active=this._active||!g.passive;let y=f.length-1;for(;y>=0&&!(f[y].priority>=g.priority);)y--;f.splice(y+1,0,g)}remove(e,t){const{handlers:n,handlersByElement:i}=this;for(let s=n.length-1;s>=0;s--){const a=n[s];if(a.type===e&&a.handler===t){n.splice(s,1);const o=i.get(a.srcElement);o.splice(o.indexOf(a),1),o.length===0&&i.delete(a.srcElement)}}this._active=n.some(s=>!s.passive)}_emit(e,t){const n=this.handlersByElement.get(t);if(n){let i=!1;const s=()=>{e.handled=!0},a=()=>{e.handled=!0,i=!0},o=[];for(let u=0;u<n.length;u++){const{type:f,handler:g,once:y}=n[u];if(g({...e,type:f,stopPropagation:s,stopImmediatePropagation:a}),y&&o.push(n[u]),i)break}for(let u=0;u<o.length;u++){const{type:f,handler:g}=o[u];this.remove(f,g)}}}_normalizeEvent(e){const t=this.eventManager.getElement();return{...e,...Bbe(e),...Mbe(e,t),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:t}}}function Obe(r){if("recognizer"in r)return r;let e;const t=Array.isArray(r)?[...r]:[r];if(typeof t[0]=="function"){const n=t.shift(),i=t.shift()||{};e=new n(i)}else e=t.shift();return{recognizer:e,recognizeWith:typeof t[0]=="string"?[t[0]]:t[0],requireFailure:typeof t[1]=="string"?[t[1]]:t[1]}}class Dbe{constructor(e=null,t={}){if(this._onBasicInput=n=>{this.manager.emit(n.srcEvent.type,n)},this._onOtherEvent=n=>{this.manager.emit(n.type,n)},this.options={recognizers:[],events:{},touchAction:"compute",tabIndex:0,cssProps:{},...t},this.events=new Map,this.element=e,!!e){this.manager=new cbe(e,this.options);for(const n of this.options.recognizers){const{recognizer:i,recognizeWith:s,requireFailure:a}=Obe(n);this.manager.add(i),s&&i.recognizeWith(s),a&&i.requireFailure(a)}this.manager.on("hammer.input",this._onBasicInput),this.wheelInput=new _be(e,this._onOtherEvent,{enable:!1}),this.moveInput=new vbe(e,this._onOtherEvent,{enable:!1}),this.keyInput=new Abe(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new xbe(e,this._onOtherEvent,{enable:!1}),this.on(this.options.events)}}getElement(){return this.element}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy())}on(e,t,n){this._addEventHandler(e,t,n,!1)}once(e,t,n){this._addEventHandler(e,t,n,!0)}watch(e,t,n){this._addEventHandler(e,t,n,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:n}=this;if(!n)return;const i=n.get(e);i&&(i.set({enable:t}),n.touchAction.update()),this.wheelInput?.enableEventType(e,t),this.moveInput?.enableEventType(e,t),this.keyInput?.enableEventType(e,t),this.contextmenuInput?.enableEventType(e,t)}_addEventHandler(e,t,n,i,s){if(typeof e!="string"){n=t;for(const[f,g]of Object.entries(e))this._addEventHandler(f,g,n,i,s);return}const{manager:a,events:o}=this;if(!a)return;let u=o.get(e);if(!u){const f=this._getRecognizerName(e)||e;u=new kbe(this,f),o.set(e,u),a&&a.on(e,u.handleEvent)}u.add(e,t,n,i,s),u.isEmpty()||this._toggleRecognizer(u.recognizerName,!0)}_removeEventHandler(e,t){if(typeof e!="string"){for(const[s,a]of Object.entries(e))this._removeEventHandler(s,a);return}const{events:n}=this,i=n.get(e);if(i&&(i.remove(e,t),i.isEmpty())){const{recognizerName:s}=i;let a=!1;for(const o of n.values())if(o.recognizerName===s&&!o.isEmpty()){a=!0;break}a||this._toggleRecognizer(s,!1)}}_getRecognizerName(e){return this.manager.recognizers.find(t=>t.getEventNames().includes(e))?.options.event}}const Pr={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Pr,"IDENTITY",{get:()=>(Rr.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const za={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Go={common:0,meters:1,pixels:2},mB={click:"onClick",dblclick:"onClick",panstart:"onDragStart",panmove:"onDrag",panend:"onDragEnd"},a5={multipan:[t5,{threshold:10,direction:Ps.Vertical,pointers:2}],pinch:[pbe,{},null,["multipan"]],pan:[t5,{threshold:1},["pinch"],["multipan"]],dblclick:[e5,{event:"dblclick",taps:2}],click:[e5,{event:"click"},null,["dblclick"]]};function Lbe(r,e){if(r===e)return!0;if(Array.isArray(r)){const t=r.length;if(!e||e.length!==t)return!1;for(let n=0;n<t;n++)if(r[n]!==e[n])return!1;return!0}return!1}function qv(r){let e={},t;return n=>{for(const i in n)if(!Lbe(n[i],e[i])){t=r(n),e=n;break}return t}}const l5=[0,0,0,0],Nbe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],EK=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Fbe=[0,0,0],IK=[0,0,0],Ube=qv($be);function PK(r,e,t=IK){t.length<3&&(t=[t[0],t[1],0]);let n=t,i,s=!0;switch(e===Pr.LNGLAT_OFFSETS||e===Pr.METER_OFFSETS?i=t:i=r.isGeospatial?[Math.fround(r.longitude),Math.fround(r.latitude),0]:null,r.projectionMode){case za.WEB_MERCATOR:(e===Pr.LNGLAT||e===Pr.CARTESIAN)&&(i=[0,0,0],s=!1);break;case za.WEB_MERCATOR_AUTO_OFFSET:e===Pr.LNGLAT?n=i:e===Pr.CARTESIAN&&(n=[Math.fround(r.center[0]),Math.fround(r.center[1]),0],i=r.unprojectPosition(n),n[0]-=t[0],n[1]-=t[1],n[2]-=t[2]);break;case za.IDENTITY:n=r.position.map(Math.fround),n[2]=n[2]||0;break;case za.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:n,offsetMode:s}}function zbe(r,e,t){const{viewMatrixUncentered:n,projectionMatrix:i}=r;let{viewMatrix:s,viewProjectionMatrix:a}=r,o=l5,u=l5,f=r.cameraPosition;const{geospatialOrigin:g,shaderCoordinateOrigin:y,offsetMode:A}=PK(r,e,t);return A&&(u=r.projectPosition(g||y),f=[f[0]-u[0],f[1]-u[1],f[2]-u[2]],u[3]=1,o=Py([],u,a),s=n||s,a=qf([],i,s),a=qf([],a,Nbe)),{viewMatrix:s,viewProjectionMatrix:a,projectionCenter:o,originCommon:u,cameraPosCommon:f,shaderCoordinateOrigin:y,geospatialOrigin:g}}function Vbe({viewport:r,devicePixelRatio:e=1,modelMatrix:t=null,coordinateSystem:n=Pr.DEFAULT,coordinateOrigin:i=IK,autoWrapLongitude:s=!1}){n===Pr.DEFAULT&&(n=r.isGeospatial?Pr.LNGLAT:Pr.CARTESIAN);const a=Ube({viewport:r,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:i});return a.wrapLongitude=s,a.modelMatrix=t||EK,a}function $be({viewport:r,devicePixelRatio:e,coordinateSystem:t,coordinateOrigin:n}){const{projectionCenter:i,viewProjectionMatrix:s,originCommon:a,cameraPosCommon:o,shaderCoordinateOrigin:u,geospatialOrigin:f}=zbe(r,t,n),g=r.getDistanceScales(),y=[r.width*e,r.height*e],A=Py([],[0,0,-r.focalDistance,1],r.projectionMatrix)[3]||1,C={coordinateSystem:t,projectionMode:r.projectionMode,coordinateOrigin:u,commonOrigin:a.slice(0,3),center:i,pseudoMeters:!!r._pseudoMeters,viewportSize:y,devicePixelRatio:e,focalDistance:A,commonUnitsPerMeter:g.unitsPerMeter,commonUnitsPerWorldUnit:g.unitsPerMeter,commonUnitsPerWorldUnit2:Fbe,scale:r.scale,wrapLongitude:!1,viewProjectionMatrix:s,modelMatrix:EK,cameraPosition:o};if(f){const M=r.getDistanceScales(f);switch(t){case Pr.METER_OFFSETS:C.commonUnitsPerWorldUnit=M.unitsPerMeter,C.commonUnitsPerWorldUnit2=M.unitsPerMeter2;break;case Pr.LNGLAT:case Pr.LNGLAT_OFFSETS:r._pseudoMeters||(C.commonUnitsPerMeter=M.unitsPerMeter),C.commonUnitsPerWorldUnit=M.unitsPerDegree,C.commonUnitsPerWorldUnit2=M.unitsPerDegree2;break;case Pr.CARTESIAN:C.commonUnitsPerWorldUnit=[1,1,M.unitsPerMeter[2]],C.commonUnitsPerWorldUnit2=[0,0,M.unitsPerMeter2[2]];break}}return C}const jbe=Object.keys(Pr).map(r=>`const COORDINATE_SYSTEM_${r}: i32 = ${Pr[r]};`).join(""),Gbe=Object.keys(za).map(r=>`const PROJECTION_MODE_${r}: i32 = ${za[r]};`).join(""),Hbe=Object.keys(Go).map(r=>`const UNIT_${r.toUpperCase()}: i32 = ${Go[r]};`).join(""),Wbe=`${jbe}
${Gbe}
${Hbe}

const TILE_SIZE: f32 = 512.0;
const PI: f32 = 3.1415926536;
const WORLD_SCALE: f32 = TILE_SIZE / (PI * 2.0);
const ZERO_64_LOW: vec3<f32> = vec3<f32>(0.0, 0.0, 0.0);
const EARTH_RADIUS: f32 = 6370972.0; // meters
const GLOBE_RADIUS: f32 = 256.0;

// -----------------------------------------------------------------------------
// Uniform block (converted from GLSL uniform block)
// -----------------------------------------------------------------------------
struct ProjectUniforms {
  wrapLongitude: i32,
  coordinateSystem: i32,
  commonUnitsPerMeter: vec3<f32>,
  projectionMode: i32,
  scale: f32,
  commonUnitsPerWorldUnit: vec3<f32>,
  commonUnitsPerWorldUnit2: vec3<f32>,
  center: vec4<f32>,
  modelMatrix: mat4x4<f32>,
  viewProjectionMatrix: mat4x4<f32>,
  viewportSize: vec2<f32>,
  devicePixelRatio: f32,
  focalDistance: f32,
  cameraPosition: vec3<f32>,
  coordinateOrigin: vec3<f32>,
  commonOrigin: vec3<f32>,
  pseudoMeters: i32,
};

@group(0) @binding(0)
var<uniform> project: ProjectUniforms;

// -----------------------------------------------------------------------------
// Geometry data
// (In your GLSL code, "geometry" was assumed to be available globally. In WGSL,
// you might supply this via vertex attributes or a uniform. Here we define a
// uniform struct for demonstration.)
// -----------------------------------------------------------------------------

// Structure to carry additional geometry data used by deck.gl filters.
struct Geometry {
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  position: vec4<f32>,
  normal: vec3<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

// @group(0) @binding(1)
var<private> geometry: Geometry;
`,Kbe=`${Wbe}

// -----------------------------------------------------------------------------
// Functions
// -----------------------------------------------------------------------------

// Returns an adjustment factor for commonUnitsPerMeter
fn _project_size_at_latitude(lat: f32) -> f32 {
  let y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

// Overloaded version: scales a value in meters at a given latitude.
fn _project_size_at_latitude_m(meters: f32, lat: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * _project_size_at_latitude(lat);
}

// Computes a non-linear scale factor based on geometry.
// (Note: This function relies on "geometry" being provided.)
fn project_size() -> f32 {
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
      project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
      project.pseudoMeters == 0) {
    if (geometry.position.w == 0.0) {
      return _project_size_at_latitude(geometry.worldPosition.y);
    }
    let y: f32 = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    let y2 = y * y;
    let y4 = y2 * y2;
    let y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

// Overloads to scale offsets (meters to world units)
fn project_size_float(meters: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * project_size();
}

fn project_size_vec2(meters: vec2<f32>) -> vec2<f32> {
  return meters * project.commonUnitsPerMeter.xy * project_size();
}

fn project_size_vec3(meters: vec3<f32>) -> vec3<f32> {
  return meters * project.commonUnitsPerMeter * project_size();
}

fn project_size_vec4(meters: vec4<f32>) -> vec4<f32> {
  return vec4<f32>(meters.xyz * project.commonUnitsPerMeter, meters.w);
}

// Returns a rotation matrix aligning the zaxis with the given up vector.
fn project_get_orientation_matrix(up: vec3<f32>) -> mat3x3<f32> {
  let uz = normalize(up);
  let ux = select(
    vec3<f32>(1.0, 0.0, 0.0),
    normalize(vec3<f32>(uz.y, -uz.x, 0.0)),
    abs(uz.z) == 1.0
  );
  let uy = cross(uz, ux);
  return mat3x3<f32>(ux, uy, uz);
}

// Since WGSL does not support "out" parameters, we return a struct.
struct RotationResult {
  needsRotation: bool,
  transform: mat3x3<f32>,
};

fn project_needs_rotation(commonPosition: vec3<f32>) -> RotationResult {
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    return RotationResult(true, project_get_orientation_matrix(commonPosition));
  } else {
    return RotationResult(false, mat3x3<f32>());  // identity alternative if needed
  };
}

// Projects a normal vector from the current coordinate system to world space.
fn project_normal(vector: vec3<f32>) -> vec3<f32> {
  let normal_modelspace = project.modelMatrix * vec4<f32>(vector, 0.0);
  var n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
  let rotResult = project_needs_rotation(geometry.position.xyz);
  if (rotResult.needsRotation) {
    n = rotResult.transform * n;
  }
  return n;
}

// Applies a scale offset based on y-offset (dy)
fn project_offset_(offset: vec4<f32>) -> vec4<f32> {
  let dy: f32 = offset.y;
  let commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
  return vec4<f32>(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}

// Projects lng/lat coordinates to a unit tile [0,1]
fn project_mercator_(lnglat: vec2<f32>) -> vec2<f32> {
  var x = lnglat.x;
  if (project.wrapLongitude != 0) {
    x = ((x + 180.0) % 360.0) - 180.0;
  }
  let y = clamp(lnglat.y, -89.9, 89.9);
  return vec2<f32>(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// Projects lng/lat/z coordinates for a globe projection.
fn project_globe_(lnglatz: vec3<f32>) -> vec3<f32> {
  let lambda = radians(lnglatz.x);
  let phi = radians(lnglatz.y);
  let cosPhi = cos(phi);
  let D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
  return vec3<f32>(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}

// Projects positions (with an optional 64-bit low part) from the input
// coordinate system to the common space.
fn project_position_vec4_f64(position: vec4<f32>, position64Low: vec3<f32>) -> vec4<f32> {
  var position_world = project.modelMatrix * position;

  // Work around for a Mac+NVIDIA bug:
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_mercator_(position_world.xy),
        _project_size_at_latitude_m(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world = vec4f(position_world.xyz + project.coordinateOrigin, position_world.w);
    }
  }
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
        return vec4<f32>(
          project_mercator_(position_world.xy) - project.commonOrigin.xy,
          project_size_float(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
      (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
       (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
        project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world = vec4f(position_world.xyz - project.coordinateOrigin, position_world.w);
  }

  return project_offset_(position_world) +
         project_offset_(project.modelMatrix * vec4<f32>(position64Low, 0.0));
}

// Overloaded versions for different input types.
fn project_position_vec4_f32(position: vec4<f32>) -> vec4<f32> {
  return project_position_vec4_f64(position, ZERO_64_LOW);
}

fn project_position_vec3_f64(position: vec3<f32>, position64Low: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), position64Low);
  return projected_position.xyz;
}

fn project_position_vec3_f32(position: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

fn project_position_vec2_f32(position: vec2<f32>) -> vec2<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

// Transforms a common space position to clip space.
fn project_common_position_to_clipspace_with_projection(position: vec4<f32>, viewProjectionMatrix: mat4x4<f32>, center: vec4<f32>) -> vec4<f32> {
  return viewProjectionMatrix * position + center;
}

// Uses the project viewProjectionMatrix and center.
fn project_common_position_to_clipspace(position: vec4<f32>) -> vec4<f32> {
  return project_common_position_to_clipspace_with_projection(position, project.viewProjectionMatrix, project.center);
}

// Returns a clip space offset corresponding to a given number of screen pixels.
fn project_pixel_size_to_clipspace(pixels: vec2<f32>) -> vec2<f32> {
  let offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
  return offset * project.focalDistance;
}

fn project_meter_size_to_pixel(meters: f32) -> f32 {
  return project_size_float(meters) * project.scale;
}

fn project_unit_size_to_pixel(size: f32, unit: i32) -> f32 {
  if (unit == UNIT_METERS) {
    return project_meter_size_to_pixel(size);
  } else if (unit == UNIT_COMMON) {
    return size * project.scale;
  }
  // UNIT_PIXELS: no scaling applied.
  return size;
}

fn project_pixel_size_float(pixels: f32) -> f32 {
  return pixels / project.scale;
}

fn project_pixel_size_vec2(pixels: vec2<f32>) -> vec2<f32> {
  return pixels / project.scale;
}
`,Xbe=Object.keys(Pr).map(r=>`const int COORDINATE_SYSTEM_${r} = ${Pr[r]};`).join(""),Jbe=Object.keys(za).map(r=>`const int PROJECTION_MODE_${r} = ${za[r]};`).join(""),qbe=Object.keys(Go).map(r=>`const int UNIT_${r.toUpperCase()} = ${Go[r]};`).join(""),Ybe=`${Xbe}
${Jbe}
${qbe}
uniform projectUniforms {
bool wrapLongitude;
int coordinateSystem;
vec3 commonUnitsPerMeter;
int projectionMode;
float scale;
vec3 commonUnitsPerWorldUnit;
vec3 commonUnitsPerWorldUnit2;
vec4 center;
mat4 modelMatrix;
mat4 viewProjectionMatrix;
vec2 viewportSize;
float devicePixelRatio;
float focalDistance;
vec3 cameraPosition;
vec3 coordinateOrigin;
vec3 commonOrigin;
bool pseudoMeters;
} project;
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
float y = clamp(lat, -89.9, 89.9);
return 1.0 / cos(radians(y));
}
float project_size() {
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
project.pseudoMeters == false) {
if (geometry.position.w == 0.0) {
return project_size_at_latitude(geometry.worldPosition.y);
}
float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
float y2 = y * y;
float y4 = y2 * y2;
float y6 = y4 * y2;
return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
}
return 1.0;
}
float project_size_at_latitude(float meters, float lat) {
return meters * project.commonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
return meters * project.commonUnitsPerMeter.z * project_size();
}
vec2 project_size(vec2 meters) {
return meters * project.commonUnitsPerMeter.xy * project_size();
}
vec3 project_size(vec3 meters) {
return meters * project.commonUnitsPerMeter * project_size();
}
vec4 project_size(vec4 meters) {
return vec4(meters.xyz * project.commonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
vec3 uz = normalize(up);
vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
vec3 uy = cross(uz, ux);
return mat3(ux, uy, uz);
}
bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
transform = project_get_orientation_matrix(commonPosition);
return true;
}
return false;
}
vec3 project_normal(vec3 vector) {
vec4 normal_modelspace = project.modelMatrix * vec4(vector, 0.0);
vec3 n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
mat3 rotation;
if (project_needs_rotation(geometry.position.xyz, rotation)) {
n = rotation * n;
}
return n;
}
vec4 project_offset_(vec4 offset) {
float dy = offset.y;
vec3 commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
float x = lnglat.x;
if (project.wrapLongitude) {
x = mod(x + 180., 360.0) - 180.;
}
float y = clamp(lnglat.y, -89.9, 89.9);
return vec2(
radians(x) + PI,
PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
) * WORLD_SCALE;
}
vec3 project_globe_(vec3 lnglatz) {
float lambda = radians(lnglatz.x);
float phi = radians(lnglatz.y);
float cosPhi = cos(phi);
float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
return vec3(
sin(lambda) * cosPhi,
-cos(lambda) * cosPhi,
sin(phi)
) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
vec4 position_world = project.modelMatrix * position;
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_mercator_(position_world.xy),
project_size_at_latitude(position_world.z, position_world.y),
position_world.w
);
}
if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
position_world.xyz += project.coordinateOrigin;
}
}
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_globe_(position_world.xyz),
position_world.w
);
}
}
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
return vec4(
project_mercator_(position_world.xy) - project.commonOrigin.xy,
project_size(position_world.z),
position_world.w
);
}
}
}
if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
(project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
(project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
position_world.xyz -= project.coordinateOrigin;
}
return project_offset_(position_world) + project_offset_(project.modelMatrix * vec4(position64Low, 0.0));
}
vec4 project_position(vec4 position) {
return project_position(position, ZERO_64_LOW);
}
vec3 project_position(vec3 position, vec3 position64Low) {
vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
return projected_position.xyz;
}
vec3 project_position(vec3 position) {
vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
return projected_position.xyz;
}
vec2 project_position(vec2 position) {
vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
return projected_position.xy;
}
vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
return project_common_position_to_clipspace(position, project.viewProjectionMatrix, project.center);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
vec2 offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
return offset * project.focalDistance;
}
float project_size_to_pixel(float meters) {
return project_size(meters) * project.scale;
}
float project_size_to_pixel(float size, int unit) {
if (unit == UNIT_METERS) return project_size_to_pixel(size);
if (unit == UNIT_COMMON) return size * project.scale;
return size;
}
float project_pixel_size(float pixels) {
return pixels / project.scale;
}
vec2 project_pixel_size(vec2 pixels) {
return pixels / project.scale;
}
`,Zbe={};function Qbe(r=Zbe){return"viewport"in r?Vbe(r):{}}const bO={name:"project",dependencies:[_ye,vK],source:Kbe,vs:Ybe,getUniforms:Qbe,uniformTypes:{wrapLongitude:"f32",coordinateSystem:"i32",commonUnitsPerMeter:"vec3<f32>",projectionMode:"i32",scale:"f32",commonUnitsPerWorldUnit:"vec3<f32>",commonUnitsPerWorldUnit2:"vec3<f32>",center:"vec4<f32>",modelMatrix:"mat4x4<f32>",viewProjectionMatrix:"mat4x4<f32>",viewportSize:"vec2<f32>",devicePixelRatio:"f32",focalDistance:"f32",cameraPosition:"vec3<f32>",coordinateOrigin:"vec3<f32>",commonOrigin:"vec3<f32>",pseudoMeters:"f32"}},e0e=`// Define a structure to hold both the clip-space position and the common position.
struct ProjectResult {
  clipPosition: vec4<f32>,
  commonPosition: vec4<f32>,
};

// This function mimics the GLSL version with the 'out' parameter by returning both values.
fn project_position_to_clipspace_and_commonspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> ProjectResult {
  // Compute the projected position.
  let projectedPosition: vec3<f32> = project_position_vec3_f64(position, position64Low);

  // Start with the provided offset.
  var finalOffset: vec3<f32> = offset;

  // Get whether a rotation is needed and the rotation matrix.
  let rotationResult = project_needs_rotation(projectedPosition);

  // If rotation is needed, update the offset.
  if (rotationResult.needsRotation) {
    finalOffset = rotationResult.transform * offset;
  }

  // Compute the common position.
  let commonPosition: vec4<f32> = vec4<f32>(projectedPosition + finalOffset, 1.0);

  // Convert to clip-space.
  let clipPosition: vec4<f32> = project_common_position_to_clipspace(commonPosition);

  return ProjectResult(clipPosition, commonPosition);
}

// A convenience overload that returns only the clip-space position.
fn project_position_to_clipspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> vec4<f32> {
  return project_position_to_clipspace_and_commonspace(position, position64Low, offset).clipPosition;
}
`,t0e=`vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,$s={name:"project32",dependencies:[bO],source:e0e,vs:t0e};function r0e(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Nm(r,e){const t=Py([],e,r);return pO(t,t,1/t[3]),t}function c5(r,e){const t=r%e;return t<0?e+t:t}function yB(r,e,t){return r<e?e:r>t?t:r}function n0e(r){return Math.log(r)*Math.LOG2E}const _O=Math.log2||n0e;function Zu(r,e){if(!r)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const Jl=Math.PI,BK=Jl/4,yl=Jl/180,bB=180/Jl,ry=512,HC=4003e4,od=85.051129,i0e=1.5;function s0e(r){return _O(r)}function Jc(r){const[e,t]=r;Zu(Number.isFinite(e)),Zu(Number.isFinite(t)&&t>=-90&&t<=90,"invalid latitude");const n=e*yl,i=t*yl,s=ry*(n+Jl)/(2*Jl),a=ry*(Jl+Math.log(Math.tan(BK+i*.5)))/(2*Jl);return[s,a]}function ny(r){const[e,t]=r,n=e/ry*(2*Jl)-Jl,i=2*(Math.atan(Math.exp(t/ry*(2*Jl)-Jl))-BK);return[n*bB,i*bB]}function o0e(r){const{latitude:e}=r;Zu(Number.isFinite(e));const t=Math.cos(e*yl);return s0e(HC*t)-9}function Iw(r){const e=Math.cos(r*yl);return ry/HC/e}function _B(r){const{latitude:e,longitude:t,highPrecision:n=!1}=r;Zu(Number.isFinite(e)&&Number.isFinite(t));const i=ry,s=Math.cos(e*yl),a=i/360,o=a/s,u=i/HC/s,f={unitsPerMeter:[u,u,u],metersPerUnit:[1/u,1/u,1/u],unitsPerDegree:[a,o,u],degreesPerUnit:[1/a,1/o,1/u]};if(n){const g=yl*Math.tan(e*yl)/s,y=a*g/2,A=i/HC*g,C=A/o*u;f.unitsPerDegree2=[0,y,A],f.unitsPerMeter2=[C,0,C]}return f}function MK(r,e){const[t,n,i]=r,[s,a,o]=e,{unitsPerMeter:u,unitsPerMeter2:f}=_B({longitude:t,latitude:n,highPrecision:!0}),g=Jc(r);g[0]+=s*(u[0]+f[0]*a),g[1]+=a*(u[1]+f[1]*a);const y=ny(g),A=(i||0)+(o||0);return Number.isFinite(i)||Number.isFinite(o)?[y[0],y[1],A]:y}function a0e(r){const{height:e,pitch:t,bearing:n,altitude:i,scale:s,center:a}=r,o=r0e();jC(o,o,[0,0,-i]),cK(o,o,-t*yl),uK(o,o,n*yl);const u=s/e;return fO(o,o,[u,u,u]),a&&jC(o,o,lme([],a)),o}function l0e(r){const{width:e,height:t,altitude:n,pitch:i=0,offset:s,center:a,scale:o,nearZMultiplier:u=1,farZMultiplier:f=1}=r;let{fovy:g=H_(i0e)}=r;n!==void 0&&(g=H_(n));const y=g*yl,A=i*yl,C=vO(g);let M=C;a&&(M+=a[2]*o/Math.cos(A)/t);const k=y*(.5+(s?s[1]:0)/t),D=Math.sin(k)*M/Math.sin(yB(Math.PI/2-A-k,.01,Math.PI-.01)),V=Math.sin(A)*D+M,W=M*10,z=Math.min(V*f,W);return{fov:y,aspect:e/t,focalDistance:C,near:u,far:z}}function H_(r){return 2*Math.atan(.5/r)*bB}function vO(r){return .5/Math.tan(.5*r*yl)}function RK(r,e){const[t,n,i=0]=r;return Zu(Number.isFinite(t)&&Number.isFinite(n)&&Number.isFinite(i)),Nm(e,[t,n,i,1])}function AO(r,e,t=0){const[n,i,s]=r;if(Zu(Number.isFinite(n)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return Nm(e,[n,i,s,1]);const a=Nm(e,[n,i,0,1]),o=Nm(e,[n,i,1,1]),u=a[2],f=o[2],g=u===f?0:((t||0)-u)/(f-u);return qW([],a,o,g)}function c0e(r){const{width:e,height:t,bounds:n,minExtent:i=0,maxZoom:s=24,offset:a=[0,0]}=r,[[o,u],[f,g]]=n,y=u0e(r.padding),A=Jc([o,yB(g,-od,od)]),C=Jc([f,yB(u,-od,od)]),M=[Math.max(Math.abs(C[0]-A[0]),i),Math.max(Math.abs(C[1]-A[1]),i)],k=[e-y.left-y.right-Math.abs(a[0])*2,t-y.top-y.bottom-Math.abs(a[1])*2];Zu(k[0]>0&&k[1]>0);const D=k[0]/M[0],V=k[1]/M[1],W=(y.right-y.left)/2/D,z=(y.top-y.bottom)/2/V,$=[(C[0]+A[0])/2+W,(C[1]+A[1])/2+z],te=ny($),le=Math.min(s,_O(Math.abs(Math.min(D,V))));return Zu(Number.isFinite(le)),{longitude:te[0],latitude:te[1],zoom:le}}function u0e(r=0){return typeof r=="number"?{top:r,bottom:r,left:r,right:r}:(Zu(Number.isFinite(r.top)&&Number.isFinite(r.bottom)&&Number.isFinite(r.left)&&Number.isFinite(r.right)),r)}const u5=Math.PI/180;function h0e(r,e=0){const{width:t,height:n,unproject:i}=r,s={targetZ:e},a=i([0,n],s),o=i([t,n],s);let u,f;const g=r.fovy?.5*r.fovy*u5:Math.atan(.5/r.altitude),y=(90-r.pitch)*u5;return g>y-.01?(u=h5(r,0,e),f=h5(r,t,e)):(u=i([0,0],s),f=i([t,0],s)),[a,o,f,u]}function h5(r,e,t){const{pixelUnprojectionMatrix:n}=r,i=Nm(n,[e,0,1,1]),s=Nm(n,[e,r.height,1,1]),o=(t*r.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),u=qW([],i,s,o),f=ny(u);return f.push(t),f}const d5=512;function d0e(r){const{width:e,height:t,pitch:n=0}=r;let{longitude:i,latitude:s,zoom:a,bearing:o=0}=r;(i<-180||i>180)&&(i=c5(i+180,360)-180),(o<-180||o>180)&&(o=c5(o+180,360)-180);const u=_O(t/d5);if(a<=u)a=u,s=0;else{const f=t/2/Math.pow(2,a),g=ny([0,f])[1];if(s<g)s=g;else{const y=ny([0,d5-f])[1];s>y&&(s=y)}}return{width:e,height:t,longitude:i,latitude:s,zoom:a,pitch:n,bearing:o}}const kK=`
uniform shadowUniforms {
  bool drawShadowMap;
  bool useShadowMap;
  vec4 color;
  highp int lightId;
  float lightCount;
  mat4 viewProjectionMatrix0;
  mat4 viewProjectionMatrix1;
  vec4 projectCenter0;
  vec4 projectCenter1;
} shadow;
`,f0e=`
const int max_lights = 2;

out vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  mat4 viewProjectionMatrices[max_lights];
  viewProjectionMatrices[0] = shadow.viewProjectionMatrix0;
  viewProjectionMatrices[1] = shadow.viewProjectionMatrix1;
  vec4 projectCenters[max_lights];
  projectCenters[0] = shadow.projectCenter0;
  projectCenters[1] = shadow.projectCenter1;

  if (shadow.drawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[shadow.lightId], projectCenters[shadow.lightId]);
  }
  if (shadow.useShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow.lightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[i], projectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,p0e=`
${kK}
${f0e}
`,g0e=`
const int max_lights = 2;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;

in vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow.drawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow.useShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow.lightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow.color.a / shadow.lightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow.color.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,m0e=`
${kK}
${g0e}
`,y0e=qv(x0e),b0e=qv(w0e),_0e=[0,0,0,1],v0e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function A0e(r,e){const[t,n,i]=r,s=AO([t,n,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}function x0e({viewport:r,center:e}){return new $r(r.viewProjectionMatrix).invert().transform(e)}function w0e({viewport:r,shadowMatrices:e}){const t=[],n=r.pixelUnprojectionMatrix,i=r.isGeospatial?void 0:1,s=[[0,0,i],[r.width,0,i],[0,r.height,i],[r.width,r.height,i],[0,0,-1],[r.width,0,-1],[0,r.height,-1],[r.width,r.height,-1]].map(a=>A0e(a,n));for(const a of e){const o=a.clone().translate(new rt(r.center).negate()),u=s.map(g=>o.transform(g)),f=new $r().ortho({left:Math.min(...u.map(g=>g[0])),right:Math.max(...u.map(g=>g[0])),bottom:Math.min(...u.map(g=>g[1])),top:Math.max(...u.map(g=>g[1])),near:Math.min(...u.map(g=>-g[2])),far:Math.max(...u.map(g=>-g[2]))});t.push(f.multiplyRight(a))}return t}function C0e(r){const{shadowEnabled:e=!0,project:t}=r;if(!e||!t||!r.shadowMatrices||!r.shadowMatrices.length)return{drawShadowMap:!1,useShadowMap:!1,shadow_uShadowMap0:r.dummyShadowMap,shadow_uShadowMap1:r.dummyShadowMap};const n=bO.getUniforms(t),i=y0e({viewport:t.viewport,center:n.center}),s=[],a=b0e({shadowMatrices:r.shadowMatrices,viewport:t.viewport}).slice();for(let u=0;u<r.shadowMatrices.length;u++){const f=a[u],g=f.clone().translate(new rt(t.viewport.center).negate());n.coordinateSystem===Pr.LNGLAT&&n.projectionMode===za.WEB_MERCATOR?(a[u]=g,s[u]=i):(a[u]=f.clone().multiplyRight(v0e),s[u]=g.transform(i))}const o={drawShadowMap:!!r.drawToShadowMap,useShadowMap:r.shadowMaps?r.shadowMaps.length>0:!1,color:r.shadowColor||_0e,lightId:r.shadowLightId||0,lightCount:r.shadowMatrices.length,shadow_uShadowMap0:r.dummyShadowMap,shadow_uShadowMap1:r.dummyShadowMap};for(let u=0;u<a.length;u++)o[`viewProjectionMatrix${u}`]=a[u],o[`projectCenter${u}`]=s[u];for(let u=0;u<2;u++)o[`shadow_uShadowMap${u}`]=r.shadowMaps&&r.shadowMaps[u]||r.dummyShadowMap;return o}const f5={name:"shadow",dependencies:[bO],vs:p0e,fs:m0e,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:C0e,uniformTypes:{drawShadowMap:"f32",useShadowMap:"f32",color:"vec4<f32>",lightId:"i32",lightCount:"f32",viewProjectionMatrix0:"mat4x4<f32>",viewProjectionMatrix1:"mat4x4<f32>",projectCenter0:"vec4<f32>",projectCenter1:"vec4<f32>"}},Ja={...j6,defaultUniforms:{...j6.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}}},T0e=[vK],S0e=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"],E0e=[];function I0e(r){const e=MC.getDefaultShaderAssembler();for(const n of T0e)e.addDefaultModule(n);e._hookFunctions.length=0;const t=r==="glsl"?S0e:E0e;for(const n of t)e.addShaderHook(n);return e}const P0e=[255,255,255],B0e=1;let M0e=0;class R0e{constructor(e={}){this.type="ambient";const{color:t=P0e}=e,{intensity:n=B0e}=e;this.id=e.id||`ambient-${M0e++}`,this.color=t,this.intensity=n}}const k0e=[255,255,255],O0e=1,D0e=[0,0,-1];let L0e=0;class p5{constructor(e={}){this.type="directional";const{color:t=k0e}=e,{intensity:n=O0e}=e,{direction:i=D0e}=e,{_shadow:s=!1}=e;this.id=e.id||`directional-${L0e++}`,this.color=t,this.intensity=n,this.type="directional",this.direction=new rt(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class N0e{constructor(e,t={id:"pass"}){const{id:n}=t;this.id=n,this.device=e,this.props={...t}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class xO extends N0e{constructor(){super(...arguments),this._lastRenderIndex=-1}render(e){const[t,n]=this.device.canvasContext.getDrawingBufferSize(),i=e.clearCanvas??!0,s=e.clearColor??(i?[0,0,0,0]:!1),a=i?1:!1,o=i?0:!1,u=e.colorMask??15,f={viewport:[0,0,t,n]};e.colorMask&&(f.colorMask=u),e.scissorRect&&(f.scissorRect=e.scissorRect);const g=this.device.beginRenderPass({framebuffer:e.target,parameters:f,clearColor:s,clearDepth:a,clearStencil:o});try{return this._drawLayers(g,e)}finally{g.end(),this.device.submit()}}_drawLayers(e,t){const{target:n,shaderModuleProps:i,viewports:s,views:a,onViewportActive:o,clearStack:u=!0}=t;t.pass=t.pass||"unknown",u&&(this._lastRenderIndex=-1);const f=[];for(const g of s){const y=a&&a[g.id];o?.(g);const A=this._getDrawLayerParams(g,t),C=g.subViewports||[g];for(const M of C){const k=this._drawLayersInViewport(e,{target:n,shaderModuleProps:i,viewport:M,view:y,pass:t.pass,layers:t.layers},A);f.push(k)}}return f}_getDrawLayerParams(e,{layers:t,pass:n,isPicking:i=!1,layerFilter:s,cullRect:a,effects:o,shaderModuleProps:u},f=!1){const g=[],y=OK(this._lastRenderIndex+1),A={layer:t[0],viewport:e,isPicking:i,renderPass:n,cullRect:a},C={};for(let M=0;M<t.length;M++){const k=t[M],D=this._shouldDrawLayer(k,A,s,C),V={shouldDrawLayer:D};D&&!f&&(V.shouldDrawLayer=!0,V.layerRenderIndex=y(k,D),V.shaderModuleProps=this._getShaderModuleProps(k,o,n,u),V.layerParameters={...k.context.deck?.props.parameters,...this.getLayerParameters(k,M,e)}),g[M]=V}return g}_drawLayersInViewport(e,{layers:t,shaderModuleProps:n,pass:i,target:s,viewport:a,view:o},u){const f=F0e(this.device,{shaderModuleProps:n,target:s,viewport:a});if(o){const{clear:y,clearColor:A,clearDepth:C,clearStencil:M}=o.props;if(y){let k=[0,0,0,0],D=1,V=0;Array.isArray(A)?k=[...A.slice(0,3),A[3]||255].map(z=>z/255):A===!1&&(k=!1),C!==void 0&&(D=C),M!==void 0&&(V=M),this.device.beginRenderPass({framebuffer:s,parameters:{viewport:f,scissorRect:f},clearColor:k,clearDepth:D,clearStencil:V}).end()}}const g={totalCount:t.length,visibleCount:0,compositeCount:0,pickableCount:0};e.setParameters({viewport:f});for(let y=0;y<t.length;y++){const A=t[y],C=u[y],{shouldDrawLayer:M}=C;if(M&&A.props.pickable&&g.pickableCount++,A.isComposite&&g.compositeCount++,A.isDrawable&&C.shouldDrawLayer){const{layerRenderIndex:k,shaderModuleProps:D,layerParameters:V}=C;g.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,k),D.project&&(D.project.viewport=a),A.context.renderPass=e;try{A._drawLayer({renderPass:e,shaderModuleProps:D,uniforms:{layerIndex:k},parameters:V})}catch(W){A.raiseError(W,`drawing ${A} to ${i}`)}}}return g}shouldDrawLayer(e){return!0}getShaderModuleProps(e,t,n){return null}getLayerParameters(e,t,n){return e.props.parameters}_shouldDrawLayer(e,t,n,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;t.layer=e;let a=e.parent;for(;a;){if(!a.props.visible||!a.filterSubLayer(t))return!1;t.layer=a,a=a.parent}if(n){const o=t.layer.id;if(o in i||(i[o]=n(t)),!i[o])return!1}return e.activateViewport(t.viewport),!0}_getShaderModuleProps(e,t,n,i){const s=this.device.canvasContext.cssToDeviceRatio(),a=e.internalState?.propsInTransition||e.props,o={layer:a,picking:{isActive:!1},project:{viewport:e.context.viewport,devicePixelRatio:s,modelMatrix:a.modelMatrix,coordinateSystem:a.coordinateSystem,coordinateOrigin:a.coordinateOrigin,autoWrapLongitude:e.wrapLongitude}};if(t)for(const u of t)g5(o,u.getShaderModuleProps?.(e,o));return g5(o,this.getShaderModuleProps(e,t,o),i)}}function OK(r=0,e={}){const t={},n=(i,s)=>{const a=i.props._offset,o=i.id,u=i.parent&&i.parent.id;let f;if(u&&!(u in e)&&n(i.parent,!1),u in t){const g=t[u]=t[u]||OK(e[u],e);f=g(i,s),t[o]=g}else Number.isFinite(a)?(f=a+(e[u]||0),t[o]=null):f=r;return s&&f>=r&&(r=f+1),e[o]=f,f};return n}function F0e(r,{shaderModuleProps:e,target:t,viewport:n}){const i=e?.project?.devicePixelRatio??r.canvasContext.cssToDeviceRatio(),[,s]=r.canvasContext.getDrawingBufferSize(),a=t?t.height:s,o=n;return[o.x*i,a-(o.y+o.height)*i,o.width*i,o.height*i]}function g5(r,...e){for(const t of e)if(t)for(const n in t)r[n]?Object.assign(r[n],t[n]):r[n]=t[n];return r}class U0e extends xO{constructor(e,t){super(e,t);const n=e.createTexture({format:"rgba8unorm",width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}}),i=e.createTexture({format:"depth16unorm",width:1,height:1});this.fbo=e.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[n],depthStencilAttachment:i})}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null)}getShadowMap(){return this.fbo.colorAttachments[0].texture}render(e){const t=this.fbo,n=this.device.canvasContext.cssToDeviceRatio(),i=e.viewports[0],s=i.width*n,a=i.height*n,o=[1,1,1,1];(s!==t.width||a!==t.height)&&t.resize({width:s,height:a}),super.render({...e,clearColor:o,target:t,pass:"shadow"})}getLayerParameters(e,t,n){return{...e.props.parameters,blend:!1,depthWriteEnabled:!0,depthCompare:"less-equal"}}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getShaderModuleProps(e,t,n){return{shadow:{project:n.project,drawToShadowMap:!0}}}}const z0e={color:[255,255,255],intensity:1},m5=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],V0e=[0,0,0,200/255];class DK{constructor(e={}){this.id="lighting-effect",this.shadowColor=V0e,this.shadow=!1,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.dummyShadowMap=null,this.setProps(e)}setup(e){this.context=e;const{device:t,deck:n}=e;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(t),n._addDefaultShaderModule(f5),this.dummyShadowMap=t.createTexture({width:1,height:1}))}setProps(e){this.ambientLight=void 0,this.directionalLights=[],this.pointLights=[];for(const t in e){const n=e[t];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(t=>t.shadow),this.context&&this.setup(this.context),this.props=e}preRender({layers:e,layerFilter:t,viewports:n,onViewportActive:i,views:s}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:e,layerFilter:t,viewports:n,onViewportActive:i,views:s,shaderModuleProps:{shadow:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}}})}}getShaderModuleProps(e,t){const n=this.shadow?{project:t.project,shadowMaps:this.shadowPasses.map(a=>a.getShadowMap()),dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{},i={enabled:!0,ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(a=>a.getProjectedLight({layer:e})),pointLights:this.pointLights.map(a=>a.getProjectedLight({layer:e}))},s=e.props.material;return{shadow:n,lighting:i,phongMaterial:s,gouraudMaterial:s}}cleanup(e){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,e.deck._removeDefaultShaderModule(f5))}_calculateMatrices(){const e=[];for(const t of this.directionalLights){const n=new $r().lookAt({eye:new rt(t.direction).negate()});e.push(n)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const n=new U0e(e);this.shadowPasses[t]=n}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:n}=this;!e&&t.length===0&&n.length===0&&(this.ambientLight=new R0e(z0e),this.directionalLights.push(new p5(m5[0]),new p5(m5[1])))}}class $0e{constructor(e={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,t,{size:n=1,type:i,padding:s=0,copy:a=!1,initialize:o=!1,maxCount:u}){const f=i||e&&e.constructor||Float32Array,g=t*n+s;if(ArrayBuffer.isView(e)){if(g<=e.length)return e;if(g*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new f(e.buffer,0,g)}let y=1/0;u&&(y=u*n+s);const A=this._allocate(f,g,o,y);return e&&a?A.set(e):o||A.fill(0,0,4),this._release(e),A}release(e){this._release(e)}_allocate(e,t,n,i){let s=Math.max(Math.ceil(t*this.opts.overAlloc),1);s>i&&(s=i);const a=this._pool,o=e.BYTES_PER_ELEMENT*s,u=a.findIndex(f=>f.byteLength>=o);if(u>=0){const f=new e(a.splice(u,1)[0],0,s);return n&&f.fill(0),f}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:n}=e,{byteLength:i}=n,s=t.findIndex(a=>a.byteLength>=i);s<0?t.push(n):(s>0||t.length<this.opts.poolSize)&&t.splice(s,0,n),t.length>this.opts.poolSize&&t.shift()}}const iy=new $0e;function P0(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function j0e(r,e){const t=r%e;return t<0?e+t:t}function G0e(r){return[r[12],r[13],r[14]]}function H0e(r){return{left:Lg(r[3]+r[0],r[7]+r[4],r[11]+r[8],r[15]+r[12]),right:Lg(r[3]-r[0],r[7]-r[4],r[11]-r[8],r[15]-r[12]),bottom:Lg(r[3]+r[1],r[7]+r[5],r[11]+r[9],r[15]+r[13]),top:Lg(r[3]-r[1],r[7]-r[5],r[11]-r[9],r[15]-r[13]),near:Lg(r[3]+r[2],r[7]+r[6],r[11]+r[10],r[15]+r[14]),far:Lg(r[3]-r[2],r[7]-r[6],r[11]-r[10],r[15]-r[14])}}const y5=new rt;function Lg(r,e,t,n){y5.set(r,e,t);const i=y5.len();return{distance:n/i,normal:new rt(-r/i,-e/i,-t/i)}}function W0e(r){return r-Math.fround(r)}let Zb;function NI(r,e){const{size:t=1,startIndex:n=0}=e,i=e.endIndex!==void 0?e.endIndex:r.length,s=(i-n)/t;Zb=iy.allocate(Zb,s,{type:Float32Array,size:t*2});let a=n,o=0;for(;a<i;){for(let u=0;u<t;u++){const f=r[a++];Zb[o+u]=f,Zb[o+u+t]=W0e(f)}o+=t*2}return Zb.subarray(0,s*t*2)}function K0e(r){let e=null,t=!1;for(const n of r)n&&(e?(t||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],t=!0),e[0][0]=Math.min(e[0][0],n[0][0]),e[0][1]=Math.min(e[0][1],n[0][1]),e[1][0]=Math.max(e[1][0],n[1][0]),e[1][1]=Math.max(e[1][1],n[1][1])):e=n);return e}const X0e=Math.PI/180,J0e=P0(),b5=[0,0,0],q0e={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function Y0e({width:r,height:e,orthographic:t,fovyRadians:n,focalDistance:i,padding:s,near:a,far:o}){const u=r/e,f=t?new $r().orthographic({fovy:n,aspect:u,focalDistance:i,near:a,far:o}):new $r().perspective({fovy:n,aspect:u,near:a,far:o});if(s){const{left:g=0,right:y=0,top:A=0,bottom:C=0}=s,M=Xl((g+r-y)/2,0,r)-r/2,k=Xl((A+e-C)/2,0,e)-e/2;f[8]-=M*2/r,f[9]+=k*2/e}return f}class nh{constructor(e={}){this._frustumPlanes={},this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||q0e,this.focalDistance=e.focalDistance||1,this.position=e.position||b5,this.modelMatrix=e.modelMatrix||null;const{longitude:t,latitude:n}=e;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(t),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?za.WEB_MERCATOR:za.WEB_MERCATOR_AUTO_OFFSET:za.IDENTITY}equals(e){return e instanceof nh?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&ml(e.projectionMatrix,this.projectionMatrix)&&ml(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:t=!0}={}){const n=this.projectPosition(e),i=RK(n,this.pixelProjectionMatrix),[s,a]=i,o=t?a:this.height-a;return e.length===2?[s,o]:[s,o,i[2]]}unproject(e,{topLeft:t=!0,targetZ:n}={}){const[i,s,a]=e,o=t?s:this.height-s,u=n&&n*this.distanceScales.unitsPerMeter[2],f=AO([i,o,a],this.pixelUnprojectionMatrix,u),[g,y,A]=this.unprojectPosition(f);return Number.isFinite(a)?[g,y,A]:Number.isFinite(n)?[g,y,n]:[g,y]}projectPosition(e){const[t,n]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[t,n,i]}unprojectPosition(e){const[t,n]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[t,n,i]}projectFlat(e){if(this.isGeospatial){const t=Jc(e);return t[1]=Xl(t[1],-318,830),t}return e}unprojectFlat(e){return this.isGeospatial?ny(e):e}getBounds(e={}){const t={targetZ:e.z||0},n=this.unproject([0,0],t),i=this.unproject([this.width,0],t),s=this.unproject([0,this.height],t),a=this.unproject([this.width,this.height],t);return[Math.min(n[0],i[0],s[0],a[0]),Math.min(n[1],i[1],s[1],a[1]),Math.max(n[0],i[0],s[0],a[0]),Math.max(n[1],i[1],s[1],a[1])]}getDistanceScales(e){return e&&this.isGeospatial?_B({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:t,width:n=1,height:i=1}){return e<this.x+this.width&&this.x<e+n&&t<this.y+this.height&&this.y<t+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,H0e(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,t){return null}_initProps(e){const t=e.longitude,n=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=o0e({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||_B({latitude:n,longitude:t}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:a}=e;let o=b5;if(s&&(o=a?new $r(a).transformAsVector(s,[]):s),this.isGeospatial){const u=this.projectPosition([t,n,0]);this.center=new rt(o).scale(this.distanceScales.unitsPerMeter).add(u)}else this.center=this.projectPosition(o)}_initMatrices(e){const{viewMatrix:t=J0e,projectionMatrix:n=null,orthographic:i=!1,fovyRadians:s,fovy:a=75,near:o=.1,far:u=1e3,padding:f=null,focalDistance:g=1}=e;this.viewMatrixUncentered=t,this.viewMatrix=new $r().multiplyRight(t).translate(new rt(this.center).negate()),this.projectionMatrix=n||Y0e({width:this.width,height:this.height,orthographic:i,fovyRadians:s||a*X0e,focalDistance:g,padding:f,near:o,far:u});const y=P0();qf(y,y,this.projectionMatrix),qf(y,y,this.viewMatrix),this.viewProjectionMatrix=y,this.viewMatrixInverse=uB([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=G0e(this.viewMatrixInverse);const A=P0(),C=P0();fO(A,A,[this.width/2,-this.height/2,1]),jC(A,A,[1,-1,0]),qf(C,A,this.viewProjectionMatrix),this.pixelProjectionMatrix=C,this.pixelUnprojectionMatrix=uB(P0(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Rr.warn("Pixel project matrix not invertible")()}}nh.displayName="Viewport";class Qu extends nh{constructor(e={}){const{latitude:t=0,longitude:n=0,zoom:i=0,pitch:s=0,bearing:a=0,nearZMultiplier:o=.1,farZMultiplier:u=1.01,nearZ:f,farZ:g,orthographic:y=!1,projectionMatrix:A,repeat:C=!1,worldOffset:M=0,position:k,padding:D,legacyMeterSizes:V=!1}=e;let{width:W,height:z,altitude:$=1.5}=e;const te=Math.pow(2,i);W=W||1,z=z||1;let le,_e=null;if(A)$=A[5]/2,le=H_($);else{e.fovy?(le=e.fovy,$=vO(le)):le=H_($);let Y;if(D){const{top:ce=0,bottom:oe=0}=D;Y=[0,Xl((ce+z-oe)/2,0,z)-z/2]}_e=l0e({width:W,height:z,scale:te,center:k&&[0,0,k[2]*Iw(t)],offset:Y,pitch:s,fovy:le,nearZMultiplier:o,farZMultiplier:u}),Number.isFinite(f)&&(_e.near=f),Number.isFinite(g)&&(_e.far=g)}let se=a0e({height:z,pitch:s,bearing:a,scale:te,altitude:$});M&&(se=new $r().translate([512*M,0,0]).multiplyLeft(se)),super({...e,width:W,height:z,viewMatrix:se,longitude:n,latitude:t,zoom:i,..._e,fovy:le,focalDistance:$}),this.latitude=t,this.longitude=n,this.zoom=i,this.pitch=s,this.bearing=a,this.altitude=$,this.fovy=le,this.orthographic=y,this._subViewports=C?[]:null,this._pseudoMeters=V,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),t=Math.floor((e[0]+180)/360),n=Math.ceil((e[2]-180)/360);for(let i=t;i<=n;i++){const s=i?new Qu({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[t,n]=this.projectFlat(e),i=(e[2]||0)*Iw(e[1]);return[t,n,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[t,n]=this.unprojectFlat(e),i=(e[2]||0)/Iw(n);return[t,n,i]}addMetersToLngLat(e,t){return MK(e,t)}panByPosition(e,t){const n=AO(t,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=L6([],i,tme([],n)),a=L6([],this.center,s),[o,u]=this.unprojectFlat(a);return{longitude:o,latitude:u}}getBounds(e={}){const t=h0e(this,e.z||0);return[Math.min(t[0][0],t[1][0],t[2][0],t[3][0]),Math.min(t[0][1],t[1][1],t[2][1],t[3][1]),Math.max(t[0][0],t[1][0],t[2][0],t[3][0]),Math.max(t[0][1],t[1][1],t[2][1],t[3][1])]}fitBounds(e,t={}){const{width:n,height:i}=this,{longitude:s,latitude:a,zoom:o}=c0e({width:n,height:i,bounds:e,...t});return new Qu({width:n,height:i,longitude:s,latitude:a,zoom:o})}}Qu.displayName="WebMercatorViewport";const _5=[0,0,0];function FI(r,e,t=!1){const n=e.projectPosition(r);if(t&&e instanceof Qu){const[i,s,a=0]=r,o=e.getDistanceScales([i,s]);n[2]=a*o.unitsPerMeter[2]}return n}function Z0e(r){const{viewport:e,modelMatrix:t,coordinateOrigin:n}=r;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:a}=r;return i===Pr.DEFAULT&&(i=e.isGeospatial?Pr.LNGLAT:Pr.CARTESIAN),s===void 0&&(s=i),a===void 0&&(a=n),{viewport:e,coordinateSystem:i,coordinateOrigin:n,modelMatrix:t,fromCoordinateSystem:s,fromCoordinateOrigin:a}}function LK(r,{viewport:e,modelMatrix:t,coordinateSystem:n,coordinateOrigin:i,offsetMode:s}){let[a,o,u=0]=r;switch(t&&([a,o,u]=Py([],[a,o,u,1],t)),n){case Pr.LNGLAT:return FI([a,o,u],e,s);case Pr.LNGLAT_OFFSETS:return FI([a+i[0],o+i[1],u+(i[2]||0)],e,s);case Pr.METER_OFFSETS:return FI(MK(i,[a,o,u]),e,s);case Pr.CARTESIAN:default:return e.isGeospatial?[a+i[0],o+i[1],u+i[2]]:e.projectPosition([a,o,u])}}function Q0e(r,e){const{viewport:t,coordinateSystem:n,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:a,fromCoordinateOrigin:o}=Z0e(e),{autoOffset:u=!0}=e,{geospatialOrigin:f=_5,shaderCoordinateOrigin:g=_5,offsetMode:y=!1}=u?PK(t,n,i):{},A=LK(r,{viewport:t,modelMatrix:s,coordinateSystem:a,coordinateOrigin:o,offsetMode:y});if(y){const C=t.projectPosition(f||g);oK(A,A,C)}return A}let e_e=1,t_e=1;class NK{constructor(){H(this,"time",0);H(this,"channels",new Map);H(this,"animations",new Map);H(this,"playing",!1);H(this,"lastEngineTime",-1)}addChannel(e){const{delay:t=0,duration:n=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,a=e_e++,o={time:0,delay:t,duration:n,rate:i,repeat:s};return this._setChannelTime(o,this.time),this.channels.set(a,o),a}removeChannel(e){this.channels.delete(e);for(const[t,n]of this.animations)n.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return t===void 0?!1:this.time>=t.delay+t.duration*t.repeat}getTime(e){if(e===void 0)return this.time;const t=this.channels.get(e);return t===void 0?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const i of t)this._setChannelTime(i,this.time);const n=this.animations.values();for(const i of n){const{animation:s,channel:a}=i;s.setTime(this.getTime(a))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const n=t_e++;return this.animations.set(n,{animation:e,channel:t}),e.setTime(this.getTime(t)),n}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const n=t-e.delay,i=e.duration*e.repeat;n>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,n)%e.duration,e.time*=e.rate)}}function r_e(r){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(r):setTimeout(r,1e3/60)}function n_e(r){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(r):clearTimeout(r)}let i_e=0;const LT=class LT{constructor(e){H(this,"device",null);H(this,"canvas",null);H(this,"props");H(this,"animationProps",null);H(this,"timeline",null);H(this,"stats");H(this,"cpuTime");H(this,"gpuTime");H(this,"frameRate");H(this,"display");H(this,"needsRedraw","initialized");H(this,"_initialized",!1);H(this,"_running",!1);H(this,"_animationFrameId",null);H(this,"_nextFramePromise",null);H(this,"_resolveNextFrame",null);H(this,"_cpuStartTime",0);H(this,"_error",null);if(this.props={...LT.defaultAnimationLoopProps,...e},e=this.props,!e.device)throw new Error("No device provided");this.stats=e.stats||new Iy({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}reportError(e){this.props.onError(e),this._error=e}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(e!==!1&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){const t=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(t),t}}stop(){return this._running&&(this.animationProps&&!this._error&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){return this.device?.isLost||this._error?this:(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers(),this)}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){this._running&&(this._animationFrameId=r_e(this._animationFrame.bind(this)))}_cancelAnimationFrame(){this._animationFrameId!==null&&(n_e(this._animationFrameId),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){if(this.display){this.display._renderFrame(e);return}this.props.onRender(this._getAnimationProps()),this.device?.submit()}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeViewport()}_initializeAnimationProps(){const e=this.device?.getDefaultCanvasContext();if(!this.device||!e)throw new Error("loop");const t=e?.canvas,n=e.props.useDevicePixels;this.animationProps={animationLoop:this,device:this.device,canvasContext:e,canvas:t,useDevicePixels:n,timeline:this.timeline,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:e,height:t,aspect:n}=this._getSizeAndAspect();(e!==this.animationProps.width||t!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=this.device.getDefaultCanvasContext().canvas||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(t);const n=this.props.onAddHTML(t);n&&(t.innerHTML=n)}}_getSizeAndAspect(){if(!this.device)return{width:1,height:1,aspect:1};const[e,t]=this.device?.getDefaultCanvasContext().getDevicePixelSize()||[1,1];let n=1;const i=this.device?.getDefaultCanvasContext().canvas;return i&&i.clientHeight?n=i.clientWidth/i.clientHeight:e>0&&t>0&&(n=e/t),{width:e,height:t,aspect:n}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}};H(LT,"defaultAnimationLoopProps",{device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:e=>console.error(e),stats:Z3.stats.get(`animation-loop-${i_e++}`),autoResizeViewport:!1});let vB=LT;const UI={};function Td(r="id"){UI[r]=UI[r]||1;const e=UI[r]++;return`${r}-${e}`}class v5{constructor(e){H(this,"id");H(this,"userData",{});H(this,"topology");H(this,"bufferLayout",[]);H(this,"vertexCount");H(this,"indices");H(this,"attributes");if(this.id=e.id||Td("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&!(this.indices.usage&Li.INDEX))throw new Error("Index buffer must have INDEX usage")}destroy(){this.indices?.destroy();for(const e of Object.values(this.attributes))e.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices||null}_calculateVertexCount(e){return e.byteLength/12}}function s_e(r,e){if(e instanceof v5)return e;const t=o_e(r,e),{attributes:n,bufferLayout:i}=a_e(r,e);return new v5({topology:e.topology||"triangle-list",bufferLayout:i,vertexCount:e.vertexCount,indices:t,attributes:n})}function o_e(r,e){if(!e.indices)return;const t=e.indices.value;return r.createBuffer({usage:Li.INDEX,data:t})}function a_e(r,e){const t=[],n={};for(const[s,a]of Object.entries(e.attributes)){let o=s;switch(s){case"POSITION":o="positions";break;case"NORMAL":o="normals";break;case"TEXCOORD_0":o="texCoords";break;case"COLOR_0":o="colors";break}if(a){n[o]=r.createBuffer({data:a.value,id:`${s}-buffer`});const{value:u,size:f,normalized:g}=a;t.push({name:o,format:fpe(u,f,g)})}}const i=e._calculateVertexCount(e.attributes,e.indices);return{attributes:n,bufferLayout:t,vertexCount:i}}const NT=class NT{constructor(e){H(this,"device");H(this,"cachingEnabled");H(this,"destroyPolicy");H(this,"debug");H(this,"_hashCounter",0);H(this,"_hashes",{});H(this,"_renderPipelineCache",{});H(this,"_computePipelineCache",{});this.device=e,this.cachingEnabled=e.props._cachePipelines,this.destroyPolicy=e.props._cacheDestroyPolicy,this.debug=e.props.debugFactories}static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new NT(e),e._lumaData.defaultPipelineFactory}get[Symbol.toStringTag](){return"PipelineFactory"}toString(){return`PipelineFactory(${this.device.id})`}createRenderPipeline(e){if(!this.cachingEnabled)return this.device.createRenderPipeline(e);const t={...Jf.defaultProps,...e},n=this._renderPipelineCache,i=this._hashRenderPipeline(t);let s=n[i]?.pipeline;return s?(n[i].useCount++,this.debug&&Bt.log(3,`${this}: ${n[i].pipeline} reused, count=${n[i].useCount}, (id=${e.id})`)()):(s=this.device.createRenderPipeline({...t,id:t.id?`${t.id}-cached`:Td("unnamed-cached")}),s.hash=i,n[i]={pipeline:s,useCount:1},this.debug&&Bt.log(3,`${this}: ${s} created, count=${n[i].useCount}`)()),s}createComputePipeline(e){if(!this.cachingEnabled)return this.device.createComputePipeline(e);const t={...LC.defaultProps,...e},n=this._computePipelineCache,i=this._hashComputePipeline(t);let s=n[i]?.pipeline;return s?(n[i].useCount++,this.debug&&Bt.log(3,`${this}: ${n[i].pipeline} reused, count=${n[i].useCount}, (id=${e.id})`)()):(s=this.device.createComputePipeline({...t,id:t.id?`${t.id}-cached`:void 0}),s.hash=i,n[i]={pipeline:s,useCount:1},this.debug&&Bt.log(3,`${this}: ${s} created, count=${n[i].useCount}`)()),s}release(e){if(!this.cachingEnabled){e.destroy();return}const t=this._getCache(e),n=e.hash;t[n].useCount--,t[n].useCount===0?(this._destroyPipeline(e),this.debug&&Bt.log(3,`${this}: ${e} released and destroyed`)()):t[n].useCount<0?(Bt.error(`${this}: ${e} released, useCount < 0, resetting`)(),t[n].useCount=0):this.debug&&Bt.log(3,`${this}: ${e} released, count=${t[n].useCount}`)()}_destroyPipeline(e){const t=this._getCache(e);switch(this.destroyPolicy){case"never":return!1;case"unused":return delete t[e.hash],e.destroy(),!0}}_getCache(e){let t;if(e instanceof LC&&(t=this._computePipelineCache),e instanceof Jf&&(t=this._renderPipelineCache),!t)throw new Error(`${this}`);if(!t[e.hash])throw new Error(`${this}: ${e} matched incorrect entry`);return t}_hashComputePipeline(e){const{type:t}=this.device,n=this._getHash(e.shader.source);return`${t}/C/${n}`}_hashRenderPipeline(e){const t=e.vs?this._getHash(e.vs.source):0,n=e.fs?this._getHash(e.fs.source):0,i="-",s=this._getHash(JSON.stringify(e.bufferLayout)),{type:a}=this.device;switch(a){case"webgl":return`${a}/R/${t}/${n}V${i}BL${s}`;case"webgpu":default:const o=this._getHash(JSON.stringify(e.parameters));return`${a}/R/${t}/${n}V${i}T${e.topology}P${o}BL${s}`}}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}};H(NT,"defaultProps",{...Jf.defaultProps});let AB=NT;const FT=class FT{constructor(e){H(this,"device");H(this,"cachingEnabled");H(this,"destroyPolicy");H(this,"debug");H(this,"_cache",{});this.device=e,this.cachingEnabled=e.props._cacheShaders,this.destroyPolicy=e.props._cacheDestroyPolicy,this.debug=!0}static getDefaultShaderFactory(e){var t;return(t=e._lumaData).defaultShaderFactory||(t.defaultShaderFactory=new FT(e)),e._lumaData.defaultShaderFactory}get[Symbol.toStringTag](){return"ShaderFactory"}toString(){return`${this[Symbol.toStringTag]}(${this.device.id})`}createShader(e){if(!this.cachingEnabled)return this.device.createShader(e);const t=this._hashShader(e);let n=this._cache[t];if(n)n.useCount++,this.debug&&Bt.log(3,`${this}: Reusing shader ${n.shader.id} count=${n.useCount}`)();else{const i=this.device.createShader({...e,id:e.id?`${e.id}-cached`:void 0});this._cache[t]=n={shader:i,useCount:1},this.debug&&Bt.log(3,`${this}: Created new shader ${i.id}`)()}return n.shader}release(e){if(!this.cachingEnabled){e.destroy();return}const t=this._hashShader(e),n=this._cache[t];if(n)if(n.useCount--,n.useCount===0)this.destroyPolicy==="unused"&&(delete this._cache[t],n.shader.destroy(),this.debug&&Bt.log(3,`${this}: Releasing shader ${e.id}, destroyed`)());else{if(n.useCount<0)throw new Error(`ShaderFactory: Shader ${e.id} released too many times`);this.debug&&Bt.log(3,`${this}: Releasing shader ${e.id} count=${n.useCount}`)()}}_hashShader(e){return`${e.stage}:${e.source}`}};H(FT,"defaultProps",{...OC.defaultProps});let xB=FT;function l_e(r,e){const t={},n="Values";if(r.attributes.length===0&&!r.varyings?.length)return{"No attributes or varyings":{[n]:"N/A"}};for(const i of r.attributes)if(i){const s=`${i.location} ${i.name}: ${i.type}`;t[`in ${s}`]={[n]:i.stepMode||"vertex"}}for(const i of r.varyings||[]){const s=`${i.location} ${i.name}`;t[`out ${s}`]={[n]:JSON.stringify(i)}}return t}let Ns=null,zI=null;function c_e(r,{id:e,minimap:t,opaque:n,top:i="0",left:s="0",rgbaScale:a=1}){Ns||(Ns=document.createElement("canvas"),Ns.id=e,Ns.title=e,Ns.style.zIndex="100",Ns.style.position="absolute",Ns.style.top=i,Ns.style.left=s,Ns.style.border="blue 5px solid",Ns.style.transform="scaleY(-1)",document.body.appendChild(Ns),zI=Ns.getContext("2d")),(Ns.width!==r.width||Ns.height!==r.height)&&(Ns.width=r.width/2,Ns.height=r.height/2,Ns.style.width="400px",Ns.style.height="400px");const o=r.device.readPixelsToArrayWebGL(r),u=zI?.createImageData(r.width,r.height);if(u){for(let g=0;g<o.length;g+=4)u.data[0+g+0]=o[g+0]*a,u.data[0+g+1]=o[g+1]*a,u.data[0+g+2]=o[g+2]*a,u.data[0+g+3]=n?255:o[g+3]*a;zI?.putImageData(u,0,0)}}function wB(r,e,t){if(r===e)return!0;if(!t||!r||!e)return!1;if(Array.isArray(r)){if(!Array.isArray(e)||r.length!==e.length)return!1;for(let n=0;n<r.length;n++)if(!wB(r[n],e[n],t-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof r=="object"&&typeof e=="object"){const n=Object.keys(r),i=Object.keys(e);if(n.length!==i.length)return!1;for(const s of n)if(!e.hasOwnProperty(s)||!wB(r[s],e[s],t-1))return!1;return!0}return!1}class VI{constructor(e){H(this,"bufferLayouts");this.bufferLayouts=e}getBufferLayout(e){return this.bufferLayouts.find(t=>t.name===e)||null}getAttributeNamesForBuffer(e){return e.attributes?e.attributes?.map(t=>t.attribute):[e.name]}mergeBufferLayouts(e,t){const n=[...e];for(const i of t){const s=n.findIndex(a=>a.name===i.name);s<0?n.push(i):n[s]=i}return n}getBufferIndex(e){const t=this.bufferLayouts.findIndex(n=>n.name===e);return t===-1&&Bt.warn(`BufferLayout: Missing buffer for "${e}".`)(),t}}function u_e(r,e){const t=Object.fromEntries(r.attributes.map(i=>[i.name,i.location])),n=e.slice();return n.sort((i,s)=>{const a=i.attributes?i.attributes.map(g=>g.attribute):[i.name],o=s.attributes?s.attributes.map(g=>g.attribute):[s.name],u=Math.min(...a.map(g=>t[g])),f=Math.min(...o.map(g=>t[g]));return u-f}),n}function h_e(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function d_e(r){return Array.isArray(r)?r.length===0||typeof r[0]=="number":!1}function f_e(r){return h_e(r)||d_e(r)}function p_e(r){return f_e(r)||typeof r=="number"||typeof r=="boolean"}function g_e(r){const e={bindings:{},uniforms:{}};return Object.keys(r).forEach(t=>{const n=r[t];p_e(n)?e.uniforms[t]=n:e.bindings[t]=n}),e}class m_e{constructor(e,t){H(this,"options",{disableWarnings:!1});H(this,"modules");H(this,"moduleUniforms");H(this,"moduleBindings");Object.assign(this.options,t);const n=Xk(Object.values(e).filter(i=>i.dependencies));for(const i of n)e[i.name]=i;Bt.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(const[i,s]of Object.entries(e))this._addModule(s),s.name&&i!==s.name&&!this.options.disableWarnings&&Bt.warn(`Module name: ${i} vs ${s.name}`)()}destroy(){}setProps(e){for(const t of Object.keys(e)){const n=t,i=e[n]||{},s=this.modules[n];if(!s){this.options.disableWarnings||Bt.warn(`Module ${t} not found`)();continue}const a=this.moduleUniforms[n],o=this.moduleBindings[n],u=s.getUniforms?.(i,a)||i,{uniforms:f,bindings:g}=g_e(u);this.moduleUniforms[n]={...a,...f},this.moduleBindings[n]={...o,...g}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindingValues(){const e={};for(const t of Object.values(this.moduleBindings))Object.assign(e,t);return e}getDebugTable(){const e={};for(const[t,n]of Object.entries(this.moduleUniforms))for(const[i,s]of Object.entries(n))e[`${t}.${i}`]={type:this.modules[t].uniformTypes?.[i],value:String(s)};return e}_addModule(e){const t=e.name;this.moduleUniforms[t]=e.defaultUniforms||{},this.moduleBindings[t]={}}}let y_e="";async function b_e(r,e){const t=new Image;return t.crossOrigin="anonymous",t.src=r.startsWith("http")?r:y_e+r,await t.decode(),e?await createImageBitmap(t,e):await createImageBitmap(t)}const __e=["+X","-X","+Y","-Y","+Z","-Z"],v_e=["+X","-X","+Y","-Y","+Z","-Z"],UT=class UT{constructor(e,t){H(this,"device");H(this,"id");H(this,"props");H(this,"texture");H(this,"sampler");H(this,"view");H(this,"ready");H(this,"isReady",!1);H(this,"destroyed",!1);H(this,"resolveReady",()=>{});H(this,"rejectReady",()=>{});this.device=e;const n=Td("async-texture");this.props={...UT.defaultProps,id:n,...t},this.id=this.props.id,t={...t},typeof t?.data=="string"&&t.dimension==="2d"&&(t.data=b_e(t.data)),t.mipmaps&&(t.mipLevels="auto"),this.ready=new Promise((i,s)=>{this.resolveReady=()=>{this.isReady=!0,i()},this.rejectReady=s}),this.initAsync(t)}get[Symbol.toStringTag](){return"AsyncTexture"}toString(){return`AsyncTexture:"${this.id}"(${this.isReady?"ready":"loading"})`}async initAsync(e){const t=e.data,n=await FK(t).then(void 0,this.rejectReady);if(this.destroyed)return;const i=this.props.width&&this.props.height?{width:this.props.width,height:this.props.height}:this.getTextureDataSize(n);if(!i)throw new Error("Texture size could not be determined");const s={...i,...e,data:void 0,mipLevels:1},a=this.device.getMipLevelCount(s.width,s.height);if(s.mipLevels=this.props.mipLevels==="auto"?a:Math.min(a,this.props.mipLevels),this.texture=this.device.createTexture(s),this.sampler=this.texture.sampler,this.view=this.texture.view,e.data)switch(this.props.dimension){case"1d":this._setTexture1DData(this.texture,n);break;case"2d":this._setTexture2DData(n);break;case"3d":this._setTexture3DData(this.texture,n);break;case"2d-array":this._setTextureArrayData(this.texture,n);break;case"cube":this._setTextureCubeData(this.texture,n);break;case"cube-array":this._setTextureCubeArrayData(this.texture,n);break}this.props.mipmaps&&this.generateMipmaps(),Bt.info(1,`${this} loaded`),this.resolveReady()}destroy(){this.texture&&(this.texture.destroy(),this.texture=null),this.destroyed=!0}generateMipmaps(){this.texture.generateMipmapsWebGL()}setSampler(e={}){this.texture.setSampler(e instanceof ey?e:this.device.createSampler(e))}resize(e){if(!this.isReady)throw new Error("Cannot resize texture before it is ready");if(e.width===this.texture.width&&e.height===this.texture.height)return!1;if(this.texture){const t=this.texture;this.texture=t.clone(e),t.destroy()}return!0}isTextureLevelData(e){const t=e?.data;return ArrayBuffer.isView(t)}getTextureDataSize(e){if(!e||ArrayBuffer.isView(e))return null;if(Array.isArray(e))return this.getTextureDataSize(e[0]);if(this.device.isExternalImage(e))return this.device.getExternalImageSize(e);if(e&&typeof e=="object"&&e.constructor===Object){const n=Object.values(e)[0];return{width:n.width,height:n.height}}throw new Error("texture size deduction failed")}getCubeFaceDepth(e){switch(e){case"+X":return 0;case"-X":return 1;case"+Y":return 2;case"-Y":return 3;case"+Z":return 4;case"-Z":return 5;default:throw new Error(e)}}setTextureData(e){}_setTexture1DData(e,t){throw new Error("setTexture1DData not supported in WebGL.")}_setTexture2DData(e,t=0){if(!this.texture)throw new Error("Texture not initialized");const n=this._normalizeTextureData(e);n.length>1&&this.props.mipmaps!==!1&&Bt.warn(`Texture ${this.id} mipmap and multiple LODs.`)();for(let i=0;i<n.length;i++){const s=n[i];this.device.isExternalImage(s)?this.texture.copyExternalImage({image:s,depth:t,mipLevel:i,flipY:!0}):this.texture.copyImageData({data:s.data,mipLevel:i})}}_setTexture3DData(e,t){if(this.texture?.props.dimension!=="3d")throw new Error(this.id);for(let n=0;n<t.length;n++)this._setTexture2DData(t[n],n)}_setTextureCubeData(e,t){if(this.texture?.props.dimension!=="cube")throw new Error(this.id);for(const[n,i]of Object.entries(t)){const s=v_e.indexOf(n);this._setTexture2DData(i,s)}}_setTextureArrayData(e,t){if(this.texture?.props.dimension!=="2d-array")throw new Error(this.id);for(let n=0;n<t.length;n++)this._setTexture2DData(t[n],n)}_setTextureCubeArrayData(e,t){throw new Error("setTextureCubeArrayData not supported in WebGL2.")}_setTextureCubeFaceData(e,t,n,i=0){Array.isArray(t)&&t.length>1&&this.props.mipmaps!==!1&&Bt.warn(`${this.id} has mipmap and multiple LODs.`)();const s=__e.indexOf(n);this._setTexture2DData(t,s)}_normalizeTextureData(e){const t=this.texture;let n;return ArrayBuffer.isView(e)?n=[{data:e,width:t.width,height:t.height}]:Array.isArray(e)?n=e:n=[e],n}};H(UT,"defaultProps",{...ca.defaultProps,data:null,mipmaps:!1});let t_=UT;async function FK(r){if(r=await r,Array.isArray(r))return await Promise.all(r.map(FK));if(r&&typeof r=="object"&&r.constructor===Object){const e=r,t=await Promise.all(Object.values(e)),n=Object.keys(e),i={};for(let s=0;s<n.length;s++)i[n[s]]=t[s];return i}return r}const xf=2,A_e=1e4,zT=class zT{constructor(e,t){H(this,"device");H(this,"id");H(this,"source");H(this,"vs");H(this,"fs");H(this,"pipelineFactory");H(this,"shaderFactory");H(this,"userData",{});H(this,"parameters");H(this,"topology");H(this,"bufferLayout");H(this,"isInstanced");H(this,"instanceCount",0);H(this,"vertexCount");H(this,"indexBuffer",null);H(this,"bufferAttributes",{});H(this,"constantAttributes",{});H(this,"bindings",{});H(this,"vertexArray");H(this,"transformFeedback",null);H(this,"pipeline");H(this,"shaderInputs");H(this,"_uniformStore");H(this,"_attributeInfos",{});H(this,"_gpuGeometry",null);H(this,"props");H(this,"_pipelineNeedsUpdate","newly created");H(this,"_needsRedraw","initializing");H(this,"_destroyed",!1);H(this,"_lastDrawTimestamp",-1);H(this,"_lastLogTime",0);H(this,"_logOpen",!1);H(this,"_drawCount",0);var u;this.props={...zT.defaultProps,...t},t=this.props,this.id=t.id||Td("model"),this.device=e,Object.assign(this.userData,t.userData);const n=Object.fromEntries(this.props.modules?.map(f=>[f.name,f])||[]),i=t.shaderInputs||new m_e(n,{disableWarnings:this.props.disableWarnings});this.setShaderInputs(i);const s=w_e(e),a=(this.props.modules?.length>0?this.props.modules:this.shaderInputs?.getModules())||[];if(this.device.type==="webgpu"&&this.props.source){const{source:f,getUniforms:g}=this.props.shaderAssembler.assembleWGSLShader({platformInfo:s,...this.props,modules:a});this.source=f,this._getModuleUniforms=g,(u=this.props).shaderLayout||(u.shaderLayout=$ge(this.source))}else{const{vs:f,fs:g,getUniforms:y}=this.props.shaderAssembler.assembleGLSLShaderPair({platformInfo:s,...this.props,modules:a});this.vs=f,this.fs=g,this._getModuleUniforms=y}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,t.geometry&&this.setGeometry(t.geometry),this.pipelineFactory=t.pipelineFactory||AB.getDefaultPipelineFactory(this.device),this.shaderFactory=t.shaderFactory||xB.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({shaderLayout:this.pipeline.shaderLayout,bufferLayout:this.pipeline.bufferLayout}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in t&&(this.isInstanced=t.isInstanced),t.instanceCount&&this.setInstanceCount(t.instanceCount),t.vertexCount&&this.setVertexCount(t.vertexCount),t.indexBuffer&&this.setIndexBuffer(t.indexBuffer),t.attributes&&this.setAttributes(t.attributes),t.constantAttributes&&this.setConstantAttributes(t.constantAttributes),t.bindings&&this.setBindings(t.bindings),t.transformFeedback&&(this.transformFeedback=t.transformFeedback),Object.seal(this)}get[Symbol.toStringTag](){return"Model"}toString(){return`Model(${this.id})`}destroy(){this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),this._gpuGeometry?.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||(this._needsRedraw=e)}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){const t=this._areBindingsLoading();if(t)return Bt.info(xf,`>>> DRAWING ABORTED ${this.id}: ${t} not loaded`)(),!1;try{e.pushDebugGroup(`${this}.predraw(${e})`),this.predraw()}finally{e.popDebugGroup()}let n;try{e.pushDebugGroup(`${this}.draw(${e})`),this._logDrawCallStart(),this.pipeline=this._updatePipeline();const i=this._getBindings();this.pipeline.setBindings(i,{disableWarnings:this.props.disableWarnings});const{indexBuffer:s}=this.vertexArray,a=s?s.byteLength/(s.indexType==="uint32"?4:2):void 0;n=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:a,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{e.popDebugGroup(),this._logDrawCallEnd()}return this._logFramebuffer(e),n?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",n}setGeometry(e){this._gpuGeometry?.destroy();const t=e&&s_e(this.device,e);if(t){this.setTopology(t.topology||"triangle-list");const n=new VI(this.bufferLayout);this.bufferLayout=n.mergeBufferLayouts(t.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(t)}this._gpuGeometry=t}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){const t=new VI(this.bufferLayout);this.bufferLayout=this._gpuGeometry?t.mergeBufferLayouts(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({shaderLayout:this.pipeline.shaderLayout,bufferLayout:this.pipeline.bufferLayout}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){wB(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,this.isInstanced===void 0&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new uge(this.shaderInputs.modules);for(const[t,n]of Object.entries(this.shaderInputs.modules))if(x_e(n)){const i=this._uniformStore.getManagedUniformBuffer(this.device,t);this.bindings[`${t}Uniforms`]=i}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindingValues()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,t){const n=t?.disableWarnings??this.props.disableWarnings;e.indices&&Bt.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)(),this.bufferLayout=u_e(this.pipeline.shaderLayout,this.bufferLayout);const i=new VI(this.bufferLayout);for(const[s,a]of Object.entries(e)){const o=i.getBufferLayout(s);if(!o){n||Bt.warn(`Model(${this.id}): Missing layout for buffer "${s}".`)();continue}const u=i.getAttributeNamesForBuffer(o);let f=!1;for(const g of u){const y=this._attributeInfos[g];if(y){const A=this.device.type==="webgpu"?i.getBufferIndex(y.bufferName):y.location;this.vertexArray.setBuffer(A,a),f=!0}}!f&&!n&&Bt.warn(`Model(${this.id}): Ignoring buffer "${a.id}" for unknown attribute "${s}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,t){for(const[n,i]of Object.entries(e)){const s=this._attributeInfos[n];s?this.vertexArray.setConstantWebGL(s.location,i):(t?.disableWarnings??this.props.disableWarnings)||Bt.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${n}"`)()}this.setNeedsRedraw("constants")}_areBindingsLoading(){for(const e of Object.values(this.bindings))if(e instanceof t_&&!e.isReady)return e.id;return!1}_getBindings(){const e={};for(const[t,n]of Object.entries(this.bindings))n instanceof t_?n.isReady&&(e[t]=n.texture):e[t]=n;return e}_getBindingsUpdateTimestamp(){let e=0;for(const t of Object.values(this.bindings))t instanceof kC?e=Math.max(e,t.texture.updateTimestamp):t instanceof Li||t instanceof ca?e=Math.max(e,t.updateTimestamp):t instanceof t_?e=t.texture?Math.max(e,t.texture.updateTimestamp):1/0:t instanceof ey||(e=Math.max(e,t.buffer.updateTimestamp));return e}_setGeometryAttributes(e){const t={...e.attributes};for(const[n]of Object.entries(t))!this.pipeline.shaderLayout.attributes.find(i=>i.name===n)&&n!=="positions"&&delete t[n];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(t,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||(this._pipelineNeedsUpdate=e),this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,t=null;this.pipeline&&(Bt.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),e=this.pipeline.vs,t=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const n=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debugShaders:this.props.debugShaders});let i=null;this.source?i=n:this.fs&&(i=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debugShaders:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,bindings:this._getBindings(),vs:n,fs:i}),this._attributeInfos=wW(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),t&&this.shaderFactory.release(t)}return this.pipeline}_logDrawCallStart(){const e=Bt.level>3?0:A_e;Bt.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,Bt.group(xf,`>>> DRAWING MODEL ${this.id}`,{collapsed:Bt.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const e=l_e(this.pipeline.shaderLayout,this.id);Bt.table(xf,e)();const t=this.shaderInputs.getDebugTable();Bt.table(xf,t)();const n=this._getAttributeDebugTable();Bt.table(xf,this._attributeInfos)(),Bt.table(xf,n)(),Bt.groupEnd(xf)(),this._logOpen=!1}}_logFramebuffer(e){const t=this.device.props.debugFramebuffers;if(this._drawCount++,!t)return;const n=e.props.framebuffer;n&&c_e(n,{id:n.id,minimap:!0})}_getAttributeDebugTable(){const e={};for(const[t,n]of Object.entries(this._attributeInfos)){const i=this.vertexArray.attributes[n.location];e[n.location]={name:t,type:n.shaderType,values:i?this._getBufferOrConstantValues(i,n.bufferDataType):"null"}}if(this.vertexArray.indexBuffer){const{indexBuffer:t}=this.vertexArray,n=t.indexType==="uint32"?new Uint32Array(t.debugData):new Uint16Array(t.debugData);e.indices={name:"indices",type:t.indexType,values:n.toString()}}return e}_getBufferOrConstantValues(e,t){const n=qk(t);return(e instanceof Li?new n(e.debugData):e).toString()}};H(zT,"defaultProps",{...Jf.defaultProps,source:void 0,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:MC.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0});let Mi=zT;function x_e(r){return!!(r.uniformTypes&&!C_e(r.uniformTypes))}function w_e(r){return{type:r.type,shaderLanguage:r.info.shadingLanguage,shaderLanguageVersion:r.info.shadingLanguageVersion,gpu:r.info.gpu,features:r.features}}function C_e(r){for(const e in r)return!1;return!0}const g_=class g_{constructor(e,t=g_.defaultProps){H(this,"device");H(this,"model");H(this,"transformFeedback");if(!g_.isSupported(e))throw new Error("BufferTransform not yet implemented on WebGPU");this.device=e,this.model=new Mi(this.device,{id:t.id||"buffer-transform-model",fs:t.fs||yW(),topology:t.topology||"point-list",varyings:t.outputs||t.varyings,...t}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:t.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}static isSupported(e){return e?.info?.type==="webgl"}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){e?.inputBuffers&&this.model.setAttributes(e.inputBuffers),e?.outputBuffers&&this.transformFeedback.setBuffers(e.outputBuffers);const t=this.device.beginRenderPass(e);this.model.draw(t),t.end()}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){const t=this.getBuffer(e);if(!t)throw new Error("BufferTransform#getBuffer");if(t instanceof Li)return t.readAsync();const{buffer:n,byteOffset:i=0,byteLength:s=n.byteLength}=t;return n.readAsync(i,s)}};H(g_,"defaultProps",{...Mi.defaultProps,outputs:void 0,feedbackBuffers:void 0});let sy=g_;const T_e="transform_output";class A5{constructor(e,t){H(this,"device");H(this,"model");H(this,"sampler");H(this,"currentIndex",0);H(this,"samplerTextureMap",null);H(this,"bindings",[]);H(this,"resources",{});this.device=e,this.sampler=e.createSampler({addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",minFilter:"nearest",magFilter:"nearest",mipmapFilter:"nearest"}),this.model=new Mi(this.device,{id:t.id||Td("texture-transform-model"),fs:t.fs||yW({input:t.targetTextureVarying,inputChannels:t.targetTextureChannels,output:T_e}),vertexCount:t.vertexCount,...t}),this._initialize(t),Object.seal(this)}destroy(){this.model.destroy();for(const e of this.bindings)e.framebuffer?.destroy()}delete(){this.destroy()}run(e){const{framebuffer:t}=this.bindings[this.currentIndex],n=this.device.beginRenderPass({framebuffer:t,...e});this.model.draw(n),n.end(),this.device.submit()}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}_initialize(e){this._updateBindings(e)}_updateBindings(e){this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e)}_updateBinding(e,{sourceBuffers:t,sourceTextures:n,targetTexture:i}){if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,n),Object.assign(e.sourceBuffers,t),i){e.targetTexture=i;const{width:s,height:a}=i;e.framebuffer&&e.framebuffer.destroy(),e.framebuffer=this.device.createFramebuffer({id:"transform-framebuffer",width:s,height:a,colorAttachments:[i]}),e.framebuffer.resize({width:s,height:a})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:t}=this.bindings[e];for(const n in t)t[n].sampler=this.sampler}}class To{constructor(e){H(this,"id");H(this,"topology");H(this,"vertexCount");H(this,"indices");H(this,"attributes");H(this,"userData",{});const{attributes:t={},indices:n=null,vertexCount:i=null}=e;this.id=e.id||Td("geometry"),this.topology=e.topology,n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n),this.attributes={};for(const[s,a]of Object.entries(t)){const o=ArrayBuffer.isView(a)?{value:a}:a;if(!ArrayBuffer.isView(o.value))throw new Error(`${this._print(s)}: must be typed array or object with value as typed array`);if((s==="POSITION"||s==="positions")&&!o.size&&(o.size=3),s==="indices"){if(this.indices)throw new Error("Multiple indices detected");this.indices=o}else this.attributes[s]=o}this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=i||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,t){return this}_calculateVertexCount(e,t){if(t)return t.value.length;let n=1/0;for(const i of Object.values(e)){const{value:s,size:a,constant:o}=i;!o&&s&&a!==void 0&&a>=1&&(n=Math.min(n,s.length/a))}return n}}class WC{constructor(e={}){H(this,"id");H(this,"matrix",new $r);H(this,"display",!0);H(this,"position",new rt);H(this,"rotation",new rt);H(this,"scale",new rt(1,1,1));H(this,"userData",{});H(this,"props",{});const{id:t}=e;this.id=t||Td(this.constructor.name),this._setScenegraphNodeProps(e)}getBounds(){return null}destroy(){}delete(){this.destroy()}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return`{type: ScenegraphNode, id: ${this.id})}`}setPosition(e){return this.position=e,this}setRotation(e){return this.rotation=e,this}setScale(e){return this.scale=e,this}setMatrix(e,t=!0){t?this.matrix.copy(e):this.matrix=e}setMatrixComponents(e){const{position:t,rotation:n,scale:i,update:s=!0}=e;return t&&this.setPosition(t),n&&this.setRotation(n),i&&this.setScale(i),s&&this.updateMatrix(),this}updateMatrix(){const e=this.position,t=this.rotation,n=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(t),this.matrix.scale(n),this}update(e={}){const{position:t,rotation:n,scale:i}=e;return t&&this.setPosition(t),n&&this.setRotation(n),i&&this.setScale(i),this.updateMatrix(),this}getCoordinateUniforms(e,t){t=t||this.matrix;const n=new $r(e).multiplyRight(t),i=n.invert(),s=i.transpose();return{viewMatrix:e,modelMatrix:t,objectMatrix:t,worldMatrix:n,worldInverseMatrix:i,worldInverseTransposeMatrix:s}}_setScenegraphNodeProps(e){"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}class By extends WC{constructor(t={}){t=Array.isArray(t)?{children:t}:t;const{children:n=[]}=t;Bt.assert(n.every(i=>i instanceof WC),"every child must an instance of ScenegraphNode");super(t);H(this,"children");this.children=n}getBounds(){const t=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];return this.traverse((n,{worldMatrix:i})=>{const s=n.getBounds();if(!s)return;const[a,o]=s,u=new rt(a).add(o).divide([2,2,2]);i.transformAsPoint(u,u);const f=new rt(o).subtract(a).divide([2,2,2]);i.transformAsVector(f,f);for(let g=0;g<8;g++){const y=new rt(g&1?-1:1,g&2?-1:1,g&4?-1:1).multiply(f).add(u);for(let A=0;A<3;A++)t[0][A]=Math.min(t[0][A],y[A]),t[1][A]=Math.max(t[1][A],y[A])}}),Number.isFinite(t[0][0])?t:null}destroy(){this.children.forEach(t=>t.destroy()),this.removeAll(),super.destroy()}add(...t){for(const n of t)Array.isArray(n)?this.add(...n):this.children.push(n);return this}remove(t){const n=this.children,i=n.indexOf(t);return i>-1&&n.splice(i,1),this}removeAll(){return this.children=[],this}traverse(t,{worldMatrix:n=new $r}={}){const i=new $r(n).multiplyRight(this.matrix);for(const s of this.children)s instanceof By?s.traverse(t,{worldMatrix:i}):t(s,{worldMatrix:i})}}class CB extends WC{constructor(t){super(t);H(this,"model");H(this,"bounds",null);H(this,"managedResources");this.model=t.model,this.managedResources=t.managedResources||[],this.bounds=t.bounds||null,this.setProps(t)}destroy(){this.model&&(this.model.destroy(),this.model=null),this.managedResources.forEach(t=>t.destroy()),this.managedResources=[]}getBounds(){return this.bounds}draw(t){return this.model.draw(t)}}class UK extends To{constructor(e={}){const{id:t=Td("cube-geometry"),indices:n=!0}=e;super(n?{...e,id:t,topology:"triangle-list",indices:{size:1,value:S_e},attributes:{...k_e,...e.attributes}}:{...e,id:t,topology:"triangle-list",indices:void 0,attributes:{...O_e,...e.attributes}})}}const S_e=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),E_e=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),I_e=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),P_e=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),B_e=new Float32Array([1,-1,1,-1,-1,1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,-1,-1,1,1,1,1,1,1,1,-1,-1,1,-1,-1,1,1,1,1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,-1,1,-1,1,1,1,-1,1,1,-1,-1,1,-1,-1,1,1,-1,1,1,1,1,1,-1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1]),M_e=new Float32Array([1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,1,0,0]),R_e=new Float32Array([1,0,1,1,0,0,1,1,0,0,0,1,1,0,0,1,1,0,1,1,0,0,0,1,1,1,1,1,1,0,1,1,1,0,0,1,1,1,0,1,1,1,1,1,1,0,0,1,0,1,1,1,1,1,1,1,1,1,0,1,0,1,0,1,0,1,1,1,1,1,0,1,0,0,1,1,0,1,1,1,0,1,0,1,0,0,0,1,0,0,1,1,0,1,0,1,1,1,1,1,0,1,1,1,0,0,1,1,0,0,1,1,1,0,1,1,1,1,1,1,1,0,0,1,0,0,0,1,0,1,0,1,1,1,0,1,1,0,0,1,0,1,0,1]),k_e={POSITION:{size:3,value:E_e},NORMAL:{size:3,value:I_e},TEXCOORD_0:{size:2,value:P_e}},O_e={POSITION:{size:3,value:B_e},TEXCOORD_0:{size:2,value:M_e},COLOR_0:{size:3,value:R_e}},D_e={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant",blendAlphaDstFactor:"zero"};class zK extends xO{constructor(){super(...arguments),this._colorEncoderState=null}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:t,views:n,viewports:i,onViewportActive:s,pickingFBO:a,deviceRect:{x:o,y:u,width:f,height:g},cullRect:y,effects:A,pass:C="picking",pickZ:M,shaderModuleProps:k}){this.pickZ=M;const D=this._resetColorEncoder(M),V=[o,u,f,g],W=super.render({target:a,layers:e,layerFilter:t,views:n,viewports:i,onViewportActive:s,cullRect:y,effects:A?.filter($=>$.useInPicking),pass:C,isPicking:!0,shaderModuleProps:k,clearColor:[0,0,0,0],colorMask:15,scissorRect:V});return this._colorEncoderState=null,{decodePickingColor:D&&N_e.bind(null,D),stats:W}}shouldDrawLayer(e){const{pickable:t,operation:n}=e.props;return t&&n.includes("draw")||n.includes("terrain")||n.includes("mask")}getShaderModuleProps(e,t,n){return{picking:{isActive:1,isAttribute:this.pickZ},lighting:{enabled:!1}}}getLayerParameters(e,t,n){const i={...e.props.parameters},{pickable:s,operation:a}=e.props;return!this._colorEncoderState||a.includes("terrain")?i.blend=!1:s&&a.includes("draw")&&(Object.assign(i,D_e),i.blend=!0,i.blendColor=L_e(this._colorEncoderState,e,n)),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function L_e(r,e,t){const{byLayer:n,byAlpha:i}=r;let s,a=n.get(e);return a?(a.viewports.push(t),s=a.a):(s=n.size+1,s<=255?(a={a:s,layer:e,viewports:[t]},n.set(e,a),i[s]=a):(Rr.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function N_e(r,e){const t=r.byAlpha[e[3]];return t&&{pickedLayer:t.layer,pickedViewports:t.viewports,pickedObjectIndex:t.layer.decodePickingColor(e)}}const sm={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},KC=Symbol.for("component"),bd=Symbol.for("propTypes"),$I=Symbol.for("deprecatedProps"),Fm=Symbol.for("asyncPropDefaults"),pp=Symbol.for("asyncPropOriginal"),ad=Symbol.for("asyncPropResolved");function xd(r,e=()=>!0){return Array.isArray(r)?VK(r,e,[]):e(r)?[r]:[]}function VK(r,e,t){let n=-1;for(;++n<r.length;){const i=r[n];Array.isArray(i)?VK(i,e,t):e(i)&&t.push(i)}return t}function F_e({target:r,source:e,start:t=0,count:n=1}){const i=e.length,s=n*i;let a=0;for(let o=t;a<i;a++)r[o++]=e[a];for(;a<s;)a<s-a?(r.copyWithin(t+a,t,t+a),a*=2):(r.copyWithin(t+a,t,t+s-a),a=s);return r}class U_e{constructor(e,t,n){this._loadCount=0,this._subscribers=new Set,this.id=e,this.context=n,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,t){if(e===this._data&&!t)return;this._data=e;const n=++this._loadCount;let i=e;typeof e=="string"&&(i=Yu(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===n&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class z_e{constructor(e){this.protocol=e.protocol||"resource://",this._context={device:e.device,gl:e.device?.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:t,forceUpdate:n=!1,persistent:i=!0}){let s=this._resources[e];s?s.setData(t,n):(s=new U_e(e,t,this._context),this._resources[e]=s),s.persistent=i}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const t=this._consumers[e];if(t){for(const n in t){const i=t[n],s=this._resources[i.resourceId];s&&s.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:t,consumerId:n,requestId:i="default"}){const{_resources:s,protocol:a}=this;e.startsWith(a)&&(e=e.replace(a,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const o=s[e];if(this._track(n,i,o,t),o)return o.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,n,i){const s=this._consumers,a=s[e]=s[e]||{};let o=a[t];const u=o&&o.resourceId&&this._resources[o.resourceId];u&&(u.unsubscribe(o),this.prune()),n&&(o?(o.onChange=i,o.resourceId=n.id):o={onChange:i,resourceId:n.id},a[t]=o,n.subscribe(o))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];!t.persistent&&!t.inUse()&&(t.delete(),delete this._resources[e])}}}const V_e="layerManager.setLayers",$_e="layerManager.activateViewport";class j_e{constructor(e,t){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=o=>{bo($_e,this,o),o&&(this.context.viewport=o)};const{deck:n,stats:i,viewport:s,timeline:a}=t||{};this.layers=[],this.resourceManager=new z_e({device:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:e,gl:e?.gl,deck:n,shaderAssembler:I0e(e?.info?.shadingLanguage||"glsl"),defaultShaderModules:[Nye],renderPass:void 0,stats:i||new Iy({id:"deck.gl"}),viewport:s||new nh({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:a||new NK,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const i=n.getNeedsRedraw(e);t=t||i}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(t=>e.find(n=>t.id.indexOf(n)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){bo(V_e,this,t,e),this._lastRenderedLayers=e;const n=xd(e,Boolean);for(const i of n)i.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw(`updating layers: ${e}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}addDefaultShaderModule(e){const{defaultShaderModules:t}=this.context;t.find(n=>n.name===e.name)||(t.push(e),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(e){const{defaultShaderModules:t}=this.context,n=t.findIndex(i=>i.name===e.name);n>=0&&(t.splice(n,1),this._defaultShaderModulesChanged=!0)}_handleError(e,t,n){n.raiseError(t,`${e} of ${n}`)}_updateLayers(e,t){const n={};for(const a of e)n[a.id]?Rr.warn(`Multiple old layers with same id ${a.id}`)():n[a.id]=a;if(this._defaultShaderModulesChanged){for(const a of e)a.setNeedsUpdate(),a.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}const i=[];this._updateSublayersRecursively(t,n,i),this._finalizeOldLayers(n);let s=!1;for(const a of i)if(a.hasUniformTransition()){s=`Uniform transition in ${a}`;break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,t,n){for(const i of e){i.context=this.context;const s=t[i.id];s===null&&Rr.warn(`Multiple new layers with same id ${i.id}`)(),t[i.id]=null;let a=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),n.push(i),a=i.isComposite?i.getSubLayers():null}catch(o){this._handleError("matching",o,i)}a&&this._updateSublayersRecursively(a,t,n)}}_finalizeOldLayers(e){for(const t in e){const n=e[t];n&&this._finalizeLayer(n)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=sm.INITIALIZED}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle=sm.MATCHED,t!==e&&(e.lifecycle=sm.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||`finalized ${e}`,e.lifecycle=sm.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=sm.FINALIZED}catch(t){this._handleError("finalization",t,e)}}}function Ms(r,e,t){if(r===e)return!0;if(!t||!r||!e)return!1;if(Array.isArray(r)){if(!Array.isArray(e)||r.length!==e.length)return!1;for(let n=0;n<r.length;n++)if(!Ms(r[n],e[n],t-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof r=="object"&&typeof e=="object"){const n=Object.keys(r),i=Object.keys(e);if(n.length!==i.length)return!1;for(const s of n)if(!e.hasOwnProperty(s)||!Ms(r[s],e[s],t-1))return!1;return!0}return!1}class G_e{constructor(e){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const t=this.controllers[e];t&&t.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter(t=>t.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(t=>{e[t.id]=t}),e}getView(e){return this.views.find(t=>t.id===e)}getViewState(e){const t=typeof e=="string"?this.getView(e):e,n=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(n):n}getViewport(e){return this._viewportMap[e]}unproject(e,t){const n=this.getViewports(),i={x:e[0],y:e[1]};for(let s=n.length-1;s>=0;--s){const a=n[s];if(a.containsPixel(i)){const o=e.slice();return o[0]-=a.x,o[1]-=a.y,a.unproject(o,t)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){(e!==this.width||t!==this.height)&&(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=xd(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Ms(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Rr.warn("missing `viewState` or `initialViewState`")()}_createController(e,t){const n=t.type;return new n({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>this.getView(e.id)?.makeViewport({viewState:s,width:this.width,height:this.height})})}_updateController(e,t,n,i){const s=e.controller;if(s&&n){const a={...t,...s,id:e.id,x:n.x,y:n.y,width:n.width,height:n.height};return(!i||i.constructor!==s.type)&&(i=this._createController(e,a)),i&&i.setProps(a),i}return null}_rebuildViewports(){const{views:e}=this,t=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let i=e.length;i--;){const s=e[i],a=this.getViewState(s),o=s.makeViewport({viewState:a,width:this.width,height:this.height});let u=t[s.id];const f=!!s.controller;f&&!u&&(n=!0),(n||!f)&&u&&(u.finalize(),u=null),this.controllers[s.id]=this._updateController(s,a,o,u),o&&this._viewports.unshift(o)}for(const i in t){const s=t[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,t){return e.length!==t.length?!0:e.some((n,i)=>!e[i].equals(t[i]))}}const H_e=/([0-9]+\.?[0-9]*)(%|px)/;function zh(r){switch(typeof r){case"number":return{position:r,relative:!1};case"string":const e=H_e.exec(r);if(e&&e.length>=3){const t=e[2]==="%",n=parseFloat(e[1]);return{position:t?n/100:n,relative:t}}default:throw new Error(`Could not parse position string ${r}`)}}function Vh(r,e){return r.relative?Math.round(r.position*e):r.position}class $K{constructor(e){const{id:t,x:n=0,y:i=0,width:s="100%",height:a="100%",padding:o=null}=e;this.id=t||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=zh(n),this._y=zh(i),this._width=zh(s),this._height=zh(a),this._padding=o&&{left:zh(o.left||0),right:zh(o.right||0),top:zh(o.top||0),bottom:zh(o.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.constructor===e.constructor&&Ms(this.props,e.props,2)}clone(e){const t=this.constructor;return new t({...this.props,...e})}makeViewport({width:e,height:t,viewState:n}){n=this.filterViewState(n);const i=this.getDimensions({width:e,height:t});if(!i.height||!i.width)return null;const s=this.getViewportType(n);return new s({...n,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const t={...e};for(const n in this.props.viewState)n!=="id"&&(t[n]=this.props.viewState[n]);return t}return e}getDimensions({width:e,height:t}){const n={x:Vh(this._x,e),y:Vh(this._y,t),width:Vh(this._width,e),height:Vh(this._height,t)};return this._padding&&(n.padding={left:Vh(this._padding.left,e),top:Vh(this._padding.top,t),right:Vh(this._padding.right,e),bottom:Vh(this._padding.bottom,t)}),n}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class FS{constructor(e){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=e}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings=e,this._inProgress=!0,this.settings.onStart?.(this)}end(){this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd?.(this))}cancel(){this._inProgress&&(this.settings.onInterrupt?.(this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:e,settings:t}=this;this._handle=e.addChannel({delay:e.getTime(),duration:t.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate?.(this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const x5=()=>{},TB={BREAK:1,SNAP_TO_END:2,IGNORE:3},W_e=r=>r,K_e=TB.BREAK;class X_e{constructor(e){this._onTransitionUpdate=t=>{const{time:n,settings:{interpolator:i,startProps:s,endProps:a,duration:o,easing:u}}=t,f=u(n/o),g=i.interpolateProps(s,a,f);this.propsInTransition=this.getControllerState({...this.props,...g}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new FS(e.timeline),this.onViewStateChange=e.onViewStateChange||x5,this.onStateChange=e.onStateChange||x5}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const n=this.props;if(this.props=e,!n||this._shouldIgnoreViewportChange(n,e))return!1;if(this._isTransitionEnabled(e)){let i=n;if(this.transition.inProgress){const{interruption:s,endProps:a}=this.transition.settings;i={...n,...s===TB.SNAP_TO_END?a:this.propsInTransition||n}}this._triggerTransition(i,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:n}=e;return(t>0||t==="auto")&&!!n}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,t){return this.transition.inProgress?this.transition.settings.interruption===TB.IGNORE||this._isUpdateDueToCurrentTransition(t):this._isTransitionEnabled(t)?t.transitionInterpolator.arePropsEqual(e,t):!0}_triggerTransition(e,t){const n=this.getControllerState(e),i=this.getControllerState(t).shortestPathFrom(n),s=t.transitionInterpolator,a=s.getDuration?s.getDuration(e,t):t.transitionDuration;if(a===0)return;const o=s.initializeProps(e,i);this.propsInTransition={};const u={duration:a,easing:t.transitionEasing||W_e,interpolator:s,interruption:t.transitionInterruption||K_e,startProps:o.start,endProps:o.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)};this.transition.start(u),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(t)}}}function vs(r,e){if(!r)throw new Error(e||"deck.gl: assertion failed.")}class J_e{constructor(e){const{compare:t,extract:n,required:i}=e;this._propsToCompare=t,this._propsToExtract=n||t,this._requiredProps=i}arePropsEqual(e,t){for(const n of this._propsToCompare)if(!(n in e)||!(n in t)||!ml(e[n],t[n]))return!1;return!0}initializeProps(e,t){const n={},i={};for(const s of this._propsToExtract)(s in e||s in t)&&(n[s]=e[s],i[s]=t[s]);return this._checkRequiredProps(n),this._checkRequiredProps(i),{start:n,end:i}}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(t=>{const n=e[t];vs(Number.isFinite(n)||Array.isArray(n),`${t} is required for transition`)})}}const q_e=["longitude","latitude","zoom","bearing","pitch"],Y_e=["longitude","latitude","zoom"];class wO extends J_e{constructor(e={}){const t=Array.isArray(e)?e:e.transitionProps,n=Array.isArray(e)?{}:e;n.transitionProps=Array.isArray(t)?{compare:t,required:t}:t||{compare:q_e,required:Y_e},super(n.transitionProps),this.opts=n}initializeProps(e,t){const n=super.initializeProps(e,t),{makeViewport:i,around:s}=this.opts;if(i&&s){const a=i(e),o=i(t),u=a.unproject(s);n.start.around=s,Object.assign(n.end,{around:o.project(u),aroundPosition:u,width:t.width,height:t.height})}return n}interpolateProps(e,t,n){const i={};for(const s of this._propsToExtract)i[s]=Hu(e[s]||0,t[s]||0,n);if(t.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...t,...i});Object.assign(i,s.panByPosition(t.aroundPosition,Hu(e.around,t.around,n)))}return i}}const Su={transitionDuration:0},Z_e=300,nx=r=>1-(1-r)*(1-r),Ng={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],MULTI_PAN:["multipanstart","multipanmove","multipanend"],DOUBLE_CLICK:["dblclick"],KEYBOARD:["keydown"]},wf={};class jK{constructor(e){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new X_e({...e,getControllerState:t=>new this.ControllerState(t),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const e in this._events)this._events[e]&&this.eventManager?.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const t=this._eventStartBlocked;switch(e.type){case"panstart":return t?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return t?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"multipanstart":return t?!1:this._onMultiPanStart(e);case"multipanmove":return this._onMultiPan(e);case"multipanend":return this._onMultiPanEnd(e);case"dblclick":return this._onDoubleClick(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:t,y:n}=this.props,{offsetCenter:i}=e;return[i.x-t,i.y-n]}isPointInBounds(e,t){const{width:n,height:i}=this.props;if(t&&t.handled)return!1;const s=e[0]>=0&&e[0]<=n&&e[1]>=0&&e[1]<=i;return s&&t&&t.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:t}=e;return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const t=setTimeout(()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=t}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:t}=e;this.inertia=Number.isFinite(t)?t:t===!0?Z_e:0;const{scrollZoom:n=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:a=!0,touchZoom:o=!0,touchRotate:u=!1,keyboard:f=!0}=e,g=!!this.onViewStateChange;this.toggleEvents(Ng.WHEEL,g&&n),this.toggleEvents(Ng.PAN,g),this.toggleEvents(Ng.PINCH,g&&(o||u)),this.toggleEvents(Ng.MULTI_PAN,g&&u),this.toggleEvents(Ng.DOUBLE_CLICK,g&&a),this.toggleEvents(Ng.KEYBOARD,g&&f),this.scrollZoom=n,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=a,this.touchZoom=o,this.touchRotate=u,this.keyboard=f}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach(n=>{this._events[n]!==t&&(this._events[n]=t,t?this.eventManager.on(n,this.handleEvent):this.eventManager.off(n,this.handleEvent))})}updateViewport(e,t=null,n={}){const i={...e.getViewportProps(),...t},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(n),s){const a=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:a,viewId:this.props.id})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let n=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(n=!n);const i=this.controllerState[n?"panStart":"rotateStart"]({pos:t});return this._panMove=n,this.updateViewport(i,Su,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),n=this.controllerState.pan({pos:t});return this.updateViewport(n,Su,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const n=this.getCenter(e),i=[n[0]+e.velocityX*t/2,n[1]+e.velocityY*t/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:nx},{isDragging:!1,isPanning:!0})}else{const n=this.controllerState.panEnd();this.updateViewport(n,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),n=this.controllerState.rotate({pos:t});return this.updateViewport(n,Su,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const n=this.getCenter(e),i=[n[0]+e.velocityX*t/2,n[1]+e.velocityY*t/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:nx},{isDragging:!1,isRotating:!0})}else{const n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;e.srcEvent.preventDefault();const{speed:n=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let a=2/(1+Math.exp(-Math.abs(s*n)));s<0&&a!==0&&(a=1/a);const o=i?{...this._getTransitionProps({around:t}),transitionDuration:250}:Su,u=this.controllerState.zoom({pos:t,scale:a});return this.updateViewport(u,o,{isZooming:!0,isPanning:!0}),!0}_onMultiPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.controllerState.rotateStart({pos:t});return this.updateViewport(n,Su,{isDragging:!0}),!0}_onMultiPan(e){if(!this.touchRotate||!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const n=this.controllerState.rotate({pos:t});return this.updateViewport(n,Su,{isDragging:!0,isRotating:!0}),!0}_onMultiPanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const n=this.getCenter(e),i=[n[0],n[1]+=e.velocityY*t/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:nx},{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const n=this.controllerState.rotateEnd();this.updateViewport(n,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return wf._startPinchRotation=e.rotation,wf._lastPinchEvent=e,this.updateViewport(n,Su,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:n}=e,i=this.getCenter(e);t=t.zoom({pos:i,scale:n})}if(this.touchRotate){const{rotation:n}=e;t=t.rotate({deltaAngleX:wf._startPinchRotation-n})}return this.updateViewport(t,Su,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),wf._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this,{_lastPinchEvent:n}=wf;if(this.touchZoom&&t&&n&&e.scale!==n.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const a=Math.log2(e.scale),o=(a-Math.log2(n.scale))/(e.deltaTime-n.deltaTime),u=Math.pow(2,a+o*t/2);s=s.zoom({pos:i,scale:u}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:t,transitionEasing:nx},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return wf._startPinchRotation=null,wf._lastPinchEvent=null,!0}_onDoubleClick(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const n=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:t,scale:n?.5:2});return this.updateViewport(i,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:n,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:a}=this.keyboard===!0?{}:this.keyboard,{controllerState:o}=this;let u;const f={};switch(e.srcEvent.code){case"Minus":u=t?o.zoomOut(n).zoomOut(n):o.zoomOut(n),f.isZooming=!0;break;case"Equal":u=t?o.zoomIn(n).zoomIn(n):o.zoomIn(n),f.isZooming=!0;break;case"ArrowLeft":t?(u=o.rotateLeft(s),f.isRotating=!0):(u=o.moveLeft(i),f.isPanning=!0);break;case"ArrowRight":t?(u=o.rotateRight(s),f.isRotating=!0):(u=o.moveRight(i),f.isPanning=!0);break;case"ArrowUp":t?(u=o.rotateUp(a),f.isRotating=!0):(u=o.moveUp(i),f.isPanning=!0);break;case"ArrowDown":t?(u=o.rotateDown(a),f.isRotating=!0):(u=o.moveDown(i),f.isPanning=!0);break;default:return!1}return this.updateViewport(u,this._getTransitionProps(),f),!0}_getTransitionProps(e){const{transition:t}=this;return!t||!t.transitionInterpolator?Su:e?{...t,transitionInterpolator:new wO({...e,...t.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:t}}class Q_e{constructor(e,t){this._viewportProps=this.applyConstraints(e),this._state=t}getViewportProps(){return this._viewportProps}getState(){return this._state}}const w5=5,eve=1.2;class GK extends Q_e{constructor(e){const{width:t,height:n,latitude:i,longitude:s,zoom:a,bearing:o=0,pitch:u=0,altitude:f=1.5,position:g=[0,0,0],maxZoom:y=20,minZoom:A=0,maxPitch:C=60,minPitch:M=0,startPanLngLat:k,startZoomLngLat:D,startRotatePos:V,startBearing:W,startPitch:z,startZoom:$,normalize:te=!0}=e;vs(Number.isFinite(s)),vs(Number.isFinite(i)),vs(Number.isFinite(a)),super({width:t,height:n,latitude:i,longitude:s,zoom:a,bearing:o,pitch:u,altitude:f,maxZoom:y,minZoom:A,maxPitch:C,minPitch:M,normalize:te,position:g},{startPanLngLat:k,startZoomLngLat:D,startRotatePos:V,startBearing:W,startPitch:z,startZoom:$}),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:t}){const n=this.getState().startPanLngLat||this._unproject(t);if(!n)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(n,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:n=0}){const{startRotatePos:i,startBearing:s,startPitch:a}=this.getState();if(!i||s===void 0||a===void 0)return this;let o;return e?o=this._getNewRotation(e,i,a,s):o={bearing:s+t,pitch:a+n},this._getUpdatedState(o)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:t,scale:n}){let{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(t)||this._unproject(e)),!s)return this;const{maxZoom:a,minZoom:o}=this.getViewportProps();let u=i+Math.log2(n);u=Xl(u,o,a);const f=this.makeViewport({...this.getViewportProps(),zoom:u});return this._getUpdatedState({zoom:u,...f.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),n={...this.getViewportProps()},{bearing:i,longitude:s}=n;return Math.abs(i-t.bearing)>180&&(n.bearing=i<0?i+360:i-360),Math.abs(s-t.longitude)>180&&(n.longitude=s<0?s+360:s-360),n}applyConstraints(e){const{maxZoom:t,minZoom:n,zoom:i}=e;e.zoom=Xl(i,n,t);const{maxPitch:s,minPitch:a,pitch:o}=e;e.pitch=Xl(o,a,s);const{normalize:u=!0}=e;return u&&Object.assign(e,d0e(e)),e}_zoomFromCenter(e){const{width:t,height:n}=this.getViewportProps();return this.zoom({pos:[t/2,n/2],scale:e})}_panFromCenter(e){const{width:t,height:n}=this.getViewportProps();return this.pan({startPos:[t/2,n/2],pos:[t/2+e[0],n/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const t=this.makeViewport(this.getViewportProps());return e&&t.unproject(e)}_getNewRotation(e,t,n,i){const s=e[0]-t[0],a=e[1]-t[1],o=e[1],u=t[1],{width:f,height:g}=this.getViewportProps(),y=s/f;let A=0;a>0?Math.abs(g-u)>w5&&(A=a/(u-g)*eve):a<0&&u>w5&&(A=1-o/u),A=Xl(A,-1,1);const{minPitch:C,maxPitch:M}=this.getViewportProps(),k=i+180*y;let D=n;return A>0?D=n+A*(M-n):A<0&&(D=n-A*(C-n)),{pitch:D,bearing:k}}}class tve extends jK{constructor(){super(...arguments),this.ControllerState=GK,this.transition={transitionDuration:300,transitionInterpolator:new wO({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(e){e.position=e.position||[0,0,0];const t=this.props;super.setProps(e),(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class CO extends $K{constructor(e={}){super(e)}getViewportType(){return Qu}get ControllerType(){return tve}}CO.displayName="MapView";const rve=new DK;function nve(r,e){const t=r.order??1/0,n=e.order??1/0;return t-n}class ive{constructor(e){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=e,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const t=this._defaultEffects;if(!t.find(n=>n.id===e.id)){const n=t.findIndex(i=>nve(i,e)>0);n<0?t.push(e):t.splice(n,0,e),e.setup(this._context),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(Ms(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._resolvedEffects}_setEffects(e){const t={};for(const i of this.effects)t[i.id]=i;const n=[];for(const i of e){const s=t[i.id];let a=i;s&&s!==i?s.setProps?(s.setProps(i.props),a=s):s.cleanup(this._context):s||i.setup(this._context),n.push(a),delete t[i.id]}for(const i in t)t[i].cleanup(this._context);this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),e.some(i=>i instanceof DK)||this._resolvedEffects.push(rve),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class sve extends xO{shouldDrawLayer(e){const{operation:t}=e.props;return t.includes("draw")||t.includes("terrain")}}const ove="deckRenderer.renderLayers";class ave{constructor(e){this.device=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new sve(e),this.pickLayersPass=new zK(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e};n.effects&&this._preRender(n.effects,n);const i=this.lastPostProcessEffect?this.renderBuffers[0]:n.target;this.lastPostProcessEffect&&(n.clearColor=[0,0,0,0],n.clearCanvas=!0);const s=t.render({...n,target:i});n.effects&&(this.lastPostProcessEffect&&(n.clearCanvas=e.clearCanvas===void 0?!0:e.clearCanvas),this._postRender(n.effects,n)),this.renderCount++,bo(ove,this,s,e)}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){this.lastPostProcessEffect=null,t.preRenderStats=t.preRenderStats||{};for(const n of e)t.preRenderStats[n.id]=n.preRender(t),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this,t=this.device.canvasContext.getDrawingBufferSize(),[n,i]=t;e.length===0&&[0,1].map(s=>{const a=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"},width:n,height:i});e.push(this.device.createFramebuffer({id:`deck-renderbuffer-${s}`,colorAttachments:[a]}))});for(const s of e)s.resize(t)}_postRender(e,t){const{renderBuffers:n}=this,i={...t,inputBuffer:n[0],swapBuffer:n[1]};for(const s of e)if(s.postRender){i.target=s.id===this.lastPostProcessEffect?t.target:void 0;const a=s.postRender(i);i.inputBuffer=a,i.swapBuffer=a===n[0]?n[1]:n[0]}}}const lve={pickedColor:null,pickedObjectIndex:-1};function C5({pickedColors:r,decodePickingColor:e,deviceX:t,deviceY:n,deviceRadius:i,deviceRect:s}){const{x:a,y:o,width:u,height:f}=s;let g=i*i,y=-1,A=0;for(let C=0;C<f;C++){const M=C+o-n,k=M*M;if(k>g)A+=4*u;else for(let D=0;D<u;D++){if(r[A+3]-1>=0){const W=D+a-t,z=W*W+k;z<=g&&(g=z,y=A)}A+=4}}if(y>=0){const C=r.slice(y,y+4),M=e(C);if(M){const k=Math.floor(y/4/u),D=y/4-k*u;return{...M,pickedColor:C,pickedX:a+D,pickedY:o+k}}Rr.error("Picked non-existent layer. Is picking buffer corrupt?")()}return lve}function T5({pickedColors:r,decodePickingColor:e}){const t=new Map;if(r){for(let n=0;n<r.length;n+=4)if(r[n+3]-1>=0){const s=r.slice(n,n+4),a=s.join(",");if(!t.has(a)){const o=e(s);o?t.set(a,{...o,color:s}):Rr.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(t.values())}function SB({pickInfo:r,viewports:e,pixelRatio:t,x:n,y:i,z:s}){let a=e[0];e.length>1&&(a=cve(r?.pickedViewports||e,{x:n,y:i}));let o;if(a){const u=[n-a.x,i-a.y];s!==void 0&&(u[2]=s),o=a.unproject(u)}return{color:null,layer:null,viewport:a,index:-1,picked:!1,x:n,y:i,pixel:[n,i],coordinate:o,devicePixel:r&&"pickedX"in r?[r.pickedX,r.pickedY]:void 0,pixelRatio:t}}function S5(r){const{pickInfo:e,lastPickedInfo:t,mode:n,layers:i}=r,{pickedColor:s,pickedLayer:a,pickedObjectIndex:o}=e,u=a?[a]:[];if(n==="hover"){const y=t.index,A=t.layerId,C=a?a.props.id:null;if(C!==A||o!==y){if(C!==A){const M=i.find(k=>k.props.id===A);M&&u.unshift(M)}t.layerId=C,t.index=o,t.info=null}}const f=SB(r),g=new Map;return g.set(null,f),u.forEach(y=>{let A={...f};y===a&&(A.color=s,A.index=o,A.picked=!0),A=EB({layer:y,info:A,mode:n});const C=A.layer;y===a&&n==="hover"&&(t.info=A),g.set(C.id,A),n==="hover"&&C.updateAutoHighlight(A)}),g}function EB({layer:r,info:e,mode:t}){for(;r&&e;){const n=e.layer||null;e.sourceLayer=n,e.layer=r,e=r.getPickingInfo({info:e,mode:t,sourceLayer:n}),r=r.parent}return e}function cve(r,e){for(let t=r.length-1;t>=0;t--){const n=r[t];if(n.containsPixel(e))return n}return r[0]}class uve{constructor(e){this._pickable=!0,this.device=e,this.pickLayersPass=new zK(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObjectAsync(e){return this._pickClosestObjectAsync(e)}pickObjectsAsync(e){return this._pickVisibleObjectsAsync(e)}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:t,layers:n,viewports:i},s=this.lastPickedInfo.info){const a=s&&s.layer&&s.layer.id,o=s&&s.viewport&&s.viewport.id,u=a?n.find(A=>A.id===a):null,f=o&&i.find(A=>A.id===o)||i[0],g=f&&f.unproject([e-f.x,t-f.y]);return{...s,...{x:e,y:t,viewport:f,coordinate:g,layer:u}}}_resizeBuffer(){if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){const t=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=t}const{canvas:e}=this.device.getDefaultCanvasContext();this.pickingFBO?.resize({width:e.width,height:e.height}),this.depthFBO?.resize({width:e.width,height:e.height})}_getPickable(e){if(this._pickable===!1)return null;const t=e.filter(n=>this.pickLayersPass.shouldDrawLayer(n)&&!n.isComposite);return t.length?t:null}async _pickClosestObjectAsync({layers:e,views:t,viewports:n,x:i,y:s,radius:a=0,depth:o=1,mode:u="query",unproject3D:f,onViewportActive:g,effects:y}){const A=this.device.canvasContext.cssToDeviceRatio(),C=this._getPickable(e);if(!C||n.length===0)return{result:[],emptyInfo:SB({viewports:n,x:i,y:s,pixelRatio:A})};this._resizeBuffer();const M=this.device.canvasContext.cssToDevicePixels([i,s],!0),k=[M.x+Math.floor(M.width/2),M.y+Math.floor(M.height/2)],D=Math.round(a*A),{width:V,height:W}=this.pickingFBO,z=this._getPickingRect({deviceX:k[0],deviceY:k[1],deviceRadius:D,deviceWidth:V,deviceHeight:W}),$={x:i-a,y:s-a,width:a*2+1,height:a*2+1};let te;const le=[],_e=new Set;for(let se=0;se<o;se++){let Y;if(z){const oe=this._drawAndSample({layers:C,views:t,viewports:n,onViewportActive:g,deviceRect:z,cullRect:$,effects:y,pass:`picking:${u}`});Y=C5({...oe,deviceX:k[0],deviceY:k[1],deviceRadius:D,deviceRect:z})}else Y={pickedColor:null,pickedObjectIndex:-1};let ce;if(Y.pickedLayer&&f&&this.depthFBO){const{pickedColors:oe}=this._drawAndSample({layers:[Y.pickedLayer],views:t,viewports:n,onViewportActive:g,deviceRect:{x:Y.pickedX,y:Y.pickedY,width:1,height:1},cullRect:$,effects:y,pass:`picking:${u}:z`},!0);oe[3]&&(ce=oe[0])}Y.pickedLayer&&se+1<o&&(_e.add(Y.pickedLayer),Y.pickedLayer.disablePickingIndex(Y.pickedObjectIndex)),te=S5({pickInfo:Y,lastPickedInfo:this.lastPickedInfo,mode:u,layers:C,viewports:n,x:i,y:s,z:ce,pixelRatio:A});for(const oe of te.values())oe.layer&&le.push(oe);if(!Y.pickedColor)break}for(const se of _e)se.restorePickingColors();return{result:le,emptyInfo:te.get(null)}}_pickClosestObject({layers:e,views:t,viewports:n,x:i,y:s,radius:a=0,depth:o=1,mode:u="query",unproject3D:f,onViewportActive:g,effects:y}){const A=this.device.canvasContext.cssToDeviceRatio(),C=this._getPickable(e);if(!C||n.length===0)return{result:[],emptyInfo:SB({viewports:n,x:i,y:s,pixelRatio:A})};this._resizeBuffer();const M=this.device.canvasContext.cssToDevicePixels([i,s],!0),k=[M.x+Math.floor(M.width/2),M.y+Math.floor(M.height/2)],D=Math.round(a*A),{width:V,height:W}=this.pickingFBO,z=this._getPickingRect({deviceX:k[0],deviceY:k[1],deviceRadius:D,deviceWidth:V,deviceHeight:W}),$={x:i-a,y:s-a,width:a*2+1,height:a*2+1};let te;const le=[],_e=new Set;for(let se=0;se<o;se++){let Y;if(z){const oe=this._drawAndSample({layers:C,views:t,viewports:n,onViewportActive:g,deviceRect:z,cullRect:$,effects:y,pass:`picking:${u}`});Y=C5({...oe,deviceX:k[0],deviceY:k[1],deviceRadius:D,deviceRect:z})}else Y={pickedColor:null,pickedObjectIndex:-1};let ce;if(Y.pickedLayer&&f&&this.depthFBO){const{pickedColors:oe}=this._drawAndSample({layers:[Y.pickedLayer],views:t,viewports:n,onViewportActive:g,deviceRect:{x:Y.pickedX,y:Y.pickedY,width:1,height:1},cullRect:$,effects:y,pass:`picking:${u}:z`},!0);oe[3]&&(ce=oe[0])}Y.pickedLayer&&se+1<o&&(_e.add(Y.pickedLayer),Y.pickedLayer.disablePickingIndex(Y.pickedObjectIndex)),te=S5({pickInfo:Y,lastPickedInfo:this.lastPickedInfo,mode:u,layers:C,viewports:n,x:i,y:s,z:ce,pixelRatio:A});for(const oe of te.values())oe.layer&&le.push(oe);if(!Y.pickedColor)break}for(const se of _e)se.restorePickingColors();return{result:le,emptyInfo:te.get(null)}}async _pickVisibleObjectsAsync({layers:e,views:t,viewports:n,x:i,y:s,width:a=1,height:o=1,mode:u="query",maxObjects:f=null,onViewportActive:g,effects:y}){const A=this._getPickable(e);if(!A||n.length===0)return[];this._resizeBuffer();const C=this.device.canvasContext.cssToDeviceRatio(),M=this.device.canvasContext.cssToDevicePixels([i,s],!0),k=M.x,D=M.y+M.height,V=this.device.canvasContext.cssToDevicePixels([i+a,s+o],!0),W=V.x+V.width,z=V.y,$={x:k,y:z,width:W-k,height:D-z},te=this._drawAndSample({layers:A,views:t,viewports:n,onViewportActive:g,deviceRect:$,cullRect:{x:i,y:s,width:a,height:o},effects:y,pass:`picking:${u}`}),le=T5(te),_e=new Map,se=[],Y=Number.isFinite(f);for(let ce=0;ce<le.length&&!(Y&&se.length>=f);ce++){const oe=le[ce];let Me={color:oe.pickedColor,layer:null,index:oe.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:C};Me=EB({layer:oe.pickedLayer,info:Me,mode:u});const ze=Me.layer.id;_e.has(ze)||_e.set(ze,new Set);const Ve=_e.get(ze),lt=Me.object??Me.index;Ve.has(lt)||(Ve.add(lt),se.push(Me))}return se}_pickVisibleObjects({layers:e,views:t,viewports:n,x:i,y:s,width:a=1,height:o=1,mode:u="query",maxObjects:f=null,onViewportActive:g,effects:y}){const A=this._getPickable(e);if(!A||n.length===0)return[];this._resizeBuffer();const C=this.device.canvasContext.cssToDeviceRatio(),M=this.device.canvasContext.cssToDevicePixels([i,s],!0),k=M.x,D=M.y+M.height,V=this.device.canvasContext.cssToDevicePixels([i+a,s+o],!0),W=V.x+V.width,z=V.y,$={x:k,y:z,width:W-k,height:D-z},te=this._drawAndSample({layers:A,views:t,viewports:n,onViewportActive:g,deviceRect:$,cullRect:{x:i,y:s,width:a,height:o},effects:y,pass:`picking:${u}`}),le=T5(te),_e=new Map,se=[],Y=Number.isFinite(f);for(let ce=0;ce<le.length&&!(Y&&se.length>=f);ce++){const oe=le[ce];let Me={color:oe.pickedColor,layer:null,index:oe.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:C};Me=EB({layer:oe.pickedLayer,info:Me,mode:u});const ze=Me.layer.id;_e.has(ze)||_e.set(ze,new Set);const Ve=_e.get(ze),lt=Me.object??Me.index;Ve.has(lt)||(Ve.add(lt),se.push(Me))}return se}async _drawAndSampleAsync({layers:e,views:t,viewports:n,onViewportActive:i,deviceRect:s,cullRect:a,effects:o,pass:u},f=!1){const g=f?this.depthFBO:this.pickingFBO,y={layers:e,layerFilter:this.layerFilter,views:t,viewports:n,onViewportActive:i,pickingFBO:g,deviceRect:s,cullRect:a,effects:o,pass:u,pickZ:f,preRenderStats:{},isPicking:!0};for(const W of o)W.useInPicking&&(y.preRenderStats[W.id]=W.preRender(y));const{decodePickingColor:A}=this.pickLayersPass.render(y),{x:C,y:M,width:k,height:D}=s,V=new(f?Float32Array:Uint8Array)(k*D*4);return this.device.readPixelsToArrayWebGL(g,{sourceX:C,sourceY:M,sourceWidth:k,sourceHeight:D,target:V}),{pickedColors:V,decodePickingColor:A}}_drawAndSample({layers:e,views:t,viewports:n,onViewportActive:i,deviceRect:s,cullRect:a,effects:o,pass:u},f=!1){const g=f?this.depthFBO:this.pickingFBO,y={layers:e,layerFilter:this.layerFilter,views:t,viewports:n,onViewportActive:i,pickingFBO:g,deviceRect:s,cullRect:a,effects:o,pass:u,pickZ:f,preRenderStats:{},isPicking:!0};for(const W of o)W.useInPicking&&(y.preRenderStats[W.id]=W.preRender(y));const{decodePickingColor:A}=this.pickLayersPass.render(y),{x:C,y:M,width:k,height:D}=s,V=new(f?Float32Array:Uint8Array)(k*D*4);return this.device.readPixelsToArrayWebGL(g,{sourceX:C,sourceY:M,sourceWidth:k,sourceHeight:D,target:V}),{pickedColors:V,decodePickingColor:A}}_getPickingRect({deviceX:e,deviceY:t,deviceRadius:n,deviceWidth:i,deviceHeight:s}){const a=Math.max(0,e-n),o=Math.max(0,t-n),u=Math.min(i,e+n+1)-a,f=Math.min(s,t+n+1)-o;return u<=0||f<=0?null:{x:a,y:o,width:u,height:f}}}const hve={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},dve="top-left",E5="__root";class fve{constructor({deck:e,parentElement:t}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=e,t?.classList.add("deck-widget-container"),this.parentElement=t}getWidgets(){return this.resolvedWidgets}setProps(e){if(e.widgets&&!Ms(e.widgets,this.widgets,1)){const t=e.widgets.filter(Boolean);this._setWidgets(t)}}finalize(){for(const e of this.getWidgets())this._removeWidget(e);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(const e in this.containers)this.containers[e].remove()}addDefault(e){this.defaultWidgets.find(t=>t.id===e.id)||(this._addWidget(e),this.defaultWidgets.push(e),this._setWidgets(this.widgets))}onRedraw({viewports:e,layers:t}){const n=e.reduce((i,s)=>(i[s.id]=s,i),{});for(const i of this.getWidgets()){const{viewId:s}=i;if(s){const a=n[s];a&&(i.onViewportChange&&i.onViewportChange(a),i.onRedraw?.({viewports:[a],layers:t}))}else{if(i.onViewportChange)for(const a of e)i.onViewportChange(a);i.onRedraw?.({viewports:e,layers:t})}}this.lastViewports=n,this._updateContainers()}onHover(e,t){for(const n of this.getWidgets()){const{viewId:i}=n;(!i||i===e.viewport?.id)&&n.onHover?.(e,t)}}onEvent(e,t){const n=mB[t.type];if(n)for(const i of this.getWidgets()){const{viewId:s}=i;(!s||s===e.viewport?.id)&&i[n]?.(e,t)}}_setWidgets(e){const t={};for(const n of this.resolvedWidgets)t[n.id]=n;this.resolvedWidgets.length=0;for(const n of this.defaultWidgets)t[n.id]=null,this.resolvedWidgets.push(n);for(let n of e){const i=t[n.id];i?i.viewId!==n.viewId||i.placement!==n.placement?(this._removeWidget(i),this._addWidget(n)):n!==i&&(i.setProps(n.props),n=i):this._addWidget(n),t[n.id]=null,this.resolvedWidgets.push(n)}for(const n in t){const i=t[n];i&&this._removeWidget(i)}this.widgets=e}_addWidget(e){const{viewId:t=null,placement:n=dve}=e;e.widgetManager=this,e.deck=this.deck,e.rootElement=e._onAdd({deck:this.deck,viewId:t}),e.rootElement&&this._getContainer(t,n).append(e.rootElement),e.updateHTML()}_removeWidget(e){e.onRemove?.(),e.rootElement&&e.rootElement.remove(),e.rootElement=void 0,e.deck=void 0,e.widgetManager=void 0}_getContainer(e,t){const n=e||E5;let i=this.containers[n];i||(i=document.createElement("div"),i.style.pointerEvents="none",i.style.position="absolute",i.style.overflow="hidden",this.parentElement?.append(i),this.containers[n]=i);let s=i.querySelector(`.${t}`);return s||(s=globalThis.document.createElement("div"),s.className=t,s.style.position="absolute",s.style.zIndex="2",Object.assign(s.style,hve[t]),i.append(s)),s}_updateContainers(){const e=this.deck.width,t=this.deck.height;for(const n in this.containers){const i=this.lastViewports[n]||null,s=n===E5||i,a=this.containers[n];s?(a.style.display="block",a.style.left=`${i?i.x:0}px`,a.style.top=`${i?i.y:0}px`,a.style.width=`${i?i.width:e}px`,a.style.height=`${i?i.height:t}px`):a.style.display="none"}}}function I5(r,e){e&&Object.entries(e).map(([t,n])=>{t.startsWith("--")?r.style.setProperty(t,n):r.style[t]=n})}function pve(r,e){e&&Object.keys(e).map(t=>{t.startsWith("--")?r.style.removeProperty(t):r.style[t]=""})}class TO{constructor(e){this.viewId=null,this.props={...this.constructor.defaultProps,...e},this.id=this.props.id}setProps(e){const t=this.props,n=this.rootElement;n&&t.className!==e.className&&(t.className&&n.classList.remove(t.className),e.className&&n.classList.add(e.className)),n&&!Ms(t.style,e.style,1)&&(pve(n,t.style),I5(n,e.style)),Object.assign(this.props,e),this.updateHTML()}updateHTML(){this.rootElement&&this.onRenderHTML(this.rootElement)}onCreateRootElement(){const e=["deck-widget",this.className,this.props.className],t=document.createElement("div");return e.filter(n=>typeof n=="string"&&n.length>0).forEach(n=>t.classList.add(n)),I5(t,this.props.style),t}_onAdd(e){return this.onAdd(e)??this.onCreateRootElement()}onAdd(e){}onRemove(){}onViewportChange(e){}onRedraw(e){}onHover(e,t){}onClick(e,t){}onDrag(e,t){}onDragStart(e,t){}onDragEnd(e,t){}}TO.defaultProps={id:"widget",style:{},className:""};const gve={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class HK extends TO{constructor(e={}){super(e),this.id="default-tooltip",this.placement="fill",this.className="deck-tooltip",this.isVisible=!1,this.setProps(e)}onCreateRootElement(){const e=document.createElement("div");return e.className=this.className,Object.assign(e.style,gve),e}onRenderHTML(e){}onViewportChange(e){this.isVisible&&e.id===this.lastViewport?.id&&!e.equals(this.lastViewport)&&this.setTooltip(null),this.lastViewport=e}onHover(e){const{deck:t}=this,n=t&&t.props.getTooltip;if(!n)return;const i=n(e);this.setTooltip(i,e.x,e.y)}setTooltip(e,t,n){const i=this.rootElement;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform=`translate(${t}px, ${n}px)`,e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}}HK.defaultProps={...TO.defaultProps};var gm;(function(r){r[r.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",r[r.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",r[r.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",r[r.POINTS=0]="POINTS",r[r.LINES=1]="LINES",r[r.LINE_LOOP=2]="LINE_LOOP",r[r.LINE_STRIP=3]="LINE_STRIP",r[r.TRIANGLES=4]="TRIANGLES",r[r.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",r[r.TRIANGLE_FAN=6]="TRIANGLE_FAN",r[r.ZERO=0]="ZERO",r[r.ONE=1]="ONE",r[r.SRC_COLOR=768]="SRC_COLOR",r[r.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",r[r.SRC_ALPHA=770]="SRC_ALPHA",r[r.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",r[r.DST_ALPHA=772]="DST_ALPHA",r[r.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",r[r.DST_COLOR=774]="DST_COLOR",r[r.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",r[r.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",r[r.CONSTANT_COLOR=32769]="CONSTANT_COLOR",r[r.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",r[r.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",r[r.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",r[r.FUNC_ADD=32774]="FUNC_ADD",r[r.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",r[r.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",r[r.BLEND_EQUATION=32777]="BLEND_EQUATION",r[r.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",r[r.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",r[r.BLEND_DST_RGB=32968]="BLEND_DST_RGB",r[r.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",r[r.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",r[r.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",r[r.BLEND_COLOR=32773]="BLEND_COLOR",r[r.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",r[r.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",r[r.LINE_WIDTH=2849]="LINE_WIDTH",r[r.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",r[r.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",r[r.CULL_FACE_MODE=2885]="CULL_FACE_MODE",r[r.FRONT_FACE=2886]="FRONT_FACE",r[r.DEPTH_RANGE=2928]="DEPTH_RANGE",r[r.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",r[r.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",r[r.DEPTH_FUNC=2932]="DEPTH_FUNC",r[r.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",r[r.STENCIL_FUNC=2962]="STENCIL_FUNC",r[r.STENCIL_FAIL=2964]="STENCIL_FAIL",r[r.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",r[r.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",r[r.STENCIL_REF=2967]="STENCIL_REF",r[r.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",r[r.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",r[r.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",r[r.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",r[r.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",r[r.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",r[r.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",r[r.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",r[r.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",r[r.VIEWPORT=2978]="VIEWPORT",r[r.SCISSOR_BOX=3088]="SCISSOR_BOX",r[r.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",r[r.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",r[r.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",r[r.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",r[r.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",r[r.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",r[r.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",r[r.RED_BITS=3410]="RED_BITS",r[r.GREEN_BITS=3411]="GREEN_BITS",r[r.BLUE_BITS=3412]="BLUE_BITS",r[r.ALPHA_BITS=3413]="ALPHA_BITS",r[r.DEPTH_BITS=3414]="DEPTH_BITS",r[r.STENCIL_BITS=3415]="STENCIL_BITS",r[r.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",r[r.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",r[r.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",r[r.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",r[r.SAMPLES=32937]="SAMPLES",r[r.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",r[r.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",r[r.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",r[r.VENDOR=7936]="VENDOR",r[r.RENDERER=7937]="RENDERER",r[r.VERSION=7938]="VERSION",r[r.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",r[r.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",r[r.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",r[r.STATIC_DRAW=35044]="STATIC_DRAW",r[r.STREAM_DRAW=35040]="STREAM_DRAW",r[r.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",r[r.ARRAY_BUFFER=34962]="ARRAY_BUFFER",r[r.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",r[r.BUFFER_SIZE=34660]="BUFFER_SIZE",r[r.BUFFER_USAGE=34661]="BUFFER_USAGE",r[r.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",r[r.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",r[r.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",r[r.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",r[r.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",r[r.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",r[r.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",r[r.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",r[r.CULL_FACE=2884]="CULL_FACE",r[r.FRONT=1028]="FRONT",r[r.BACK=1029]="BACK",r[r.FRONT_AND_BACK=1032]="FRONT_AND_BACK",r[r.BLEND=3042]="BLEND",r[r.DEPTH_TEST=2929]="DEPTH_TEST",r[r.DITHER=3024]="DITHER",r[r.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",r[r.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",r[r.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",r[r.SCISSOR_TEST=3089]="SCISSOR_TEST",r[r.STENCIL_TEST=2960]="STENCIL_TEST",r[r.NO_ERROR=0]="NO_ERROR",r[r.INVALID_ENUM=1280]="INVALID_ENUM",r[r.INVALID_VALUE=1281]="INVALID_VALUE",r[r.INVALID_OPERATION=1282]="INVALID_OPERATION",r[r.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",r[r.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",r[r.CW=2304]="CW",r[r.CCW=2305]="CCW",r[r.DONT_CARE=4352]="DONT_CARE",r[r.FASTEST=4353]="FASTEST",r[r.NICEST=4354]="NICEST",r[r.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",r[r.BYTE=5120]="BYTE",r[r.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",r[r.SHORT=5122]="SHORT",r[r.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",r[r.INT=5124]="INT",r[r.UNSIGNED_INT=5125]="UNSIGNED_INT",r[r.FLOAT=5126]="FLOAT",r[r.DOUBLE=5130]="DOUBLE",r[r.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",r[r.ALPHA=6406]="ALPHA",r[r.RGB=6407]="RGB",r[r.RGBA=6408]="RGBA",r[r.LUMINANCE=6409]="LUMINANCE",r[r.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",r[r.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",r[r.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",r[r.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",r[r.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",r[r.VERTEX_SHADER=35633]="VERTEX_SHADER",r[r.COMPILE_STATUS=35713]="COMPILE_STATUS",r[r.DELETE_STATUS=35712]="DELETE_STATUS",r[r.LINK_STATUS=35714]="LINK_STATUS",r[r.VALIDATE_STATUS=35715]="VALIDATE_STATUS",r[r.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",r[r.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",r[r.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",r[r.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",r[r.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",r[r.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",r[r.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",r[r.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",r[r.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",r[r.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",r[r.SHADER_TYPE=35663]="SHADER_TYPE",r[r.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",r[r.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",r[r.NEVER=512]="NEVER",r[r.LESS=513]="LESS",r[r.EQUAL=514]="EQUAL",r[r.LEQUAL=515]="LEQUAL",r[r.GREATER=516]="GREATER",r[r.NOTEQUAL=517]="NOTEQUAL",r[r.GEQUAL=518]="GEQUAL",r[r.ALWAYS=519]="ALWAYS",r[r.KEEP=7680]="KEEP",r[r.REPLACE=7681]="REPLACE",r[r.INCR=7682]="INCR",r[r.DECR=7683]="DECR",r[r.INVERT=5386]="INVERT",r[r.INCR_WRAP=34055]="INCR_WRAP",r[r.DECR_WRAP=34056]="DECR_WRAP",r[r.NEAREST=9728]="NEAREST",r[r.LINEAR=9729]="LINEAR",r[r.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",r[r.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",r[r.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",r[r.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",r[r.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",r[r.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",r[r.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",r[r.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",r[r.TEXTURE_2D=3553]="TEXTURE_2D",r[r.TEXTURE=5890]="TEXTURE",r[r.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",r[r.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",r[r.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",r[r.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",r[r.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",r[r.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",r[r.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",r[r.TEXTURE0=33984]="TEXTURE0",r[r.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",r[r.REPEAT=10497]="REPEAT",r[r.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",r[r.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",r[r.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",r[r.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",r[r.FLOAT_VEC2=35664]="FLOAT_VEC2",r[r.FLOAT_VEC3=35665]="FLOAT_VEC3",r[r.FLOAT_VEC4=35666]="FLOAT_VEC4",r[r.INT_VEC2=35667]="INT_VEC2",r[r.INT_VEC3=35668]="INT_VEC3",r[r.INT_VEC4=35669]="INT_VEC4",r[r.BOOL=35670]="BOOL",r[r.BOOL_VEC2=35671]="BOOL_VEC2",r[r.BOOL_VEC3=35672]="BOOL_VEC3",r[r.BOOL_VEC4=35673]="BOOL_VEC4",r[r.FLOAT_MAT2=35674]="FLOAT_MAT2",r[r.FLOAT_MAT3=35675]="FLOAT_MAT3",r[r.FLOAT_MAT4=35676]="FLOAT_MAT4",r[r.SAMPLER_2D=35678]="SAMPLER_2D",r[r.SAMPLER_CUBE=35680]="SAMPLER_CUBE",r[r.LOW_FLOAT=36336]="LOW_FLOAT",r[r.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",r[r.HIGH_FLOAT=36338]="HIGH_FLOAT",r[r.LOW_INT=36339]="LOW_INT",r[r.MEDIUM_INT=36340]="MEDIUM_INT",r[r.HIGH_INT=36341]="HIGH_INT",r[r.FRAMEBUFFER=36160]="FRAMEBUFFER",r[r.RENDERBUFFER=36161]="RENDERBUFFER",r[r.RGBA4=32854]="RGBA4",r[r.RGB5_A1=32855]="RGB5_A1",r[r.RGB565=36194]="RGB565",r[r.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",r[r.STENCIL_INDEX=6401]="STENCIL_INDEX",r[r.STENCIL_INDEX8=36168]="STENCIL_INDEX8",r[r.DEPTH_STENCIL=34041]="DEPTH_STENCIL",r[r.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",r[r.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",r[r.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",r[r.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",r[r.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",r[r.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",r[r.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",r[r.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",r[r.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",r[r.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",r[r.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",r[r.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",r[r.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",r[r.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",r[r.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",r[r.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",r[r.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",r[r.NONE=0]="NONE",r[r.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",r[r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",r[r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",r[r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",r[r.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",r[r.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",r[r.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",r[r.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",r[r.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",r[r.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",r[r.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",r[r.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",r[r.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",r[r.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",r[r.READ_BUFFER=3074]="READ_BUFFER",r[r.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",r[r.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",r[r.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",r[r.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",r[r.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",r[r.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",r[r.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",r[r.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",r[r.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",r[r.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",r[r.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",r[r.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",r[r.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",r[r.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",r[r.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",r[r.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",r[r.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",r[r.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",r[r.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",r[r.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",r[r.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",r[r.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",r[r.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",r[r.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",r[r.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",r[r.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",r[r.RED=6403]="RED",r[r.RGB8=32849]="RGB8",r[r.RGBA8=32856]="RGBA8",r[r.RGB10_A2=32857]="RGB10_A2",r[r.TEXTURE_3D=32879]="TEXTURE_3D",r[r.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",r[r.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",r[r.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",r[r.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",r[r.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",r[r.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",r[r.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",r[r.SRGB=35904]="SRGB",r[r.SRGB8=35905]="SRGB8",r[r.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",r[r.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",r[r.RGBA32F=34836]="RGBA32F",r[r.RGB32F=34837]="RGB32F",r[r.RGBA16F=34842]="RGBA16F",r[r.RGB16F=34843]="RGB16F",r[r.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",r[r.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",r[r.R11F_G11F_B10F=35898]="R11F_G11F_B10F",r[r.RGB9_E5=35901]="RGB9_E5",r[r.RGBA32UI=36208]="RGBA32UI",r[r.RGB32UI=36209]="RGB32UI",r[r.RGBA16UI=36214]="RGBA16UI",r[r.RGB16UI=36215]="RGB16UI",r[r.RGBA8UI=36220]="RGBA8UI",r[r.RGB8UI=36221]="RGB8UI",r[r.RGBA32I=36226]="RGBA32I",r[r.RGB32I=36227]="RGB32I",r[r.RGBA16I=36232]="RGBA16I",r[r.RGB16I=36233]="RGB16I",r[r.RGBA8I=36238]="RGBA8I",r[r.RGB8I=36239]="RGB8I",r[r.RED_INTEGER=36244]="RED_INTEGER",r[r.RGB_INTEGER=36248]="RGB_INTEGER",r[r.RGBA_INTEGER=36249]="RGBA_INTEGER",r[r.R8=33321]="R8",r[r.RG8=33323]="RG8",r[r.R16F=33325]="R16F",r[r.R32F=33326]="R32F",r[r.RG16F=33327]="RG16F",r[r.RG32F=33328]="RG32F",r[r.R8I=33329]="R8I",r[r.R8UI=33330]="R8UI",r[r.R16I=33331]="R16I",r[r.R16UI=33332]="R16UI",r[r.R32I=33333]="R32I",r[r.R32UI=33334]="R32UI",r[r.RG8I=33335]="RG8I",r[r.RG8UI=33336]="RG8UI",r[r.RG16I=33337]="RG16I",r[r.RG16UI=33338]="RG16UI",r[r.RG32I=33339]="RG32I",r[r.RG32UI=33340]="RG32UI",r[r.R8_SNORM=36756]="R8_SNORM",r[r.RG8_SNORM=36757]="RG8_SNORM",r[r.RGB8_SNORM=36758]="RGB8_SNORM",r[r.RGBA8_SNORM=36759]="RGBA8_SNORM",r[r.RGB10_A2UI=36975]="RGB10_A2UI",r[r.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",r[r.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",r[r.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",r[r.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",r[r.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",r[r.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",r[r.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",r[r.HALF_FLOAT=5131]="HALF_FLOAT",r[r.RG=33319]="RG",r[r.RG_INTEGER=33320]="RG_INTEGER",r[r.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",r[r.CURRENT_QUERY=34917]="CURRENT_QUERY",r[r.QUERY_RESULT=34918]="QUERY_RESULT",r[r.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",r[r.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",r[r.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",r[r.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",r[r.DRAW_BUFFER0=34853]="DRAW_BUFFER0",r[r.DRAW_BUFFER1=34854]="DRAW_BUFFER1",r[r.DRAW_BUFFER2=34855]="DRAW_BUFFER2",r[r.DRAW_BUFFER3=34856]="DRAW_BUFFER3",r[r.DRAW_BUFFER4=34857]="DRAW_BUFFER4",r[r.DRAW_BUFFER5=34858]="DRAW_BUFFER5",r[r.DRAW_BUFFER6=34859]="DRAW_BUFFER6",r[r.DRAW_BUFFER7=34860]="DRAW_BUFFER7",r[r.DRAW_BUFFER8=34861]="DRAW_BUFFER8",r[r.DRAW_BUFFER9=34862]="DRAW_BUFFER9",r[r.DRAW_BUFFER10=34863]="DRAW_BUFFER10",r[r.DRAW_BUFFER11=34864]="DRAW_BUFFER11",r[r.DRAW_BUFFER12=34865]="DRAW_BUFFER12",r[r.DRAW_BUFFER13=34866]="DRAW_BUFFER13",r[r.DRAW_BUFFER14=34867]="DRAW_BUFFER14",r[r.DRAW_BUFFER15=34868]="DRAW_BUFFER15",r[r.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",r[r.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",r[r.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",r[r.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",r[r.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",r[r.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",r[r.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",r[r.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",r[r.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",r[r.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",r[r.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",r[r.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",r[r.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",r[r.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",r[r.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",r[r.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",r[r.SAMPLER_3D=35679]="SAMPLER_3D",r[r.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",r[r.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",r[r.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",r[r.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",r[r.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",r[r.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",r[r.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",r[r.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",r[r.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",r[r.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",r[r.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",r[r.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",r[r.MAX_SAMPLES=36183]="MAX_SAMPLES",r[r.SAMPLER_BINDING=35097]="SAMPLER_BINDING",r[r.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",r[r.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",r[r.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",r[r.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",r[r.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",r[r.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",r[r.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",r[r.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",r[r.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",r[r.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",r[r.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",r[r.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",r[r.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",r[r.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",r[r.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",r[r.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",r[r.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",r[r.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",r[r.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",r[r.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",r[r.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",r[r.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",r[r.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",r[r.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",r[r.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",r[r.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",r[r.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",r[r.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",r[r.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",r[r.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",r[r.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",r[r.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",r[r.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",r[r.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",r[r.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",r[r.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",r[r.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",r[r.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",r[r.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",r[r.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",r[r.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",r[r.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",r[r.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",r[r.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",r[r.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",r[r.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",r[r.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",r[r.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",r[r.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",r[r.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",r[r.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",r[r.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",r[r.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",r[r.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",r[r.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",r[r.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",r[r.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",r[r.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",r[r.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",r[r.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",r[r.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",r[r.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",r[r.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",r[r.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",r[r.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",r[r.UNIFORM_TYPE=35383]="UNIFORM_TYPE",r[r.UNIFORM_SIZE=35384]="UNIFORM_SIZE",r[r.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",r[r.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",r[r.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",r[r.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",r[r.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",r[r.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",r[r.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",r[r.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",r[r.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",r[r.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",r[r.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",r[r.OBJECT_TYPE=37138]="OBJECT_TYPE",r[r.SYNC_CONDITION=37139]="SYNC_CONDITION",r[r.SYNC_STATUS=37140]="SYNC_STATUS",r[r.SYNC_FLAGS=37141]="SYNC_FLAGS",r[r.SYNC_FENCE=37142]="SYNC_FENCE",r[r.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",r[r.UNSIGNALED=37144]="UNSIGNALED",r[r.SIGNALED=37145]="SIGNALED",r[r.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",r[r.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",r[r.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",r[r.WAIT_FAILED=37149]="WAIT_FAILED",r[r.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",r[r.COLOR=6144]="COLOR",r[r.DEPTH=6145]="DEPTH",r[r.STENCIL=6146]="STENCIL",r[r.MIN=32775]="MIN",r[r.MAX=32776]="MAX",r[r.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",r[r.STREAM_READ=35041]="STREAM_READ",r[r.STREAM_COPY=35042]="STREAM_COPY",r[r.STATIC_READ=35045]="STATIC_READ",r[r.STATIC_COPY=35046]="STATIC_COPY",r[r.DYNAMIC_READ=35049]="DYNAMIC_READ",r[r.DYNAMIC_COPY=35050]="DYNAMIC_COPY",r[r.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",r[r.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",r[r.INVALID_INDEX=4294967295]="INVALID_INDEX",r[r.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",r[r.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",r[r.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",r[r.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",r[r.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",r[r.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",r[r.R16_EXT=33322]="R16_EXT",r[r.RG16_EXT=33324]="RG16_EXT",r[r.RGB16_EXT=32852]="RGB16_EXT",r[r.RGBA16_EXT=32859]="RGBA16_EXT",r[r.R16_SNORM_EXT=36760]="R16_SNORM_EXT",r[r.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",r[r.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",r[r.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",r[r.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",r[r.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",r[r.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",r[r.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",r[r.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",r[r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",r[r.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",r[r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",r[r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",r[r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",r[r.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",r[r.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",r[r.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",r[r.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",r[r.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",r[r.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",r[r.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",r[r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",r[r.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",r[r.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",r[r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",r[r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",r[r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",r[r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",r[r.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",r[r.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",r[r.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",r[r.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",r[r.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",r[r.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",r[r.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",r[r.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",r[r.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",r[r.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",r[r.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",r[r.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",r[r.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",r[r.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",r[r.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",r[r.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",r[r.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",r[r.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",r[r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",r[r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",r[r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",r[r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",r[r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",r[r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",r[r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",r[r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",r[r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",r[r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",r[r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",r[r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",r[r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",r[r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",r[r.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",r[r.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",r[r.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",r[r.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",r[r.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",r[r.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",r[r.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",r[r.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",r[r.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",r[r.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",r[r.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",r[r.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",r[r.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",r[r.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",r[r.LINE_WEBGL=6913]="LINE_WEBGL",r[r.FILL_WEBGL=6914]="FILL_WEBGL",r[r.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",r[r.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",r[r.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",r[r.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",r[r.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",r[r.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",r[r.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",r[r.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",r[r.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",r[r.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",r[r.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",r[r.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",r[r.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",r[r.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",r[r.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",r[r.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",r[r.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",r[r.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",r[r.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",r[r.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",r[r.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",r[r.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",r[r.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",r[r.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"})(gm||(gm={}));const mve={WEBGL_depth_texture:{UNSIGNED_INT_24_8_WEBGL:34042},OES_element_index_uint:{},OES_texture_float:{},OES_texture_half_float:{HALF_FLOAT_OES:5131},EXT_color_buffer_float:{},OES_standard_derivatives:{FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723},EXT_frag_depth:{},EXT_blend_minmax:{MIN_EXT:32775,MAX_EXT:32776},EXT_shader_texture_lod:{}},yve=r=>({drawBuffersWEBGL(e){return r.drawBuffers(e)},COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067}),bve=r=>({VERTEX_ARRAY_BINDING_OES:34229,createVertexArrayOES(){return r.createVertexArray()},deleteVertexArrayOES(e){return r.deleteVertexArray(e)},isVertexArrayOES(e){return r.isVertexArray(e)},bindVertexArrayOES(e){return r.bindVertexArray(e)}}),_ve=r=>({VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,drawArraysInstancedANGLE(...e){return r.drawArraysInstanced(...e)},drawElementsInstancedANGLE(...e){return r.drawElementsInstanced(...e)},vertexAttribDivisorANGLE(...e){return r.vertexAttribDivisor(...e)}});function vve(r=!0){const e=HTMLCanvasElement.prototype;if(!r&&e.originalGetContext){e.getContext=e.originalGetContext,e.originalGetContext=void 0;return}e.originalGetContext=e.getContext,e.getContext=function(t,n){if(t==="webgl"||t==="experimental-webgl"){const i=this.originalGetContext("webgl2",n);return i instanceof HTMLElement&&Ave(i),i}return this.originalGetContext(t,n)}}function Ave(r){r.getExtension("EXT_color_buffer_float");const e={...mve,WEBGL_disjoint_timer_query:r.getExtension("EXT_disjoint_timer_query_webgl2"),WEBGL_draw_buffers:yve(r),OES_vertex_array_object:bve(r),ANGLE_instanced_arrays:_ve(r)},t=r.getExtension;r.getExtension=function(i){const s=t.call(r,i);return s||(i in e?e[i]:null)};const n=r.getSupportedExtensions;r.getSupportedExtensions=function(){return(n.apply(r)||[])?.concat(Object.keys(e))}}async function WK(r,e){const t=document.getElementsByTagName("head")[0];if(!t)throw new Error("loadScript");const n=document.createElement("script");return n.setAttribute("type","text/javascript"),n.setAttribute("src",r),new Promise((i,s)=>{n.onload=i,n.onerror=a=>s(new Error(`Unable to load script '${r}': ${a}`)),t.appendChild(n)})}const xve=1;let Ia=null,P5=!1;const SO={debugSpectorJS:Bt.get("debug-spectorjs"),debugSpectorJSUrl:"https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",gl:void 0};async function wve(r){if(!globalThis.SPECTOR)try{await WK(r.debugSpectorJSUrl||SO.debugSpectorJSUrl)}catch(e){Bt.warn(String(e))}}function Cve(r){if(r={...SO,...r},!r.debugSpectorJS)return null;if(!Ia&&globalThis.SPECTOR&&!globalThis.luma?.spector){Bt.probe(xve,"SPECTOR found and initialized. Start with `luma.spector.displayUI()`")();const{Spector:e}=globalThis.SPECTOR;Ia=new e,globalThis.luma&&(globalThis.luma.spector=Ia)}if(!Ia)return null;if(P5||(P5=!0,Ia.spyCanvases(),Ia?.onCaptureStarted.add(e=>Bt.info("Spector capture started:",e)()),Ia?.onCapture.add(e=>{Bt.info("Spector capture complete:",e)(),Ia?.getResultUI(),Ia?.resultView.display(),Ia?.resultView.addCapture(e)})),r.gl){const e=r.gl,t=e.device;Ia?.startCapture(r.gl,500),e.device=t,new Promise(n=>setTimeout(n,2e3)).then(n=>{Bt.info("Spector capture stopped after 2 seconds")(),Ia?.stopCapture()})}return Ia}const Tve="https://unpkg.com/webgl-debug@2.0.1/index.js";function KK(r){return r.luma=r.luma||{},r.luma}async function Sve(){_p()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await WK(Tve))}function Eve(r,e={}){return e.debugWebGL||e.traceWebGL?Pve(r,e):Ive(r)}function Ive(r){const e=KK(r);return e.realContext?e.realContext:r}function Pve(r,e){if(!globalThis.WebGLDebugUtils)return Bt.warn("webgl-debug not loaded")(),r;const t=KK(r);if(t.debugContext)return t.debugContext;globalThis.WebGLDebugUtils.init({...gm,...r});const n=globalThis.WebGLDebugUtils.makeDebugContext(r,Bve.bind(null,e),Mve.bind(null,e));for(const a in gm)!(a in n)&&typeof gm[a]=="number"&&(n[a]=gm[a]);class i{}Object.setPrototypeOf(n,Object.getPrototypeOf(r)),Object.setPrototypeOf(i,n);const s=Object.create(i);return t.realContext=r,t.debugContext=s,s.debug=!0,s}function B5(r,e){e=Array.from(e).map(n=>n===void 0?"undefined":n);let t=globalThis.WebGLDebugUtils.glFunctionArgsToString(r,e);return t=`${t.slice(0,100)}${t.length>100?"...":""}`,`gl.${r}(${t})`}function Bve(r,e,t,n){n=Array.from(n).map(o=>o===void 0?"undefined":o);const i=globalThis.WebGLDebugUtils.glEnumToString(e),s=globalThis.WebGLDebugUtils.glFunctionArgsToString(t,n),a=`${i} in gl.${t}(${s})`;Bt.error(a)();debugger}function Mve(r,e,t){let n="";Bt.level>=1&&(n=B5(e,t),r.traceWebGL&&Bt.log(1,n)());for(const i of t)if(i===void 0){n=n||B5(e,t);debugger}}const ix=1;class Rve extends Bpe{constructor(){super();H(this,"type","webgl");hp.defaultProps={...hp.defaultProps,...SO}}enforceWebGL2(t){vve(t)}isSupported(){return typeof WebGL2RenderingContext<"u"}isDeviceHandle(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:(typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext&&Bt.warn("WebGL1 is not supported",t)(),!1)}async attach(t,n={}){const{WebGLDevice:i}=await Promise.resolve().then(()=>W5);if(t instanceof i)return t;if(t?.device instanceof i)return t.device;if(!kve(t))throw new Error("Invalid WebGL2RenderingContext");const s=n.createCanvasContext===!0?{}:n.createCanvasContext;return new i({...n,_handle:t,createCanvasContext:{canvas:t.canvas,autoResize:!1,...s}})}async create(t={}){const{WebGLDevice:n}=await Promise.resolve().then(()=>W5);Bt.groupCollapsed(ix,"WebGLDevice created")();try{const i=[];(t.debugWebGL||t.debug)&&i.push(Sve()),t.debugSpectorJS&&i.push(wve(t));const s=await Promise.allSettled(i);for(const u of s)u.status==="rejected"&&Bt.error(`Failed to initialize debug libraries ${u.reason}`)();const a=new n(t),o=`${a._reused?"Reusing":"Created"} device with WebGL2 ${a.props.debug?"debug ":""}context: ${a.info.vendor}, ${a.info.renderer} for canvas: ${a.canvasContext.id}`;return Bt.probe(ix,o)(),Bt.table(ix,a.info)(),a}finally{Bt.groupEnd(ix)()}}}function kve(r){return typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext?!0:!!(r&&Number.isFinite(r._version))}const jI=new Rve,EO={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},fs=(r,e,t)=>e?r.enable(t):r.disable(t),M5=(r,e,t)=>r.hint(t,e),Pa=(r,e,t)=>r.pixelStorei(t,e),R5=(r,e,t)=>{const n=t===36006?36009:36008;return r.bindFramebuffer(n,e)},Qb=(r,e,t)=>{const i={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[t];r.bindBuffer(i,e)};function GI(r){return Array.isArray(r)||ArrayBuffer.isView(r)&&!(r instanceof DataView)}const Ove={3042:fs,32773:(r,e)=>r.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(r,e)=>r.clearColor(...e),3107:(r,e)=>r.colorMask(...e),2884:fs,2885:(r,e)=>r.cullFace(e),2929:fs,2931:(r,e)=>r.clearDepth(e),2932:(r,e)=>r.depthFunc(e),2928:(r,e)=>r.depthRange(...e),2930:(r,e)=>r.depthMask(e),3024:fs,35723:M5,35725:(r,e)=>r.useProgram(e),36007:(r,e)=>r.bindRenderbuffer(36161,e),36389:(r,e)=>r.bindTransformFeedback?.(36386,e),34229:(r,e)=>r.bindVertexArray(e),36006:R5,36010:R5,34964:Qb,36662:Qb,36663:Qb,35053:Qb,35055:Qb,2886:(r,e)=>r.frontFace(e),33170:M5,2849:(r,e)=>r.lineWidth(e),32823:fs,32824:"polygonOffset",10752:"polygonOffset",35977:fs,32926:fs,32928:fs,32938:"sampleCoverage",32939:"sampleCoverage",3089:fs,3088:(r,e)=>r.scissor(...e),2960:fs,2961:(r,e)=>r.clearStencil(e),2968:(r,e)=>r.stencilMaskSeparate(1028,e),36005:(r,e)=>r.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(r,e)=>r.viewport(...e),34383:fs,10754:fs,12288:fs,12289:fs,12290:fs,12291:fs,12292:fs,12293:fs,12294:fs,12295:fs,3333:Pa,3317:Pa,37440:Pa,37441:Pa,37443:Pa,3330:Pa,3332:Pa,3331:Pa,3314:Pa,32878:Pa,3316:Pa,3315:Pa,32877:Pa,framebuffer:(r,e)=>{const t=e&&"handle"in e?e.handle:e;return r.bindFramebuffer(36160,t)},blend:(r,e)=>e?r.enable(3042):r.disable(3042),blendColor:(r,e)=>r.blendColor(...e),blendEquation:(r,e)=>{const t=typeof e=="number"?[e,e]:e;r.blendEquationSeparate(...t)},blendFunc:(r,e)=>{const t=e?.length===2?[...e,...e]:e;r.blendFuncSeparate(...t)},clearColor:(r,e)=>r.clearColor(...e),clearDepth:(r,e)=>r.clearDepth(e),clearStencil:(r,e)=>r.clearStencil(e),colorMask:(r,e)=>r.colorMask(...e),cull:(r,e)=>e?r.enable(2884):r.disable(2884),cullFace:(r,e)=>r.cullFace(e),depthTest:(r,e)=>e?r.enable(2929):r.disable(2929),depthFunc:(r,e)=>r.depthFunc(e),depthMask:(r,e)=>r.depthMask(e),depthRange:(r,e)=>r.depthRange(...e),dither:(r,e)=>e?r.enable(3024):r.disable(3024),derivativeHint:(r,e)=>{r.hint(35723,e)},frontFace:(r,e)=>r.frontFace(e),mipmapHint:(r,e)=>r.hint(33170,e),lineWidth:(r,e)=>r.lineWidth(e),polygonOffsetFill:(r,e)=>e?r.enable(32823):r.disable(32823),polygonOffset:(r,e)=>r.polygonOffset(...e),sampleCoverage:(r,e)=>r.sampleCoverage(e[0],e[1]||!1),scissorTest:(r,e)=>e?r.enable(3089):r.disable(3089),scissor:(r,e)=>r.scissor(...e),stencilTest:(r,e)=>e?r.enable(2960):r.disable(2960),stencilMask:(r,e)=>{e=GI(e)?e:[e,e];const[t,n]=e;r.stencilMaskSeparate(1028,t),r.stencilMaskSeparate(1029,n)},stencilFunc:(r,e)=>{e=GI(e)&&e.length===3?[...e,...e]:e;const[t,n,i,s,a,o]=e;r.stencilFuncSeparate(1028,t,n,i),r.stencilFuncSeparate(1029,s,a,o)},stencilOp:(r,e)=>{e=GI(e)&&e.length===3?[...e,...e]:e;const[t,n,i,s,a,o]=e;r.stencilOpSeparate(1028,t,n,i),r.stencilOpSeparate(1029,s,a,o)},viewport:(r,e)=>r.viewport(...e)};function $i(r,e,t){return e[r]!==void 0?e[r]:t[r]}const Dve={blendEquation:(r,e,t)=>r.blendEquationSeparate($i(32777,e,t),$i(34877,e,t)),blendFunc:(r,e,t)=>r.blendFuncSeparate($i(32969,e,t),$i(32968,e,t),$i(32971,e,t),$i(32970,e,t)),polygonOffset:(r,e,t)=>r.polygonOffset($i(32824,e,t),$i(10752,e,t)),sampleCoverage:(r,e,t)=>r.sampleCoverage($i(32938,e,t),$i(32939,e,t)),stencilFuncFront:(r,e,t)=>r.stencilFuncSeparate(1028,$i(2962,e,t),$i(2967,e,t),$i(2963,e,t)),stencilFuncBack:(r,e,t)=>r.stencilFuncSeparate(1029,$i(34816,e,t),$i(36003,e,t),$i(36004,e,t)),stencilOpFront:(r,e,t)=>r.stencilOpSeparate(1028,$i(2964,e,t),$i(2965,e,t),$i(2966,e,t)),stencilOpBack:(r,e,t)=>r.stencilOpSeparate(1029,$i(34817,e,t),$i(34818,e,t),$i(34819,e,t))},k5={enable:(r,e)=>r({[e]:!0}),disable:(r,e)=>r({[e]:!1}),pixelStorei:(r,e,t)=>r({[e]:t}),hint:(r,e,t)=>r({[e]:t}),useProgram:(r,e)=>r({35725:e}),bindRenderbuffer:(r,e,t)=>r({36007:t}),bindTransformFeedback:(r,e,t)=>r({36389:t}),bindVertexArray:(r,e)=>r({34229:e}),bindFramebuffer:(r,e,t)=>{switch(e){case 36160:return r({36006:t,36010:t});case 36009:return r({36006:t});case 36008:return r({36010:t});default:return null}},bindBuffer:(r,e,t)=>{const n={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[e];return n?r({[n]:t}):{valueChanged:!0}},blendColor:(r,e,t,n,i)=>r({32773:new Float32Array([e,t,n,i])}),blendEquation:(r,e)=>r({32777:e,34877:e}),blendEquationSeparate:(r,e,t)=>r({32777:e,34877:t}),blendFunc:(r,e,t)=>r({32969:e,32968:t,32971:e,32970:t}),blendFuncSeparate:(r,e,t,n,i)=>r({32969:e,32968:t,32971:n,32970:i}),clearColor:(r,e,t,n,i)=>r({3106:new Float32Array([e,t,n,i])}),clearDepth:(r,e)=>r({2931:e}),clearStencil:(r,e)=>r({2961:e}),colorMask:(r,e,t,n,i)=>r({3107:[e,t,n,i]}),cullFace:(r,e)=>r({2885:e}),depthFunc:(r,e)=>r({2932:e}),depthRange:(r,e,t)=>r({2928:new Float32Array([e,t])}),depthMask:(r,e)=>r({2930:e}),frontFace:(r,e)=>r({2886:e}),lineWidth:(r,e)=>r({2849:e}),polygonOffset:(r,e,t)=>r({32824:e,10752:t}),sampleCoverage:(r,e,t)=>r({32938:e,32939:t}),scissor:(r,e,t,n,i)=>r({3088:new Int32Array([e,t,n,i])}),stencilMask:(r,e)=>r({2968:e,36005:e}),stencilMaskSeparate:(r,e,t)=>r({[e===1028?2968:36005]:t}),stencilFunc:(r,e,t,n)=>r({2962:e,2967:t,2963:n,34816:e,36003:t,36004:n}),stencilFuncSeparate:(r,e,t,n,i)=>r({[e===1028?2962:34816]:t,[e===1028?2967:36003]:n,[e===1028?2963:36004]:i}),stencilOp:(r,e,t,n)=>r({2964:e,2965:t,2966:n,34817:e,34818:t,34819:n}),stencilOpSeparate:(r,e,t,n,i)=>r({[e===1028?2964:34817]:t,[e===1028?2965:34818]:n,[e===1028?2966:34819]:i}),viewport:(r,e,t,n,i)=>r({2978:[e,t,n,i]})},Ec=(r,e)=>r.isEnabled(e),O5={3042:Ec,2884:Ec,2929:Ec,3024:Ec,32823:Ec,32926:Ec,32928:Ec,3089:Ec,2960:Ec,35977:Ec},Lve=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function My(r,e){if(Fve(e))return;const t={};for(const i in e){const s=Number(i),a=Ove[i];a&&(typeof a=="string"?t[a]=!0:a(r,e[i],s))}const n=r.state&&r.state.cache;if(n)for(const i in t){const s=Dve[i];s(r,e,n)}}function XK(r,e=EO){if(typeof e=="number"){const i=e,s=O5[i];return s?s(r,i):r.getParameter(i)}const t=Array.isArray(e)?e:Object.keys(e),n={};for(const i of t){const s=O5[i];n[i]=s?s(r,Number(i)):r.getParameter(Number(i))}return n}function Nve(r){My(r,EO)}function Fve(r){for(const e in r)return!1;return!0}function Uve(r,e){if(r===e)return!0;if(D5(r)&&D5(e)&&r.length===e.length){for(let t=0;t<r.length;++t)if(r[t]!==e[t])return!1;return!0}return!1}function D5(r){return Array.isArray(r)||ArrayBuffer.isView(r)}class Yf{constructor(e,t){H(this,"gl");H(this,"program",null);H(this,"stateStack",[]);H(this,"enable",!0);H(this,"cache",null);H(this,"log");H(this,"initialized",!1);this.gl=e,this.log=t?.log||(()=>{}),this._updateCache=this._updateCache.bind(this),Object.seal(this)}static get(e){return e.state}push(e={}){this.stateStack.push({})}pop(){const e=this.stateStack[this.stateStack.length-1];My(this.gl,e),this.stateStack.pop()}trackState(e,t){if(this.cache=t?.copyState?XK(e):Object.assign({},EO),this.initialized)throw new Error("WebGLStateTracker");this.initialized=!0,this.gl.state=this,Vve(e);for(const n in k5){const i=k5[n];zve(e,n,i)}L5(e,"getParameter"),L5(e,"isEnabled")}_updateCache(e){let t=!1,n;const i=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const s in e){const a=e[s],o=this.cache[s];Uve(a,o)||(t=!0,n=o,i&&!(s in i)&&(i[s]=o),this.cache[s]=a)}return{valueChanged:t,oldValue:n}}}function L5(r,e){const t=r[e].bind(r);r[e]=function(i){if(i===void 0||Lve.has(i))return t(i);const s=Yf.get(r);return i in s.cache||(s.cache[i]=t(i)),s.enable?s.cache[i]:t(i)},Object.defineProperty(r[e],"name",{value:`${e}-from-cache`,configurable:!1})}function zve(r,e,t){if(!r[e])return;const n=r[e].bind(r);r[e]=function(...s){const a=Yf.get(r),{valueChanged:o,oldValue:u}=t(a._updateCache,...s);return o&&n(...s),u},Object.defineProperty(r[e],"name",{value:`${e}-to-cache`,configurable:!1})}function Vve(r){const e=r.useProgram.bind(r);r.useProgram=function(n){const i=Yf.get(r);i.program!==n&&(e(n),i.program=n)}}function $ve(r,e,t){let n="";const i={preserveDrawingBuffer:!0,...t};let s=null;if(s||(s=r.getContext("webgl2",i)),i.failIfMajorPerformanceCaveat&&(n||(n="Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow.")),!s&&!t.failIfMajorPerformanceCaveat&&(i.failIfMajorPerformanceCaveat=!1,s=r.getContext("webgl2",i),s.luma||(s.luma={}),s.luma.softwareRenderer=!0),s||(s=r.getContext("webgl",{}),s&&(s=null,n||(n="Your browser only supports WebGL1"))),!s)throw n||(n="Your browser does not support WebGL"),new Error(`Failed to create WebGL context: ${n}`);const{onContextLost:a,onContextRestored:o}=e;return r.addEventListener("webglcontextlost",u=>a(u),!1),r.addEventListener("webglcontextrestored",u=>o(u),!1),s.luma||(s.luma={}),s}function oy(r,e,t){return t[e]===void 0&&(t[e]=r.getExtension(e)||null),t[e]}function jve(r,e){const t=r.getParameter(7936),n=r.getParameter(7937);oy(r,"WEBGL_debug_renderer_info",e);const i=e.WEBGL_debug_renderer_info,s=r.getParameter(i?i.UNMASKED_VENDOR_WEBGL:7936),a=r.getParameter(i?i.UNMASKED_RENDERER_WEBGL:7937),o=s||t,u=a||n,f=r.getParameter(7938),g=JK(o,u),y=Gve(o,u),A=Hve(o,u);return{type:"webgl",gpu:g,gpuType:A,gpuBackend:y,vendor:o,renderer:u,version:f,shadingLanguage:"glsl",shadingLanguageVersion:300}}function JK(r,e){return/NVIDIA/i.exec(r)||/NVIDIA/i.exec(e)?"nvidia":/INTEL/i.exec(r)||/INTEL/i.exec(e)?"intel":/Apple/i.exec(r)||/Apple/i.exec(e)?"apple":/AMD/i.exec(r)||/AMD/i.exec(e)||/ATI/i.exec(r)||/ATI/i.exec(e)?"amd":/SwiftShader/i.exec(r)||/SwiftShader/i.exec(e)?"software":"unknown"}function Gve(r,e){return/Metal/i.exec(r)||/Metal/i.exec(e)?"metal":/ANGLE/i.exec(r)||/ANGLE/i.exec(e)?"opengl":"unknown"}function Hve(r,e){if(/SwiftShader/i.exec(r)||/SwiftShader/i.exec(e))return"cpu";switch(JK(r,e)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}function qK(r){switch(r){case"uint8":return 5121;case"sint8":return 5120;case"unorm8":return 5121;case"snorm8":return 5120;case"uint16":return 5123;case"sint16":return 5122;case"unorm16":return 5123;case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(r))}const B0="WEBGL_compressed_texture_s3tc",M0="WEBGL_compressed_texture_s3tc_srgb",mm="EXT_texture_compression_rgtc",ym="EXT_texture_compression_bptc",Wve="WEBGL_compressed_texture_etc",Kve="WEBGL_compressed_texture_astc",Xve="WEBGL_compressed_texture_etc1",Jve="WEBGL_compressed_texture_pvrtc",qve="WEBGL_compressed_texture_atc",N5="EXT_texture_norm16",F5="EXT_render_snorm",Yve="EXT_color_buffer_float",IO={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat-renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[F5],"norm16-renderable-webgl":[N5],"snorm16-renderable-webgl":[N5,F5],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[B0,M0,mm,ym],"texture-compression-bc5-webgl":[mm],"texture-compression-bc7-webgl":[ym],"texture-compression-etc2":[Wve],"texture-compression-astc":[Kve],"texture-compression-etc1-webgl":[Xve],"texture-compression-pvrtc-webgl":[Jve],"texture-compression-atc-webgl":[qve]};function Zve(r){return r in IO}function Qve(r,e,t){return(IO[e]||[]).every(i=>oy(r,i,t))}const PO={r8unorm:{gl:33321,rb:!0},r8snorm:{gl:36756},r8uint:{gl:33330,rb:!0},r8sint:{gl:33329,rb:!0},rg8unorm:{gl:33323,rb:!0},rg8snorm:{gl:36757},rg8uint:{gl:33336,rb:!0},rg8sint:{gl:33335,rb:!0},r16uint:{gl:33332,rb:!0},r16sint:{gl:33331,rb:!0},r16float:{gl:33325,rb:!0},r16unorm:{gl:33322,rb:!0},r16snorm:{gl:36760},"rgba4unorm-webgl":{gl:32854,rb:!0},"rgb565unorm-webgl":{gl:36194,rb:!0},"rgb5a1unorm-webgl":{gl:32855,rb:!0},"rgb8unorm-webgl":{gl:32849},"rgb8snorm-webgl":{gl:36758},rgba8unorm:{gl:32856},"rgba8unorm-srgb":{gl:35907},rgba8snorm:{gl:36759},rgba8uint:{gl:36220},rgba8sint:{gl:36238},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{gl:33338},rg16sint:{gl:33337},rg16float:{gl:33327,rb:!0},rg16unorm:{gl:33324},rg16snorm:{gl:36761},r32uint:{gl:33334,rb:!0},r32sint:{gl:33333,rb:!0},r32float:{gl:33326},rgb9e5ufloat:{gl:35901},rg11b10ufloat:{gl:35898,rb:!0},rgb10a2unorm:{gl:32857,rb:!0},rgb10a2uint:{gl:36975,rb:!0},"rgb16unorm-webgl":{gl:32852},"rgb16snorm-webgl":{gl:36762},rg32uint:{gl:33340,rb:!0},rg32sint:{gl:33339,rb:!0},rg32float:{gl:33328,rb:!0},rgba16uint:{gl:36214,rb:!0},rgba16sint:{gl:36232,rb:!0},rgba16float:{gl:34842},rgba16unorm:{gl:32859,rb:!0},rgba16snorm:{gl:36763},"rgb32float-webgl":{gl:34837,x:Yve,dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,rb:!0},rgba32sint:{gl:36226,rb:!0},rgba32float:{gl:34836,rb:!0},stencil8:{gl:36168,rb:!0},depth16unorm:{gl:33189,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,dataFormat:6402,types:[5125]},depth32float:{gl:36012,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth32float-stencil8":{gl:36013,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:B0},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:M0},"bc1-rgba-unorm":{gl:33777,x:B0},"bc1-rgba-unorm-srgb":{gl:35916,x:M0},"bc2-rgba-unorm":{gl:33778,x:B0},"bc2-rgba-unorm-srgb":{gl:35918,x:M0},"bc3-rgba-unorm":{gl:33779,x:B0},"bc3-rgba-unorm-srgb":{gl:35919,x:M0},"bc4-r-unorm":{gl:36283,x:mm},"bc4-r-snorm":{gl:36284,x:mm},"bc5-rg-unorm":{gl:36285,x:mm},"bc5-rg-snorm":{gl:36286,x:mm},"bc6h-rgb-ufloat":{gl:36495,x:ym},"bc6h-rgb-float":{gl:36494,x:ym},"bc7-rgba-unorm":{gl:36492,x:ym},"bc7-rgba-unorm-srgb":{gl:36493,x:ym},"etc2-rgb8unorm":{gl:37492},"etc2-rgb8unorm-srgb":{gl:37494},"etc2-rgb8a1unorm":{gl:37496},"etc2-rgb8a1unorm-srgb":{gl:37497},"etc2-rgba8unorm":{gl:37493},"etc2-rgba8unorm-srgb":{gl:37495},"eac-r11unorm":{gl:37488},"eac-r11snorm":{gl:37489},"eac-rg11unorm":{gl:37490},"eac-rg11snorm":{gl:37491},"astc-4x4-unorm":{gl:37808},"astc-4x4-unorm-srgb":{gl:37840},"astc-5x4-unorm":{gl:37809},"astc-5x4-unorm-srgb":{gl:37841},"astc-5x5-unorm":{gl:37810},"astc-5x5-unorm-srgb":{gl:37842},"astc-6x5-unorm":{gl:37811},"astc-6x5-unorm-srgb":{gl:37843},"astc-6x6-unorm":{gl:37812},"astc-6x6-unorm-srgb":{gl:37844},"astc-8x5-unorm":{gl:37813},"astc-8x5-unorm-srgb":{gl:37845},"astc-8x6-unorm":{gl:37814},"astc-8x6-unorm-srgb":{gl:37846},"astc-8x8-unorm":{gl:37815},"astc-8x8-unorm-srgb":{gl:37847},"astc-10x5-unorm":{gl:37819},"astc-10x5-unorm-srgb":{gl:37851},"astc-10x6-unorm":{gl:37817},"astc-10x6-unorm-srgb":{gl:37849},"astc-10x8-unorm":{gl:37818},"astc-10x8-unorm-srgb":{gl:37850},"astc-10x10-unorm":{gl:37819},"astc-10x10-unorm-srgb":{gl:37851},"astc-12x10-unorm":{gl:37820},"astc-12x10-unorm-srgb":{gl:37852},"astc-12x12-unorm":{gl:37821},"astc-12x12-unorm-srgb":{gl:37853},"pvrtc-rgb4unorm-webgl":{gl:35840},"pvrtc-rgba4unorm-webgl":{gl:35842},"pvrtc-rbg2unorm-webgl":{gl:35841},"pvrtc-rgba2unorm-webgl":{gl:35843},"etc1-rbg-unorm-webgl":{gl:36196},"atc-rgb-unorm-webgl":{gl:35986},"atc-rgba-unorm-webgl":{gl:35986},"atc-rgbai-unorm-webgl":{gl:34798}};function eAe(r,e,t){let n=e.create;const i=PO[e.format];return i?.gl===void 0&&(n=!1),i?.x&&(n=n&&!!oy(r,i.x,t)),{format:e.format,create:n&&e.create,render:n&&e.render,filter:n&&e.filter,blend:n&&e.blend,store:n&&e.store}}function YK(r){const e=PO[r],t=nAe(r),n=Dm.getInfo(r);return n.compressed&&(e.dataFormat=t),{internalFormat:t,format:e?.dataFormat||rAe(n.channels,n.integer,n.normalized,t),type:n.dataType?qK(n.dataType):e?.types?.[0]||5121,compressed:n.compressed||!1}}function tAe(r){switch(Dm.getInfo(r).attachment){case"depth":return 36096;case"stencil":return 36128;case"depth-stencil":return 33306;default:throw new Error(`Not a depth stencil format: ${r}`)}}function rAe(r,e,t,n){if(n===6408||n===6407)return n;switch(r){case"r":return e&&!t?36244:6403;case"rg":return e&&!t?33320:33319;case"rgb":return e&&!t?36248:6407;case"rgba":return e&&!t?36249:6408;case"bgra":throw new Error("bgra pixels not supported by WebGL");default:return 6408}}function nAe(r){const t=PO[r]?.gl;if(t===void 0)throw new Error(`Unsupported texture format ${r}`);return t}const U5={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class iAe extends Ipe{constructor(t,n,i){super([],i);H(this,"gl");H(this,"extensions");H(this,"testedFeatures",new Set);this.gl=t,this.extensions=n,oy(t,"EXT_color_buffer_float",n)}*[Symbol.iterator](){const t=this.getFeatures();for(const n of t)this.has(n)&&(yield n);return[]}has(t){return this.disabledFeatures?.[t]?!1:(this.testedFeatures.has(t)||(this.testedFeatures.add(t),Zve(t)&&Qve(this.gl,t,this.extensions)&&this.features.add(t),this.getWebGLFeature(t)&&this.features.add(t)),this.features.has(t))}initializeFeatures(){const t=this.getFeatures().filter(n=>n!=="polygon-mode-webgl");for(const n of t)this.has(n)}getFeatures(){return[...Object.keys(U5),...Object.keys(IO)]}getWebGLFeature(t){const n=U5[t];return typeof n=="string"?!!oy(this.gl,n,this.extensions):!!n}}class sAe extends Epe{constructor(t){super();H(this,"gl");H(this,"limits",{});this.gl=t}get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderVariables(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}getParameter(t){return this.limits[t]===void 0&&(this.limits[t]=this.gl.getParameter(t)),this.limits[t]||0}}class r_ extends DC{constructor(t,n){super(t,n);H(this,"device");H(this,"gl");H(this,"handle");H(this,"colorAttachments",[]);H(this,"depthStencilAttachment",null);const i=n.handle===null;this.device=t,this.gl=t.gl,this.handle=this.props.handle||i?this.props.handle:this.gl.createFramebuffer(),i||(t._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this.autoCreateAttachmentTextures(),this.updateAttachments())}destroy(){super.destroy(),!this.destroyed&&this.handle!==null&&this.gl.deleteFramebuffer(this.handle)}updateAttachments(){const t=this.gl.bindFramebuffer(36160,this.handle);for(let n=0;n<this.colorAttachments.length;++n){const i=this.colorAttachments[n];if(i){const s=36064+n;this._attachTextureView(s,i)}}if(this.depthStencilAttachment){const n=tAe(this.depthStencilAttachment.props.format);this._attachTextureView(n,this.depthStencilAttachment)}if(this.device.props.debug){const n=this.gl.checkFramebufferStatus(36160);if(n!==36053)throw new Error(`Framebuffer ${aAe(n)}`)}this.gl.bindFramebuffer(36160,t)}_attachTextureView(t,n){const{gl:i}=this.device,{texture:s}=n,a=n.props.baseMipLevel,o=n.props.baseArrayLayer;switch(i.bindTexture(s.glTarget,s.handle),s.glTarget){case 35866:case 32879:i.framebufferTextureLayer(36160,t,s.handle,a,o);break;case 34067:const u=oAe(o);i.framebufferTexture2D(36160,t,u,s.handle,a);break;case 3553:i.framebufferTexture2D(36160,t,3553,s.handle,a);break;default:throw new Error("Illegal texture type")}i.bindTexture(s.glTarget,null)}}function oAe(r){return r<34069?r+34069:r}function aAe(r){switch(r){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${r}`}}class lAe extends RC{constructor(t,n){super(n);H(this,"device");H(this,"handle",null);H(this,"_framebuffer",null);this.device=t,this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this._updateDevice()}get[Symbol.toStringTag](){return"WebGLCanvasContext"}getCurrentFramebuffer(){return this._framebuffer=this._framebuffer||new r_(this.device,{handle:null}),this._framebuffer}_updateDevice(){}}const HI={};function cAe(r="id"){HI[r]=HI[r]||1;const e=HI[r]++;return`${r}-${e}`}class n_ extends Li{constructor(t,n={}){super(t,n);H(this,"device");H(this,"gl");H(this,"handle");H(this,"glTarget");H(this,"glUsage");H(this,"glIndexType",5123);H(this,"byteLength",0);H(this,"bytesUsed",0);this.device=t,this.gl=this.device.gl;const i=typeof n=="object"?n.handle:void 0;this.handle=i||this.gl.createBuffer(),t._setWebGLDebugMetadata(this.handle,this,{spector:{...this.props,data:typeof this.props.data}}),this.glTarget=uAe(this.props.usage),this.glUsage=hAe(this.props.usage),this.glIndexType=this.props.indexType==="uint32"?5125:5123,n.data?this._initWithData(n.data,n.byteOffset,n.byteLength):this._initWithByteLength(n.byteLength||0)}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}_initWithData(t,n=0,i=t.byteLength+n){const s=this.glTarget;this.gl.bindBuffer(s,this.handle),this.gl.bufferData(s,i,this.glUsage),this.gl.bufferSubData(s,n,t),this.gl.bindBuffer(s,null),this.bytesUsed=i,this.byteLength=i,this._setDebugData(t,n,i),this.trackAllocatedMemory(i)}_initWithByteLength(t){let n=t;t===0&&(n=new Float32Array(0));const i=this.glTarget;return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,this.glUsage),this.gl.bindBuffer(i,null),this.bytesUsed=t,this.byteLength=t,this._setDebugData(null,0,t),this.trackAllocatedMemory(t),this}write(t,n=0){const i=ArrayBuffer.isView(t)?t:new Uint8Array(t),s=36663;this.gl.bindBuffer(s,this.handle),this.gl.bufferSubData(s,n,i),this.gl.bindBuffer(s,null),this._setDebugData(t,n,t.byteLength)}async mapAndWriteAsync(t,n=0,i=this.byteLength-n){const s=new ArrayBuffer(i);await t(s,"copied"),this.write(s,n)}async readAsync(t=0,n){return this.readSyncWebGL(t,n)}async mapAndReadAsync(t,n=0,i){const s=await this.readAsync(n,i);return await t(s.buffer,"copied")}readSyncWebGL(t=0,n){n=n??this.byteLength-t;const i=new Uint8Array(n),s=0;return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,i,s,n),this.gl.bindBuffer(36662,null),this._setDebugData(i,t,n),i}}function uAe(r){return r&Li.INDEX?34963:r&Li.VERTEX?34962:r&Li.UNIFORM?35345:34962}function hAe(r){return r&Li.INDEX||r&Li.VERTEX?35044:r&Li.UNIFORM?35048:35044}function dAe(r){const e=r.split(/\r?\n/),t=[];for(const n of e){if(n.length<=1)continue;const i=n.split(":");if(i.length===2){const[y,A]=i;t.push({message:A.trim(),type:z5(y),lineNum:0,linePos:0});continue}const[s,a,o,...u]=i;let f=parseInt(o,10);isNaN(f)&&(f=0);let g=parseInt(a,10);isNaN(g)&&(g=0),t.push({message:u.join(":").trim(),type:z5(s),lineNum:f,linePos:g})}return t}function z5(r){const e=["warning","error","info"],t=r.toLowerCase();return e.includes(t)?t:"info"}class fAe extends OC{constructor(t,n){super(t,n);H(this,"device");H(this,"handle");switch(this.device=t,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}t._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0,this.handle.destroyed=!0)}get asyncCompilationStatus(){return this._waitForCompilationComplete().then(()=>(this._getCompilationStatus(),this.compilationStatus))}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){const t=this.device.gl.getShaderInfoLog(this.handle);return t?dAe(t):[]}getTranslatedSource(){return this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders?.getTranslatedShaderSource(this.handle)||null}async _compile(t){t=t.startsWith("#version ")?t:`#version 300 es
${t}`;const{gl:n}=this.device;if(n.shaderSource(this.handle,t),n.compileShader(this.handle),!this.device.props.debug){this.compilationStatus="pending";return}if(!this.device.features.has("compilation-status-async-webgl")){if(this._getCompilationStatus(),this.debugShader(),this.compilationStatus==="error")throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`);return}Bt.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),Bt.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader()}async _waitForCompilationComplete(){const t=async s=>await new Promise(a=>setTimeout(a,s));if(!this.device.features.has("compilation-status-async-webgl")){await t(10);return}const{gl:i}=this.device;for(;;){if(i.getShaderParameter(this.handle,37297))return;await t(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}function pAe(r,e,t,n){if(bAe(e))return n(r);const i=r;i.pushState();try{return gAe(r,e),My(i.gl,t),n(r)}finally{i.popState()}}function gAe(r,e){const t=r,{gl:n}=t;if(e.cullMode)switch(e.cullMode){case"none":n.disable(2884);break;case"front":n.enable(2884),n.cullFace(1028);break;case"back":n.enable(2884),n.cullFace(1029);break}if(e.frontFace&&n.frontFace(Zf("frontFace",e.frontFace,{ccw:2305,cw:2304})),e.unclippedDepth&&r.features.has("depth-clip-control")&&n.enable(34383),e.depthBias!==void 0&&(n.enable(32823),n.polygonOffset(e.depthBias,e.depthBiasSlopeScale||0)),e.provokingVertex&&r.features.has("provoking-vertex-webgl")){const s=t.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,a=Zf("provokingVertex",e.provokingVertex,{first:36429,last:36430});s?.provokingVertexWEBGL(a)}if((e.polygonMode||e.polygonOffsetLine)&&r.features.has("polygon-mode-webgl")){if(e.polygonMode){const s=t.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,a=Zf("polygonMode",e.polygonMode,{fill:6914,line:6913});s?.polygonModeWEBGL(1028,a),s?.polygonModeWEBGL(1029,a)}e.polygonOffsetLine&&n.enable(10754)}if(r.features.has("shader-clip-cull-distance-webgl")&&(e.clipDistance0&&n.enable(12288),e.clipDistance1&&n.enable(12289),e.clipDistance2&&n.enable(12290),e.clipDistance3&&n.enable(12291),e.clipDistance4&&n.enable(12292),e.clipDistance5&&n.enable(12293),e.clipDistance6&&n.enable(12294),e.clipDistance7&&n.enable(12295)),e.depthWriteEnabled!==void 0&&n.depthMask(yAe("depthWriteEnabled",e.depthWriteEnabled)),e.depthCompare&&(e.depthCompare!=="always"?n.enable(2929):n.disable(2929),n.depthFunc(IB("depthCompare",e.depthCompare))),e.stencilWriteMask){const i=e.stencilWriteMask;n.stencilMaskSeparate(1028,i),n.stencilMaskSeparate(1029,i)}if(e.stencilReadMask&&Bt.warn("stencilReadMask not supported under WebGL"),e.stencilCompare){const i=e.stencilReadMask||4294967295,s=IB("depthCompare",e.stencilCompare);e.stencilCompare!=="always"?n.enable(2960):n.disable(2960),n.stencilFuncSeparate(1028,s,0,i),n.stencilFuncSeparate(1029,s,0,i)}if(e.stencilPassOperation&&e.stencilFailOperation&&e.stencilDepthFailOperation){const i=WI("stencilPassOperation",e.stencilPassOperation),s=WI("stencilFailOperation",e.stencilFailOperation),a=WI("stencilDepthFailOperation",e.stencilDepthFailOperation);n.stencilOpSeparate(1028,s,a,i),n.stencilOpSeparate(1029,s,a,i)}switch(e.blend){case!0:n.enable(3042);break;case!1:n.disable(3042);break}if(e.blendColorOperation||e.blendAlphaOperation){const i=V5("blendColorOperation",e.blendColorOperation||"add"),s=V5("blendAlphaOperation",e.blendAlphaOperation||"add");n.blendEquationSeparate(i,s);const a=sx("blendColorSrcFactor",e.blendColorSrcFactor||"one"),o=sx("blendColorDstFactor",e.blendColorDstFactor||"zero"),u=sx("blendAlphaSrcFactor",e.blendAlphaSrcFactor||"one"),f=sx("blendAlphaDstFactor",e.blendAlphaDstFactor||"zero");n.blendFuncSeparate(a,o,u,f)}}function IB(r,e){return Zf(r,e,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function WI(r,e){return Zf(r,e,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function V5(r,e){return Zf(r,e,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function sx(r,e,t="color"){return Zf(r,e,{one:1,zero:0,src:768,"one-minus-src":769,dst:774,"one-minus-dst":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,constant:t==="color"?32769:32771,"one-minus-constant":t==="color"?32770:32772,src1:768,"one-minus-src1":769,"src1-alpha":770,"one-minus-src1-alpha":771})}function mAe(r,e){return`Illegal parameter ${e} for ${r}`}function Zf(r,e,t){if(!(e in t))throw new Error(mAe(r,e));return t[e]}function yAe(r,e){return e}function bAe(r){let e=!0;for(const t in r){e=!1;break}return e}function ZK(r){const e={};return r.addressModeU&&(e[10242]=KI(r.addressModeU)),r.addressModeV&&(e[10243]=KI(r.addressModeV)),r.addressModeW&&(e[32882]=KI(r.addressModeW)),r.magFilter&&(e[10240]=PB(r.magFilter)),(r.minFilter||r.mipmapFilter)&&(e[10241]=_Ae(r.minFilter||"linear",r.mipmapFilter)),r.lodMinClamp!==void 0&&(e[33082]=r.lodMinClamp),r.lodMaxClamp!==void 0&&(e[33083]=r.lodMaxClamp),r.type==="comparison-sampler"&&(e[34892]=34894),r.compare&&(e[34893]=IB("compare",r.compare)),r.maxAnisotropy&&(e[34046]=r.maxAnisotropy),e}function KI(r){switch(r){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function PB(r){switch(r){case"nearest":return 9728;case"linear":return 9729}}function _Ae(r,e="none"){if(!e)return PB(r);switch(e){case"none":return PB(r);case"nearest":switch(r){case"nearest":return 9984;case"linear":return 9985}break;case"linear":switch(r){case"nearest":return 9986;case"linear":return 9987}}}class vAe extends ey{constructor(t,n){super(t,n);H(this,"device");H(this,"handle");H(this,"parameters");this.device=t,this.parameters=ZK(n),this.handle=n.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(t){for(const[n,i]of Object.entries(t)){const s=Number(n);switch(s){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,s,i);break;default:this.device.gl.samplerParameteri(this.handle,s,i);break}}}}function W_(r,e,t){if(AAe(e))return t(r);const{nocatch:n=!0}=e,i=Yf.get(r);i.push(),My(r,e);let s;if(n)s=t(r),i.pop();else try{s=t(r)}finally{i.pop()}return s}function AAe(r){for(const e in r)return!1;return!0}class bm extends kC{constructor(t,n){super(t,{...ca.defaultProps,...n});H(this,"device");H(this,"gl");H(this,"handle");H(this,"texture");this.device=t,this.gl=this.device.gl,this.handle=null,this.texture=n.texture}}class i_ extends ca{constructor(t,n){super(t,n);H(this,"device");H(this,"gl");H(this,"handle");H(this,"sampler");H(this,"view");H(this,"glTarget");H(this,"glFormat");H(this,"glType");H(this,"glInternalFormat");H(this,"compressed");H(this,"_textureUnit",0);this.device=t,this.gl=this.device.gl;const i=YK(this.props.format);this.glTarget=xAe(this.props.dimension),this.glInternalFormat=i.internalFormat,this.glFormat=i.format,this.glType=i.type,this.compressed=i.compressed,this.handle=this.props.handle||this.gl.createTexture(),this.device._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this.gl.bindTexture(this.glTarget,this.handle);const{dimension:s,width:a,height:o,depth:u,mipLevels:f,glTarget:g,glInternalFormat:y}=this;switch(s){case"2d":case"cube":this.gl.texStorage2D(g,f,y,a,o);break;case"2d-array":case"3d":this.gl.texStorage3D(g,f,y,a,o,u);break;default:throw new Error(s)}this.gl.bindTexture(this.glTarget,null),this._initializeData(n.data),this.setSampler(this.props.sampler),this.view=new bm(this.device,{...this.props,texture:this}),Object.seal(this)}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}createView(t){return new bm(this.device,{...t,texture:this})}setSampler(t={}){super.setSampler(t);const n=ZK(this.sampler.props);this._setSamplerParameters(n)}copyImageData(t){const n=this._normalizeCopyImageDataOptions(t),i=n.data,{width:s,height:a,depth:o}=this,{mipLevel:u=0,byteOffset:f=0,x:g=0,y=0,z:A=0}=n,{glFormat:C,glType:M,compressed:k}=this,D=$5(this.glTarget,this.dimension,A);let V;if(!this.compressed){const{bytesPerPixel:z}=this.device.getTextureFormatInfo(this.format);if(z){if(n.bytesPerRow%z!==0)throw new Error(`bytesPerRow (${n.bytesPerRow}) must be a multiple of bytesPerPixel (${z}) for ${this.format}`);V=n.bytesPerRow/z}}const W=this.compressed?{}:{...V!==void 0?{3314:V}:{},32878:n.rowsPerImage};this.gl.bindTexture(D,this.handle),W_(this.gl,W,()=>{switch(this.dimension){case"2d":case"cube":k?this.gl.compressedTexSubImage2D(D,u,g,y,s,a,C,i,f):this.gl.texSubImage2D(D,u,g,y,s,a,C,M,i,f);break;case"2d-array":case"3d":k?this.gl.compressedTexSubImage3D(D,u,g,y,A,s,a,o,C,i,f):this.gl.texSubImage3D(D,u,g,y,A,s,a,o,C,M,i,f);break;default:}}),this.gl.bindTexture(D,null)}copyExternalImage(t){const n=this._normalizeCopyExternalImageOptions(t);if(n.sourceX||n.sourceY)throw new Error("WebGL does not support sourceX/sourceY)");const{glFormat:i,glType:s}=this,{image:a,depth:o,mipLevel:u,x:f,y:g,z:y,width:A,height:C}=n,M=$5(this.glTarget,this.dimension,o),k=n.flipY?{37440:!0}:{};return this.gl.bindTexture(this.glTarget,this.handle),W_(this.gl,k,()=>{switch(this.dimension){case"2d":case"cube":this.gl.texSubImage2D(M,u,f,g,A,C,i,s,a);break;case"2d-array":case"3d":this.gl.texSubImage3D(M,u,f,g,y,A,C,o,i,s,a);break;default:}}),this.gl.bindTexture(this.glTarget,null),{width:n.width,height:n.height}}generateMipmapsWebGL(t){if(!(!(this.device.isTextureFormatRenderable(this.props.format)&&this.device.isTextureFormatFilterable(this.props.format))&&(Bt.warn(`${this} is not renderable or filterable, may not be able to generate mipmaps`)(),!t?.force)))try{this.gl.bindTexture(this.glTarget,this.handle),this.gl.generateMipmap(this.glTarget)}catch(i){Bt.warn(`Error generating mipmap for ${this}: ${i.message}`)()}finally{this.gl.bindTexture(this.glTarget,null)}}_setSamplerParameters(t){Bt.log(2,`${this.id} sampler parameters`,this.device.getGLKeys(t))(),this.gl.bindTexture(this.glTarget,this.handle);for(const[n,i]of Object.entries(t)){const s=Number(n),a=i;switch(s){case 33082:case 33083:this.gl.texParameterf(this.glTarget,s,a);break;case 10240:case 10241:this.gl.texParameteri(this.glTarget,s,a);break;case 10242:case 10243:case 32882:this.gl.texParameteri(this.glTarget,s,a);break;case 34046:this.device.features.has("texture-filterable-anisotropic-webgl")&&this.gl.texParameteri(this.glTarget,s,a);break;case 34892:case 34893:this.gl.texParameteri(this.glTarget,s,a);break}}this.gl.bindTexture(this.glTarget,null)}_getActiveUnit(){return this.gl.getParameter(34016)-33984}_bind(t){const{gl:n}=this;return t!==void 0&&(this._textureUnit=t,n.activeTexture(33984+t)),n.bindTexture(this.glTarget,this.handle),t}_unbind(t){const{gl:n}=this;return t!==void 0&&(this._textureUnit=t,n.activeTexture(33984+t)),n.bindTexture(this.glTarget,null),t}}function xAe(r){switch(r){case"1d":break;case"2d":return 3553;case"3d":return 32879;case"cube":return 34067;case"2d-array":return 35866}throw new Error(r)}function $5(r,e,t){return e==="cube"?34069+t:r}function wAe(r){return EAe[r]}function BO(r){return SAe[r]}function CAe(r){return!!QK[r]}function TAe(r){return QK[r]}const SAe={5126:"f32",35664:"vec2<f32>",35665:"vec3<f32>",35666:"vec4<f32>",5124:"i32",35667:"vec2<i32>",35668:"vec3<i32>",35669:"vec4<i32>",5125:"u32",36294:"vec2<u32>",36295:"vec3<u32>",36296:"vec4<u32>",35670:"f32",35671:"vec2<f32>",35672:"vec3<f32>",35673:"vec4<f32>",35674:"mat2x2<f32>",35685:"mat2x3<f32>",35686:"mat2x4<f32>",35687:"mat3x2<f32>",35675:"mat3x3<f32>",35688:"mat3x4<f32>",35689:"mat4x2<f32>",35690:"mat4x3<f32>",35676:"mat4x4<f32>"},QK={35678:{viewDimension:"2d",sampleType:"float"},35680:{viewDimension:"cube",sampleType:"float"},35679:{viewDimension:"3d",sampleType:"float"},35682:{viewDimension:"3d",sampleType:"depth"},36289:{viewDimension:"2d-array",sampleType:"float"},36292:{viewDimension:"2d-array",sampleType:"depth"},36293:{viewDimension:"cube",sampleType:"float"},36298:{viewDimension:"2d",sampleType:"sint"},36299:{viewDimension:"3d",sampleType:"sint"},36300:{viewDimension:"cube",sampleType:"sint"},36303:{viewDimension:"2d-array",sampleType:"uint"},36306:{viewDimension:"2d",sampleType:"uint"},36307:{viewDimension:"3d",sampleType:"uint"},36308:{viewDimension:"cube",sampleType:"uint"},36311:{viewDimension:"2d-array",sampleType:"uint"}},EAe={uint8:5121,sint8:5120,unorm8:5121,snorm8:5120,uint16:5123,sint16:5122,unorm16:5123,snorm16:5122,uint32:5125,sint32:5124,float16:5131,float32:5126};function IAe(r,e){const t={attributes:[],bindings:[]};t.attributes=PAe(r,e);const n=RAe(r,e);for(const o of n){const u=o.uniforms.map(f=>({name:f.name,format:f.format,byteOffset:f.byteOffset,byteStride:f.byteStride,arrayLength:f.arrayLength}));t.bindings.push({type:"uniform",name:o.name,group:0,location:o.location,visibility:(o.vertex?1:0)&(o.fragment?2:0),minBindingSize:o.byteLength,uniforms:u})}const i=MAe(r,e);let s=0;for(const o of i)if(CAe(o.type)){const{viewDimension:u,sampleType:f}=TAe(o.type);t.bindings.push({type:"texture",name:o.name,group:0,location:s,viewDimension:u,sampleType:f}),o.textureUnit=s,s+=1}i.length&&(t.uniforms=i);const a=BAe(r,e);return a?.length&&(t.varyings=a),t}function PAe(r,e){const t=[],n=r.getProgramParameter(e,35721);for(let i=0;i<n;i++){const s=r.getActiveAttrib(e,i);if(!s)throw new Error("activeInfo");const{name:a,type:o}=s,u=r.getAttribLocation(e,a);if(u>=0){const f=BO(o),g=/instance/i.test(a)?"instance":"vertex";t.push({name:a,location:u,stepMode:g,type:f})}}return t.sort((i,s)=>i.location-s.location),t}function BAe(r,e){const t=[],n=r.getProgramParameter(e,35971);for(let i=0;i<n;i++){const s=r.getTransformFeedbackVarying(e,i);if(!s)throw new Error("activeInfo");const{name:a,type:o,size:u}=s,f=BO(o),{type:g,components:y}=xW(f);t.push({location:i,name:a,type:g,size:u*y})}return t.sort((i,s)=>i.location-s.location),t}function MAe(r,e){const t=[],n=r.getProgramParameter(e,35718);for(let i=0;i<n;i++){const s=r.getActiveUniform(e,i);if(!s)throw new Error("activeInfo");const{name:a,size:o,type:u}=s,{name:f,isArray:g}=kAe(a);let y=r.getUniformLocation(e,f);const A={location:y,name:f,size:o,type:u,isArray:g};if(t.push(A),A.size>1)for(let C=0;C<A.size;C++){const M=`${f}[${C}]`;y=r.getUniformLocation(e,M);const k={...A,name:M,location:y};t.push(k)}}return t}function RAe(r,e){const t=(s,a)=>r.getActiveUniformBlockParameter(e,s,a),n=[],i=r.getProgramParameter(e,35382);for(let s=0;s<i;s++){const a={name:r.getActiveUniformBlockName(e,s)||"",location:t(s,35391),byteLength:t(s,35392),vertex:t(s,35396),fragment:t(s,35398),uniformCount:t(s,35394),uniforms:[]},o=t(s,35395)||[],u=r.getActiveUniforms(e,o,35383),f=r.getActiveUniforms(e,o,35384),g=r.getActiveUniforms(e,o,35387),y=r.getActiveUniforms(e,o,35388);for(let A=0;A<a.uniformCount;++A){const C=r.getActiveUniform(e,o[A]);if(!C)throw new Error("activeInfo");const M=BO(u[A]);a.uniforms.push({name:C.name,format:M,type:u[A],arrayLength:f[A],byteOffset:g[A],byteStride:y[A]})}n.push(a)}return n.sort((s,a)=>s.location-a.location),n}function kAe(r){if(r[r.length-1]!=="]")return{name:r,length:1,isArray:!1};const t=/([^[]*)(\[[0-9]+\])?/.exec(r);if(!t||t.length<2)throw new Error(`Failed to parse GLSL uniform name ${r}`);return{name:t[1],length:t[2]?1:0,isArray:!!t[2]}}function OAe(r,e,t,n){const i=r;let s=n;s===!0&&(s=1),s===!1&&(s=0);const a=typeof s=="number"?[s]:s;switch(t){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if(typeof n!="number")throw new Error("samplers must be set to integers");return r.uniform1i(e,n);case 5126:return r.uniform1fv(e,a);case 35664:return r.uniform2fv(e,a);case 35665:return r.uniform3fv(e,a);case 35666:return r.uniform4fv(e,a);case 5124:return r.uniform1iv(e,a);case 35667:return r.uniform2iv(e,a);case 35668:return r.uniform3iv(e,a);case 35669:return r.uniform4iv(e,a);case 35670:return r.uniform1iv(e,a);case 35671:return r.uniform2iv(e,a);case 35672:return r.uniform3iv(e,a);case 35673:return r.uniform4iv(e,a);case 5125:return i.uniform1uiv(e,a,1);case 36294:return i.uniform2uiv(e,a,2);case 36295:return i.uniform3uiv(e,a,3);case 36296:return i.uniform4uiv(e,a,4);case 35674:return r.uniformMatrix2fv(e,!1,a);case 35675:return r.uniformMatrix3fv(e,!1,a);case 35676:return r.uniformMatrix4fv(e,!1,a);case 35685:return i.uniformMatrix2x3fv(e,!1,a);case 35686:return i.uniformMatrix2x4fv(e,!1,a);case 35687:return i.uniformMatrix3x2fv(e,!1,a);case 35688:return i.uniformMatrix3x4fv(e,!1,a);case 35689:return i.uniformMatrix4x2fv(e,!1,a);case 35690:return i.uniformMatrix4x3fv(e,!1,a)}throw new Error("Illegal uniform")}function DAe(r){switch(r){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"triangle-list":return 4;case"triangle-strip":return 5;default:throw new Error(r)}}function LAe(r){switch(r){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 1;case"triangle-list":return 4;case"triangle-strip":return 4;default:throw new Error(r)}}const j5=4;class NAe extends Jf{constructor(t,n){super(t,n);H(this,"device");H(this,"handle");H(this,"vs");H(this,"fs");H(this,"introspectedLayout");H(this,"uniforms",{});H(this,"bindings",{});H(this,"varyings",null);H(this,"_uniformCount",0);H(this,"_uniformSetters",{});this.device=t,this.handle=this.props.handle||this.device.gl.createProgram(),this.device._setWebGLDebugMetadata(this.handle,this,{spector:{id:this.props.id}}),this.vs=n.vs,this.fs=n.fs;const{varyings:i,bufferMode:s=35981}=n;i&&i.length>0&&(this.varyings=i,this.device.gl.transformFeedbackVaryings(this.handle,i,s)),this._linkShaders(),Bt.time(3,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=IAe(this.device.gl,this.handle),Bt.timeEnd(3,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=n.shaderLayout?FAe(this.introspectedLayout,n.shaderLayout):this.introspectedLayout}get[Symbol.toStringTag](){return"WEBGLRenderPipeline"}destroy(){this.handle&&(this.device.gl.useProgram(null),this.device.gl.deleteProgram(this.handle),this.destroyed=!0,this.handle.destroyed=!0,this.handle=null)}setBindings(t,n){for(const[i,s]of Object.entries(t)){const a=this.shaderLayout.bindings.find(o=>o.name===i)||this.shaderLayout.bindings.find(o=>o.name===`${i}Uniforms`);if(!a){const o=this.shaderLayout.bindings.map(u=>`"${u.name}"`).join(", ");n?.disableWarnings||Bt.warn(`No binding "${i}" in render pipeline "${this.id}", expected one of ${o}`,s)();continue}switch(s||Bt.warn(`Unsetting binding "${i}" in render pipeline "${this.id}"`)(),a.type){case"uniform":if(!(s instanceof n_)&&!(s.buffer instanceof n_))throw new Error("buffer value");break;case"texture":if(!(s instanceof bm||s instanceof i_||s instanceof r_))throw new Error(`${this} Bad texture binding for ${i}`);break;case"sampler":Bt.warn(`Ignoring sampler ${i}`)();break;default:throw new Error(a.type)}this.bindings[i]=s}}draw(t){const{renderPass:n,parameters:i=this.props.parameters,topology:s=this.props.topology,vertexArray:a,vertexCount:o,instanceCount:u,isInstanced:f=!1,firstVertex:g=0,transformFeedback:y}=t,A=DAe(s),C=!!a.indexBuffer,M=a.indexBuffer?.glIndexType;if(this.linkStatus!=="success")return Bt.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable())return Bt.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;this.device.gl.useProgram(this.handle),a.bindBeforeRender(n),y&&y.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const k=n;return pAe(this.device,i,k.glParameters,()=>{C&&f?this.device.gl.drawElementsInstanced(A,o||0,M,g,u||0):C?this.device.gl.drawElements(A,o||0,M,g):f?this.device.gl.drawArraysInstanced(A,g,o||0,u||0):this.device.gl.drawArrays(A,g,o||0),y&&y.end()}),a.unbindAfterRender(n),!0}async _linkShaders(){const{gl:t}=this.device;if(t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),Bt.time(j5,`linkProgram for ${this.id}`)(),t.linkProgram(this.handle),Bt.timeEnd(j5,`linkProgram for ${this.id}`)(),Bt.level,!this.device.features.has("compilation-status-async-webgl")){const i=this._getLinkStatus();this._reportLinkStatus(i);return}Bt.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),Bt.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();const n=this._getLinkStatus();this._reportLinkStatus(n)}async _reportLinkStatus(t){switch(t){case"success":return;default:const n=t==="link-error"?"Link error":"Validation error";switch(this.vs.compilationStatus){case"error":throw this.vs.debugShader(),new Error(`${this} ${n} during compilation of ${this.vs}`);case"pending":await this.vs.asyncCompilationStatus,this.vs.debugShader();break}switch(this.fs?.compilationStatus){case"error":throw this.fs.debugShader(),new Error(`${this} ${n} during compilation of ${this.fs}`);case"pending":await this.fs.asyncCompilationStatus,this.fs.debugShader();break}const i=this.device.gl.getProgramInfoLog(this.handle);this.device.reportError(new Error(`${n} during ${t}: ${i}`),this)(),this.device.debug()}}_getLinkStatus(){const{gl:t}=this.device;return t.getProgramParameter(this.handle,35714)?(t.validateProgram(this.handle),t.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation-error")):(this.linkStatus="error","link-error")}async _waitForLinkComplete(){const t=async s=>await new Promise(a=>setTimeout(a,s));if(!this.device.features.has("compilation-status-async-webgl")){await t(10);return}const{gl:i}=this.device;for(;;){if(i.getProgramParameter(this.handle,37297))return;await t(10)}}_areTexturesRenderable(){let t=!0;for(const n of this.shaderLayout.bindings)!this.bindings[n.name]&&!this.bindings[n.name.replace(/Uniforms$/,"")]&&(Bt.warn(`Binding ${n.name} not found in ${this.id}`)(),t=!1);return t}_applyBindings(){if(this.linkStatus!=="success")return;const{gl:t}=this.device;t.useProgram(this.handle);let n=0,i=0;for(const s of this.shaderLayout.bindings){const a=this.bindings[s.name]||this.bindings[s.name.replace(/Uniforms$/,"")];if(!a)throw new Error(`No value for binding ${s.name} in ${this.id}`);switch(s.type){case"uniform":const{name:o}=s,u=t.getUniformBlockIndex(this.handle,o);if(u===4294967295)throw new Error(`Invalid uniform block name ${o}`);t.uniformBlockBinding(this.handle,i,u),a instanceof n_?t.bindBufferBase(35345,i,a.handle):t.bindBufferRange(35345,i,a.buffer.handle,a.offset||0,a.size||a.buffer.byteLength-a.offset),i+=1;break;case"texture":if(!(a instanceof bm||a instanceof i_||a instanceof r_))throw new Error("texture");let f;if(a instanceof bm)f=a.texture;else if(a instanceof i_)f=a;else if(a instanceof r_&&a.colorAttachments[0]instanceof bm)Bt.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),f=a.colorAttachments[0].texture;else throw new Error("No texture");t.activeTexture(33984+n),t.bindTexture(f.glTarget,f.handle),n+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${s.type}' not supported in WebGL`)}}}_applyUniforms(){for(const t of this.shaderLayout.uniforms||[]){const{name:n,location:i,type:s,textureUnit:a}=t,o=this.uniforms[n]??a;o!==void 0&&OAe(this.device.gl,i,s,o)}}}function FAe(r,e){const t={...r,attributes:r.attributes.map(n=>({...n}))};for(const n of e?.attributes||[]){const i=t.attributes.find(s=>s.name===n.name);i?(i.type=n.type||i.type,i.stepMode=n.stepMode||i.stepMode):Bt.warn(`shader layout attribute ${n.name} not present in shader`)}return t}class UAe extends tB{constructor(t){super(t,{});H(this,"device");H(this,"handle",null);H(this,"commands",[]);this.device=t}_executeCommands(t=this.commands){for(const n of t)switch(n.name){case"copy-buffer-to-buffer":zAe(this.device,n.options);break;case"copy-buffer-to-texture":VAe(this.device,n.options);break;case"copy-texture-to-buffer":$Ae(this.device,n.options);break;case"copy-texture-to-texture":jAe(this.device,n.options);break;default:throw new Error(n.name)}}}function zAe(r,e){const t=e.sourceBuffer,n=e.destinationBuffer;r.gl.bindBuffer(36662,t.handle),r.gl.bindBuffer(36663,n.handle),r.gl.copyBufferSubData(36662,36663,e.sourceOffset??0,e.destinationOffset??0,e.size),r.gl.bindBuffer(36662,null),r.gl.bindBuffer(36663,null)}function VAe(r,e){throw new Error("Not implemented")}function $Ae(r,e){const{sourceTexture:t,mipLevel:n=0,aspect:i="all",width:s=e.sourceTexture.width,height:a=e.sourceTexture.height,depthOrArrayLayers:o=0,origin:u=[0,0],destinationBuffer:f,byteOffset:g=0,bytesPerRow:y,rowsPerImage:A}=e;if(i!=="all")throw new Error("aspect not supported in WebGL");if(n!==0||o!==0||y||A)throw new Error("not implemented");const{framebuffer:C,destroyFramebuffer:M}=eX(t);let k;try{const D=f,V=s||C.width,W=a||C.height,z=YK(C.colorAttachments[0].texture.props.format),$=z.format,te=z.type;r.gl.bindBuffer(35051,D.handle),k=r.gl.bindFramebuffer(36160,C.handle),r.gl.readPixels(u[0],u[1],V,W,$,te,g)}finally{r.gl.bindBuffer(35051,null),k!==void 0&&r.gl.bindFramebuffer(36160,k),M&&C.destroy()}}function jAe(r,e){const{sourceTexture:t,destinationMipLevel:n=0,origin:i=[0,0],destinationOrigin:s=[0,0],destinationTexture:a}=e;let{width:o=e.destinationTexture.width,height:u=e.destinationTexture.height}=e;const{framebuffer:f,destroyFramebuffer:g}=eX(t),[y,A]=i,[C,M,k]=s,D=r.gl.bindFramebuffer(36160,f.handle);let V,W;if(a instanceof i_)V=a,o=Number.isFinite(o)?o:V.width,u=Number.isFinite(u)?u:V.height,V._bind(0),W=V.glTarget;else throw new Error("invalid destination");switch(W){case 3553:case 34067:r.gl.copyTexSubImage2D(W,n,C,M,y,A,o,u);break;case 35866:case 32879:r.gl.copyTexSubImage3D(W,n,C,M,k,y,A,o,u);break}V&&V._unbind(),r.gl.bindFramebuffer(36160,D),g&&f.destroy()}function eX(r){if(r instanceof ca){const{width:e,height:t,id:n}=r;return{framebuffer:r.device.createFramebuffer({id:`framebuffer-for-${n}`,width:e,height:t,colorAttachments:[r]}),destroyFramebuffer:!0}}return{framebuffer:r,destroyFramebuffer:!1}}const GAe=[1,2,4,8];class HAe extends Q3{constructor(t,n){super(t,n);H(this,"device");H(this,"handle",null);H(this,"glParameters",{});this.device=t;let i;if(!n?.parameters?.viewport)if(n?.framebuffer){const{width:a,height:o}=n.framebuffer;i=[0,0,a,o]}else{const[a,o]=t.getDefaultCanvasContext().getDrawingBufferSize();i=[0,0,a,o]}this.device.pushState(),this.setParameters({viewport:i,...this.props.parameters});const s=this.props.framebuffer;if(this.props.framebuffer&&s?.handle){const a=this.props.framebuffer.colorAttachments.map((o,u)=>36064+u);this.device.gl.drawBuffers(a)}else this.device.gl.drawBuffers([1029]);this.clear()}end(){this.device.popState()}pushDebugGroup(t){}popDebugGroup(){}insertDebugMarker(t){}setParameters(t={}){const n={...this.glParameters};n.framebuffer=this.props.framebuffer||null,this.props.depthReadOnly&&(n.depthMask=!this.props.depthReadOnly),n.stencilMask=this.props.stencilReadOnly?0:1,n[35977]=this.props.discard,t.viewport&&(t.viewport.length>=6?(n.viewport=t.viewport.slice(0,4),n.depthRange=[t.viewport[4],t.viewport[5]]):n.viewport=t.viewport),t.scissorRect&&(n.scissorTest=!0,n.scissor=t.scissorRect),t.blendConstant&&(n.blendColor=t.blendConstant),t.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),n[2967]=t.stencilReference),"colorMask"in t&&(n.colorMask=GAe.map(i=>!!(i&t.colorMask))),this.glParameters=n,My(this.device.gl,n)}beginOcclusionQuery(t){this.props.occlusionQuerySet?.beginOcclusionQuery()}endOcclusionQuery(){this.props.occlusionQuerySet?.endOcclusionQuery()}clear(){const t={...this.glParameters};let n=0;this.props.clearColors&&this.props.clearColors.forEach((i,s)=>{i&&this.clearColorBuffer(s,i)}),this.props.clearColor!==!1&&this.props.clearColors===void 0&&(n|=16384,t.clearColor=this.props.clearColor),this.props.clearDepth!==!1&&(n|=256,t.clearDepth=this.props.clearDepth),this.props.clearStencil!==!1&&(n|=1024,t.clearStencil=this.props.clearStencil),n!==0&&W_(this.device.gl,t,()=>{this.device.gl.clear(n)})}clearColorBuffer(t=0,n=[0,0,0,0]){W_(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(n.constructor){case Int8Array:case Int16Array:case Int32Array:this.device.gl.clearBufferiv(6144,t,n);break;case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:this.device.gl.clearBufferuiv(6144,t,n);break;case Float32Array:this.device.gl.clearBufferfv(6144,t,n);break;default:throw new Error("clearColorBuffer: color must be typed array")}})}}class G5 extends eB{constructor(t,n){super(t,n);H(this,"device");H(this,"handle",null);H(this,"commandBuffer");this.device=t,this.commandBuffer=new UAe(t)}destroy(){}finish(){return this.commandBuffer}beginRenderPass(t){return new HAe(this.device,t)}beginComputePass(t){throw new Error("ComputePass not supported in WebGL")}copyBufferToBuffer(t){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:t})}copyBufferToTexture(t){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:t})}copyTextureToBuffer(t){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:t})}copyTextureToTexture(t){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:t})}pushDebugGroup(t){}popDebugGroup(){}insertDebugMarker(t){}resolveQuerySet(t,n,i){}}function WAe(r){const{target:e,source:t,start:n=0,count:i=1}=r,s=t.length,a=i*s;let o=0;for(let u=n;o<s;o++)e[u++]=t[o];for(;o<a;)o<a-o?(e.copyWithin(n+o,n,n+o),o*=2):(e.copyWithin(n+o,n,n+a-o),o=a);return r.target}class MO extends rB{constructor(t,n){super(t,n);H(this,"device");H(this,"handle");H(this,"buffer",null);H(this,"bufferValue",null);this.device=t,this.handle=this.device.gl.createVertexArray()}get[Symbol.toStringTag](){return"VertexArray"}static isConstantAttributeZeroSupported(t){return zue()==="Chrome"}destroy(){super.destroy(),this.buffer&&this.buffer?.destroy(),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(t){const n=t;if(n&&n.glTarget!==34963)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,n?n.handle:null),this.indexBuffer=n,this.device.gl.bindVertexArray(null)}setBuffer(t,n){const i=n;if(i.glTarget===34963)throw new Error("Use .setIndexBuffer()");const{size:s,type:a,stride:o,offset:u,normalized:f,integer:g,divisor:y}=this._getAccessor(t);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,i.handle),g?this.device.gl.vertexAttribIPointer(t,s,a,o,u):this.device.gl.vertexAttribPointer(t,s,a,f,o,u),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(t),this.device.gl.vertexAttribDivisor(t,y||0),this.attributes[t]=i,this.device.gl.bindVertexArray(null)}setConstantWebGL(t,n){this._enable(t,!1),this.attributes[t]=n}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let t=0;t<this.maxVertexAttributes;++t){const n=this.attributes[t];ArrayBuffer.isView(n)&&this.device.setConstantAttributeWebGL(t,n)}}_getAccessor(t){const n=this.attributeInfos[t];if(!n)throw new Error(`Unknown attribute location ${t}`);const i=qK(n.bufferDataType);return{size:n.bufferComponents,type:i,stride:n.byteStride,offset:n.byteOffset,normalized:n.normalized,integer:n.integer,divisor:n.stepMode==="instance"?1:0}}_enable(t,n=!0){const s=MO.isConstantAttributeZeroSupported(this.device)||t!==0;(n||s)&&(t=Number(t),this.device.gl.bindVertexArray(this.handle),n?this.device.gl.enableVertexAttribArray(t):this.device.gl.disableVertexAttribArray(t),this.device.gl.bindVertexArray(null))}getConstantBuffer(t,n){const i=KAe(n),s=i.byteLength*t,a=i.length*t;if(this.buffer&&s!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${s} !== ${this.buffer.byteLength}.`);let o=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:s}),o||(o=!XAe(i,this.bufferValue)),o){const u=nge(n.constructor,a);WAe({target:u,source:i,start:0,count:a}),this.buffer.write(u),this.bufferValue=n}return this.buffer}}function KAe(r){return Array.isArray(r)?new Float32Array(r):r}function XAe(r,e){if(!r||!e||r.length!==e.length||r.constructor!==e.constructor)return!1;for(let t=0;t<r.length;++t)if(r[t]!==e[t])return!1;return!0}class JAe extends nB{constructor(t,n){super(t,n);H(this,"device");H(this,"gl");H(this,"handle");H(this,"layout");H(this,"buffers",{});H(this,"unusedBuffers",{});H(this,"bindOnUse",!0);H(this,"_bound",!1);this.device=t,this.gl=t.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,n.buffers&&this.setBuffers(n.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(t="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(LAe(t))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(t){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(const n in t)this.setBuffer(n,t[n])})}setBuffer(t,n){const i=this._getVaryingIndex(t),{buffer:s,byteLength:a,byteOffset:o}=this._getBufferRange(n);if(i<0){this.unusedBuffers[t]=s,Bt.warn(`${this.id} unusedBuffers varying buffer ${t}`)();return}this.buffers[i]={buffer:s,byteLength:a,byteOffset:o},this.bindOnUse||this._bindBuffer(i,s,o,a)}getBuffer(t){if(H5(t))return this.buffers[t]||null;const n=this._getVaryingIndex(t);return n>=0?this.buffers[n]:null}bind(t=this.handle){if(typeof t!="function")return this.gl.bindTransformFeedback(36386,t),this;let n;return this._bound?n=t():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,n=t(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),n}unbind(){this.bind(null)}_getBufferRange(t){if(t instanceof n_)return{buffer:t,byteOffset:0,byteLength:t.byteLength};const{buffer:n,byteOffset:i=0,byteLength:s=t.buffer.byteLength}=t;return{buffer:n,byteOffset:i,byteLength:s}}_getVaryingIndex(t){if(H5(t))return Number(t);for(const n of this.layout.varyings||[])if(t===n.name)return n.location;return-1}_bindBuffers(){for(const t in this.buffers){const{buffer:n,byteLength:i,byteOffset:s}=this._getBufferRange(this.buffers[t]);this._bindBuffer(Number(t),n,s,i)}}_unbindBuffers(){for(const t in this.buffers)this.gl.bindBufferBase(35982,Number(t),null)}_bindBuffer(t,n,i=0,s){const a=n&&n.handle;!a||s===void 0?this.gl.bindBufferBase(35982,t,a):this.gl.bindBufferRange(35982,t,a,i,s)}}function H5(r){return typeof r=="number"?Number.isInteger(r):/^\d+$/.test(r)}class qAe extends iB{constructor(t,n){super(t,n);H(this,"device");H(this,"handle");H(this,"target",null);H(this,"_queryPending",!1);H(this,"_pollingPromise",null);if(this.device=t,n.count>1)throw new Error("WebGL QuerySet can only have one value");const i=this.device.gl.createQuery();if(!i)throw new Error("WebGL query not supported");this.handle=i,Object.seal(this)}get[Symbol.toStringTag](){return"Query"}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(t){return this._begin(t?.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(t){this._queryPending||(this.target=t,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const t=this.device.gl.getQueryParameter(this.handle,34919);return t&&(this._queryPending=!1),t}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(t=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((i,s)=>{const a=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):n++>t?(s("Timed out"),this._pollingPromise=null):requestAnimationFrame(a)};requestAnimationFrame(a)}),this._pollingPromise}}function tX(r){switch(r){case 6406:case 33326:case 6403:case 36244:return 1;case 33339:case 33340:case 33328:case 33320:case 33319:return 2;case 6407:case 36248:case 34837:return 3;case 6408:case 36249:case 34836:return 4;default:return 0}}function YAe(r){switch(r){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return 0}}function ZAe(r){return QAe[r]}const QAe={5124:"sint32",5125:"uint32",5122:"sint16",5123:"uint16",5120:"sint8",5121:"uint8",5126:"float32",5131:"float16",33635:"uint16",32819:"uint16",32820:"uint16",33640:"uint32",35899:"uint32",35902:"uint32",34042:"uint32",36269:"uint32"};function e1e(r,e){const{sourceX:t=0,sourceY:n=0,sourceAttachment:i=0}=e||{};let{target:s=null,sourceWidth:a,sourceHeight:o,sourceDepth:u,sourceFormat:f,sourceType:g}=e||{};const{framebuffer:y,deleteFramebuffer:A}=rX(r),{gl:C,handle:M}=y;a||(a=y.width),o||(o=y.height);const k=y.colorAttachments[i]?.texture;if(!k)throw new Error(`Invalid framebuffer attachment ${i}`);u=k?.depth||1,f||(f=k?.glFormat||6408),g||(g=k?.glType||5121),s=n1e(s,g,f,a,o);const D=Jk(s);g=g||wAe(D);const V=C.bindFramebuffer(36160,M);return C.readBuffer(36064+i),C.readPixels(t,n,a,o,f,g,s),C.readBuffer(36064),C.bindFramebuffer(36160,V||null),A&&y.destroy(),s}function t1e(r,e){const{target:t,sourceX:n=0,sourceY:i=0,sourceFormat:s=6408,targetByteOffset:a=0}=e||{};let{sourceWidth:o,sourceHeight:u,sourceType:f}=e||{};const{framebuffer:g,deleteFramebuffer:y}=rX(r);o=o||g.width,u=u||g.height;const A=g;f=f||5121;let C=t;if(!C){const k=tX(s),D=YAe(f),V=a+o*u*k*D;C=A.device.createBuffer({byteLength:V})}const M=r.device.createCommandEncoder();return M.copyTextureToBuffer({sourceTexture:r,width:o,height:u,origin:[n,i],destinationBuffer:C,byteOffset:a}),M.destroy(),y&&g.destroy(),C}function rX(r){return r instanceof DC?{framebuffer:r,deleteFramebuffer:!1}:{framebuffer:r1e(r),deleteFramebuffer:!0}}function r1e(r,e){const{device:t,width:n,height:i,id:s}=r;return t.createFramebuffer({...e,id:`framebuffer-for-${s}`,width:n,height:i,colorAttachments:[r]})}function n1e(r,e,t,n,i,s){if(r)return r;e||(e=5121);const a=ZAe(e),o=qk(a),u=tX(t);return new o(n*i*u)}class BB extends hp{constructor(t){super({...t,id:t.id||cAe("webgl-device")});H(this,"type","webgl");H(this,"handle");H(this,"features");H(this,"limits");H(this,"info");H(this,"canvasContext");H(this,"preferredColorFormat","rgba8unorm");H(this,"preferredDepthFormat","depth24plus");H(this,"commandEncoder");H(this,"lost");H(this,"_resolveContextLost");H(this,"gl");H(this,"_constants");H(this,"_extensions",{});H(this,"_polyfilled",!1);H(this,"spectorJS");const n=hp._getCanvasContextProps(t);if(!n)throw new Error("WebGLDevice requires props.createCanvasContext to be set");let i=n.canvas?.gl?.device;if(i)throw new Error(`WebGL context already attached to device ${i.id}`);this.canvasContext=new lAe(this,n),this.lost=new Promise(y=>{this._resolveContextLost=y});const s={...t.webgl};n.alphaMode==="premultiplied"&&(s.premultipliedAlpha=!0),t.powerPreference!==void 0&&(s.powerPreference=t.powerPreference);const o=this.props._handle||$ve(this.canvasContext.canvas,{onContextLost:y=>this._resolveContextLost?.({reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."}),onContextRestored:y=>console.log("WebGL context restored")},s);if(!o)throw new Error("WebGL context creation failed");if(i=o.device,i){if(t._reuseDevices)return Bt.log(1,`Not creating a new Device, instead returning a reference to Device ${i.id} already attached to WebGL context`,i)(),i._reused=!0,i;throw new Error(`WebGL context already attached to device ${i.id}`)}this.handle=o,this.gl=o,this.spectorJS=Cve({...this.props,gl:this.handle}),this.gl.device=this,this.gl._version=2,this.info=jve(this.gl,this._extensions),this.limits=new sAe(this.gl),this.features=new iAe(this.gl,this._extensions,this.props._disabledFeatures),this.props._initializeFeatures&&this.features.initializeFeatures(),new Yf(this.gl,{log:(...y)=>Bt.log(1,...y)()}).trackState(this.gl,{copyState:!1});const f=t.debugWebGL||t.debug,g=t.debugWebGL;f&&(this.gl=Eve(this.gl,{debugWebGL:f,traceWebGL:g}),Bt.warn("WebGL debug mode activated. Performance reduced.")(),t.debugWebGL&&(Bt.level=Math.max(Bt.level,1))),this.commandEncoder=new G5(this,{id:`${this}-command-encoder`})}get[Symbol.toStringTag](){return"WebGLDevice"}toString(){return`${this[Symbol.toStringTag]}(${this.id})`}isVertexFormatSupported(t){switch(t){case"unorm8x4-bgra":return!1;default:return!0}}destroy(){!this.props._reuseDevices&&!this._reused&&delete this.gl.device}get isLost(){return this.gl.isContextLost()}getTextureByteAlignment(){return 4}createCanvasContext(t){throw new Error("WebGL only supports a single canvas")}createBuffer(t){const n=this._normalizeBufferProps(t);return new n_(this,n)}createTexture(t){return new i_(this,t)}createExternalTexture(t){throw new Error("createExternalTexture() not implemented")}createSampler(t){return new vAe(this,t)}createShader(t){return new fAe(this,t)}createFramebuffer(t){return new r_(this,t)}createVertexArray(t){return new MO(this,t)}createTransformFeedback(t){return new JAe(this,t)}createQuerySet(t){return new qAe(this,t)}createRenderPipeline(t){return new NAe(this,t)}createComputePipeline(t){throw new Error("ComputePipeline not supported in WebGL")}createCommandEncoder(t={}){return new G5(this,t)}submit(t){t||(t=this.commandEncoder.finish(),this.commandEncoder.destroy(),this.commandEncoder=this.createCommandEncoder({id:`${this.id}-default-encoder`})),t._executeCommands()}readPixelsToArrayWebGL(t,n){return e1e(t,n)}readPixelsToBufferWebGL(t,n){return t1e(t,n)}setParametersWebGL(t){My(this.gl,t)}getParametersWebGL(t){return XK(this.gl,t)}withParametersWebGL(t,n){return W_(this.gl,t,n)}resetWebGL(){Bt.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),Nve(this.gl)}_getDeviceSpecificTextureFormatCapabilities(t){return eAe(this.gl,t,this._extensions)}loseDevice(){let t=!1;const i=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return i&&(t=!0,i.loseContext()),this._resolveContextLost?.({reason:"destroyed",message:"Application triggered context loss"}),t}pushState(){Yf.get(this.gl).push()}popState(){Yf.get(this.gl).pop()}getGLKey(t,n){const i=Number(t);for(const s in this.gl)if(this.gl[s]===i)return`GL.${s}`;return n?.emptyIfUnknown?"":String(t)}getGLKeys(t){const n={emptyIfUnknown:!0};return Object.entries(t).reduce((i,[s,a])=>(i[`${s}:${this.getGLKey(s,n)}`]=`${a}:${this.getGLKey(a,n)}`,i),{})}setConstantAttributeWebGL(t,n){const i=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(i).fill(null);const s=this._constants[t];switch(s&&a1e(s,n)&&Bt.info(1,`setConstantAttributeWebGL(${t}) could have been skipped, value unchanged`)(),this._constants[t]=n,n.constructor){case Float32Array:i1e(this,t,n);break;case Int32Array:s1e(this,t,n);break;case Uint32Array:o1e(this,t,n);break;default:throw new Error("constant")}}getExtension(t){return oy(this.gl,t,this._extensions),this._extensions}_setWebGLDebugMetadata(t,n,i){t.luma=n;const s={props:i.spector,id:i.spector.id};t.__SPECTOR_Metadata=s}}function i1e(r,e,t){switch(t.length){case 1:r.gl.vertexAttrib1fv(e,t);break;case 2:r.gl.vertexAttrib2fv(e,t);break;case 3:r.gl.vertexAttrib3fv(e,t);break;case 4:r.gl.vertexAttrib4fv(e,t);break}}function s1e(r,e,t){r.gl.vertexAttribI4iv(e,t)}function o1e(r,e,t){r.gl.vertexAttribI4uiv(e,t)}function a1e(r,e){if(!r||!e||r.length!==e.length||r.constructor!==e.constructor)return!1;for(let t=0;t<r.length;++t)if(r[t]!==e[t])return!1;return!0}const W5=Object.freeze(Object.defineProperty({__proto__:null,WebGLDevice:BB},Symbol.toStringTag,{value:"Module"}));function $h(){}const l1e=({isDragging:r})=>r?"grabbing":"grab",nX={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{},gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:$h,onWebGLInitialized:$h,onResize:$h,onViewStateChange:$h,onInteractionStateChange:$h,onBeforeRender:$h,onAfterRender:$h,onLoad:$h,onError:r=>Rr.error(r.message,r.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:l1e,getTooltip:null,debug:!1,drawPickingColors:!1};class Us{constructor(e){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new Iy({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=n=>{const{_pickRequest:i}=this;if(n.type==="pointerleave")i.x=-1,i.y=-1,i.radius=0;else{if(n.leftButton||n.rightButton)return;{const s=n.offsetCenter;if(!s)return;i.x=s.x,i.y=s.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=n},this._onEvent=n=>{const i=mB[n.type],s=n.offsetCenter;if(!i||!s||!this.layerManager)return;const a=this.layerManager.getLayers(),o=this.deckPicker.getLastPickedObject({x:s.x,y:s.y,layers:a,viewports:this.getViewports(s)},this._lastPointerDownInfo),{layer:u}=o,f=u&&(u[i]||u.props[i]),g=this.props[i];let y=!1;f&&(y=f.call(u,o,n)),y||(g?.(o,n),this.widgetManager.onEvent(o,n))},this._onPointerDown=n=>{if(this.device?.type==="webgpu")return;const i=n.offsetCenter,s=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=s.result[0]||s.emptyInfo},this.props={...nX,...e},e=this.props,e.viewState&&e.initialViewState&&Rr.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,e.device&&(this.device=e.device);let t=this.device;if(!t&&e.gl){e.gl instanceof WebGLRenderingContext&&Rr.error("WebGL1 context not supported.")();const n=this.props.deviceProps?.onResize;t=jI.attach(e.gl,{...this.props.deviceProps,onResize:(i,s)=>{const{width:a,height:o}=i.canvas;i.drawingBufferWidth=a,i.drawingBufferHeight=o,this._needsRedraw="Canvas resized",n?.(i,s)}})}t||(t=this._createDevice(e)),this.animationLoop=this._createAnimationLoop(t,e),this.setProps(e),e._typedArrayManagerProps&&iy.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop?.stop(),this.animationLoop?.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager?.finalize(),this.layerManager=null,this.viewManager?.finalize(),this.viewManager=null,this.effectManager?.finalize(),this.effectManager=null,this.deckRenderer?.finalize(),this.deckRenderer=null,this.deckPicker?.finalize(),this.deckPicker=null,this.eventManager?.destroy(),this.eventManager=null,this.widgetManager?.finalize(),this.widgetManager=null,!this.props.canvas&&!this.props.device&&!this.props.gl&&this.canvas&&(this.canvas.parentElement?.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Rr.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Rr.removed("onLayerClick","onClick")(),e.initialViewState&&!Ms(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),e.device&&e.device.id!==this.device?.id&&(this.animationLoop?.stop(),this.canvas!==e.device.canvasContext?.canvas&&(this.canvas?.remove(),this.eventManager?.destroy(),this.canvas=null),Rr.log(`recreating animation loop for new device! id=${e.device.id}`)(),this.animationLoop=this._createAnimationLoop(e.device,e),this.animationLoop.start()),this.animationLoop?.setProps(t),e.useDevicePixels!==void 0&&this.device?.canvasContext&&this.device.canvasContext.setProps({useDevicePixels:e.useDevicePixels}),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t),this.widgetManager.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),a=this.deckRenderer.needsRedraw(e);return t=t||n||i||s||a,t}redraw(e){if(!this.layerManager)return;let t=this.needsRedraw({clearRedrawFlags:!0});t=e||t,t&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}get isInitialized(){return this.viewManager!==null}getViews(){return vs(this.viewManager),this.viewManager.views}getViewports(e){return vs(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,t=!1){for(const n in e)this.layerManager.resourceManager.add({resourceId:n,data:e[n],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_addDefaultShaderModule(e){this.layerManager.addDefaultShaderModule(e)}_removeDefaultShaderModule(e){this.layerManager?.removeDefaultShaderModule(e)}_pick(e,t,n){vs(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(t).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return i.get(t).timeEnd(),s}_createCanvas(e){let t=e.canvas;return typeof t=="string"&&(t=document.getElementById(t),vs(t)),t||(t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay",e.width&&typeof e.width=="number"&&(t.width=e.width),e.height&&typeof e.height=="number"&&(t.height=e.height),(e.parent||document.body).appendChild(t)),Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;const{width:t,height:n}=e;if(t||t===0){const i=Number.isFinite(t)?`${t}px`:t;this.canvas.style.width=i}if(n||n===0){const i=Number.isFinite(n)?`${n}px`:n;this.canvas.style.position=e.style?.position||"absolute",this.canvas.style.height=i}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const t=e.clientWidth??e.width,n=e.clientHeight??e.height;(t!==this.width||n!==this.height)&&(this.width=t,this.height=n,this.viewManager?.setProps({width:t,height:n}),this.layerManager?.activateViewport(this.getViewports()[0]),this.props.onResize({width:t,height:n}))}_createAnimationLoop(e,t){const{gl:n,onError:i}=t;return new vB({device:e,autoResizeDrawingBuffer:!n,autoResizeViewport:!1,onInitialize:s=>this._setDevice(s.device),onRender:this._onRenderFrame.bind(this),onError:i})}_createDevice(e){const t=this.props.deviceProps?.createCanvasContext,n=typeof t=="object"?t:void 0,i={adapters:[],_cacheShaders:!0,_cachePipelines:!0,...e.deviceProps};i.adapters.includes(jI)||i.adapters.push(jI);const s={alphaMode:this.props.deviceProps?.type==="webgpu"?"premultiplied":void 0},a=this.props.deviceProps?.onResize;return Z3.createDevice({_reuseDevices:!0,type:"webgl",...i,createCanvasContext:{...s,...n,canvas:this._createCanvas(e),useDevicePixels:this.props.useDevicePixels,autoResize:!0},onResize:(o,u)=>{this._needsRedraw="Canvas resized",a?.(o,u)}})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){const{views:e}=this.props,t=Array.isArray(e)?e:e?[e]:[new CO({id:"default-view"})];return t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){if(this.device?.type==="webgpu")return;const{_pickRequest:e}=this;if(e.event){const{result:t,emptyInfo:n}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=t.length>0;let i=n,s=!1;for(const a of t)i=a,s=a.layer?.onHover(a,e.event)||s;s||(this.props.onHover?.(i,e.event),this.widgetManager.onHover(i,e.event)),e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(e){if(this.device=e,!this.animationLoop)return;this.canvas||(this.canvas=this.device.canvasContext?.canvas,!this.canvas.isConnected&&this.props.parent&&this.props.parent.insertBefore(this.canvas,this.props.parent.firstChild)),this.device.type==="webgl"&&this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device.type==="webgl"&&this.props.onWebGLInitialized(this.device.gl);const t=new NK;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new Dbe(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizers:Object.keys(a5).map(i=>{const[s,a,o,u]=a5[i],f=this.props.eventRecognizerOptions?.[i],g={...a,...f,event:i};return{recognizer:new s(g),recognizeWith:o,requestFailure:u}}),events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in mB)this.eventManager.on(i,this._onEvent);this.viewManager=new G_e({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new j_e(this.device,{deck:this,stats:this.stats,viewport:n,timeline:t}),this.effectManager=new ive({deck:this,device:this.device}),this.deckRenderer=new ave(this.device),this.deckPicker=new uve(this.device),this.widgetManager=new fve({deck:this,parentElement:this.canvas?.parentElement}),this.widgetManager.addDefault(new HK),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){const{device:n,gl:i}=this.layerManager.context;this.props.onBeforeRender({device:n,gl:i});const s={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...t};this.deckRenderer?.renderLayers(s),s.pass==="screen"&&this.widgetManager.onRedraw({viewports:s.viewports,layers:s.layers}),this.props.onAfterRender({device:n,gl:i})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Rr.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this.device?.type!=="webgpu"&&this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:t},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const n=Z3.stats.get("Memory Usage");e.bufferMemory=n.get("Buffer Memory").count,e.textureMemory=n.get("Texture Memory").count,e.renderbufferMemory=n.get("Renderbuffer Memory").count,e.gpuMemory=n.get("GPU Memory").count}}Us.defaultProps=nX;Us.VERSION=kfe;function c1e(r){switch(r){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return qk(r)}}const u1e=Jk;function ox(r,e,t){const n=t==="webgpu"&&e.type==="uint8"?"unorm8":e.type;return{attribute:r,format:e.size>1?`${n}x${e.size}`:e.type,byteOffset:e.offset||0}}function Uf(r){return r.stride||r.size*r.bytesPerElement}function h1e(r,e){return r.type===e.type&&r.size===e.size&&Uf(r)===Uf(e)&&(r.offset||0)===(e.offset||0)}function MB(r,e){e.offset&&Rr.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const t=Uf(r),n=e.vertexOffset!==void 0?e.vertexOffset:r.vertexOffset||0,i=e.elementOffset||0,s=n*t+i*r.bytesPerElement+(r.offset||0);return{...e,offset:s,stride:t}}function d1e(r,e){const t=MB(r,e);return{high:t,low:{...t,offset:t.offset+r.size*4}}}class f1e{constructor(e,t,n){this._buffer=null,this.device=e,this.id=t.id||"",this.size=t.size||1;const i=t.logicalType||t.type,s=i==="float64";let{defaultValue:a}=t;a=Number.isFinite(a)?[a]:a||new Array(this.size).fill(0);let o;s?o="float32":!i&&t.isIndexed?o="uint32":o=i||"float32";let u=c1e(i||o);this.doublePrecision=s,s&&t.fp64===!1&&(u=Float32Array),this.value=null,this.settings={...t,defaultType:u,defaultValue:a,logicalType:i,type:o,normalized:o.includes("norm"),size:this.size,bytesPerElement:u.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Uf(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),iy.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(e=this.id,t=null){const n={};if(this.state.constant){const i=this.value;if(t){const s=MB(this.getAccessor(),t),a=s.offset/i.BYTES_PER_ELEMENT,o=s.size||this.size;n[e]=i.subarray(a,a+o)}else n[e]=i}else n[e]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?n[`${e}64Low`]=n[e]:n[`${e}64Low`]=new Float32Array(this.size)),n}_getBufferLayout(e=this.id,t=null){const n=this.getAccessor(),i=[],s={name:this.id,byteStride:Uf(n),attributes:i};if(this.doublePrecision){const a=d1e(n,t||{});i.push(ox(e,{...n,...a.high},this.device.type),ox(`${e}64Low`,{...n,...a.low},this.device.type))}else if(t){const a=MB(n,t);i.push(ox(e,{...n,...a},this.device.type))}else i.push(ox(e,n,this.device.type));return s}setAccessor(e){this.state.bufferAccessor=e}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const t=Array.from(this.value);e=[t,t]}else{const{value:t,numInstances:n,size:i}=this,s=n*i;if(t&&s&&t.length>=s){const a=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let u=0;u<s;)for(let f=0;f<i;f++){const g=t[u++];g<a[f]&&(a[f]=g),g>o[f]&&(o[f]=g)}e=[a,o]}}return this.state.bounds=e,e}setData(e){const{state:t}=this;let n;ArrayBuffer.isView(e)?n={value:e}:e instanceof Li?n={buffer:e}:n=e;const i={...this.settings,...n};if(ArrayBuffer.isView(n.value)){if(!n.type)if(this.doublePrecision&&n.value instanceof Float64Array)i.type="float32";else{const a=u1e(n.value);i.type=i.normalized?a.replace("int","norm"):a}i.bytesPerElement=n.value.BYTES_PER_ELEMENT,i.stride=Uf(i)}if(t.bounds=null,n.constant){let s=n.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!t.constant||!this._areValuesEqual(s,this.value)))return!1;t.externalBuffer=null,t.constant=!0,this.value=ArrayBuffer.isView(s)?s:new Float32Array(s)}else if(n.buffer){const s=n.buffer;t.externalBuffer=s,t.constant=!1,this.value=n.value||null}else if(n.value){this._checkExternalBuffer(n);let s=n.value;t.externalBuffer=null,t.constant=!1,this.value=s;let{buffer:a}=this;const o=Uf(i),u=(i.vertexOffset||0)*o;if(this.doublePrecision&&s instanceof Float64Array&&(s=NI(s,i)),this.settings.isIndexed){const g=this.settings.defaultType;s.constructor!==g&&(s=new g(s))}const f=s.byteLength+u+o*2;(!a||a.byteLength<f)&&(a=this._createBuffer(f)),a.write(s,u)}return this.setAccessor(i),!0}updateSubBuffer(e={}){this.state.bounds=null;const t=this.value,{startOffset:n=0,endOffset:i}=e;this.buffer.write(this.doublePrecision&&t instanceof Float64Array?NI(t,{size:this.size,startIndex:n,endIndex:i}):t.subarray(n,i),n*t.BYTES_PER_ELEMENT+this.byteOffset)}allocate(e,t=!1){const{state:n}=this,i=n.allocatedValue,s=iy.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:t});this.value=s;const{byteOffset:a}=this;let{buffer:o}=this;return(!o||o.byteLength<s.byteLength+a)&&(o=this._createBuffer(s.byteLength+a),t&&i&&o.write(i instanceof Float64Array?NI(i,this):i,a)),n.allocatedValue=s,n.constant=!1,n.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(e){const{value:t}=e;if(!ArrayBuffer.isView(t))throw new Error(`Attribute ${this.id} value is not TypedArray`);const n=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=t.BYTES_PER_ELEMENT<4),i)throw new Error(`Attribute ${this.id} does not support ${t.constructor.name}`);!(t instanceof n)&&this.settings.normalized&&!("normalized"in e)&&Rr.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(e){switch(this.settings.type){case"snorm8":return new Float32Array(e).map(t=>(t+128)/255*2-1);case"snorm16":return new Float32Array(e).map(t=>(t+32768)/65535*2-1);case"unorm8":return new Float32Array(e).map(t=>t/255);case"unorm16":return new Float32Array(e).map(t=>t/65535);default:return e}}_normalizeValue(e,t,n){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return t[n]=e,t;if(!e){let a=s;for(;--a>=0;)t[n+a]=i[a];return t}switch(s){case 4:t[n+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:t[n+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:t[n+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:t[n+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let a=s;for(;--a>=0;)t[n+a]=Number.isFinite(e[a])?e[a]:i[a]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:n}=this;for(let i=0;i<n;i++)if(e[i]!==t[i])return!1;return!0}_createBuffer(e){this._buffer&&this._buffer.destroy();const{isIndexed:t,type:n}=this.settings;return this._buffer=this.device.createBuffer({...this._buffer?.props,id:this.id,usage:(t?Li.INDEX:Li.VERTEX)|Li.COPY_DST,indexType:t?n:void 0,byteLength:e}),this._buffer}}const K5=[],X5=[];function Sd(r,e=0,t=1/0){let n=K5;const i={index:-1,data:r,target:[]};return r?typeof r[Symbol.iterator]=="function"?n=r:r.length>0&&(X5.length=r.length,n=X5):n=K5,(e>0||Number.isFinite(t))&&(n=(Array.isArray(n)?n:Array.from(n)).slice(e,t),i.index=e-1),{iterable:n,objectInfo:i}}function iX(r){return r&&r[Symbol.asyncIterator]}function sX(r,e){const{size:t,stride:n,offset:i,startIndices:s,nested:a}=e,o=r.BYTES_PER_ELEMENT,u=n?n/o:t,f=i?i/o:0,g=Math.floor((r.length-f)/u);return(y,{index:A,target:C})=>{if(!s){const V=A*u+f;for(let W=0;W<t;W++)C[W]=r[V+W];return C}const M=s[A],k=s[A+1]||g;let D;if(a){D=new Array(k-M);for(let V=M;V<k;V++){const W=V*u+f;C=new Array(t);for(let z=0;z<t;z++)C[z]=r[W+z];D[V-M]=C}}else if(u===t)D=r.subarray(M*t+f,k*t+f);else{D=new r.constructor((k-M)*t);let V=0;for(let W=M;W<k;W++){const z=W*u+f;for(let $=0;$<t;$++)D[V++]=r[z+$]}}return D}}const p1e=[],Pw=[[0,1/0]];function g1e(r,e){if(r===Pw||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return r;const t=[],n=r.length;let i=0;for(let s=0;s<n;s++){const a=r[s];a[1]<e[0]?(t.push(a),i=s+1):a[0]>e[1]?t.push(a):e=[Math.min(a[0],e[0]),Math.max(a[1],e[1])]}return t.splice(i,0,e),t}const m1e={interpolation:{duration:0,easing:r=>r},spring:{stiffness:.05,damping:.5}};function oX(r,e){if(!r)return null;Number.isFinite(r)&&(r={type:"interpolation",duration:r});const t=r.type||"interpolation";return{...m1e[t],...e,...r,type:t}}class aX extends f1e{constructor(e,t){super(e,t,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:Pw}),this.constant=!1,this.settings.update=t.update||(t.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}layoutChanged(){return this.state.layoutChanged}setAccessor(e){var t;(t=this.state).layoutChanged||(t.layoutChanged=!h1e(e,this.getAccessor())),super.setAccessor(e)}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,n=this.settings.transition,i=Array.isArray(t)?e[t.find(s=>e[s])]:e[t];return oX(i,n)}setNeedsUpdate(e=this.id,t){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:n=0,endRow:i=1/0}=t;this.state.updateRanges=g1e(this.state.updateRanges,[n,i])}else this.state.updateRanges=Pw}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=p1e}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:t,settings:n}=this;return n.noAlloc?!1:n.update?(super.allocate(e,t.updateRanges!==Pw),!0):!1}updateBuffer({numInstances:e,data:t,props:n,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:a,noAlloc:o}}=this;let u=!0;if(a){for(const[f,g]of s)a.call(i,this,{data:t,startRow:f,endRow:g,props:n,numInstances:e});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[f,g]of s){const y=Number.isFinite(f)?this.getVertexOffset(f):0,A=Number.isFinite(g)?this.getVertexOffset(g):o||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:y,endOffset:A})}this._checkAttributeArray()}else u=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),u}setConstantValue(e,t){const n=this.device.type==="webgpu";if(n||t===void 0||typeof t=="function"){if(n&&typeof t!="function"){const a=this._normalizeValue(t,[],0);this._areValuesEqual(a,this.value)||this.setNeedsUpdate("WebGPU constant updated")}return!1}const i=this.settings.transform&&e?this.settings.transform.call(e,t):t;return this.setData({constant:!0,value:i})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e,t=null){const{state:n,settings:i}=this;if(!e)return n.binaryValue=null,n.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(n.binaryValue===e)return this.clearNeedsUpdate(),!0;if(n.binaryValue=e,this.setNeedsRedraw(),i.transform||t!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const a=e;vs(ArrayBuffer.isView(a.value),`invalid ${i.accessor}`);const o=!!a.size&&a.size!==this.size;return n.binaryAccessor=sX(a.value,{size:a.size||this.size,stride:a.stride,offset:a.offset,startIndices:t,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:t}=this;return(t?e<t.length?t[e]:this.numInstances:e)*this.size}getValue(){const e=this.settings.shaderAttributes,t=super.getValue();if(!e)return t;for(const n in e)Object.assign(t,super.getValue(n,e[n]));return t}getBufferLayout(e){this.state.layoutChanged=!1;const t=this.settings.shaderAttributes,n=super._getBufferLayout(),{stepMode:i}=this.settings;if(i==="dynamic"?n.stepMode=e?e.isInstanced?"instance":"vertex":"instance":n.stepMode=i??"vertex",!t)return n;for(const s in t){const a=super._getBufferLayout(s,t[s]);n.attributes.push(...a.attributes)}return n}_autoUpdater(e,{data:t,startRow:n,endRow:i,props:s,numInstances:a}){if(e.constant&&this.context.device.type!=="webgpu")return;const{settings:o,state:u,value:f,size:g,startIndices:y}=e,{accessor:A,transform:C}=o;let M=u.binaryAccessor||(typeof A=="function"?A:s[A]);typeof M!="function"&&typeof A=="string"&&(M=()=>s[A]),vs(typeof M=="function",`accessor "${A}" is not a function`);let k=e.getVertexOffset(n);const{iterable:D,objectInfo:V}=Sd(t,n,i);for(const W of D){V.index++;let z=M(W,V);if(C&&(z=C.call(this,z)),y){const $=(V.index<y.length-1?y[V.index+1]:a)-y[V.index];if(z&&Array.isArray(z[0])){let te=k;for(const le of z)e._normalizeValue(le,f,te),te+=g}else z&&z.length>g?f.set(z,k):(e._normalizeValue(z,V.target,0),F_e({target:f,source:V.target,start:k,count:$}));k+=$*g}else e._normalizeValue(z,f,k),k+=g}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let n=!0;switch(t){case 4:n=n&&Number.isFinite(e[3]);case 3:n=n&&Number.isFinite(e[2]);case 2:n=n&&Number.isFinite(e[1]);case 1:n=n&&Number.isFinite(e[0]);break;default:n=!1}if(!n)throw new Error(`Illegal attribute generated for ${this.id}`)}}}function XI(r){const{source:e,target:t,start:n=0,size:i,getData:s}=r,a=r.end||t.length,o=e.length,u=a-n;if(o>u){t.set(e.subarray(0,u),n);return}if(t.set(e,n),!s)return;let f=o;for(;f<u;){const g=s(f,e);for(let y=0;y<i;y++)t[n+f]=g[y]||0,f++}}function y1e({source:r,target:e,size:t,getData:n,sourceStartIndices:i,targetStartIndices:s}){if(!i||!s)return XI({source:r,target:e,size:t,getData:n}),e;let a=0,o=0;const u=n&&((g,y)=>n(g+o,y)),f=Math.min(i.length,s.length);for(let g=1;g<f;g++){const y=i[g]*t,A=s[g]*t;XI({source:r.subarray(a,y),target:e,start:o,end:A,size:t,getData:u}),a=y,o=A}return o<e.length&&XI({source:[],target:e,start:o,size:t,getData:u}),e}function b1e(r){const{device:e,settings:t,value:n}=r,i=new aX(e,t);return i.setData({value:n instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:t.normalized}),i}function lX(r){switch(r){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${r}"`)}}function cX(r){switch(r){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function uX(r){r.push(r.shift())}function _1e(r,e){const{doublePrecision:t,settings:n,value:i,size:s}=r,a=t&&i instanceof Float64Array?2:1;let o=0;const{shaderAttributes:u}=r.settings;if(u)for(const f of Object.values(u))o=Math.max(o,f.vertexOffset??0);return(n.noAlloc?i.length:(e+o)*s)*a}function hX({device:r,source:e,target:t}){return(!t||t.byteLength<e.byteLength)&&(t?.destroy(),t=r.createBuffer({byteLength:e.byteLength,usage:e.usage})),t}function dX({device:r,buffer:e,attribute:t,fromLength:n,toLength:i,fromStartIndices:s,getData:a=o=>o}){const o=t.doublePrecision&&t.value instanceof Float64Array?2:1,u=t.size*o,f=t.byteOffset,g=t.settings.bytesPerElement<4?f/t.settings.bytesPerElement*4:f,y=t.startIndices,A=s&&y,C=t.isConstant;if(!A&&e&&n>=i)return e;const M=t.value instanceof Float64Array?Float32Array:t.value.constructor,k=C?t.value:new M(t.getBuffer().readSyncWebGL(f,i*M.BYTES_PER_ELEMENT).buffer);if(t.settings.normalized&&!C){const z=a;a=($,te)=>t.normalizeConstant(z($,te))}const D=C?(z,$)=>a(k,$):(z,$)=>a(k.subarray(z+f,z+f+u),$),V=e?new Float32Array(e.readSyncWebGL(g,n*4).buffer):new Float32Array(0),W=new Float32Array(i);return y1e({source:V,target:W,sourceStartIndices:s,targetStartIndices:y,size:u,getData:D}),(!e||e.byteLength<W.byteLength+g)&&(e?.destroy(),e=r.createBuffer({byteLength:W.byteLength+g,usage:35050})),e.write(W,g),e}class fX{constructor({device:e,attribute:t,timeline:n}){this.buffers=[],this.currentLength=0,this.device=e,this.transition=new FS(n),this.attribute=t,this.attributeInTransition=b1e(t),this.currentStartIndices=t.startIndices}get inProgress(){return this.transition.inProgress}start(e,t,n=1/0){this.settings=e,this.currentStartIndices=this.attribute.startIndices,this.currentLength=_1e(this.attribute,t),this.transition.start({...e,duration:n})}update(){const e=this.transition.update();return e&&this.onUpdate(),e}setBuffer(e){this.attributeInTransition.setData({buffer:e,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(const e of this.buffers)e.destroy();this.buffers.length=0}}class v1e extends fX{constructor({device:e,attribute:t,timeline:n}){super({device:e,attribute:t,timeline:n}),this.type="interpolation",this.transform=C1e(e,t)}start(e,t){const n=this.currentLength,i=this.currentStartIndices;if(super.start(e,t,e.duration),e.duration<=0){this.transition.cancel();return}const{buffers:s,attribute:a}=this;uX(s),s[0]=dX({device:this.device,buffer:s[0],attribute:a,fromLength:n,toLength:this.currentLength,fromStartIndices:i,getData:e.enter}),s[1]=hX({device:this.device,source:s[0],target:s[1]}),this.setBuffer(s[1]);const{transform:o}=this,u=o.model;let f=Math.floor(this.currentLength/a.size);pX(a)&&(f/=2),u.setVertexCount(f),a.isConstant?(u.setAttributes({aFrom:s[0]}),u.setConstantAttributes({aTo:a.value})):u.setAttributes({aFrom:s[0],aTo:a.getBuffer()}),o.transformFeedback.setBuffers({vCurrent:s[1]})}onUpdate(){const{duration:e,easing:t}=this.settings,{time:n}=this.transition;let i=n/e;t&&(i=t(i));const{model:s}=this.transform,a={time:i};s.shaderInputs.setProps({interpolation:a}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}}const A1e=`uniform interpolationUniforms {
  float time;
} interpolation;
`,J5={name:"interpolation",vs:A1e,uniformTypes:{time:"f32"}},x1e=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, interpolation.time);
  gl_Position = vec4(0.0);
}
`,w1e=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aFrom64Low;
in ATTRIBUTE_TYPE aTo;
in ATTRIBUTE_TYPE aTo64Low;
out ATTRIBUTE_TYPE vCurrent;
out ATTRIBUTE_TYPE vCurrent64Low;

vec2 mix_fp64(vec2 a, vec2 b, float x) {
  vec2 range = sub_fp64(b, a);
  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));
}

void main(void) {
  for (int i=0; i<ATTRIBUTE_SIZE; i++) {
    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), interpolation.time);
    vCurrent[i] = value.x;
    vCurrent64Low[i] = value.y;
  }
  gl_Position = vec4(0.0);
}
`;function pX(r){return r.doublePrecision&&r.value instanceof Float64Array}function C1e(r,e){const t=e.size,n=lX(t),i=cX(t),s=e.getBufferLayout();return pX(e)?new sy(r,{vs:w1e,bufferLayout:[{name:"aFrom",byteStride:8*t,attributes:[{attribute:"aFrom",format:i,byteOffset:0},{attribute:"aFrom64Low",format:i,byteOffset:4*t}]},{name:"aTo",byteStride:8*t,attributes:[{attribute:"aTo",format:i,byteOffset:0},{attribute:"aTo64Low",format:i,byteOffset:4*t}]}],modules:[xye,J5],defines:{ATTRIBUTE_TYPE:n,ATTRIBUTE_SIZE:t},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0}):new sy(r,{vs:x1e,bufferLayout:[{name:"aFrom",format:i},{name:"aTo",format:s.attributes[0].format}],modules:[J5],defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"],disableWarnings:!0})}class T1e extends fX{constructor({device:e,attribute:t,timeline:n}){super({device:e,attribute:t,timeline:n}),this.type="spring",this.texture=M1e(e),this.framebuffer=R1e(e,this.texture),this.transform=B1e(e,t)}start(e,t){const n=this.currentLength,i=this.currentStartIndices;super.start(e,t);const{buffers:s,attribute:a}=this;for(let u=0;u<2;u++)s[u]=dX({device:this.device,buffer:s[u],attribute:a,fromLength:n,toLength:this.currentLength,fromStartIndices:i,getData:e.enter});s[2]=hX({device:this.device,source:s[0],target:s[2]}),this.setBuffer(s[1]);const{model:o}=this.transform;o.setVertexCount(Math.floor(this.currentLength/a.size)),a.isConstant?o.setConstantAttributes({aTo:a.value}):o.setAttributes({aTo:a.getBuffer()})}onUpdate(){const{buffers:e,transform:t,framebuffer:n,transition:i}=this,s=this.settings;t.model.setAttributes({aPrev:e[0],aCur:e[1]}),t.transformFeedback.setBuffers({vNext:e[2]});const a={stiffness:s.stiffness,damping:s.damping};t.model.shaderInputs.setProps({spring:a}),t.run({framebuffer:n,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),uX(e),this.setBuffer(e[1]),this.device.readPixelsToArrayWebGL(n)[0]>0||i.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}}const S1e=`uniform springUniforms {
  float damping;
  float stiffness;
} spring;
`,E1e={name:"spring",vs:S1e,uniformTypes:{damping:"f32",stiffness:"f32"}},I1e=`#version 300 es
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

in ATTRIBUTE_TYPE aPrev;
in ATTRIBUTE_TYPE aCur;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vNext;
out float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE force = delta * spring.stiffness;
  ATTRIBUTE_TYPE resistance = velocity * spring.damping;
  return force - resistance + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,P1e=`#version 300 es
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

in float vIsTransitioningFlag;

out vec4 fragColor;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  fragColor = vec4(1.0);
}`;function B1e(r,e){const t=lX(e.size),n=cX(e.size);return new sy(r,{vs:I1e,fs:P1e,bufferLayout:[{name:"aPrev",format:n},{name:"aCur",format:n},{name:"aTo",format:e.getBufferLayout().attributes[0].format}],varyings:["vNext"],modules:[E1e],defines:{ATTRIBUTE_TYPE:t},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}function M1e(r){return r.createTexture({data:new Uint8Array(4),format:"rgba8unorm",width:1,height:1})}function R1e(r,e){return r.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[e]})}const k1e={interpolation:v1e,spring:T1e};class O1e{constructor(e,{id:t,timeline:n}){if(!e)throw new Error("AttributeTransitionManager is constructed without device");this.id=t,this.device=e,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:t,numInstances:n}){this.numInstances=n||1;for(const i in e){const s=e[i],a=s.getTransitionSetting(t);a&&this._updateAttribute(i,s,a)}for(const i in this.transitions){const s=e[i];(!s||!s.getTransitionSetting(t))&&this._removeTransition(i)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const n=this.transitions[t];n.inProgress&&(e[t]=n.attributeInTransition)}return e}run(){if(this.numInstances===0)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].delete(),delete this.transitions[e]}_updateAttribute(e,t,n){const i=this.transitions[e];let s=!i||i.type!==n.type;if(s){i&&this._removeTransition(e);const a=k1e[n.type];a?this.transitions[e]=new a({attribute:t,timeline:this.timeline,device:this.device}):(Rr.error(`unsupported transition type '${n.type}'`)(),s=!1)}(s||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(n,this.numInstances))}}const q5="attributeManager.invalidate",D1e="attributeManager.updateStart",L1e="attributeManager.updateEnd",N1e="attribute.updateStart",F1e="attribute.allocate",U1e="attribute.updateEnd";class US{constructor(e,{id:t="attribute-manager",stats:n,timeline:i}={}){this.mergeBoundsMemoized=qv(K0e),this.id=t,this.device=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new O1e(e,{id:`${t}-transitions`,timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{stepMode:"instance"})}remove(e){for(const t of e)this.attributes[t]!==void 0&&(this.attributes[t].delete(),delete this.attributes[t])}invalidate(e,t){const n=this._invalidateTrigger(e,t);bo(q5,this,e,n)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);bo(q5,this,"all")}update({data:e,numInstances:t,startIndices:n=null,transitions:i,props:s={},buffers:a={},context:o={}}){let u=!1;bo(D1e,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const f in this.attributes){const g=this.attributes[f],y=g.settings.accessor;g.startIndices=n,g.numInstances=t,s[f]&&Rr.removed(`props.${f}`,`data.attributes.${f}`)(),g.setExternalBuffer(a[f])||g.setBinaryValue(typeof y=="string"?a[y]:void 0,e.startIndices)||typeof y=="string"&&!a[y]&&g.setConstantValue(o,s[y])||g.needsUpdate()&&(u=!0,this._updateAttribute({attribute:g,numInstances:t,data:e,props:s,context:o})),this.needsRedraw=this.needsRedraw||g.needsRedraw()}u&&bo(L1e,this,t),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:t,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(e){const t=e.map(n=>this.attributes[n]?.getBounds());return this.mergeBoundsMemoized(t)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:t,attributeTransitionManager:n}=this,i={...n.getAttributes()};for(const s in t){const a=t[s];a.needsRedraw(e)&&!n.hasAttribute(s)&&(i[s]=a)}return i}getBufferLayouts(e){return Object.values(this.getAttributes()).map(t=>t.getBufferLayout(e))}_add(e,t){for(const n in e){const i=e[n],s={...i,id:n,size:i.isIndexed&&1||i.size||1,...t};this.attributes[n]=new aX(this.device,s)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes)this.attributes[t].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(t)});this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:n,updateTriggers:i}=this,s=i[e];return s&&s.forEach(a=>{const o=n[a];o&&o.setNeedsUpdate(o.id,t)}),s}_updateAttribute(e){const{attribute:t,numInstances:n}=e;if(bo(N1e,t),t.constant){t.setConstantValue(e.context,t.value);return}t.allocate(n)&&bo(F1e,t,n),t.updateBuffer(e)&&(this.needsRedraw=!0,bo(U1e,t,n))}}class z1e extends FS{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:n,duration:i,easing:s}}=this,a=s(e/i);this._value=Hu(t,n,a)}}const Y5=1e-5;function Z5(r,e,t,n,i){const s=e-r,o=(t-e)*i,u=-s*n;return o+u+s+e}function V1e(r,e,t,n,i){if(Array.isArray(t)){const s=[];for(let a=0;a<t.length;a++)s[a]=Z5(r[a],e[a],t[a],n,i);return s}return Z5(r,e,t,n,i)}function Q5(r,e){if(Array.isArray(r)){let t=0;for(let n=0;n<r.length;n++){const i=r[n]-e[n];t+=i*i}return Math.sqrt(t)}return Math.abs(r-e)}class $1e extends FS{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:n,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:a=e}=this;let o=V1e(s,a,t,n,i);const u=Q5(o,t),f=Q5(o,a);u<Y5&&f<Y5&&(o=t,this.end()),this._prevValue=a,this._currValue=o}}const j1e={interpolation:z1e,spring:$1e};class G1e{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,n,i){const{transitions:s}=this;if(s.has(e)){const u=s.get(e),{value:f=u.settings.fromValue}=u;t=f,this.remove(e)}if(i=oX(i),!i)return;const a=j1e[i.type];if(!a){Rr.error(`unsupported transition type '${i.type}'`)();return}const o=new a(this.timeline);o.start({...i,fromValue:t,toValue:n}),s.set(e,o)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,n]of this.transitions)n.update(),e[t]=n.value,n.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function H1e(r){const e=r[bd];for(const t in e){const n=e[t],{validate:i}=n;if(i&&!i(r[t],n))throw new Error(`Invalid prop ${t}: ${r[t]}`)}}function W1e(r,e){const t=RO({newProps:r,oldProps:e,propTypes:r[bd],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),n=X1e(r,e);let i=!1;return n||(i=J1e(r,e)),{dataChanged:n,propsChanged:t,updateTriggersChanged:i,extensionsChanged:q1e(r,e),transitionsChanged:K1e(r,e)}}function K1e(r,e){if(!r.transitions)return!1;const t={},n=r[bd];let i=!1;for(const s in r.transitions){const a=n[s],o=a&&a.type;(o==="number"||o==="color"||o==="array")&&RB(r[s],e[s],a)&&(t[s]=!0,i=!0)}return i?t:!1}function RO({newProps:r,oldProps:e,ignoreProps:t={},propTypes:n={},triggerName:i="props"}){if(e===r)return!1;if(typeof r!="object"||r===null)return`${i} changed shallowly`;if(typeof e!="object"||e===null)return`${i} changed shallowly`;for(const s of Object.keys(r))if(!(s in t)){if(!(s in e))return`${i}.${s} added`;const a=RB(r[s],e[s],n[s]);if(a)return`${i}.${s} ${a}`}for(const s of Object.keys(e))if(!(s in t)){if(!(s in r))return`${i}.${s} dropped`;if(!Object.hasOwnProperty.call(r,s)){const a=RB(r[s],e[s],n[s]);if(a)return`${i}.${s} ${a}`}}return!1}function RB(r,e,t){let n=t&&t.equal;return n&&!n(r,e,t)||!n&&(n=r&&e&&r.equals,n&&!n.call(r,e))?"changed deeply":!n&&e!==r?"changed shallowly":null}function X1e(r,e){if(e===null)return"oldProps is null, initial diff";let t=!1;const{dataComparator:n,_dataDiff:i}=r;return n?n(r.data,e.data)||(t="Data comparator detected a change"):r.data!==e.data&&(t="A new data container was supplied"),t&&i&&(t=i(r.data,e.data)||t),t}function J1e(r,e){if(e===null)return{all:!0};if("all"in r.updateTriggers&&e8(r,e,"all"))return{all:!0};const t={};let n=!1;for(const i in r.updateTriggers)i!=="all"&&e8(r,e,i)&&(t[i]=!0,n=!0);return n?t:!1}function q1e(r,e){if(e===null)return!0;const t=e.extensions,{extensions:n}=r;if(n===t)return!1;if(!t||!n||n.length!==t.length)return!0;for(let i=0;i<n.length;i++)if(!n[i].equals(t[i]))return!0;return!1}function e8(r,e,t){let n=r.updateTriggers[t];n=n??{};let i=e.updateTriggers[t];return i=i??{},RO({oldProps:i,newProps:n,triggerName:t})}const Y1e="count(): argument not an object",Z1e="count(): argument not a container";function Q1e(r){if(!txe(r))throw new Error(Y1e);if(typeof r.count=="function")return r.count();if(Number.isFinite(r.size))return r.size;if(Number.isFinite(r.length))return r.length;if(exe(r))return Object.keys(r).length;throw new Error(Z1e)}function exe(r){return r!==null&&typeof r=="object"&&r.constructor===Object}function txe(r){return r!==null&&typeof r=="object"}function t8(r,e){if(!e)return r;const t={...r,...e};if("defines"in e&&(t.defines={...r.defines,...e.defines}),"modules"in e&&(t.modules=(r.modules||[]).concat(e.modules),e.modules.some(n=>n.name==="project64"))){const n=t.modules.findIndex(i=>i.name==="project32");n>=0&&t.modules.splice(n,1)}if("inject"in e)if(!r.inject)t.inject=e.inject;else{const n={...r.inject};for(const i in e.inject)n[i]=(n[i]||"")+e.inject[i];t.inject=n}return t}const rxe={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},kB={};function nxe(r,e,t,n){if(t instanceof ca)return t;t.constructor&&t.constructor.name!=="Object"&&(t={data:t});let i=null;t.compressed&&(i={minFilter:"linear",mipmapFilter:t.data.length>1?"nearest":"linear"});const{width:s,height:a}=t.data,o=e.createTexture({...t,sampler:{...rxe,...i,...n},mipLevels:e.getMipLevelCount(s,a)});return o.generateMipmapsWebGL(),kB[o.id]=r,o}function ixe(r,e){!e||!(e instanceof ca)||kB[e.id]===r&&(e.delete(),delete kB[e.id])}const sxe={boolean:{validate(r,e){return!0},equal(r,e,t){return!!r==!!e}},number:{validate(r,e){return Number.isFinite(r)&&(!("max"in e)||r<=e.max)&&(!("min"in e)||r>=e.min)}},color:{validate(r,e){return e.optional&&!r||OB(r)&&(r.length===3||r.length===4)},equal(r,e,t){return Ms(r,e,1)}},accessor:{validate(r,e){const t=XC(r);return t==="function"||t===XC(e.value)},equal(r,e,t){return typeof e=="function"?!0:Ms(r,e,1)}},array:{validate(r,e){return e.optional&&!r||OB(r)},equal(r,e,t){const{compare:n}=t,i=Number.isInteger(n)?n:n?1:0;return n?Ms(r,e,i):r===e}},object:{equal(r,e,t){if(t.ignore)return!0;const{compare:n}=t,i=Number.isInteger(n)?n:n?1:0;return n?Ms(r,e,i):r===e}},function:{validate(r,e){return e.optional&&!r||typeof r=="function"},equal(r,e,t){return!t.compare&&t.ignore!==!1||r===e}},data:{transform:(r,e,t)=>{if(!r)return r;const{dataTransform:n}=t.props;return n?n(r):typeof r.shape=="string"&&r.shape.endsWith("-table")&&Array.isArray(r.data)?r.data:r}},image:{transform:(r,e,t)=>{const n=t.context;return!n||!n.device?null:nxe(t.id,n.device,r,{...e.parameters,...t.props.textureParameters})},release:(r,e,t)=>{ixe(t.id,r)}}};function oxe(r){const e={},t={},n={};for(const[i,s]of Object.entries(r)){const a=s?.deprecatedFor;if(a)n[i]=Array.isArray(a)?a:[a];else{const o=axe(i,s);e[i]=o,t[i]=o.value}}return{propTypes:e,defaultProps:t,deprecatedProps:n}}function axe(r,e){switch(XC(e)){case"object":return e0(r,e);case"array":return e0(r,{type:"array",value:e,compare:!1});case"boolean":return e0(r,{type:"boolean",value:e});case"number":return e0(r,{type:"number",value:e});case"function":return e0(r,{type:"function",value:e,compare:!0});default:return{name:r,type:"unknown",value:e}}}function e0(r,e){return"type"in e?{name:r,...sxe[e.type],...e}:"value"in e?{name:r,type:XC(e.value),...e}:{name:r,type:"object",value:e}}function OB(r){return Array.isArray(r)||ArrayBuffer.isView(r)}function XC(r){return OB(r)?"array":r===null?"null":typeof r}function lxe(r,e){let t;for(let s=e.length-1;s>=0;s--){const a=e[s];"extensions"in a&&(t=a.extensions)}const n=DB(r.constructor,t),i=Object.create(n);i[KC]=r,i[pp]={},i[ad]={};for(let s=0;s<e.length;++s){const a=e[s];for(const o in a)i[o]=a[o]}return Object.freeze(i),i}const cxe="_mergedDefaultProps";function DB(r,e){if(!(r instanceof zS.constructor))return{};let t=cxe;if(e)for(const i of e){const s=i.constructor;s&&(t+=`:${s.extensionName||s.name}`)}const n=gX(r,t);return n||(r[t]=uxe(r,e||[]))}function uxe(r,e){if(!r.prototype)return null;const n=Object.getPrototypeOf(r),i=DB(n),s=gX(r,"defaultProps")||{},a=oxe(s),o=Object.assign(Object.create(null),i,a.defaultProps),u=Object.assign(Object.create(null),i?.[bd],a.propTypes),f=Object.assign(Object.create(null),i?.[$I],a.deprecatedProps);for(const g of e){const y=DB(g.constructor);y&&(Object.assign(o,y),Object.assign(u,y[bd]),Object.assign(f,y[$I]))}return hxe(o,r),fxe(o,u),dxe(o,f),o[bd]=u,o[$I]=f,e.length===0&&!kO(r,"_propTypes")&&(r._propTypes=u),o}function hxe(r,e){const t=gxe(e);Object.defineProperties(r,{id:{writable:!0,value:t}})}function dxe(r,e){for(const t in e)Object.defineProperty(r,t,{enumerable:!1,set(n){const i=`${this.id}: ${t}`;for(const s of e[t])kO(this,s)||(this[s]=n);Rr.deprecated(i,e[t].join("/"))()}})}function fxe(r,e){const t={},n={};for(const i in e){const s=e[i],{name:a,value:o}=s;s.async&&(t[a]=o,n[a]=pxe(a))}r[Fm]=t,r[pp]={},Object.defineProperties(r,n)}function pxe(r){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||iX(e)?this[pp][r]=e:this[ad][r]=e},get(){if(this[ad]){if(r in this[ad])return this[ad][r]||this[Fm][r];if(r in this[pp]){const e=this[KC]&&this[KC].internalState;if(e&&e.hasAsyncProp(r))return e.getAsyncProp(r)||this[Fm][r]}}return this[Fm][r]}}}function kO(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function gX(r,e){return kO(r,e)&&r[e]}function gxe(r){const e=r.componentName;return e||Rr.warn(`${r.name}.componentName not specified`)(),e||r.name}let mxe=0;class zS{constructor(...e){this.props=lxe(this,e),this.id=this.props.id,this.count=mxe++}clone(e){const{props:t}=this,n={};for(const i in t[Fm])i in t[ad]?n[i]=t[ad][i]:i in t[pp]&&(n[i]=t[pp][i]);return new this.constructor({...t,...n,...e})}}zS.componentName="Component";zS.defaultProps={};const yxe=Object.freeze({});class bxe{constructor(e){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t&&t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||yxe}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return!!(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){this.component=e[KC]||this.component;const t=e[ad]||{},n=e[pp]||e,i=e[Fm]||{};for(const s in t){const a=t[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,a),t[s]=this.getAsyncProp(s)}for(const s in n){const a=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,a)}}_fetch(e,t){return null}_onResolve(e,t){}_onError(e,t){}_updateAsyncProp(e,t){if(this._didAsyncInputValueChange(e,t)){if(typeof t=="string"&&(t=this._fetch(e,t)),t instanceof Promise){this._watchPromise(e,t);return}if(iX(t)){this._resolveAsyncIterable(e,t);return}this._setPropValue(e,t)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,t){const n=this.asyncProps[e];return t===n.resolvedValue||t===n.lastValue?!1:(n.lastValue=t,!0)}_setPropValue(e,t){this._freezeAsyncOldProps();const n=this.asyncProps[e];n&&(t=this._postProcessValue(n,t),n.resolvedValue=t,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(e,t,n){const i=this.asyncProps[e];i&&n>=i.resolvedLoadCount&&t!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=t,i.resolvedLoadCount=n,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const n=this.asyncProps[e];if(n){n.pendingLoadCount++;const i=n.pendingLoadCount;t.then(s=>{this.component&&(s=this._postProcessValue(n,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s))}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,t){if(e!=="data"){this._setPropValue(e,t);return}const n=this.asyncProps[e];if(!n)return;n.pendingLoadCount++;const i=n.pendingLoadCount;let s=[],a=0;for await(const o of t){if(!this.component)return;const{dataTransform:u}=this.component.props;u?s=u(o,s):s=s.concat(o),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:a,endRow:s.length}]}),a=s.length,this._setAsyncPropValue(e,s,i)}this._onResolve(e,s)}_postProcessValue(e,t){const n=e.type;return n&&this.component&&(n.release&&n.release(e.resolvedValue,n,this.component),n.transform)?n.transform(t,n,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const i=this.component&&this.component.props[bd];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}class _xe extends bxe{constructor({attributeManager:e,layer:t}){super(t),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,t){const n=this.layer,i=n?.props.fetch;return i?i(t,{propName:e,layer:n}):super._fetch(e,t)}_onResolve(e,t){const n=this.layer;if(n){const i=n.props.onDataLoad;e==="data"&&i&&i(t,{propName:e,layer:n})}}_onError(e,t){const n=this.layer;n&&n.raiseError(t,`loading ${e} of ${this.layer}`)}}const vxe="layer.changeFlag",Axe="layer.initialize",xxe="layer.update",wxe="layer.finalize",Cxe="layer.matched",r8=2**24-1,Txe=Object.freeze([]),Sxe=qv(({oldViewport:r,viewport:e})=>r.equals(e));let Ol=new Uint8ClampedArray(0);const Exe={data:{type:"data",value:Txe,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:r=>r&&r.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(r,{propName:e,layer:t,loaders:n,loadOptions:i,signal:s})=>{const{resourceManager:a}=t.context;i=i||t.getLoadOptions(),n=n||t.props.loaders,s&&(i={...i,fetch:{...i?.fetch,signal:s}});let o=a.contains(r);return!o&&!i&&(a.add({resourceId:r,data:Yu(r,n),persistent:!1}),o=!0),o?a.subscribe({resourceId:r,onChange:u=>t.internalState?.reloadAsyncProp(e,u),consumerId:t.id,requestId:e}):Yu(r,n,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Pr.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:r})=>[0,-r*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class oo extends zS{constructor(){super(...arguments),this.internalState=null,this.lifecycle=sm.NO_STATE,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(e){vs(this.internalState);const t=this.internalState.viewport||this.context.viewport,n=LK(e,{viewport:t,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,a]=RK(n,t.pixelProjectionMatrix);return e.length===2?[i,s]:[i,s,a]}unproject(e){return vs(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,t){vs(this.internalState);const n=this.internalState.viewport||this.context.viewport;return Q0e(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...t})}get isComposite(){return!1}get isDrawable(){return!0}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){const e=this.state;return e&&(e.models||e.model&&[e.model])||[]}setShaderModuleProps(...e){for(const t of this.getModels())t.shaderInputs.setProps(...e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Pr.DEFAULT||e===Pr.LNGLAT||e===Pr.CARTESIAN}onHover(e,t){return this.props.onHover&&this.props.onHover(e,t)||!1}onClick(e,t){return this.props.onClick&&this.props.onClick(e,t)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,t=[]){return t[0]=e+1&255,t[1]=e+1>>8&255,t[2]=e+1>>8>>8&255,t}decodePickingColor(e){vs(e instanceof Uint8Array);const[t,n,i]=e;return t+n*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:Q1e(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){return this.getAttributeManager()?.getBounds(["positions","instancePositions"])}getShaders(e){e=t8(e,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(const t of this.props.extensions)e=t8(e,t.getShaders.call(this,t));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const t=this.getAttributeManager(),{dataChanged:n}=e.changeFlags;if(n&&t)if(Array.isArray(n))for(const i of n)t.invalidateAll(i);else t.invalidateAll();if(t){const{props:i}=e,s=this.internalState.hasPickingBuffer,a=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(o=>o.getNeedsPickingBuffer.call(this,o));if(s!==a){this.internalState.hasPickingBuffer=a;const{pickingColors:o,instancePickingColors:u}=t.attributes,f=o||u;f&&(a&&f.constant&&(f.constant=!1,t.invalidate(f.id)),!f.value&&!a&&(f.constant=!0,f.value=[0,0,0]))}}}finalizeState(e){for(const n of this.getModels())n.destroy();const t=this.getAttributeManager();t&&t.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const t of this.getModels())t.draw(e.renderPass)}getPickingInfo({info:e,mode:t,sourceLayer:n}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,t){t&&(e=new Error(`${t}: ${e.message}`,{cause:e})),this.props.onError?.(e)||this.context?.onError?.(e,this)}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){return this.internalState?.uniformTransitions.active||!1}activateViewport(e){if(!this.internalState)return;const t=this.internalState.viewport;this.internalState.viewport=e,(!t||!Sxe({oldViewport:t,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const t=this.getAttributeManager();t&&(e==="all"?t.invalidateAll():t.invalidate(e))}updateAttributes(e){let t=!1;for(const n in e)e[n].layoutChanged()&&(t=!0);for(const n of this.getModels())this._setModelAttributes(n,e,t)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const t=this.props,n=this.getNumInstances(),i=this.getStartIndices();e.update({data:t.data,numInstances:n,startIndices:i,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const t=e.update(),n=Object.create(this.props);for(const i in t)Object.defineProperty(n,i,{value:t[i]});return n}return this.props}calculateInstancePickingColors(e,{numInstances:t}){if(e.constant)return;const n=Math.floor(Ol.length/4);if(this.internalState.usesPickingColorCache=!0,n<t){t>r8&&Rr.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Ol=iy.allocate(Ol,t,{size:4,copy:!0,maxCount:Math.max(t,r8)});const i=Math.floor(Ol.length/4),s=[0,0,0];for(let a=n;a<i;a++)this.encodePickingColor(a,s),Ol[a*4+0]=s[0],Ol[a*4+1]=s[1],Ol[a*4+2]=s[2],Ol[a*4+3]=0}e.value=Ol.subarray(0,t*4)}_setModelAttributes(e,t,n=!1){if(!Object.keys(t).length)return;if(n){const o=this.getAttributeManager();e.setBufferLayout(o.getBufferLayouts(e)),t=o.getAttributes()}const i=e.userData?.excludeAttributes||{},s={},a={};for(const o in t){if(i[o])continue;const u=t[o].getValue();for(const f in u){const g=u[f];g instanceof Li?t[o].settings.isIndexed?e.setIndexBuffer(g):s[f]=g:g&&(a[f]=g)}}e.setAttributes(s),e.setConstantAttributes(a)}disablePickingIndex(e){const t=this.props.data;if(!("attributes"in t)){this._disablePickingIndex(e);return}const{pickingColors:n,instancePickingColors:i}=this.getAttributeManager().attributes,s=n||i,a=s&&t.attributes&&t.attributes[s.id];if(a&&a.value){const o=a.value,u=this.encodePickingColor(e);for(let f=0;f<t.length;f++){const g=s.getVertexOffset(f);o[g]===u[0]&&o[g+1]===u[1]&&o[g+2]===u[2]&&this._disablePickingIndex(f)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:t,instancePickingColors:n}=this.getAttributeManager().attributes,i=t||n;if(!i)return;const s=i.getVertexOffset(e),a=i.getVertexOffset(e+1);i.buffer.write(new Uint8Array(a-s),s)}restorePickingColors(){const{pickingColors:e,instancePickingColors:t}=this.getAttributeManager().attributes,n=e||t;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==Ol.buffer&&(n.value=Ol.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){vs(!this.internalState),vs(Number.isFinite(this.props.coordinateSystem)),bo(Axe,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new _xe({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Rr.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new G1e(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){bo(Cxe,this,this===e);const{state:t,internalState:n}=e;this!==e&&(this.internalState=n,this.state=t,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(bo(xxe,this,e),!e)return;const t=this.props,n=this.context,i=this.internalState,s=n.viewport,a=this._updateUniformTransition();i.propsInTransition=a,n.viewport=i.viewport||s,this.props=a;try{const o=this._getUpdateParams(),u=this.getModels();if(n.device)this.updateState(o);else try{this.updateState(o)}catch{}for(const g of this.props.extensions)g.updateState.call(this,o,g);this.setNeedsRedraw(),this._updateAttributes();const f=this.getModels()[0]!==u[0];this._postUpdate(o,f)}finally{n.viewport=s,this.props=t,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){bo(wxe,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({renderPass:e,shaderModuleProps:t=null,uniforms:n={},parameters:i={}}){this._updateAttributeTransition();const s=this.props,a=this.context;this.props=this.internalState.propsInTransition||s;try{t&&this.setShaderModuleProps(t);const{getPolygonOffset:o}=this.props,u=o&&o(n)||[0,0];a.device instanceof BB&&a.device.setParametersWebGL({polygonOffset:u});for(const f of this.getModels())f.device.type==="webgpu"?f.setParameters({...f.parameters,...i}):f.setParameters(i);if(a.device instanceof BB)a.device.withParametersWebGL(i,()=>{const f={renderPass:e,shaderModuleProps:t,uniforms:n,parameters:i,context:a};for(const g of this.props.extensions)g.draw.call(this,f,g);this.draw(f)});else{const f={renderPass:e,shaderModuleProps:t,uniforms:n,parameters:i,context:a};for(const g of this.props.extensions)g.draw.call(this,f,g);this.draw(f)}}finally{this.props=s}}getChangeFlags(){return this.internalState?.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:t}=this.internalState;for(const i in e)if(e[i]){let s=!1;switch(i){case"dataChanged":const a=e[i],o=t[i];a&&Array.isArray(o)&&(t.dataChanged=Array.isArray(a)?o.concat(a):a,s=!0);default:t[i]||(t[i]=e[i],s=!0)}s&&bo(vxe,this,i,e)}const n=!!(t.dataChanged||t.updateTriggersChanged||t.propsChanged||t.extensionsChanged);t.propsOrDataChanged=n,t.somethingChanged=n||t.viewportChanged||t.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,t){const n=W1e(e,t);if(n.updateTriggersChanged)for(const i in n.updateTriggersChanged)n.updateTriggersChanged[i]&&this.invalidateAttribute(i);if(n.transitionsChanged)for(const i in n.transitionsChanged)this.internalState.uniformTransitions.add(i,t[i],e[i],e.transitions?.[i]);return this.setChangeFlags(n)}validateProps(){H1e(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const t={highlightedObjectColor:e.picked?e.color:null},{highlightColor:n}=this.props;e.picked&&typeof n=="function"&&(t.highlightColor=n(e)),this.setShaderModuleProps({picking:t}),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new US(e.device,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,t){const{props:n,oldProps:i}=e,s=this.state.model;s?.isInstanced&&s.setInstanceCount(this.getNumInstances());const{autoHighlight:a,highlightedObjectIndex:o,highlightColor:u}=n;if(t||i.autoHighlight!==a||i.highlightedObjectIndex!==o||i.highlightColor!==u){const f={};Array.isArray(u)&&(f.highlightColor=u),(t||i.autoHighlight!==a||o!==i.highlightedObjectIndex)&&(f.highlightedObjectColor=Number.isFinite(o)&&o>=0?this.encodePickingColor(o):null),this.setShaderModuleProps({picking:f})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let t=!1;t=t||this.internalState.needsRedraw&&this.id;const n=this.getAttributeManager(),i=n?n.getNeedsRedraw(e):!1;if(t=t||i,t)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,t}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}oo.defaultProps=Exe;oo.layerName="Layer";const Ixe="compositeLayer.renderLayers";class Zc extends oo{get isComposite(){return!0}get isDrawable(){return!1}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:t}=e;return t&&t.__source&&t.__source.parent&&t.__source.parent.id===this.id&&(e.object=t.__source.object,e.index=t.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,t){return t&&t.length}getSubLayerClass(e,t){const{_subLayerProps:n}=this.props;return n&&n[e]&&n[e].type||t}getSubLayerRow(e,t,n){return e.__source={parent:this,object:t,index:n},e}getSubLayerAccessor(e){if(typeof e=="function"){const t={index:-1,data:this.props.data,target:[]};return(n,i)=>n&&n.__source?(t.index=n.__source.index,e(n.__source.object,t)):e(n,i)}return e}getSubLayerProps(e={}){const{opacity:t,pickable:n,visible:i,parameters:s,getPolygonOffset:a,highlightedObjectIndex:o,autoHighlight:u,highlightColor:f,coordinateSystem:g,coordinateOrigin:y,wrapLongitude:A,positionFormat:C,modelMatrix:M,extensions:k,fetch:D,operation:V,_subLayerProps:W}=this.props,z={id:"",updateTriggers:{},opacity:t,pickable:n,visible:i,parameters:s,getPolygonOffset:a,highlightedObjectIndex:o,autoHighlight:u,highlightColor:f,coordinateSystem:g,coordinateOrigin:y,wrapLongitude:A,positionFormat:C,modelMatrix:M,extensions:k,fetch:D,operation:V},$=W&&e.id&&W[e.id],te=$&&$.updateTriggers,le=e.id||"sublayer";if($){const _e=this.props[bd],se=e.type?e.type._propTypes:{};for(const Y in $){const ce=se[Y]||_e[Y];ce&&ce.type==="accessor"&&($[Y]=this.getSubLayerAccessor($[Y]))}}Object.assign(z,e,$),z.id=`${this.props.id}-${le}`,z.updateTriggers={all:this.props.updateTriggers?.all,...e.updateTriggers,...te};for(const _e of k){const se=_e.getSubLayerProps.call(this,_e);se&&Object.assign(z,se,{updateTriggers:Object.assign(z.updateTriggers,se.updateTriggers)})}return z}_updateAutoHighlight(e){for(const t of this.getSubLayers())t.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,t){let n=this.internalState.subLayers;const i=!n||this.needsUpdate();if(i){const s=this.renderLayers();n=xd(s,Boolean),this.internalState.subLayers=n}bo(Ixe,this,i,n);for(const s of n)s.parent=this}}Zc.layerName="CompositeLayer";const ax=Math.PI/180,n8=180/Math.PI,Bw=6370972,_m=256;function Pxe(){const r=_m/Bw,e=Math.PI/180*_m;return{unitsPerMeter:[r,r,r],unitsPerMeter2:[0,0,0],metersPerUnit:[1/r,1/r,1/r],unitsPerDegree:[e,e,r],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/r]}}class mX extends nh{constructor(e={}){const{longitude:t=0,zoom:n=0,nearZMultiplier:i=.5,farZMultiplier:s=1,resolution:a=10}=e;let{latitude:o=0,height:u,altitude:f=1.5,fovy:g}=e;o=Math.max(Math.min(o,od),-od),u=u||1,g?f=vO(g):g=H_(f);const y=1/Math.PI/Math.cos(o*Math.PI/180),A=Math.pow(2,n)*y,C=e.nearZ??i,M=e.farZ??(f+_m*2*A/u)*s,k=new $r().lookAt({eye:[0,-f,0],up:[0,0,1]});k.rotateX(o*ax),k.rotateZ(-t*ax),k.scale(A/u),super({...e,height:u,viewMatrix:k,longitude:t,latitude:o,zoom:n,distanceScales:Pxe(),fovy:g,focalDistance:f,near:C,far:M}),this.scale=A,this.latitude=o,this.longitude=t,this.resolution=a}get projectionMode(){return za.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const t={targetZ:e.z||0},n=this.unproject([0,this.height/2],t),i=this.unproject([this.width/2,0],t),s=this.unproject([this.width,this.height/2],t),a=this.unproject([this.width/2,this.height],t);return s[0]<this.longitude&&(s[0]+=360),n[0]>this.longitude&&(n[0]-=360),[Math.min(n[0],s[0],i[0],a[0]),Math.min(n[1],s[1],i[1],a[1]),Math.max(n[0],s[0],i[0],a[0]),Math.max(n[1],s[1],i[1],a[1])]}unproject(e,{topLeft:t=!0,targetZ:n}={}){const[i,s,a]=e,o=t?s:this.height-s,{pixelUnprojectionMatrix:u}=this;let f;if(Number.isFinite(a))f=JI(u,[i,o,a,1]);else{const C=JI(u,[i,o,-1,1]),M=JI(u,[i,o,1,1]),k=((n||0)/Bw+1)*_m,D=BI(oK([],C,M)),V=BI(C),W=BI(M),$=4*((4*V*W-(D-V-W)**2)/16)/D,te=Math.sqrt(V-$),le=Math.sqrt(Math.max(0,k*k-$)),_e=(te-le)/Math.sqrt(D);f=ume([],C,M,_e)}const[g,y,A]=this.unprojectPosition(f);return Number.isFinite(a)?[g,y,A]:Number.isFinite(n)?[g,y,n]:[g,y]}projectPosition(e){const[t,n,i=0]=e,s=t*ax,a=n*ax,o=Math.cos(a),u=(i/Bw+1)*_m;return[Math.sin(s)*o*u,-Math.cos(s)*o*u,Math.sin(a)*u]}unprojectPosition(e){const[t,n,i]=e,s=aK(e),a=Math.asin(i/s),u=Math.atan2(t,-n)*n8,f=a*n8,g=(s/_m-1)*Bw;return[u,f,g]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,t){const n=this.unproject(t);return{longitude:e[0]-n[0]+this.longitude,latitude:e[1]-n[1]+this.latitude}}}function JI(r,e){const t=Py([],e,r);return pO(t,t,1/t[3]),t}class Bxe extends GK{applyConstraints(e){const{maxZoom:t,minZoom:n,zoom:i}=e;e.zoom=Xl(i,n,t);const{longitude:s,latitude:a}=e;return(s<-180||s>180)&&(e.longitude=j0e(s+180,360)-180),e.latitude=Xl(a,-od,od),e}}class Mxe extends jK{constructor(){super(...arguments),this.ControllerState=Bxe,this.transition={transitionDuration:300,transitionInterpolator:new wO(["longitude","latitude","zoom"])},this.dragMode="pan"}setProps(e){super.setProps(e),this.dragRotate=!1,this.touchRotate=!1}}class yX extends $K{constructor(e={}){super(e)}getViewportType(e){return e.zoom>12?Qu:mX}get ControllerType(){return Mxe}}yX.displayName="GlobeView";class OO{static get componentName(){return Object.prototype.hasOwnProperty.call(this,"extensionName")?this.extensionName:""}constructor(e){e&&(this.opts=e)}equals(e){return this===e?!0:this.constructor===e.constructor&&Ms(this.opts,e.opts,1)}getShaders(e){return null}getSubLayerProps(e){const{defaultProps:t}=e.constructor,n={updateTriggers:{}};for(const i in t)if(i in this.props){const s=t[i],a=this.props[i];n[i]=a,s&&s.type==="accessor"&&(n.updateTriggers[i]=this.props.updateTriggers[i],typeof a=="function"&&(n[i]=this.getSubLayerAccessor(a)))}return n}initializeState(e,t){}updateState(e,t){}onNeedsRedraw(e){}getNeedsPickingBuffer(e){return!1}draw(e,t){}finalizeState(e,t){}}OO.defaultProps={};OO.extensionName="LayerExtension";class bX{constructor(e){this.indexStarts=[0],this.vertexStarts=[0],this.vertexCount=0,this.instanceCount=0;const{attributes:t={}}=e;this.typedArrayManager=iy,this.attributes={},this._attributeDefs=t,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:t,buffers:n={},getGeometry:i,geometryBuffer:s,positionFormat:a,dataChanged:o,normalize:u=!0}=this.opts;if(this.data=t,this.getGeometry=i,this.positionSize=s&&s.size||(a==="XY"?2:3),this.buffers=n,this.normalize=u,s&&(vs(t.startIndices),this.getGeometry=this.getGeometryFromBuffer(s),u||(n.vertexPositions=s)),this.geometryBuffer=n.vertexPositions,Array.isArray(o))for(const f of o)this._rebuildGeometry(f);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:t}){this._rebuildGeometry({startRow:e,endRow:t})}getGeometryFromBuffer(e){const t=e.value||e;return ArrayBuffer.isView(t)?sX(t,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,t){const{attributes:n,buffers:i,_attributeDefs:s,typedArrayManager:a}=this;for(const o in s)if(o in i)a.release(n[o]),n[o]=null;else{const u=s[o];u.copy=t,n[o]=a.allocate(n[o],e,u)}}_forEachGeometry(e,t,n){const{data:i,getGeometry:s}=this,{iterable:a,objectInfo:o}=Sd(i,t,n);for(const u of a){o.index++;const f=s?s(u,o):null;e(f,o.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:t,vertexStarts:n,instanceCount:i}=this;const{data:s,geometryBuffer:a}=this,{startRow:o=0,endRow:u=1/0}=e||{},f={};if(e||(t=[0],n=[0]),this.normalize||!a)this._forEachGeometry((y,A)=>{const C=y&&this.normalizeGeometry(y);f[A]=C,n[A+1]=n[A]+(C?this.getGeometrySize(C):0)},o,u),i=n[n.length-1];else if(n=s.startIndices,i=n[s.length]||0,ArrayBuffer.isView(a))i=i||a.length/this.positionSize;else if(a instanceof Li){const y=this.positionSize*4;i=i||a.byteLength/y}else if(a.buffer){const y=a.stride||this.positionSize*4;i=i||a.buffer.byteLength/y}else if(a.value){const y=a.value,A=a.stride/y.BYTES_PER_ELEMENT||this.positionSize;i=i||y.length/A}this._allocate(i,!!e),this.indexStarts=t,this.vertexStarts=n,this.instanceCount=i;const g={};this._forEachGeometry((y,A)=>{const C=f[A]||y;g.vertexStart=n[A],g.indexStart=t[A];const M=A<n.length-1?n[A+1]:i;g.geometrySize=M-n[A],g.geometryIndex=A,this.updateGeometryAttributes(C,g)},o,u),this.vertexCount=t[t.length-1]}}const K_="mapbox",qI=512,Rxe=Math.PI/180;function _X({map:r,gl:e,deck:t}){if(r.__deck)return r.__deck;const n=t?.props._customRender,i=t?.props.onLoad,s={...t?.props,_customRender:()=>{r.triggerRepaint(),n?.("")}};s.parameters={...Mw(r,!0),...s.parameters},s.views||(s.views=s_(r));let a;return(!t||t.props.gl===e)&&(Object.assign(s,{gl:e,width:null,height:null,touchAction:"unset",viewState:X_(r)}),t?.isInitialized?i8(t,r):s.onLoad=()=>{i?.(),i8(a,r)}),t?(a=t,t.setProps(s),t.userData.isExternal=!0):(a=new Us(s),r.on("remove",()=>{vX(r)})),a.userData.mapboxLayers=new Set,r.__deck=a,r.on("render",()=>{a.isInitialized&&Fxe(a,r)}),a}function i8(r,e){const t=()=>{r.isInitialized?Uxe(r,e):e.off("move",t)};e.on("move",t)}function vX(r){r.__deck?.finalize(),r.__deck=null}function Mw(r,e){const t=e?{depthWriteEnabled:!0,depthCompare:"less-equal",depthBias:0,blend:!0,blendColorSrcFactor:"src-alpha",blendColorDstFactor:"one-minus-src-alpha",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one-minus-src-alpha",blendColorOperation:"add",blendAlphaOperation:"add"}:{};return DO(r)==="globe"&&(t.cullMode="back"),t}function kxe(r,e){r.userData.mapboxLayers.add(e),LO(r)}function Oxe(r,e){r.userData.mapboxLayers.delete(e),LO(r)}function Dxe(r,e){LO(r)}function Lxe(r,e,t,n){let{currentViewport:i}=r.userData,s=!1;i||(i=AX(r,e,n),r.userData.currentViewport=i,s=!0),r.isInitialized&&r._drawLayers("mapbox-repaint",{viewports:[i],layerFilter:a=>(!r.props.layerFilter||r.props.layerFilter(a))&&(t.id===a.layer.id||a.layer.props.operation.includes("terrain")),clearStack:s,clearCanvas:!1})}function DO(r){const e=r.getProjection?.(),t=e?.type||e?.name;if(t==="globe")return"globe";if(t&&t!=="mercator")throw new Error("Unsupported projection");return"mercator"}function s_(r){return DO(r)==="globe"?new yX({id:K_}):new CO({id:K_})}function X_(r){const{lng:e,lat:t}=r.getCenter(),n={longitude:(e+540)%360-180,latitude:t,zoom:r.getZoom(),bearing:r.getBearing(),pitch:r.getPitch(),padding:r.getPadding(),repeat:r.getRenderWorldCopies()};return r.getTerrain?.()&&Nxe(r,n),n}function Nxe(r,e){if(r.getFreeCameraOptions){const{position:t}=r.getFreeCameraOptions();if(!t||t.z===void 0)return;const n=r.transform.height,{longitude:i,latitude:s,pitch:a}=e,o=t.x*qI,u=(1-t.y)*qI,f=t.z*qI,g=Jc([i,s]),y=o-g[0],A=u-g[1],C=Math.sqrt(y*y+A*A),M=a*Rxe,k=1.5*n,D=M<.001?k*Math.cos(M)/f:k*Math.sin(M)/C;e.zoom=Math.log2(D);const V=k*Math.cos(M)/D,W=f-V;e.position=[0,0,W/Iw(s)]}else typeof r.transform.elevation=="number"&&(e.position=[0,0,r.transform.elevation])}function AX(r,e,t){const n=X_(e),{views:i}=r.props,s=i&&xd(i).find(u=>u.id===K_)||s_(e);t&&(s.props.nearZMultiplier=.2);const a=t?.nearZ??e.transform._nearZ,o=t?.farZ??e.transform._farZ;return Number.isFinite(a)&&(n.nearZ=a/e.transform.height,n.farZ=o/e.transform.height),s.makeViewport({width:r.width,height:r.height,viewState:n})}function Fxe(r,e){const{mapboxLayers:t,isExternal:n}=r.userData;if(n){const i=Array.from(t,g=>g.id),a=xd(r.props.layers,Boolean).some(g=>g&&!i.includes(g.id));let o=r.getViewports();const u=o.findIndex(g=>g.id===K_),f=o.length>1||u<0;(a||f)&&(u>=0&&(o=o.slice(),o[u]=AX(r,e)),r._drawLayers("mapbox-repaint",{viewports:o,layerFilter:g=>(!r.props.layerFilter||r.props.layerFilter(g))&&(g.viewport.id!==K_||!i.includes(g.layer.id)),clearCanvas:!1}))}r.userData.currentViewport=null}function Uxe(r,e){r.setProps({viewState:X_(e)}),r.needsRedraw({clearRedrawFlags:!0})}function LO(r){if(r.userData.isExternal)return;const e=[];r.userData.mapboxLayers.forEach(t=>{const n=t.props.type,i=new n(t.props);e.push(i)}),r.setProps({layers:e})}class zxe{constructor(e){if(!e.id)throw new Error("Layer must have an unique id");this.id=e.id,this.type="custom",this.renderingMode=e.renderingMode||"3d",this.slot=e.slot,this.map=null,this.deck=null,this.props=e}onAdd(e,t){this.map=e,this.deck=_X({map:e,gl:t,deck:this.props.deck}),kxe(this.deck,this)}onRemove(){this.deck&&Oxe(this.deck,this)}setProps(e){Object.assign(this.props,e,{id:this.id}),this.deck&&Dxe(this.deck)}render(e,t){Lxe(this.deck,this.map,this,t)}}const YI="__UNDEFINED__";function lx(r,e,t,n){if(!r||!e||!r.style||!r.style._loaded)return;const i=xd(n,Boolean);if(t!==n){const o=xd(t,Boolean),u=new Set(o.map(f=>f.id));for(const f of i)u.delete(f.id);for(const f of u)r.getLayer(f)&&r.removeLayer(f)}for(const o of i){const u=r.getLayer(o.id);u?(u.implementation||u).setProps(o.props):r.addLayer(new zxe({id:o.id,deck:e,slot:o.props.slot}),o.props.beforeId)}const s=r.style._order,a={};for(const o of i){let{beforeId:u}=o.props;(!u||!s.includes(u))&&(u=YI),a[u]=a[u]||[],a[u].push(o.id)}for(const o in a){const u=a[o];let f=o===YI?s.length:s.indexOf(o),g=o===YI?void 0:o;for(let y=u.length-1;y>=0;y--){const A=u[y],C=s.indexOf(A);C!==f-1&&(r.moveLayer(A,g),C>f&&f++),f--,g=A}}}class Vxe{constructor(e){this._handleStyleChange=()=>{if(lx(this._map,this._deck,this._props.layers,this._props.layers),!this._map)return;DO(this._map)&&!this._props.views&&this._deck?.setProps({views:s_(this._map)})},this._updateContainerSize=()=>{if(this._map&&this._container){const{clientWidth:n,clientHeight:i}=this._map.getContainer();Object.assign(this._container.style,{width:`${n}px`,height:`${i}px`})}},this._updateViewState=()=>{const n=this._deck,i=this._map;n&&i&&(n.setProps({views:this._props.views||s_(i),viewState:X_(i)}),n.isInitialized&&n.redraw())},this._handleMouseEvent=n=>{const i=this._deck;if(!i||!i.isInitialized)return;const s={type:n.type,offsetCenter:n.point,srcEvent:n},a=this._lastMouseDownPoint;switch(!n.point&&a&&(s.deltaX=n.originalEvent.clientX-a.clientX,s.deltaY=n.originalEvent.clientY-a.clientY,s.offsetCenter={x:a.x+s.deltaX,y:a.y+s.deltaY}),s.type){case"mousedown":i._onPointerDown(s),this._lastMouseDownPoint={...n.point,clientX:n.originalEvent.clientX,clientY:n.originalEvent.clientY};break;case"dragstart":s.type="panstart",i._onEvent(s);break;case"drag":s.type="panmove",i._onEvent(s);break;case"dragend":s.type="panend",i._onEvent(s);break;case"click":s.tapCount=1,i._onEvent(s);break;case"dblclick":s.type="click",s.tapCount=2,i._onEvent(s);break;case"mousemove":s.type="pointermove",i._onPointerMove(s);break;case"mouseout":s.type="pointerleave",i._onPointerMove(s);break;default:return}};const{interleaved:t=!1}=e;this._interleaved=t,this._props=this.filterProps(e)}filterProps(e){const{interleaved:t=!1,useDevicePixels:n,...i}=e;return!t&&n!==void 0&&(i.useDevicePixels=n),i}setProps(e){this._interleaved&&e.layers&&lx(this._map,this._deck,this._props.layers,e.layers),Object.assign(this._props,this.filterProps(e)),this._deck&&this._map&&this._deck.setProps({...this._props,parameters:{...Mw(this._map,this._interleaved),...this._props.parameters}})}onAdd(e){return this._map=e,this._interleaved?this._onAddInterleaved(e):this._onAddOverlaid(e)}_onAddOverlaid(e){const t=document.createElement("div");return Object.assign(t.style,{position:"absolute",left:0,top:0,textAlign:"initial",pointerEvents:"none"}),this._container=t,this._deck=new Us({...this._props,parent:t,parameters:{...Mw(e,!1),...this._props.parameters},views:this._props.views||s_(e),viewState:X_(e)}),e.on("resize",this._updateContainerSize),e.on("render",this._updateViewState),e.on("mousedown",this._handleMouseEvent),e.on("dragstart",this._handleMouseEvent),e.on("drag",this._handleMouseEvent),e.on("dragend",this._handleMouseEvent),e.on("mousemove",this._handleMouseEvent),e.on("mouseout",this._handleMouseEvent),e.on("click",this._handleMouseEvent),e.on("dblclick",this._handleMouseEvent),this._updateContainerSize(),t}_onAddInterleaved(e){const t=e.painter.context.gl;return t instanceof WebGLRenderingContext&&Rr.warn("Incompatible basemap library. See: https://deck.gl/docs/api-reference/mapbox/overview#compatibility")(),this._deck=_X({map:e,gl:t,deck:new Us({...this._props,gl:t,parameters:{...Mw(e,!0),...this._props.parameters}})}),e.on("styledata",this._handleStyleChange),lx(e,this._deck,[],this._props.layers),document.createElement("div")}onRemove(){const e=this._map;e&&(this._interleaved?this._onRemoveInterleaved(e):this._onRemoveOverlaid(e)),this._deck=void 0,this._map=void 0,this._container=void 0}_onRemoveOverlaid(e){e.off("resize",this._updateContainerSize),e.off("render",this._updateViewState),e.off("mousedown",this._handleMouseEvent),e.off("dragstart",this._handleMouseEvent),e.off("drag",this._handleMouseEvent),e.off("dragend",this._handleMouseEvent),e.off("mousemove",this._handleMouseEvent),e.off("mouseout",this._handleMouseEvent),e.off("click",this._handleMouseEvent),e.off("dblclick",this._handleMouseEvent),this._deck?.finalize()}_onRemoveInterleaved(e){e.off("styledata",this._handleStyleChange),lx(e,this._deck,this._props.layers,[]),vX(e)}getDefaultPosition(){return"top-left"}pickObject(e){return vs(this._deck),this._deck.pickObject(e)}pickMultipleObjects(e){return vs(this._deck),this._deck.pickMultipleObjects(e)}pickObjects(e){return vs(this._deck),this._deck.pickObjects(e)}finalize(){this._map&&this._map.removeControl(this)}getCanvas(){return this._map?this._interleaved?this._map.getCanvas():this._deck.getCanvas():null}}const $xe=Symbol("map"),jxe=$xe,Gxe=Symbol("isLoaded"),Hxe=Symbol("isInitialized"),Wxe=Hxe;var xX=(r=>(r.TOP_LEFT="top-left",r.TOP_RIGHT="top-right",r.BOTTOM_LEFT="bottom-left",r.BOTTOM_RIGHT="bottom-right",r))(xX||{});const Kxe={width:{type:[Number,String],default:"100%"},height:{type:[Number,String],default:"100%"},attributionControl:{type:[Boolean,Object],default:void 0},bearing:{type:Number},bearingSnap:{type:Number},bounds:{type:[Array,Object]},boxZoom:{type:Boolean,default:void 0},center:{type:[Array,Object]},clickTolerance:{type:Number},collectResourceTiming:{type:Boolean,default:void 0},crossSourceCollisions:{type:Boolean,default:void 0},dragPan:{type:Boolean,default:void 0},dragRotate:{type:Boolean,default:void 0},doubleClickZoom:{type:Boolean,default:void 0},hash:{type:[Boolean,String],default:void 0},fadeDuration:{type:Number},fitBoundsOptions:{type:Object},interactive:{type:Boolean,default:void 0},keyboard:{type:Boolean,default:void 0},locale:{type:Object},localIdeographFontFamily:{type:String},logoPosition:{type:[String],validator:r=>r in xX},maxBounds:{type:[Array,Object]},maxPitch:{type:Number},maxZoom:{type:Number},minPitch:{type:Number},minZoom:{type:Number},pitch:{type:Number},pitchWithRotate:{type:Boolean,default:void 0},canvasContextAttributes:{type:Object},refreshExpiredTiles:{type:Boolean,default:void 0},renderWorldCopies:{type:Boolean,default:void 0},scrollZoom:{type:Boolean,default:void 0},style:{type:[String,Object]},trackResize:{type:Boolean,default:void 0},transformRequest:{type:Function},transformCameraUpdate:{type:Function},touchZoomRotate:{type:Boolean,default:void 0},touchPitch:{type:Boolean,default:void 0},zoom:{type:Number},maxTileCacheSize:{type:Number},mapKey:{type:[String,Symbol]},pixelRatio:{type:Number},validateStyle:{type:Boolean,default:void 0},cooperativeGestures:{type:Object}},Xxe=["error","load","idle","remove","render","resize","webglcontextlost","webglcontextrestored","dataloading","data","tiledataloading","sourcedataloading","styledataloading","sourcedata","styledata","styleimagemissing","dataabort","sourcedataabort","boxzoomcancel","boxzoomstart","boxzoomend","touchcancel","touchmove","touchend","touchstart","click","contextmenu","dblclick","mousemove","mouseup","mousedown","mouseout","mouseover","movestart","move","moveend","zoomstart","zoom","zoomend","rotatestart","rotate","rotateend","dragstart","drag","dragend","pitchstart","pitch","pitchend","wheel","terrain","cooperativegestureprevented"];function Jxe(r,e,t,n){return i=>t.emit(n,{type:i.type,map:e,component:r,event:i})}const{LngLat:s8}=OH;function qxe(r,e){const t=s8.convert(r),n=s8.convert(e);return t.lng===n.lng&&t.lat===n.lat}const wX=Symbol("mapboxOverlayInstanceSymbol"),{Map:Yxe}=OH,o8=I.defineComponent({name:"Map",props:{...Kxe},emits:["map:error","map:load","map:idle","map:remove","map:render","map:resize","map:webglcontextlost","map:webglcontextrestored","map:dataloading","map:data","map:tiledataloading","map:sourcedataloading","map:styledataloading","map:sourcedata","map:styledata","map:styleimagemissing","map:dataabort","map:sourcedataabort","map:boxzoomcancel","map:boxzoomstart","map:boxzoomend","map:touchcancel","map:touchmove","map:touchend","map:touchstart","map:click","map:contextmenu","map:dblclick","map:mousemove","map:mouseup","map:mousedown","map:mouseout","map:mouseover","map:movestart","map:move","map:moveend","map:zoomstart","map:zoom","map:zoomend","map:rotatestart","map:rotate","map:rotateend","map:dragstart","map:drag","map:dragend","map:pitchstart","map:pitch","map:pitchend","map:wheel","map:terrain","map:cooperativegestureprevented","map:projectiontransition","update:center","update:zoom","update:pitch","update:bearing"],slots:Object,setup(r,e){const t=I.markRaw(I.getCurrentInstance()),n=I.shallowRef(),i=I.shallowRef(),s=I.ref(!1),a=I.ref(!1),o=new Map;I.provide(jxe,i),I.provide(Gxe,a),I.provide(Wxe,s);const u=I.inject(wX);I.watch(()=>r.bearing,A=>{var C;A&&((C=i.value)==null||C.setBearing(A))}),I.watch(()=>r.bounds,A=>{var C;A&&((C=i.value)==null||C.fitBounds(A,r.fitBoundsOptions))}),I.watch(()=>r.center,A=>{var C,M;const k=(C=i.value)==null?void 0:C.getCenter();A&&k&&!qxe(A,k)&&((M=i.value)==null||M.setCenter(A))}),I.watch(()=>r.maxBounds,A=>{var C;A&&((C=i.value)==null||C.setMaxBounds(A))}),I.watch(()=>r.maxPitch,A=>{var C;A&&((C=i.value)==null||C.setMaxPitch(A))}),I.watch(()=>r.maxZoom,A=>{var C;A&&((C=i.value)==null||C.setMaxZoom(A))}),I.watch(()=>r.minPitch,A=>{var C;A&&((C=i.value)==null||C.setMinPitch(A))}),I.watch(()=>r.minZoom,A=>{var C;A&&((C=i.value)==null||C.setMinZoom(A))}),I.watch(()=>r.pitch,A=>{var C;A&&((C=i.value)==null||C.setPitch(A))}),I.watch(()=>r.renderWorldCopies,A=>{var C;A&&((C=i.value)==null||C.setRenderWorldCopies(A))}),I.watch(()=>r.style,A=>{var C;A&&((C=i.value)==null||C.setStyle(A))}),I.watch(()=>r.transformRequest,A=>{var C;A&&((C=i.value)==null||C.setTransformRequest(A))}),I.watch(()=>r.zoom,A=>{var C;A&&((C=i.value)==null||C.setZoom(A))}),I.watch(()=>r.zoom,A=>{var C;A&&((C=i.value)==null||C.setZoom(A))});function f(){const A={...r,style:r.style,container:n.value};for(const C of Object.keys(A))A[C]===void 0&&delete A[C];if(i.value=I.markRaw(new Yxe(A)),s.value=!0,o.set("__load",()=>a.value=!0),i.value.on("load",o.get("__load")),o.set("__moveend",()=>e.emit("update:center",i.value.getCenter())),i.value.on("moveend",o.get("__moveend")),o.set("__zoomend",()=>e.emit("update:zoom",i.value.getZoom())),i.value.on("zoomend",o.get("__zoomend")),o.set("__pitchend",()=>e.emit("update:pitch",i.value.getPitch())),i.value.on("pitchend",o.get("__pitchend")),o.set("__rotateend",()=>e.emit("update:bearing",i.value.getBearing())),i.value.on("rotateend",o.get("__rotateend")),i.value.on("load",()=>{var C;u&&((C=i.value)==null||C.addControl(u.value))}),t.vnode.props){for(const C of Xxe)if(t.vnode.props["onMap:"+C]){const M=`map:${C}`,k=Jxe(t,i.value,e,M);o.set(C,k),i.value.on(C,k)}}i.value.getCanvas().addEventListener("webglcontextlost",y)}async function g(){a.value=!1,i.value&&(i.value.getCanvas().removeEventListener("webglcontextlost",y),s.value=!1,o.forEach((A,C)=>{i.value.off(C.startsWith("__")?C.substring(2):C,A)}),i.value.remove())}function y(){g().then(),I.nextTick(f).then()}return I.onMounted(f),I.onBeforeUnmount(g),e.expose({map:i}),()=>[I.h("div",{ref:n,style:{height:r.height,width:r.width}}),s.value&&e.slots.default?e.slots.default({}):void 0]},render(){return null}}),Zxe={interleaved:{type:Boolean,default:!1},beforeId:{type:String,default:void 0},id:{type:String,default:"deckgl-overlay"},style:{type:Object,default:Us.defaultProps.style},useDevicePixels:{type:[Boolean,Number],default:Us.defaultProps.useDevicePixels},pickingRadius:{type:Number,default:Us.defaultProps.pickingRadius},parameters:{type:Object,default:Us.defaultProps.parameters},layerFilter:{type:Function,default:Us.defaultProps.layerFilter},layers:{type:Array,default:Us.defaultProps.layers},effects:{type:Array,default:Us.defaultProps.effects},views:{type:[Object,Array],default:Us.defaultProps.views},touchAction:{type:String,default:Us.defaultProps.touchAction},eventRecognizerOptions:{type:Object,default:Us.defaultProps.eventRecognizerOptions},getCursor:{type:Function,default:Us.defaultProps.getCursor},getTooltip:{type:Function,default:Us.defaultProps.getTooltip},debug:{type:Boolean,default:Us.defaultProps.debug}},Qxe=["interleaved","id","style","useDevicePixels","pickingRadius","parameters","layerFilter","layers","effects","views","touchAction","eventRecognizerOptions","getCursor","getTooltip","debug"];function ewe(r,e){for(const t of Object.keys(r))(r[t]===void 0||!e.includes(t))&&delete r[t];return r}const twe=I.defineComponent({name:"DeckGL",props:{...Zxe},slots:Object,emits:["load","click","hover","drag","dragStart","dragEnd","deviceInitialized","beforeRender","afterRender","interactionStateChange","viewStateChange","error","resize","metrics"],setup(r,e){const t=I.ref(null),n=I.ref(!1),i=I.ref([]);I.provide(wX,t),I.provide("removeLayer",u=>{var f;i.value=(f=i.value)==null?void 0:f.filter(g=>g!==u)}),I.provide("addLayer",u=>{i.value=[...i.value,u]});const s=I.computed(()=>[...i.value,...r.layers]);I.watch(s,()=>{var u;(u=t.value)==null||u.setProps({layers:s.value})},{deep:!0});function a(){const u=ewe({...r},Qxe);t.value=I.markRaw(new Vxe({...u,layers:[...s.value],onLoad:()=>e.emit("load"),onClick:(f,g)=>e.emit("click",{info:f,event:g}),onHover:(f,g)=>e.emit("hover",{info:f,event:g}),onDrag:(f,g)=>e.emit("drag",{info:f,event:g}),onDragStart:(f,g)=>e.emit("dragStart",{info:f,event:g}),onDragEnd:(f,g)=>e.emit("dragEnd",{info:f,event:g}),onDeviceInitialized:f=>e.emit("deviceInitialized",f),onBeforeRender:({device:f,gl:g})=>e.emit("beforeRender",{device:f,gl:g}),onAfterRender:({device:f,gl:g})=>e.emit("afterRender",{device:f,gl:g}),onInteractionStateChange:f=>e.emit("interactionStateChange",f),onViewStateChange:({viewState:f,oldViewState:g,viewId:y,interactionState:A})=>e.emit("viewStateChange",{viewState:f,viewId:y,interactionState:A,oldViewState:g}),onError:(f,g)=>e.emit("error",{error:f,layer:g}),onResize:({width:f,height:g})=>e.emit("resize",{width:f,height:g}),_onMetrics:f=>e.emit("metrics",f)})),n.value=!0}I.onMounted(a);function o(){t.value&&(t.value.finalize(),t.value=null)}return I.onBeforeUnmount(o),e.expose({mapboxOverlay:t}),()=>[n.value&&e.slots.default?e.slots.default({}):void 0]}}),a8=`uniform arcUniforms {
  bool greatCircle;
  bool useShortestPath;
  float numSegments;
  float widthScale;
  float widthMinPixels;
  float widthMaxPixels;
  highp int widthUnits;
} arc;
`,rwe={name:"arc",vs:a8,fs:a8,uniformTypes:{greatCircle:"f32",useShortestPath:"f32",numSegments:"f32",widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",widthUnits:"i32"}},nwe=`#version 300 es
#define SHADER_NAME arc-layer-vertex-shader
in vec4 instanceSourceColors;
in vec4 instanceTargetColors;
in vec3 instanceSourcePositions;
in vec3 instanceSourcePositions64Low;
in vec3 instanceTargetPositions;
in vec3 instanceTargetPositions64Low;
in vec3 instancePickingColors;
in float instanceWidths;
in float instanceHeights;
in float instanceTilts;
out vec4 vColor;
out vec2 uv;
out float isValid;
float paraboloid(float distance, float sourceZ, float targetZ, float ratio) {
float deltaZ = targetZ - sourceZ;
float dh = distance * instanceHeights;
if (dh == 0.0) {
return sourceZ + deltaZ * ratio;
}
float unitZ = deltaZ / dh;
float p2 = unitZ * unitZ + 1.0;
float dir = step(deltaZ, 0.0);
float z0 = mix(sourceZ, targetZ, dir);
float r = mix(ratio, 1.0 - ratio, dir);
return sqrt(r * (p2 - r)) * dh + z0;
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {
vec2 dir_screenspace = normalize(line_clipspace * project.viewportSize);
dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
return dir_screenspace * offset_direction * width / 2.0;
}
float getSegmentRatio(float index) {
return smoothstep(0.0, 1.0, index / (arc.numSegments - 1.0));
}
vec3 interpolateFlat(vec3 source, vec3 target, float segmentRatio) {
float distance = length(source.xy - target.xy);
float z = paraboloid(distance, source.z, target.z, segmentRatio);
float tiltAngle = radians(instanceTilts);
vec2 tiltDirection = normalize(target.xy - source.xy);
vec2 tilt = vec2(-tiltDirection.y, tiltDirection.x) * z * sin(tiltAngle);
return vec3(
mix(source.xy, target.xy, segmentRatio) + tilt,
z * cos(tiltAngle)
);
}
float getAngularDist (vec2 source, vec2 target) {
vec2 sourceRadians = radians(source);
vec2 targetRadians = radians(target);
vec2 sin_half_delta = sin((sourceRadians - targetRadians) / 2.0);
vec2 shd_sq = sin_half_delta * sin_half_delta;
float a = shd_sq.y + cos(sourceRadians.y) * cos(targetRadians.y) * shd_sq.x;
return 2.0 * asin(sqrt(a));
}
vec3 interpolateGreatCircle(vec3 source, vec3 target, vec3 source3D, vec3 target3D, float angularDist, float t) {
vec2 lngLat;
if(abs(angularDist - PI) < 0.001) {
lngLat = (1.0 - t) * source.xy + t * target.xy;
} else {
float a = sin((1.0 - t) * angularDist);
float b = sin(t * angularDist);
vec3 p = source3D.yxz * a + target3D.yxz * b;
lngLat = degrees(vec2(atan(p.y, -p.x), atan(p.z, length(p.xy))));
}
float z = paraboloid(angularDist * EARTH_RADIUS, source.z, target.z, t);
return vec3(lngLat, z);
}
void main(void) {
geometry.worldPosition = instanceSourcePositions;
geometry.worldPositionAlt = instanceTargetPositions;
float segmentIndex = float(gl_VertexID / 2);
float segmentSide = mod(float(gl_VertexID), 2.) == 0. ? -1. : 1.;
float segmentRatio = getSegmentRatio(segmentIndex);
float prevSegmentRatio = getSegmentRatio(max(0.0, segmentIndex - 1.0));
float nextSegmentRatio = getSegmentRatio(min(arc.numSegments - 1.0, segmentIndex + 1.0));
float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
isValid = 1.0;
uv = vec2(segmentRatio, segmentSide);
geometry.uv = uv;
geometry.pickingColor = instancePickingColors;
vec4 curr;
vec4 next;
vec3 source;
vec3 target;
if ((arc.greatCircle || project.projectionMode == PROJECTION_MODE_GLOBE) && project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
source = project_globe_(vec3(instanceSourcePositions.xy, 0.0));
target = project_globe_(vec3(instanceTargetPositions.xy, 0.0));
float angularDist = getAngularDist(instanceSourcePositions.xy, instanceTargetPositions.xy);
vec3 prevPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, prevSegmentRatio);
vec3 currPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, segmentRatio);
vec3 nextPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, nextSegmentRatio);
if (abs(currPos.x - prevPos.x) > 180.0) {
indexDir = -1.0;
isValid = 0.0;
} else if (abs(currPos.x - nextPos.x) > 180.0) {
indexDir = 1.0;
isValid = 0.0;
}
nextPos = indexDir < 0.0 ? prevPos : nextPos;
nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;
if (isValid == 0.0) {
nextPos.x += nextPos.x > 0.0 ? -360.0 : 360.0;
float t = ((currPos.x > 0.0 ? 180.0 : -180.0) - currPos.x) / (nextPos.x - currPos.x);
currPos = mix(currPos, nextPos, t);
segmentRatio = mix(segmentRatio, nextSegmentRatio, t);
}
vec3 currPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, segmentRatio);
vec3 nextPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, nextSegmentRatio);
curr = project_position_to_clipspace(currPos, currPos64Low, vec3(0.0), geometry.position);
next = project_position_to_clipspace(nextPos, nextPos64Low, vec3(0.0));
} else {
vec3 source_world = instanceSourcePositions;
vec3 target_world = instanceTargetPositions;
if (arc.useShortestPath) {
source_world.x = mod(source_world.x + 180., 360.0) - 180.;
target_world.x = mod(target_world.x + 180., 360.0) - 180.;
float deltaLng = target_world.x - source_world.x;
if (deltaLng > 180.) target_world.x -= 360.;
if (deltaLng < -180.) source_world.x -= 360.;
}
source = project_position(source_world, instanceSourcePositions64Low);
target = project_position(target_world, instanceTargetPositions64Low);
float antiMeridianX = 0.0;
if (arc.useShortestPath) {
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
antiMeridianX = -(project.coordinateOrigin.x + 180.) / 360. * TILE_SIZE;
}
float thresholdRatio = (antiMeridianX - source.x) / (target.x - source.x);
if (prevSegmentRatio <= thresholdRatio && nextSegmentRatio > thresholdRatio) {
isValid = 0.0;
indexDir = sign(segmentRatio - thresholdRatio);
segmentRatio = thresholdRatio;
}
}
nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;
vec3 currPos = interpolateFlat(source, target, segmentRatio);
vec3 nextPos = interpolateFlat(source, target, nextSegmentRatio);
if (arc.useShortestPath) {
if (nextPos.x < antiMeridianX) {
currPos.x += TILE_SIZE;
nextPos.x += TILE_SIZE;
}
}
curr = project_common_position_to_clipspace(vec4(currPos, 1.0));
next = project_common_position_to_clipspace(vec4(nextPos, 1.0));
geometry.position = vec4(currPos, 1.0);
}
float widthPixels = clamp(
project_size_to_pixel(instanceWidths * arc.widthScale, arc.widthUnits),
arc.widthMinPixels, arc.widthMaxPixels
);
vec3 offset = vec3(
getExtrusionOffset((next.xy - curr.xy) * indexDir, segmentSide, widthPixels),
0.0);
DECKGL_FILTER_SIZE(offset, geometry);
DECKGL_FILTER_GL_POSITION(curr, geometry);
gl_Position = curr + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);
vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio);
vColor = vec4(color.rgb, color.a * layer.opacity);
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,iwe=`#version 300 es
#define SHADER_NAME arc-layer-fragment-shader
precision highp float;
in vec4 vColor;
in vec2 uv;
in float isValid;
out vec4 fragColor;
void main(void) {
if (isValid == 0.0) {
discard;
}
fragColor = vColor;
geometry.uv = uv;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,JC=[0,0,0,255],swe={getSourcePosition:{type:"accessor",value:r=>r.sourcePosition},getTargetPosition:{type:"accessor",value:r=>r.targetPosition},getSourceColor:{type:"accessor",value:JC},getTargetColor:{type:"accessor",value:JC},getWidth:{type:"accessor",value:1},getHeight:{type:"accessor",value:1},getTilt:{type:"accessor",value:0},greatCircle:!1,numSegments:{type:"number",value:50,min:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class NO extends oo{getBounds(){return this.getAttributeManager()?.getBounds(["instanceSourcePositions","instanceTargetPositions"])}getShaders(){return super.getShaders({vs:nwe,fs:iwe,modules:[$s,Ja,rwe]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceSourceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getSourceColor",defaultValue:JC},instanceTargetColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getTargetColor",defaultValue:JC},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1},instanceHeights:{size:1,transition:!0,accessor:"getHeight",defaultValue:1},instanceTilts:{size:1,transition:!0,accessor:"getTilt",defaultValue:0}})}updateState(e){super.updateState(e),e.changeFlags.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){const{widthUnits:t,widthScale:n,widthMinPixels:i,widthMaxPixels:s,greatCircle:a,wrapLongitude:o,numSegments:u}=this.props,f={numSegments:u,widthUnits:Go[t],widthScale:n,widthMinPixels:i,widthMaxPixels:s,greatCircle:a,useShortestPath:o},g=this.state.model;g.shaderInputs.setProps({arc:f}),g.setVertexCount(u*2),g.draw(this.context.renderPass)}_getModel(){return new Mi(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),topology:"triangle-strip",isInstanced:!0})}}NO.layerName="ArcLayer";NO.defaultProps=swe;const owe=new Uint32Array([0,2,1,0,3,2]),awe=new Float32Array([0,1,0,0,1,0,1,1]);function lwe(r,e){if(!e)return cwe(r);const t=Math.max(Math.abs(r[0][0]-r[3][0]),Math.abs(r[1][0]-r[2][0])),n=Math.max(Math.abs(r[1][1]-r[0][1]),Math.abs(r[2][1]-r[3][1])),i=Math.ceil(t/e)+1,s=Math.ceil(n/e)+1,a=(i-1)*(s-1)*6,o=new Uint32Array(a),u=new Float32Array(i*s*2),f=new Float64Array(i*s*3);let g=0,y=0;for(let A=0;A<i;A++){const C=A/(i-1);for(let M=0;M<s;M++){const k=M/(s-1),D=uwe(r,C,k);f[g*3+0]=D[0],f[g*3+1]=D[1],f[g*3+2]=D[2]||0,u[g*2+0]=C,u[g*2+1]=1-k,A>0&&M>0&&(o[y++]=g-s,o[y++]=g-s-1,o[y++]=g-1,o[y++]=g-s,o[y++]=g-1,o[y++]=g),g++}}return{vertexCount:a,positions:f,indices:o,texCoords:u}}function cwe(r){const e=new Float64Array(12);for(let t=0;t<r.length;t++)e[t*3+0]=r[t][0],e[t*3+1]=r[t][1],e[t*3+2]=r[t][2]||0;return{vertexCount:6,positions:e,indices:owe,texCoords:awe}}function uwe(r,e,t){return Hu(Hu(r[0],r[1],t),Hu(r[3],r[2],t),e)}const l8=`uniform bitmapUniforms {
  vec4 bounds;
  float coordinateConversion;
  float desaturate;
  vec3 tintColor;
  vec4 transparentColor;
} bitmap;
`,hwe={name:"bitmap",vs:l8,fs:l8,uniformTypes:{bounds:"vec4<f32>",coordinateConversion:"f32",desaturate:"f32",tintColor:"vec3<f32>",transparentColor:"vec4<f32>"}},dwe=`#version 300 es
#define SHADER_NAME bitmap-layer-vertex-shader

in vec2 texCoords;
in vec3 positions;
in vec3 positions64Low;

out vec2 vTexCoord;
out vec2 vTexPos;

const vec3 pickingColor = vec3(1.0, 0.0, 0.0);

void main(void) {
  geometry.worldPosition = positions;
  geometry.uv = texCoords;
  geometry.pickingColor = pickingColor;

  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTexCoord = texCoords;

  if (bitmap.coordinateConversion < -0.5) {
    vTexPos = geometry.position.xy + project.commonOrigin.xy;
  } else if (bitmap.coordinateConversion > 0.5) {
    vTexPos = geometry.worldPosition.xy;
  }

  vec4 color = vec4(0.0);
  DECKGL_FILTER_COLOR(color, geometry);
}
`,fwe=`
vec3 packUVsIntoRGB(vec2 uv) {
  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction
  vec2 uv8bit = floor(uv * 256.);

  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits
  // Scale and clamp to 0-1 range
  vec2 uvFraction = fract(uv * 256.);
  vec2 uvFraction4bit = floor(uvFraction * 16.);

  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates
  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;

  return vec3(uv8bit, fractions) / 255.;
}
`,pwe=`#version 300 es
#define SHADER_NAME bitmap-layer-fragment-shader

#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D bitmapTexture;

in vec2 vTexCoord;
in vec2 vTexPos;

out vec4 fragColor;

/* projection utils */
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / PI / 2.0;

// from degrees to Web Mercator
vec2 lnglat_to_mercator(vec2 lnglat) {
  float x = lnglat.x;
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// from Web Mercator to degrees
vec2 mercator_to_lnglat(vec2 xy) {
  xy /= WORLD_SCALE;
  return degrees(vec2(
    xy.x - PI,
    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5
  ));
}
/* End projection utils */

// apply desaturation
vec3 color_desaturate(vec3 color) {
  float luminance = (color.r + color.g + color.b) * 0.333333333;
  return mix(color, vec3(luminance), bitmap.desaturate);
}

// apply tint
vec3 color_tint(vec3 color) {
  return color * bitmap.tintColor;
}

// blend with background color
vec4 apply_opacity(vec3 color, float alpha) {
  if (bitmap.transparentColor.a == 0.0) {
    return vec4(color, alpha);
  }
  float blendedAlpha = alpha + bitmap.transparentColor.a * (1.0 - alpha);
  float highLightRatio = alpha / blendedAlpha;
  vec3 blendedRGB = mix(bitmap.transparentColor.rgb, color, highLightRatio);
  return vec4(blendedRGB, blendedAlpha);
}

vec2 getUV(vec2 pos) {
  return vec2(
    (pos.x - bitmap.bounds[0]) / (bitmap.bounds[2] - bitmap.bounds[0]),
    (pos.y - bitmap.bounds[3]) / (bitmap.bounds[1] - bitmap.bounds[3])
  );
}

${fwe}

void main(void) {
  vec2 uv = vTexCoord;
  if (bitmap.coordinateConversion < -0.5) {
    vec2 lnglat = mercator_to_lnglat(vTexPos);
    uv = getUV(lnglat);
  } else if (bitmap.coordinateConversion > 0.5) {
    vec2 commonPos = lnglat_to_mercator(vTexPos);
    uv = getUV(commonPos);
  }
  vec4 bitmapColor = texture(bitmapTexture, uv);

  fragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * layer.opacity);

  geometry.uv = uv;
  DECKGL_FILTER_COLOR(fragColor, geometry);

  if (bool(picking.isActive) && !bool(picking.isAttribute)) {
    // Since instance information is not used, we can use picking color for pixel index
    fragColor.rgb = packUVsIntoRGB(uv);
  }
}
`,gwe={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:Pr.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0,value:null}};class VS extends oo{getShaders(){return super.getShaders({vs:dwe,fs:pwe,modules:[$s,Ja,hwe]})}initializeState(){const e=this.getAttributeManager();e.remove(["instancePickingColors"]);const t=!0;e.add({indices:{size:1,isIndexed:!0,update:n=>n.value=this.state.mesh.indices,noAlloc:t},positions:{size:3,type:"float64",fp64:this.use64bitPositions(),update:n=>n.value=this.state.mesh.positions,noAlloc:t},texCoords:{size:2,update:n=>n.value=this.state.mesh.texCoords,noAlloc:t}})}updateState({props:e,oldProps:t,changeFlags:n}){const i=this.getAttributeManager();if(n.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),i.invalidateAll()),e.bounds!==t.bounds){const s=this.state.mesh,a=this._createMesh();this.state.model.setVertexCount(a.vertexCount);for(const o in a)s&&s[o]!==a[o]&&i.invalidate(o);this.setState({mesh:a,...this._getCoordinateUniforms()})}else e._imageCoordinateSystem!==t._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(e){const{image:t}=this.props,n=e.info;if(!n.color||!t)return n.bitmap=null,n;const{width:i,height:s}=t;n.index=0;const a=mwe(n.color);return n.bitmap={size:{width:i,height:s},uv:a,pixel:[Math.floor(a[0]*i),Math.floor(a[1]*s)]},n}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight({...e,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:e}=this.props;let t=e;return c8(e)&&(t=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),lwe(t,this.context.viewport.resolution)}_getModel(){return new Mi(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),topology:"triangle-list",isInstanced:!1})}draw(e){const{shaderModuleProps:t}=e,{model:n,coordinateConversion:i,bounds:s,disablePicking:a}=this.state,{image:o,desaturate:u,transparentColor:f,tintColor:g}=this.props;if(!(t.picking.isActive&&a)&&o&&n){const y={bitmapTexture:o,bounds:s,coordinateConversion:i,desaturate:u,tintColor:g.slice(0,3).map(A=>A/255),transparentColor:f.map(A=>A/255)};n.shaderInputs.setProps({bitmap:y}),n.draw(this.context.renderPass)}}_getCoordinateUniforms(){const{LNGLAT:e,CARTESIAN:t,DEFAULT:n}=Pr;let{_imageCoordinateSystem:i}=this.props;if(i!==n){const{bounds:s}=this.props;if(!c8(s))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const a=this.context.viewport.resolution?e:t;if(i=i===e?e:t,i===e&&a===t)return{coordinateConversion:-1,bounds:s};if(i===t&&a===e){const o=Jc([s[0],s[1]]),u=Jc([s[2],s[3]]);return{coordinateConversion:1,bounds:[o[0],o[1],u[0],u[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}VS.layerName="BitmapLayer";VS.defaultProps=gwe;function mwe(r){const[e,t,n]=r,i=(n&240)/256,s=(n&15)/16;return[(e+s)/256,(t+i)/256]}function c8(r){return Number.isFinite(r[0])}const u8=`uniform iconUniforms {
  float sizeScale;
  vec2 iconsTextureDim;
  float sizeBasis;
  float sizeMinPixels;
  float sizeMaxPixels;
  bool billboard;
  highp int sizeUnits;
  float alphaCutoff;
} icon;
`,ywe={name:"icon",vs:u8,fs:u8,uniformTypes:{sizeScale:"f32",iconsTextureDim:"vec2<f32>",sizeBasis:"f32",sizeMinPixels:"f32",sizeMaxPixels:"f32",billboard:"f32",sizeUnits:"i32",alphaCutoff:"f32"}},bwe=`#version 300 es
#define SHADER_NAME icon-layer-vertex-shader
in vec2 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceSizes;
in float instanceAngles;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec4 instanceIconFrames;
in float instanceColorModes;
in vec2 instanceOffsets;
in vec2 instancePixelOffset;
out float vColorMode;
out vec4 vColor;
out vec2 vTextureCoords;
out vec2 uv;
vec2 rotate_by_angle(vec2 vertex, float angle) {
float angle_radian = angle * PI / 180.0;
float cos_angle = cos(angle_radian);
float sin_angle = sin(angle_radian);
mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
return rotationMatrix * vertex;
}
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = positions;
geometry.pickingColor = instancePickingColors;
uv = positions;
vec2 iconSize = instanceIconFrames.zw;
float sizePixels = clamp(
project_size_to_pixel(instanceSizes * icon.sizeScale, icon.sizeUnits),
icon.sizeMinPixels, icon.sizeMaxPixels
);
float iconConstraint = icon.sizeBasis == 0.0 ? iconSize.x : iconSize.y;
float instanceScale = iconConstraint == 0.0 ? 0.0 : sizePixels / iconConstraint;
vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
pixelOffset += instancePixelOffset;
pixelOffset.y *= -1.0;
if (icon.billboard)  {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = vec3(pixelOffset, 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
DECKGL_FILTER_SIZE(offset_common, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vTextureCoords = mix(
instanceIconFrames.xy,
instanceIconFrames.xy + iconSize,
(positions.xy + 1.0) / 2.0
) / icon.iconsTextureDim;
vColor = instanceColors;
DECKGL_FILTER_COLOR(vColor, geometry);
vColorMode = instanceColorModes;
}
`,_we=`#version 300 es
#define SHADER_NAME icon-layer-fragment-shader
precision highp float;
uniform sampler2D iconsTexture;
in float vColorMode;
in vec4 vColor;
in vec2 vTextureCoords;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
vec4 texColor = texture(iconsTexture, vTextureCoords);
vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
float a = texColor.a * layer.opacity * vColor.a;
if (a < icon.alphaCutoff) {
discard;
}
fragColor = vec4(color, a);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,vwe=1024,Awe=4,h8=()=>{},d8={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},xwe={x:0,y:0,width:0,height:0};function wwe(r){return Math.pow(2,Math.ceil(Math.log2(r)))}function Cwe(r,e,t,n){const i=Math.min(t/e.width,n/e.height),s=Math.floor(e.width*i),a=Math.floor(e.height*i);return i===1?{image:e,width:s,height:a}:(r.canvas.height=a,r.canvas.width=s,r.clearRect(0,0,s,a),r.drawImage(e,0,0,e.width,e.height,0,0,s,a),{image:r.canvas,width:s,height:a})}function J_(r){return r&&(r.id||r.url)}function Twe(r,e,t,n){const{width:i,height:s,device:a}=r,o=a.createTexture({format:"rgba8unorm",width:e,height:t,sampler:n,mipLevels:a.getMipLevelCount(e,t)}),u=a.createCommandEncoder();return u.copyTextureToTexture({sourceTexture:r,destinationTexture:o,width:i,height:s}),u.finish(),o.generateMipmapsWebGL(),r.destroy(),o}function f8(r,e,t){for(let n=0;n<e.length;n++){const{icon:i,xOffset:s}=e[n],a=J_(i);r[a]={...i,x:s,y:t}}}function Swe({icons:r,buffer:e,mapping:t={},xOffset:n=0,yOffset:i=0,rowHeight:s=0,canvasWidth:a}){let o=[];for(let u=0;u<r.length;u++){const f=r[u],g=J_(f);if(!t[g]){const{height:y,width:A}=f;n+A+e>a&&(f8(t,o,i),n=0,i=s+i+e,s=0,o=[]),o.push({icon:f,xOffset:n}),n=n+A+e,s=Math.max(s,y)}}return o.length>0&&f8(t,o,i),{mapping:t,rowHeight:s,xOffset:n,yOffset:i,canvasWidth:a,canvasHeight:wwe(s+i+e)}}function Ewe(r,e,t){if(!r||!e)return null;t=t||{};const n={},{iterable:i,objectInfo:s}=Sd(r);for(const a of i){s.index++;const o=e(a,s),u=J_(o);if(!o)throw new Error("Icon is missing.");if(!o.url)throw new Error("Icon url is missing.");!n[u]&&(!t[u]||o.url!==t[u].url)&&(n[u]={...o,source:a,sourceIndex:s.index})}return n}class Iwe{constructor(e,{onUpdate:t=h8,onError:n=h8}){this._loadOptions=null,this._texture=null,this._externalTexture=null,this._mapping={},this._samplerParameters=null,this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=Awe,this._canvasWidth=vwe,this._canvasHeight=0,this._canvas=null,this.device=e,this.onUpdate=t,this.onError=n}finalize(){this._texture?.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const t=this._autoPacking?J_(e):e;return this._mapping[t]||xwe}setProps({loadOptions:e,autoPacking:t,iconAtlas:n,iconMapping:i,textureParameters:s}){e&&(this._loadOptions=e),t!==void 0&&(this._autoPacking=t),i&&(this._mapping=i),n&&(this._texture?.delete(),this._texture=null,this._externalTexture=n),s&&(this._samplerParameters=s)}get isLoaded(){return this._pendingCount===0}packIcons(e,t){if(!this._autoPacking||typeof document>"u")return;const n=Object.values(Ewe(e,t,this._mapping)||{});if(n.length>0){const{mapping:i,xOffset:s,yOffset:a,rowHeight:o,canvasHeight:u}=Swe({icons:n,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=o,this._mapping=i,this._xOffset=s,this._yOffset=a,this._canvasHeight=u,this._texture||(this._texture=this.device.createTexture({format:"rgba8unorm",data:null,width:this._canvasWidth,height:this._canvasHeight,sampler:this._samplerParameters||d8,mipLevels:this.device.getMipLevelCount(this._canvasWidth,this._canvasHeight)})),this._texture.height!==this._canvasHeight&&(this._texture=Twe(this._texture,this._canvasWidth,this._canvasHeight,this._samplerParameters||d8)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(n),this._texture?.generateMipmapsWebGL()}}_loadIcons(e){const t=this._canvas.getContext("2d",{willReadFrequently:!0});for(const n of e)this._pendingCount++,Yu(n.url,this._loadOptions).then(i=>{const s=J_(n),a=this._mapping[s],{x:o,y:u,width:f,height:g}=a,{image:y,width:A,height:C}=Cwe(t,i,f,g);this._texture?.copyExternalImage({image:y,x:o+(f-A)/2,y:u+(g-C)/2,width:A,height:C}),a.width=A,a.height=C,this._texture?.generateMipmapsWebGL(),this.onUpdate()}).catch(i=>{this.onError({url:n.url,source:n.source,sourceIndex:n.sourceIndex,loadOptions:this._loadOptions,error:i})}).finally(()=>{this._pendingCount--})}}const CX=[0,0,0,255],Pwe={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeBasis:"height",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:r=>r.position},getIcon:{type:"accessor",value:r=>r.icon},getColor:{type:"accessor",value:CX},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0,value:null}};class Yv extends oo{getShaders(){return super.getShaders({vs:bwe,fs:_we,modules:[$s,Ja,ywe]})}initializeState(){this.state={iconManager:new Iwe(this.context.device,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:"uint8",accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:CX},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:t,oldProps:n,changeFlags:i}=e,s=this.getAttributeManager(),{iconAtlas:a,iconMapping:o,data:u,getIcon:f,textureParameters:g}=t,{iconManager:y}=this.state;if(typeof a=="string")return;const A=a||this.internalState.isAsyncPropLoading("iconAtlas");y.setProps({loadOptions:t.loadOptions,autoPacking:!A,iconAtlas:a,iconMapping:A?o:null,textureParameters:g}),A?n.iconMapping!==t.iconMapping&&s.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&y.packIcons(u,f),i.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),s.invalidateAll())}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:t,sizeBasis:n,sizeMinPixels:i,sizeMaxPixels:s,sizeUnits:a,billboard:o,alphaCutoff:u}=this.props,{iconManager:f}=this.state,g=f.getTexture();if(g){const y=this.state.model,A={iconsTexture:g,iconsTextureDim:[g.width,g.height],sizeUnits:Go[a],sizeScale:t,sizeBasis:n==="height"?1:0,sizeMinPixels:i,sizeMaxPixels:s,billboard:o,alphaCutoff:u};y.shaderInputs.setProps({icon:A}),y.draw(this.context.renderPass)}}_getModel(){const e=[-1,-1,1,-1,-1,1,1,1];return new Mi(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new To({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array(e)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){const t=this.getCurrentLayer()?.props.onIconError;t?t(e):Rr.error(e.error.message)()}getInstanceOffset(e){const{width:t,height:n,anchorX:i=t/2,anchorY:s=n/2}=this.state.iconManager.getIconMapping(e);return[t/2-i,n/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:t,y:n,width:i,height:s}=this.state.iconManager.getIconMapping(e);return[t,n,i,s]}}Yv.defaultProps=Pwe;Yv.layerName="IconLayer";const Bwe=`struct LineUniforms {
  widthScale: f32,
  widthMinPixels: f32,
  widthMaxPixels: f32,
  useShortestPath: f32,
  widthUnits: i32,
};

@group(0) @binding(1)
var<uniform> line: LineUniforms;
`,p8=`uniform lineUniforms {
  float widthScale;
  float widthMinPixels;
  float widthMaxPixels;
  float useShortestPath;
  highp int widthUnits;
} line;
`,Mwe={name:"line",source:Bwe,vs:p8,fs:p8,uniformTypes:{widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",useShortestPath:"f32",widthUnits:"i32"}},Rwe=`// ---------- Helper Structures & Functions ----------

// Placeholder filter functions.
fn deckgl_filter_size(offset: vec3<f32>, geometry: Geometry) -> vec3<f32> {
  return offset;
}
fn deckgl_filter_gl_position(p: vec4<f32>, geometry: Geometry) -> vec4<f32> {
  return p;
}
fn deckgl_filter_color(color: vec4<f32>, geometry: Geometry) -> vec4<f32> {
  return color;
}

// Compute an extrusion offset given a line direction (in clipspace),
// an offset direction (-1 or 1), and a width in pixels.
// Assumes a uniform "project" with a viewportSize field is available.
fn getExtrusionOffset(line_clipspace: vec2<f32>, offset_direction: f32, width: f32) -> vec2<f32> {
  // project.viewportSize should be provided as a uniform (not shown here)
  let dir_screenspace = normalize(line_clipspace * project.viewportSize);
  // Rotate by 90: (x,y) becomes (-y,x)
  let rotated = vec2<f32>(-dir_screenspace.y, dir_screenspace.x);
  return rotated * offset_direction * width / 2.0;
}

// Splits the line between two points at a given x coordinate.
// Interpolates the y and z components.
fn splitLine(a: vec3<f32>, b: vec3<f32>, x: f32) -> vec3<f32> {
  let t: f32 = (x - a.x) / (b.x - a.x);
  return vec3<f32>(x, a.yz + t * (b.yz - a.yz));
}

// ---------- Uniforms & Global Structures ----------

// Uniforms for line, color, and project are assumed to be defined elsewhere.
// For example:
//
// @group(0) @binding(0)
// var<uniform> line: LineUniform;
//
// struct ColorUniform {
//   opacity: f32,
// };
// @group(0) @binding(1)
// var<uniform> color: ColorUniform;
//
// struct ProjectUniform {
//   viewportSize: vec2<f32>,
// };
// @group(0) @binding(2)
// var<uniform> project: ProjectUniform;



// ---------- Vertex Output Structure ----------

struct Varyings {
  @builtin(position) gl_Position: vec4<f32>,
  @location(0) vColor: vec4<f32>,
  @location(1) uv: vec2<f32>,
};

// ---------- Vertex Shader Entry Point ----------

@vertex
fn vertexMain(
  @location(0) positions: vec3<f32>,
  @location(1) instanceSourcePositions: vec3<f32>,
  @location(2) instanceTargetPositions: vec3<f32>,
  @location(3) instanceSourcePositions64Low: vec3<f32>,
  @location(4) instanceTargetPositions64Low: vec3<f32>,
  @location(5) instanceColors: vec4<f32>,
  @location(6) instancePickingColors: vec3<f32>,
  @location(7) instanceWidths: f32
) -> Varyings {
  var geometry: Geometry;
  geometry.worldPosition = instanceSourcePositions;
  geometry.worldPositionAlt = instanceTargetPositions;

  var source_world: vec3<f32> = instanceSourcePositions;
  var target_world: vec3<f32> = instanceTargetPositions;
  var source_world_64low: vec3<f32> = instanceSourcePositions64Low;
  var target_world_64low: vec3<f32> = instanceTargetPositions64Low;

  // Apply shortest-path adjustments if needed.
  if (line.useShortestPath > 0.5 || line.useShortestPath < -0.5) {
    source_world.x = (source_world.x + 180.0 % 360.0) - 180.0;
    target_world.x = (target_world.x + 180.0 % 360.0) - 180.0;
    let deltaLng: f32 = target_world.x - source_world.x;

    if (deltaLng * line.useShortestPath > 180.0) {
      source_world.x = source_world.x + 360.0 * line.useShortestPath;
      source_world = splitLine(source_world, target_world, 180.0 * line.useShortestPath);
      source_world_64low = vec3<f32>(0.0, 0.0, 0.0);
    } else if (deltaLng * line.useShortestPath < -180.0) {
      target_world.x = target_world.x + 360.0 * line.useShortestPath;
      target_world = splitLine(source_world, target_world, 180.0 * line.useShortestPath);
      target_world_64low = vec3<f32>(0.0, 0.0, 0.0);
    } else if (line.useShortestPath < 0.0) {
      var abortOut: Varyings;
      abortOut.gl_Position = vec4<f32>(0.0);
      abortOut.vColor = vec4<f32>(0.0);
      abortOut.uv = vec2<f32>(0.0);
      return abortOut;
    }
  }

  // Project Pos and target positions to clip space.
  let sourceResult = project_position_to_clipspace_and_commonspace(source_world, source_world_64low, vec3<f32>(0.0));
  let targetResult = project_position_to_clipspace_and_commonspace(target_world, target_world_64low, vec3<f32>(0.0));
  let sourcePos: vec4<f32> = sourceResult.clipPosition;
  let targetPos: vec4<f32> = targetResult.clipPosition;
  let source_commonspace: vec4<f32> = sourceResult.commonPosition;
  let target_commonspace: vec4<f32> = targetResult.commonPosition;

  // Interpolate along the line segment.
  let segmentIndex: f32 = positions.x;
  let p: vec4<f32> = sourcePos + segmentIndex * (targetPos - sourcePos);
  geometry.position = source_commonspace + segmentIndex * (target_commonspace - source_commonspace);
  let uv: vec2<f32> = positions.xy;
  geometry.uv = uv;
  geometry.pickingColor = instancePickingColors;

  // Determine width in pixels.
  let widthPixels: f32 = clamp(
    project_unit_size_to_pixel(instanceWidths * line.widthScale, line.widthUnits),
    line.widthMinPixels, line.widthMaxPixels
  );

  // Compute extrusion offset.
  let extrusion: vec2<f32> = getExtrusionOffset(targetPos.xy - sourcePos.xy, positions.y, widthPixels);
  let offset: vec3<f32> = vec3<f32>(extrusion, 0.0);

  // Apply deck.gl filter functions.
  let filteredOffset = deckgl_filter_size(offset, geometry);
  let filteredP = deckgl_filter_gl_position(p, geometry);

  let clipOffset: vec2<f32> = project_pixel_size_to_clipspace(filteredOffset.xy);
  let finalPosition: vec4<f32> = filteredP + vec4<f32>(clipOffset, 0.0, 0.0);

  // Compute color.
  var vColor: vec4<f32> = vec4<f32>(instanceColors.rgb, instanceColors.a * color.opacity);
  // vColor = deckgl_filter_color(vColor, geometry);

  var output: Varyings;
  output.gl_Position = finalPosition;
  output.vColor = vColor;
  output.uv = uv;
  return output;
}

@fragment
fn fragmentMain(
  @location(0) vColor: vec4<f32>,
  @location(1) uv: vec2<f32>
) -> @location(0) vec4<f32> {
  // Create and initialize geometry with the provided uv.
  var geometry: Geometry;
  geometry.uv = uv;

  // Start with the input color.
  var fragColor: vec4<f32> = vColor;

  // Apply the deck.gl filter to the color.
  fragColor = deckgl_filter_color(fragColor, geometry);

  // Apply premultiplied alpha as required by transparent canvas
  fragColor = deckgl_premultiplied_alpha(fragColor);

  return fragColor;
}
`,kwe=`#version 300 es
#define SHADER_NAME line-layer-vertex-shader
in vec3 positions;
in vec3 instanceSourcePositions;
in vec3 instanceTargetPositions;
in vec3 instanceSourcePositions64Low;
in vec3 instanceTargetPositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in float instanceWidths;
out vec4 vColor;
out vec2 uv;
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {
vec2 dir_screenspace = normalize(line_clipspace * project.viewportSize);
dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
return dir_screenspace * offset_direction * width / 2.0;
}
vec3 splitLine(vec3 a, vec3 b, float x) {
float t = (x - a.x) / (b.x - a.x);
return vec3(x, mix(a.yz, b.yz, t));
}
void main(void) {
geometry.worldPosition = instanceSourcePositions;
geometry.worldPositionAlt = instanceTargetPositions;
vec3 source_world = instanceSourcePositions;
vec3 target_world = instanceTargetPositions;
vec3 source_world_64low = instanceSourcePositions64Low;
vec3 target_world_64low = instanceTargetPositions64Low;
if (line.useShortestPath > 0.5 || line.useShortestPath < -0.5) {
source_world.x = mod(source_world.x + 180., 360.0) - 180.;
target_world.x = mod(target_world.x + 180., 360.0) - 180.;
float deltaLng = target_world.x - source_world.x;
if (deltaLng * line.useShortestPath > 180.) {
source_world.x += 360. * line.useShortestPath;
source_world = splitLine(source_world, target_world, 180. * line.useShortestPath);
source_world_64low = vec3(0.0);
} else if (deltaLng * line.useShortestPath < -180.) {
target_world.x += 360. * line.useShortestPath;
target_world = splitLine(source_world, target_world, 180. * line.useShortestPath);
target_world_64low = vec3(0.0);
} else if (line.useShortestPath < 0.) {
gl_Position = vec4(0.);
return;
}
}
vec4 source_commonspace;
vec4 target_commonspace;
vec4 source = project_position_to_clipspace(source_world, source_world_64low, vec3(0.), source_commonspace);
vec4 target = project_position_to_clipspace(target_world, target_world_64low, vec3(0.), target_commonspace);
float segmentIndex = positions.x;
vec4 p = mix(source, target, segmentIndex);
geometry.position = mix(source_commonspace, target_commonspace, segmentIndex);
uv = positions.xy;
geometry.uv = uv;
geometry.pickingColor = instancePickingColors;
float widthPixels = clamp(
project_size_to_pixel(instanceWidths * line.widthScale, line.widthUnits),
line.widthMinPixels, line.widthMaxPixels
);
vec3 offset = vec3(
getExtrusionOffset(target.xy - source.xy, positions.y, widthPixels),
0.0);
DECKGL_FILTER_SIZE(offset, geometry);
DECKGL_FILTER_GL_POSITION(p, geometry);
gl_Position = p + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);
vColor = vec4(instanceColors.rgb, instanceColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Owe=`#version 300 es
#define SHADER_NAME line-layer-fragment-shader
precision highp float;
in vec4 vColor;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
fragColor = vColor;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,Dwe=[0,0,0,255],Lwe={getSourcePosition:{type:"accessor",value:r=>r.sourcePosition},getTargetPosition:{type:"accessor",value:r=>r.targetPosition},getColor:{type:"accessor",value:Dwe},getWidth:{type:"accessor",value:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class FO extends oo{getBounds(){return this.getAttributeManager()?.getBounds(["instanceSourcePositions","instanceTargetPositions"])}getShaders(){return super.getShaders({vs:kwe,fs:Owe,source:Rwe,modules:[$s,yO,Ja,Mwe]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1}})}updateState(e){super.updateState(e),e.changeFlags.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){const{widthUnits:t,widthScale:n,widthMinPixels:i,widthMaxPixels:s,wrapLongitude:a}=this.props,o=this.state.model,u={widthUnits:Go[t],widthScale:n,widthMinPixels:i,widthMaxPixels:s,useShortestPath:a?1:0};o.shaderInputs.setProps({line:u}),o.draw(this.context.renderPass),a&&(o.shaderInputs.setProps({line:{...u,useShortestPath:-1}}),o.draw(this.context.renderPass))}_getModel(){const e=this.context.device.type==="webgpu"?{depthWriteEnabled:!0,depthCompare:"less-equal"}:void 0,t=[0,-1,0,0,1,0,1,-1,0,1,1,0];return new Mi(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new To({topology:"triangle-strip",attributes:{positions:{size:3,value:new Float32Array(t)}}}),parameters:e,isInstanced:!0})}}FO.layerName="LineLayer";FO.defaultProps=Lwe;const Nwe=`struct PointCloudUniforms {
  radiusPixels: f32,
  sizeUnits: i32,
};

@group(0) @binding(3)
var<uniform> pointCloud: PointCloudUniforms;
`,g8=`uniform pointCloudUniforms {
  float radiusPixels;
  highp int sizeUnits;
} pointCloud;
`,Fwe={name:"pointCloud",source:Nwe,vs:g8,fs:g8,uniformTypes:{radiusPixels:"f32",sizeUnits:"i32"}},Uwe=`#version 300 es
#define SHADER_NAME point-cloud-layer-vertex-shader
in vec3 positions;
in vec3 instanceNormals;
in vec4 instanceColors;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec3 instancePickingColors;
out vec4 vColor;
out vec2 unitPosition;
void main(void) {
geometry.worldPosition = instancePositions;
geometry.normal = project_normal(instanceNormals);
unitPosition = positions.xy;
geometry.uv = unitPosition;
geometry.pickingColor = instancePickingColors;
vec3 offset = vec3(positions.xy * project_size_to_pixel(pointCloud.radiusPixels, pointCloud.sizeUnits), 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, instanceColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,zwe=`#version 300 es
#define SHADER_NAME point-cloud-layer-fragment-shader
precision highp float;
in vec4 vColor;
in vec2 unitPosition;
out vec4 fragColor;
void main(void) {
geometry.uv = unitPosition.xy;
float distToCenter = length(unitPosition);
if (distToCenter > 1.0) {
discard;
}
fragColor = vColor;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,Vwe=`struct ConstantAttributes {
  instanceNormals: vec3<f32>,
  instanceColors: vec4<f32>,
  instancePositions: vec3<f32>,
  instancePositions64Low: vec3<f32>,
  instancePickingColors: vec3<f32>
};

const constants = ConstantAttributes(
  vec3<f32>(1.0, 0.0, 0.0),
  vec4<f32>(0.0, 0.0, 0.0, 1.0),
  vec3<f32>(0.0),
  vec3<f32>(0.0),
  vec3<f32>(0.0)
);

struct Attributes {
  @builtin(instance_index) instanceIndex : u32,
  @builtin(vertex_index) vertexIndex : u32,
  @location(0) positions: vec3<f32>,
  @location(1) instancePositions: vec3<f32>,
  @location(2) instancePositions64Low: vec3<f32>,
  @location(3) instanceNormals: vec3<f32>,
  @location(4) instanceColors: vec4<f32>,
  @location(5) instancePickingColors: vec3<f32>
};

struct Varyings {
  @builtin(position) position: vec4<f32>,
  @location(0) vColor: vec4<f32>,
  @location(1) unitPosition: vec2<f32>,
};

@vertex
fn vertexMain(attributes: Attributes) -> Varyings {
  var varyings: Varyings;
  
  // var geometry: Geometry;
  // geometry.worldPosition = instancePositions;
  // geometry.normal = project_normal(instanceNormals);

  // position on the containing square in [-1, 1] space
  varyings.unitPosition = attributes.positions.xy;
  geometry.uv = varyings.unitPosition;
  geometry.pickingColor = attributes.instancePickingColors;

  // Find the center of the point and add the current vertex
  let offset = vec3<f32>(attributes.positions.xy * project_unit_size_to_pixel(pointCloud.radiusPixels, pointCloud.sizeUnits), 0.0);
  // DECKGL_FILTER_SIZE(offset, geometry);

  varyings.position = project_position_to_clipspace(attributes.instancePositions, attributes.instancePositions64Low, vec3<f32>(0.0)); // TODO , geometry.position);
  // DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  let clipPixels = project_pixel_size_to_clipspace(offset.xy);
  varyings.position.x += clipPixels.x;
  varyings.position.y += clipPixels.y;

  // Apply lighting
  let lightColor = lighting_getLightColor2(attributes.instanceColors.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);

  // Apply opacity to instance color, or return instance picking color
  varyings.vColor = vec4(lightColor, attributes.instanceColors.a * color.opacity);
  // DECKGL_FILTER_COLOR(vColor, geometry);

  return varyings;
}

@fragment
fn fragmentMain(varyings: Varyings) -> @location(0) vec4<f32> {
  // var geometry: Geometry;
  // geometry.uv = unitPosition.xy;

  let distToCenter = length(varyings.unitPosition);
  if (distToCenter > 1.0) {
    discard;
  }

  var fragColor: vec4<f32>;

  fragColor = varyings.vColor;
  // DECKGL_FILTER_COLOR(fragColor, geometry);

  // Apply premultiplied alpha as required by transparent canvas
  fragColor = deckgl_premultiplied_alpha(fragColor);

  return fragColor;
}
`,TX=[0,0,0,255],SX=[0,0,1],$we={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:r=>r.position},getNormal:{type:"accessor",value:SX},getColor:{type:"accessor",value:TX},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};function jwe(r){const{header:e,attributes:t}=r;if(!(!e||!t)&&(r.length=e.vertexCount,t.POSITION&&(t.instancePositions=t.POSITION),t.NORMAL&&(t.instanceNormals=t.NORMAL),t.COLOR_0)){const{size:n,value:i}=t.COLOR_0;t.instanceColors={size:n,type:"unorm8",value:i}}}class $S extends oo{getShaders(){return super.getShaders({vs:Uwe,fs:zwe,source:Vwe,modules:[$s,yO,LS,Ja,Fwe]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:SX},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:TX}})}updateState(e){const{changeFlags:t,props:n}=e;super.updateState(e),t.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll()),t.dataChanged&&jwe(n.data)}draw({uniforms:e}){const{pointSize:t,sizeUnits:n}=this.props,i=this.state.model,s={sizeUnits:Go[n],radiusPixels:t};i.shaderInputs.setProps({pointCloud:s}),this.context.device.type==="webgpu"&&(i.instanceCount=this.props.data.length),i.draw(this.context.renderPass)}_getModel(){const e=this.context.device.type==="webgpu"?{depthWriteEnabled:!0,depthCompare:"less-equal"}:void 0,t=[];for(let n=0;n<3;n++){const i=n/3*Math.PI*2;t.push(Math.cos(i)*2,Math.sin(i)*2,0)}return new Mi(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new To({topology:"triangle-list",attributes:{positions:new Float32Array(t)}}),parameters:e,isInstanced:!0})}}$S.layerName="PointCloudLayer";$S.defaultProps=$we;const m8=`uniform scatterplotUniforms {
  float radiusScale;
  float radiusMinPixels;
  float radiusMaxPixels;
  float lineWidthScale;
  float lineWidthMinPixels;
  float lineWidthMaxPixels;
  float stroked;
  float filled;
  bool antialiasing;
  bool billboard;
  highp int radiusUnits;
  highp int lineWidthUnits;
} scatterplot;
`,Gwe={name:"scatterplot",vs:m8,fs:m8,source:"",uniformTypes:{radiusScale:"f32",radiusMinPixels:"f32",radiusMaxPixels:"f32",lineWidthScale:"f32",lineWidthMinPixels:"f32",lineWidthMaxPixels:"f32",stroked:"f32",filled:"f32",antialiasing:"f32",billboard:"f32",radiusUnits:"i32",lineWidthUnits:"i32"}},Hwe=`#version 300 es
#define SHADER_NAME scatterplot-layer-vertex-shader
in vec3 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceRadius;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
out vec4 vFillColor;
out vec4 vLineColor;
out vec2 unitPosition;
out float innerUnitRadius;
out float outerRadiusPixels;
void main(void) {
geometry.worldPosition = instancePositions;
outerRadiusPixels = clamp(
project_size_to_pixel(scatterplot.radiusScale * instanceRadius, scatterplot.radiusUnits),
scatterplot.radiusMinPixels, scatterplot.radiusMaxPixels
);
float lineWidthPixels = clamp(
project_size_to_pixel(scatterplot.lineWidthScale * instanceLineWidths, scatterplot.lineWidthUnits),
scatterplot.lineWidthMinPixels, scatterplot.lineWidthMaxPixels
);
outerRadiusPixels += scatterplot.stroked * lineWidthPixels / 2.0;
float edgePadding = scatterplot.antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
unitPosition = edgePadding * positions.xy;
geometry.uv = unitPosition;
geometry.pickingColor = instancePickingColors;
innerUnitRadius = 1.0 - scatterplot.stroked * lineWidthPixels / outerRadiusPixels;
if (scatterplot.billboard) {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = edgePadding * positions * outerRadiusPixels;
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,Wwe=`#version 300 es
#define SHADER_NAME scatterplot-layer-fragment-shader
precision highp float;
in vec4 vFillColor;
in vec4 vLineColor;
in vec2 unitPosition;
in float innerUnitRadius;
in float outerRadiusPixels;
out vec4 fragColor;
void main(void) {
geometry.uv = unitPosition;
float distToCenter = length(unitPosition) * outerRadiusPixels;
float inCircle = scatterplot.antialiasing ?
smoothedge(distToCenter, outerRadiusPixels) :
step(distToCenter, outerRadiusPixels);
if (inCircle == 0.0) {
discard;
}
if (scatterplot.stroked > 0.5) {
float isLine = scatterplot.antialiasing ?
smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
step(innerUnitRadius * outerRadiusPixels, distToCenter);
if (scatterplot.filled > 0.5) {
fragColor = mix(vFillColor, vLineColor, isLine);
} else {
if (isLine == 0.0) {
discard;
}
fragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
}
} else if (scatterplot.filled < 0.5) {
discard;
} else {
fragColor = vFillColor;
}
fragColor.a *= inCircle;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,Kwe=`// Main shaders

struct ScatterplotUniforms {
  radiusScale: f32,
  radiusMinPixels: f32,
  radiusMaxPixels: f32,
  lineWidthScale: f32,
  lineWidthMinPixels: f32,
  lineWidthMaxPixels: f32,
  stroked: f32,
  filled: i32,
  antialiasing: i32,
  billboard: i32,
  radiusUnits: i32,
  lineWidthUnits: i32,
};

struct ConstantAttributeUniforms {
 instancePositions: vec3<f32>,
 instancePositions64Low: vec3<f32>,
 instanceRadius: f32,
 instanceLineWidths: f32,
 instanceFillColors: vec4<f32>,
 instanceLineColors: vec4<f32>,
 instancePickingColors: vec3<f32>,

 instancePositionsConstant: i32,
 instancePositions64LowConstant: i32,
 instanceRadiusConstant: i32,
 instanceLineWidthsConstant: i32,
 instanceFillColorsConstant: i32,
 instanceLineColorsConstant: i32,
 instancePickingColorsConstant: i32
};

@group(0) @binding(2) var<uniform> scatterplot: ScatterplotUniforms;

struct ConstantAttributes {
  instancePositions: vec3<f32>,
  instancePositions64Low: vec3<f32>,
  instanceRadius: f32,
  instanceLineWidths: f32,
  instanceFillColors: vec4<f32>,
  instanceLineColors: vec4<f32>,
  instancePickingColors: vec3<f32>
};

const constants = ConstantAttributes(
  vec3<f32>(0.0),
  vec3<f32>(0.0),
  0.0,
  0.0,
  vec4<f32>(0.0, 0.0, 0.0, 1.0),
  vec4<f32>(0.0, 0.0, 0.0, 1.0),
  vec3<f32>(0.0)
);

struct Attributes {
  @builtin(instance_index) instanceIndex : u32,
  @builtin(vertex_index) vertexIndex : u32,
  @location(0) positions: vec3<f32>,
  @location(1) instancePositions: vec3<f32>,
  @location(2) instancePositions64Low: vec3<f32>,
  @location(3) instanceRadius: f32,
  @location(4) instanceLineWidths: f32,
  @location(5) instanceFillColors: vec4<f32>,
  @location(6) instanceLineColors: vec4<f32>,
  @location(7) instancePickingColors: vec3<f32>
};

struct Varyings {
  @builtin(position) position: vec4<f32>,
  @location(0) vFillColor: vec4<f32>,
  @location(1) vLineColor: vec4<f32>,
  @location(2) unitPosition: vec2<f32>,
  @location(3) innerUnitRadius: f32,
  @location(4) outerRadiusPixels: f32,
};

@vertex
fn vertexMain(attributes: Attributes) -> Varyings {
  var varyings: Varyings;

  // Draw an inline geometry constant array clip space triangle to verify that rendering works.
  // var positions = array<vec2<f32>, 3>(vec2(0.0, 0.5), vec2(-0.5, -0.5), vec2(0.5, -0.5));
  // if (attributes.instanceIndex == 0) {
  //   varyings.position = vec4<f32>(positions[attributes.vertexIndex], 0.0, 1.0);
  //   return varyings;
  // }

  // var geometry: Geometry;
  // geometry.worldPosition = instancePositions;

  // Multiply out radius and clamp to limits
  varyings.outerRadiusPixels = clamp(
    project_unit_size_to_pixel(scatterplot.radiusScale * attributes.instanceRadius, scatterplot.radiusUnits),
    scatterplot.radiusMinPixels, scatterplot.radiusMaxPixels
  );

  // Multiply out line width and clamp to limits
  let lineWidthPixels = clamp(
    project_unit_size_to_pixel(scatterplot.lineWidthScale * attributes.instanceLineWidths, scatterplot.lineWidthUnits),
    scatterplot.lineWidthMinPixels, scatterplot.lineWidthMaxPixels
  );

  // outer radius needs to offset by half stroke width
  varyings.outerRadiusPixels += scatterplot.stroked * lineWidthPixels / 2.0;
  // Expand geometry to accommodate edge smoothing
  let edgePadding = select(
    (varyings.outerRadiusPixels + SMOOTH_EDGE_RADIUS) / varyings.outerRadiusPixels,
    1.0,
    scatterplot.antialiasing != 0
  );

  // position on the containing square in [-1, 1] space
  varyings.unitPosition = edgePadding * attributes.positions.xy;
  geometry.uv = varyings.unitPosition;
  geometry.pickingColor = attributes.instancePickingColors;

  varyings.innerUnitRadius = 1.0 - scatterplot.stroked * lineWidthPixels / varyings.outerRadiusPixels;

  if (scatterplot.billboard != 0) {
    varyings.position = project_position_to_clipspace(attributes.instancePositions, attributes.instancePositions64Low, vec3<f32>(0.0)); // TODO , geometry.position);
    // DECKGL_FILTER_GL_POSITION(varyings.position, geometry);
    let offset = attributes.positions; // * edgePadding * varyings.outerRadiusPixels;
    // DECKGL_FILTER_SIZE(offset, geometry);
    let clipPixels = project_pixel_size_to_clipspace(offset.xy);
    varyings.position.x = clipPixels.x;
    varyings.position.y = clipPixels.y;
  } else {
    let offset = edgePadding * attributes.positions * project_pixel_size_float(varyings.outerRadiusPixels);
    // DECKGL_FILTER_SIZE(offset, geometry);
    varyings.position = project_position_to_clipspace(attributes.instancePositions, attributes.instancePositions64Low, offset); // TODO , geometry.position);
    // DECKGL_FILTER_GL_POSITION(varyings.position, geometry);
  }

  // Apply opacity to instance color, or return instance picking color
  varyings.vFillColor = vec4<f32>(attributes.instanceFillColors.rgb, attributes.instanceFillColors.a * color.opacity);
  // DECKGL_FILTER_COLOR(varyings.vFillColor, geometry);
  varyings.vLineColor = vec4<f32>(attributes.instanceLineColors.rgb, attributes.instanceLineColors.a * color.opacity);
  // DECKGL_FILTER_COLOR(varyings.vLineColor, geometry);

  return varyings;
}

@fragment
fn fragmentMain(varyings: Varyings) -> @location(0) vec4<f32> {
  // var geometry: Geometry;
  // geometry.uv = unitPosition;

  let distToCenter = length(varyings.unitPosition) * varyings.outerRadiusPixels;
  let inCircle = select(
    smoothedge(distToCenter, varyings.outerRadiusPixels),
    step(distToCenter, varyings.outerRadiusPixels),
    scatterplot.antialiasing != 0
  );

  if (inCircle == 0.0) {
    discard;
  }

  var fragColor: vec4<f32>;

  if (scatterplot.stroked != 0) {
    let isLine = select(
      smoothedge(varyings.innerUnitRadius * varyings.outerRadiusPixels, distToCenter),
      step(varyings.innerUnitRadius * varyings.outerRadiusPixels, distToCenter),
      scatterplot.antialiasing != 0
    );

    if (scatterplot.filled != 0) {
      fragColor = mix(varyings.vFillColor, varyings.vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      fragColor = vec4<f32>(varyings.vLineColor.rgb, varyings.vLineColor.a * isLine);
    }
  } else if (scatterplot.filled == 0) {
    discard;
  } else {
    fragColor = varyings.vFillColor;
  }

  fragColor.a *= inCircle;
  // DECKGL_FILTER_COLOR(fragColor, geometry);

  // Apply premultiplied alpha as required by transparent canvas
  fragColor = deckgl_premultiplied_alpha(fragColor);

  return fragColor;
  // return vec4<f32>(0, 0, 1, 1);
}
`,y8=[0,0,0,255],Xwe={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:r=>r.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:y8},getLineColor:{type:"accessor",value:y8},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class jS extends oo{getShaders(){return super.getShaders({vs:Hwe,fs:Wwe,source:Kwe,modules:[$s,yO,Ja,Gwe]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e),e.changeFlags.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){const{radiusUnits:t,radiusScale:n,radiusMinPixels:i,radiusMaxPixels:s,stroked:a,filled:o,billboard:u,antialiasing:f,lineWidthUnits:g,lineWidthScale:y,lineWidthMinPixels:A,lineWidthMaxPixels:C}=this.props,M={stroked:a,filled:o,billboard:u,antialiasing:f,radiusUnits:Go[t],radiusScale:n,radiusMinPixels:i,radiusMaxPixels:s,lineWidthUnits:Go[g],lineWidthScale:y,lineWidthMinPixels:A,lineWidthMaxPixels:C},k=this.state.model;k.shaderInputs.setProps({scatterplot:M}),this.context.device.type==="webgpu"&&(k.instanceCount=this.props.data.length),k.draw(this.context.renderPass)}_getModel(){const e=this.context.device.type==="webgpu"?{depthWriteEnabled:!0,depthCompare:"less-equal"}:void 0,t=[-1,-1,0,1,-1,0,-1,1,0,1,1,0];return new Mi(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new To({topology:"triangle-strip",attributes:{positions:{size:3,value:new Float32Array(t)}}}),isInstanced:!0,parameters:e})}}jS.defaultProps=Xwe;jS.layerName="ScatterplotLayer";const UO={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function zO(r,e,t={}){return Jwe(r,t)!==e?(Ywe(r,t),!0):!1}function Jwe(r,e={}){return Math.sign(qwe(r,e))}const b8={x:0,y:1,z:2};function qwe(r,e={}){const{start:t=0,end:n=r.length,plane:i="xy"}=e,s=e.size||2;let a=0;const o=b8[i[0]],u=b8[i[1]];for(let f=t,g=n-s;f<n;f+=s)a+=(r[f+o]-r[g+o])*(r[f+u]+r[g+u]),g=f;return a/2}function Ywe(r,e){const{start:t=0,end:n=r.length,size:i=2}=e,s=(n-t)/i,a=Math.floor(s/2);for(let o=0;o<a;++o){const u=t+o*i,f=t+(s-1-o)*i;for(let g=0;g<i;++g){const y=r[u+g];r[u+g]=r[f+g],r[f+g]=y}}}function ql(r,e){const t=e.length,n=r.length;if(n>0){let i=!0;for(let s=0;s<t;s++)if(r[n-t+s]!==e[s]){i=!1;break}if(i)return!1}for(let i=0;i<t;i++)r[n+i]=e[i];return!0}function LB(r,e){const t=e.length;for(let n=0;n<t;n++)r[n]=e[n]}function q_(r,e,t,n,i=[]){const s=n+e*t;for(let a=0;a<t;a++)i[a]=r[s+a];return i}function NB(r,e,t,n,i=[]){let s,a;if(t&8)s=(n[3]-r[1])/(e[1]-r[1]),a=3;else if(t&4)s=(n[1]-r[1])/(e[1]-r[1]),a=1;else if(t&2)s=(n[2]-r[0])/(e[0]-r[0]),a=2;else if(t&1)s=(n[0]-r[0])/(e[0]-r[0]),a=0;else return null;for(let o=0;o<r.length;o++)i[o]=(a&1)===o?n[a]:s*(e[o]-r[o])+r[o];return i}function Rw(r,e){let t=0;return r[0]<e[0]?t|=1:r[0]>e[2]&&(t|=2),r[1]<e[1]?t|=4:r[1]>e[3]&&(t|=8),t}function EX(r,e){const{size:t=2,broken:n=!1,gridResolution:i=10,gridOffset:s=[0,0],startIndex:a=0,endIndex:o=r.length}=e||{},u=(o-a)/t;let f=[];const g=[f],y=q_(r,0,t,a);let A,C;const M=PX(y,i,s,[]),k=[];ql(f,y);for(let D=1;D<u;D++){for(A=q_(r,D,t,a,A),C=Rw(A,M);C;){NB(y,A,C,M,k);const V=Rw(k,M);V&&(NB(y,k,V,M,k),C=V),ql(f,k),LB(y,k),Qwe(M,i,C),n&&f.length>t&&(f=[],g.push(f),ql(f,y)),C=Rw(A,M)}ql(f,A),LB(y,A)}return n?g:g[0]}const _8=0,Zwe=1;function IX(r,e=null,t){if(!r.length)return[];const{size:n=2,gridResolution:i=10,gridOffset:s=[0,0],edgeTypes:a=!1}=t||{},o=[],u=[{pos:r,types:a?new Array(r.length/n).fill(Zwe):null,holes:e||[]}],f=[[],[]];let g=[];for(;u.length;){const{pos:y,types:A,holes:C}=u.shift();eCe(y,n,C[0]||y.length,f),g=PX(f[0],i,s,g);const M=Rw(f[1],g);if(M){let k=v8(y,A,n,0,C[0]||y.length,g,M);const D={pos:k[0].pos,types:k[0].types,holes:[]},V={pos:k[1].pos,types:k[1].types,holes:[]};u.push(D,V);for(let W=0;W<C.length;W++)k=v8(y,A,n,C[W],C[W+1]||y.length,g,M),k[0]&&(D.holes.push(D.pos.length),D.pos=cx(D.pos,k[0].pos),a&&(D.types=cx(D.types,k[0].types))),k[1]&&(V.holes.push(V.pos.length),V.pos=cx(V.pos,k[1].pos),a&&(V.types=cx(V.types,k[1].types)))}else{const k={positions:y};a&&(k.edgeTypes=A),C.length&&(k.holeIndices=C),o.push(k)}}return o}function v8(r,e,t,n,i,s,a){const o=(i-n)/t,u=[],f=[],g=[],y=[],A=[];let C,M,k;const D=q_(r,o-1,t,n);let V=Math.sign(a&8?D[1]-s[3]:D[0]-s[2]),W=e&&e[o-1],z=0,$=0;for(let te=0;te<o;te++)C=q_(r,te,t,n,C),M=Math.sign(a&8?C[1]-s[3]:C[0]-s[2]),k=e&&e[n/t+te],M&&V&&V!==M&&(NB(D,C,a,s,A),ql(u,A)&&g.push(W),ql(f,A)&&y.push(W)),M<=0?(ql(u,C)&&g.push(k),z-=M):g.length&&(g[g.length-1]=_8),M>=0?(ql(f,C)&&y.push(k),$+=M):y.length&&(y[y.length-1]=_8),LB(D,C),V=M,W=k;return[z?{pos:u,types:e&&g}:null,$?{pos:f,types:e&&y}:null]}function PX(r,e,t,n){const i=Math.floor((r[0]-t[0])/e)*e+t[0],s=Math.floor((r[1]-t[1])/e)*e+t[1];return n[0]=i,n[1]=s,n[2]=i+e,n[3]=s+e,n}function Qwe(r,e,t){t&8?(r[1]+=e,r[3]+=e):t&4?(r[1]-=e,r[3]-=e):t&2?(r[0]+=e,r[2]+=e):t&1&&(r[0]-=e,r[2]-=e)}function eCe(r,e,t,n){let i=1/0,s=-1/0,a=1/0,o=-1/0;for(let u=0;u<t;u+=e){const f=r[u],g=r[u+1];i=f<i?f:i,s=f>s?f:s,a=g<a?g:a,o=g>o?g:o}return n[0][0]=i,n[0][1]=a,n[1][0]=s,n[1][1]=o,n}function cx(r,e){for(let t=0;t<e.length;t++)r.push(e[t]);return r}const tCe=85.051129;function rCe(r,e){const{size:t=2,startIndex:n=0,endIndex:i=r.length,normalize:s=!0}=e||{},a=r.slice(n,i);BX(a,t,0,i-n);const o=EX(a,{size:t,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const u of o)MX(u,t);return o}function nCe(r,e=null,t){const{size:n=2,normalize:i=!0,edgeTypes:s=!1}=t||{};e=e||[];const a=[],o=[];let u=0,f=0;for(let y=0;y<=e.length;y++){const A=e[y]||r.length,C=f,M=iCe(r,n,u,A);for(let k=M;k<A;k++)a[f++]=r[k];for(let k=u;k<M;k++)a[f++]=r[k];BX(a,n,C,f),sCe(a,n,C,f,t?.maxLatitude),u=A,o[y]=f}o.pop();const g=IX(a,o,{size:n,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(i)for(const y of g)MX(y.positions,n);return g}function iCe(r,e,t,n){let i=-1,s=-1;for(let a=t+1;a<n;a+=e){const o=Math.abs(r[a]);o>i&&(i=o,s=a-1)}return s}function sCe(r,e,t,n,i=tCe){const s=r[t],a=r[n-e];if(Math.abs(s-a)>180){const o=q_(r,0,e,t);o[0]+=Math.round((a-s)/360)*360,ql(r,o),o[1]=Math.sign(o[1])*i,ql(r,o),o[0]=s,ql(r,o)}}function BX(r,e,t,n){let i=r[0],s;for(let a=t;a<n;a+=e){s=r[a];const o=s-i;(o>180||o<-180)&&(s-=Math.round(o/360)*360),r[a]=i=s}}function MX(r,e){let t;const n=r.length/e;for(let s=0;s<n&&(t=r[s*e],(t+180)%360===0);s++);const i=-Math.round(t/360)*360;if(i!==0)for(let s=0;s<n;s++)r[s*e]+=i}class oCe extends To{constructor(e){const{indices:t,attributes:n}=aCe(e);super({...e,indices:t,attributes:n})}}function aCe(r){const{radius:e,height:t=1,nradial:n=10}=r;let{vertices:i}=r;i&&(Rr.assert(i.length>=n),i=i.flatMap(C=>[C[0],C[1]]),zO(i,UO.COUNTER_CLOCKWISE));const s=t>0,a=n+1,o=s?a*3+1:n,u=Math.PI*2/n,f=new Uint16Array(s?n*3*2:0),g=new Float32Array(o*3),y=new Float32Array(o*3);let A=0;if(s){for(let C=0;C<a;C++){const M=C*u,k=C%n,D=Math.sin(M),V=Math.cos(M);for(let W=0;W<2;W++)g[A+0]=i?i[k*2]:V*e,g[A+1]=i?i[k*2+1]:D*e,g[A+2]=(1/2-W)*t,y[A+0]=i?i[k*2]:V,y[A+1]=i?i[k*2+1]:D,A+=3}g[A+0]=g[A-3],g[A+1]=g[A-2],g[A+2]=g[A-1],A+=3}for(let C=s?0:1;C<a;C++){const M=Math.floor(C/2)*Math.sign(.5-C%2),k=M*u,D=(M+n)%n,V=Math.sin(k),W=Math.cos(k);g[A+0]=i?i[D*2]:W*e,g[A+1]=i?i[D*2+1]:V*e,g[A+2]=t/2,y[A+2]=1,A+=3}if(s){let C=0;for(let M=0;M<n;M++)f[C++]=M*2+0,f[C++]=M*2+2,f[C++]=M*2+0,f[C++]=M*2+1,f[C++]=M*2+1,f[C++]=M*2+3}return{indices:f,attributes:{POSITION:{size:3,value:g},NORMAL:{size:3,value:y}}}}const A8=`uniform columnUniforms {
  float radius;
  float angle;
  vec2 offset;
  bool extruded;
  bool stroked;
  bool isStroke;
  float coverage;
  float elevationScale;
  float edgeDistance;
  float widthScale;
  float widthMinPixels;
  float widthMaxPixels;
  highp int radiusUnits;
  highp int widthUnits;
} column;
`,lCe={name:"column",vs:A8,fs:A8,uniformTypes:{radius:"f32",angle:"f32",offset:"vec2<f32>",extruded:"f32",stroked:"f32",isStroke:"f32",coverage:"f32",elevationScale:"f32",edgeDistance:"f32",widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",radiusUnits:"i32",widthUnits:"i32"}},cCe=`#version 300 es
#define SHADER_NAME column-layer-vertex-shader
in vec3 positions;
in vec3 normals;
in vec3 instancePositions;
in float instanceElevations;
in vec3 instancePositions64Low;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in float instanceStrokeWidths;
in vec3 instancePickingColors;
out vec4 vColor;
#ifdef FLAT_SHADING
out vec3 cameraPosition;
out vec4 position_commonspace;
#endif
void main(void) {
geometry.worldPosition = instancePositions;
vec4 color = column.isStroke ? instanceLineColors : instanceFillColors;
mat2 rotationMatrix = mat2(cos(column.angle), sin(column.angle), -sin(column.angle), cos(column.angle));
float elevation = 0.0;
float strokeOffsetRatio = 1.0;
if (column.extruded) {
elevation = instanceElevations * (positions.z + 1.0) / 2.0 * column.elevationScale;
} else if (column.stroked) {
float widthPixels = clamp(
project_size_to_pixel(instanceStrokeWidths * column.widthScale, column.widthUnits),
column.widthMinPixels, column.widthMaxPixels) / 2.0;
float halfOffset = project_pixel_size(widthPixels) / project_size(column.edgeDistance * column.coverage * column.radius);
if (column.isStroke) {
strokeOffsetRatio -= sign(positions.z) * halfOffset;
} else {
strokeOffsetRatio -= halfOffset;
}
}
float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);
float dotRadius = column.radius * column.coverage * shouldRender;
geometry.pickingColor = instancePickingColors;
vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);
vec3 centroidPosition64Low = instancePositions64Low;
vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + column.offset) * dotRadius;
if (column.radiusUnits == UNIT_METERS) {
offset = project_size(offset);
}
vec3 pos = vec3(offset, 0.);
DECKGL_FILTER_SIZE(pos, geometry);
gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);
geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (column.extruded && !column.isStroke) {
#ifdef FLAT_SHADING
cameraPosition = project.cameraPosition;
position_commonspace = geometry.position;
vColor = vec4(color.rgb, color.a * layer.opacity);
#else
vec3 lightColor = lighting_getLightColor(color.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, color.a * layer.opacity);
#endif
} else {
vColor = vec4(color.rgb, color.a * layer.opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,uCe=`#version 300 es
#define SHADER_NAME column-layer-fragment-shader
precision highp float;
out vec4 fragColor;
in vec4 vColor;
#ifdef FLAT_SHADING
in vec3 cameraPosition;
in vec4 position_commonspace;
#endif
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
#ifdef FLAT_SHADING
if (column.extruded && !column.isStroke && !bool(picking.isActive)) {
vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
fragColor.rgb = lighting_getLightColor(vColor.rgb, cameraPosition, position_commonspace.xyz, normal);
}
#endif
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,qC=[0,0,0,255],hCe={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,flatShading:!1,getPosition:{type:"accessor",value:r=>r.position},getFillColor:{type:"accessor",value:qC},getLineColor:{type:"accessor",value:qC},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class Ry extends oo{getShaders(){const e={},{flatShading:t}=this.props;return t&&(e.FLAT_SHADING=1),super.getShaders({vs:cCe,fs:uCe,defines:e,modules:[$s,t?gO:LS,Ja,lCe]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getFillColor",defaultValue:qC},instanceLineColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getLineColor",defaultValue:qC},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(e){super.updateState(e);const{props:t,oldProps:n,changeFlags:i}=e,s=i.extensionsChanged||t.flatShading!==n.flatShading;s&&(this.state.models?.forEach(o=>o.destroy()),this.setState(this._getModels()),this.getAttributeManager().invalidateAll());const a=this.getNumInstances();this.state.fillModel.setInstanceCount(a),this.state.wireframeModel.setInstanceCount(a),(s||t.diskResolution!==n.diskResolution||t.vertices!==n.vertices||(t.extruded||t.stroked)!==(n.extruded||n.stroked))&&this._updateGeometry(t)}getGeometry(e,t,n){const i=new oCe({radius:1,height:n?2:0,vertices:t,nradial:e});let s=0;if(t)for(let a=0;a<e;a++){const o=t[a],u=Math.sqrt(o[0]*o[0]+o[1]*o[1]);s+=u/e}else s=1;return this.setState({edgeDistance:Math.cos(Math.PI/e)*s}),i}_getModels(){const e=this.getShaders(),t=this.getAttributeManager().getBufferLayouts(),n=new Mi(this.context.device,{...e,id:`${this.props.id}-fill`,bufferLayout:t,isInstanced:!0}),i=new Mi(this.context.device,{...e,id:`${this.props.id}-wireframe`,bufferLayout:t,isInstanced:!0});return{fillModel:n,wireframeModel:i,models:[i,n]}}_updateGeometry({diskResolution:e,vertices:t,extruded:n,stroked:i}){const s=this.getGeometry(e,t,n||i);this.setState({fillVertexCount:s.attributes.POSITION.value.length/3});const a=this.state.fillModel,o=this.state.wireframeModel;a.setGeometry(s),a.setTopology("triangle-strip"),a.setIndexBuffer(null),o.setGeometry(s),o.setTopology("line-list")}draw({uniforms:e}){const{lineWidthUnits:t,lineWidthScale:n,lineWidthMinPixels:i,lineWidthMaxPixels:s,radiusUnits:a,elevationScale:o,extruded:u,filled:f,stroked:g,wireframe:y,offset:A,coverage:C,radius:M,angle:k}=this.props,D=this.state.fillModel,V=this.state.wireframeModel,{fillVertexCount:W,edgeDistance:z}=this.state,$={radius:M,angle:k/180*Math.PI,offset:A,extruded:u,stroked:g,coverage:C,elevationScale:o,edgeDistance:z,radiusUnits:Go[a],widthUnits:Go[t],widthScale:n,widthMinPixels:i,widthMaxPixels:s};u&&y&&(V.shaderInputs.setProps({column:{...$,isStroke:!0}}),V.draw(this.context.renderPass)),f&&(D.setVertexCount(W),D.shaderInputs.setProps({column:{...$,isStroke:!1}}),D.draw(this.context.renderPass)),!u&&g&&(D.setVertexCount(W*2/3),D.shaderInputs.setProps({column:{...$,isStroke:!0}}),D.draw(this.context.renderPass))}}Ry.layerName="ColumnLayer";Ry.defaultProps=hCe;const dCe={cellSize:{type:"number",min:0,value:1e3},offset:{type:"array",value:[1,1]}};let VO=class extends Ry{_updateGeometry(){const e=new UK;this.state.fillModel.setGeometry(e)}draw({uniforms:e}){const{elevationScale:t,extruded:n,offset:i,coverage:s,cellSize:a,angle:o,radiusUnits:u}=this.props,f=this.state.fillModel,g={radius:a/2,radiusUnits:Go[u],angle:o,offset:i,extruded:n,stroked:!1,coverage:s,elevationScale:t,edgeDistance:1,isStroke:!1,widthUnits:0,widthScale:0,widthMinPixels:0,widthMaxPixels:0};f.shaderInputs.setProps({column:g}),f.draw(this.context.renderPass)}};VO.layerName="GridCellLayer";VO.defaultProps=dCe;function fCe(r,e,t,n){let i;if(Array.isArray(r[0])){const s=r.length*e;i=new Array(s);for(let a=0;a<r.length;a++)for(let o=0;o<e;o++)i[a*e+o]=r[a][o]||0}else i=r;return t?EX(i,{size:e,gridResolution:t}):n?rCe(i,{size:e}):i}const pCe=1,gCe=2,ZI=4;class mCe extends bX{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?fCe(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(x8(e)){let n=0;for(const i of e)n+=this.getGeometrySize(i);return n}const t=this.getPathLength(e);return t<2?0:this.isClosed(e)?t<3?0:t+2:t}updateGeometryAttributes(e,t){if(t.geometrySize!==0)if(e&&x8(e))for(const n of e){const i=this.getGeometrySize(n);t.geometrySize=i,this.updateGeometryAttributes(n,t),t.vertexStart+=i}else this._updateSegmentTypes(e,t),this._updatePositions(e,t)}_updateSegmentTypes(e,t){const n=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:s,geometrySize:a}=t;n.fill(0,s,s+a),i?(n[s]=ZI,n[s+a-2]=ZI):(n[s]+=pCe,n[s+a-2]+=gCe),n[s+a-1]=ZI}_updatePositions(e,t){const{positions:n}=this.attributes;if(!n||!e)return;const{vertexStart:i,geometrySize:s}=t,a=new Array(3);for(let o=i,u=0;u<s;o++,u++)this.getPointOnPath(e,u,a),n[o*3]=a[0],n[o*3+1]=a[1],n[o*3+2]=a[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,t,n=[]){const{positionSize:i}=this;t*i>=e.length&&(t+=1-e.length/i);const s=t*i;return n[0]=e[s],n[1]=e[s+1],n[2]=i===3&&e[s+2]||0,n}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:t}=this,n=e.length-t;return e[0]===e[n]&&e[1]===e[n+1]&&(t===2||e[2]===e[n+2])}}function x8(r){return Array.isArray(r[0])}const w8=`uniform pathUniforms {
  float widthScale;
  float widthMinPixels;
  float widthMaxPixels;
  float jointType;
  float capType;
  float miterLimit;
  bool billboard;
  highp int widthUnits;
} path;
`,yCe={name:"path",vs:w8,fs:w8,uniformTypes:{widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",jointType:"f32",capType:"f32",miterLimit:"f32",billboard:"f32",widthUnits:"i32"}},bCe=`#version 300 es
#define SHADER_NAME path-layer-vertex-shader
in vec2 positions;
in float instanceTypes;
in vec3 instanceStartPositions;
in vec3 instanceEndPositions;
in vec3 instanceLeftPositions;
in vec3 instanceRightPositions;
in vec3 instanceLeftPositions64Low;
in vec3 instanceStartPositions64Low;
in vec3 instanceEndPositions64Low;
in vec3 instanceRightPositions64Low;
in float instanceStrokeWidths;
in vec4 instanceColors;
in vec3 instancePickingColors;
uniform float opacity;
out vec4 vColor;
out vec2 vCornerOffset;
out float vMiterLength;
out vec2 vPathPosition;
out float vPathLength;
out float vJointType;
const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);
float flipIfTrue(bool flag) {
return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
vec2 width
) {
bool isEnd = positions.x > 0.0;
float sideOfPath = positions.y;
float isJoint = float(sideOfPath == 0.0);
vec3 deltaA3 = (currPoint - prevPoint);
vec3 deltaB3 = (nextPoint - currPoint);
mat3 rotationMatrix;
bool needsRotation = !path.billboard && project_needs_rotation(currPoint, rotationMatrix);
if (needsRotation) {
deltaA3 = deltaA3 * rotationMatrix;
deltaB3 = deltaB3 * rotationMatrix;
}
vec2 deltaA = deltaA3.xy / width;
vec2 deltaB = deltaB3.xy / width;
float lenA = length(deltaA);
float lenB = length(deltaB);
vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);
vec2 perpA = vec2(-dirA.y, dirA.x);
vec2 perpB = vec2(-dirB.y, dirB.x);
vec2 tangent = dirA + dirB;
tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
vec2 miterVec = vec2(-tangent.y, tangent.x);
vec2 dir = isEnd ? dirA : dirB;
vec2 perp = isEnd ? perpA : perpB;
float L = isEnd ? lenA : lenB;
float sinHalfA = abs(dot(miterVec, perp));
float cosHalfA = abs(dot(dirA, miterVec));
float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
float cornerPosition = sideOfPath * turnDirection;
float miterSize = 1.0 / max(sinHalfA, EPSILON);
miterSize = mix(
min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
miterSize,
step(0.0, cornerPosition)
);
vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
* (sideOfPath + isJoint * turnDirection);
bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
bool isCap = isStartCap || isEndCap;
if (isCap) {
offsetVec = mix(perp * sideOfPath, dir * path.capType * 4.0 * flipIfTrue(isStartCap), isJoint);
vJointType = path.capType;
} else {
vJointType = path.jointType;
}
vPathLength = L;
vCornerOffset = offsetVec;
vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
vMiterLength = isCap ? isJoint : vMiterLength;
vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
vPathPosition = vec2(
dot(offsetFromStartOfPath, perp),
dot(offsetFromStartOfPath, dir)
);
geometry.uv = vPathPosition;
float isValid = step(instanceTypes, 3.5);
vec3 offset = vec3(offsetVec * width * isValid, 0.0);
if (needsRotation) {
offset = rotationMatrix * offset;
}
return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
if (position.w < EPSILON) {
float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
position = refPosition + (position - refPosition) * r;
}
}
void main() {
geometry.pickingColor = instancePickingColors;
vColor = vec4(instanceColors.rgb, instanceColors.a * layer.opacity);
float isEnd = positions.x;
vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);
vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);
vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);
geometry.worldPosition = currPosition;
vec2 widthPixels = vec2(clamp(
project_size_to_pixel(instanceStrokeWidths * path.widthScale, path.widthUnits),
path.widthMinPixels, path.widthMaxPixels) / 2.0);
vec3 width;
if (path.billboard) {
vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);
clipLine(prevPositionScreen, currPositionScreen);
clipLine(nextPositionScreen, currPositionScreen);
clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));
width = vec3(widthPixels, 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(
prevPositionScreen.xyz / prevPositionScreen.w,
currPositionScreen.xyz / currPositionScreen.w,
nextPositionScreen.xyz / nextPositionScreen.w,
project_pixel_size_to_clipspace(width.xy)
);
DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
} else {
prevPosition = project_position(prevPosition, prevPosition64Low);
currPosition = project_position(currPosition, currPosition64Low);
nextPosition = project_position(nextPosition, nextPosition64Low);
width = vec3(project_pixel_size(widthPixels), 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
geometry.position = vec4(currPosition + offset, 1.0);
gl_Position = project_common_position_to_clipspace(geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,_Ce=`#version 300 es
#define SHADER_NAME path-layer-fragment-shader
precision highp float;
in vec4 vColor;
in vec2 vCornerOffset;
in float vMiterLength;
in vec2 vPathPosition;
in float vPathLength;
in float vJointType;
out vec4 fragColor;
void main(void) {
geometry.uv = vPathPosition;
if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
discard;
}
if (vJointType < 0.5 && vMiterLength > path.miterLimit + 1.0) {
discard;
}
}
fragColor = vColor;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,RX=[0,0,0,255],vCe={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:r=>r.path},getColor:{type:"accessor",value:RX},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},QI={enter:(r,e)=>e.length?e.subarray(e.length-r.length):r};class xp extends oo{getShaders(){return super.getShaders({vs:bCe,fs:_Ce,modules:[$s,Ja,yCe]})}get wrapLongitude(){return!1}getBounds(){return this.getAttributeManager()?.getBounds(["vertexPositions"])}initializeState(){this.getAttributeManager().addInstanced({vertexPositions:{size:3,vertexOffset:1,type:"float64",fp64:this.use64bitPositions(),transition:QI,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:"uint8",update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:QI,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",accessor:"getColor",transition:QI,defaultValue:RX},instancePickingColors:{size:4,type:"uint8",accessor:(n,{index:i,target:s})=>this.encodePickingColor(n&&n.__source?n.__source.index:i,s)}}),this.setState({pathTesselator:new mCe({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:t,changeFlags:n}=e,i=this.getAttributeManager();if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPath)){const{pathTesselator:a}=this.state,o=t.data.attributes||{};a.updateGeometry({data:t.data,geometryBuffer:o.getPath,buffers:o,normalize:!t._pathType,loop:t._pathType==="loop",getGeometry:t.getPath,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:n.dataChanged}),this.setState({numInstances:a.instanceCount,startIndices:a.vertexStarts}),n.dataChanged||i.invalidateAll()}n.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),i.invalidateAll())}getPickingInfo(e){const t=super.getPickingInfo(e),{index:n}=t,i=this.props.data;return i[0]&&i[0].__source&&(t.object=i.find(s=>s.__source.index===n)),t}disablePickingIndex(e){const t=this.props.data;if(t[0]&&t[0].__source)for(let n=0;n<t.length;n++)t[n].__source.index===e&&this._disablePickingIndex(n);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:t,capRounded:n,billboard:i,miterLimit:s,widthUnits:a,widthScale:o,widthMinPixels:u,widthMaxPixels:f}=this.props,g=this.state.model,y={jointType:Number(t),capType:Number(n),billboard:i,widthUnits:Go[a],widthScale:o,miterLimit:s,widthMinPixels:u,widthMaxPixels:f};g.shaderInputs.setProps({path:y}),g.draw(this.context.renderPass)}_getModel(){const e=[0,1,2,1,4,2,1,3,4,3,5,4],t=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new Mi(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new To({topology:"triangle-list",attributes:{indices:new Uint16Array(e),positions:{value:new Float32Array(t),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateSegmentTypes(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("segmentTypes")}}xp.defaultProps=vCe;xp.layerName="PathLayer";var $O={exports:{}};$O.exports=GS;$O.exports.default=GS;function GS(r,e,t){t=t||2;var n=e&&e.length,i=n?e[0]*t:r.length,s=kX(r,0,i,t,!0),a=[];if(!s||s.next===s.prev)return a;var o,u,f,g,y,A,C;if(n&&(s=TCe(r,e,s,t)),r.length>80*t){o=f=r[0],u=g=r[1];for(var M=t;M<i;M+=t)y=r[M],A=r[M+1],y<o&&(o=y),A<u&&(u=A),y>f&&(f=y),A>g&&(g=A);C=Math.max(f-o,g-u),C=C!==0?32767/C:0}return Y_(s,a,t,o,u,C,0),a}function kX(r,e,t,n,i){var s,a;if(i===zB(r,e,t,n)>0)for(s=e;s<t;s+=n)a=C8(s,r[s],r[s+1],a);else for(s=t-n;s>=e;s-=n)a=C8(s,r[s],r[s+1],a);return a&&HS(a,a.next)&&(Q_(a),a=a.next),a}function gp(r,e){if(!r)return r;e||(e=r);var t=r,n;do if(n=!1,!t.steiner&&(HS(t,t.next)||Di(t.prev,t,t.next)===0)){if(Q_(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function Y_(r,e,t,n,i,s,a){if(r){!a&&s&&BCe(r,n,i,s);for(var o=r,u,f;r.prev!==r.next;){if(u=r.prev,f=r.next,s?xCe(r,n,i,s):ACe(r)){e.push(u.i/t|0),e.push(r.i/t|0),e.push(f.i/t|0),Q_(r),r=f.next,o=f.next;continue}if(r=f,r===o){a?a===1?(r=wCe(gp(r),e,t),Y_(r,e,t,n,i,s,2)):a===2&&CCe(r,e,t,n,i,s):Y_(gp(r),e,t,n,i,s,1);break}}}}function ACe(r){var e=r.prev,t=r,n=r.next;if(Di(e,t,n)>=0)return!1;for(var i=e.x,s=t.x,a=n.x,o=e.y,u=t.y,f=n.y,g=i<s?i<a?i:a:s<a?s:a,y=o<u?o<f?o:f:u<f?u:f,A=i>s?i>a?i:a:s>a?s:a,C=o>u?o>f?o:f:u>f?u:f,M=n.next;M!==e;){if(M.x>=g&&M.x<=A&&M.y>=y&&M.y<=C&&vm(i,o,s,u,a,f,M.x,M.y)&&Di(M.prev,M,M.next)>=0)return!1;M=M.next}return!0}function xCe(r,e,t,n){var i=r.prev,s=r,a=r.next;if(Di(i,s,a)>=0)return!1;for(var o=i.x,u=s.x,f=a.x,g=i.y,y=s.y,A=a.y,C=o<u?o<f?o:f:u<f?u:f,M=g<y?g<A?g:A:y<A?y:A,k=o>u?o>f?o:f:u>f?u:f,D=g>y?g>A?g:A:y>A?y:A,V=FB(C,M,e,t,n),W=FB(k,D,e,t,n),z=r.prevZ,$=r.nextZ;z&&z.z>=V&&$&&$.z<=W;){if(z.x>=C&&z.x<=k&&z.y>=M&&z.y<=D&&z!==i&&z!==a&&vm(o,g,u,y,f,A,z.x,z.y)&&Di(z.prev,z,z.next)>=0||(z=z.prevZ,$.x>=C&&$.x<=k&&$.y>=M&&$.y<=D&&$!==i&&$!==a&&vm(o,g,u,y,f,A,$.x,$.y)&&Di($.prev,$,$.next)>=0))return!1;$=$.nextZ}for(;z&&z.z>=V;){if(z.x>=C&&z.x<=k&&z.y>=M&&z.y<=D&&z!==i&&z!==a&&vm(o,g,u,y,f,A,z.x,z.y)&&Di(z.prev,z,z.next)>=0)return!1;z=z.prevZ}for(;$&&$.z<=W;){if($.x>=C&&$.x<=k&&$.y>=M&&$.y<=D&&$!==i&&$!==a&&vm(o,g,u,y,f,A,$.x,$.y)&&Di($.prev,$,$.next)>=0)return!1;$=$.nextZ}return!0}function wCe(r,e,t){var n=r;do{var i=n.prev,s=n.next.next;!HS(i,s)&&OX(i,n,n.next,s)&&Z_(i,s)&&Z_(s,i)&&(e.push(i.i/t|0),e.push(n.i/t|0),e.push(s.i/t|0),Q_(n),Q_(n.next),n=r=s),n=n.next}while(n!==r);return gp(n)}function CCe(r,e,t,n,i,s){var a=r;do{for(var o=a.next.next;o!==a.prev;){if(a.i!==o.i&&kCe(a,o)){var u=DX(a,o);a=gp(a,a.next),u=gp(u,u.next),Y_(a,e,t,n,i,s,0),Y_(u,e,t,n,i,s,0);return}o=o.next}a=a.next}while(a!==r)}function TCe(r,e,t,n){var i=[],s,a,o,u,f;for(s=0,a=e.length;s<a;s++)o=e[s]*n,u=s<a-1?e[s+1]*n:r.length,f=kX(r,o,u,n,!1),f===f.next&&(f.steiner=!0),i.push(RCe(f));for(i.sort(SCe),s=0;s<i.length;s++)t=ECe(i[s],t);return t}function SCe(r,e){return r.x-e.x}function ECe(r,e){var t=ICe(r,e);if(!t)return e;var n=DX(t,r);return gp(n,n.next),gp(t,t.next)}function ICe(r,e){var t=e,n=r.x,i=r.y,s=-1/0,a;do{if(i<=t.y&&i>=t.next.y&&t.next.y!==t.y){var o=t.x+(i-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(o<=n&&o>s&&(s=o,a=t.x<t.next.x?t:t.next,o===n))return a}t=t.next}while(t!==e);if(!a)return null;var u=a,f=a.x,g=a.y,y=1/0,A;t=a;do n>=t.x&&t.x>=f&&n!==t.x&&vm(i<g?n:s,i,f,g,i<g?s:n,i,t.x,t.y)&&(A=Math.abs(i-t.y)/(n-t.x),Z_(t,r)&&(A<y||A===y&&(t.x>a.x||t.x===a.x&&PCe(a,t)))&&(a=t,y=A)),t=t.next;while(t!==u);return a}function PCe(r,e){return Di(r.prev,r,e.prev)<0&&Di(e.next,r,r.next)<0}function BCe(r,e,t,n){var i=r;do i.z===0&&(i.z=FB(i.x,i.y,e,t,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==r);i.prevZ.nextZ=null,i.prevZ=null,MCe(i)}function MCe(r){var e,t,n,i,s,a,o,u,f=1;do{for(t=r,r=null,s=null,a=0;t;){for(a++,n=t,o=0,e=0;e<f&&(o++,n=n.nextZ,!!n);e++);for(u=f;o>0||u>0&&n;)o!==0&&(u===0||!n||t.z<=n.z)?(i=t,t=t.nextZ,o--):(i=n,n=n.nextZ,u--),s?s.nextZ=i:r=i,i.prevZ=s,s=i;t=n}s.nextZ=null,f*=2}while(a>1);return r}function FB(r,e,t,n,i){return r=(r-t)*i|0,e=(e-n)*i|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r|e<<1}function RCe(r){var e=r,t=r;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==r);return t}function vm(r,e,t,n,i,s,a,o){return(i-a)*(e-o)>=(r-a)*(s-o)&&(r-a)*(n-o)>=(t-a)*(e-o)&&(t-a)*(s-o)>=(i-a)*(n-o)}function kCe(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!OCe(r,e)&&(Z_(r,e)&&Z_(e,r)&&DCe(r,e)&&(Di(r.prev,r,e.prev)||Di(r,e.prev,e))||HS(r,e)&&Di(r.prev,r,r.next)>0&&Di(e.prev,e,e.next)>0)}function Di(r,e,t){return(e.y-r.y)*(t.x-e.x)-(e.x-r.x)*(t.y-e.y)}function HS(r,e){return r.x===e.x&&r.y===e.y}function OX(r,e,t,n){var i=hx(Di(r,e,t)),s=hx(Di(r,e,n)),a=hx(Di(t,n,r)),o=hx(Di(t,n,e));return!!(i!==s&&a!==o||i===0&&ux(r,t,e)||s===0&&ux(r,n,e)||a===0&&ux(t,r,n)||o===0&&ux(t,e,n))}function ux(r,e,t){return e.x<=Math.max(r.x,t.x)&&e.x>=Math.min(r.x,t.x)&&e.y<=Math.max(r.y,t.y)&&e.y>=Math.min(r.y,t.y)}function hx(r){return r>0?1:r<0?-1:0}function OCe(r,e){var t=r;do{if(t.i!==r.i&&t.next.i!==r.i&&t.i!==e.i&&t.next.i!==e.i&&OX(t,t.next,r,e))return!0;t=t.next}while(t!==r);return!1}function Z_(r,e){return Di(r.prev,r,r.next)<0?Di(r,e,r.next)>=0&&Di(r,r.prev,e)>=0:Di(r,e,r.prev)<0||Di(r,r.next,e)<0}function DCe(r,e){var t=r,n=!1,i=(r.x+e.x)/2,s=(r.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&i<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==r);return n}function DX(r,e){var t=new UB(r.i,r.x,r.y),n=new UB(e.i,e.x,e.y),i=r.next,s=e.prev;return r.next=e,e.prev=r,t.next=i,i.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function C8(r,e,t,n){var i=new UB(r,e,t);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Q_(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function UB(r,e,t){this.i=r,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}GS.deviation=function(r,e,t,n){var i=e&&e.length,s=i?e[0]*t:r.length,a=Math.abs(zB(r,0,s,t));if(i)for(var o=0,u=e.length;o<u;o++){var f=e[o]*t,g=o<u-1?e[o+1]*t:r.length;a-=Math.abs(zB(r,f,g,t))}var y=0;for(o=0;o<n.length;o+=3){var A=n[o]*t,C=n[o+1]*t,M=n[o+2]*t;y+=Math.abs((r[A]-r[M])*(r[C+1]-r[A+1])-(r[A]-r[C])*(r[M+1]-r[A+1]))}return a===0&&y===0?0:Math.abs((y-a)/a)};function zB(r,e,t,n){for(var i=0,s=e,a=t-n;s<t;s+=n)i+=(r[a]-r[s])*(r[s+1]+r[a+1]),a=s;return i}GS.flatten=function(r){for(var e=r[0][0].length,t={vertices:[],holes:[],dimensions:e},n=0,i=0;i<r.length;i++){for(var s=0;s<r[i].length;s++)for(var a=0;a<e;a++)t.vertices.push(r[i][s][a]);i>0&&(n+=r[i-1].length,t.holes.push(n))}return t};var LCe=$O.exports;const NCe=R$(LCe),dx=UO.CLOCKWISE,T8=UO.COUNTER_CLOCKWISE,ld={};function FCe(r){if(r=r&&r.positions||r,!Array.isArray(r)&&!ArrayBuffer.isView(r))throw new Error("invalid polygon")}function R0(r){return"positions"in r?r.positions:r}function kw(r){return"holeIndices"in r?r.holeIndices:null}function UCe(r){return Array.isArray(r[0])}function zCe(r){return r.length>=1&&r[0].length>=2&&Number.isFinite(r[0][0])}function VCe(r){const e=r[0],t=r[r.length-1];return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function $Ce(r,e,t,n){for(let i=0;i<e;i++)if(r[t+i]!==r[n-e+i])return!1;return!0}function S8(r,e,t,n,i){let s=e;const a=t.length;for(let o=0;o<a;o++)for(let u=0;u<n;u++)r[s++]=t[o][u]||0;if(!VCe(t))for(let o=0;o<n;o++)r[s++]=t[0][o]||0;return ld.start=e,ld.end=s,ld.size=n,zO(r,i,ld),s}function E8(r,e,t,n,i=0,s,a){s=s||t.length;const o=s-i;if(o<=0)return e;let u=e;for(let f=0;f<o;f++)r[u++]=t[i+f];if(!$Ce(t,n,i,s))for(let f=0;f<n;f++)r[u++]=t[i+f];return ld.start=e,ld.end=u,ld.size=n,zO(r,a,ld),u}function LX(r,e){FCe(r);const t=[],n=[];if("positions"in r){const{positions:i,holeIndices:s}=r;if(s){let a=0;for(let o=0;o<=s.length;o++)a=E8(t,a,i,e,s[o-1],s[o],o===0?dx:T8),n.push(a);return n.pop(),{positions:t,holeIndices:n}}r=i}if(!UCe(r))return E8(t,0,r,e,0,t.length,dx),t;if(!zCe(r)){let i=0;for(const[s,a]of r.entries())i=S8(t,i,a,e,s===0?dx:T8),n.push(i);return n.pop(),{positions:t,holeIndices:n}}return S8(t,0,r,e,dx),t}function eP(r,e,t){const n=r.length/3;let i=0;for(let s=0;s<n;s++){const a=(s+1)%n;i+=r[s*3+e]*r[a*3+t],i-=r[a*3+e]*r[s*3+t]}return Math.abs(i/2)}function I8(r,e,t,n){const i=r.length/3;for(let s=0;s<i;s++){const a=s*3,o=r[a+0],u=r[a+1],f=r[a+2];r[a+e]=o,r[a+t]=u,r[a+n]=f}}function jCe(r,e,t,n){let i=kw(r);i&&(i=i.map(o=>o/e));let s=R0(r);const a=n&&e===3;if(t){const o=s.length;s=s.slice();const u=[];for(let f=0;f<o;f+=e){u[0]=s[f],u[1]=s[f+1],a&&(u[2]=s[f+2]);const g=t(u);s[f]=g[0],s[f+1]=g[1],a&&(s[f+2]=g[2])}}if(a){const o=eP(s,0,1),u=eP(s,0,2),f=eP(s,1,2);if(!o&&!u&&!f)return[];o>u&&o>f||(u>f?(t||(s=s.slice()),I8(s,0,2,1)):(t||(s=s.slice()),I8(s,2,0,1)))}return NCe(s,i,e)}class GCe extends bX{constructor(e){const{fp64:t,IndexType:n=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:t?Float64Array:Float32Array},vertexValid:{type:Uint16Array,size:1},indices:{type:n,size:1}}})}get(e){const{attributes:t}=this;return e==="indices"?t.indices&&t.indices.subarray(0,this.vertexCount):t[e]}updateGeometry(e){super.updateGeometry(e);const t=this.buffers.indices;if(t)this.vertexCount=(t.value||t).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const t=LX(e,this.positionSize);return this.opts.resolution?IX(R0(t),kw(t),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?nCe(R0(t),kw(t),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):t}return e}getGeometrySize(e){if(P8(e)){let t=0;for(const n of e)t+=this.getGeometrySize(n);return t}return R0(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,t){if(e&&P8(e))for(const n of e){const i=this.getGeometrySize(n);t.geometrySize=i,this.updateGeometryAttributes(n,t),t.vertexStart+=i,t.indexStart=this.indexStarts[t.geometryIndex+1]}else{const n=e;this._updateIndices(n,t),this._updatePositions(n,t),this._updateVertexValid(n,t)}}_updateIndices(e,{geometryIndex:t,vertexStart:n,indexStart:i}){const{attributes:s,indexStarts:a,typedArrayManager:o}=this;let u=s.indices;if(!u||!e)return;let f=i;const g=jCe(e,this.positionSize,this.opts.preproject,this.opts.full3d);u=o.allocate(u,i+g.length,{copy:!0});for(let y=0;y<g.length;y++)u[f++]=g[y]+n;a[t+1]=i+g.length,s.indices=u}_updatePositions(e,{vertexStart:t,geometrySize:n}){const{attributes:{positions:i},positionSize:s}=this;if(!i||!e)return;const a=R0(e);for(let o=t,u=0;u<n;o++,u++){const f=a[u*s],g=a[u*s+1],y=s>2?a[u*s+2]:0;i[o*3]=f,i[o*3+1]=g,i[o*3+2]=y}}_updateVertexValid(e,{vertexStart:t,geometrySize:n}){const{positionSize:i}=this,s=this.attributes.vertexValid,a=e&&kw(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,t):s.fill(1,t,t+n),a)for(let o=0;o<a.length;o++)s[t+a[o]/i-1]=0;s[t+n-1]=0}}function P8(r){return Array.isArray(r)&&r.length>0&&!Number.isFinite(r[0])}const B8=`uniform solidPolygonUniforms {
  bool extruded;
  bool isWireframe;
  float elevationScale;
} solidPolygon;
`,HCe={name:"solidPolygon",vs:B8,fs:B8,uniformTypes:{extruded:"f32",isWireframe:"f32",elevationScale:"f32"}},NX=`in vec4 fillColors;
in vec4 lineColors;
in vec3 pickingColors;
out vec4 vColor;
struct PolygonProps {
vec3 positions;
vec3 positions64Low;
vec3 normal;
float elevations;
};
vec3 project_offset_normal(vec3 vector) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
return normalize(vector * project.commonUnitsPerWorldUnit);
}
return project_normal(vector);
}
void calculatePosition(PolygonProps props) {
vec3 pos = props.positions;
vec3 pos64Low = props.positions64Low;
vec3 normal = props.normal;
vec4 colors = solidPolygon.isWireframe ? lineColors : fillColors;
geometry.worldPosition = props.positions;
geometry.pickingColor = pickingColors;
if (solidPolygon.extruded) {
pos.z += props.elevations * solidPolygon.elevationScale;
}
gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (solidPolygon.extruded) {
#ifdef IS_SIDE_VERTEX
normal = project_offset_normal(normal);
#else
normal = project_normal(normal);
#endif
geometry.normal = normal;
vec3 lightColor = lighting_getLightColor(colors.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, colors.a * layer.opacity);
} else {
vColor = vec4(colors.rgb, colors.a * layer.opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,WCe=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader
in vec3 vertexPositions;
in vec3 vertexPositions64Low;
in float elevations;
${NX}
void main(void) {
PolygonProps props;
props.positions = vertexPositions;
props.positions64Low = vertexPositions64Low;
props.elevations = elevations;
props.normal = vec3(0.0, 0.0, 1.0);
calculatePosition(props);
}
`,KCe=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX
in vec2 positions;
in vec3 vertexPositions;
in vec3 nextVertexPositions;
in vec3 vertexPositions64Low;
in vec3 nextVertexPositions64Low;
in float elevations;
in float instanceVertexValid;
${NX}
void main(void) {
if(instanceVertexValid < 0.5){
gl_Position = vec4(0.);
return;
}
PolygonProps props;
vec3 pos;
vec3 pos64Low;
vec3 nextPos;
vec3 nextPos64Low;
#if RING_WINDING_ORDER_CW == 1
pos = vertexPositions;
pos64Low = vertexPositions64Low;
nextPos = nextVertexPositions;
nextPos64Low = nextVertexPositions64Low;
#else
pos = nextVertexPositions;
pos64Low = nextVertexPositions64Low;
nextPos = vertexPositions;
nextPos64Low = vertexPositions64Low;
#endif
props.positions = mix(pos, nextPos, positions.x);
props.positions64Low = mix(pos64Low, nextPos64Low, positions.x);
props.normal = vec3(
pos.y - nextPos.y + (pos64Low.y - nextPos64Low.y),
nextPos.x - pos.x + (nextPos64Low.x - pos64Low.x),
0.0);
props.elevations = elevations * positions.y;
calculatePosition(props);
}
`,XCe=`#version 300 es
#define SHADER_NAME solid-polygon-layer-fragment-shader
precision highp float;
in vec4 vColor;
out vec4 fragColor;
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,YC=[0,0,0,255],JCe={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:r=>r.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:YC},getLineColor:{type:"accessor",value:YC},material:!0},fx={enter:(r,e)=>e.length?e.subarray(e.length-r.length):r};class ky extends oo{getShaders(e){return super.getShaders({vs:e==="top"?WCe:KCe,fs:XCe,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[$s,LS,Ja,HCe]})}get wrapLongitude(){return!1}getBounds(){return this.getAttributeManager()?.getBounds(["vertexPositions"])}initializeState(){const{viewport:e}=this.context;let{coordinateSystem:t}=this.props;const{_full3d:n}=this.props;e.isGeospatial&&t===Pr.DEFAULT&&(t=Pr.LNGLAT);let i;t===Pr.LNGLAT&&(n?i=e.projectPosition.bind(e):i=e.projectFlat.bind(e)),this.setState({numInstances:0,polygonTesselator:new GCe({preproject:i,fp64:this.use64bitPositions(),IndexType:Uint32Array})});const s=this.getAttributeManager(),a=!0;s.remove(["instancePickingColors"]),s.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:a},vertexPositions:{size:3,type:"float64",stepMode:"dynamic",fp64:this.use64bitPositions(),transition:fx,accessor:"getPolygon",update:this.calculatePositions,noAlloc:a,shaderAttributes:{nextVertexPositions:{vertexOffset:1}}},instanceVertexValid:{size:1,type:"uint16",stepMode:"instance",update:this.calculateVertexValid,noAlloc:a},elevations:{size:1,stepMode:"dynamic",transition:fx,accessor:"getElevation"},fillColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:fx,accessor:"getFillColor",defaultValue:YC},lineColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:fx,accessor:"getLineColor",defaultValue:YC},pickingColors:{size:4,type:"uint8",stepMode:"dynamic",accessor:(o,{index:u,target:f})=>this.encodePickingColor(o&&o.__source?o.__source.index:u,f)}})}getPickingInfo(e){const t=super.getPickingInfo(e),{index:n}=t,i=this.props.data;return i[0]&&i[0].__source&&(t.object=i.find(s=>s.__source.index===n)),t}disablePickingIndex(e){const t=this.props.data;if(t[0]&&t[0].__source)for(let n=0;n<t.length;n++)t[n].__source.index===e&&this._disablePickingIndex(n);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:t,filled:n,wireframe:i,elevationScale:s}=this.props,{topModel:a,sideModel:o,wireframeModel:u,polygonTesselator:f}=this.state,g={extruded:!!t,elevationScale:s,isWireframe:!1};u&&i&&(u.setInstanceCount(f.instanceCount-1),u.shaderInputs.setProps({solidPolygon:{...g,isWireframe:!0}}),u.draw(this.context.renderPass)),o&&n&&(o.setInstanceCount(f.instanceCount-1),o.shaderInputs.setProps({solidPolygon:g}),o.draw(this.context.renderPass)),a&&n&&(a.setVertexCount(f.vertexCount),a.shaderInputs.setProps({solidPolygon:g}),a.draw(this.context.renderPass))}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:t,oldProps:n,changeFlags:i}=e,s=this.getAttributeManager();(i.extensionsChanged||t.filled!==n.filled||t.extruded!==n.extruded)&&(this.state.models?.forEach(o=>o.destroy()),this.setState(this._getModels()),s.invalidateAll())}updateGeometry({props:e,oldProps:t,changeFlags:n}){if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon)){const{polygonTesselator:s}=this.state,a=e.data.attributes||{};s.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:a.getPolygon,buffers:a,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:n.dataChanged,full3d:e._full3d}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),n.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(){const{id:e,filled:t,extruded:n}=this.props;let i,s,a;if(t){const o=this.getShaders("top");o.defines.NON_INSTANCED_MODEL=1;const u=this.getAttributeManager().getBufferLayouts({isInstanced:!1});i=new Mi(this.context.device,{...o,id:`${e}-top`,topology:"triangle-list",bufferLayout:u,isIndexed:!0,userData:{excludeAttributes:{instanceVertexValid:!0}}})}if(n){const o=this.getAttributeManager().getBufferLayouts({isInstanced:!0});s=new Mi(this.context.device,{...this.getShaders("side"),id:`${e}-side`,bufferLayout:o,geometry:new To({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,1,1,0,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}}),a=new Mi(this.context.device,{...this.getShaders("side"),id:`${e}-wireframe`,bufferLayout:o,geometry:new To({topology:"line-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}})}return{models:[s,a,i].filter(Boolean),topModel:i,sideModel:s,wireframeModel:a}}calculateIndices(e){const{polygonTesselator:t}=this.state;e.startIndices=t.indexStarts,e.value=t.get("indices")}calculatePositions(e){const{polygonTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}ky.defaultProps=JCe;ky.layerName="SolidPolygonLayer";function FX({data:r,getIndex:e,dataRange:t,replace:n}){const{startRow:i=0,endRow:s=1/0}=t,a=r.length;let o=a,u=a;for(let A=0;A<a;A++){const C=e(r[A]);if(o>A&&C>=i&&(o=A),C>=s){u=A;break}}let f=o;const y=u-o!==n.length?r.slice(u):void 0;for(let A=0;A<n.length;A++)r[f++]=n[A];if(y){for(let A=0;A<y.length;A++)r[f++]=y[A];r.length=f}return{startRow:o,endRow:o+n.length}}const UX=[0,0,0,255],qCe=[0,0,0,255],YCe={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:r=>r.polygon},getFillColor:{type:"accessor",value:qCe},getLineColor:{type:"accessor",value:UX},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class jO extends Zc{initializeState(){this.state={paths:[],pathsDiff:null},this.props.getLineDashArray&&Rr.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:e}){const t=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getPolygon);if(t&&Array.isArray(e.dataChanged)){const n=this.state.paths.slice(),i=e.dataChanged.map(s=>FX({data:n,getIndex:a=>a.__source.index,dataRange:s,replace:this._getPaths(s)}));this.setState({paths:n,pathsDiff:i})}else t&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(e={}){const{data:t,getPolygon:n,positionFormat:i,_normalize:s}=this.props,a=[],o=i==="XY"?2:3,{startRow:u,endRow:f}=e,{iterable:g,objectInfo:y}=Sd(t,u,f);for(const A of g){y.index++;let C=n(A,y);s&&(C=LX(C,o));const{holeIndices:M}=C,k=C.positions||C;if(M)for(let D=0;D<=M.length;D++){const V=k.slice(M[D-1]||0,M[D]||k.length);a.push(this.getSubLayerRow({path:V},A,y.index))}else a.push(this.getSubLayerRow({path:k},A,y.index))}return a}renderLayers(){const{data:e,_dataDiff:t,stroked:n,filled:i,extruded:s,wireframe:a,_normalize:o,_windingOrder:u,elevationScale:f,transitions:g,positionFormat:y}=this.props,{lineWidthUnits:A,lineWidthScale:C,lineWidthMinPixels:M,lineWidthMaxPixels:k,lineJointRounded:D,lineMiterLimit:V,lineDashJustified:W}=this.props,{getFillColor:z,getLineColor:$,getLineWidth:te,getLineDashArray:le,getElevation:_e,getPolygon:se,updateTriggers:Y,material:ce}=this.props,{paths:oe,pathsDiff:Me}=this.state,ze=this.getSubLayerClass("fill",ky),Ve=this.getSubLayerClass("stroke",xp),lt=this.shouldRenderSubLayer("fill",oe)&&new ze({_dataDiff:t,extruded:s,elevationScale:f,filled:i,wireframe:a,_normalize:o,_windingOrder:u,getElevation:_e,getFillColor:z,getLineColor:s&&a?$:UX,material:ce,transitions:g},this.getSubLayerProps({id:"fill",updateTriggers:Y&&{getPolygon:Y.getPolygon,getElevation:Y.getElevation,getFillColor:Y.getFillColor,lineColors:s&&a,getLineColor:Y.getLineColor}}),{data:e,positionFormat:y,getPolygon:se}),gt=!s&&n&&this.shouldRenderSubLayer("stroke",oe)&&new Ve({_dataDiff:Me&&(()=>Me),widthUnits:A,widthScale:C,widthMinPixels:M,widthMaxPixels:k,jointRounded:D,miterLimit:V,dashJustified:W,_pathType:"loop",transitions:g&&{getWidth:g.getLineWidth,getColor:g.getLineColor,getPath:g.getPolygon},getColor:this.getSubLayerAccessor($),getWidth:this.getSubLayerAccessor(te),getDashArray:this.getSubLayerAccessor(le)},this.getSubLayerProps({id:"stroke",updateTriggers:Y&&{getWidth:Y.getLineWidth,getColor:Y.getLineColor,getDashArray:Y.getLineDashArray}}),{data:oe,positionFormat:y,getPath:At=>At.path});return[!s&&lt,gt,s&&lt]}}jO.layerName="PolygonLayer";jO.defaultProps=YCe;function ZCe(r,e){if(!r)return null;const t="startIndices"in r?r.startIndices[e]:e,n=r.featureIds.value[t];return t!==-1?QCe(r,n,t):null}function QCe(r,e,t){const n={properties:{...r.properties[e]}};for(const i in r.numericProps)n.properties[i]=r.numericProps[i].value[t];return n}function eTe(r,e){const t={points:null,lines:null,polygons:null};for(const n in t){const i=r[n].globalFeatureIds.value;t[n]=new Uint8ClampedArray(i.length*4);const s=[];for(let a=0;a<i.length;a++)e(i[a],s),t[n][a*4+0]=s[0],t[n][a*4+1]=s[1],t[n][a*4+2]=s[2],t[n][a*4+3]=255}return t}const M8=`uniform sdfUniforms {
  float gamma;
  bool enabled;
  float buffer;
  float outlineBuffer;
  vec4 outlineColor;
} sdf;
`,tTe={name:"sdf",vs:M8,fs:M8,uniformTypes:{gamma:"f32",enabled:"f32",buffer:"f32",outlineBuffer:"f32",outlineColor:"vec4<f32>"}},rTe=`#version 300 es
#define SHADER_NAME multi-icon-layer-fragment-shader
precision highp float;
uniform sampler2D iconsTexture;
in vec4 vColor;
in vec2 vTextureCoords;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
if (!bool(picking.isActive)) {
float alpha = texture(iconsTexture, vTextureCoords).a;
vec4 color = vColor;
if (sdf.enabled) {
float distance = alpha;
alpha = smoothstep(sdf.buffer - sdf.gamma, sdf.buffer + sdf.gamma, distance);
if (sdf.outlineBuffer > 0.0) {
float inFill = alpha;
float inBorder = smoothstep(sdf.outlineBuffer - sdf.gamma, sdf.outlineBuffer + sdf.gamma, distance);
color = mix(sdf.outlineColor, vColor, inFill);
alpha = inBorder;
}
}
float a = alpha * color.a;
if (a < icon.alphaCutoff) {
discard;
}
fragColor = vec4(color.rgb, a * layer.opacity);
}
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,tP=192/256,R8=[],nTe={getIconOffsets:{type:"accessor",value:r=>r.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class GO extends Yv{getShaders(){const e=super.getShaders();return{...e,modules:[...e.modules,tTe],fs:rTe}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:"uint8",size:3,accessor:(t,{index:n,target:i})=>this.encodePickingColor(n,i)}})}updateState(e){super.updateState(e);const{props:t,oldProps:n}=e;let{outlineColor:i}=t;i!==n.outlineColor&&(i=i.map(s=>s/255),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!t.sdf&&t.outlineWidth&&Rr.warn(`${this.id}: fontSettings.sdf is required to render outline`)()}draw(e){const{sdf:t,smoothing:n,outlineWidth:i}=this.props,{outlineColor:s}=this.state,a=i?Math.max(n,tP*(1-i)):-1,o=this.state.model,u={buffer:tP,outlineBuffer:a,gamma:n,enabled:!!t,outlineColor:s};if(o.shaderInputs.setProps({sdf:u}),super.draw(e),t&&i){const{iconManager:f}=this.state;f.getTexture()&&(o.shaderInputs.setProps({sdf:{...u,outlineBuffer:tP}}),o.draw(this.context.renderPass))}}getInstanceOffset(e){return e?Array.from(e).flatMap(t=>super.getInstanceOffset(t)):R8}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(t=>super.getInstanceIconFrame(t)):R8}}GO.defaultProps=nTe;GO.layerName="MultiIconLayer";const o_=1e20;class iTe{constructor({fontSize:e=24,buffer:t=3,radius:n=8,cutoff:i=.25,fontFamily:s="sans-serif",fontWeight:a="normal",fontStyle:o="normal",lang:u=null}={}){this.buffer=t,this.cutoff=i,this.radius=n,this.lang=u;const f=this.size=e+t*4,g=this._createCanvas(f),y=this.ctx=g.getContext("2d",{willReadFrequently:!0});y.font=`${o} ${a} ${e}px ${s}`,y.textBaseline="alphabetic",y.textAlign="left",y.fillStyle="black",this.gridOuter=new Float64Array(f*f),this.gridInner=new Float64Array(f*f),this.f=new Float64Array(f),this.z=new Float64Array(f+1),this.v=new Uint16Array(f)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:n,actualBoundingBoxDescent:i,actualBoundingBoxLeft:s,actualBoundingBoxRight:a}=this.ctx.measureText(e),o=Math.ceil(n),u=0,f=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(a-s))),g=Math.min(this.size-this.buffer,o+Math.ceil(i)),y=f+2*this.buffer,A=g+2*this.buffer,C=Math.max(y*A,0),M=new Uint8ClampedArray(C),k={data:M,width:y,height:A,glyphWidth:f,glyphHeight:g,glyphTop:o,glyphLeft:u,glyphAdvance:t};if(f===0||g===0)return k;const{ctx:D,buffer:V,gridInner:W,gridOuter:z}=this;this.lang&&(D.lang=this.lang),D.clearRect(V,V,f,g),D.fillText(e,V,V+o);const $=D.getImageData(V,V,f,g);z.fill(o_,0,C),W.fill(0,0,C);for(let te=0;te<g;te++)for(let le=0;le<f;le++){const _e=$.data[4*(te*f+le)+3]/255;if(_e===0)continue;const se=(te+V)*y+le+V;if(_e===1)z[se]=0,W[se]=o_;else{const Y=.5-_e;z[se]=Y>0?Y*Y:0,W[se]=Y<0?Y*Y:0}}k8(z,0,0,y,A,y,this.f,this.v,this.z),k8(W,V,V,f,g,y,this.f,this.v,this.z);for(let te=0;te<C;te++){const le=Math.sqrt(z[te])-Math.sqrt(W[te]);M[te]=Math.round(255-255*(le/this.radius+this.cutoff))}return k}}function k8(r,e,t,n,i,s,a,o,u){for(let f=e;f<e+n;f++)O8(r,t*s+f,s,i,a,o,u);for(let f=t;f<t+i;f++)O8(r,f*s+e,1,n,a,o,u)}function O8(r,e,t,n,i,s,a){s[0]=0,a[0]=-o_,a[1]=o_,i[0]=r[e];for(let o=1,u=0,f=0;o<n;o++){i[o]=r[e+o*t];const g=o*o;do{const y=s[u];f=(i[o]-i[y]+g-y*y)/(o-y)/2}while(f<=a[u]&&--u>-1);u++,s[u]=o,a[u]=f,a[u+1]=o_}for(let o=0,u=0;o<n;o++){for(;a[u+1]<o;)u++;const f=s[u],g=o-f;r[e+o*t]=i[f]+g*g}}const sTe=32,oTe=[];function aTe(r){return Math.pow(2,Math.ceil(Math.log2(r)))}function lTe({characterSet:r,getFontWidth:e,fontHeight:t,buffer:n,maxCanvasWidth:i,mapping:s={},xOffset:a=0,yOffset:o=0}){let u=0,f=a;const g=t+n*2;for(const y of r)if(!s[y]){const A=e(y);f+A+n*2>i&&(f=0,u++),s[y]={x:f+n,y:o+u*g+n,width:A,height:g,layoutWidth:A,layoutHeight:t},f+=A+n*2}return{mapping:s,xOffset:f,yOffset:o+u*g,canvasHeight:aTe(o+(u+1)*g)}}function zX(r,e,t,n){let i=0;for(let s=e;s<t;s++){const a=r[s];i+=n[a]?.layoutWidth||0}return i}function VX(r,e,t,n,i,s){let a=e,o=0;for(let u=e;u<t;u++){const f=zX(r,u,u+1,i);o+f>n&&(a<u&&s.push(u),a=u,o=0),o+=f}return o}function cTe(r,e,t,n,i,s){let a=e,o=e,u=e,f=0;for(let g=e;g<t;g++)if((r[g]===" "||r[g+1]===" "||g+1===t)&&(u=g+1),u>o){let y=zX(r,o,u,i);f+y>n&&(a<o&&(s.push(o),a=o,f=0),y>n&&(y=VX(r,o,u,n,i,s),a=s[s.length-1])),o=u,f+=y}return f}function uTe(r,e,t,n,i=0,s){s===void 0&&(s=r.length);const a=[];return e==="break-all"?VX(r,i,s,t,n,a):cTe(r,i,s,t,n,a),a}function hTe(r,e,t,n,i,s){let a=0,o=0;for(let u=e;u<t;u++){const f=r[u],g=n[f];g?(o||(o=g.layoutHeight),i[u]=a+g.layoutWidth/2,a+=g.layoutWidth):(Rr.warn(`Missing character: ${f} (${f.codePointAt(0)})`)(),i[u]=a,a+=sTe)}s[0]=a,s[1]=o}function dTe(r,e,t,n,i){const s=Array.from(r),a=s.length,o=new Array(a),u=new Array(a),f=new Array(a),g=(t==="break-word"||t==="break-all")&&isFinite(n)&&n>0,y=[0,0],A=[0,0];let C=0,M=0,k=0;for(let D=0;D<=a;D++){const V=s[D];if((V===`
`||D===a)&&(k=D),k>M){const W=g?uTe(s,t,n,i,M,k):oTe;for(let z=0;z<=W.length;z++){const $=z===0?M:W[z-1],te=z<W.length?W[z]:k;hTe(s,$,te,i,o,A);for(let le=$;le<te;le++){const _e=s[le],se=i[_e]?.layoutOffsetY||0;u[le]=C+A[1]/2+se,f[le]=A[0]}C=C+A[1]*e,y[0]=Math.max(y[0],A[0])}M=k}V===`
`&&(o[M]=0,u[M]=0,f[M]=0,M++)}return y[1]=C,{x:o,y:u,rowWidth:f,size:y}}function fTe({value:r,length:e,stride:t,offset:n,startIndices:i,characterSet:s}){const a=r.BYTES_PER_ELEMENT,o=t?t/a:1,u=n?n/a:0,f=i[e]||Math.ceil((r.length-u)/o),g=s&&new Set,y=new Array(e);let A=r;if(o>1||u>0){const C=r.constructor;A=new C(f);for(let M=0;M<f;M++)A[M]=r[M*o+u]}for(let C=0;C<e;C++){const M=i[C],k=i[C+1]||f,D=A.subarray(M,k);y[C]=String.fromCodePoint.apply(null,D),g&&D.forEach(g.add,g)}if(g)for(const C of g)s.add(String.fromCodePoint(C));return{texts:y,characterCount:f}}class $X{constructor(e=5){this._cache={},this._order=[],this.limit=e}get(e){const t=this._cache[e];return t&&(this._deleteOrder(e),this._appendOrder(e)),t}set(e,t){this._cache[e]?(this.delete(e),this._cache[e]=t,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=t,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const t=this._order.indexOf(e);t>=0&&this._order.splice(t,1)}_appendOrder(e){this._order.push(e)}}function pTe(){const r=[];for(let e=32;e<128;e++)r.push(String.fromCharCode(e));return r}const Um={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:pTe(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},D8=1024,L8=.9,N8=1.2,jX=3;let ZC=new $X(jX);function gTe(r,e){let t;typeof e=="string"?t=new Set(Array.from(e)):t=new Set(e);const n=ZC.get(r);if(!n)return t;for(const i in n.mapping)t.has(i)&&t.delete(i);return t}function mTe(r,e){for(let t=0;t<r.length;t++)e.data[4*t+3]=r[t]}function F8(r,e,t,n){r.font=`${n} ${t}px ${e}`,r.fillStyle="#000",r.textBaseline="alphabetic",r.textAlign="left"}function yTe(r){Rr.assert(Number.isFinite(r)&&r>=jX,"Invalid cache limit"),ZC=new $X(r)}class bTe{constructor(){this.props={...Um}}get atlas(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:t}=this.props;return(e*N8+t*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const t=gTe(this._key,this.props.characterSet),n=ZC.get(this._key);if(n&&t.size===0){this._atlas!==n&&(this._atlas=n);return}const i=this._generateFontAtlas(t,n);this._atlas=i,ZC.set(this._key,i)}_generateFontAtlas(e,t){const{fontFamily:n,fontWeight:i,fontSize:s,buffer:a,sdf:o,radius:u,cutoff:f}=this.props;let g=t&&t.data;g||(g=document.createElement("canvas"),g.width=D8);const y=g.getContext("2d",{willReadFrequently:!0});F8(y,n,s,i);const{mapping:A,canvasHeight:C,xOffset:M,yOffset:k}=lTe({getFontWidth:D=>y.measureText(D).width,fontHeight:s*N8,buffer:a,characterSet:e,maxCanvasWidth:D8,...t&&{mapping:t.mapping,xOffset:t.xOffset,yOffset:t.yOffset}});if(g.height!==C){const D=y.getImageData(0,0,g.width,g.height);g.height=C,y.putImageData(D,0,0)}if(F8(y,n,s,i),o){const D=new iTe({fontSize:s,buffer:a,radius:u,cutoff:f,fontFamily:n,fontWeight:`${i}`});for(const V of e){const{data:W,width:z,height:$,glyphTop:te}=D.draw(V);A[V].width=z,A[V].layoutOffsetY=s*L8-te;const le=y.createImageData(z,$);mTe(W,le),y.putImageData(le,A[V].x,A[V].y)}}else for(const D of e)y.fillText(D,A[D].x,A[D].y+a+s*L8);return{xOffset:M,yOffset:k,mapping:A,data:g,width:g.width,height:g.height}}_getKey(){const{fontFamily:e,fontWeight:t,fontSize:n,buffer:i,sdf:s,radius:a,cutoff:o}=this.props;return s?`${e} ${t} ${n} ${i} ${a} ${o}`:`${e} ${t} ${n} ${i}`}}const U8=`uniform textBackgroundUniforms {
  bool billboard;
  float sizeScale;
  float sizeMinPixels;
  float sizeMaxPixels;
  vec4 borderRadius;
  vec4 padding;
  highp int sizeUnits;
  bool stroked;
} textBackground;
`,_Te={name:"textBackground",vs:U8,fs:U8,uniformTypes:{billboard:"f32",sizeScale:"f32",sizeMinPixels:"f32",sizeMaxPixels:"f32",borderRadius:"vec4<f32>",padding:"vec4<f32>",sizeUnits:"i32",stroked:"f32"}},vTe=`#version 300 es
#define SHADER_NAME text-background-layer-vertex-shader
in vec2 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceRects;
in float instanceSizes;
in float instanceAngles;
in vec2 instancePixelOffsets;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
out vec4 vFillColor;
out vec4 vLineColor;
out float vLineWidth;
out vec2 uv;
out vec2 dimensions;
vec2 rotate_by_angle(vec2 vertex, float angle) {
float angle_radian = radians(angle);
float cos_angle = cos(angle_radian);
float sin_angle = sin(angle_radian);
mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
return rotationMatrix * vertex;
}
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = positions;
geometry.pickingColor = instancePickingColors;
uv = positions;
vLineWidth = instanceLineWidths;
float sizePixels = clamp(
project_size_to_pixel(instanceSizes * textBackground.sizeScale, textBackground.sizeUnits),
textBackground.sizeMinPixels, textBackground.sizeMaxPixels
);
dimensions = instanceRects.zw * sizePixels + textBackground.padding.xy + textBackground.padding.zw;
vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-textBackground.padding.xy, textBackground.padding.zw, positions);
pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
pixelOffset += instancePixelOffsets;
pixelOffset.y *= -1.0;
if (textBackground.billboard)  {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = vec3(pixelOffset, 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
DECKGL_FILTER_SIZE(offset_common, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,ATe=`#version 300 es
#define SHADER_NAME text-background-layer-fragment-shader
precision highp float;
in vec4 vFillColor;
in vec4 vLineColor;
in float vLineWidth;
in vec2 uv;
in vec2 dimensions;
out vec4 fragColor;
float round_rect(vec2 p, vec2 size, vec4 radii) {
vec2 pixelPositionCB = (p - 0.5) * size;
vec2 sizeCB = size * 0.5;
float maxBorderRadius = min(size.x, size.y) * 0.5;
vec4 borderRadius = vec4(min(radii, maxBorderRadius));
borderRadius.xy =
(pixelPositionCB.x > 0.0) ? borderRadius.xy : borderRadius.zw;
borderRadius.x = (pixelPositionCB.y > 0.0) ? borderRadius.x : borderRadius.y;
vec2 q = abs(pixelPositionCB) - sizeCB + borderRadius.x;
return -(min(max(q.x, q.y), 0.0) + length(max(q, 0.0)) - borderRadius.x);
}
float rect(vec2 p, vec2 size) {
vec2 pixelPosition = p * size;
return min(min(pixelPosition.x, size.x - pixelPosition.x),
min(pixelPosition.y, size.y - pixelPosition.y));
}
vec4 get_stroked_fragColor(float dist) {
float isBorder = smoothedge(dist, vLineWidth);
return mix(vFillColor, vLineColor, isBorder);
}
void main(void) {
geometry.uv = uv;
if (textBackground.borderRadius != vec4(0.0)) {
float distToEdge = round_rect(uv, dimensions, textBackground.borderRadius);
if (textBackground.stroked) {
fragColor = get_stroked_fragColor(distToEdge);
} else {
fragColor = vFillColor;
}
float shapeAlpha = smoothedge(-distToEdge, 0.0);
fragColor.a *= shapeAlpha;
} else {
if (textBackground.stroked) {
float distToEdge = rect(uv, dimensions);
fragColor = get_stroked_fragColor(distToEdge);
} else {
fragColor = vFillColor;
}
}
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,xTe={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,borderRadius:{type:"object",value:0},padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:r=>r.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class HO extends oo{getShaders(){return super.getShaders({vs:vTe,fs:ATe,modules:[$s,Ja,_Te]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:t}=e;t.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){const{billboard:t,sizeScale:n,sizeUnits:i,sizeMinPixels:s,sizeMaxPixels:a,getLineWidth:o}=this.props;let{padding:u,borderRadius:f}=this.props;u.length<4&&(u=[u[0],u[1],u[0],u[1]]),Array.isArray(f)||(f=[f,f,f,f]);const g=this.state.model,y={billboard:t,stroked:!!o,borderRadius:f,padding:u,sizeUnits:Go[i],sizeScale:n,sizeMinPixels:s,sizeMaxPixels:a};g.shaderInputs.setProps({textBackground:y}),g.draw(this.context.renderPass)}_getModel(){const e=[0,0,1,0,0,1,1,1];return new Mi(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new To({topology:"triangle-strip",vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(e)}}}),isInstanced:!0})}}HO.defaultProps=xTe;HO.layerName="TextBackgroundLayer";const z8={start:1,middle:0,end:-1},V8={top:1,center:0,bottom:-1},rP=[0,0,0,255],wTe=1,CTe={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:rP},getBorderWidth:{type:"accessor",value:0},backgroundBorderRadius:{type:"object",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:Um.characterSet},fontFamily:Um.fontFamily,fontWeight:Um.fontWeight,lineHeight:wTe,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:rP},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:r=>r.text},getPosition:{type:"accessor",value:r=>r.position},getColor:{type:"accessor",value:rP},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class WS extends Zc{constructor(){super(...arguments),this.getBoundingRect=(e,t)=>{let{size:[n,i]}=this.transformParagraph(e,t);const{fontSize:s}=this.state.fontAtlasManager.props;n/=s,i/=s;const{getTextAnchor:a,getAlignmentBaseline:o}=this.props,u=z8[typeof a=="function"?a(e,t):a],f=V8[typeof o=="function"?o(e,t):o];return[(u-1)*n/2,(f-1)*i/2,n,i]},this.getIconOffsets=(e,t)=>{const{getTextAnchor:n,getAlignmentBaseline:i}=this.props,{x:s,y:a,rowWidth:o,size:[u,f]}=this.transformParagraph(e,t),g=z8[typeof n=="function"?n(e,t):n],y=V8[typeof i=="function"?i(e,t):i],A=s.length,C=new Array(A*2);let M=0;for(let k=0;k<A;k++){const D=(1-g)*(u-o[k])/2;C[M++]=(g-1)*u/2+D+s[k],C[M++]=(y-1)*f/2+a[k]}return C}}initializeState(){this.state={styleVersion:0,fontAtlasManager:new bTe},this.props.maxWidth>0&&Rr.once(1,"v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:t,oldProps:n,changeFlags:i}=e;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||t.lineHeight!==n.lineHeight||t.wordBreak!==n.wordBreak||t.maxWidth!==n.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:t,fontWeight:n}=this.props,{fontAtlasManager:i,characterSet:s}=this.state,a={...e,characterSet:s,fontFamily:t,fontWeight:n};if(!i.mapping)return i.setProps(a),!0;for(const o in a)if(a[o]!==i.props[o])return i.setProps(a),!0;return!1}_updateText(){const{data:e,characterSet:t}=this.props,n=e.attributes?.getText;let{getText:i}=this.props,s=e.startIndices,a;const o=t==="auto"&&new Set;if(n&&s){const{texts:u,characterCount:f}=fTe({...ArrayBuffer.isView(n)?{value:n}:n,length:e.length,startIndices:s,characterSet:o});a=f,i=(g,{index:y})=>u[y]}else{const{iterable:u,objectInfo:f}=Sd(e);s=[0],a=0;for(const g of u){f.index++;const y=Array.from(i(g,f)||"");o&&y.forEach(o.add,o),a+=y.length,s.push(a)}}this.setState({getText:i,startIndices:s,numInstances:a,characterSet:o||t})}transformParagraph(e,t){const{fontAtlasManager:n}=this.state,i=n.mapping,s=this.state.getText,{wordBreak:a,lineHeight:o,maxWidth:u}=this.props,f=s(e,t)||"";return dTe(f,o,a,u*n.props.fontSize,i)}renderLayers(){const{startIndices:e,numInstances:t,getText:n,fontAtlasManager:{scale:i,atlas:s,mapping:a},styleVersion:o}=this.state,{data:u,_dataDiff:f,getPosition:g,getColor:y,getSize:A,getAngle:C,getPixelOffset:M,getBackgroundColor:k,getBorderColor:D,getBorderWidth:V,backgroundBorderRadius:W,backgroundPadding:z,background:$,billboard:te,fontSettings:le,outlineWidth:_e,outlineColor:se,sizeScale:Y,sizeUnits:ce,sizeMinPixels:oe,sizeMaxPixels:Me,transitions:ze,updateTriggers:Ve}=this.props,lt=this.getSubLayerClass("characters",GO),gt=this.getSubLayerClass("background",HO);return[$&&new gt({getFillColor:k,getLineColor:D,getLineWidth:V,borderRadius:W,padding:z,getPosition:g,getSize:A,getAngle:C,getPixelOffset:M,billboard:te,sizeScale:Y,sizeUnits:ce,sizeMinPixels:oe,sizeMaxPixels:Me,transitions:ze&&{getPosition:ze.getPosition,getAngle:ze.getAngle,getSize:ze.getSize,getFillColor:ze.getBackgroundColor,getLineColor:ze.getBorderColor,getLineWidth:ze.getBorderWidth,getPixelOffset:ze.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:Ve.getPosition,getAngle:Ve.getAngle,getSize:Ve.getSize,getFillColor:Ve.getBackgroundColor,getLineColor:Ve.getBorderColor,getLineWidth:Ve.getBorderWidth,getPixelOffset:Ve.getPixelOffset,getBoundingRect:{getText:Ve.getText,getTextAnchor:Ve.getTextAnchor,getAlignmentBaseline:Ve.getAlignmentBaseline,styleVersion:o}}}),{data:u.attributes&&u.attributes.background?{length:u.length,attributes:u.attributes.background}:u,_dataDiff:f,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new lt({sdf:le.sdf,smoothing:Number.isFinite(le.smoothing)?le.smoothing:Um.smoothing,outlineWidth:_e/(le.radius||Um.radius),outlineColor:se,iconAtlas:s,iconMapping:a,getPosition:g,getColor:y,getSize:A,getAngle:C,getPixelOffset:M,billboard:te,sizeScale:Y*i,sizeUnits:ce,sizeMinPixels:oe*i,sizeMaxPixels:Me*i,transitions:ze&&{getPosition:ze.getPosition,getAngle:ze.getAngle,getColor:ze.getColor,getSize:ze.getSize,getPixelOffset:ze.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:Ve.getText,getPosition:Ve.getPosition,getAngle:Ve.getAngle,getColor:Ve.getColor,getSize:Ve.getSize,getPixelOffset:Ve.getPixelOffset,getIconOffsets:{getTextAnchor:Ve.getTextAnchor,getAlignmentBaseline:Ve.getAlignmentBaseline,styleVersion:o}}}),{data:u,_dataDiff:f,startIndices:e,numInstances:t,getIconOffsets:this.getIconOffsets,getIcon:n})]}static set fontAtlasCacheLimit(e){yTe(e)}}WS.defaultProps=CTe;WS.layerName="TextLayer";const Ow={circle:{type:jS,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:Yv,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:WS,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},Dw={type:xp,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},VB={type:ky,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function t0({type:r,props:e}){const t={};for(const n in e)t[n]=r.defaultProps[e[n]];return t}function nP(r,e){const{transitions:t,updateTriggers:n}=r.props,i={updateTriggers:{},transitions:t&&{getPosition:t.geometry}};for(const s in e){const a=e[s];let o=r.props[s];s.startsWith("get")&&(o=r.getSubLayerAccessor(o),i.updateTriggers[a]=n[s],t&&(i.transitions[a]=t[s])),i[a]=o}return i}function TTe(r){if(Array.isArray(r))return r;switch(Rr.assert(r.type,"GeoJSON does not have type"),r.type){case"Feature":return[r];case"FeatureCollection":return Rr.assert(Array.isArray(r.features),"GeoJSON does not have features array"),r.features;default:return[{geometry:r}]}}function $8(r,e,t={}){const n={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:s=r.length}=t;for(let a=i;a<s;a++){const o=r[a],{geometry:u}=o;if(u)if(u.type==="GeometryCollection"){Rr.assert(Array.isArray(u.geometries),"GeoJSON does not have geometries array");const{geometries:f}=u;for(let g=0;g<f.length;g++){const y=f[g];j8(y,n,e,o,a)}}else j8(u,n,e,o,a)}return n}function j8(r,e,t,n,i){const{type:s,coordinates:a}=r,{pointFeatures:o,lineFeatures:u,polygonFeatures:f,polygonOutlineFeatures:g}=e;if(!ETe(s,a)){Rr.warn(`${s} coordinates are malformed`)();return}switch(s){case"Point":o.push(t({geometry:r},n,i));break;case"MultiPoint":a.forEach(y=>{o.push(t({geometry:{type:"Point",coordinates:y}},n,i))});break;case"LineString":u.push(t({geometry:r},n,i));break;case"MultiLineString":a.forEach(y=>{u.push(t({geometry:{type:"LineString",coordinates:y}},n,i))});break;case"Polygon":f.push(t({geometry:r},n,i)),a.forEach(y=>{g.push(t({geometry:{type:"LineString",coordinates:y}},n,i))});break;case"MultiPolygon":a.forEach(y=>{f.push(t({geometry:{type:"Polygon",coordinates:y}},n,i)),y.forEach(A=>{g.push(t({geometry:{type:"LineString",coordinates:A}},n,i))})});break}}const STe={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function ETe(r,e){let t=STe[r];for(Rr.assert(t,`Unknown GeoJSON type ${r}`);e&&--t>0;)e=e[0];return e&&Number.isFinite(e[0])}function GX(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function px(r){return r.geometry.coordinates}function ITe(r,e){const t=GX(),{pointFeatures:n,lineFeatures:i,polygonFeatures:s,polygonOutlineFeatures:a}=r;return t.points.data=n,t.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),t.points.getPosition=px,t.lines.data=i,t.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),t.lines.getPath=px,t.polygons.data=s,t.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),t.polygons.getPolygon=px,t.polygonsOutline.data=a,t.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),t.polygonsOutline.getPath=px,t}function PTe(r,e){const t=GX(),{points:n,lines:i,polygons:s}=r,a=eTe(r,e);t.points.data={length:n.positions.value.length/n.positions.size,attributes:{...n.attributes,getPosition:n.positions,instancePickingColors:{size:4,value:a.points}},properties:n.properties,numericProps:n.numericProps,featureIds:n.featureIds},t.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:4,value:a.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},t.lines._pathType="open";const o=s.positions.value.length/s.positions.size,u=Array(o).fill(1);for(const f of s.primitivePolygonIndices.value)u[f-1]=0;return t.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:{...s.attributes,getPolygon:s.positions,instanceVertexValid:{size:1,value:new Uint16Array(u)},pickingColors:{size:4,value:a.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},t.polygons._normalize=!1,s.triangles&&(t.polygons.data.attributes.indices=s.triangles.value),t.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:4,value:a.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},t.polygonsOutline._pathType="open",t}const BTe=["points","linestrings","polygons"],MTe={...t0(Ow.circle),...t0(Ow.icon),...t0(Ow.text),...t0(Dw),...t0(VB),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:r=>r.properties.icon},getText:{type:"accessor",value:r=>r.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class Oy extends Zc{initializeState(){this.state={layerProps:{},features:{},featuresDiff:{}}}updateState({props:e,changeFlags:t}){if(!t.dataChanged)return;const{data:n}=this.props,i=n&&"points"in n&&"polygons"in n&&"lines"in n;this.setState({binary:i}),i?this._updateStateBinary({props:e,changeFlags:t}):this._updateStateJSON({props:e,changeFlags:t})}_updateStateBinary({props:e,changeFlags:t}){const n=PTe(e.data,this.encodePickingColor);this.setState({layerProps:n})}_updateStateJSON({props:e,changeFlags:t}){const n=TTe(e.data),i=this.getSubLayerRow.bind(this);let s={};const a={};if(Array.isArray(t.dataChanged)){const u=this.state.features;for(const f in u)s[f]=u[f].slice(),a[f]=[];for(const f of t.dataChanged){const g=$8(n,i,f);for(const y in u)a[y].push(FX({data:s[y],getIndex:A=>A.__source.index,dataRange:f,replace:g[y]}))}}else s=$8(n,i);const o=ITe(s,a);this.setState({features:s,featuresDiff:a,layerProps:o})}getPickingInfo(e){const t=super.getPickingInfo(e),{index:n,sourceLayer:i}=t;return t.featureType=BTe.find(s=>i.id.startsWith(`${this.id}-${s}-`)),n>=0&&i.id.startsWith(`${this.id}-points-text`)&&this.state.binary&&(t.index=this.props.data.points.globalFeatureIds.value[n]),t}_updateAutoHighlight(e){const t=`${this.id}-points-`,n=e.featureType==="points";for(const i of this.getSubLayers())i.id.startsWith(t)===n&&i.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:t}=this.props,{layerProps:n}=this.state,i="polygons-fill",s=this.shouldRenderSubLayer(i,n.polygons?.data)&&this.getSubLayerClass(i,VB.type);if(s){const a=nP(this,VB.props),o=e&&t;return o||delete a.getLineColor,a.updateTriggers.lineColors=o,new s(a,this.getSubLayerProps({id:i,updateTriggers:a.updateTriggers}),n.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:t}=this.props,{layerProps:n}=this.state,i="polygons-stroke",s="linestrings",a=!e&&t&&this.shouldRenderSubLayer(i,n.polygonsOutline?.data)&&this.getSubLayerClass(i,Dw.type),o=this.shouldRenderSubLayer(s,n.lines?.data)&&this.getSubLayerClass(s,Dw.type);if(a||o){const u=nP(this,Dw.props);return[a&&new a(u,this.getSubLayerProps({id:i,updateTriggers:u.updateTriggers}),n.polygonsOutline),o&&new o(u,this.getSubLayerProps({id:s,updateTriggers:u.updateTriggers}),n.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:t,binary:n}=this.state;let{highlightedObjectIndex:i}=this.props;!n&&Number.isFinite(i)&&(i=t.points.data.findIndex(o=>o.__source.index===i));const s=new Set(e.split("+")),a=[];for(const o of s){const u=`points-${o}`,f=Ow[o],g=f&&this.shouldRenderSubLayer(u,t.points?.data)&&this.getSubLayerClass(u,f.type);if(g){const y=nP(this,f.props);let A=t.points;if(o==="text"&&n){const{instancePickingColors:C,...M}=A.data.attributes;A={...A,data:{...A.data,attributes:M}}}a.push(new g(y,this.getSubLayerProps({id:u,updateTriggers:y.updateTriggers,highlightedObjectIndex:i}),A))}}return a}renderLayers(){const{extruded:e}=this.props,t=this._renderPolygonLayer(),n=this._renderLineLayers(),i=this._renderPointLayers();return[!e&&t,n,i,e&&t]}getSubLayerAccessor(e){const{binary:t}=this.state;return!t||typeof e!="function"?super.getSubLayerAccessor(e):(n,i)=>{const{data:s,index:a}=i,o=ZCe(s,a);return e(o,i)}}}Oy.layerName="GeoJsonLayer";Oy.defaultProps=MTe;function RTe(r){return typeof r=="string"?r.charAt(0).toLowerCase()+r.slice(1):r}function $B(r){if(Array.isArray(r))return r.map(e=>$B(e));if(r&&typeof r=="object"){const e={};for(const[t,n]of Object.entries(r))e[RTe(t)]=$B(n);return e}return r}var WO={},KS={};(function(r){const e=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",t=e+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",n="["+e+"]["+t+"]*",i=new RegExp("^"+n+"$"),s=function(o,u){const f=[];let g=u.exec(o);for(;g;){const y=[];y.startIndex=u.lastIndex-g[0].length;const A=g.length;for(let C=0;C<A;C++)y.push(g[C]);f.push(y),g=u.exec(o)}return f},a=function(o){const u=i.exec(o);return!(u===null||typeof u>"u")};r.isExist=function(o){return typeof o<"u"},r.isEmptyObject=function(o){return Object.keys(o).length===0},r.merge=function(o,u,f){if(u){const g=Object.keys(u),y=g.length;for(let A=0;A<y;A++)f==="strict"?o[g[A]]=[u[g[A]]]:o[g[A]]=u[g[A]]}},r.getValue=function(o){return r.isExist(o)?o:""},r.isName=a,r.getAllMatches=s,r.nameRegexp=n})(KS);const KO=KS,kTe={allowBooleanAttributes:!1,unpairedTags:[]};WO.validate=function(r,e){e=Object.assign({},kTe,e);const t=[];let n=!1,i=!1;r[0]==="\uFEFF"&&(r=r.substr(1));for(let s=0;s<r.length;s++)if(r[s]==="<"&&r[s+1]==="?"){if(s+=2,s=H8(r,s),s.err)return s}else if(r[s]==="<"){let a=s;if(s++,r[s]==="!"){s=W8(r,s);continue}else{let o=!1;r[s]==="/"&&(o=!0,s++);let u="";for(;s<r.length&&r[s]!==">"&&r[s]!==" "&&r[s]!=="	"&&r[s]!==`
`&&r[s]!=="\r";s++)u+=r[s];if(u=u.trim(),u[u.length-1]==="/"&&(u=u.substring(0,u.length-1),s--),!VTe(u)){let y;return u.trim().length===0?y="Invalid space after '<'.":y="Tag '"+u+"' is an invalid name.",Zi("InvalidTag",y,No(r,s))}const f=LTe(r,s);if(f===!1)return Zi("InvalidAttr","Attributes for '"+u+"' have open quote.",No(r,s));let g=f.value;if(s=f.index,g[g.length-1]==="/"){const y=s-g.length;g=g.substring(0,g.length-1);const A=K8(g,e);if(A===!0)n=!0;else return Zi(A.err.code,A.err.msg,No(r,y+A.err.line))}else if(o)if(f.tagClosed){if(g.trim().length>0)return Zi("InvalidTag","Closing tag '"+u+"' can't have attributes or invalid starting.",No(r,a));if(t.length===0)return Zi("InvalidTag","Closing tag '"+u+"' has not been opened.",No(r,a));{const y=t.pop();if(u!==y.tagName){let A=No(r,y.tagStartPos);return Zi("InvalidTag","Expected closing tag '"+y.tagName+"' (opened in line "+A.line+", col "+A.col+") instead of closing tag '"+u+"'.",No(r,a))}t.length==0&&(i=!0)}}else return Zi("InvalidTag","Closing tag '"+u+"' doesn't have proper closing.",No(r,s));else{const y=K8(g,e);if(y!==!0)return Zi(y.err.code,y.err.msg,No(r,s-g.length+y.err.line));if(i===!0)return Zi("InvalidXml","Multiple possible root nodes found.",No(r,s));e.unpairedTags.indexOf(u)!==-1||t.push({tagName:u,tagStartPos:a}),n=!0}for(s++;s<r.length;s++)if(r[s]==="<")if(r[s+1]==="!"){s++,s=W8(r,s);continue}else if(r[s+1]==="?"){if(s=H8(r,++s),s.err)return s}else break;else if(r[s]==="&"){const y=UTe(r,s);if(y==-1)return Zi("InvalidChar","char '&' is not expected.",No(r,s));s=y}else if(i===!0&&!G8(r[s]))return Zi("InvalidXml","Extra text at the end",No(r,s));r[s]==="<"&&s--}}else{if(G8(r[s]))continue;return Zi("InvalidChar","char '"+r[s]+"' is not expected.",No(r,s))}if(n){if(t.length==1)return Zi("InvalidTag","Unclosed tag '"+t[0].tagName+"'.",No(r,t[0].tagStartPos));if(t.length>0)return Zi("InvalidXml","Invalid '"+JSON.stringify(t.map(s=>s.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return Zi("InvalidXml","Start tag expected.",1);return!0};function G8(r){return r===" "||r==="	"||r===`
`||r==="\r"}function H8(r,e){const t=e;for(;e<r.length;e++)if(r[e]=="?"||r[e]==" "){const n=r.substr(t,e-t);if(e>5&&n==="xml")return Zi("InvalidXml","XML declaration allowed only at the start of the document.",No(r,e));if(r[e]=="?"&&r[e+1]==">"){e++;break}else continue}return e}function W8(r,e){if(r.length>e+5&&r[e+1]==="-"&&r[e+2]==="-"){for(e+=3;e<r.length;e++)if(r[e]==="-"&&r[e+1]==="-"&&r[e+2]===">"){e+=2;break}}else if(r.length>e+8&&r[e+1]==="D"&&r[e+2]==="O"&&r[e+3]==="C"&&r[e+4]==="T"&&r[e+5]==="Y"&&r[e+6]==="P"&&r[e+7]==="E"){let t=1;for(e+=8;e<r.length;e++)if(r[e]==="<")t++;else if(r[e]===">"&&(t--,t===0))break}else if(r.length>e+9&&r[e+1]==="["&&r[e+2]==="C"&&r[e+3]==="D"&&r[e+4]==="A"&&r[e+5]==="T"&&r[e+6]==="A"&&r[e+7]==="["){for(e+=8;e<r.length;e++)if(r[e]==="]"&&r[e+1]==="]"&&r[e+2]===">"){e+=2;break}}return e}const OTe='"',DTe="'";function LTe(r,e){let t="",n="",i=!1;for(;e<r.length;e++){if(r[e]===OTe||r[e]===DTe)n===""?n=r[e]:n!==r[e]||(n="");else if(r[e]===">"&&n===""){i=!0;break}t+=r[e]}return n!==""?!1:{value:t,index:e,tagClosed:i}}const NTe=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function K8(r,e){const t=KO.getAllMatches(r,NTe),n={};for(let i=0;i<t.length;i++){if(t[i][1].length===0)return Zi("InvalidAttr","Attribute '"+t[i][2]+"' has no space in starting.",r0(t[i]));if(t[i][3]!==void 0&&t[i][4]===void 0)return Zi("InvalidAttr","Attribute '"+t[i][2]+"' is without value.",r0(t[i]));if(t[i][3]===void 0&&!e.allowBooleanAttributes)return Zi("InvalidAttr","boolean attribute '"+t[i][2]+"' is not allowed.",r0(t[i]));const s=t[i][2];if(!zTe(s))return Zi("InvalidAttr","Attribute '"+s+"' is an invalid name.",r0(t[i]));if(!n.hasOwnProperty(s))n[s]=1;else return Zi("InvalidAttr","Attribute '"+s+"' is repeated.",r0(t[i]))}return!0}function FTe(r,e){let t=/\d/;for(r[e]==="x"&&(e++,t=/[\da-fA-F]/);e<r.length;e++){if(r[e]===";")return e;if(!r[e].match(t))break}return-1}function UTe(r,e){if(e++,r[e]===";")return-1;if(r[e]==="#")return e++,FTe(r,e);let t=0;for(;e<r.length;e++,t++)if(!(r[e].match(/\w/)&&t<20)){if(r[e]===";")break;return-1}return e}function Zi(r,e,t){return{err:{code:r,msg:e,line:t.line||t,col:t.col}}}function zTe(r){return KO.isName(r)}function VTe(r){return KO.isName(r)}function No(r,e){const t=r.substring(0,e).split(/\r?\n/);return{line:t.length,col:t[t.length-1].length+1}}function r0(r){return r.startIndex+r[1].length}var XO={};const HX={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(r,e){return e},attributeValueProcessor:function(r,e){return e},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(r,e,t){return r}},$Te=function(r){return Object.assign({},HX,r)};XO.buildOptions=$Te;XO.defaultOptions=HX;class jTe{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,t){e==="__proto__"&&(e="#__proto__"),this.child.push({[e]:t})}addChild(e){e.tagname==="__proto__"&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child})}}var GTe=jTe;const HTe=KS;function WTe(r,e){const t={};if(r[e+3]==="O"&&r[e+4]==="C"&&r[e+5]==="T"&&r[e+6]==="Y"&&r[e+7]==="P"&&r[e+8]==="E"){e=e+9;let n=1,i=!1,s=!1,a="";for(;e<r.length;e++)if(r[e]==="<"&&!s){if(i&&JTe(r,e)){e+=7;let o,u;[o,u,e]=KTe(r,e+1),u.indexOf("&")===-1&&(t[QTe(o)]={regx:RegExp(`&${o};`,"g"),val:u})}else if(i&&qTe(r,e))e+=8;else if(i&&YTe(r,e))e+=8;else if(i&&ZTe(r,e))e+=9;else if(XTe)s=!0;else throw new Error("Invalid DOCTYPE");n++,a=""}else if(r[e]===">"){if(s?r[e-1]==="-"&&r[e-2]==="-"&&(s=!1,n--):n--,n===0)break}else r[e]==="["?i=!0:a+=r[e];if(n!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:t,i:e}}function KTe(r,e){let t="";for(;e<r.length&&r[e]!=="'"&&r[e]!=='"';e++)t+=r[e];if(t=t.trim(),t.indexOf(" ")!==-1)throw new Error("External entites are not supported");const n=r[e++];let i="";for(;e<r.length&&r[e]!==n;e++)i+=r[e];return[t,i,e]}function XTe(r,e){return r[e+1]==="!"&&r[e+2]==="-"&&r[e+3]==="-"}function JTe(r,e){return r[e+1]==="!"&&r[e+2]==="E"&&r[e+3]==="N"&&r[e+4]==="T"&&r[e+5]==="I"&&r[e+6]==="T"&&r[e+7]==="Y"}function qTe(r,e){return r[e+1]==="!"&&r[e+2]==="E"&&r[e+3]==="L"&&r[e+4]==="E"&&r[e+5]==="M"&&r[e+6]==="E"&&r[e+7]==="N"&&r[e+8]==="T"}function YTe(r,e){return r[e+1]==="!"&&r[e+2]==="A"&&r[e+3]==="T"&&r[e+4]==="T"&&r[e+5]==="L"&&r[e+6]==="I"&&r[e+7]==="S"&&r[e+8]==="T"}function ZTe(r,e){return r[e+1]==="!"&&r[e+2]==="N"&&r[e+3]==="O"&&r[e+4]==="T"&&r[e+5]==="A"&&r[e+6]==="T"&&r[e+7]==="I"&&r[e+8]==="O"&&r[e+9]==="N"}function QTe(r){if(HTe.isName(r))return r;throw new Error(`Invalid entity name ${r}`)}var eSe=WTe;const tSe=/^[-+]?0x[a-fA-F0-9]+$/,rSe=/^([\-\+])?(0*)([0-9]*(\.[0-9]*)?)$/,nSe={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function iSe(r,e={}){if(e=Object.assign({},nSe,e),!r||typeof r!="string")return r;let t=r.trim();if(e.skipLike!==void 0&&e.skipLike.test(t))return r;if(r==="0")return 0;if(e.hex&&tSe.test(t))return oSe(t,16);if(t.search(/[eE]/)!==-1){const n=t.match(/^([-\+])?(0*)([0-9]*(\.[0-9]*)?[eE][-\+]?[0-9]+)$/);if(n){if(e.leadingZeros)t=(n[1]||"")+n[3];else if(!(n[2]==="0"&&n[3][0]==="."))return r;return e.eNotation?Number(t):r}else return r}else{const n=rSe.exec(t);if(n){const i=n[1],s=n[2];let a=sSe(n[3]);if(!e.leadingZeros&&s.length>0&&i&&t[2]!==".")return r;if(!e.leadingZeros&&s.length>0&&!i&&t[1]!==".")return r;if(e.leadingZeros&&s===r)return 0;{const o=Number(t),u=""+o;return u.search(/[eE]/)!==-1?e.eNotation?o:r:t.indexOf(".")!==-1?u==="0"&&a===""||u===a||i&&u==="-"+a?o:r:s?a===u||i+a===u?o:r:t===u||t===i+u?o:r}}else return r}}function sSe(r){return r&&r.indexOf(".")!==-1&&(r=r.replace(/0+$/,""),r==="."?r="0":r[0]==="."?r="0"+r:r[r.length-1]==="."&&(r=r.substr(0,r.length-1))),r}function oSe(r,e){if(parseInt)return parseInt(r,e);if(Number.parseInt)return Number.parseInt(r,e);if(window&&window.parseInt)return window.parseInt(r,e);throw new Error("parseInt, Number.parseInt, window.parseInt are not supported")}var aSe=iSe;function lSe(r){return typeof r=="function"?r:Array.isArray(r)?e=>{for(const t of r)if(typeof t=="string"&&e===t||t instanceof RegExp&&t.test(e))return!0}:()=>!1}var WX=lSe;const KX=KS,n0=GTe,cSe=eSe,uSe=aSe,hSe=WX;let dSe=class{constructor(e){this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:""},pound:{regex:/&(pound|#163);/g,val:""},yen:{regex:/&(yen|#165);/g,val:""},euro:{regex:/&(euro|#8364);/g,val:""},copyright:{regex:/&(copy|#169);/g,val:""},reg:{regex:/&(reg|#174);/g,val:""},inr:{regex:/&(inr|#8377);/g,val:""},num_dec:{regex:/&#([0-9]{1,7});/g,val:(t,n)=>String.fromCharCode(Number.parseInt(n,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(t,n)=>String.fromCharCode(Number.parseInt(n,16))}},this.addExternalEntities=fSe,this.parseXml=bSe,this.parseTextData=pSe,this.resolveNameSpace=gSe,this.buildAttributesMap=ySe,this.isItStopNode=xSe,this.replaceEntitiesValue=vSe,this.readStopNodeData=CSe,this.saveTextToParentTag=ASe,this.addChild=_Se,this.ignoreAttributesFn=hSe(this.options.ignoreAttributes)}};function fSe(r){const e=Object.keys(r);for(let t=0;t<e.length;t++){const n=e[t];this.lastEntities[n]={regex:new RegExp("&"+n+";","g"),val:r[n]}}}function pSe(r,e,t,n,i,s,a){if(r!==void 0&&(this.options.trimValues&&!n&&(r=r.trim()),r.length>0)){a||(r=this.replaceEntitiesValue(r));const o=this.options.tagValueProcessor(e,r,t,i,s);return o==null?r:typeof o!=typeof r||o!==r?o:this.options.trimValues?GB(r,this.options.parseTagValue,this.options.numberParseOptions):r.trim()===r?GB(r,this.options.parseTagValue,this.options.numberParseOptions):r}}function gSe(r){if(this.options.removeNSPrefix){const e=r.split(":"),t=r.charAt(0)==="/"?"/":"";if(e[0]==="xmlns")return"";e.length===2&&(r=t+e[1])}return r}const mSe=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function ySe(r,e,t){if(this.options.ignoreAttributes!==!0&&typeof r=="string"){const n=KX.getAllMatches(r,mSe),i=n.length,s={};for(let a=0;a<i;a++){const o=this.resolveNameSpace(n[a][1]);if(this.ignoreAttributesFn(o,e))continue;let u=n[a][4],f=this.options.attributeNamePrefix+o;if(o.length)if(this.options.transformAttributeName&&(f=this.options.transformAttributeName(f)),f==="__proto__"&&(f="#__proto__"),u!==void 0){this.options.trimValues&&(u=u.trim()),u=this.replaceEntitiesValue(u);const g=this.options.attributeValueProcessor(o,u,e);g==null?s[f]=u:typeof g!=typeof u||g!==u?s[f]=g:s[f]=GB(u,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(s[f]=!0)}if(!Object.keys(s).length)return;if(this.options.attributesGroupName){const a={};return a[this.options.attributesGroupName]=s,a}return s}}const bSe=function(r){r=r.replace(/\r\n?/g,`
`);const e=new n0("!xml");let t=e,n="",i="";for(let s=0;s<r.length;s++)if(r[s]==="<")if(r[s+1]==="/"){const o=zf(r,">",s,"Closing Tag is not closed.");let u=r.substring(s+2,o).trim();if(this.options.removeNSPrefix){const y=u.indexOf(":");y!==-1&&(u=u.substr(y+1))}this.options.transformTagName&&(u=this.options.transformTagName(u)),t&&(n=this.saveTextToParentTag(n,t,i));const f=i.substring(i.lastIndexOf(".")+1);if(u&&this.options.unpairedTags.indexOf(u)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${u}>`);let g=0;f&&this.options.unpairedTags.indexOf(f)!==-1?(g=i.lastIndexOf(".",i.lastIndexOf(".")-1),this.tagsNodeStack.pop()):g=i.lastIndexOf("."),i=i.substring(0,g),t=this.tagsNodeStack.pop(),n="",s=o}else if(r[s+1]==="?"){let o=jB(r,s,!1,"?>");if(!o)throw new Error("Pi Tag is not closed.");if(n=this.saveTextToParentTag(n,t,i),!(this.options.ignoreDeclaration&&o.tagName==="?xml"||this.options.ignorePiTags)){const u=new n0(o.tagName);u.add(this.options.textNodeName,""),o.tagName!==o.tagExp&&o.attrExpPresent&&(u[":@"]=this.buildAttributesMap(o.tagExp,i,o.tagName)),this.addChild(t,u,i)}s=o.closeIndex+1}else if(r.substr(s+1,3)==="!--"){const o=zf(r,"-->",s+4,"Comment is not closed.");if(this.options.commentPropName){const u=r.substring(s+4,o-2);n=this.saveTextToParentTag(n,t,i),t.add(this.options.commentPropName,[{[this.options.textNodeName]:u}])}s=o}else if(r.substr(s+1,2)==="!D"){const o=cSe(r,s);this.docTypeEntities=o.entities,s=o.i}else if(r.substr(s+1,2)==="!["){const o=zf(r,"]]>",s,"CDATA is not closed.")-2,u=r.substring(s+9,o);n=this.saveTextToParentTag(n,t,i);let f=this.parseTextData(u,t.tagname,i,!0,!1,!0,!0);f==null&&(f=""),this.options.cdataPropName?t.add(this.options.cdataPropName,[{[this.options.textNodeName]:u}]):t.add(this.options.textNodeName,f),s=o+2}else{let o=jB(r,s,this.options.removeNSPrefix),u=o.tagName;const f=o.rawTagName;let g=o.tagExp,y=o.attrExpPresent,A=o.closeIndex;this.options.transformTagName&&(u=this.options.transformTagName(u)),t&&n&&t.tagname!=="!xml"&&(n=this.saveTextToParentTag(n,t,i,!1));const C=t;if(C&&this.options.unpairedTags.indexOf(C.tagname)!==-1&&(t=this.tagsNodeStack.pop(),i=i.substring(0,i.lastIndexOf("."))),u!==e.tagname&&(i+=i?"."+u:u),this.isItStopNode(this.options.stopNodes,i,u)){let M="";if(g.length>0&&g.lastIndexOf("/")===g.length-1)u[u.length-1]==="/"?(u=u.substr(0,u.length-1),i=i.substr(0,i.length-1),g=u):g=g.substr(0,g.length-1),s=o.closeIndex;else if(this.options.unpairedTags.indexOf(u)!==-1)s=o.closeIndex;else{const D=this.readStopNodeData(r,f,A+1);if(!D)throw new Error(`Unexpected end of ${f}`);s=D.i,M=D.tagContent}const k=new n0(u);u!==g&&y&&(k[":@"]=this.buildAttributesMap(g,i,u)),M&&(M=this.parseTextData(M,u,i,!0,y,!0,!0)),i=i.substr(0,i.lastIndexOf(".")),k.add(this.options.textNodeName,M),this.addChild(t,k,i)}else{if(g.length>0&&g.lastIndexOf("/")===g.length-1){u[u.length-1]==="/"?(u=u.substr(0,u.length-1),i=i.substr(0,i.length-1),g=u):g=g.substr(0,g.length-1),this.options.transformTagName&&(u=this.options.transformTagName(u));const M=new n0(u);u!==g&&y&&(M[":@"]=this.buildAttributesMap(g,i,u)),this.addChild(t,M,i),i=i.substr(0,i.lastIndexOf("."))}else{const M=new n0(u);this.tagsNodeStack.push(t),u!==g&&y&&(M[":@"]=this.buildAttributesMap(g,i,u)),this.addChild(t,M,i),t=M}n="",s=A}}else n+=r[s];return e.child};function _Se(r,e,t){const n=this.options.updateTag(e.tagname,t,e[":@"]);n===!1||(typeof n=="string"&&(e.tagname=n),r.addChild(e))}const vSe=function(r){if(this.options.processEntities){for(let e in this.docTypeEntities){const t=this.docTypeEntities[e];r=r.replace(t.regx,t.val)}for(let e in this.lastEntities){const t=this.lastEntities[e];r=r.replace(t.regex,t.val)}if(this.options.htmlEntities)for(let e in this.htmlEntities){const t=this.htmlEntities[e];r=r.replace(t.regex,t.val)}r=r.replace(this.ampEntity.regex,this.ampEntity.val)}return r};function ASe(r,e,t,n){return r&&(n===void 0&&(n=e.child.length===0),r=this.parseTextData(r,e.tagname,t,!1,e[":@"]?Object.keys(e[":@"]).length!==0:!1,n),r!==void 0&&r!==""&&e.add(this.options.textNodeName,r),r=""),r}function xSe(r,e,t){const n="*."+t;for(const i in r){const s=r[i];if(n===s||e===s)return!0}return!1}function wSe(r,e,t=">"){let n,i="";for(let s=e;s<r.length;s++){let a=r[s];if(n)a===n&&(n="");else if(a==='"'||a==="'")n=a;else if(a===t[0])if(t[1]){if(r[s+1]===t[1])return{data:i,index:s}}else return{data:i,index:s};else a==="	"&&(a=" ");i+=a}}function zf(r,e,t,n){const i=r.indexOf(e,t);if(i===-1)throw new Error(n);return i+e.length-1}function jB(r,e,t,n=">"){const i=wSe(r,e+1,n);if(!i)return;let s=i.data;const a=i.index,o=s.search(/\s/);let u=s,f=!0;o!==-1&&(u=s.substring(0,o),s=s.substring(o+1).trimStart());const g=u;if(t){const y=u.indexOf(":");y!==-1&&(u=u.substr(y+1),f=u!==i.data.substr(y+1))}return{tagName:u,tagExp:s,closeIndex:a,attrExpPresent:f,rawTagName:g}}function CSe(r,e,t){const n=t;let i=1;for(;t<r.length;t++)if(r[t]==="<")if(r[t+1]==="/"){const s=zf(r,">",t,`${e} is not closed`);if(r.substring(t+2,s).trim()===e&&(i--,i===0))return{tagContent:r.substring(n,t),i:s};t=s}else if(r[t+1]==="?")t=zf(r,"?>",t+1,"StopNode is not closed.");else if(r.substr(t+1,3)==="!--")t=zf(r,"-->",t+3,"StopNode is not closed.");else if(r.substr(t+1,2)==="![")t=zf(r,"]]>",t,"StopNode is not closed.")-2;else{const s=jB(r,t,">");s&&((s&&s.tagName)===e&&s.tagExp[s.tagExp.length-1]!=="/"&&i++,t=s.closeIndex)}}function GB(r,e,t){if(e&&typeof r=="string"){const n=r.trim();return n==="true"?!0:n==="false"?!1:uSe(r,t)}else return KX.isExist(r)?r:""}var TSe=dSe,XX={};function SSe(r,e){return JX(r,e)}function JX(r,e,t){let n;const i={};for(let s=0;s<r.length;s++){const a=r[s],o=ESe(a);let u="";if(t===void 0?u=o:u=t+"."+o,o===e.textNodeName)n===void 0?n=a[o]:n+=""+a[o];else{if(o===void 0)continue;if(a[o]){let f=JX(a[o],e,u);const g=PSe(f,e);a[":@"]?ISe(f,a[":@"],u,e):Object.keys(f).length===1&&f[e.textNodeName]!==void 0&&!e.alwaysCreateTextNode?f=f[e.textNodeName]:Object.keys(f).length===0&&(e.alwaysCreateTextNode?f[e.textNodeName]="":f=""),i[o]!==void 0&&i.hasOwnProperty(o)?(Array.isArray(i[o])||(i[o]=[i[o]]),i[o].push(f)):e.isArray(o,u,g)?i[o]=[f]:i[o]=f}}}return typeof n=="string"?n.length>0&&(i[e.textNodeName]=n):n!==void 0&&(i[e.textNodeName]=n),i}function ESe(r){const e=Object.keys(r);for(let t=0;t<e.length;t++){const n=e[t];if(n!==":@")return n}}function ISe(r,e,t,n){if(e){const i=Object.keys(e),s=i.length;for(let a=0;a<s;a++){const o=i[a];n.isArray(o,t+"."+o,!0,!0)?r[o]=[e[o]]:r[o]=e[o]}}}function PSe(r,e){const{textNodeName:t}=e,n=Object.keys(r).length;return!!(n===0||n===1&&(r[t]||typeof r[t]=="boolean"||r[t]===0))}XX.prettify=SSe;const{buildOptions:BSe}=XO,MSe=TSe,{prettify:RSe}=XX,kSe=WO;let OSe=class{constructor(e){this.externalEntities={},this.options=BSe(e)}parse(e,t){if(typeof e!="string")if(e.toString)e=e.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(t){t===!0&&(t={});const s=kSe.validate(e,t);if(s!==!0)throw Error(`${s.err.msg}:${s.err.line}:${s.err.col}`)}const n=new MSe(this.options);n.addExternalEntities(this.externalEntities);const i=n.parseXml(e);return this.options.preserveOrder||i===void 0?i:RSe(i,this.options)}addEntity(e,t){if(t.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(e.indexOf("&")!==-1||e.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(t==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[e]=t}};var DSe=OSe;const LSe=`
`;function NSe(r,e){let t="";return e.format&&e.indentBy.length>0&&(t=LSe),qX(r,e,"",t)}function qX(r,e,t,n){let i="",s=!1;for(let a=0;a<r.length;a++){const o=r[a],u=FSe(o);if(u===void 0)continue;let f="";if(t.length===0?f=u:f=`${t}.${u}`,u===e.textNodeName){let M=o[u];USe(f,e)||(M=e.tagValueProcessor(u,M),M=YX(M,e)),s&&(i+=n),i+=M,s=!1;continue}else if(u===e.cdataPropName){s&&(i+=n),i+=`<![CDATA[${o[u][0][e.textNodeName]}]]>`,s=!1;continue}else if(u===e.commentPropName){i+=n+`<!--${o[u][0][e.textNodeName]}-->`,s=!0;continue}else if(u[0]==="?"){const M=X8(o[":@"],e),k=u==="?xml"?"":n;let D=o[u][0][e.textNodeName];D=D.length!==0?" "+D:"",i+=k+`<${u}${D}${M}?>`,s=!0;continue}let g=n;g!==""&&(g+=e.indentBy);const y=X8(o[":@"],e),A=n+`<${u}${y}`,C=qX(o[u],e,f,g);e.unpairedTags.indexOf(u)!==-1?e.suppressUnpairedNode?i+=A+">":i+=A+"/>":(!C||C.length===0)&&e.suppressEmptyNode?i+=A+"/>":C&&C.endsWith(">")?i+=A+`>${C}${n}</${u}>`:(i+=A+">",C&&n!==""&&(C.includes("/>")||C.includes("</"))?i+=n+e.indentBy+C+n:i+=C,i+=`</${u}>`),s=!0}return i}function FSe(r){const e=Object.keys(r);for(let t=0;t<e.length;t++){const n=e[t];if(r.hasOwnProperty(n)&&n!==":@")return n}}function X8(r,e){let t="";if(r&&!e.ignoreAttributes)for(let n in r){if(!r.hasOwnProperty(n))continue;let i=e.attributeValueProcessor(n,r[n]);i=YX(i,e),i===!0&&e.suppressBooleanAttributes?t+=` ${n.substr(e.attributeNamePrefix.length)}`:t+=` ${n.substr(e.attributeNamePrefix.length)}="${i}"`}return t}function USe(r,e){r=r.substr(0,r.length-e.textNodeName.length-1);let t=r.substr(r.lastIndexOf(".")+1);for(let n in e.stopNodes)if(e.stopNodes[n]===r||e.stopNodes[n]==="*."+t)return!0;return!1}function YX(r,e){if(r&&r.length>0&&e.processEntities)for(let t=0;t<e.entities.length;t++){const n=e.entities[t];r=r.replace(n.regex,n.val)}return r}var zSe=NSe;const VSe=zSe,$Se=WX,jSe={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(r,e){return e},attributeValueProcessor:function(r,e){return e},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function Ed(r){this.options=Object.assign({},jSe,r),this.options.ignoreAttributes===!0||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.ignoreAttributesFn=$Se(this.options.ignoreAttributes),this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=WSe),this.processTextOrObjNode=GSe,this.options.format?(this.indentate=HSe,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}Ed.prototype.build=function(r){return this.options.preserveOrder?VSe(r,this.options):(Array.isArray(r)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(r={[this.options.arrayNodeName]:r}),this.j2x(r,0,[]).val)};Ed.prototype.j2x=function(r,e,t){let n="",i="";const s=t.join(".");for(let a in r)if(Object.prototype.hasOwnProperty.call(r,a))if(typeof r[a]>"u")this.isAttribute(a)&&(i+="");else if(r[a]===null)this.isAttribute(a)||a===this.options.cdataPropName?i+="":a[0]==="?"?i+=this.indentate(e)+"<"+a+"?"+this.tagEndChar:i+=this.indentate(e)+"<"+a+"/"+this.tagEndChar;else if(r[a]instanceof Date)i+=this.buildTextValNode(r[a],a,"",e);else if(typeof r[a]!="object"){const o=this.isAttribute(a);if(o&&!this.ignoreAttributesFn(o,s))n+=this.buildAttrPairStr(o,""+r[a]);else if(!o)if(a===this.options.textNodeName){let u=this.options.tagValueProcessor(a,""+r[a]);i+=this.replaceEntitiesValue(u)}else i+=this.buildTextValNode(r[a],a,"",e)}else if(Array.isArray(r[a])){const o=r[a].length;let u="",f="";for(let g=0;g<o;g++){const y=r[a][g];if(!(typeof y>"u"))if(y===null)a[0]==="?"?i+=this.indentate(e)+"<"+a+"?"+this.tagEndChar:i+=this.indentate(e)+"<"+a+"/"+this.tagEndChar;else if(typeof y=="object")if(this.options.oneListGroup){const A=this.j2x(y,e+1,t.concat(a));u+=A.val,this.options.attributesGroupName&&y.hasOwnProperty(this.options.attributesGroupName)&&(f+=A.attrStr)}else u+=this.processTextOrObjNode(y,a,e,t);else if(this.options.oneListGroup){let A=this.options.tagValueProcessor(a,y);A=this.replaceEntitiesValue(A),u+=A}else u+=this.buildTextValNode(y,a,"",e)}this.options.oneListGroup&&(u=this.buildObjectNode(u,a,f,e)),i+=u}else if(this.options.attributesGroupName&&a===this.options.attributesGroupName){const o=Object.keys(r[a]),u=o.length;for(let f=0;f<u;f++)n+=this.buildAttrPairStr(o[f],""+r[a][o[f]])}else i+=this.processTextOrObjNode(r[a],a,e,t);return{attrStr:n,val:i}};Ed.prototype.buildAttrPairStr=function(r,e){return e=this.options.attributeValueProcessor(r,""+e),e=this.replaceEntitiesValue(e),this.options.suppressBooleanAttributes&&e==="true"?" "+r:" "+r+'="'+e+'"'};function GSe(r,e,t,n){const i=this.j2x(r,t+1,n.concat(e));return r[this.options.textNodeName]!==void 0&&Object.keys(r).length===1?this.buildTextValNode(r[this.options.textNodeName],e,i.attrStr,t):this.buildObjectNode(i.val,e,i.attrStr,t)}Ed.prototype.buildObjectNode=function(r,e,t,n){if(r==="")return e[0]==="?"?this.indentate(n)+"<"+e+t+"?"+this.tagEndChar:this.indentate(n)+"<"+e+t+this.closeTag(e)+this.tagEndChar;{let i="</"+e+this.tagEndChar,s="";return e[0]==="?"&&(s="?",i=""),(t||t==="")&&r.indexOf("<")===-1?this.indentate(n)+"<"+e+t+s+">"+r+i:this.options.commentPropName!==!1&&e===this.options.commentPropName&&s.length===0?this.indentate(n)+`<!--${r}-->`+this.newLine:this.indentate(n)+"<"+e+t+s+this.tagEndChar+r+this.indentate(n)+i}};Ed.prototype.closeTag=function(r){let e="";return this.options.unpairedTags.indexOf(r)!==-1?this.options.suppressUnpairedNode||(e="/"):this.options.suppressEmptyNode?e="/":e=`></${r}`,e};Ed.prototype.buildTextValNode=function(r,e,t,n){if(this.options.cdataPropName!==!1&&e===this.options.cdataPropName)return this.indentate(n)+`<![CDATA[${r}]]>`+this.newLine;if(this.options.commentPropName!==!1&&e===this.options.commentPropName)return this.indentate(n)+`<!--${r}-->`+this.newLine;if(e[0]==="?")return this.indentate(n)+"<"+e+t+"?"+this.tagEndChar;{let i=this.options.tagValueProcessor(e,r);return i=this.replaceEntitiesValue(i),i===""?this.indentate(n)+"<"+e+t+this.closeTag(e)+this.tagEndChar:this.indentate(n)+"<"+e+t+">"+i+"</"+e+this.tagEndChar}};Ed.prototype.replaceEntitiesValue=function(r){if(r&&r.length>0&&this.options.processEntities)for(let e=0;e<this.options.entities.length;e++){const t=this.options.entities[e];r=r.replace(t.regex,t.val)}return r};function HSe(r){return this.options.indentBy.repeat(r)}function WSe(r){return r.startsWith(this.options.attributeNamePrefix)&&r!==this.options.textNodeName?r.substr(this.attrPrefixLen):!1}var KSe=Ed;const XSe=WO,JSe=DSe,qSe=KSe;var YSe={XMLParser:JSe,XMLValidator:XSe,XMLBuilder:qSe};function J8(r,e){if(e?._parser&&e._parser!=="fast-xml-parser")throw new Error(e?._parser);const t={allowBooleanAttributes:!0,ignoreDeclaration:!0,removeNSPrefix:e?.removeNSPrefix,textNodeName:e?.textNodeName,isArray:(i,s,a,o)=>!!e?.arrayPaths?.some(f=>s===f),...e?._fastXML},n=ZSe(r,t);return e?.uncapitalizeKeys?$B(n):n}function ZSe(r,e){return new YSe.XMLParser({ignoreAttributes:!1,attributeNamePrefix:"",...e}).parse(r)}const QSe="4.3.3",ay={dataType:null,batchType:null,name:"XML",id:"xml",module:"xml",version:QSe,worker:!1,extensions:["xml"],mimeTypes:["application/xml","text/xml"],testText:e2e,options:{xml:{_parser:"fast-xml-parser",uncapitalizeKeys:!1,removeNSPrefix:!1,textNodeName:"value",arrayPaths:[]}},parse:async(r,e)=>J8(new TextDecoder().decode(r),{...ay.options.xml,...e?.xml}),parseTextSync:(r,e)=>J8(r,{...ay.options.xml,...e?.xml})};function e2e(r){return r.startsWith("<?xml")}function t2e(r,e){const t=ay.parseTextSync?.(r,e),n=t?.ServiceExceptionReport?.ServiceException||t?.["ogc:ServiceExceptionReport"]?.["ogc:ServiceException"];return typeof n=="string"?n:n.value||n.code||"Unknown error"}const r2e="4.3.3",Lw={dataType:null,batchType:null,id:"wms-error",name:"WMS Error",module:"wms",version:r2e,worker:!1,extensions:["xml"],mimeTypes:["application/vnd.ogc.se_xml","application/xml","text/xml"],testText:n2e,options:{wms:{throwOnError:!1}},parse:async(r,e)=>iP(new TextDecoder().decode(r),e),parseSync:(r,e)=>iP(new TextDecoder().decode(r),e),parseTextSync:(r,e)=>iP(r,e)};function n2e(r){return r.startsWith("<?xml")}function iP(r,e){const t={...Lw.options.wms,...e?.wms},n=t2e(r,t),i=t.minimalErrors?n:`WMS Service error: ${n}`;if(t.throwOnError)throw new Error(i);return i}function ly(r){return Array.isArray(r)?r:r?[r]:[]}function XS(r){const e=ly(r);return e.length>0&&e.every(t=>typeof t=="string")?e:[]}function gx(r,e=void 0){switch(typeof r){case"number":return r;case"string":return parseFloat(r);default:return}}function sP(r,e=void 0){switch(typeof r){case"number":return r;case"string":return parseInt(r,10);default:return}}function zm(r){switch(r){case"true":return!0;case"false":return!1;case"1":return!0;case"0":return!1;default:return!1}}function q8(r,e){const t=ay.parseTextSync?.(r,e),n=t.WMT_MS_Capabilities||t.WMS_Capabilities||t,i=i2e(n);if(e?.inheritedLayerProps)for(const s of i.layers)QX(s,null);return e?.includeRawJSON&&(i.json=n),e?.includeXMLText&&(i.xml=r),i}function i2e(r){const e={version:String(r.version||""),name:String(r.Service?.Name||"unnamed"),title:r.Service?.Title?String(r.Service?.Title):void 0,abstract:r.Service?.Abstract?String(r.Service?.Abstract):void 0,keywords:XS(r.Service?.KeywordList?.Keyword),fees:r.Service?.Fees?JSON.stringify(r.Service?.Fees):void 0,accessConstraints:r.Service?.AccessConstraints?JSON.stringify(r.Service?.AccessConstraints):void 0,layerLimit:sP(r.Service?.LayerLimit),maxWidth:sP(r.Service?.maxWidth),maxHeight:sP(r.Service?.maxHeight),layers:[],requests:s2e(r.Capability?.Request),exceptions:o2e(r.Exception)},t=ly(r.Capability?.Layer);for(const n of t)e.layers.push(ZX(n));for(const[n,i]of Object.entries(e))i===void 0&&delete e[n];return e}function s2e(r){const e={};for(const[t,n]of Object.entries(r||{})){const i=XS(n?.Format);e[t]={mimeTypes:i}}return e}function o2e(r){if(ly(r?.Format).length>0)return{mimeTypes:XS(r)}}function ZX(r){const e={title:String(r?.Title||""),name:r?.Name&&String(r?.Name),abstract:r?.Name&&String(r?.Abstract),keywords:XS(r.KeywordList?.Keyword)},t=r?.CRS||r?.SRS;t&&Array.isArray(t)&&t.every(f=>typeof f=="string")&&(e.crs=t);let n=r?.EX_GeographicBoundingBox&&a2e(r?.EX_GeographicBoundingBox);n&&(e.geographicBoundingBox=n),n=r?.LatLonBoundingBox&&l2e(r?.LatLonBoundingBox),n&&(e.geographicBoundingBox=n);const i=r?.BoundingBox&&c2e(r?.BoundingBox);i&&i.length>0&&(e.boundingBoxes=i);const a=ly(r?.Dimension).map(f=>h2e(f));a.length&&(e.dimensions=a),r?.opaque&&(e.opaque=zm(r?.opaque)),r?.cascaded&&(e.cascaded=zm(r?.cascaded)),r?.queryable&&(e.queryable=zm(r?.queryable));const o=ly(r?.Layer),u=[];for(const f of o)u.push(ZX(f));u.length>0&&(e.layers=u);for(const[f,g]of Object.entries(e))g===void 0&&delete e[f];return e}function a2e(r){const{westBoundLongitude:e,northBoundLatitude:t,eastBoundLongitude:n,southBoundLatitude:i}=r;return[[e,i],[n,t]]}function l2e(r){const{minx:e,miny:t,maxx:n,maxy:i}=r;return[[e,t],[n,i]]}function c2e(r){return ly(r).map(t=>u2e(t))}function u2e(r){const{CRS:e,SRS:t,minx:n,miny:i,maxx:s,maxy:a,resx:o,resy:u}=r,f={crs:e||t,boundingBox:[[gx(n),gx(i)],[gx(s),gx(a)]]};return o&&(f.xResolution=o),u&&(f.yResolution=u),f}function h2e(r){const{name:e,units:t,value:n}=r,i={name:e,units:t,extent:n};return r.unitSymbol&&(i.unitSymbol=r.unitSymbol),r.default&&(i.defaultValue=r.default),r.multipleValues&&(i.multipleValues=zm(r.multipleValues)),r.nearestValue&&(i.nearestValue=zm(r.nearestValue)),r.current&&(i.current=zm(r.current)),i}function QX(r,e){e?.geographicBoundingBox&&!r.geographicBoundingBox&&(r.geographicBoundingBox=[...e.geographicBoundingBox]),e?.crs&&!r.crs&&(r.crs=[...e.crs]),e?.boundingBoxes&&!r.boundingBoxes&&(r.boundingBoxes=[...e.boundingBoxes]),e?.dimensions&&!r.dimensions&&(r.dimensions=[...e.dimensions]);for(const t of r.layers||[])QX(t,r)}const d2e="4.3.3",JO={dataType:null,batchType:null,id:"wms-capabilities",name:"WMS Capabilities",module:"wms",version:d2e,worker:!1,extensions:["xml"],mimeTypes:["application/vnd.ogc.wms_xml","application/xml","text/xml"],testText:f2e,options:{wms:{}},parse:async(r,e)=>q8(new TextDecoder().decode(r),e?.wms),parseTextSync:(r,e)=>q8(r,e?.wms)};function f2e(r){return r.startsWith("<?xml")}function Y8(r,e){const n=(ay.parseTextSync?.(r,e)).FeatureInfoResponse?.FIELDS||[];return{features:(Array.isArray(n)?n:[n]).map(s=>p2e(s))}}function p2e(r){return{attributes:r||{},type:"",bounds:{bottom:0,top:0,left:0,right:0}}}const g2e={...JO,dataType:null,id:"wms-feature-info",name:"WMS FeatureInfo",parse:async(r,e)=>Y8(new TextDecoder().decode(r),e),parseTextSync:(r,e)=>Y8(r,e)};function Z8(r,e){return ay.parseTextSync?.(r,e)}const m2e={...JO,dataType:null,id:"wms-layer-description",name:"WMS DescribeLayer",parse:async(r,e)=>Z8(new TextDecoder().decode(r),e),parseTextSync:(r,e)=>Z8(r,e)},y2e={name:"Web Map Service (OGC WMS)",id:"wms",module:"wms",version:"0.0.0",extensions:[],mimeTypes:[],options:{wms:{}},type:"wms",fromUrl:!0,fromBlob:!1,testURL:r=>r.toLowerCase().includes("wms"),createDataSource:(r,e)=>new b2e(r,e)};class b2e extends V_{constructor(t,n){super(n);H(this,"url");H(this,"data");H(this,"substituteCRS84");H(this,"flipCRS");H(this,"wmsParameters");H(this,"vendorParameters");H(this,"capabilities",null);this.url=t,this.data=t,this.substituteCRS84=n.wms?.substituteCRS84??n.substituteCRS84??!1,this.flipCRS=["EPSG:4326"],this.wmsParameters={layers:void 0,query_layers:void 0,styles:void 0,version:"1.3.0",crs:"EPSG:4326",format:"image/png",info_format:"text/plain",transparent:void 0,time:void 0,elevation:void 0,...n.wmsParameters,...n.wms?.wmsParameters},this.vendorParameters=n.wms?.vendorParameters||n.vendorParameters||{}}async getMetadata(){const t=await this.getCapabilities();return this.normalizeMetadata(t)}async getImage(t){const{boundingBox:n,bbox:i,...s}=t,a={bbox:n?[...n[0],...n[1]]:i,...s};return await this.getMap(a)}normalizeMetadata(t){return t}async getCapabilities(t,n){const i=this.getCapabilitiesURL(t,n),s=await this.fetch(i),a=await s.arrayBuffer();this._checkResponse(s,a);const o=await JO.parse(a,this.loadOptions);return this.capabilities=o,o}async getMap(t,n){const i=this.getMapURL(t,n),s=await this.fetch(i),a=await s.arrayBuffer();this._checkResponse(s,a);try{return await EC.parse(a,this.loadOptions)}catch{throw this._parseError(a)}}async getFeatureInfo(t,n){const i=this.getFeatureInfoURL(t,n),s=await this.fetch(i),a=await s.arrayBuffer();return this._checkResponse(s,a),await g2e.parse(a,this.loadOptions)}async getFeatureInfoText(t,n){const i=this.getFeatureInfoURL(t,n),s=await this.fetch(i),a=await s.arrayBuffer();return this._checkResponse(s,a),new TextDecoder().decode(a)}async describeLayer(t,n){const i=this.describeLayerURL(t,n),s=await this.fetch(i),a=await s.arrayBuffer();return this._checkResponse(s,a),await m2e.parse(a,this.loadOptions)}async getLegendGraphic(t,n){const i=this.getLegendGraphicURL(t,n),s=await this.fetch(i),a=await s.arrayBuffer();this._checkResponse(s,a);try{return await EC.parse(a,this.loadOptions)}catch{throw this._parseError(a)}}getCapabilitiesURL(t,n){const i={version:this.wmsParameters.version,...t};return this._getWMSUrl("GetCapabilities",i,n)}getMapURL(t,n){t=this._getWMS130Parameters(t);const i={version:this.wmsParameters.version,format:this.wmsParameters.format,transparent:this.wmsParameters.transparent,time:this.wmsParameters.time,elevation:this.wmsParameters.elevation,layers:this.wmsParameters.layers,styles:this.wmsParameters.styles,crs:this.wmsParameters.crs,...t};return this._getWMSUrl("GetMap",i,n)}getFeatureInfoURL(t,n){t=this._getWMS130Parameters(t);const{boundingBox:i,bbox:s}=t;t.bbox=i?[...i[0],...i[1]]:s;const a={version:this.wmsParameters.version,info_format:this.wmsParameters.info_format,layers:this.wmsParameters.layers,query_layers:this.wmsParameters.query_layers,styles:this.wmsParameters.styles,crs:this.wmsParameters.crs,...t};return this._getWMSUrl("GetFeatureInfo",a,n)}describeLayerURL(t,n){const i={version:this.wmsParameters.version,...t};return this._getWMSUrl("DescribeLayer",i,n)}getLegendGraphicURL(t,n){const i={version:this.wmsParameters.version,...t};return this._getWMSUrl("GetLegendGraphic",i,n)}_parseWMSUrl(t){const[n,i]=t.split("?"),s=i.split("&"),a={};for(const o of s){const[u,f]=o.split("=");a[u]=f}return{url:n,parameters:a}}_getWMSUrl(t,n,i){let s=this.url,a=!0;const o={service:"WMS",version:n.version,request:t,...n,...this.vendorParameters,...i},u=["transparent","time","elevation"];for(const[f,g]of Object.entries(o))(!u.includes(f)||g)&&(s+=a?"?":"&",a=!1,s+=this._getURLParameter(f,g,n));return encodeURI(s)}_getWMS130Parameters(t){const n={...t};return n.srs&&(n.crs=n.crs||n.srs,delete n.srs),n}_getURLParameter(t,n,i){switch(t){case"crs":i.version!=="1.3.0"?t="srs":this.substituteCRS84&&n==="EPSG:4326"&&(n="CRS:84");break;case"srs":i.version==="1.3.0"&&(t="crs");break;case"bbox":const s=this._flipBoundingBox(n,i);s&&(n=s);break;case"x":i.version==="1.3.0"&&(t="i");break;case"y":i.version==="1.3.0"&&(t="j");break}return t=t.toUpperCase(),Array.isArray(n)?`${t}=${n.join(",")}`:`${t}=${n?String(n):""}`}_flipBoundingBox(t,n){if(!Array.isArray(t)||t.length!==4)return null;const i=n.version==="1.3.0"&&this.flipCRS.includes(n.crs||"")&&!(this.substituteCRS84&&n.crs==="EPSG:4326"),s=t;return i?[s[1],s[0],s[3],s[2]]:s}async _fetchArrayBuffer(t){const n=await this.fetch(t),i=await n.arrayBuffer();return this._checkResponse(n,i),i}_checkResponse(t,n){const i=t.headers["content-type"];if(!t.ok||Lw.mimeTypes.includes(i)){const s=UH(this.loadOptions,{wms:{throwOnError:!0}}),a=Lw.parseSync?.(n,s);throw new Error(a)}}_parseError(t){const n=Lw.parseSync?.(t,this.loadOptions);return new Error(n)}}const _2e={name:"ArcGISImageServer",id:"arcgis-image-server",module:"wms",version:"0.0.0",extensions:[],mimeTypes:[],options:{"arcgis-image-server":{}},type:"arcgis-image-server",fromUrl:!0,fromBlob:!1,testURL:r=>r.toLowerCase().includes("ImageServer"),createDataSource:(r,e)=>new v2e(r,e)};class v2e extends V_{constructor(t,n){super(n);H(this,"url");H(this,"data");this.url=t,this.data=t}async getMetadata(){return await this.metadata()}async getImage(t){throw new Error("not implemented")}async metadata(){throw new Error("not implemented")}exportImage(t){throw new Error("not implemented")}metadataURL(t){return`${this.url}?f=pjson`}exportImageURL(t){const n=`bbox=${t.bbox[0]},${t.bbox[1]},${t.bbox[2]},${t.bbox[3]}`,i=`size=${t.width},${t.height}`,s={...t,bbox:n,size:i};return delete s.width,delete s.height,this.getUrl("exportImage",s)}getUrl(t,n,i){let s=`${this.url}/${t}`,a=!0;for(const[o,u]of Object.entries(n))s+=a?"?":"&",a=!1,Array.isArray(u)?s+=`${o.toUpperCase()}=${u.join(",")}`:s+=`${o.toUpperCase()}=${u?String(u):""}`;return s}async checkResponse(t){if(!t.ok)throw new Error("error")}}const A2e=[y2e,_2e];function x2e(r,e=A2e){const{type:t="auto"}=r,n=t==="auto"?C2e(r.url,e):w2e(t,e);if(!n)throw new Error("Not a valid image source type");return n.createDataSource(r.url,r)}function w2e(r,e){for(const t of e)if(t.type===r)return t;return null}function C2e(r,e){for(const t of e)if(t.testURL&&t.testURL(r))return t;return null}const Q8=6378137*Math.PI;function eU(r){const e=Jc(r);return e[0]=(e[0]/256-1)*Q8,e[1]=(e[1]/256-1)*Q8,e}const T2e={id:"imagery-layer",data:"",serviceType:"auto",srs:"auto",layers:{type:"array",compare:!0,value:[]},onMetadataLoad:{type:"function",value:()=>{}},onMetadataLoadError:{type:"function",value:console.error},onImageLoadStart:{type:"function",value:()=>{}},onImageLoad:{type:"function",value:()=>{}},onImageLoadError:{type:"function",compare:!1,value:(r,e)=>console.error(e,r)}};class qO extends Zc{get isLoaded(){return this.state?.loadCounter===0&&super.isLoaded}shouldUpdateState(){return!0}initializeState(){this.state._nextRequestId=0,this.state.lastRequestId=-1,this.state.loadCounter=0}updateState({changeFlags:e,props:t,oldProps:n}){const{viewport:i}=this.context;e.dataChanged||t.serviceType!==n.serviceType?(this.state.imageSource=this._createImageSource(t),this._loadMetadata(),this.debounce(()=>this.loadImage(i,"image source changed"),0)):Ms(t.layers,n.layers,1)?e.viewportChanged&&this.debounce(()=>this.loadImage(i,"viewport changed")):this.debounce(()=>this.loadImage(i,"layers changed"),0)}finalizeState(){}renderLayers(){const{bounds:e,image:t,lastRequestParameters:n}=this.state;return t&&new VS({...this.getSubLayerProps({id:"bitmap"}),_imageCoordinateSystem:n.srs==="EPSG:4326"?Pr.LNGLAT:Pr.CARTESIAN,bounds:e,image:t})}async getFeatureInfoText(e,t){const{lastRequestParameters:n}=this.state;return n?await this.state.imageSource.getFeatureInfoText?.({...n,query_layers:n.layers,x:e,y:t,info_format:"application/vnd.ogc.gml"}):""}_createImageSource(e){if(e.data instanceof V_)return e.data;if(typeof e.data=="string")return x2e({url:e.data,loadOptions:e.loadOptions,type:e.serviceType});throw new Error("invalid image source in props.data")}async _loadMetadata(){const{imageSource:e}=this.state;try{this.state.loadCounter++;const t=await e.getMetadata();this.state.imageSource===e&&this.getCurrentLayer()?.props.onMetadataLoad(t)}catch(t){this.getCurrentLayer()?.props.onMetadataLoadError(t)}finally{this.state.loadCounter--}}async loadImage(e,t){const{layers:n,serviceType:i}=this.props;if(i==="wms"&&n.length===0)return;const s=e.getBounds(),{width:a,height:o}=e,u=this.getRequestId();let{srs:f}=this.props;f==="auto"&&(f=e.resolution?"EPSG:4326":"EPSG:3857");const g={width:a,height:o,boundingBox:[[s[0],s[1]],[s[2],s[3]]],layers:n,crs:f};if(f==="EPSG:3857"){const y=eU([s[0],s[1]]),A=eU([s[2],s[3]]);g.boundingBox=[y,A]}try{this.state.loadCounter++,this.props.onImageLoadStart(u);const y=await this.state.imageSource.getImage(g);this.state.lastRequestId<u&&(this.getCurrentLayer()?.props.onImageLoad(u),this.setState({image:y,bounds:s,lastRequestParameters:g,lastRequestId:u}))}catch(y){this.raiseError(y,"Load image"),this.getCurrentLayer()?.props.onImageLoadError(u,y)}finally{this.state.loadCounter--}}getRequestId(){return this.state._nextRequestId++}debounce(e,t=500){clearTimeout(this.state._timeoutId),this.state._timeoutId=setTimeout(()=>e(),t)}}qO.layerName="WMSLayer";qO.defaultProps=T2e;class S2e{constructor(e){this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(e){this._bbox||(this._bbox=e,"west"in e?this.boundingBox=[[e.west,e.south],[e.east,e.north]]:this.boundingBox=[[e.left,e.top],[e.right,e.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return!!this._loader&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const e=this.content?this.content.byteLength:0;return Number.isFinite(e)||console.error("byteLength not defined in tile data"),e}async _loadData({getData:e,requestScheduler:t,onLoad:n,onError:i}){const{index:s,id:a,bbox:o,userData:u,zoom:f}=this,g=this._loaderId;this._abortController=new AbortController;const{signal:y}=this._abortController,A=await t.scheduleRequest(this,k=>k.isSelected?1:-1);if(!A){this._isCancelled=!0;return}if(this._isCancelled){A.done();return}let C=null,M;try{C=await e({index:s,id:a,bbox:o,userData:u,zoom:f,signal:y})}catch(k){M=k||!0}finally{A.done()}if(g===this._loaderId){if(this._loader=void 0,this.content=C,this._isCancelled&&!C){this._isLoaded=!1;return}this._isLoaded=!0,this._isCancelled=!1,M?i(M,this):n(this)}}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){this.isLoaded||(this._isCancelled=!0,this._abortController?.abort())}}const _o={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},tU=new rt,E2e=new rt;class YO{constructor(e=[0,0,0],t=[0,0,0],n){n=n||tU.copy(e).add(t).scale(.5),this.center=new rt(n),this.halfDiagonal=new rt(t).subtract(this.center),this.minimum=new rt(e),this.maximum=new rt(t)}clone(){return new YO(this.minimum,this.maximum,this.center)}equals(e){return this===e||!!e&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){const{halfDiagonal:t}=this,n=E2e.from(e.normal),i=t.x*Math.abs(n.x)+t.y*Math.abs(n.y)+t.z*Math.abs(n.z),s=this.center.dot(n)+e.distance;return s-i>0?_o.INSIDE:s+i<0?_o.OUTSIDE:_o.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const t=tU.from(e).subtract(this.center),{halfDiagonal:n}=this;let i=0,s;return s=Math.abs(t.x)-n.x,s>0&&(i+=s*s),s=Math.abs(t.y)-n.y,s>0&&(i+=s*s),s=Math.abs(t.z)-n.z,s>0&&(i+=s*s),i}}const i0=new rt,rU=new rt;class Zv{constructor(e=[0,0,0],t=0){this.radius=-0,this.center=new rt,this.fromCenterRadius(e,t)}fromCenterRadius(e,t){return this.center.from(e),this.radius=t,this}fromCornerPoints(e,t){return t=i0.from(t),this.center=new rt().from(e).add(t).scale(.5),this.radius=this.center.distance(t),this}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new Zv(this.center,this.radius)}union(e){const t=this.center,n=this.radius,i=e.center,s=e.radius,a=i0.copy(i).subtract(t),o=a.magnitude();if(n>=o+s)return this.clone();if(s>=o+n)return e.clone();const u=(n+o+s)*.5;return rU.copy(a).scale((-n+u)/o).add(t),this.center.copy(rU),this.radius=u,this}expand(e){const n=i0.from(e).subtract(this.center).magnitude();return n>this.radius&&(this.radius=n),this}transform(e){this.center.transform(e);const t=Bme(i0,e);return this.radius=Math.max(t[0],Math.max(t[1],t[2]))*this.radius,this}distanceSquaredTo(e){const t=this.distanceTo(e);return t*t}distanceTo(e){const n=i0.from(e).subtract(this.center);return Math.max(0,n.len()-this.radius)}intersectPlane(e){const t=this.center,n=this.radius,s=e.normal.dot(t)+e.distance;return s<-n?_o.OUTSIDE:s<n?_o.INTERSECTING:_o.INSIDE}}const I2e=new rt,P2e=new rt,mx=new rt,yx=new rt,bx=new rt,B2e=new rt,M2e=new rt,Eu={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class Qv{constructor(e=[0,0,0],t=[0,0,0,0,0,0,0,0,0]){this.center=new rt().from(e),this.halfAxes=new Hi(t)}get halfSize(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2);return[new rt(e).len(),new rt(t).len(),new rt(n).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2),i=new rt(e).normalize(),s=new rt(t).normalize(),a=new rt(n).normalize();return new j_().fromMatrix3(new Hi([...i,...s,...a]))}fromCenterHalfSizeQuaternion(e,t,n){const i=new j_(n),s=new Hi().fromQuaternion(i);return s[0]=s[0]*t[0],s[1]=s[1]*t[0],s[2]=s[2]*t[0],s[3]=s[3]*t[1],s[4]=s[4]*t[1],s[5]=s[5]*t[1],s[6]=s[6]*t[2],s[7]=s[7]*t[2],s[8]=s[8]*t[2],this.center=new rt().from(e),this.halfAxes=s,this}clone(){return new Qv(this.center,this.halfAxes)}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new Zv){const t=this.halfAxes,n=t.getColumn(0,mx),i=t.getColumn(1,yx),s=t.getColumn(2,bx),a=I2e.copy(n).add(i).add(s);return e.center.copy(this.center),e.radius=a.magnitude(),e}intersectPlane(e){const t=this.center,n=e.normal,i=this.halfAxes,s=n.x,a=n.y,o=n.z,u=Math.abs(s*i[Eu.COLUMN0ROW0]+a*i[Eu.COLUMN0ROW1]+o*i[Eu.COLUMN0ROW2])+Math.abs(s*i[Eu.COLUMN1ROW0]+a*i[Eu.COLUMN1ROW1]+o*i[Eu.COLUMN1ROW2])+Math.abs(s*i[Eu.COLUMN2ROW0]+a*i[Eu.COLUMN2ROW1]+o*i[Eu.COLUMN2ROW2]),f=n.dot(t)+e.distance;return f<=-u?_o.OUTSIDE:f>=u?_o.INSIDE:_o.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const t=P2e.from(e).subtract(this.center),n=this.halfAxes,i=n.getColumn(0,mx),s=n.getColumn(1,yx),a=n.getColumn(2,bx),o=i.magnitude(),u=s.magnitude(),f=a.magnitude();i.normalize(),s.normalize(),a.normalize();let g=0,y;return y=Math.abs(t.dot(i))-o,y>0&&(g+=y*y),y=Math.abs(t.dot(s))-u,y>0&&(g+=y*y),y=Math.abs(t.dot(a))-f,y>0&&(g+=y*y),g}computePlaneDistances(e,t,n=[-0,-0]){let i=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const a=this.center,o=this.halfAxes,u=o.getColumn(0,mx),f=o.getColumn(1,yx),g=o.getColumn(2,bx),y=B2e.copy(u).add(f).add(g).add(a),A=M2e.copy(y).subtract(e);let C=t.dot(A);return i=Math.min(C,i),s=Math.max(C,s),y.copy(a).add(u).add(f).subtract(g),A.copy(y).subtract(e),C=t.dot(A),i=Math.min(C,i),s=Math.max(C,s),y.copy(a).add(u).subtract(f).add(g),A.copy(y).subtract(e),C=t.dot(A),i=Math.min(C,i),s=Math.max(C,s),y.copy(a).add(u).subtract(f).subtract(g),A.copy(y).subtract(e),C=t.dot(A),i=Math.min(C,i),s=Math.max(C,s),a.copy(y).subtract(u).add(f).add(g),A.copy(y).subtract(e),C=t.dot(A),i=Math.min(C,i),s=Math.max(C,s),a.copy(y).subtract(u).add(f).subtract(g),A.copy(y).subtract(e),C=t.dot(A),i=Math.min(C,i),s=Math.max(C,s),a.copy(y).subtract(u).subtract(f).add(g),A.copy(y).subtract(e),C=t.dot(A),i=Math.min(C,i),s=Math.max(C,s),a.copy(y).subtract(u).subtract(f).subtract(g),A.copy(y).subtract(e),C=t.dot(A),i=Math.min(C,i),s=Math.max(C,s),n[0]=i,n[1]=s,n}transform(e){this.center.transformAsPoint(e);const t=this.halfAxes.getColumn(0,mx);t.transformAsPoint(e);const n=this.halfAxes.getColumn(1,yx);n.transformAsPoint(e);const i=this.halfAxes.getColumn(2,bx);return i.transformAsPoint(e),this.halfAxes=new Hi([...t,...n,...i]),this}getTransform(){throw new Error("not implemented")}}const nU=new rt,iU=new rt;class Vl{constructor(e=[0,0,1],t=0){this.normal=new rt,this.distance=-0,this.fromNormalDistance(e,t)}fromNormalDistance(e,t){return Hl(Number.isFinite(t)),this.normal.from(e).normalize(),this.distance=t,this}fromPointNormal(e,t){e=nU.from(e),this.normal.from(t).normalize();const n=-this.normal.dot(e);return this.distance=n,this}fromCoefficients(e,t,n,i){return this.normal.set(e,t,n),Hl(ml(this.normal.len(),1)),this.distance=i,this}clone(){return new Vl(this.normal,this.distance)}equals(e){return ml(this.distance,e.distance)&&ml(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const t=iU.copy(this.normal).transformAsVector(e).normalize(),n=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(n,t)}projectPointOntoPlane(e,t=[0,0,0]){const n=nU.from(e),i=this.getPointDistance(n),s=iU.copy(this.normal).scale(i);return n.subtract(s).to(t)}}const sU=[new rt([1,0,0]),new rt([0,1,0]),new rt([0,0,1])],oU=new rt,R2e=new rt;class Va{constructor(e=[]){this.planes=e}fromBoundingSphere(e){this.planes.length=2*sU.length;const t=e.center,n=e.radius;let i=0;for(const s of sU){let a=this.planes[i],o=this.planes[i+1];a||(a=this.planes[i]=new Vl),o||(o=this.planes[i+1]=new Vl);const u=oU.copy(s).scale(-n).add(t);a.fromPointNormal(u,s);const f=oU.copy(s).scale(n).add(t),g=R2e.copy(s).negate();o.fromPointNormal(f,g),i+=2}return this}computeVisibility(e){let t=_o.INSIDE;for(const n of this.planes)switch(e.intersectPlane(n)){case _o.OUTSIDE:return _o.OUTSIDE;case _o.INTERSECTING:t=_o.INTERSECTING;break}return t}computeVisibilityWithPlaneMask(e,t){if(Hl(Number.isFinite(t),"parentPlaneMask is required."),t===Va.MASK_OUTSIDE||t===Va.MASK_INSIDE)return t;let n=Va.MASK_INSIDE;const i=this.planes;for(let s=0;s<this.planes.length;++s){const a=s<31?1<<s:0;if(s<31&&!(t&a))continue;const o=i[s],u=e.intersectPlane(o);if(u===_o.OUTSIDE)return Va.MASK_OUTSIDE;u===_o.INTERSECTING&&(n|=a)}return n}}Va.MASK_OUTSIDE=4294967295;Va.MASK_INSIDE=0;Va.MASK_INDETERMINATE=2147483647;new rt;new rt;new rt;new rt;new rt;new rt;new rt;new rt;new rt;new rt;new rt;new rt;new rt;new rt;new rt;new rt;new rt;const Pc=new Hi,k2e=new Hi,O2e=new Hi,_x=new Hi,aU=new Hi;function D2e(r,e={}){const t=gye,n=10;let i=0,s=0;const a=k2e,o=O2e;a.identity(),o.copy(r);const u=t*L2e(o);for(;s<n&&N2e(o)>u;)F2e(o,_x),aU.copy(_x).transpose(),o.multiplyRight(_x),o.multiplyLeft(aU),a.multiplyRight(_x),++i>2&&(++s,i=0);return e.unitary=a.toTarget(e.unitary),e.diagonal=o.toTarget(e.diagonal),e}function L2e(r){let e=0;for(let t=0;t<9;++t){const n=r[t];e+=n*n}return Math.sqrt(e)}const HB=[1,0,0],WB=[2,2,1];function N2e(r){let e=0;for(let t=0;t<3;++t){const n=r[Pc.getElementIndex(WB[t],HB[t])];e+=2*n*n}return Math.sqrt(e)}function F2e(r,e){const t=pK;let n=0,i=1;for(let f=0;f<3;++f){const g=Math.abs(r[Pc.getElementIndex(WB[f],HB[f])]);g>n&&(i=f,n=g)}const s=HB[i],a=WB[i];let o=1,u=0;if(Math.abs(r[Pc.getElementIndex(a,s)])>t){const f=r[Pc.getElementIndex(a,a)],g=r[Pc.getElementIndex(s,s)],y=r[Pc.getElementIndex(a,s)],A=(f-g)/2/y;let C;A<0?C=-1/(-A+Math.sqrt(1+A*A)):C=1/(A+Math.sqrt(1+A*A)),o=1/Math.sqrt(1+C*C),u=C*o}return Hi.IDENTITY.to(e),e[Pc.getElementIndex(s,s)]=e[Pc.getElementIndex(a,a)]=o,e[Pc.getElementIndex(a,s)]=u,e[Pc.getElementIndex(s,a)]=-u,e}const jh=new rt,U2e=new rt,z2e=new rt,V2e=new rt,$2e=new rt,j2e=new Hi,G2e={diagonal:new Hi,unitary:new Hi};function eJ(r,e=new Qv){if(!r||r.length===0)return e.halfAxes=new Hi([0,0,0,0,0,0,0,0,0]),e.center=new rt,e;const t=r.length,n=new rt(0,0,0);for(const Y of r)n.add(Y);const i=1/t;n.multiplyByScalar(i);let s=0,a=0,o=0,u=0,f=0,g=0;for(const Y of r){const ce=jh.copy(Y).subtract(n);s+=ce.x*ce.x,a+=ce.x*ce.y,o+=ce.x*ce.z,u+=ce.y*ce.y,f+=ce.y*ce.z,g+=ce.z*ce.z}s*=i,a*=i,o*=i,u*=i,f*=i,g*=i;const y=j2e;y[0]=s,y[1]=a,y[2]=o,y[3]=a,y[4]=u,y[5]=f,y[6]=o,y[7]=f,y[8]=g;const{unitary:A}=D2e(y,G2e),C=e.halfAxes.copy(A);let M=C.getColumn(0,z2e),k=C.getColumn(1,V2e),D=C.getColumn(2,$2e),V=-Number.MAX_VALUE,W=-Number.MAX_VALUE,z=-Number.MAX_VALUE,$=Number.MAX_VALUE,te=Number.MAX_VALUE,le=Number.MAX_VALUE;for(const Y of r)jh.copy(Y),V=Math.max(jh.dot(M),V),W=Math.max(jh.dot(k),W),z=Math.max(jh.dot(D),z),$=Math.min(jh.dot(M),$),te=Math.min(jh.dot(k),te),le=Math.min(jh.dot(D),le);M=M.multiplyByScalar(.5*($+V)),k=k.multiplyByScalar(.5*(te+W)),D=D.multiplyByScalar(.5*(le+z)),e.center.copy(M).add(k).add(D);const _e=U2e.set(V-$,W-te,z-le).multiplyByScalar(.5),se=new Hi([_e[0],0,0,0,_e[1],0,0,0,_e[2]]);return e.halfAxes.multiplyRight(se),e}const Am=512,lU=3,tJ=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],rJ=tJ.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),H2e=rJ.concat([[.25,.5],[.75,.5]]);class xm{constructor(e,t,n){this.x=e,this.y=t,this.z=n}get children(){if(!this._children){const e=this.x*2,t=this.y*2,n=this.z+1;this._children=[new xm(e,t,n),new xm(e,t+1,n),new xm(e+1,t,n),new xm(e+1,t+1,n)]}return this._children}update(e){const{viewport:t,cullingVolume:n,elevationBounds:i,minZ:s,maxZ:a,bounds:o,offset:u,project:f}=e,g=this.getBoundingVolume(i,u,f);if(o&&!this.insideBounds(o)||n.computeVisibility(g)<0)return!1;if(!this.childVisible){let{z:A}=this;if(A<a&&A>=s){const C=g.distanceTo(t.cameraPosition)*t.scale/t.height;A+=Math.floor(Math.log2(C))}if(A>=a)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const A of this.children)A.update(e);return!0}getSelected(e=[]){if(this.selected&&e.push(this),this._children)for(const t of this._children)t.getSelected(e);return e}insideBounds([e,t,n,i]){const s=Math.pow(2,this.z),a=Am/s;return this.x*a<n&&this.y*a<i&&(this.x+1)*a>e&&(this.y+1)*a>t}getBoundingVolume(e,t,n){if(n){const u=this.z<1?H2e:this.z<2?rJ:tJ,f=[];for(const g of u){const y=XB(this.x+g[0],this.y+g[1],this.z);y[2]=e[0],f.push(n(y)),e[0]!==e[1]&&(y[2]=e[1],f.push(n(y)))}return eJ(f)}const i=Math.pow(2,this.z),s=Am/i,a=this.x*s+t*Am,o=Am-(this.y+1)*s;return new YO([a,o,e[0]],[a+s,o+s,e[1]])}}function W2e(r,e,t,n){const i=r instanceof mX&&r.resolution?r.projectPosition:null,s=Object.values(r.getFrustumPlanes()).map(({normal:C,distance:M})=>new Vl(C.clone().negate(),M)),a=new Va(s),o=r.distanceScales.unitsPerMeter[2],u=t&&t[0]*o||0,f=t&&t[1]*o||0,g=r instanceof Qu&&r.pitch<=60?e:0;if(n){const[C,M,k,D]=n,V=Jc([C,D]),W=Jc([k,M]);n=[V[0],Am-V[1],W[0],Am-W[1]]}const y=new xm(0,0,0),A={viewport:r,project:i,cullingVolume:a,elevationBounds:[u,f],minZ:g,maxZ:e,bounds:n,offset:0};if(y.update(A),r instanceof Qu&&r.subViewports&&r.subViewports.length>1){for(A.offset=-1;y.update(A)&&!(--A.offset<-lU););for(A.offset=1;y.update(A)&&!(++A.offset>lU););}return y.getSelected()}const eh=512,K2e=[-1/0,-1/0,1/0,1/0],QC={type:"object",value:null,validate:(r,e)=>e.optional&&r===null||typeof r=="string"||Array.isArray(r)&&r.every(t=>typeof t=="string"),equal:(r,e)=>{if(r===e)return!0;if(!Array.isArray(r)||!Array.isArray(e))return!1;const t=r.length;if(t!==e.length)return!1;for(let n=0;n<t;n++)if(r[n]!==e[n])return!1;return!0}};function ZO(r,e){const t=[e.transformAsPoint([r[0],r[1]]),e.transformAsPoint([r[2],r[1]]),e.transformAsPoint([r[0],r[3]]),e.transformAsPoint([r[2],r[3]])];return[Math.min(...t.map(i=>i[0])),Math.min(...t.map(i=>i[1])),Math.max(...t.map(i=>i[0])),Math.max(...t.map(i=>i[1]))]}function X2e(r){return Math.abs(r.split("").reduce((e,t)=>(e<<5)-e+t.charCodeAt(0)|0,0))}function eT(r,e){if(!r||!r.length)return null;const{index:t,id:n}=e;if(Array.isArray(r)){const s=X2e(n)%r.length;r=r[s]}let i=r;for(const s of Object.keys(t)){const a=new RegExp(`{${s}}`,"g");i=i.replace(a,String(t[s]))}return Number.isInteger(t.y)&&Number.isInteger(t.z)&&(i=i.replace(/\{-y\}/g,String(Math.pow(2,t.z)-t.y-1))),i}function J2e(r,e,t){let n;return n=r.getBounds(),r.isGeospatial?[Math.max(n[0],t[0]),Math.max(n[1],t[1]),Math.min(n[2],t[2]),Math.min(n[3],t[3])]:[Math.max(Math.min(n[0],t[2]),t[0]),Math.max(Math.min(n[1],t[3]),t[1]),Math.min(Math.max(n[2],t[0]),t[2]),Math.min(Math.max(n[3],t[1]),t[3])]}function q2e({viewport:r,z:e,cullRect:t}){return(r.subViewports||[r]).map(i=>KB(i,e||0,t))}function KB(r,e,t){if(!Array.isArray(e)){const s=t.x-r.x,a=t.y-r.y,{width:o,height:u}=t,f={targetZ:e},g=r.unproject([s,a],f),y=r.unproject([s+o,a],f),A=r.unproject([s,a+u],f),C=r.unproject([s+o,a+u],f);return[Math.min(g[0],y[0],A[0],C[0]),Math.min(g[1],y[1],A[1],C[1]),Math.max(g[0],y[0],A[0],C[0]),Math.max(g[1],y[1],A[1],C[1])]}const n=KB(r,e[0],t),i=KB(r,e[1],t);return[Math.min(n[0],i[0]),Math.min(n[1],i[1]),Math.max(n[2],i[2]),Math.max(n[3],i[3])]}function Y2e(r,e,t){return t?ZO(r,t).map(i=>i*e/eh):r.map(n=>n*e/eh)}function QO(r,e){return Math.pow(2,r)*eh/e}function XB(r,e,t){const n=QO(t,eh),i=r/n*360-180,s=Math.PI-2*Math.PI*e/n,a=180/Math.PI*Math.atan(.5*(Math.exp(s)-Math.exp(-s)));return[i,a]}function cU(r,e,t,n){const i=QO(t,n);return[r/i*eh,e/i*eh]}function Z2e(r,e,t,n,i=eh){if(r.isGeospatial){const[f,g]=XB(e,t,n),[y,A]=XB(e+1,t+1,n);return{west:f,north:g,east:y,south:A}}const[s,a]=cU(e,t,n,i),[o,u]=cU(e+1,t+1,n,i);return{left:s,top:a,right:o,bottom:u}}function Q2e(r,e,t,n,i){const s=J2e(r,null,n),a=QO(e,t),[o,u,f,g]=Y2e(s,a,i),y=[];for(let A=Math.floor(o);A<f;A++)for(let C=Math.floor(u);C<g;C++)y.push({x:A,y:C,z:e});return y}function eEe({viewport:r,maxZoom:e,minZoom:t,zRange:n,extent:i,tileSize:s=eh,modelMatrix:a,modelMatrixInverse:o,zoomOffset:u=0}){let f=r.isGeospatial?Math.round(r.zoom+Math.log2(eh/s))+u:Math.ceil(r.zoom)+u;if(typeof t=="number"&&Number.isFinite(t)&&f<t){if(!i)return[];f=t}typeof e=="number"&&Number.isFinite(e)&&f>e&&(f=e);let g=i;return a&&o&&i&&!r.isGeospatial&&(g=ZO(i,a)),r.isGeospatial?W2e(r,f,n,i):Q2e(r,f,s,g||K2e,o)}function tEe(r){return/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(r)}function rEe(r){return Number.isFinite(r.west)&&Number.isFinite(r.north)&&Number.isFinite(r.east)&&Number.isFinite(r.south)}function nEe(r){let e={},t;return n=>{for(const i in n)if(!iEe(n[i],e[i])){t=r(n),e=n;break}return t}}function iEe(r,e){if(r===e)return!0;if(Array.isArray(r)){const t=r.length;if(!e||e.length!==t)return!1;for(let n=0;n<t;n++)if(r[n]!==e[n])return!1;return!0}return!1}const uU=1,JS=2,sEe="never",oEe="no-overlap",eD="best-available",aEe=5,lEe={[eD]:hEe,[oEe]:dEe,[sEe]:()=>{}},cEe={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,debounceTime:0,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}};class uEe{constructor(e){this._getCullBounds=nEe(q2e),this.opts={...cEe,...e},this.setOptions(this.opts),this.onTileLoad=t=>{this.opts.onTileLoad?.(t),this.opts.maxCacheByteSize!==null&&(this._cacheByteSize+=t.byteLength,this._resizeCache())},this._requestScheduler=new GH({throttleRequests:this.opts.maxRequests>0||this.opts.debounceTime>0,maxRequests:this.opts.maxRequests,debounceTime:this.opts.debounceTime}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._zRange=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new $r,this._modelMatrixInverse=new $r}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles!==null&&this._selectedTiles.every(e=>e.isLoaded)}get needsReload(){return this._selectedTiles!==null&&this._selectedTiles.some(e=>e.needsReload)}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(const e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const e of this._cache.keys()){const t=this._cache.get(e);!this._selectedTiles||!this._selectedTiles.includes(t)?this._cache.delete(e):t.setNeedsReload()}}update(e,{zRange:t,modelMatrix:n}={zRange:null,modelMatrix:null}){const i=n?new $r(n):new $r,s=!i.equals(this._modelMatrix);if(!this._viewport||!e.equals(this._viewport)||!ml(this._zRange,t)||s){s&&(this._modelMatrixInverse=i.clone().invert(),this._modelMatrix=i),this._viewport=e,this._zRange=t;const o=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:t,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=o.map(u=>this._getTile(u,!0)),this._dirty&&this._rebuildTree()}else this.needsReload&&(this._selectedTiles=this._selectedTiles.map(o=>this._getTile(o.index,!0)));const a=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),a&&this._frameNumber++,this._frameNumber}isTileVisible(e,t,n){if(!e.isVisible)return!1;if(t&&this._viewport){const i=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:t});let{bbox:s}=e;for(const[a,o,u,f]of i){let g;if("west"in s)g=s.west<u&&s.east>a&&s.south<f&&s.north>o;else{if(n&&!$r.IDENTITY.equals(n)){const[C,M,k,D]=ZO([s.left,s.top,s.right,s.bottom],n);s={left:C,top:M,right:k,bottom:D}}const y=Math.min(s.top,s.bottom),A=Math.max(s.top,s.bottom);g=s.left<u&&s.right>a&&y<f&&A>o}if(g)return!0}return!1}return!0}getTileIndices({viewport:e,maxZoom:t,minZoom:n,zRange:i,modelMatrix:s,modelMatrixInverse:a}){const{tileSize:o,extent:u,zoomOffset:f}=this.opts;return eEe({viewport:e,maxZoom:t,minZoom:n,zRange:i,tileSize:o,extent:u,modelMatrix:s,modelMatrixInverse:a,zoomOffset:f})}getTileId(e){return`${e.x}-${e.y}-${e.z}`}getTileZoom(e){return e.z}getTileMetadata(e){const{tileSize:t}=this.opts;return{bbox:Z2e(this._viewport,e.x,e.y,e.z,t)}}getParentIndex(e){const t=Math.floor(e.x/2),n=Math.floor(e.y/2),i=e.z-1;return{x:t,y:n,z:i}}updateTileStates(){const e=this.opts.refinementStrategy||eD,t=new Array(this._cache.size);let n=0;for(const i of this._cache.values())t[n++]=i.isVisible,i.isSelected=!1,i.isVisible=!1;for(const i of this._selectedTiles)i.isSelected=!0,i.isVisible=!0;(typeof e=="function"?e:lEe[e])(Array.from(this._cache.values())),n=0;for(const i of this._cache.values())if(t[n++]!==i.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:e=0}=this.opts,t=[];let n=0;for(const i of this._cache.values())i.isLoading&&(n++,!i.isSelected&&!i.isVisible&&t.push(i));for(;e>0&&n>e&&t.length>0;)t.shift().abort(),n--}_rebuildTree(){const{_cache:e}=this;for(const t of e.values())t.parent=null,t.children&&(t.children.length=0);for(const t of e.values()){const n=this._getNearestAncestor(t);t.parent=n,n?.children&&n.children.push(t)}}_resizeCache(){const{_cache:e,opts:t}=this,n=t.maxCacheSize??(t.maxCacheByteSize!==null?1/0:aEe*this.selectedTiles.length),i=t.maxCacheByteSize??1/0;if(e.size>n||this._cacheByteSize>i){for(const[a,o]of e)if(!o.isVisible&&!o.isSelected&&(this._cacheByteSize-=t.maxCacheByteSize!==null?o.byteLength:0,e.delete(a),this.opts.onTileUnload?.(o)),e.size<=n&&this._cacheByteSize<=i)break;this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((a,o)=>a.zoom-o.zoom),this._dirty=!1)}_getTile(e,t){const n=this.getTileId(e);let i=this._cache.get(n),s=!1;return!i&&t?(i=new S2e(e),Object.assign(i,this.getTileMetadata(i.index)),Object.assign(i,{id:n,zoom:this.getTileZoom(i.index)}),s=!0,this._cache.set(n,i),this._dirty=!0):i&&i.needsReload&&(s=!0),i&&s&&i.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),i}_getNearestAncestor(e){const{_minZoom:t=0}=this;let n=e.index;for(;this.getTileZoom(n)>t;){n=this.getParentIndex(n);const i=this._getTile(n);if(i)return i}return null}}function hEe(r){for(const e of r)e.state=0;for(const e of r)e.isSelected&&!nJ(e)&&tD(e);for(const e of r)e.isVisible=!!(e.state&JS)}function dEe(r){for(const t of r)t.state=0;for(const t of r)t.isSelected&&nJ(t);const e=Array.from(r).sort((t,n)=>t.zoom-n.zoom);for(const t of e)if(t.isVisible=!!(t.state&JS),t.children&&(t.isVisible||t.state&uU))for(const n of t.children)n.state=uU;else t.isSelected&&tD(t)}function nJ(r){let e=r;for(;e;){if(e.isLoaded||e.content)return e.state|=JS,!0;e=e.parent}return!1}function tD(r){for(const e of r.children)e.isLoaded||e.content?e.state|=JS:tD(e)}const fEe={TilesetClass:uEe,data:{type:"data",value:[]},dataComparator:QC.equal,renderSubLayers:{type:"function",value:r=>new Oy(r)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:r=>{}},onTileUnload:{type:"function",value:r=>{}},onTileError:{type:"function",value:r=>console.error(r)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:eD,zRange:null,maxRequests:6,debounceTime:0,zoomOffset:0};class eA extends Zc{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){this.state?.tileset?.finalize()}get isLoaded(){return!!this.state?.tileset?.selectedTiles?.every(e=>e.isLoaded&&e.layers&&e.layers.every(t=>t.isLoaded))}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({changeFlags:e}){let{tileset:t}=this.state;const n=e.propsOrDataChanged||e.updateTriggersChanged,i=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);t?n&&(t.setOptions(this._getTilesetOptions()),i?t.reloadAll():t.tiles.forEach(s=>{s.layers=null})):(t=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:t})),this._updateTileset()}_getTilesetOptions(){const{tileSize:e,maxCacheSize:t,maxCacheByteSize:n,refinementStrategy:i,extent:s,maxZoom:a,minZoom:o,maxRequests:u,debounceTime:f,zoomOffset:g}=this.props;return{maxCacheSize:t,maxCacheByteSize:n,maxZoom:a,minZoom:o,tileSize:e,refinementStrategy:i,extent:s,maxRequests:u,debounceTime:f,zoomOffset:g,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const e=this.state.tileset,{zRange:t,modelMatrix:n}=this.props,i=e.update(this.context.viewport,{zRange:t,modelMatrix:n}),{isLoaded:s}=e,a=this.state.isLoaded!==s,o=this.state.frameNumber!==i;s&&(a||o)&&this._onViewportLoad(),o&&this.setState({frameNumber:i}),this.state.isLoaded=s}_onViewportLoad(){const{tileset:e}=this.state,{onViewportLoad:t}=this.props;t&&t(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,t){this.props.onTileError(e),t.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){const{data:t,getTileData:n,fetch:i}=this.props,{signal:s}=e;return e.url=typeof t=="string"||Array.isArray(t)?eT(t,e):null,n?n(e):i&&e.url?i(e.url,{propName:"data",layer:this,signal:s}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo(e){const t=e.sourceLayer,n=t.props.tile,i=e.info;return i.picked&&(i.tile=n),i.sourceTile=n,i.sourceTileSubLayer=t,i}_updateAutoHighlight(e){e.sourceTileSubLayer.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map(e=>{const t=this.getSubLayerPropsByTile(e);if(!(!e.isLoaded&&!e.content))if(e.layers)t&&e.layers[0]&&Object.keys(t).some(n=>e.layers[0].props[n]!==t[n])&&(e.layers=e.layers.map(n=>n.clone(t)));else{const n=this.renderSubLayers({...this.props,...this.getSubLayerProps({id:e.id,updateTriggers:this.props.updateTriggers}),data:e.content,_offset:0,tile:e});e.layers=xd(n,Boolean).map(i=>i.clone({tile:e,...t}))}return e.layers})}filterSubLayer({layer:e,cullRect:t}){const{tile:n}=e.props,{modelMatrix:i}=this.props;return this.state.tileset.isTileVisible(n,t,i?new $r(i):null)}}eA.defaultProps=fEe;eA.layerName="TileLayer";const hU=`uniform tripsUniforms {
  bool fadeTrail;
  float trailLength;
  float currentTime;
} trips;
`,pEe={name:"trips",vs:hU,fs:hU,uniformTypes:{fadeTrail:"f32",trailLength:"f32",currentTime:"f32"}},gEe={fadeTrail:!0,trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:r=>r.timestamps}};class rD extends xp{getShaders(){const e=super.getShaders();return e.inject={"vs:#decl":`in float instanceTimestamps;
in float instanceNextTimestamps;
out float vTime;
`,"vs:#main-end":`vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;
`,"fs:#decl":`in float vTime;
`,"fs:#main-start":`if(vTime > trips.currentTime || (trips.fadeTrail && (vTime < trips.currentTime - trips.trailLength))) {
  discard;
}
`,"fs:DECKGL_FILTER_COLOR":`if(trips.fadeTrail) {
  color.a *= 1.0 - (trips.currentTime - vTime) / trips.trailLength;
}
`},e.modules=[...e.modules,pEe],e}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}draw(e){const{fadeTrail:t,trailLength:n,currentTime:i}=this.props,s={fadeTrail:t,trailLength:n,currentTime:i};this.state.model.shaderInputs.setProps({trips:s}),super.draw(e)}}rD.layerName="TripsLayer";rD.defaultProps=gEe;const oP=Math.PI/180,vx=new Float32Array(16),dU=new Float32Array(12);function fU(r,e,t){const n=e[0]*oP,i=e[1]*oP,s=e[2]*oP,a=Math.sin(s),o=Math.sin(n),u=Math.sin(i),f=Math.cos(s),g=Math.cos(n),y=Math.cos(i),A=t[0],C=t[1],M=t[2];r[0]=A*y*g,r[1]=A*u*g,r[2]=A*-o,r[3]=C*(-u*f+y*o*a),r[4]=C*(y*f+u*o*a),r[5]=C*g*a,r[6]=M*(u*a+y*o*f),r[7]=M*(-y*a+u*o*f),r[8]=M*g*f}function pU(r){return r[0]=r[0],r[1]=r[1],r[2]=r[2],r[3]=r[4],r[4]=r[5],r[5]=r[6],r[6]=r[8],r[7]=r[9],r[8]=r[10],r[9]=r[12],r[10]=r[13],r[11]=r[14],r.subarray(0,12)}const iJ={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrixCol0:{size:3,elementOffset:0},instanceModelMatrixCol1:{size:3,elementOffset:3},instanceModelMatrixCol2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(r,{startRow:e,endRow:t}){const{data:n,getOrientation:i,getScale:s,getTranslation:a,getTransformMatrix:o}=this.props,u=Array.isArray(o),f=u&&o.length===16,g=Array.isArray(s),y=Array.isArray(i),A=Array.isArray(a),C=f||!u&&!!o(n[0]);C?r.constant=f:r.constant=y&&g&&A;const M=r.value;if(r.constant){let k;C?(vx.set(o),k=pU(vx)):(k=dU,fU(k,i,s),k.set(a,9)),r.value=new Float32Array(k)}else{let k=e*r.size;const{iterable:D,objectInfo:V}=Sd(n,e,t);for(const W of D){V.index++;let z;if(C)vx.set(f?o:o(W,V)),z=pU(vx);else{z=dU;const $=y?i:i(W,V),te=g?s:s(W,V);fU(z,$,te),z.set(A?a:a(W,V),9)}M[k++]=z[0],M[k++]=z[1],M[k++]=z[2],M[k++]=z[3],M[k++]=z[4],M[k++]=z[5],M[k++]=z[6],M[k++]=z[7],M[k++]=z[8],M[k++]=z[9],M[k++]=z[10],M[k++]=z[11]}}}};function sJ(r,e){return e===Pr.CARTESIAN||e===Pr.METER_OFFSETS||e===Pr.DEFAULT&&!r.isGeospatial}const gU=`uniform simpleMeshUniforms {
  float sizeScale;
  bool composeModelMatrix;
  bool hasTexture;
  bool flatShading;
} simpleMesh;
`,mEe={name:"simpleMesh",vs:gU,fs:gU,uniformTypes:{sizeScale:"f32",composeModelMatrix:"f32",hasTexture:"f32",flatShading:"f32"}},yEe=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec3 instanceModelMatrixCol0;
in vec3 instanceModelMatrixCol1;
in vec3 instanceModelMatrixCol2;
in vec3 instanceTranslation;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = texCoords;
geometry.pickingColor = instancePickingColors;
vTexCoord = texCoords;
cameraPosition = project.cameraPosition;
vColor = vec4(colors * instanceColors.rgb, instanceColors.a);
mat3 instanceModelMatrix = mat3(instanceModelMatrixCol0, instanceModelMatrixCol1, instanceModelMatrixCol2);
vec3 pos = (instanceModelMatrix * positions) * simpleMesh.sizeScale + instanceTranslation;
if (simpleMesh.composeModelMatrix) {
DECKGL_FILTER_SIZE(pos, geometry);
normals_commonspace = project_normal(instanceModelMatrix * normals);
geometry.worldPosition += pos;
gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
geometry.position = position_commonspace;
}
else {
pos = project_size(pos);
DECKGL_FILTER_SIZE(pos, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
geometry.position = position_commonspace;
normals_commonspace = project_normal(instanceModelMatrix * normals);
}
geometry.normal = normals_commonspace;
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,bEe=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs
precision highp float;
uniform sampler2D sampler;
in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;
out vec4 fragColor;
void main(void) {
geometry.uv = vTexCoord;
vec3 normal;
if (simpleMesh.flatShading) {
normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
} else {
normal = normals_commonspace;
}
vec4 color = simpleMesh.hasTexture ? texture(sampler, vTexCoord) : vColor;
DECKGL_FILTER_COLOR(color, geometry);
vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
fragColor = vec4(lightColor, color.a * layer.opacity);
}
`;function aP(r){const e=r.positions||r.POSITION;Rr.assert(e,'no "postions" or "POSITION" attribute in mesh');const t=e.value.length/e.size;let n=r.COLOR_0||r.colors;n||(n={size:3,value:new Float32Array(t*3).fill(1)});let i=r.NORMAL||r.normals;i||(i={size:3,value:new Float32Array(t*3).fill(0)});let s=r.TEXCOORD_0||r.texCoords;return s||(s={size:2,value:new Float32Array(t*2).fill(0)}),{positions:e,colors:n,normals:i,texCoords:s}}function mU(r){return r instanceof To?(r.attributes=aP(r.attributes),r):r.attributes?new To({...r,topology:"triangle-list",attributes:aP(r.attributes)}):new To({topology:"triangle-list",attributes:aP(r)})}const _Ee=[0,0,0,255],vEe={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:r=>r.position},getColor:{type:"accessor",value:_Ee},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0,value:null}};class ev extends oo{getShaders(){return super.getShaders({vs:yEe,fs:bEe,modules:[$s,gO,Ja,mEe]})}getBounds(){if(this.props._instanced)return super.getBounds();let e=this.state.positionBounds;if(e)return e;const{mesh:t}=this.props;if(!t)return null;if(e=t.header?.boundingBox,!e){const{attributes:n}=mU(t);n.POSITION=n.POSITION||n.positions,e=sW(n)}return this.state.positionBounds=e,e}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:"float64",fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:"unorm8",transition:!0,size:this.props.colorFormat.length,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:iJ}),this.setState({emptyTexture:this.context.device.createTexture({data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);const{props:t,oldProps:n,changeFlags:i}=e;if(t.mesh!==n.mesh||i.extensionsChanged){if(this.state.positionBounds=null,this.state.model?.destroy(),t.mesh){this.state.model=this.getModel(t.mesh);const s=t.mesh.attributes||t.mesh;this.setState({hasNormals:!!(s.NORMAL||s.normals)})}this.getAttributeManager().invalidateAll()}t.texture!==n.texture&&t.texture instanceof ca&&this.setTexture(t.texture),this.state.model&&this.state.model.setTopology(this.props.wireframe?"line-strip":"triangle-list")}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){const{model:t}=this.state;if(!t)return;const{viewport:n,renderPass:i}=this.context,{sizeScale:s,coordinateSystem:a,_instanced:o}=this.props,u={sizeScale:s,composeModelMatrix:!o||sJ(n,a),flatShading:!this.state.hasNormals};t.shaderInputs.setProps({simpleMesh:u}),t.draw(i)}get isLoaded(){return!!(this.state?.model&&super.isLoaded)}getModel(e){const t=new Mi(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:mU(e),isInstanced:!0}),{texture:n}=this.props,{emptyTexture:i}=this.state,s={sampler:n||i,hasTexture:!!n};return t.shaderInputs.setProps({simpleMesh:s}),t}setTexture(e){const{emptyTexture:t,model:n}=this.state;if(n){const i={sampler:e||t,hasTexture:!!e};n.shaderInputs.setProps({simpleMesh:i})}}}ev.defaultProps=vEe;ev.layerName="SimpleMeshLayer";const AEe="4.3.3",tT={TRANSCODER:"basis_transcoder.js",TRANSCODER_WASM:"basis_transcoder.wasm",ENCODER:"basis_encoder.js",ENCODER_WASM:"basis_encoder.wasm"};let yU;async function bU(r){ehe(r.modules);const e=the("basis");return e||(yU||(yU=xEe(r)),await yU)}async function xEe(r){let e=null,t=null;return[e,t]=await Promise.all([await Xf(tT.TRANSCODER,"textures",r),await Xf(tT.TRANSCODER_WASM,"textures",r)]),e=e||globalThis.BASIS,await wEe(e,t)}function wEe(r,e){const t={};return e&&(t.wasmBinary=e),new Promise(n=>{r(t).then(i=>{const{BasisFile:s,initializeBasis:a}=i;a(),n({BasisFile:s})})})}let lP;async function _U(r){const e=r.modules||{};return e.basisEncoder?e.basisEncoder:(lP=lP||CEe(r),await lP)}async function CEe(r){let e=null,t=null;return[e,t]=await Promise.all([await Xf(tT.ENCODER,"textures",r),await Xf(tT.ENCODER_WASM,"textures",r)]),e=e||globalThis.BASIS,await TEe(e,t)}function TEe(r,e){const t={};return e&&(t.wasmBinary=e),new Promise(n=>{r(t).then(i=>{const{BasisFile:s,KTX2File:a,initializeBasis:o,BasisEncoder:u}=i;o(),n({BasisFile:s,KTX2File:a,BasisEncoder:u})})})}const Fg={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGBA_ASTC_4X4_KHR:37808},SEe=["","WEBKIT_","MOZ_"],vU={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"};let Ax=null;function EEe(r){if(!Ax){r=r||IEe()||void 0,Ax=new Set;for(const e of SEe)for(const t in vU)if(r&&r.getExtension(`${e}${t}`)){const n=vU[t];Ax.add(n)}}return Ax}function IEe(){try{return document.createElement("canvas").getContext("webgl")}catch{return null}}const Ba=[171,75,84,88,32,50,48,187,13,10,26,10];function PEe(r){const e=new Uint8Array(r);return!(e.byteLength<Ba.length||e[0]!==Ba[0]||e[1]!==Ba[1]||e[2]!==Ba[2]||e[3]!==Ba[3]||e[4]!==Ba[4]||e[5]!==Ba[5]||e[6]!==Ba[6]||e[7]!==Ba[7]||e[8]!==Ba[8]||e[9]!==Ba[9]||e[10]!==Ba[10]||e[11]!==Ba[11])}const BEe={etc1:{basisFormat:0,compressed:!0,format:Fg.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:Fg.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:Fg.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:Fg.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:Fg.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:Fg.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};async function MEe(r,e){if(e.basis.containerFormat==="auto"){if(PEe(r)){const n=await _U(e);return AU(n.KTX2File,r,e)}const{BasisFile:t}=await bU(e);return cP(t,r,e)}switch(e.basis.module){case"encoder":const t=await _U(e);switch(e.basis.containerFormat){case"ktx2":return AU(t.KTX2File,r,e);case"basis":default:return cP(t.BasisFile,r,e)}case"transcoder":default:const{BasisFile:n}=await bU(e);return cP(n,r,e)}}function cP(r,e,t){const n=new r(new Uint8Array(e));try{if(!n.startTranscoding())throw new Error("Failed to start basis transcoding");const i=n.getNumImages(),s=[];for(let a=0;a<i;a++){const o=n.getNumLevels(a),u=[];for(let f=0;f<o;f++)u.push(REe(n,a,f,t));s.push(u)}return s}finally{n.close(),n.delete()}}function REe(r,e,t,n){const i=r.getImageWidth(e,t),s=r.getImageHeight(e,t),a=r.getHasAlpha(),{compressed:o,format:u,basisFormat:f}=oJ(n,a),g=r.getImageTranscodedSizeInBytes(e,t,f),y=new Uint8Array(g);if(!r.transcodeImage(y,e,t,f,0,0))throw new Error("failed to start Basis transcoding");return{width:i,height:s,data:y,compressed:o,format:u,hasAlpha:a}}function AU(r,e,t){const n=new r(new Uint8Array(e));try{if(!n.startTranscoding())throw new Error("failed to start KTX2 transcoding");const i=n.getLevels(),s=[];for(let a=0;a<i;a++)s.push(kEe(n,a,t));return[s]}finally{n.close(),n.delete()}}function kEe(r,e,t){const{alphaFlag:n,height:i,width:s}=r.getImageLevelInfo(e,0,0),{compressed:a,format:o,basisFormat:u}=oJ(t,n),f=r.getImageTranscodedSizeInBytes(e,0,0,u),g=new Uint8Array(f);if(!r.transcodeImage(g,e,0,0,u,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:s,height:i,data:g,compressed:a,levelSize:f,hasAlpha:n,format:o}}function oJ(r,e){let t=r&&r.basis&&r.basis.format;return t==="auto"&&(t=aJ()),typeof t=="object"&&(t=e?t.alpha:t.noAlpha),t=t.toLowerCase(),BEe[t]}function aJ(){const r=EEe();return r.has("astc")?"astc-4x4":r.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:r.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:r.has("etc1")?"etc1":r.has("etc2")?"etc2":"rgb565"}const OEe={dataType:null,batchType:null,name:"Basis",id:"basis",module:"textures",version:AEe,worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},DEe={...OEe,parse:MEe};function LEe(r){return{addressModeU:xU(r.wrapS),addressModeV:xU(r.wrapT),magFilter:NEe(r.magFilter),...FEe(r.minFilter)}}function xU(r){switch(r){case 33071:return"clamp-to-edge";case 10497:return"repeat";case 33648:return"mirror-repeat";default:return}}function NEe(r){switch(r){case 9728:return"nearest";case 9729:return"linear";default:return}}function FEe(r){switch(r){case 9728:return{minFilter:"nearest"};case 9729:return{minFilter:"linear"};case 9984:return{minFilter:"nearest",mipmapFilter:"nearest"};case 9985:return{minFilter:"linear",mipmapFilter:"nearest"};case 9986:return{minFilter:"nearest",mipmapFilter:"linear"};case 9987:return{minFilter:"linear",mipmapFilter:"linear"};default:return{}}}function lJ(r,e,t,n){const i={defines:{MANUAL_SRGB:!0,SRGB_FAST_APPROXIMATION:!0},bindings:{},uniforms:{camera:[0,0,0],metallicRoughnessValues:[1,1]},parameters:{},glParameters:{},generatedTextures:[]};i.defines.USE_TEX_LOD=!0;const{imageBasedLightingEnvironment:s}=n;return s&&(i.bindings.pbr_diffuseEnvSampler=s.diffuseEnvSampler.texture,i.bindings.pbr_specularEnvSampler=s.specularEnvSampler.texture,i.bindings.pbr_BrdfLUT=s.brdfLutTexture.texture,i.uniforms.scaleIBLAmbient=[1,1]),n?.pbrDebug&&(i.defines.PBR_DEBUG=!0,i.uniforms.scaleDiffBaseMR=[0,0,0,0],i.uniforms.scaleFGDSpec=[0,0,0,0]),t.NORMAL&&(i.defines.HAS_NORMALS=!0),t.TANGENT&&n?.useTangents&&(i.defines.HAS_TANGENTS=!0),t.TEXCOORD_0&&(i.defines.HAS_UV=!0),n?.imageBasedLightingEnvironment&&(i.defines.USE_IBL=!0),n?.lights&&(i.defines.USE_LIGHTS=!0),e&&UEe(r,e,i),i}function UEe(r,e,t){if(t.uniforms.unlit=!!e.unlit,e.pbrMetallicRoughness&&zEe(r,e.pbrMetallicRoughness,t),e.normalTexture){a_(r,e.normalTexture,"pbr_normalSampler","HAS_NORMALMAP",t);const{scale:n=1}=e.normalTexture;t.uniforms.normalScale=n}if(e.occlusionTexture){a_(r,e.occlusionTexture,"pbr_occlusionSampler","HAS_OCCLUSIONMAP",t);const{strength:n=1}=e.occlusionTexture;t.uniforms.occlusionStrength=n}switch(e.emissiveTexture&&(a_(r,e.emissiveTexture,"pbr_emissiveSampler","HAS_EMISSIVEMAP",t),t.uniforms.emissiveFactor=e.emissiveFactor||[0,0,0]),e.alphaMode||"MASK"){case"MASK":const{alphaCutoff:n=.5}=e;t.defines.ALPHA_CUTOFF=!0,t.uniforms.alphaCutoff=n;break;case"BLEND":Bt.warn("glTF BLEND alphaMode might not work well because it requires mesh sorting")(),t.parameters.blend=!0,t.parameters.blendColorOperation="add",t.parameters.blendColorSrcFactor="src-alpha",t.parameters.blendColorDstFactor="one-minus-src-alpha",t.parameters.blendAlphaOperation="add",t.parameters.blendAlphaSrcFactor="one",t.parameters.blendAlphaDstFactor="one-minus-src-alpha",t.glParameters.blend=!0,t.glParameters.blendEquation=32774,t.glParameters.blendFunc=[770,771,1,771];break}}function zEe(r,e,t){e.baseColorTexture&&a_(r,e.baseColorTexture,"pbr_baseColorSampler","HAS_BASECOLORMAP",t),t.uniforms.baseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&a_(r,e.metallicRoughnessTexture,"pbr_metallicRoughnessSampler","HAS_METALROUGHNESSMAP",t);const{metallicFactor:n=1,roughnessFactor:i=1}=e;t.uniforms.metallicRoughnessValues=[n,i]}function a_(r,e,t,n,i){const s=e.texture.source.image;let a;s.compressed?a=s:a={data:s};const o={wrapS:10497,wrapT:10497,...e?.texture?.sampler},u=r.createTexture({id:e.uniformName||e.id,sampler:LEe(o),...a});i.bindings[t]=u,n&&(i.defines[n]=!0),i.generatedTextures.push(u)}var Rf;(function(r){r[r.POINTS=0]="POINTS",r[r.LINES=1]="LINES",r[r.LINE_LOOP=2]="LINE_LOOP",r[r.LINE_STRIP=3]="LINE_STRIP",r[r.TRIANGLES=4]="TRIANGLES",r[r.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",r[r.TRIANGLE_FAN=6]="TRIANGLE_FAN"})(Rf||(Rf={}));function VEe(r){switch(r){case Rf.POINTS:return"point-list";case Rf.LINES:return"line-list";case Rf.LINE_STRIP:return"line-strip";case Rf.TRIANGLES:return"triangle-list";case Rf.TRIANGLE_STRIP:return"triangle-strip";default:throw new Error(String(r))}}const $Ee=`
layout(0) positions: vec4; // in vec4 POSITION;

  #ifdef HAS_NORMALS
    in vec4 normals; // in vec4 NORMAL;
  #endif

  #ifdef HAS_TANGENTS
    in vec4 TANGENT;
  #endif

  #ifdef HAS_UV
    // in vec2 TEXCOORD_0;
    in vec2 texCoords;
  #endif

@vertex
  void main(void) {
    vec4 _NORMAL = vec4(0.);
    vec4 _TANGENT = vec4(0.);
    vec2 _TEXCOORD_0 = vec2(0.);

    #ifdef HAS_NORMALS
      _NORMAL = normals;
    #endif

    #ifdef HAS_TANGENTS
      _TANGENT = TANGENT;
    #endif

    #ifdef HAS_UV
      _TEXCOORD_0 = texCoords;
    #endif

    pbr_setPositionNormalTangentUV(positions, _NORMAL, _TANGENT, _TEXCOORD_0);
    gl_Position = u_MVPMatrix * positions;
  }

@fragment
  out vec4 fragmentColor;

  void main(void) {
    vec3 pos = pbr_vPosition;
    fragmentColor = pbr_filterColor(vec4(1.0));
  }
`,jEe=`#version 300 es

  // in vec4 POSITION;
  in vec4 positions;

  #ifdef HAS_NORMALS
    // in vec4 NORMAL;
    in vec4 normals;
  #endif

  #ifdef HAS_TANGENTS
    in vec4 TANGENT;
  #endif

  #ifdef HAS_UV
    // in vec2 TEXCOORD_0;
    in vec2 texCoords;
  #endif

  void main(void) {
    vec4 _NORMAL = vec4(0.);
    vec4 _TANGENT = vec4(0.);
    vec2 _TEXCOORD_0 = vec2(0.);

    #ifdef HAS_NORMALS
      _NORMAL = normals;
    #endif

    #ifdef HAS_TANGENTS
      _TANGENT = TANGENT;
    #endif

    #ifdef HAS_UV
      _TEXCOORD_0 = texCoords;
    #endif

    pbr_setPositionNormalTangentUV(positions, _NORMAL, _TANGENT, _TEXCOORD_0);
    gl_Position = pbrProjection.modelViewProjectionMatrix * positions;
  }
`,GEe=`#version 300 es
  out vec4 fragmentColor;

  void main(void) {
    vec3 pos = pbr_vPosition;
    fragmentColor = pbr_filterColor(vec4(1.0));
  }
`;function HEe(r,e){const{id:t,geometry:n,parsedPPBRMaterial:i,vertexCount:s,modelOptions:a={}}=e;Bt.info(4,"createGLTFModel defines: ",i.defines)();const o=[],u={depthWriteEnabled:!0,depthCompare:"less",depthFormat:"depth24plus",cullMode:"back"},f={id:t,source:$Ee,vs:jEe,fs:GEe,geometry:n,topology:n.topology,vertexCount:s,modules:[mO],...a,defines:{...i.defines,...a.defines},parameters:{...u,...i.parameters,...a.parameters}},g=new Mi(r,f),{camera:y,...A}={...i.uniforms,...a.uniforms,...i.bindings,...a.bindings};return g.shaderInputs.setProps({pbrMaterial:A,pbrProjection:{camera:y}}),new CB({managedResources:o,model:g})}const WEe={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:void 0,lights:!0,useTangents:!1};function KEe(r,e,t={}){const n={...WEe,...t};return e.scenes.map(s=>XEe(r,s,e.nodes,n))}function XEe(r,e,t,n){const s=(e.nodes||[]).map(o=>cJ(r,o,t,n));return new By({id:e.name||e.id,children:s})}function cJ(r,e,t,n){if(!e._node){const a=(e.children||[]).map(u=>cJ(r,u,t,n));e.mesh&&a.push(JEe(r,e.mesh,n));const o=new By({id:e.name||e.id,children:a});if(e.matrix)o.setMatrix(e.matrix);else{if(o.matrix.identity(),e.translation&&o.matrix.translate(e.translation),e.rotation){const u=new $r().fromQuaternion(e.rotation);o.matrix.multiplyRight(u)}e.scale&&o.matrix.scale(e.scale)}e._node=o}const i=t.find(s=>s.id===e.id);return i._node=e._node,e._node}function JEe(r,e,t){if(!e._mesh){const i=(e.primitives||[]).map((a,o)=>qEe(r,a,o,e,t)),s=new By({id:e.name||e.id,children:i});e._mesh=s}return e._mesh}function qEe(r,e,t,n,i){const s=e.name||`${n.name||n.id}-primitive-${t}`,a=VEe(e.mode||4),o=e.indices?e.indices.count:YEe(e.attributes),u=wU(s,e,a),f=lJ(r,e.material,u.attributes,i),g=HEe(r,{id:s,geometry:wU(s,e,a),parsedPPBRMaterial:f,modelOptions:i.modelOptions,vertexCount:o});return g.bounds=[e.attributes.POSITION.min,e.attributes.POSITION.max],g}function YEe(r){throw new Error("getVertexCount not implemented")}function wU(r,e,t){const n={};for(const[i,s]of Object.entries(e.attributes)){const{components:a,size:o,value:u}=s;n[i]={size:o??a,value:u}}return new To({id:r,topology:t,indices:e.indices.value,attributes:n})}const uP=new j_;function ZEe(r,{input:e,interpolation:t,output:n},i,s){const a=e[e.length-1],o=r%a,u=e.findIndex(A=>A>=o),f=Math.max(0,u-1);if(!Array.isArray(i[s]))switch(s){case"translation":i[s]=[0,0,0];break;case"rotation":i[s]=[0,0,0,1];break;case"scale":i[s]=[1,1,1];break;default:Bt.warn(`Bad animation path ${s}`)()}const g=e[f],y=e[u];switch(t){case"STEP":tIe(i,s,n[f]);break;case"LINEAR":if(y>g){const A=(o-g)/(y-g);QEe(i,s,n[f],n[u],A)}break;case"CUBICSPLINE":if(y>g){const A=(o-g)/(y-g),C=y-g,M=n[3*f+1],k=n[3*f+2],D=n[3*u+0],V=n[3*u+1];eIe(i,s,{p0:M,outTangent0:k,inTangent1:D,p1:V,tDiff:C,ratio:A})}break;default:Bt.warn(`Interpolation ${t} not supported`)();break}}function QEe(r,e,t,n,i){if(!r[e])throw new Error;if(e==="rotation"){uP.slerp({start:t,target:n,ratio:i});for(let s=0;s<uP.length;s++)r[e][s]=uP[s]}else for(let s=0;s<t.length;s++)r[e][s]=i*n[s]+(1-i)*t[s]}function eIe(r,e,{p0:t,outTangent0:n,inTangent1:i,p1:s,tDiff:a,ratio:o}){if(!r[e])throw new Error;for(let u=0;u<r[e].length;u++){const f=n[u]*a,g=i[u]*a;r[e][u]=(2*Math.pow(o,3)-3*Math.pow(o,2)+1)*t[u]+(Math.pow(o,3)-2*Math.pow(o,2)+o)*f+(-2*Math.pow(o,3)+3*Math.pow(o,2))*s[u]+(Math.pow(o,3)-Math.pow(o,2))*g}}function tIe(r,e,t){if(!r[e])throw new Error;for(let n=0;n<t.length;n++)r[e][n]=t[n]}class rIe{constructor(e){H(this,"animation");H(this,"startTime",0);H(this,"playing",!0);H(this,"speed",1);var t;this.animation=e.animation,(t=this.animation).name||(t.name="unnamed"),Object.assign(this,e)}setTime(e){if(!this.playing)return;const n=(e/1e3-this.startTime)*this.speed;this.animation.channels.forEach(({sampler:i,target:s,path:a})=>{ZEe(n,i,s,a),sIe(s,s._node)})}}class nIe{constructor(e){H(this,"animations");this.animations=e.animations.map((t,n)=>{const i=t.name||`Animation-${n}`;return new rIe({animation:{name:i,channels:t.channels}})})}animate(e){Bt.warn("GLTFAnimator#animate is deprecated. Use GLTFAnimator#setTime instead")(),this.setTime(e)}setTime(e){this.animations.forEach(t=>t.setTime(e))}getAnimations(){return this.animations}}const iIe=new $r;function sIe(r,e){if(e.matrix.identity(),r.translation&&e.matrix.translate(r.translation),r.rotation){const t=iIe.fromQuaternion(r.rotation);e.matrix.multiplyRight(t)}r.scale&&e.matrix.scale(r.scale)}const oIe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},aIe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function lIe(r){const e=aIe[r.componentType],t=oIe[r.type],n=t*r.count,{buffer:i,byteOffset:s=0}=r.bufferView?.data??{};return{typedArray:new e(i,s+(r.byteOffset||0),n),components:t}}function cIe(r){return(r.animations||[]).map((t,n)=>{const i=t.name||`Animation-${n}`,s=t.samplers.map(({input:o,interpolation:u="LINEAR",output:f})=>({input:CU(r.accessors[o]),interpolation:u,output:CU(r.accessors[f])})),a=t.channels.map(({sampler:o,target:u})=>({sampler:s[o],target:r.nodes[u.node??0],path:u.path}));return{name:i,channels:a}})}function CU(r){if(!r._animation){const{typedArray:e,components:t}=lIe(r);if(t===1)r._animation=Array.from(e);else{const n=[];for(let i=0;i<e.length;i+=t)n.push(Array.from(e.slice(i,i+t)));r._animation=n}}return r._animation}function JB(r){if(ArrayBuffer.isView(r)||r instanceof ArrayBuffer||r instanceof ImageBitmap)return r;if(Array.isArray(r))return r.map(JB);if(r&&typeof r=="object"){const e={};for(const t in r)e[t]=JB(r[t]);return e}return r}function uIe(r,e,t){e=JB(e);const n=KEe(r,e,t),i=cIe(e),s=new nIe({animations:i});return{scenes:n,animator:s}}function $a(r,e){if(!r)throw new Error(e||"assert failed: gltf")}const uJ={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},hJ={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},hIe=1.33,TU=["SCALAR","VEC2","VEC3","VEC4"],dIe=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],fIe=new Map(dIe),pIe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},gIe={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},mIe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function dJ(r){return TU[r-1]||TU[0]}function qS(r){const e=fIe.get(r.constructor);if(!e)throw new Error("Illegal typed array");return e}function nD(r,e){const t=mIe[r.componentType],n=pIe[r.type],i=gIe[r.componentType],s=r.count*n,a=r.count*n*i;$a(a>=0&&a<=e.byteLength);const o=hJ[r.componentType],u=uJ[r.type];return{ArrayType:t,length:s,byteLength:a,componentByteSize:o,numberOfComponentsInElement:u}}function fJ(r){let{images:e,bufferViews:t}=r;e=e||[],t=t||[];const n=e.map(a=>a.bufferView);t=t.filter(a=>!n.includes(a));const i=t.reduce((a,o)=>a+o.byteLength,0),s=e.reduce((a,o)=>{const{width:u,height:f}=o.image;return a+u*f},0);return i+Math.ceil(4*s*hIe)}function yIe(r,e,t){const n=r.bufferViews[t];$a(n);const i=n.buffer,s=e[i];$a(s);const a=(n.byteOffset||0)+s.byteOffset;return new Uint8Array(s.arrayBuffer,a,n.byteLength)}function bIe(r,e,t){const n=typeof t=="number"?r.accessors?.[t]:t;if(!n)throw new Error(`No gltf accessor ${JSON.stringify(t)}`);const i=r.bufferViews?.[n.bufferView||0];if(!i)throw new Error(`No gltf buffer view for accessor ${i}`);const{arrayBuffer:s,byteOffset:a}=e[i.buffer],o=(a||0)+(n.byteOffset||0)+(i.byteOffset||0),{ArrayType:u,length:f,componentByteSize:g,numberOfComponentsInElement:y}=nD(n,i),A=g*y,C=i.byteStride||A;if(typeof i.byteStride>"u"||i.byteStride===A)return new u(s,o,f);const M=new u(f);for(let k=0;k<n.count;k++){const D=new u(s,o+k*C,y);M.set(D,k*y)}return M}function _Ie(){return{asset:{version:"2.0",generator:"loaders.gl"},buffers:[],extensions:{},extensionsRequired:[],extensionsUsed:[]}}class js{constructor(e){H(this,"gltf");H(this,"sourceBuffers");H(this,"byteLength");this.gltf={json:e?.json||_Ie(),buffers:e?.buffers||[],images:e?.images||[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}hasExtension(e){const t=this.getUsedExtensions().find(i=>i===e),n=this.getRequiredExtensions().find(i=>i===e);return typeof t=="string"||typeof n=="string"}getExtension(e){const t=this.getUsedExtensions().find(i=>i===e),n=this.json.extensions||{};return t?n[e]:null}getRequiredExtension(e){return this.getRequiredExtensions().find(n=>n===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getRemovedExtensions(){return this.json.extensionsRemoved||[]}getObjectExtension(e,t){return(e.extensions||{})[t]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,t){if(typeof t=="object")return t;const n=this.json[e]&&this.json[e][t];if(!n)throw new Error(`glTF file error: Could not find ${e}[${t}]`);return n}getTypedArrayForBufferView(e){e=this.getBufferView(e);const t=e.buffer,n=this.gltf.buffers[t];$a(n);const i=(e.byteOffset||0)+n.byteOffset;return new Uint8Array(n.arrayBuffer,i,e.byteLength)}getTypedArrayForAccessor(e){const t=this.getAccessor(e);return bIe(this.gltf.json,this.gltf.buffers,t)}getTypedArrayForImageData(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),i=this.getBuffer(t.buffer).data,s=t.byteOffset||0;return new Uint8Array(i,s,t.byteLength)}addApplicationData(e,t){return this.json[e]=t,this}addExtraData(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this}addObjectExtension(e,t,n){return e.extensions=e.extensions||{},e.extensions[t]=n,this.registerUsedExtension(t),this}setObjectExtension(e,t,n){const i=e.extensions||{};i[t]=n}removeObjectExtension(e,t){const n=e?.extensions||{};if(n[t]){this.json.extensionsRemoved=this.json.extensionsRemoved||[];const i=this.json.extensionsRemoved;i.includes(t)||i.push(t)}delete n[t]}addExtension(e,t={}){return $a(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t}addRequiredExtension(e,t={}){return $a(t),this.addExtension(e,t),this.registerRequiredExtension(e),t}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(t=>t===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(t=>t===e)||this.json.extensionsRequired.push(e)}removeExtension(e){if(this.json.extensions?.[e]){this.json.extensionsRemoved=this.json.extensionsRemoved||[];const t=this.json.extensionsRemoved;t.includes(e)||t.push(e)}this.json.extensions&&delete this.json.extensions[e],this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e)}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:t}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:t}),this.json.scenes.length-1}addNode(e){const{meshIndex:t,matrix:n}=e;this.json.nodes=this.json.nodes||[];const i={mesh:t};return n&&(i.matrix=n),this.json.nodes.push(i),this.json.nodes.length-1}addMesh(e){const{attributes:t,indices:n,material:i,mode:s=4}=e,o={primitives:[{attributes:this._addAttributes(t),mode:s}]};if(n){const u=this._addIndices(n);o.primitives[0].indices=u}return Number.isFinite(i)&&(o.primitives[0].material=i),this.json.meshes=this.json.meshes||[],this.json.meshes.push(o),this.json.meshes.length-1}addPointCloud(e){const n={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(n),this.json.meshes.length-1}addImage(e,t){const n=Wk(e),i=t||n?.mimeType,a={bufferView:this.addBufferView(e),mimeType:i};return this.json.images=this.json.images||[],this.json.images.push(a),this.json.images.length-1}addBufferView(e,t=0,n=this.byteLength){const i=e.byteLength;$a(Number.isFinite(i)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const s={buffer:t,byteOffset:n,byteLength:i};return this.byteLength+=Kv(i,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(s),this.json.bufferViews.length-1}addAccessor(e,t){const n={bufferView:e,type:dJ(t.size),componentType:t.componentType,count:t.count,max:t.max,min:t.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(n),this.json.accessors.length-1}addBinaryBuffer(e,t={size:3}){const n=this.addBufferView(e);let i={min:t.min,max:t.max};(!i.min||!i.max)&&(i=this._getAccessorMinMax(e,t.size));const s={size:t.size,componentType:qS(e),count:Math.round(e.length/t.size),min:i.min,max:i.max};return this.addAccessor(n,Object.assign(s,t))}addTexture(e){const{imageIndex:t}=e,n={source:t};return this.json.textures=this.json.textures||[],this.json.textures.push(n),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){const e=this.byteLength,t=new ArrayBuffer(e),n=new Uint8Array(t);let i=0;for(const s of this.sourceBuffers||[])i=She(s,n,i);this.json?.buffers?.[0]?this.json.buffers[0].byteLength=e:this.json.buffers=[{byteLength:e}],this.gltf.binary=t,this.sourceBuffers=[t],this.gltf.buffers=[{arrayBuffer:t,byteOffset:0,byteLength:t.byteLength}]}_removeStringFromArray(e,t){let n=!0;for(;n;){const i=e.indexOf(t);i>-1?e.splice(i,1):n=!1}}_addAttributes(e={}){const t={};for(const n in e){const i=e[n],s=this._getGltfAttributeName(n),a=this.addBinaryBuffer(i.value,i);t[s]=a}return t}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,t){const n={min:null,max:null};if(e.length<t)return n;n.min=[],n.max=[];const i=e.subarray(0,t);for(const s of i)n.min.push(s),n.max.push(s);for(let s=t;s<e.length;s+=t)for(let a=0;a<t;a++)n.min[0+a]=Math.min(n.min[0+a],e[s+a]),n.max[0+a]=Math.max(n.max[0+a],e[s+a]);return n}}function SU(r){return(r%1+1)%1}const pJ={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16,BOOLEAN:1,STRING:1,ENUM:1},vIe={INT8:Int8Array,UINT8:Uint8Array,INT16:Int16Array,UINT16:Uint16Array,INT32:Int32Array,UINT32:Uint32Array,INT64:BigInt64Array,UINT64:BigUint64Array,FLOAT32:Float32Array,FLOAT64:Float64Array},gJ={INT8:1,UINT8:1,INT16:2,UINT16:2,INT32:4,UINT32:4,INT64:8,UINT64:8,FLOAT32:4,FLOAT64:8};function iD(r,e){return gJ[e]*pJ[r]}function YS(r,e,t,n){if(t!=="UINT8"&&t!=="UINT16"&&t!=="UINT32"&&t!=="UINT64")return null;const i=r.getTypedArrayForBufferView(e),s=ZS(i,"SCALAR",t,n+1);return s instanceof BigInt64Array||s instanceof BigUint64Array?null:s}function ZS(r,e,t,n=1){const i=pJ[e],s=vIe[t],a=gJ[t],o=n*i,u=o*a;let f=r.buffer,g=r.byteOffset;return g%a!==0&&(f=new Uint8Array(f).slice(g,g+u).buffer,g=0),new s(f,g,o)}function sD(r,e,t){const n=`TEXCOORD_${e.texCoord||0}`,i=t.attributes[n],s=r.getTypedArrayForAccessor(i),a=r.gltf.json,o=e.index,u=a.textures?.[o]?.source;if(typeof u<"u"){const f=a.images?.[u]?.mimeType,g=r.gltf.images?.[u];if(g&&typeof g.width<"u"){const y=[];for(let A=0;A<s.length;A+=2){const C=AIe(g,f,s,A,e.channels);y.push(C)}return y}}return[]}function mJ(r,e,t,n,i){if(!t?.length)return;const s=[];for(const g of t){let y=n.findIndex(A=>A===g);y===-1&&(y=n.push(g)-1),s.push(y)}const a=new Uint32Array(s),o=r.gltf.buffers.push({arrayBuffer:a.buffer,byteOffset:a.byteOffset,byteLength:a.byteLength})-1,u=r.addBufferView(a,o,0),f=r.addAccessor(u,{size:1,componentType:qS(a),count:a.length});i.attributes[e]=f}function AIe(r,e,t,n,i=[0]){const s={r:{offset:0,shift:0},g:{offset:1,shift:8},b:{offset:2,shift:16},a:{offset:3,shift:24}},a=t[n],o=t[n+1];let u=1;e&&(e.indexOf("image/jpeg")!==-1||e.indexOf("image/png")!==-1)&&(u=4);const f=xIe(a,o,r,u);let g=0;for(const y of i){const A=typeof y=="number"?Object.values(s)[y]:s[y],C=f+A.offset,M=oW(r);if(M.data.length<=C)throw new Error(`${M.data.length} <= ${C}`);const k=M.data[C];g|=k<<A.shift}return g}function xIe(r,e,t,n=1){const i=t.width,s=SU(r)*(i-1),a=Math.round(s),o=t.height,u=SU(e)*(o-1),f=Math.round(u),g=t.components?t.components:n;return(f*i+a)*g}function yJ(r,e,t,n,i){const s=[];for(let a=0;a<e;a++){const o=t[a],u=t[a+1]-t[a];if(u+o>n)break;const f=o/i,g=u/i;s.push(r.slice(f,f+g))}return s}function bJ(r,e,t){const n=[];for(let i=0;i<e;i++){const s=i*t;n.push(r.slice(s,s+t))}return n}function _J(r,e,t,n){if(t)throw new Error("Not implemented - arrayOffsets for strings is specified");if(n){const i=[],s=new TextDecoder("utf8");let a=0;for(let o=0;o<r;o++){const u=n[o+1]-n[o];if(u+a<=e.length){const f=e.subarray(a,u+a),g=s.decode(f);i.push(g),a+=u}}return i}return[]}const Vm="EXT_mesh_features",wIe=Vm;async function CIe(r,e){const t=new js(r);SIe(t,e)}function TIe(r,e){const t=new js(r);return IIe(t),t.createBinaryChunk(),t.gltf}function SIe(r,e){const t=r.gltf.json;if(t.meshes)for(const n of t.meshes)for(const i of n.primitives)EIe(r,i,e)}function EIe(r,e,t){if(!t?.gltf?.loadBuffers)return;const i=e.extensions?.[Vm]?.featureIds;if(i)for(const s of i){let a;if(typeof s.attribute<"u"){const o=`_FEATURE_ID_${s.attribute}`,u=e.attributes[o];a=r.getTypedArrayForAccessor(u)}else typeof s.texture<"u"&&t?.gltf?.loadImages?a=sD(r,s.texture,e):a=[];s.data=a}}function IIe(r,e){const t=r.gltf.json.meshes;if(t)for(const n of t)for(const i of n.primitives)BIe(r,i)}function PIe(r,e,t,n){e.extensions||(e.extensions={});let i=e.extensions[Vm];i||(i={featureIds:[]},e.extensions[Vm]=i);const{featureIds:s}=i,a={featureCount:t.length,propertyTable:n,data:t};s.push(a),r.addObjectExtension(e,Vm,i)}function BIe(r,e){const t=e.extensions?.[Vm];if(!t)return;const n=t.featureIds;n.forEach((i,s)=>{if(i.data){const{accessorKey:a,index:o}=MIe(e.attributes),u=new Uint32Array(i.data);n[s]={featureCount:u.length,propertyTable:i.propertyTable,attribute:o},r.gltf.buffers.push({arrayBuffer:u.buffer,byteOffset:u.byteOffset,byteLength:u.byteLength});const f=r.addBufferView(u),g=r.addAccessor(f,{size:1,componentType:qS(u),count:u.length});e.attributes[a]=g}})}function MIe(r){const e="_FEATURE_ID_",t=Object.keys(r).filter(s=>s.indexOf(e)===0);let n=-1;for(const s of t){const a=Number(s.substring(e.length));a>n&&(n=a)}return n++,{accessorKey:`${e}${n}`,index:n}}const RIe=Object.freeze(Object.defineProperty({__proto__:null,createExtMeshFeatures:PIe,decode:CIe,encode:TIe,name:wIe},Symbol.toStringTag,{value:"Module"})),cy="EXT_structural_metadata",kIe=cy;async function OIe(r,e){const t=new js(r);LIe(t,e)}function DIe(r,e){const t=new js(r);return ZIe(t),t.createBinaryChunk(),t.gltf}function LIe(r,e){if(!e.gltf?.loadBuffers)return;const t=r.getExtension(cy);t&&(e.gltf?.loadImages&&NIe(r,t),FIe(r,t))}function NIe(r,e){const t=e.propertyTextures,n=r.gltf.json;if(t&&n.meshes)for(const i of n.meshes)for(const s of i.primitives)zIe(r,t,s,e)}function FIe(r,e){const t=e.schema;if(!t)return;const n=t.classes,i=e.propertyTables;if(n&&i)for(const s in n){const a=UIe(i,s);a&&$Ie(r,t,a)}}function UIe(r,e){for(const t of r)if(t.class===e)return t;return null}function zIe(r,e,t,n){if(!e)return;const s=t.extensions?.[cy]?.propertyTextures;if(s)for(const a of s){const o=e[a];VIe(r,o,t,n)}}function VIe(r,e,t,n){if(!e.properties)return;n.dataAttributeNames||(n.dataAttributeNames=[]);const i=e.class;for(const s in e.properties){const a=`${i}_${s}`,o=e.properties?.[s];if(!o)continue;o.data||(o.data=[]);const u=o.data,f=sD(r,o,t);f!==null&&(mJ(r,a,f,u,t),o.data=u,n.dataAttributeNames.push(a))}}function $Ie(r,e,t){const n=e.classes?.[t.class];if(!n)throw new Error(`Incorrect data in the EXT_structural_metadata extension: no schema class with name ${t.class}`);const i=t.count;for(const s in n.properties){const a=n.properties[s],o=t.properties?.[s];if(o){const u=jIe(r,e,a,i,o);o.data=u}}}function jIe(r,e,t,n,i){let s=[];const a=i.values,o=r.getTypedArrayForBufferView(a),u=GIe(r,t,i,n),f=HIe(r,i,n);switch(t.type){case"SCALAR":case"VEC2":case"VEC3":case"VEC4":case"MAT2":case"MAT3":case"MAT4":{s=WIe(t,n,o,u);break}case"BOOLEAN":throw new Error(`Not implemented - classProperty.type=${t.type}`);case"STRING":{s=_J(n,o,u,f);break}case"ENUM":{s=KIe(e,t,n,o,u);break}default:throw new Error(`Unknown classProperty type ${t.type}`)}return s}function GIe(r,e,t,n){return e.array&&typeof e.count>"u"&&typeof t.arrayOffsets<"u"?YS(r,t.arrayOffsets,t.arrayOffsetType||"UINT32",n):null}function HIe(r,e,t){return typeof e.stringOffsets<"u"?YS(r,e.stringOffsets,e.stringOffsetType||"UINT32",t):null}function WIe(r,e,t,n){const i=r.array,s=r.count,a=iD(r.type,r.componentType),o=t.byteLength/a;let u;return r.componentType?u=ZS(t,r.type,r.componentType,o):u=t,i?n?yJ(u,e,n,t.length,a):s?bJ(u,e,s):[]:u}function KIe(r,e,t,n,i){const s=e.enumType;if(!s)throw new Error("Incorrect data in the EXT_structural_metadata extension: classProperty.enumType is not set for type ENUM");const a=r.enums?.[s];if(!a)throw new Error(`Incorrect data in the EXT_structural_metadata extension: schema.enums does't contain ${s}`);const o=a.valueType||"UINT16",u=iD(e.type,o),f=n.byteLength/u;let g=ZS(n,e.type,o,f);if(g||(g=n),e.array){if(i)return XIe({valuesData:g,numberOfElements:t,arrayOffsets:i,valuesDataBytesLength:n.length,elementSize:u,enumEntry:a});const y=e.count;return y?JIe(g,t,y,a):[]}return oD(g,0,t,a)}function XIe(r){const{valuesData:e,numberOfElements:t,arrayOffsets:n,valuesDataBytesLength:i,elementSize:s,enumEntry:a}=r,o=[];for(let u=0;u<t;u++){const f=n[u],g=n[u+1]-n[u];if(g+f>i)break;const y=f/s,A=g/s,C=oD(e,y,A,a);o.push(C)}return o}function JIe(r,e,t,n){const i=[];for(let s=0;s<e;s++){const a=t*s,o=oD(r,a,t,n);i.push(o)}return i}function oD(r,e,t,n){const i=[];for(let s=0;s<t;s++)if(r instanceof BigInt64Array||r instanceof BigUint64Array)i.push("");else{const a=r[e+s],o=qIe(n,a);o?i.push(o.name):i.push("")}return i}function qIe(r,e){for(const t of r.values)if(t.value===e)return t;return null}const YIe="schemaClassId";function ZIe(r,e){const t=r.getExtension(cy);if(t&&t.propertyTables)for(const n of t.propertyTables){const i=n.class,s=t.schema?.classes?.[i];n.properties&&s&&QIe(n,s,r)}}function QIe(r,e,t){for(const n in r.properties){const i=r.properties[n].data;if(i){const s=e.properties[n];if(s){const a=nPe(i,s,t);r.properties[n]=a}}}}function ePe(r,e,t=YIe){let n=r.getExtension(cy);n||(n=r.addExtension(cy)),n.schema=tPe(e,t,n.schema);const i=rPe(e,t,n.schema);return n.propertyTables||(n.propertyTables=[]),n.propertyTables.push(i)-1}function tPe(r,e,t){const n=t??{id:"schema_id"},i={properties:{}};for(const s of r){const a={type:s.elementType,componentType:s.componentType};i.properties[s.name]=a}return n.classes={},n.classes[e]=i,n}function rPe(r,e,t){const n={class:e,count:0};let i=0;const s=t.classes?.[e];for(const a of r){if(i===0&&(i=a.values.length),i!==a.values.length&&a.values.length)throw new Error("Illegal values in attributes");s?.properties[a.name]&&(n.properties||(n.properties={}),n.properties[a.name]={values:0,data:a.values})}return n.count=i,n}function nPe(r,e,t){const n={values:0};if(e.type==="STRING"){const{stringData:i,stringOffsets:s}=oPe(r);n.stringOffsets=hP(s,t),n.values=hP(i,t)}else if(e.type==="SCALAR"&&e.componentType){const i=sPe(r,e.componentType);n.values=hP(i,t)}return n}const iPe={INT8:Int8Array,UINT8:Uint8Array,INT16:Int16Array,UINT16:Uint16Array,INT32:Int32Array,UINT32:Uint32Array,INT64:Int32Array,UINT64:Uint32Array,FLOAT32:Float32Array,FLOAT64:Float64Array};function sPe(r,e){const t=[];for(const i of r)t.push(Number(i));const n=iPe[e];if(!n)throw new Error("Illegal component type");return new n(t)}function oPe(r){const e=new TextEncoder,t=[];let n=0;for(const u of r){const f=e.encode(u);n+=f.length,t.push(f)}const i=new Uint8Array(n),s=[];let a=0;for(const u of t)i.set(u,a),s.push(a),a+=u.length;s.push(a);const o=new Uint32Array(s);return{stringData:i,stringOffsets:o}}function hP(r,e){return e.gltf.buffers.push({arrayBuffer:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength}),e.addBufferView(r)}const aPe=Object.freeze(Object.defineProperty({__proto__:null,createExtStructuralMetadata:ePe,decode:OIe,encode:DIe,name:kIe},Symbol.toStringTag,{value:"Module"})),vJ="EXT_feature_metadata",lPe=vJ;async function cPe(r,e){const t=new js(r);uPe(t,e)}function uPe(r,e){if(!e.gltf?.loadBuffers)return;const t=r.getExtension(vJ);t&&(e.gltf?.loadImages&&hPe(r,t),dPe(r,t))}function hPe(r,e){const t=e.schema;if(!t)return;const n=t.classes,{featureTextures:i}=e;if(n&&i)for(const s in n){const a=n[s],o=pPe(i,s);o&&mPe(r,o,a)}}function dPe(r,e){const t=e.schema;if(!t)return;const n=t.classes,i=e.featureTables;if(n&&i)for(const s in n){const a=fPe(i,s);a&&gPe(r,t,a)}}function fPe(r,e){for(const t in r){const n=r[t];if(n.class===e)return n}return null}function pPe(r,e){for(const t in r){const n=r[t];if(n.class===e)return n}return null}function gPe(r,e,t){if(!t.class)return;const n=e.classes?.[t.class];if(!n)throw new Error(`Incorrect data in the EXT_structural_metadata extension: no schema class with name ${t.class}`);const i=t.count;for(const s in n.properties){const a=n.properties[s],o=t.properties?.[s];if(o){const u=yPe(r,e,a,i,o);o.data=u}}}function mPe(r,e,t){const n=e.class;for(const i in t.properties){const s=e?.properties?.[i];if(s){const a=xPe(r,s,n);s.data=a}}}function yPe(r,e,t,n,i){let s=[];const a=i.bufferView,o=r.getTypedArrayForBufferView(a),u=bPe(r,t,i,n),f=_Pe(r,t,i,n);return t.type==="STRING"||t.componentType==="STRING"?s=_J(n,o,u,f):vPe(t)&&(s=APe(t,n,o,u)),s}function bPe(r,e,t,n){return e.type==="ARRAY"&&typeof e.componentCount>"u"&&typeof t.arrayOffsetBufferView<"u"?YS(r,t.arrayOffsetBufferView,t.offsetType||"UINT32",n):null}function _Pe(r,e,t,n){return typeof t.stringOffsetBufferView<"u"?YS(r,t.stringOffsetBufferView,t.offsetType||"UINT32",n):null}function vPe(r){const e=["UINT8","INT16","UINT16","INT32","UINT32","INT64","UINT64","FLOAT32","FLOAT64"];return e.includes(r.type)||typeof r.componentType<"u"&&e.includes(r.componentType)}function APe(r,e,t,n){const i=r.type==="ARRAY",s=r.componentCount,a="SCALAR",o=r.componentType||r.type,u=iD(a,o),f=t.byteLength/u,g=ZS(t,a,o,f);return i?n?yJ(g,e,n,t.length,u):s?bJ(g,e,s):[]:g}function xPe(r,e,t){const n=r.gltf.json;if(!n.meshes)return[];const i=[];for(const s of n.meshes)for(const a of s.primitives)wPe(r,t,e,i,a);return i}function wPe(r,e,t,n,i){const s={channels:t.channels,...t.texture},a=sD(r,s,i);a&&mJ(r,e,a,n,i)}const CPe=Object.freeze(Object.defineProperty({__proto__:null,decode:cPe,name:lPe},Symbol.toStringTag,{value:"Module"})),TPe="4.3.3",uy=!0,EU=1735152710,aD=12,rT=8,SPe=1313821514,EPe=5130562,IPe=0,PPe=0,BPe=1;function MPe(r,e=0){return`${String.fromCharCode(r.getUint8(e+0))}${String.fromCharCode(r.getUint8(e+1))}${String.fromCharCode(r.getUint8(e+2))}${String.fromCharCode(r.getUint8(e+3))}`}function RPe(r,e=0,t={}){const n=new DataView(r),{magic:i=EU}=t,s=n.getUint32(e,!1);return s===i||s===EU}function kPe(r,e,t=0,n={}){const i=new DataView(e),s=MPe(i,t+0),a=i.getUint32(t+4,uy),o=i.getUint32(t+8,uy);switch(Object.assign(r,{header:{byteOffset:t,byteLength:o,hasBinChunk:!1},type:s,version:a,json:{},binChunks:[]}),t+=aD,r.version){case 1:return OPe(r,i,t);case 2:return DPe(r,i,t,n={});default:throw new Error(`Invalid GLB version ${r.version}. Only supports version 1 and 2.`)}}function OPe(r,e,t){ci(r.header.byteLength>aD+rT);const n=e.getUint32(t+0,uy),i=e.getUint32(t+4,uy);return t+=rT,ci(i===IPe),qB(r,e,t,n),t+=n,t+=YB(r,e,t,r.header.byteLength),t}function DPe(r,e,t,n){return ci(r.header.byteLength>aD+rT),LPe(r,e,t,n),t+r.header.byteLength}function LPe(r,e,t,n){for(;t+8<=r.header.byteLength;){const i=e.getUint32(t+0,uy),s=e.getUint32(t+4,uy);switch(t+=rT,s){case SPe:qB(r,e,t,i);break;case EPe:YB(r,e,t,i);break;case PPe:n.strict||qB(r,e,t,i);break;case BPe:n.strict||YB(r,e,t,i);break}t+=Kv(i,4)}return t}function qB(r,e,t,n){const i=new Uint8Array(e.buffer,t,n),a=new TextDecoder("utf8").decode(i);return r.json=JSON.parse(a),Kv(n,4)}function YB(r,e,t,n){return r.header.hasBinChunk=!0,r.binChunks.push({byteOffset:t,byteLength:n,arrayBuffer:e.buffer}),Kv(n,4)}function AJ(r,e){if(r.startsWith("data:")||r.startsWith("http:")||r.startsWith("https:"))return r;const n=e.baseUri||e.uri;if(!n)throw new Error(`'baseUri' must be provided to resolve relative url ${r}`);return n.substr(0,n.lastIndexOf("/")+1)+r}const NPe="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",FPe="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",UPe=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),zPe=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),VPe={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},$Pe={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};async function jPe(r,e,t,n,i,s="NONE"){const a=await GPe();KPe(a,a.exports[$Pe[i]],r,e,t,n,a.exports[VPe[s||"NONE"]])}let dP;async function GPe(){return dP||(dP=HPe()),dP}async function HPe(){let r=NPe;WebAssembly.validate(UPe)&&(r=FPe,console.log("Warning: meshopt_decoder is using experimental SIMD support"));const e=await WebAssembly.instantiate(WPe(r),{});return await e.instance.exports.__wasm_call_ctors(),e.instance}function WPe(r){const e=new Uint8Array(r.length);for(let n=0;n<r.length;++n){const i=r.charCodeAt(n);e[n]=i>96?i-71:i>64?i-65:i>47?i+4:i>46?63:62}let t=0;for(let n=0;n<r.length;++n)e[t++]=e[n]<60?zPe[e[n]]:(e[n]-60)*64+e[++n];return e.buffer.slice(0,t)}function KPe(r,e,t,n,i,s,a){const o=r.exports.sbrk,u=n+3&-4,f=o(u*i),g=o(s.length),y=new Uint8Array(r.exports.memory.buffer);y.set(s,g);const A=e(f,n,i,g,s.length);if(A===0&&a&&a(f,u,i),t.set(y.subarray(f,f+n*i)),o(f-o(0)),A!==0)throw new Error(`Malformed buffer data: ${A}`)}const nT="EXT_meshopt_compression",XPe=nT;async function JPe(r,e){const t=new js(r);if(!e?.gltf?.decompressMeshes||!e.gltf?.loadBuffers)return;const n=[];for(const i of r.json.bufferViews||[])n.push(qPe(t,i));await Promise.all(n),t.removeExtension(nT)}async function qPe(r,e){const t=r.getObjectExtension(e,nT);if(t){const{byteOffset:n=0,byteLength:i=0,byteStride:s,count:a,mode:o,filter:u="NONE",buffer:f}=t,g=r.gltf.buffers[f],y=new Uint8Array(g.arrayBuffer,g.byteOffset+n,i),A=new Uint8Array(r.gltf.buffers[e.buffer].arrayBuffer,e.byteOffset,e.byteLength);await jPe(A,a,s,y,o,u),r.removeObjectExtension(e,nT)}}const YPe=Object.freeze(Object.defineProperty({__proto__:null,decode:JPe,name:XPe},Symbol.toStringTag,{value:"Module"})),om="EXT_texture_webp",ZPe=om;function QPe(r,e){const t=new js(r);if(!wfe("image/webp")){if(t.getRequiredExtensions().includes(om))throw new Error(`gltf: Required extension ${om} not supported by browser`);return}const{json:n}=t;for(const i of n.textures||[]){const s=t.getObjectExtension(i,om);s&&(i.source=s.source),t.removeObjectExtension(i,om)}t.removeExtension(om)}const e3e=Object.freeze(Object.defineProperty({__proto__:null,name:ZPe,preprocess:QPe},Symbol.toStringTag,{value:"Module"})),Nw="KHR_texture_basisu",t3e=Nw;function r3e(r,e){const t=new js(r),{json:n}=t;for(const i of n.textures||[]){const s=t.getObjectExtension(i,Nw);s&&(i.source=s.source,t.removeObjectExtension(i,Nw))}t.removeExtension(Nw)}const n3e=Object.freeze(Object.defineProperty({__proto__:null,name:t3e,preprocess:r3e},Symbol.toStringTag,{value:"Module"})),i3e="4.3.3",s3e={dataType:null,batchType:null,name:"Draco",id:"draco",module:"draco",version:i3e,worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:typeof WebAssembly=="object"?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};function o3e(r,e,t){const n=xJ(e.metadata),i=[],s=a3e(e.attributes);for(const a in r){const o=r[a],u=IU(a,o,s[a]);i.push(u)}if(t){const a=IU("indices",t);i.push(a)}return{fields:i,metadata:n}}function a3e(r){const e={};for(const t in r){const n=r[t];e[n.name||"undefined"]=n}return e}function IU(r,e,t){const n=t?xJ(t.metadata):void 0;return jde(r,e,n)}function xJ(r){Object.entries(r);const e={};for(const t in r)e[`${t}.string`]=JSON.stringify(r[t]);return e}const PU={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},l3e={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},c3e=4;class u3e{constructor(e){H(this,"draco");H(this,"decoder");H(this,"metadataQuerier");this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e,t={}){const n=new this.draco.DecoderBuffer;n.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(t);const i=this.decoder.GetEncodedGeometryType(n),s=i===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let a;switch(i){case this.draco.TRIANGULAR_MESH:a=this.decoder.DecodeBufferToMesh(n,s);break;case this.draco.POINT_CLOUD:a=this.decoder.DecodeBufferToPointCloud(n,s);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!a.ok()||!s.ptr){const A=`DRACO decompression failed: ${a.error_msg()}`;throw new Error(A)}const o=this._getDracoLoaderData(s,i,t),u=this._getMeshData(s,o,t),f=sW(u.attributes),g=o3e(u.attributes,o,u.indices);return{loader:"draco",loaderData:o,header:{vertexCount:s.num_points(),boundingBox:f},...u,schema:g}}finally{this.draco.destroy(n),s&&this.draco.destroy(s)}}_getDracoLoaderData(e,t,n){const i=this._getTopLevelMetadata(e),s=this._getDracoAttributes(e,n);return{geometry_type:t,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:i,attributes:s}}_getDracoAttributes(e,t){const n={};for(let i=0;i<e.num_attributes();i++){const s=this.decoder.GetAttribute(e,i),a=this._getAttributeMetadata(e,i);n[s.unique_id()]={unique_id:s.unique_id(),attribute_type:s.attribute_type(),data_type:s.data_type(),num_components:s.num_components(),byte_offset:s.byte_offset(),byte_stride:s.byte_stride(),normalized:s.normalized(),attribute_index:i,metadata:a};const o=this._getQuantizationTransform(s,t);o&&(n[s.unique_id()].quantization_transform=o);const u=this._getOctahedronTransform(s,t);u&&(n[s.unique_id()].octahedron_transform=u)}return n}_getMeshData(e,t,n){const i=this._getMeshAttributes(t,e,n);if(!i.POSITION)throw new Error("DRACO: No position attribute found.");if(e instanceof this.draco.Mesh)switch(n.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:i,indices:{value:this._getTriangleStripIndices(e),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:i,indices:{value:this._getTriangleListIndices(e),size:1}}}return{topology:"point-list",mode:0,attributes:i}}_getMeshAttributes(e,t,n){const i={};for(const s of Object.values(e.attributes)){const a=this._deduceAttributeName(s,n);s.name=a;const o=this._getAttributeValues(t,s);if(o){const{value:u,size:f}=o;i[a]={value:u,size:f,byteOffset:s.byte_offset,byteStride:s.byte_stride,normalized:s.normalized}}}return i}_getTriangleListIndices(e){const n=e.num_faces()*3,i=n*c3e,s=this.draco._malloc(i);try{return this.decoder.GetTrianglesUInt32Array(e,i,s),new Uint32Array(this.draco.HEAPF32.buffer,s,n).slice()}finally{this.draco._free(s)}}_getTriangleStripIndices(e){const t=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,t),f3e(t)}finally{this.draco.destroy(t)}}_getAttributeValues(e,t){const n=l3e[t.data_type];if(!n)return console.warn(`DRACO: Unsupported attribute type ${t.data_type}`),null;const i=t.num_components,a=e.num_points()*i,o=a*n.BYTES_PER_ELEMENT,u=h3e(this.draco,n);let f;const g=this.draco._malloc(o);try{const y=this.decoder.GetAttribute(e,t.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,y,u,o,g),f=new n(this.draco.HEAPF32.buffer,g,a).slice()}finally{this.draco._free(g)}return{value:f,size:i}}_deduceAttributeName(e,t){const n=e.unique_id;for(const[a,o]of Object.entries(t.extraAttributes||{}))if(o===n)return a;const i=e.attribute_type;for(const a in PU)if(this.draco[a]===i)return PU[a];const s=t.attributeNameEntry||"name";return e.metadata[s]?e.metadata[s].string:`CUSTOM_ATTRIBUTE_${n}`}_getTopLevelMetadata(e){const t=this.decoder.GetMetadata(e);return this._getDracoMetadata(t)}_getAttributeMetadata(e,t){const n=this.decoder.GetAttributeMetadata(e,t);return this._getDracoMetadata(n)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const t={},n=this.metadataQuerier.NumEntries(e);for(let i=0;i<n;i++){const s=this.metadataQuerier.GetEntryName(e,i);t[s]=this._getDracoMetadataField(e,s)}return t}_getDracoMetadataField(e,t){const n=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,t,n);const i=d3e(n);return{int:this.metadataQuerier.GetIntEntry(e,t),string:this.metadataQuerier.GetStringEntry(e,t),double:this.metadataQuerier.GetDoubleEntry(e,t),intArray:i}}finally{this.draco.destroy(n)}}_disableAttributeTransforms(e){const{quantizedAttributes:t=[],octahedronAttributes:n=[]}=e,i=[...t,...n];for(const s of i)this.decoder.SkipAttributeTransform(this.draco[s])}_getQuantizationTransform(e,t){const{quantizedAttributes:n=[]}=t,i=e.attribute_type();if(n.map(a=>this.decoder[a]).includes(i)){const a=new this.draco.AttributeQuantizationTransform;try{if(a.InitFromAttribute(e))return{quantization_bits:a.quantization_bits(),range:a.range(),min_values:new Float32Array([1,2,3]).map(o=>a.min_value(o))}}finally{this.draco.destroy(a)}}return null}_getOctahedronTransform(e,t){const{octahedronAttributes:n=[]}=t,i=e.attribute_type();if(n.map(a=>this.decoder[a]).includes(i)){const a=new this.draco.AttributeQuantizationTransform;try{if(a.InitFromAttribute(e))return{quantization_bits:a.quantization_bits()}}finally{this.draco.destroy(a)}}return null}}function h3e(r,e){switch(e){case Float32Array:return r.DT_FLOAT32;case Int8Array:return r.DT_INT8;case Int16Array:return r.DT_INT16;case Int32Array:return r.DT_INT32;case Uint8Array:return r.DT_UINT8;case Uint16Array:return r.DT_UINT16;case Uint32Array:return r.DT_UINT32;default:return r.DT_INVALID}}function d3e(r){const e=r.size(),t=new Int32Array(e);for(let n=0;n<e;n++)t[n]=r.GetValue(n);return t}function f3e(r){const e=r.size(),t=new Int32Array(e);for(let n=0;n<e;n++)t[n]=r.GetValue(n);return t}const p3e="1.5.6",g3e="1.4.1",fP=`https://www.gstatic.com/draco/versioned/decoders/${p3e}`,ia={DECODER:"draco_wasm_wrapper.js",DECODER_WASM:"draco_decoder.wasm",FALLBACK_DECODER:"draco_decoder.js",ENCODER:"draco_encoder.js"},pP={[ia.DECODER]:`${fP}/${ia.DECODER}`,[ia.DECODER_WASM]:`${fP}/${ia.DECODER_WASM}`,[ia.FALLBACK_DECODER]:`${fP}/${ia.FALLBACK_DECODER}`,[ia.ENCODER]:`https://raw.githubusercontent.com/google/draco/${g3e}/javascript/${ia.ENCODER}`};let gP;async function m3e(r){const e=r.modules||{};return e.draco3d?gP||(gP=e.draco3d.createDecoderModule({}).then(t=>({draco:t}))):gP||(gP=y3e(r)),await gP}async function y3e(r){let e,t;switch(r.draco&&r.draco.decoderType){case"js":e=await Xf(pP[ia.FALLBACK_DECODER],"draco",r,ia.FALLBACK_DECODER);break;case"wasm":default:[e,t]=await Promise.all([await Xf(pP[ia.DECODER],"draco",r,ia.DECODER),await Xf(pP[ia.DECODER_WASM],"draco",r,ia.DECODER_WASM)])}return e=e||globalThis.DracoDecoderModule,await b3e(e,t)}function b3e(r,e){const t={};return e&&(t.wasmBinary=e),new Promise(n=>{r({...t,onModuleLoaded:i=>n({draco:i})})})}const wJ={...s3e,parse:_3e};async function _3e(r,e){const{draco:t}=await m3e(e),n=new u3e(t);try{return n.parseSync(r,e?.draco)}finally{n.destroy()}}function v3e(r){const e={};for(const t in r){const n=r[t];if(t!=="indices"){const i=CJ(n);e[t]=i}}return e}function CJ(r){const{buffer:e,size:t,count:n}=A3e(r);return{value:e,size:t,byteOffset:0,count:n,type:dJ(t),componentType:qS(e)}}function A3e(r){let e=r,t=1,n=0;return r&&r.value&&(e=r.value,t=r.size||1),e&&(ArrayBuffer.isView(e)||(e=x3e(e,Float32Array)),n=e.length/t),{buffer:e,size:t,count:n}}function x3e(r,e,t=!1){return r?Array.isArray(r)?new e(r):t&&!(r instanceof e)?new e(r):r:null}const wd="KHR_draco_mesh_compression",w3e=wd;function C3e(r,e,t){const n=new js(r);for(const i of TJ(n))n.getObjectExtension(i,wd)}async function T3e(r,e,t){if(!e?.gltf?.decompressMeshes)return;const n=new js(r),i=[];for(const s of TJ(n))n.getObjectExtension(s,wd)&&i.push(E3e(n,s,e,t));await Promise.all(i),n.removeExtension(wd)}function S3e(r,e={}){const t=new js(r);for(const n of t.json.meshes||[])I3e(n),t.addRequiredExtension(wd)}async function E3e(r,e,t,n){const i=r.getObjectExtension(e,wd);if(!i)return;const s=r.getTypedArrayForBufferView(i.bufferView),a=Uk(s.buffer,s.byteOffset),o={...t};delete o["3d-tiles"];const u=await Wv(a,wJ,o,n),f=v3e(u.attributes);for(const[g,y]of Object.entries(f))if(g in e.attributes){const A=e.attributes[g],C=r.getAccessor(A);C?.min&&C?.max&&(y.min=C.min,y.max=C.max)}e.attributes=f,u.indices&&(e.indices=CJ(u.indices)),r.removeObjectExtension(e,wd),P3e(e)}function I3e(r,e,t=4,n,i){if(!n.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const s=n.DracoWriter.encodeSync({attributes:r}),a=i?.parseSync?.({attributes:r}),o=n._addFauxAttributes(a.attributes),u=n.addBufferView(s);return{primitives:[{attributes:o,mode:t,extensions:{[wd]:{bufferView:u,attributes:o}}}]}}function P3e(r){if(!r.attributes&&Object.keys(r.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*TJ(r){for(const e of r.json.meshes||[])for(const t of e.primitives)yield t}const B3e=Object.freeze(Object.defineProperty({__proto__:null,decode:T3e,encode:S3e,name:w3e,preprocess:C3e},Symbol.toStringTag,{value:"Module"})),QS="KHR_texture_transform",M3e=QS,xx=new rt,R3e=new Hi,k3e=new Hi;async function O3e(r,e){if(!new js(r).hasExtension(QS)||!e.gltf?.loadBuffers)return;const i=r.json.materials||[];for(let s=0;s<i.length;s++)D3e(s,r)}function D3e(r,e){const t=e.json.materials?.[r],n=[t?.pbrMetallicRoughness?.baseColorTexture,t?.emissiveTexture,t?.normalTexture,t?.occlusionTexture,t?.pbrMetallicRoughness?.metallicRoughnessTexture],i=[];for(const s of n)s&&s?.extensions?.[QS]&&L3e(e,r,s,i)}function L3e(r,e,t,n){const i=N3e(t,n);if(!i)return;const s=r.json.meshes||[];for(const a of s)for(const o of a.primitives){const u=o.material;Number.isFinite(u)&&e===u&&F3e(r,o,i)}}function N3e(r,e){const t=r.extensions?.[QS],{texCoord:n=0}=r,{texCoord:i=n}=t;if(!(e.findIndex(([a,o])=>a===n&&o===i)!==-1)){const a=V3e(t);return n!==i&&(r.texCoord=i),e.push([n,i]),{originalTexCoord:n,texCoord:i,matrix:a}}return null}function F3e(r,e,t){const{originalTexCoord:n,texCoord:i,matrix:s}=t,a=e.attributes[`TEXCOORD_${n}`];if(Number.isFinite(a)){const o=r.json.accessors?.[a];if(o&&o.bufferView){const u=r.json.bufferViews?.[o.bufferView];if(u){const{arrayBuffer:f,byteOffset:g}=r.buffers[u.buffer],y=(g||0)+(o.byteOffset||0)+(u.byteOffset||0),{ArrayType:A,length:C}=nD(o,u),M=hJ[o.componentType],k=uJ[o.type],D=u.byteStride||M*k,V=new Float32Array(C);for(let W=0;W<o.count;W++){const z=new A(f,y+W*D,2);xx.set(z[0],z[1],1),xx.transformByMatrix3(s),V.set([xx[0],xx[1]],W*k)}n===i?U3e(o,u,r.buffers,V):z3e(i,o,e,r,V)}}}}function U3e(r,e,t,n){r.componentType=5126,t.push({arrayBuffer:n.buffer,byteOffset:0,byteLength:n.buffer.byteLength}),e.buffer=t.length-1,e.byteLength=n.buffer.byteLength,e.byteOffset=0,delete e.byteStride}function z3e(r,e,t,n,i){n.buffers.push({arrayBuffer:i.buffer,byteOffset:0,byteLength:i.buffer.byteLength});const s=n.json.bufferViews;if(!s)return;s.push({buffer:n.buffers.length-1,byteLength:i.buffer.byteLength,byteOffset:0});const a=n.json.accessors;a&&(a.push({bufferView:s?.length-1,byteOffset:0,componentType:5126,count:e.count,type:"VEC2"}),t.attributes[`TEXCOORD_${r}`]=a.length-1)}function V3e(r){const{offset:e=[0,0],rotation:t=0,scale:n=[1,1]}=r,i=new Hi().set(1,0,0,0,1,0,e[0],e[1],1),s=R3e.set(Math.cos(t),Math.sin(t),0,-Math.sin(t),Math.cos(t),0,0,0,1),a=k3e.set(n[0],0,0,0,n[1],0,0,0,1);return i.multiplyRight(s).multiplyRight(a)}const $3e=Object.freeze(Object.defineProperty({__proto__:null,decode:O3e,name:M3e},Symbol.toStringTag,{value:"Module"})),Vf="KHR_lights_punctual",j3e=Vf;async function G3e(r){const e=new js(r),{json:t}=e,n=e.getExtension(Vf);n&&(e.json.lights=n.lights,e.removeExtension(Vf));for(const i of t.nodes||[]){const s=e.getObjectExtension(i,Vf);s&&(i.light=s.light),e.removeObjectExtension(i,Vf)}}async function H3e(r){const e=new js(r),{json:t}=e;if(t.lights){const n=e.addExtension(Vf);$a(!n.lights),n.lights=t.lights,delete t.lights}if(e.json.lights){for(const n of e.json.lights){const i=n.node;e.addObjectExtension(i,Vf,n)}delete e.json.lights}}const W3e=Object.freeze(Object.defineProperty({__proto__:null,decode:G3e,encode:H3e,name:j3e},Symbol.toStringTag,{value:"Module"})),tv="KHR_materials_unlit",K3e=tv;async function X3e(r){const e=new js(r),{json:t}=e;for(const n of t.materials||[])n.extensions&&n.extensions.KHR_materials_unlit&&(n.unlit=!0),e.removeObjectExtension(n,tv);e.removeExtension(tv)}function J3e(r){const e=new js(r),{json:t}=e;if(e.materials)for(const n of t.materials||[])n.unlit&&(delete n.unlit,e.addObjectExtension(n,tv,{}),e.addExtension(tv))}const q3e=Object.freeze(Object.defineProperty({__proto__:null,decode:X3e,encode:J3e,name:K3e},Symbol.toStringTag,{value:"Module"})),k0="KHR_techniques_webgl",Y3e=k0;async function Z3e(r){const e=new js(r),{json:t}=e,n=e.getExtension(k0);if(n){const i=eBe(n,e);for(const s of t.materials||[]){const a=e.getObjectExtension(s,k0);a&&(s.technique=Object.assign({},a,i[a.technique]),s.technique.values=tBe(s.technique,e)),e.removeObjectExtension(s,k0)}e.removeExtension(k0)}}async function Q3e(r,e){}function eBe(r,e){const{programs:t=[],shaders:n=[],techniques:i=[]}=r,s=new TextDecoder;return n.forEach(a=>{if(Number.isFinite(a.bufferView))a.code=s.decode(e.getTypedArrayForBufferView(a.bufferView));else throw new Error("KHR_techniques_webgl: no shader code")}),t.forEach(a=>{a.fragmentShader=n[a.fragmentShader],a.vertexShader=n[a.vertexShader]}),i.forEach(a=>{a.program=t[a.program]}),i}function tBe(r,e){const t=Object.assign({},r.values);return Object.keys(r.uniforms||{}).forEach(n=>{r.uniforms[n].value&&!(n in t)&&(t[n]=r.uniforms[n].value)}),Object.keys(t).forEach(n=>{typeof t[n]=="object"&&t[n].index!==void 0&&(t[n].texture=e.getTexture(t[n].index))}),t}const rBe=Object.freeze(Object.defineProperty({__proto__:null,decode:Z3e,encode:Q3e,name:Y3e},Symbol.toStringTag,{value:"Module"})),SJ=[aPe,RIe,YPe,e3e,n3e,B3e,W3e,q3e,rBe,$3e,CPe];function nBe(r,e={},t){const n=SJ.filter(i=>EJ(i.name,e));for(const i of n)i.preprocess?.(r,e,t)}async function iBe(r,e={},t){const n=SJ.filter(i=>EJ(i.name,e));for(const i of n)await i.decode?.(r,e,t)}function EJ(r,e){const t=e?.gltf?.excludeExtensions||{};return!(r in t&&!t[r])}const mP="KHR_binary_glTF";function sBe(r){const e=new js(r),{json:t}=e;for(const n of t.images||[]){const i=e.getObjectExtension(n,mP);i&&Object.assign(n,i),e.removeObjectExtension(n,mP)}t.buffers&&t.buffers[0]&&delete t.buffers[0].uri,e.removeExtension(mP)}const BU={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},oBe={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class aBe{constructor(){H(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}});H(this,"json")}normalize(e,t){this.json=e.json;const n=e.json;switch(n.asset&&n.asset.version){case"2.0":return;case void 0:case"1.0":break;default:console.warn(`glTF: Unknown version ${n.asset.version}`);return}if(!t.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(n),this._convertTopLevelObjectsToArrays(n),sBe(e),this._convertObjectIdsToArrayIndices(n),this._updateObjects(n),this._updateMaterial(n)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const t in BU)this._convertTopLevelObjectToArray(e,t)}_convertTopLevelObjectToArray(e,t){const n=e[t];if(!(!n||Array.isArray(n))){e[t]=[];for(const i in n){const s=n[i];s.id=s.id||i;const a=e[t].length;e[t].push(s),this.idToIndexMap[t][i]=a}}}_convertObjectIdsToArrayIndices(e){for(const t in BU)this._convertIdsToIndices(e,t);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const t of e.textures)this._convertTextureIds(t);for(const t of e.meshes)this._convertMeshIds(t);for(const t of e.nodes)this._convertNodeIds(t);for(const t of e.scenes)this._convertSceneIds(t)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const t of e.primitives){const{attributes:n,indices:i,material:s}=t;for(const a in n)n[a]=this._convertIdToIndex(n[a],"accessor");i&&(t.indices=this._convertIdToIndex(i,"accessor")),s&&(t.material=this._convertIdToIndex(s,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(t=>this._convertIdToIndex(t,"node"))),e.meshes&&(e.meshes=e.meshes.map(t=>this._convertIdToIndex(t,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(t=>this._convertIdToIndex(t,"node")))}_convertIdsToIndices(e,t){e[t]||(console.warn(`gltf v1: json doesn't contain attribute ${t}`),e[t]=[]);for(const n of e[t])for(const i in n){const s=n[i],a=this._convertIdToIndex(s,i);n[i]=a}}_convertIdToIndex(e,t){const n=oBe[t];if(n in this.idToIndexMap){const i=this.idToIndexMap[n][e];if(!Number.isFinite(i))throw new Error(`gltf v1: failed to resolve ${t} with id ${e}`);return i}return e}_updateObjects(e){for(const t of this.json.buffers)delete t.type}_updateMaterial(e){for(const t of e.materials){t.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const n=t.values?.tex||t.values?.texture2d_0||t.values?.diffuseTex,i=e.textures.findIndex(s=>s.id===n);i!==-1&&(t.pbrMetallicRoughness.baseColorTexture={index:i})}}}function lBe(r,e={}){return new aBe().normalize(r,e)}async function cBe(r,e,t=0,n,i){return uBe(r,e,t,n),lBe(r,{normalize:n?.gltf?.normalize}),nBe(r,n,i),n?.gltf?.loadBuffers&&r.json.buffers&&await hBe(r,n,i),n?.gltf?.loadImages&&await dBe(r,n,i),await iBe(r,n,i),r}function uBe(r,e,t,n){if(n.uri&&(r.baseUri=n.uri),e instanceof ArrayBuffer&&!RPe(e,t,n)&&(e=new TextDecoder().decode(e)),typeof e=="string")r.json=xhe(e);else if(e instanceof ArrayBuffer){const a={};t=kPe(a,e,t,n.glb),$a(a.type==="glTF",`Invalid GLB magic string ${a.type}`),r._glb=a,r.json=a.json}else $a(!1,"GLTF: must be ArrayBuffer or string");const i=r.json.buffers||[];if(r.buffers=new Array(i.length).fill(null),r._glb&&r._glb.header.hasBinChunk){const{binChunks:a}=r._glb;r.buffers[0]={arrayBuffer:a[0].arrayBuffer,byteOffset:a[0].byteOffset,byteLength:a[0].byteLength}}const s=r.json.images||[];r.images=new Array(s.length).fill({})}async function hBe(r,e,t){const n=r.json.buffers||[];for(let i=0;i<n.length;++i){const s=n[i];if(s.uri){const{fetch:a}=t;$a(a);const o=AJ(s.uri,e),f=await(await t?.fetch?.(o))?.arrayBuffer?.();r.buffers[i]={arrayBuffer:f,byteOffset:0,byteLength:f.byteLength},delete s.uri}else r.buffers[i]===null&&(r.buffers[i]={arrayBuffer:new ArrayBuffer(s.byteLength),byteOffset:0,byteLength:s.byteLength})}}async function dBe(r,e,t){const n=fBe(r),i=r.json.images||[],s=[];for(const a of n)s.push(pBe(r,i[a],a,e,t));return await Promise.all(s)}function fBe(r){const e=new Set,t=r.json.textures||[];for(const n of t)n.source!==void 0&&e.add(n.source);return Array.from(e).sort()}async function pBe(r,e,t,n,i){let s;if(e.uri&&!e.hasOwnProperty("bufferView")){const o=AJ(e.uri,n),{fetch:u}=i;s=await(await u(o)).arrayBuffer(),e.bufferView={data:s}}if(Number.isFinite(e.bufferView)){const o=yIe(r.json,r.buffers,e.bufferView);s=Uk(o.buffer,o.byteOffset,o.byteLength)}$a(s,"glTF image has no data");let a=await Wv(s,[EC,DEe],{...n,mimeType:e.mimeType,basis:n.basis||{format:aJ()}},i);a&&a[0]&&(a={compressed:!0,mipmaps:!1,width:a[0].width,height:a[0].height,data:a[0]}),r.images=r.images||[],r.images[t]=a}const rv={dataType:null,batchType:null,name:"glTF",id:"gltf",module:"gltf",version:TPe,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:gBe,options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0},log:console}};async function gBe(r,e={},t){e={...rv.options,...e},e.gltf={...rv.options.gltf,...e.gltf};const{byteOffset:n=0}=e;return await cBe({},r,n,e,t)}const mBe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},yBe={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},ll={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},bBe={magFilter:ll.TEXTURE_MAG_FILTER,minFilter:ll.TEXTURE_MIN_FILTER,wrapS:ll.TEXTURE_WRAP_S,wrapT:ll.TEXTURE_WRAP_T},_Be={[ll.TEXTURE_MAG_FILTER]:ll.LINEAR,[ll.TEXTURE_MIN_FILTER]:ll.NEAREST_MIPMAP_LINEAR,[ll.TEXTURE_WRAP_S]:ll.REPEAT,[ll.TEXTURE_WRAP_T]:ll.REPEAT};function vBe(){return{id:"default-sampler",parameters:_Be}}function ABe(r){return yBe[r]}function xBe(r){return mBe[r]}class wBe{constructor(){H(this,"baseUri","");H(this,"jsonUnprocessed");H(this,"json");H(this,"buffers",[]);H(this,"images",[])}postProcess(e,t={}){const{json:n,buffers:i=[],images:s=[]}=e,{baseUri:a=""}=e;return $a(n),this.baseUri=a,this.buffers=i,this.images=s,this.jsonUnprocessed=n,this.json=this._resolveTree(e.json,t),this.json}_resolveTree(e,t={}){const n={...e};return this.json=n,e.bufferViews&&(n.bufferViews=e.bufferViews.map((i,s)=>this._resolveBufferView(i,s))),e.images&&(n.images=e.images.map((i,s)=>this._resolveImage(i,s))),e.samplers&&(n.samplers=e.samplers.map((i,s)=>this._resolveSampler(i,s))),e.textures&&(n.textures=e.textures.map((i,s)=>this._resolveTexture(i,s))),e.accessors&&(n.accessors=e.accessors.map((i,s)=>this._resolveAccessor(i,s))),e.materials&&(n.materials=e.materials.map((i,s)=>this._resolveMaterial(i,s))),e.meshes&&(n.meshes=e.meshes.map((i,s)=>this._resolveMesh(i,s))),e.nodes&&(n.nodes=e.nodes.map((i,s)=>this._resolveNode(i,s)),n.nodes=n.nodes.map((i,s)=>this._resolveNodeChildren(i))),e.skins&&(n.skins=e.skins.map((i,s)=>this._resolveSkin(i,s))),e.scenes&&(n.scenes=e.scenes.map((i,s)=>this._resolveScene(i,s))),typeof this.json.scene=="number"&&n.scenes&&(n.scene=n.scenes[this.json.scene]),n}getScene(e){return this._get(this.json.scenes,e)}getNode(e){return this._get(this.json.nodes,e)}getSkin(e){return this._get(this.json.skins,e)}getMesh(e){return this._get(this.json.meshes,e)}getMaterial(e){return this._get(this.json.materials,e)}getAccessor(e){return this._get(this.json.accessors,e)}getCamera(e){return this._get(this.json.cameras,e)}getTexture(e){return this._get(this.json.textures,e)}getSampler(e){return this._get(this.json.samplers,e)}getImage(e){return this._get(this.json.images,e)}getBufferView(e){return this._get(this.json.bufferViews,e)}getBuffer(e){return this._get(this.json.buffers,e)}_get(e,t){if(typeof t=="object")return t;const n=e&&e[t];return n||console.warn(`glTF file error: Could not find ${e}[${t}]`),n}_resolveScene(e,t){return{...e,id:e.id||`scene-${t}`,nodes:(e.nodes||[]).map(n=>this.getNode(n))}}_resolveNode(e,t){const n={...e,id:e?.id||`node-${t}`};return e.mesh!==void 0&&(n.mesh=this.getMesh(e.mesh)),e.camera!==void 0&&(n.camera=this.getCamera(e.camera)),e.skin!==void 0&&(n.skin=this.getSkin(e.skin)),e.meshes!==void 0&&e.meshes.length&&(n.mesh=e.meshes.reduce((i,s)=>{const a=this.getMesh(s);return i.id=a.id,i.primitives=i.primitives.concat(a.primitives),i},{primitives:[]})),n}_resolveNodeChildren(e){return e.children&&(e.children=e.children.map(t=>this.getNode(t))),e}_resolveSkin(e,t){const n=typeof e.inverseBindMatrices=="number"?this.getAccessor(e.inverseBindMatrices):void 0;return{...e,id:e.id||`skin-${t}`,inverseBindMatrices:n}}_resolveMesh(e,t){const n={...e,id:e.id||`mesh-${t}`,primitives:[]};return e.primitives&&(n.primitives=e.primitives.map(i=>{const s={...i,attributes:{},indices:void 0,material:void 0},a=i.attributes;for(const o in a)s.attributes[o]=this.getAccessor(a[o]);return i.indices!==void 0&&(s.indices=this.getAccessor(i.indices)),i.material!==void 0&&(s.material=this.getMaterial(i.material)),s})),n}_resolveMaterial(e,t){const n={...e,id:e.id||`material-${t}`};if(n.normalTexture&&(n.normalTexture={...n.normalTexture},n.normalTexture.texture=this.getTexture(n.normalTexture.index)),n.occlusionTexture&&(n.occlusionTexture={...n.occlusionTexture},n.occlusionTexture.texture=this.getTexture(n.occlusionTexture.index)),n.emissiveTexture&&(n.emissiveTexture={...n.emissiveTexture},n.emissiveTexture.texture=this.getTexture(n.emissiveTexture.index)),n.emissiveFactor||(n.emissiveFactor=n.emissiveTexture?[1,1,1]:[0,0,0]),n.pbrMetallicRoughness){n.pbrMetallicRoughness={...n.pbrMetallicRoughness};const i=n.pbrMetallicRoughness;i.baseColorTexture&&(i.baseColorTexture={...i.baseColorTexture},i.baseColorTexture.texture=this.getTexture(i.baseColorTexture.index)),i.metallicRoughnessTexture&&(i.metallicRoughnessTexture={...i.metallicRoughnessTexture},i.metallicRoughnessTexture.texture=this.getTexture(i.metallicRoughnessTexture.index))}return n}_resolveAccessor(e,t){const n=ABe(e.componentType),i=xBe(e.type),s=n*i,a={...e,id:e.id||`accessor-${t}`,bytesPerComponent:n,components:i,bytesPerElement:s,value:void 0,bufferView:void 0,sparse:void 0};if(e.bufferView!==void 0&&(a.bufferView=this.getBufferView(e.bufferView)),a.bufferView){const o=a.bufferView.buffer,{ArrayType:u,byteLength:f}=nD(a,a.bufferView),g=(a.bufferView.byteOffset||0)+(a.byteOffset||0)+o.byteOffset;let y=o.arrayBuffer.slice(g,g+f);a.bufferView.byteStride&&(y=this._getValueFromInterleavedBuffer(o,g,a.bufferView.byteStride,a.bytesPerElement,a.count)),a.value=new u(y)}return a}_getValueFromInterleavedBuffer(e,t,n,i,s){const a=new Uint8Array(s*i);for(let o=0;o<s;o++){const u=t+o*n;a.set(new Uint8Array(e.arrayBuffer.slice(u,u+i)),o*i)}return a.buffer}_resolveTexture(e,t){return{...e,id:e.id||`texture-${t}`,sampler:typeof e.sampler=="number"?this.getSampler(e.sampler):vBe(),source:typeof e.source=="number"?this.getImage(e.source):void 0}}_resolveSampler(e,t){const n={id:e.id||`sampler-${t}`,...e,parameters:{}};for(const i in n){const s=this._enumSamplerParameter(i);s!==void 0&&(n.parameters[s]=n[i])}return n}_enumSamplerParameter(e){return bBe[e]}_resolveImage(e,t){const n={...e,id:e.id||`image-${t}`,image:null,bufferView:e.bufferView!==void 0?this.getBufferView(e.bufferView):void 0},i=this.images[t];return i&&(n.image=i),n}_resolveBufferView(e,t){const n=e.buffer,i=this.buffers[n].arrayBuffer;let s=this.buffers[n].byteOffset||0;return e.byteOffset&&(s+=e.byteOffset),{id:`bufferView-${t}`,...e,buffer:this.buffers[n],data:new Uint8Array(i,s,e.byteLength)}}_resolveCamera(e,t){const n={...e,id:e.id||`camera-${t}`};return n.perspective,n.orthographic,n}}function lD(r,e){return new wBe().postProcess(r,e)}async function CBe(r){const e=[];return r.scenes.forEach(t=>{t.traverse(n=>{})}),await TBe(()=>e.some(t=>!t.loaded))}async function TBe(r){for(;r();)await new Promise(e=>requestAnimationFrame(e))}const MU=`uniform scenegraphUniforms {
  float sizeScale;
  float sizeMinPixels;
  float sizeMaxPixels;
  mat4 sceneModelMatrix;
  bool composeModelMatrix;
} scenegraph;
`,SBe={name:"scenegraph",vs:MU,fs:MU,uniformTypes:{sizeScale:"f32",sizeMinPixels:"f32",sizeMaxPixels:"f32",sceneModelMatrix:"mat4x4<f32>",composeModelMatrix:"f32"}},EBe=`#version 300 es
#define SHADER_NAME scenegraph-layer-vertex-shader
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec3 instanceModelMatrixCol0;
in vec3 instanceModelMatrixCol1;
in vec3 instanceModelMatrixCol2;
in vec3 instanceTranslation;
in vec3 positions;
#ifdef HAS_UV
in vec2 texCoords;
#endif
#ifdef LIGHTING_PBR
#ifdef HAS_NORMALS
in vec3 normals;
#endif
#endif
out vec4 vColor;
#ifndef LIGHTING_PBR
#ifdef HAS_UV
out vec2 vTEXCOORD_0;
#endif
#endif
void main(void) {
#if defined(HAS_UV) && !defined(LIGHTING_PBR)
vTEXCOORD_0 = texCoords;
geometry.uv = texCoords;
#endif
geometry.worldPosition = instancePositions;
geometry.pickingColor = instancePickingColors;
mat3 instanceModelMatrix = mat3(instanceModelMatrixCol0, instanceModelMatrixCol1, instanceModelMatrixCol2);
vec3 normal = vec3(0.0, 0.0, 1.0);
#ifdef LIGHTING_PBR
#ifdef HAS_NORMALS
normal = instanceModelMatrix * (scenegraph.sceneModelMatrix * vec4(normals, 0.0)).xyz;
#endif
#endif
float originalSize = project_size_to_pixel(scenegraph.sizeScale);
float clampedSize = clamp(originalSize, scenegraph.sizeMinPixels, scenegraph.sizeMaxPixels);
vec3 pos = (instanceModelMatrix * (scenegraph.sceneModelMatrix * vec4(positions, 1.0)).xyz) * scenegraph.sizeScale * (clampedSize / originalSize) + instanceTranslation;
if(scenegraph.composeModelMatrix) {
DECKGL_FILTER_SIZE(pos, geometry);
geometry.normal = project_normal(normal);
geometry.worldPosition += pos;
gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
}
else {
pos = project_size(pos);
DECKGL_FILTER_SIZE(pos, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);
geometry.normal = project_normal(normal);
}
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
#ifdef LIGHTING_PBR
pbr_vPosition = geometry.position.xyz;
#ifdef HAS_NORMALS
pbr_vNormal = geometry.normal;
#endif
#ifdef HAS_UV
pbr_vUV = texCoords;
#else
pbr_vUV = vec2(0., 0.);
#endif
geometry.uv = pbr_vUV;
#endif
vColor = instanceColors;
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,IBe=`#version 300 es
#define SHADER_NAME scenegraph-layer-fragment-shader
in vec4 vColor;
out vec4 fragColor;
#ifndef LIGHTING_PBR
#if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
in vec2 vTEXCOORD_0;
uniform sampler2D pbr_baseColorSampler;
#endif
#endif
void main(void) {
#ifdef LIGHTING_PBR
fragColor = vColor * pbr_filterColor(vec4(0));
geometry.uv = pbr_vUV;
#else
#if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
fragColor = vColor * texture(pbr_baseColorSampler, vTEXCOORD_0);
geometry.uv = vTEXCOORD_0;
#else
fragColor = vColor;
#endif
#endif
fragColor.a *= layer.opacity;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,IJ=[255,255,255,255],PBe={scenegraph:{type:"object",value:null,async:!0},getScene:r=>r&&r.scenes?typeof r.scene=="object"?r.scene:r.scenes[r.scene||0]:r,getAnimator:r=>r&&r.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:r=>r.position},getColor:{type:"accessor",value:IJ},_lighting:"flat",_imageBasedLightingEnvironment:void 0,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[rv]};class cD extends oo{getShaders(){const e={};let t;this.props._lighting==="pbr"?(t=mO,e.LIGHTING_PBR=1):t={name:"pbrMaterial"};const n=[$s,Ja,SBe,t];return super.getShaders({defines:e,vs:EBe,fs:IBe,modules:n})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:"unorm8",size:this.props.colorFormat.length,accessor:"getColor",defaultValue:IJ,transition:!0},instanceModelMatrix:iJ})}updateState(e){super.updateState(e);const{props:t,oldProps:n}=e;t.scenegraph!==n.scenegraph?this._updateScenegraph():t._animations!==n._animations&&this._applyAnimationsProp(this.state.animator,t._animations)}finalizeState(e){super.finalizeState(e),this.state.scenegraph?.destroy()}get isLoaded(){return!!(this.state?.scenegraph&&super.isLoaded)}_updateScenegraph(){const e=this.props,{device:t}=this.context;let n=null;if(e.scenegraph instanceof WC)n={scenes:[e.scenegraph]};else if(e.scenegraph&&typeof e.scenegraph=="object"){const o=e.scenegraph,u=o.json?lD(o):o,f=uIe(t,u,this._getModelOptions());n={gltf:u,...f},CBe(f).then(()=>{this.setNeedsRedraw()}).catch(g=>{this.raiseError(g,"loading glTF")})}const i={layer:this,device:this.context.device},s=e.getScene(n,i),a=e.getAnimator(n,i);if(s instanceof By){this.state.scenegraph?.destroy(),this._applyAnimationsProp(a,e._animations);const o=[];s.traverse(u=>{u instanceof CB&&o.push(u.model)}),this.setState({scenegraph:s,animator:a,models:o}),this.getAttributeManager().invalidateAll()}else s!==null&&Rr.warn("invalid scenegraph:",s)()}_applyAnimationsProp(e,t){if(!e||!t)return;const n=e.getAnimations();Object.keys(t).sort().forEach(i=>{const s=t[i];if(i==="*")n.forEach(a=>{Object.assign(a,s)});else if(Number.isFinite(Number(i))){const a=Number(i);a>=0&&a<n.length?Object.assign(n[a],s):Rr.warn(`animation ${i} not found`)()}else{const a=n.find(({animation:o})=>o.name===i);a?Object.assign(a,s):Rr.warn(`animation ${i} not found`)()}})}_getModelOptions(){const{_imageBasedLightingEnvironment:e}=this.props;let t;return e&&(typeof e=="function"?t=e({gl:this.context.gl,layer:this}):t=e),{imageBasedLightingEnvironment:t,modelOptions:{id:this.props.id,isInstanced:!0,bufferLayout:this.getAttributeManager().getBufferLayouts(),...this.getShaders()},useTangents:!1}}draw({context:e}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(e.timeline.getTime()),this.setNeedsRedraw());const{viewport:t,renderPass:n}=this.context,{sizeScale:i,sizeMinPixels:s,sizeMaxPixels:a,coordinateSystem:o}=this.props,u={camera:t.cameraPosition},f=this.getNumInstances();this.state.scenegraph.traverse((g,{worldMatrix:y})=>{if(g instanceof CB){const{model:A}=g;A.setInstanceCount(f);const C={sizeScale:i,sizeMinPixels:s,sizeMaxPixels:a,composeModelMatrix:sJ(t,o),sceneModelMatrix:y};A.shaderInputs.setProps({pbrProjection:u,scenegraph:C}),A.draw(n)}})}}cD.defaultProps=PBe;cD.layerName="ScenegraphLayer";const RU=`uniform meshUniforms {
  bool pickFeatureIds;
} mesh;
`,BBe={name:"mesh",vs:RU,fs:RU,uniformTypes:{pickFeatureIds:"f32"}},MBe=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec4 uvRegions;
in vec3 featureIdsPickingColors;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec3 instanceModelMatrixCol0;
in vec3 instanceModelMatrixCol1;
in vec3 instanceModelMatrixCol2;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;
vec2 applyUVRegion(vec2 uv) {
#ifdef HAS_UV_REGIONS
return fract(uv) * (uvRegions.zw - uvRegions.xy) + uvRegions.xy;
#else
return uv;
#endif
}
void main(void) {
vec2 uv = applyUVRegion(texCoords);
geometry.uv = uv;
if (mesh.pickFeatureIds) {
geometry.pickingColor = featureIdsPickingColors;
} else {
geometry.pickingColor = instancePickingColors;
}
mat3 instanceModelMatrix = mat3(instanceModelMatrixCol0, instanceModelMatrixCol1, instanceModelMatrixCol2);
vTexCoord = uv;
cameraPosition = project.cameraPosition;
vColor = vec4(colors * instanceColors.rgb, instanceColors.a);
vec3 pos = (instanceModelMatrix * positions) * simpleMesh.sizeScale;
vec3 projectedPosition = project_position(positions);
position_commonspace = vec4(projectedPosition, 1.0);
gl_Position = project_common_position_to_clipspace(position_commonspace);
geometry.position = position_commonspace;
normals_commonspace = project_normal(instanceModelMatrix * normals);
geometry.normal = normals_commonspace;
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
#ifdef MODULE_PBRMATERIAL
pbr_vPosition = geometry.position.xyz;
#ifdef HAS_NORMALS
pbr_vNormal = geometry.normal;
#endif
#ifdef HAS_UV
pbr_vUV = uv;
#else
pbr_vUV = vec2(0., 0.);
#endif
geometry.uv = pbr_vUV;
#endif
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,RBe=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs
precision highp float;
uniform sampler2D sampler;
in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;
out vec4 fragColor;
void main(void) {
#ifdef MODULE_PBRMATERIAL
fragColor = vColor * pbr_filterColor(vec4(0));
geometry.uv = pbr_vUV;
fragColor.a *= layer.opacity;
#else
geometry.uv = vTexCoord;
vec3 normal;
if (simpleMesh.flatShading) {
normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
} else {
normal = normals_commonspace;
}
vec4 color = simpleMesh.hasTexture ? texture(sampler, vTexCoord) : vColor;
vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
fragColor = vec4(lightColor, color.a * layer.opacity);
#endif
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;function kBe(r){const e=r.positions||r.POSITION,t=e.value.length/e.size;r.COLOR_0||r.colors||(r.colors={size:4,value:new Uint8Array(t*4).fill(255),normalized:!0})}const OBe={pbrMaterial:{type:"object",value:null},featureIds:{type:"array",value:null,optional:!0}};class uD extends ev{getShaders(){const e=super.getShaders();return e.modules.push(mO,BBe),{...e,vs:MBe,fs:RBe}}initializeState(){const{featureIds:e}=this.props;super.initializeState();const t=this.getAttributeManager();e&&t.add({featureIdsPickingColors:{type:"uint8",size:3,noAlloc:!0,update:this.calculateFeatureIdsPickingColors}})}updateState(e){super.updateState(e);const{props:t,oldProps:n}=e;t.pbrMaterial!==n.pbrMaterial&&this.updatePbrMaterialUniforms(t.pbrMaterial)}draw(e){const{featureIds:t}=this.props,{model:n}=this.state;if(!n)return;const i={pickFeatureIds:!!t},s={camera:this.context.viewport.cameraPosition};n.shaderInputs.setProps({pbrProjection:s,mesh:i}),super.draw(e)}getModel(e){const{id:t}=this.props,n=this.parseMaterial(this.props.pbrMaterial,e);this.setState({parsedPBRMaterial:n});const i=this.getShaders();return kBe(e.attributes),new Mi(this.context.device,{...this.getShaders(),id:t,geometry:e,bufferLayout:this.getAttributeManager().getBufferLayouts(),defines:{...i.defines,...n?.defines,HAS_UV_REGIONS:e.attributes.uvRegions?1:0},parameters:n?.parameters,isInstanced:!0})}updatePbrMaterialUniforms(e){const{model:t}=this.state;if(t){const{mesh:n}=this.props,i=this.parseMaterial(e,n);this.setState({parsedPBRMaterial:i});const{pbr_baseColorSampler:s}=i.bindings,{emptyTexture:a}=this.state,o={sampler:s||a,hasTexture:!!s},{camera:u,...f}={...i.bindings,...i.uniforms};t.shaderInputs.setProps({simpleMesh:o,pbrMaterial:f})}}parseMaterial(e,t){const n=!!(e.pbrMetallicRoughness&&e.pbrMetallicRoughness.baseColorTexture);return lJ(this.context.device,{unlit:n,...e},{NORMAL:t.attributes.normals,TEXCOORD_0:t.attributes.texCoords},{pbrDebug:!1,lights:!0,useTangents:!1})}calculateFeatureIdsPickingColors(e){const t=this.props.featureIds,n=new Uint8ClampedArray(t.length*e.size),i=[];for(let s=0;s<t.length;s++)this.encodePickingColor(t[s],i),n[s*3]=i[0],n[s*3+1]=i[1],n[s*3+2]=i[2];e.value=n}finalizeState(e){super.finalizeState(e),this.state.parsedPBRMaterial?.generatedTextures.forEach(t=>t.destroy()),this.setState({parsedPBRMaterial:null})}}uD.layerName="MeshLayer";uD.defaultProps=OBe;const DBe=6378137,LBe=6378137,NBe=6356752314245179e-9;function e2(r){return r}new rt;function FBe(r,e=[],t=e2){return"longitude"in r?(e[0]=t(r.longitude),e[1]=t(r.latitude),e[2]=r.height):"x"in r?(e[0]=t(r.x),e[1]=t(r.y),e[2]=r.z):(e[0]=t(r[0]),e[1]=t(r[1]),e[2]=r[2]),e}function UBe(r,e=[]){return FBe(r,e,Bs._cartographicRadians?e2:Xge)}function zBe(r,e,t=e2){return"longitude"in e?(e.longitude=t(r[0]),e.latitude=t(r[1]),e.height=r[2]):"x"in e?(e.x=t(r[0]),e.y=t(r[1]),e.z=r[2]):(e[0]=t(r[0]),e[1]=t(r[1]),e[2]=r[2]),e}function VBe(r,e){return zBe(r,e,Bs._cartographicRadians?e2:Jge)}const kU=1e-14,$Be=new rt,OU={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},yP={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},s0={east:new rt,north:new rt,up:new rt,west:new rt,south:new rt,down:new rt},jBe=new rt,GBe=new rt,HBe=new rt;function DU(r,e,t,n,i,s){const a=OU[e]&&OU[e][t];Hl(a&&(!n||n===a));let o,u,f;const g=$Be.copy(i);if(ml(g.x,0,kU)&&ml(g.y,0,kU)){const A=Math.sign(g.z);o=jBe.fromArray(yP[e]),e!=="east"&&e!=="west"&&o.scale(A),u=GBe.fromArray(yP[t]),t!=="east"&&t!=="west"&&u.scale(A),f=HBe.fromArray(yP[n]),n!=="east"&&n!=="west"&&f.scale(A)}else{const{up:A,east:C,north:M}=s0;C.set(-g.y,g.x,0).normalize(),r.geodeticSurfaceNormal(g,A),M.copy(A).cross(C);const{down:k,west:D,south:V}=s0;k.copy(A).scale(-1),D.copy(C).scale(-1),V.copy(M).scale(-1),o=s0[e],u=s0[t],f=s0[n]}return s[0]=o.x,s[1]=o.y,s[2]=o.z,s[3]=0,s[4]=u.x,s[5]=u.y,s[6]=u.z,s[7]=0,s[8]=f.x,s[9]=f.y,s[10]=f.z,s[11]=0,s[12]=g.x,s[13]=g.y,s[14]=g.z,s[15]=1,s}const Ug=new rt,WBe=new rt,KBe=new rt;function XBe(r,e,t=[]){const{oneOverRadii:n,oneOverRadiiSquared:i,centerToleranceSquared:s}=e;Ug.from(r);const a=Ug.x,o=Ug.y,u=Ug.z,f=n.x,g=n.y,y=n.z,A=a*a*f*f,C=o*o*g*g,M=u*u*y*y,k=A+C+M,D=Math.sqrt(1/k);if(!Number.isFinite(D))return;const V=WBe;if(V.copy(r).scale(D),k<s)return V.to(t);const W=i.x,z=i.y,$=i.z,te=KBe;te.set(V.x*W*2,V.y*z*2,V.z*$*2);let le=(1-D)*Ug.len()/(.5*te.len()),_e=0,se,Y,ce,oe;do{le-=_e,se=1/(1+le*W),Y=1/(1+le*z),ce=1/(1+le*$);const Me=se*se,ze=Y*Y,Ve=ce*ce,lt=Me*se,gt=ze*Y,At=Ve*ce;oe=A*Me+C*ze+M*Ve-1;const Ut=-2*(A*lt*W+C*gt*z+M*At*$);_e=oe/Ut}while(Math.abs(oe)>pye);return Ug.scale([se,Y,ce]).to(t)}const wx=new rt,LU=new rt,JBe=new rt,Dl=new rt,qBe=new rt,Cx=new rt;class ui{constructor(e=0,t=0,n=0){this.centerToleranceSquared=fye,Hl(e>=0),Hl(t>=0),Hl(n>=0),this.radii=new rt(e,t,n),this.radiiSquared=new rt(e*e,t*t,n*n),this.radiiToTheFourth=new rt(e*e*e*e,t*t*t*t,n*n*n*n),this.oneOverRadii=new rt(e===0?0:1/e,t===0?0:1/t,n===0?0:1/n),this.oneOverRadiiSquared=new rt(e===0?0:1/(e*e),t===0?0:1/(t*t),n===0?0:1/(n*n)),this.minimumRadius=Math.min(e,t,n),this.maximumRadius=Math.max(e,t,n),this.radiiSquared.z!==0&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}equals(e){return this===e||!!(e&&this.radii.equals(e.radii))}toString(){return this.radii.toString()}cartographicToCartesian(e,t=[0,0,0]){const n=LU,i=JBe,[,,s]=e;this.geodeticSurfaceNormalCartographic(e,n),i.copy(this.radiiSquared).scale(n);const a=Math.sqrt(n.dot(i));return i.scale(1/a),n.scale(s),i.add(n),i.to(t)}cartesianToCartographic(e,t=[0,0,0]){Cx.from(e);const n=this.scaleToGeodeticSurface(Cx,Dl);if(!n)return;const i=this.geodeticSurfaceNormal(n,LU),s=qBe;s.copy(Cx).subtract(n);const a=Math.atan2(i.y,i.x),o=Math.asin(i.z),u=Math.sign(uO(s,Cx))*nK(s);return VBe([a,o,u],t)}eastNorthUpToFixedFrame(e,t=new $r){return DU(this,"east","north","up",e,t)}localFrameToFixedFrame(e,t,n,i,s=new $r){return DU(this,e,t,n,i,s)}geocentricSurfaceNormal(e,t=[0,0,0]){return wx.from(e).normalize().to(t)}geodeticSurfaceNormalCartographic(e,t=[0,0,0]){const n=UBe(e),i=n[0],s=n[1],a=Math.cos(s);return wx.set(a*Math.cos(i),a*Math.sin(i),Math.sin(s)).normalize(),wx.to(t)}geodeticSurfaceNormal(e,t=[0,0,0]){return wx.from(e).scale(this.oneOverRadiiSquared).normalize().to(t)}scaleToGeodeticSurface(e,t){return XBe(e,this,t)}scaleToGeocentricSurface(e,t=[0,0,0]){Dl.from(e);const n=Dl.x,i=Dl.y,s=Dl.z,a=this.oneOverRadiiSquared,o=1/Math.sqrt(n*n*a.x+i*i*a.y+s*s*a.z);return Dl.multiplyScalar(o).to(t)}transformPositionToScaledSpace(e,t=[0,0,0]){return Dl.from(e).scale(this.oneOverRadii).to(t)}transformPositionFromScaledSpace(e,t=[0,0,0]){return Dl.from(e).scale(this.radii).to(t)}getSurfaceNormalIntersectionWithZAxis(e,t=0,n=[0,0,0]){Hl(ml(this.radii.x,this.radii.y,pK)),Hl(this.radii.z>0),Dl.from(e);const i=Dl.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(i)>=this.radii.z-t))return Dl.set(0,0,i).to(n)}}ui.WGS84=new ui(DBe,LBe,NBe);class YBe{constructor(e,t,n){H(this,"item");H(this,"previous");H(this,"next");this.item=e,this.previous=t,this.next=n}}class ZBe{constructor(){H(this,"head",null);H(this,"tail",null);H(this,"_length",0)}get length(){return this._length}add(e){const t=new YBe(e,this.tail,null);return this.tail?(this.tail.next=t,this.tail=t):(this.head=t,this.tail=t),++this._length,t}remove(e){e&&(e.previous&&e.next?(e.previous.next=e.next,e.next.previous=e.previous):e.previous?(e.previous.next=null,this.tail=e.previous):e.next?(e.next.previous=null,this.head=e.next):(this.head=null,this.tail=null),e.next=null,e.previous=null,--this._length)}splice(e,t){e!==t&&(this.remove(t),this._insert(e,t))}_insert(e,t){const n=e.next;e.next=t,this.tail===e?this.tail=t:n.previous=t,t.next=n,t.previous=e,++this._length}}class QBe{constructor(){H(this,"_list");H(this,"_sentinel");H(this,"_trimTiles");this._list=new ZBe,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}reset(){this._list.splice(this._list.tail,this._sentinel)}touch(e){const t=e._cacheNode;t&&this._list.splice(this._sentinel,t)}add(e,t,n){t._cacheNode||(t._cacheNode=this._list.add(t),n&&n(e,t))}unloadTile(e,t,n){const i=t._cacheNode;i&&(this._list.remove(i),t._cacheNode=null,n&&n(e,t))}unloadTiles(e,t){const n=this._trimTiles;this._trimTiles=!1;const i=this._list,s=e.maximumMemoryUsage*1024*1024,a=this._sentinel;let o=i.head;for(;o!==a&&(e.gpuMemoryUsageInBytes>s||n);){const u=o.item;o=o.next,this.unloadTile(e,u,t)}}trim(){this._trimTiles=!0}}function eMe(r,e){ci(r),ci(e);const{rtcCenter:t,gltfUpAxis:n}=e,{computedTransform:i,boundingVolume:{center:s}}=r;let a=new $r(i);switch(t&&a.translate(t),n){case"Z":break;case"Y":const y=new $r().rotateX(Math.PI/2);a=a.multiplyRight(y);break;case"X":const A=new $r().rotateY(-Math.PI/2);a=a.multiplyRight(A);break}e.isQuantized&&a.translate(e.quantizedVolumeOffset).scale(e.quantizedVolumeScale);const o=new rt(s);e.cartesianModelMatrix=a,e.cartesianOrigin=o;const u=ui.WGS84.cartesianToCartographic(o,new rt),g=ui.WGS84.eastNorthUpToFixedFrame(o).invert();e.cartographicModelMatrix=g.multiplyRight(a),e.cartographicOrigin=u,e.coordinateSystem||(e.modelMatrix=e.cartographicModelMatrix)}const NU=new rt,bP=new rt,ZB=new Va([new Vl,new Vl,new Vl,new Vl,new Vl,new Vl]);function tMe(r,e){const{cameraDirection:t,cameraUp:n,height:i}=r,{metersPerUnit:s}=r.distanceScales,a=Fw(r,r.center),o=ui.WGS84.eastNorthUpToFixedFrame(a),u=r.unprojectPosition(r.cameraPosition),f=ui.WGS84.cartographicToCartesian(u,new rt),g=new rt(o.transformAsVector(new rt(t).scale(s))).normalize(),y=new rt(o.transformAsVector(new rt(n).scale(s))).normalize();nMe(r);const A=r.constructor,{longitude:C,latitude:M,width:k,bearing:D,zoom:V}=r,W=new A({longitude:C,latitude:M,height:i,width:k,bearing:D,zoom:V,pitch:0});return{camera:{position:f,direction:g,up:y},viewport:r,topDownViewport:W,height:i,cullingVolume:ZB,frameNumber:e,sseDenominator:1.15}}function rMe(r,e,t){if(t===0||r.length<=t)return[r,[]];const n=[],{longitude:i,latitude:s}=e.viewport;for(const[f,g]of r.entries()){const[y,A]=g.header.mbs,C=Math.abs(i-y),M=Math.abs(s-A),k=Math.sqrt(M*M+C*C);n.push([f,k])}const a=n.sort((f,g)=>f[1]-g[1]),o=[];for(let f=0;f<t;f++)o.push(r[a[f][0]]);const u=[];for(let f=t;f<a.length;f++)u.push(r[a[f][0]]);return[o,u]}function nMe(r){const e=r.getFrustumPlanes(),t=FU(e.near,r.cameraPosition),n=Fw(r,t),i=Fw(r,r.cameraPosition,bP);let s=0;ZB.planes[s++].fromPointNormal(n,NU.copy(n).subtract(i));for(const a in e){if(a==="near")continue;const o=e[a],u=FU(o,t,bP),f=Fw(r,u,bP);ZB.planes[s++].fromPointNormal(f,NU.copy(n).subtract(f))}}function FU(r,e,t=new rt){const n=r.normal.dot(e);return t.copy(r.normal).scale(r.distance-n).add(e),t}function Fw(r,e,t=new rt){const n=r.unprojectPosition(e);return ui.WGS84.cartographicToCartesian(n,t)}const iMe=6378137,sMe=6378137,QB=6356752314245179e-9,wm=new rt;function oMe(r,e){if(r instanceof Qv){const{halfAxes:t}=r,n=lMe(t);return Math.log2(QB/(n+e[2]))}else if(r instanceof Zv){const{radius:t}=r;return Math.log2(QB/(t+e[2]))}else if(r.width&&r.height){const{width:t,height:n}=r,i=Math.log2(iMe/t),s=Math.log2(sMe/n);return(i+s)/2}return 1}function PJ(r,e,t){ui.WGS84.cartographicToCartesian([r.xmax,r.ymax,r.zmax],wm);const n=Math.sqrt(Math.pow(wm[0]-t[0],2)+Math.pow(wm[1]-t[1],2)+Math.pow(wm[2]-t[2],2));return Math.log2(QB/(n+e[2]))}function aMe(r,e,t){const[n,i,s,a]=r;return PJ({xmax:s,ymax:a,zmax:0},e,t)}function lMe(r){r.getColumn(0,wm);const e=r.getColumn(1),t=r.getColumn(2);return wm.add(e).add(t).len()}const Ma={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5};var ec;(function(r){r[r.ADD=1]="ADD",r[r.REPLACE=2]="REPLACE"})(ec||(ec={}));var Uu;(function(r){r.EMPTY="empty",r.SCENEGRAPH="scenegraph",r.POINTCLOUD="pointcloud",r.MESH="mesh"})(Uu||(Uu={}));var na;(function(r){r.I3S="I3S",r.TILES3D="TILES3D"})(na||(na={}));var hy;(function(r){r.GEOMETRIC_ERROR="geometricError",r.MAX_SCREEN_THRESHOLD="maxScreenThreshold"})(hy||(hy={}));const cMe={USE_OPTIMIZATION:1};function BJ(r){return r!=null}const vo=new rt,Uw=new rt,uMe=new rt,hMe=new rt,Cf=new rt,UU=new rt,zU=new rt,VU=new rt;function _P(r,e,t){if(ci(r,"3D Tile: boundingVolume must be defined"),r.box)return MJ(r.box,e,t);if(r.region)return pMe(r.region);if(r.sphere)return fMe(r.sphere,e,t);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function dMe(r,e){if(r.box)return gMe(e);if(r.region){const[t,n,i,s,a,o]=r.region;return[[zl(t),zl(n),a],[zl(i),zl(s),o]]}if(r.sphere)return mMe(e);throw new Error("Unkown boundingVolume type")}function MJ(r,e,t){const n=new rt(r[0],r[1],r[2]);e.transform(n,n);let i=[];if(r.length===10){const f=r.slice(3,6),g=new j_;g.fromArray(r,6);const y=new rt([1,0,0]),A=new rt([0,1,0]),C=new rt([0,0,1]);y.transformByQuaternion(g),y.scale(f[0]),A.transformByQuaternion(g),A.scale(f[1]),C.transformByQuaternion(g),C.scale(f[2]),i=[...y.toArray(),...A.toArray(),...C.toArray()]}else i=[...r.slice(3,6),...r.slice(6,9),...r.slice(9,12)];const s=e.transformAsVector(i.slice(0,3)),a=e.transformAsVector(i.slice(3,6)),o=e.transformAsVector(i.slice(6,9)),u=new Hi([s[0],s[1],s[2],a[0],a[1],a[2],o[0],o[1],o[2]]);return BJ(t)?(t.center=n,t.halfAxes=u,t):new Qv(n,u)}function fMe(r,e,t){const n=new rt(r[0],r[1],r[2]);e.transform(n,n);const i=e.getScale(Uw),s=Math.max(Math.max(i[0],i[1]),i[2]),a=r[3]*s;return BJ(t)?(t.center=n,t.radius=a,t):new Zv(n,a)}function pMe(r){const[e,t,n,i,s,a]=r,o=ui.WGS84.cartographicToCartesian([zl(e),zl(i),s],uMe),u=ui.WGS84.cartographicToCartesian([zl(n),zl(t),a],hMe),f=new rt().addVectors(o,u).multiplyByScalar(.5);return ui.WGS84.cartesianToCartographic(f,Cf),ui.WGS84.cartographicToCartesian([zl(n),Cf[1],Cf[2]],UU),ui.WGS84.cartographicToCartesian([Cf[0],zl(i),Cf[2]],zU),ui.WGS84.cartographicToCartesian([Cf[0],Cf[1],a],VU),MJ([...f,...UU.subtract(f),...zU.subtract(f),...VU.subtract(f)],new $r)}function gMe(r){const e=RJ(),{halfAxes:t}=r,n=new rt(t.getColumn(0)),i=new rt(t.getColumn(1)),s=new rt(t.getColumn(2));for(let a=0;a<2;a++){for(let o=0;o<2;o++){for(let u=0;u<2;u++)vo.copy(r.center),vo.add(n),vo.add(i),vo.add(s),kJ(e,vo),s.negate();i.negate()}n.negate()}return e}function mMe(r){const e=RJ(),{center:t,radius:n}=r,i=ui.WGS84.scaleToGeodeticSurface(t,vo);let s;i?s=ui.WGS84.geodeticSurfaceNormal(i):s=new rt(0,0,1);let a=new rt(s[2],-s[1],0);a.len()>0?a.normalize():a=new rt(0,1,0);const o=a.clone().cross(s);for(const u of[a,o,s]){Uw.copy(u).scale(n);for(let f=0;f<2;f++)vo.copy(t),vo.add(Uw),kJ(e,vo),Uw.negate()}return e}function RJ(){return[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]]}function kJ(r,e){ui.WGS84.cartesianToCartographic(e,vo),r[0][0]=Math.min(r[0][0],vo[0]),r[0][1]=Math.min(r[0][1],vo[1]),r[0][2]=Math.min(r[0][2],vo[2]),r[1][0]=Math.max(r[1][0],vo[0]),r[1][1]=Math.max(r[1][1],vo[1]),r[1][2]=Math.max(r[1][2],vo[2])}new rt;new rt;new $r;new rt;new rt;new rt;function yMe(r,e){const t=r*e;return 1-Math.exp(-(t*t))}function bMe(r,e){if(r.dynamicScreenSpaceError&&r.dynamicScreenSpaceErrorComputedDensity){const t=r.dynamicScreenSpaceErrorComputedDensity,n=r.dynamicScreenSpaceErrorFactor;return yMe(e,t)*n}return 0}function _Me(r,e,t){const n=r.tileset,i=r.parent&&r.parent.lodMetricValue||r.lodMetricValue,s=t?i:r.lodMetricValue;if(s===0)return 0;const a=Math.max(r._distanceToCamera,1e-7),{height:o,sseDenominator:u}=e,{viewDistanceScale:f}=n.options;let g=s*o*(f||1)/(a*u);return g-=bMe(n,a),g}const vP=new rt,$U=new rt,Gh=new rt,jU=new rt,vMe=new rt,AP=new $r,GU=new $r;function AMe(r,e){if(r.lodMetricValue===0||isNaN(r.lodMetricValue))return"DIG";const t=2*OJ(r,e);return t<2?"OUT":!r.header.children||t<=r.lodMetricValue?"DRAW":r.header.children?"DIG":"OUT"}function OJ(r,e){const{topDownViewport:t}=e,n=r.header.mbs[1],i=r.header.mbs[0],s=r.header.mbs[2],a=r.header.mbs[3],o=[...r.boundingVolume.center],u=t.unprojectPosition(t.cameraPosition);ui.WGS84.cartographicToCartesian(u,vP),$U.copy(vP).subtract(o).normalize(),ui.WGS84.eastNorthUpToFixedFrame(o,AP),GU.copy(AP).invert(),Gh.copy(vP).transform(GU);const f=Math.sqrt(Gh[0]*Gh[0]+Gh[1]*Gh[1]),g=f*f/Gh[2];jU.copy([Gh[0],Gh[1],g]);const A=jU.transform(AP).subtract(o).normalize(),M=$U.cross(A).normalize().scale(a).add(o),k=ui.WGS84.cartesianToCartographic(M),D=t.project([i,n,s]),V=t.project(k);return vMe.copy(D).subtract(V).magnitude()}function xMe(r){return{assetGltfUpAxis:r.asset&&r.asset.gltfUpAxis||"Y"}}class HU{constructor(e=0){H(this,"_map",new Map);H(this,"_array");H(this,"_length");this._array=new Array(e),this._length=e}get length(){return this._length}set length(e){this._length=e,e>this._array.length&&(this._array.length=e)}get values(){return this._array}get(e){return ci(e<this._array.length),this._array[e]}set(e,t){ci(e>=0),e>=this.length&&(this.length=e+1),this._map.has(this._array[e])&&this._map.delete(this._array[e]),this._array[e]=t,this._map.set(t,e)}delete(e){const t=this._map.get(e);t>=0&&(this._array.splice(t,1),this._map.delete(e),this.length--)}peek(){return this._array[this._length-1]}push(e){if(!this._map.has(e)){const t=this.length++;this._array[t]=e,this._map.set(e,t)}}pop(){const e=this._array[--this.length];return this._map.delete(e),e}reserve(e){ci(e>=0),e>this._array.length&&(this._array.length=e)}resize(e){ci(e>=0),this.length=e}trim(e){e==null&&(e=this.length),this._array.length=e}reset(){this._array=[],this._map=new Map,this._length=0}find(e){return this._map.has(e)}}const wMe={loadSiblings:!1,skipLevelOfDetail:!1,updateTransforms:!0,onTraversalEnd:()=>{},viewportTraversersMap:{},basePath:""};class t2{constructor(e){H(this,"options");H(this,"root",null);H(this,"selectedTiles",{});H(this,"requestedTiles",{});H(this,"emptyTiles",{});H(this,"lastUpdate",new Date().getTime());H(this,"updateDebounceTime",1e3);H(this,"_traversalStack",new HU);H(this,"_emptyTraversalStack",new HU);H(this,"_frameNumber",null);this.options={...wMe,...e}}traversalFinished(e){return!0}traverse(e,t,n){this.root=e,this.options={...this.options,...n},this.reset(),this.updateTile(e,t),this._frameNumber=t.frameNumber,this.executeTraversal(e,t)}reset(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}executeTraversal(e,t){const n=this._traversalStack;for(e._selectionDepth=1,n.push(e);n.length>0;){const s=n.pop();let a=!1;this.canTraverse(s,t)&&(this.updateChildTiles(s,t),a=this.updateAndPushChildren(s,t,n,s.hasRenderContent?s._selectionDepth+1:s._selectionDepth));const o=s.parent,u=!!(!o||o._shouldRefine),f=!a;s.hasRenderContent?s.refine===ec.ADD?(this.loadTile(s,t),this.selectTile(s,t)):s.refine===ec.REPLACE&&(this.loadTile(s,t),f&&this.selectTile(s,t)):(this.emptyTiles[s.id]=s,this.loadTile(s,t),f&&this.selectTile(s,t)),this.touchTile(s,t),s._shouldRefine=a&&u}const i=new Date().getTime();(this.traversalFinished(t)||i-this.lastUpdate>this.updateDebounceTime)&&(this.lastUpdate=i,this.options.onTraversalEnd(t))}updateChildTiles(e,t){const n=e.children;for(const i of n)this.updateTile(i,t)}updateAndPushChildren(e,t,n,i){const{loadSiblings:s,skipLevelOfDetail:a}=this.options,o=e.children;o.sort(this.compareDistanceToCamera.bind(this));const u=e.refine===ec.REPLACE&&e.hasRenderContent&&!a;let f=!1,g=!0;for(const y of o)if(y._selectionDepth=i,y.isVisibleAndInRequestVolume?(n.find(y)&&n.delete(y),n.push(y),f=!0):(u||s)&&(this.loadTile(y,t),this.touchTile(y,t)),u){let A;if(y._inRequestVolume?y.hasRenderContent?A=y.contentAvailable:A=this.executeEmptyTraversal(y,t):A=!1,g=g&&A,!g)return!1}return f||(g=!1),g}updateTile(e,t){this.updateTileVisibility(e,t)}selectTile(e,t){this.shouldSelectTile(e)&&(e._selectedFrame=t.frameNumber,this.selectedTiles[e.id]=e)}loadTile(e,t){this.shouldLoadTile(e)&&(e._requestedFrame=t.frameNumber,e._priority=e._getPriority(),this.requestedTiles[e.id]=e)}touchTile(e,t){e.tileset._cache.touch(e),e._touchedFrame=t.frameNumber}canTraverse(e,t){return e.hasChildren?e.hasTilesetContent?!e.contentExpired:this.shouldRefine(e,t):!1}shouldLoadTile(e){return e.hasUnloadedContent||e.contentExpired}shouldSelectTile(e){return e.contentAvailable&&!this.options.skipLevelOfDetail}shouldRefine(e,t,n=!1){let i=e._screenSpaceError;return n&&(i=e.getScreenSpaceError(t,!0)),i>e.tileset.memoryAdjustedScreenSpaceError}updateTileVisibility(e,t){const n=[];if(this.options.viewportTraversersMap)for(const i in this.options.viewportTraversersMap)this.options.viewportTraversersMap[i]===t.viewport.id&&n.push(i);else n.push(t.viewport.id);e.updateVisibility(t,n)}compareDistanceToCamera(e,t){return e._distanceToCamera-t._distanceToCamera}anyChildrenVisible(e,t){let n=!1;for(const i of e.children)i.updateVisibility(t),n=n||i.isVisibleAndInRequestVolume;return n}executeEmptyTraversal(e,t){let n=!0;const i=this._emptyTraversalStack;for(i.push(e);i.length>0;){const s=i.pop(),a=!s.hasRenderContent&&this.canTraverse(s,t),o=!s.hasRenderContent&&s.children.length===0;if(!a&&!s.contentAvailable&&!o&&(n=!1),this.updateTile(s,t),s.isVisibleAndInRequestVolume||(this.loadTile(s,t),this.touchTile(s,t)),a){const u=s.children;for(const f of u)i.push(f)}}return n}}const WU=new rt;function CMe(r){return r!=null}class eM{constructor(e,t,n,i=""){H(this,"tileset");H(this,"header");H(this,"id");H(this,"url");H(this,"parent");H(this,"refine");H(this,"type");H(this,"contentUrl");H(this,"lodMetricType","geometricError");H(this,"lodMetricValue",0);H(this,"boundingVolume",null);H(this,"content",null);H(this,"contentState",Ma.UNLOADED);H(this,"gpuMemoryUsageInBytes",0);H(this,"children",[]);H(this,"depth",0);H(this,"viewportIds",[]);H(this,"transform",new $r);H(this,"extensions",null);H(this,"implicitTiling",null);H(this,"userData",{});H(this,"computedTransform");H(this,"hasEmptyContent",!1);H(this,"hasTilesetContent",!1);H(this,"traverser",new t2({}));H(this,"_cacheNode",null);H(this,"_frameNumber",null);H(this,"_expireDate",null);H(this,"_expiredContent",null);H(this,"_boundingBox");H(this,"_distanceToCamera",0);H(this,"_screenSpaceError",0);H(this,"_visibilityPlaneMask");H(this,"_visible");H(this,"_contentBoundingVolume");H(this,"_viewerRequestVolume");H(this,"_initialTransform",new $r);H(this,"_priority",0);H(this,"_selectedFrame",0);H(this,"_requestedFrame",0);H(this,"_selectionDepth",0);H(this,"_touchedFrame",0);H(this,"_centerZDepth",0);H(this,"_shouldRefine",!1);H(this,"_stackLength",0);H(this,"_visitedFrame",0);H(this,"_inRequestVolume",!1);H(this,"_lodJudge",null);this.header=t,this.tileset=e,this.id=i||t.id,this.url=t.url,this.parent=n,this.refine=this._getRefine(t.refine),this.type=t.type,this.contentUrl=t.contentUrl,this._initializeLodMetric(t),this._initializeTransforms(t),this._initializeBoundingVolumes(t),this._initializeContent(t),this._initializeRenderingState(t),Object.seal(this)}destroy(){this.header=null}isDestroyed(){return this.header===null}get selected(){return this._selectedFrame===this.tileset._frameNumber}get isVisible(){return this._visible}get isVisibleAndInRequestVolume(){return this._visible&&this._inRequestVolume}get hasRenderContent(){return!this.hasEmptyContent&&!this.hasTilesetContent}get hasChildren(){return this.children.length>0||this.header.children&&this.header.children.length>0}get contentReady(){return this.contentState===Ma.READY||this.hasEmptyContent}get contentAvailable(){return!!(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}get hasUnloadedContent(){return this.hasRenderContent&&this.contentUnloaded}get contentUnloaded(){return this.contentState===Ma.UNLOADED}get contentExpired(){return this.contentState===Ma.EXPIRED}get contentFailed(){return this.contentState===Ma.FAILED}get distanceToCamera(){return this._distanceToCamera}get screenSpaceError(){return this._screenSpaceError}get boundingBox(){return this._boundingBox||(this._boundingBox=dMe(this.header.boundingVolume,this.boundingVolume)),this._boundingBox}getScreenSpaceError(e,t){switch(this.tileset.type){case na.I3S:return OJ(this,e);case na.TILES3D:return _Me(this,e,t);default:throw new Error("Unsupported tileset type")}}unselect(){this._selectedFrame=0}_getGpuMemoryUsageInBytes(){return this.content.gpuMemoryUsageInBytes||this.content.byteLength||0}_getPriority(){const e=this.tileset._traverser,{skipLevelOfDetail:t}=e.options,n=this.refine===ec.ADD||t;if(n&&!this.isVisible&&this._visible!==void 0||this.tileset._frameNumber-this._touchedFrame>=1||this.contentState===Ma.UNLOADED)return-1;const i=this.parent,a=i&&(!n||this._screenSpaceError===0||i.hasTilesetContent)?i._screenSpaceError:this._screenSpaceError,o=e.root?e.root._screenSpaceError:0;return Math.max(o-a,0)}async loadContent(){if(this.hasEmptyContent)return!1;if(this.content)return!0;this.contentExpired&&(this._expireDate=null),this.contentState=Ma.LOADING;const t=await this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority.bind(this));if(!t)return this.contentState=Ma.UNLOADED,!1;try{const n=this.tileset.getTileUrl(this.contentUrl),i=this.tileset.loader,s={...this.tileset.loadOptions,[i.id]:{...this.tileset.loadOptions[i.id],isTileset:this.type==="json",...this._getLoaderSpecificOptions(i.id)}};return this.content=await Yu(n,i,s),this.tileset.options.contentLoader&&await this.tileset.options.contentLoader(this),this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this),this.contentState=Ma.READY,this._onContentLoaded(),!0}catch(n){throw this.contentState=Ma.FAILED,n}finally{t.done()}}unloadContent(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=Ma.UNLOADED,!0}updateVisibility(e,t){if(this._frameNumber===e.frameNumber)return;const n=this.parent,i=n?n._visibilityPlaneMask:Va.MASK_INDETERMINATE;if(this.tileset._traverser.options.updateTransforms){const s=n?n.computedTransform:this.tileset.modelMatrix;this._updateTransform(s)}this._distanceToCamera=this.distanceToTile(e),this._screenSpaceError=this.getScreenSpaceError(e,!1),this._visibilityPlaneMask=this.visibility(e,i),this._visible=this._visibilityPlaneMask!==Va.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(e),this._frameNumber=e.frameNumber,this.viewportIds=t}visibility(e,t){const{cullingVolume:n}=e,{boundingVolume:i}=this;return n.computeVisibilityWithPlaneMask(i,t)}contentVisibility(){return!0}distanceToTile(e){const t=this.boundingVolume;return Math.sqrt(Math.max(t.distanceSquaredTo(e.camera.position),0))}cameraSpaceZDepth({camera:e}){const t=this.boundingVolume;return WU.subVectors(t.center,e.position),e.direction.dot(WU)}insideViewerRequestVolume(e){const t=this._viewerRequestVolume;return!t||t.distanceSquaredTo(e.camera.position)<=0}updateExpiration(){if(CMe(this._expireDate)&&this.contentReady&&!this.hasEmptyContent){const e=Date.now();Date.lessThan(this._expireDate,e)&&(this.contentState=Ma.EXPIRED,this._expiredContent=this.content)}}get extras(){return this.header.extras}_initializeLodMetric(e){"lodMetricType"in e?this.lodMetricType=e.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in e?this.lodMetricValue=e.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))}_initializeTransforms(e){this.transform=e.transform?new $r(e.transform):new $r;const t=this.parent,n=this.tileset,i=t&&t.computedTransform?t.computedTransform.clone():n.modelMatrix.clone();this.computedTransform=new $r(i).multiplyRight(this.transform);const s=t&&t._initialTransform?t._initialTransform.clone():new $r;this._initialTransform=new $r(s).multiplyRight(this.transform)}_initializeBoundingVolumes(e){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(e)}_initializeContent(e){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=Ma.UNLOADED,this.hasTilesetContent=!1,e.contentUrl&&(this.content=null,this.hasEmptyContent=!1)}_initializeRenderingState(e){this.depth=e.level||(this.parent?this.parent.depth+1:0),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=Va.MASK_INDETERMINATE,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0}_getRefine(e){return e||this.parent&&this.parent.refine||ec.REPLACE}_isTileset(){return this.contentUrl.indexOf(".json")!==-1}_onContentLoaded(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset._traverser.disableSkipLevelOfDetail=!0;break}this._isTileset()?this.hasTilesetContent=!0:this.gpuMemoryUsageInBytes=this._getGpuMemoryUsageInBytes()}_updateBoundingVolume(e){this.boundingVolume=_P(e.boundingVolume,this.computedTransform,this.boundingVolume);const t=e.content;t&&(t.boundingVolume&&(this._contentBoundingVolume=_P(t.boundingVolume,this.computedTransform,this._contentBoundingVolume)),e.viewerRequestVolume&&(this._viewerRequestVolume=_P(e.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))}_updateTransform(e=new $r){const t=e.clone().multiplyRight(this.transform);t.equals(this.computedTransform)||(this.computedTransform=t,this._updateBoundingVolume(this.header))}_getLoaderSpecificOptions(e){switch(e){case"i3s":return{...this.tileset.options.i3s,_tileOptions:{attributeUrls:this.header.attributeUrls,textureUrl:this.header.textureUrl,textureFormat:this.header.textureFormat,textureLoaderOptions:this.header.textureLoaderOptions,materialDefinition:this.header.materialDefinition,isDracoGeometry:this.header.isDracoGeometry,mbs:this.header.mbs},_tilesetOptions:{store:this.tileset.tileset.store,attributeStorageInfo:this.tileset.tileset.attributeStorageInfo,fields:this.tileset.tileset.fields},isTileHeader:!1};case"3d-tiles":case"cesium-ion":default:return xMe(this.tileset.tileset)}}}class TMe extends t2{compareDistanceToCamera(e,t){return t._distanceToCamera===0&&e._distanceToCamera===0?t._centerZDepth-e._centerZDepth:t._distanceToCamera-e._distanceToCamera}updateTileVisibility(e,t){if(super.updateTileVisibility(e,t),!e.isVisibleAndInRequestVolume)return;const n=e.children.length>0;if(e.hasTilesetContent&&n){const a=e.children[0];this.updateTileVisibility(a,t),e._visible=a._visible;return}if(this.meetsScreenSpaceErrorEarly(e,t)){e._visible=!1;return}const i=e.refine===ec.REPLACE,s=e._optimChildrenWithinParent===cMe.USE_OPTIMIZATION;if(i&&s&&n&&!this.anyChildrenVisible(e,t)){e._visible=!1;return}}meetsScreenSpaceErrorEarly(e,t){const{parent:n}=e;return!n||n.hasTilesetContent||n.refine!==ec.ADD?!1:!this.shouldRefine(e,t,!0)}}class SMe{constructor(){H(this,"frameNumberMap",new Map)}register(e,t){const n=this.frameNumberMap.get(e)||new Map,i=n.get(t)||0;n.set(t,i+1),this.frameNumberMap.set(e,n)}deregister(e,t){const n=this.frameNumberMap.get(e);if(!n)return;const i=n.get(t)||1;n.set(t,i-1)}isZero(e,t){return(this.frameNumberMap.get(e)?.get(t)||0)===0}}const xP={REQUESTED:"REQUESTED",COMPLETED:"COMPLETED",ERROR:"ERROR"};class EMe{constructor(){H(this,"_statusMap");H(this,"pendingTilesRegister",new SMe);this._statusMap={}}add(e,t,n,i){if(!this._statusMap[t]){const{frameNumber:s,viewport:{id:a}}=i;this._statusMap[t]={request:e,callback:n,key:t,frameState:i,status:xP.REQUESTED},this.pendingTilesRegister.register(a,s),e().then(o=>{this._statusMap[t].status=xP.COMPLETED;const{frameNumber:u,viewport:{id:f}}=this._statusMap[t].frameState;this.pendingTilesRegister.deregister(f,u),this._statusMap[t].callback(o,i)}).catch(o=>{this._statusMap[t].status=xP.ERROR;const{frameNumber:u,viewport:{id:f}}=this._statusMap[t].frameState;this.pendingTilesRegister.deregister(f,u),n(o)})}}update(e,t){if(this._statusMap[e]){const{frameNumber:n,viewport:{id:i}}=this._statusMap[e].frameState;this.pendingTilesRegister.deregister(i,n);const{frameNumber:s,viewport:{id:a}}=t;this.pendingTilesRegister.register(a,s),this._statusMap[e].frameState=t}}find(e){return this._statusMap[e]}hasPendingTiles(e,t){return!this.pendingTilesRegister.isZero(e,t)}}class IMe extends t2{constructor(t){super(t);H(this,"_tileManager");this._tileManager=new EMe}traversalFinished(t){return!this._tileManager.hasPendingTiles(t.viewport.id,this._frameNumber||0)}shouldRefine(t,n){return t._lodJudge=AMe(t,n),t._lodJudge==="DIG"}updateChildTiles(t,n){const i=t.header.children||[],s=t.children,a=t.tileset;for(const o of i){const u=`${o.id}-${n.viewport.id}`,f=s&&s.find(g=>g.id===u);if(f)f&&this.updateTile(f,n);else{let g=()=>this._loadTile(o.id,a);this._tileManager.find(u)?this._tileManager.update(u,n):(a.tileset.nodePages&&(g=()=>a.tileset.nodePagesTile.formTileFromNodePages(o.id)),this._tileManager.add(g,u,A=>this._onTileLoad(A,t,u),n))}}return!1}async _loadTile(t,n){const{loader:i}=n,s=n.getTileUrl(`${n.url}/nodes/${t}`),a={...n.loadOptions,i3s:{...n.loadOptions.i3s,isTileHeader:!0}};return await Yu(s,i,a)}_onTileLoad(t,n,i){const s=new eM(n.tileset,t,n,i);n.children.push(s);const a=this._tileManager.find(s.id).frameState;this.updateTile(s,a),this._frameNumber===a.frameNumber&&(this.traversalFinished(a)||new Date().getTime()-this.lastUpdate>this.updateDebounceTime)&&this.executeTraversal(s,a)}}const PMe={description:"",ellipsoid:ui.WGS84,modelMatrix:new $r,throttleRequests:!0,maxRequests:64,maximumMemoryUsage:32,memoryCacheOverflow:1,maximumTilesSelected:0,debounceTime:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{},onTraversalComplete:r=>r,contentLoader:void 0,viewDistanceScale:1,maximumScreenSpaceError:8,memoryAdjustedScreenSpaceError:!1,loadTiles:!0,updateTransforms:!0,viewportTraversersMap:null,loadOptions:{fetch:{}},attributions:[],basePath:"",i3s:{}},Tx="Tiles In Tileset(s)",wP="Tiles In Memory",KU="Tiles In View",XU="Tiles To Render",JU="Tiles Loaded",CP="Tiles Loading",qU="Tiles Unloaded",YU="Failed Tile Loads",ZU="Points/Vertices",TP="Tile Memory Use",QU="Maximum Screen Space Error";class BMe{constructor(e,t){H(this,"options");H(this,"loadOptions");H(this,"type");H(this,"tileset");H(this,"loader");H(this,"url");H(this,"basePath");H(this,"modelMatrix");H(this,"ellipsoid");H(this,"lodMetricType");H(this,"lodMetricValue");H(this,"refine");H(this,"root",null);H(this,"roots",{});H(this,"asset",{});H(this,"description","");H(this,"properties");H(this,"extras",null);H(this,"attributions",{});H(this,"credits",{});H(this,"stats");H(this,"contentFormats",{draco:!1,meshopt:!1,dds:!1,ktx2:!1});H(this,"cartographicCenter",null);H(this,"cartesianCenter",null);H(this,"zoom",1);H(this,"boundingVolume",null);H(this,"dynamicScreenSpaceErrorComputedDensity",0);H(this,"maximumMemoryUsage",32);H(this,"gpuMemoryUsageInBytes",0);H(this,"memoryAdjustedScreenSpaceError",0);H(this,"_cacheBytes",0);H(this,"_cacheOverflowBytes",0);H(this,"_frameNumber",0);H(this,"_queryParams",{});H(this,"_extensionsUsed",[]);H(this,"_tiles",{});H(this,"_pendingCount",0);H(this,"selectedTiles",[]);H(this,"traverseCounter",0);H(this,"geometricError",0);H(this,"lastUpdatedVieports",null);H(this,"_requestedTiles",[]);H(this,"_emptyTiles",[]);H(this,"frameStateData",{});H(this,"_traverser");H(this,"_cache",new QBe);H(this,"_requestScheduler");H(this,"updatePromise",null);H(this,"tilesetInitializationPromise");this.options={...PMe,...t},this.tileset=e,this.loader=e.loader,this.type=e.type,this.url=e.url,this.basePath=e.basePath||zk(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=e.lodMetricType,this.lodMetricValue=e.lodMetricValue,this.refine=e.root.refine,this.loadOptions=this.options.loadOptions||{},this._traverser=this._initializeTraverser(),this._requestScheduler=new GH({throttleRequests:this.options.throttleRequests,maxRequests:this.options.maxRequests}),this.memoryAdjustedScreenSpaceError=this.options.maximumScreenSpaceError,this._cacheBytes=this.options.maximumMemoryUsage*1024*1024,this._cacheOverflowBytes=this.options.memoryCacheOverflow*1024*1024,this.stats=new Iy({id:this.url}),this._initializeStats(),this.tilesetInitializationPromise=this._initializeTileSet(e)}destroy(){this._destroy()}isLoaded(){return this._pendingCount===0&&this._frameNumber!==0&&this._requestedTiles.length===0}get tiles(){return Object.values(this._tiles)}get frameNumber(){return this._frameNumber}get queryParams(){return new URLSearchParams(this._queryParams).toString()}setProps(e){this.options={...this.options,...e}}getTileUrl(e){if(e.startsWith("data:"))return e;let n=e;return this.queryParams.length&&(n=`${e}${e.includes("?")?"&":"?"}${this.queryParams}`),n}hasExtension(e){return this._extensionsUsed.indexOf(e)>-1}update(e=null){this.tilesetInitializationPromise.then(()=>{!e&&this.lastUpdatedVieports?e=this.lastUpdatedVieports:this.lastUpdatedVieports=e,e&&this.doUpdate(e)})}async selectTiles(e=null){return await this.tilesetInitializationPromise,e&&(this.lastUpdatedVieports=e),this.updatePromise||(this.updatePromise=new Promise(t=>{setTimeout(()=>{this.lastUpdatedVieports&&this.doUpdate(this.lastUpdatedVieports),t(this._frameNumber),this.updatePromise=null},this.options.debounceTime)})),this.updatePromise}adjustScreenSpaceError(){this.gpuMemoryUsageInBytes<this._cacheBytes?this.memoryAdjustedScreenSpaceError=Math.max(this.memoryAdjustedScreenSpaceError/1.02,this.options.maximumScreenSpaceError):this.gpuMemoryUsageInBytes>this._cacheBytes+this._cacheOverflowBytes&&(this.memoryAdjustedScreenSpaceError*=1.02)}doUpdate(e){if("loadTiles"in this.options&&!this.options.loadTiles||this.traverseCounter>0)return;const t=e instanceof Array?e:[e];this._cache.reset(),this._frameNumber++,this.traverseCounter=t.length;const n=[];for(const i of t){const s=i.id;this._needTraverse(s)?n.push(s):this.traverseCounter--}for(const i of t){const s=i.id;if(this.roots[s]||(this.roots[s]=this._initializeTileHeaders(this.tileset,null)),!n.includes(s))continue;const a=tMe(i,this._frameNumber);this._traverser.traverse(this.roots[s],a,this.options)}}_needTraverse(e){let t=e;return this.options.viewportTraversersMap&&(t=this.options.viewportTraversersMap[e]),t===e}_onTraversalEnd(e){const t=e.viewport.id;this.frameStateData[t]||(this.frameStateData[t]={selectedTiles:[],_requestedTiles:[],_emptyTiles:[]});const n=this.frameStateData[t],i=Object.values(this._traverser.selectedTiles),[s,a]=rMe(i,e,this.options.maximumTilesSelected);n.selectedTiles=s;for(const o of a)o.unselect();n._requestedTiles=Object.values(this._traverser.requestedTiles),n._emptyTiles=Object.values(this._traverser.emptyTiles),this.traverseCounter--,!(this.traverseCounter>0)&&this._updateTiles()}_updateTiles(){this.selectedTiles=[],this._requestedTiles=[],this._emptyTiles=[];for(const e in this.frameStateData){const t=this.frameStateData[e];this.selectedTiles=this.selectedTiles.concat(t.selectedTiles),this._requestedTiles=this._requestedTiles.concat(t._requestedTiles),this._emptyTiles=this._emptyTiles.concat(t._emptyTiles)}this.selectedTiles=this.options.onTraversalComplete(this.selectedTiles);for(const e of this.selectedTiles)this._tiles[e.id]=e;this._loadTiles(),this._unloadTiles(),this._updateStats()}_tilesChanged(e,t){if(e.length!==t.length)return!0;const n=new Set(e.map(a=>a.id)),i=new Set(t.map(a=>a.id));let s=e.filter(a=>!i.has(a.id)).length>0;return s=s||t.filter(a=>!n.has(a.id)).length>0,s}_loadTiles(){for(const e of this._requestedTiles)e.contentUnloaded&&this._loadTile(e)}_unloadTiles(){this._cache.unloadTiles(this,(e,t)=>e._unloadTile(t))}_updateStats(){let e=0,t=0;for(const n of this.selectedTiles)n.contentAvailable&&n.content&&(e++,n.content.pointCount?t+=n.content.pointCount:t+=n.content.vertexCount);this.stats.get(KU).count=this.selectedTiles.length,this.stats.get(XU).count=e,this.stats.get(ZU).count=t,this.stats.get(QU).count=this.memoryAdjustedScreenSpaceError}async _initializeTileSet(e){this.type===na.I3S&&(this.calculateViewPropsI3S(),e.root=await e.root),this.root=this._initializeTileHeaders(e,null),this.type===na.TILES3D&&(this._initializeTiles3DTileset(e),this.calculateViewPropsTiles3D()),this.type===na.I3S&&this._initializeI3STileset()}calculateViewPropsI3S(){const e=this.tileset.fullExtent;if(e){const{xmin:n,xmax:i,ymin:s,ymax:a,zmin:o,zmax:u}=e;this.cartographicCenter=new rt(n+(i-n)/2,s+(a-s)/2,o+(u-o)/2),this.cartesianCenter=new rt,ui.WGS84.cartographicToCartesian(this.cartographicCenter,this.cartesianCenter),this.zoom=PJ(e,this.cartographicCenter,this.cartesianCenter);return}const t=this.tileset.store?.extent;if(t){const[n,i,s,a]=t;this.cartographicCenter=new rt(n+(s-n)/2,i+(a-i)/2,0),this.cartesianCenter=new rt,ui.WGS84.cartographicToCartesian(this.cartographicCenter,this.cartesianCenter),this.zoom=aMe(t,this.cartographicCenter,this.cartesianCenter);return}console.warn("Extent is not defined in the tileset header"),this.cartographicCenter=new rt,this.zoom=1}calculateViewPropsTiles3D(){const e=this.root,{center:t}=e.boundingVolume;if(!t){console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new rt,this.zoom=1;return}t[0]!==0||t[1]!==0||t[2]!==0?(this.cartographicCenter=new rt,ui.WGS84.cartesianToCartographic(t,this.cartographicCenter)):this.cartographicCenter=new rt(0,0,-ui.WGS84.radii[0]),this.cartesianCenter=t,this.zoom=oMe(e.boundingVolume,this.cartographicCenter)}_initializeStats(){this.stats.get(Tx),this.stats.get(CP),this.stats.get(wP),this.stats.get(KU),this.stats.get(XU),this.stats.get(JU),this.stats.get(qU),this.stats.get(YU),this.stats.get(ZU),this.stats.get(TP,"memory"),this.stats.get(QU)}_initializeTileHeaders(e,t){const n=new eM(this,e.root,t);if(t&&(t.children.push(n),n.depth=t.depth+1),this.type===na.TILES3D){const i=[];for(i.push(n);i.length>0;){const s=i.pop();this.stats.get(Tx).incrementCount();const a=s.header.children||[];for(const o of a){const u=new eM(this,o,s);if(u.contentUrl?.includes("?session=")){const g=new URL(u.contentUrl).searchParams.get("session");g&&(this._queryParams.session=g)}s.children.push(u),u.depth=s.depth+1,i.push(u)}}}return n}_initializeTraverser(){let e;switch(this.type){case na.TILES3D:e=TMe;break;case na.I3S:e=IMe;break;default:e=t2}return new e({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})}_destroyTileHeaders(e){this._destroySubtree(e)}async _loadTile(e){let t;try{this._onStartTileLoading(),t=await e.loadContent()}catch(n){this._onTileLoadError(e,n instanceof Error?n:new Error("load failed"))}finally{this._onEndTileLoading(),this._onTileLoad(e,t)}}_onTileLoadError(e,t){this.stats.get(YU).incrementCount();const n=t.message||t.toString(),i=e.url;console.error(`A 3D tile failed to load: ${e.url} ${n}`),this.options.onTileError(e,n,i)}_onTileLoad(e,t){if(t){if(this.type===na.I3S){const n=this.tileset?.nodePagesTile?.nodesInNodePages||0;this.stats.get(Tx).reset(),this.stats.get(Tx).addCount(n)}e&&e.content&&eMe(e,e.content),this.updateContentTypes(e),this._addTileToCache(e),this.options.onTileLoad(e)}}updateContentTypes(e){if(this.type===na.I3S)switch(e.header.isDracoGeometry&&(this.contentFormats.draco=!0),e.header.textureFormat){case"dds":this.contentFormats.dds=!0;break;case"ktx2":this.contentFormats.ktx2=!0;break}else if(this.type===na.TILES3D){const{extensionsRemoved:t=[]}=e.content?.gltf||{};t.includes("KHR_draco_mesh_compression")&&(this.contentFormats.draco=!0),t.includes("EXT_meshopt_compression")&&(this.contentFormats.meshopt=!0),t.includes("KHR_texture_basisu")&&(this.contentFormats.ktx2=!0)}}_onStartTileLoading(){this._pendingCount++,this.stats.get(CP).incrementCount()}_onEndTileLoading(){this._pendingCount--,this.stats.get(CP).decrementCount()}_addTileToCache(e){this._cache.add(this,e,t=>t._updateCacheStats(e))}_updateCacheStats(e){this.stats.get(JU).incrementCount(),this.stats.get(wP).incrementCount(),this.gpuMemoryUsageInBytes+=e.gpuMemoryUsageInBytes||0,this.stats.get(TP).count=this.gpuMemoryUsageInBytes,this.options.memoryAdjustedScreenSpaceError&&this.adjustScreenSpaceError()}_unloadTile(e){this.gpuMemoryUsageInBytes-=e.gpuMemoryUsageInBytes||0,this.stats.get(wP).decrementCount(),this.stats.get(qU).incrementCount(),this.stats.get(TP).count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(e),e.unloadContent()}_destroy(){const e=[];for(this.root&&e.push(this.root);e.length>0;){const t=e.pop();for(const n of t.children)e.push(n);this._destroyTile(t)}this.root=null}_destroySubtree(e){const t=e,n=[];for(n.push(t);n.length>0;){e=n.pop();for(const i of e.children)n.push(i);e!==t&&this._destroyTile(e)}t.children=[]}_destroyTile(e){this._cache.unloadTile(this,e),this._unloadTile(e),e.destroy()}_initializeTiles3DTileset(e){if(e.queryString){const t=new URLSearchParams(e.queryString),n=Object.fromEntries(t.entries());this._queryParams={...this._queryParams,...n}}if(this.asset=e.asset,!this.asset)throw new Error("Tileset must have an asset property.");if(this.asset.version!=="0.0"&&this.asset.version!=="1.0"&&this.asset.version!=="1.1")throw new Error("The tileset must be 3D Tiles version either 0.0 or 1.0 or 1.1.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description||"",this.properties=e.properties,this.geometricError=e.geometricError,this._extensionsUsed=e.extensionsUsed||[],this.extras=e.extras}_initializeI3STileset(){this.loadOptions.i3s&&"token"in this.loadOptions.i3s&&(this._queryParams.token=this.loadOptions.i3s.token)}}const DJ="4.3.3",o0={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GLTF:"glTF"};function LJ(r,e,t){ci(r instanceof ArrayBuffer);const n=new TextDecoder("utf8"),i=new Uint8Array(r,e,t);return n.decode(i)}function MMe(r,e=0){const t=new DataView(r);return`${String.fromCharCode(t.getUint8(e+0))}${String.fromCharCode(t.getUint8(e+1))}${String.fromCharCode(t.getUint8(e+2))}${String.fromCharCode(t.getUint8(e+3))}`}const RMe={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},bs={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},vn={...RMe,...bs},SP={[bs.DOUBLE]:Float64Array,[bs.FLOAT]:Float32Array,[bs.UNSIGNED_SHORT]:Uint16Array,[bs.UNSIGNED_INT]:Uint32Array,[bs.UNSIGNED_BYTE]:Uint8Array,[bs.BYTE]:Int8Array,[bs.SHORT]:Int16Array,[bs.INT]:Int32Array},kMe={DOUBLE:bs.DOUBLE,FLOAT:bs.FLOAT,UNSIGNED_SHORT:bs.UNSIGNED_SHORT,UNSIGNED_INT:bs.UNSIGNED_INT,UNSIGNED_BYTE:bs.UNSIGNED_BYTE,BYTE:bs.BYTE,SHORT:bs.SHORT,INT:bs.INT},EP="Failed to convert GL type";class $c{static fromTypedArray(e){e=ArrayBuffer.isView(e)?e.constructor:e;for(const t in SP)if(SP[t]===e)return t;throw new Error(EP)}static fromName(e){const t=kMe[e];if(!t)throw new Error(EP);return t}static getArrayType(e){switch(e){case bs.UNSIGNED_SHORT_5_6_5:case bs.UNSIGNED_SHORT_4_4_4_4:case bs.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:const t=SP[e];if(!t)throw new Error(EP);return t}}static getByteSize(e){return $c.getArrayType(e).BYTES_PER_ELEMENT}static validate(e){return!!$c.getArrayType(e)}static createTypedArray(e,t,n=0,i){i===void 0&&(i=(t.byteLength-n)/$c.getByteSize(e));const s=$c.getArrayType(e);return new s(t,n,i)}}function OMe(r,e){if(!r)throw new Error(`math.gl assertion failed. ${e}`)}function DMe(r,e=[0,0,0]){const t=r>>11&31,n=r>>5&63,i=r&31;return e[0]=t<<3,e[1]=n<<2,e[2]=i<<3,e}new cO;new rt;new cO;new cO;function e9(r,e=255){return Xl(r,0,e)/e*2-1}function t9(r){return r<0?-1:1}function LMe(r,e,t,n){if(OMe(n),r<0||r>t||e<0||e>t)throw new Error(`x and y must be unsigned normalized integers between 0 and ${t}`);if(n.x=e9(r,t),n.y=e9(e,t),n.z=1-(Math.abs(n.x)+Math.abs(n.y)),n.z<0){const i=n.x;n.x=(1-Math.abs(n.y))*t9(i),n.y=(1-Math.abs(i))*t9(n.y)}return n.normalize()}function NMe(r,e,t){return LMe(r,e,255,t)}class hD{constructor(e,t){H(this,"json");H(this,"buffer");H(this,"featuresLength",0);H(this,"_cachedTypedArrays",{});this.json=e,this.buffer=t}getExtension(e){return this.json.extensions&&this.json.extensions[e]}hasProperty(e){return!!this.json[e]}getGlobalProperty(e,t=vn.UNSIGNED_INT,n=1){const i=this.json[e];return i&&Number.isFinite(i.byteOffset)?this._getTypedArrayFromBinary(e,t,n,1,i.byteOffset):i}getPropertyArray(e,t,n){const i=this.json[e];return i&&Number.isFinite(i.byteOffset)?("componentType"in i&&(t=$c.fromName(i.componentType)),this._getTypedArrayFromBinary(e,t,n,this.featuresLength,i.byteOffset)):this._getTypedArrayFromArray(e,t,i)}getProperty(e,t,n,i,s){const a=this.json[e];if(!a)return a;const o=this.getPropertyArray(e,t,n);if(n===1)return o[i];for(let u=0;u<n;++u)s[u]=o[n*i+u];return s}_getTypedArrayFromBinary(e,t,n,i,s){const a=this._cachedTypedArrays;let o=a[e];return o||(o=$c.createTypedArray(t,this.buffer.buffer,this.buffer.byteOffset+s,i*n),a[e]=o),o}_getTypedArrayFromArray(e,t,n){const i=this._cachedTypedArrays;let s=i[e];return s||(s=$c.createTypedArray(t,n),i[e]=s),s}}const FMe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},UMe={SCALAR:(r,e)=>r[e],VEC2:(r,e)=>[r[2*e+0],r[2*e+1]],VEC3:(r,e)=>[r[3*e+0],r[3*e+1],r[3*e+2]],VEC4:(r,e)=>[r[4*e+0],r[4*e+1],r[4*e+2],r[4*e+3]],MAT2:(r,e)=>[r[4*e+0],r[4*e+1],r[4*e+2],r[4*e+3]],MAT3:(r,e)=>[r[9*e+0],r[9*e+1],r[9*e+2],r[9*e+3],r[9*e+4],r[9*e+5],r[9*e+6],r[9*e+7],r[9*e+8]],MAT4:(r,e)=>[r[16*e+0],r[16*e+1],r[16*e+2],r[16*e+3],r[16*e+4],r[16*e+5],r[16*e+6],r[16*e+7],r[16*e+8],r[16*e+9],r[16*e+10],r[16*e+11],r[16*e+12],r[16*e+13],r[16*e+14],r[16*e+15]]},zMe={SCALAR:(r,e,t)=>{e[t]=r},VEC2:(r,e,t)=>{e[2*t+0]=r[0],e[2*t+1]=r[1]},VEC3:(r,e,t)=>{e[3*t+0]=r[0],e[3*t+1]=r[1],e[3*t+2]=r[2]},VEC4:(r,e,t)=>{e[4*t+0]=r[0],e[4*t+1]=r[1],e[4*t+2]=r[2],e[4*t+3]=r[3]},MAT2:(r,e,t)=>{e[4*t+0]=r[0],e[4*t+1]=r[1],e[4*t+2]=r[2],e[4*t+3]=r[3]},MAT3:(r,e,t)=>{e[9*t+0]=r[0],e[9*t+1]=r[1],e[9*t+2]=r[2],e[9*t+3]=r[3],e[9*t+4]=r[4],e[9*t+5]=r[5],e[9*t+6]=r[6],e[9*t+7]=r[7],e[9*t+8]=r[8],e[9*t+9]=r[9]},MAT4:(r,e,t)=>{e[16*t+0]=r[0],e[16*t+1]=r[1],e[16*t+2]=r[2],e[16*t+3]=r[3],e[16*t+4]=r[4],e[16*t+5]=r[5],e[16*t+6]=r[6],e[16*t+7]=r[7],e[16*t+8]=r[8],e[16*t+9]=r[9],e[16*t+10]=r[10],e[16*t+11]=r[11],e[16*t+12]=r[12],e[16*t+13]=r[13],e[16*t+14]=r[14],e[16*t+15]=r[15]}};function VMe(r,e,t,n){const{componentType:i}=r;ci(r.componentType);const s=typeof i=="string"?$c.fromName(i):i,a=FMe[r.type],o=UMe[r.type],u=zMe[r.type];return t+=r.byteOffset,{values:$c.createTypedArray(s,e,t,a*n),type:s,size:a,unpacker:o,packer:u}}const Nc=r=>r!==void 0;function $Me(r,e,t){if(!e)return null;let n=r.getExtension("3DTILES_batch_table_hierarchy");const i=e.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),e.extensions=e.extensions||{},e.extensions["3DTILES_batch_table_hierarchy"]=i,n=i),n?jMe(n,t):null}function jMe(r,e){let t,n,i;const s=r.instancesLength,a=r.classes;let o=r.classIds,u=r.parentCounts,f=r.parentIds,g=s;Nc(o.byteOffset)&&(o.componentType=defaultValue(o.componentType,GL.UNSIGNED_SHORT),o.type=AttributeType.SCALAR,i=getBinaryAccessor(o),o=i.createArrayBufferView(e.buffer,e.byteOffset+o.byteOffset,s));let y;if(Nc(u))for(Nc(u.byteOffset)&&(u.componentType=defaultValue(u.componentType,GL.UNSIGNED_SHORT),u.type=AttributeType.SCALAR,i=getBinaryAccessor(u),u=i.createArrayBufferView(e.buffer,e.byteOffset+u.byteOffset,s)),y=new Uint16Array(s),g=0,t=0;t<s;++t)y[t]=g,g+=u[t];Nc(f)&&Nc(f.byteOffset)&&(f.componentType=defaultValue(f.componentType,GL.UNSIGNED_SHORT),f.type=AttributeType.SCALAR,i=getBinaryAccessor(f),f=i.createArrayBufferView(e.buffer,e.byteOffset+f.byteOffset,g));const A=a.length;for(t=0;t<A;++t){const D=a[t].length,V=a[t].instances,W=getBinaryProperties(D,V,e);a[t].instances=combine(W,V)}const C=new Array(A).fill(0),M=new Uint16Array(s);for(t=0;t<s;++t)n=o[t],M[t]=C[n],++C[n];const k={classes:a,classIds:o,classIndexes:M,parentCounts:u,parentIndexes:y,parentIds:f};return WMe(k),k}function a0(r,e,t){if(!r)return;const n=r.parentCounts;return r.parentIds?t(r,e):n>0?GMe(r,e,t):HMe(r,e,t)}function GMe(r,e,t){const n=r.classIds,i=r.parentCounts,s=r.parentIds,a=r.parentIndexes,o=n.length,u=scratchVisited;u.length=Math.max(u.length,o);const f=++marker,g=scratchStack;for(g.length=0,g.push(e);g.length>0;){if(e=g.pop(),u[e]===f)continue;u[e]=f;const y=t(r,e);if(Nc(y))return y;const A=i[e],C=a[e];for(let M=0;M<A;++M){const k=s[C+M];k!==e&&g.push(k)}}return null}function HMe(r,e,t){let n=!0;for(;n;){const i=t(r,e);if(Nc(i))return i;const s=r.parentIds[e];n=s!==e,e=s}throw new Error("traverseHierarchySingleParent")}function WMe(r){const t=r.classIds.length;for(let n=0;n<t;++n)NJ(r,n,stack)}function NJ(r,e,t){const n=r.parentCounts,i=r.parentIds,s=r.parentIndexes,o=r.classIds.length;if(!Nc(i))return;assert(e<o,`Parent index ${e} exceeds the total number of instances: ${o}`),assert(t.indexOf(e)===-1,"Circular dependency detected in the batch table hierarchy."),t.push(e);const u=Nc(n)?n[e]:1,f=Nc(n)?s[e]:e;for(let g=0;g<u;++g){const y=i[f+g];y!==e&&NJ(r,y,t)}t.pop(e)}function Zo(r){return r!=null}const Sx=(r,e)=>r,KMe={HIERARCHY:!0,extensions:!0,extras:!0};class FJ{constructor(e,t,n,i={}){H(this,"json");H(this,"binary");H(this,"featureCount");H(this,"_extensions");H(this,"_properties");H(this,"_binaryProperties");H(this,"_hierarchy");ci(n>=0),this.json=e||{},this.binary=t,this.featureCount=n,this._extensions=this.json?.extensions||{},this._properties={};for(const s in this.json)KMe[s]||(this._properties[s]=this.json[s]);this._binaryProperties=this._initializeBinaryProperties(),i["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=$Me(this,this.json,this.binary))}getExtension(e){return this.json&&this.json.extensions&&this.json.extensions[e]}memorySizeInBytes(){return 0}isClass(e,t){if(this._checkBatchId(e),ci(typeof t=="string",t),this._hierarchy){const n=a0(this._hierarchy,e,(i,s)=>{const a=i.classIds[s];return i.classes[a].name===t});return Zo(n)}return!1}isExactClass(e,t){return ci(typeof t=="string",t),this.getExactClassName(e)===t}getExactClassName(e){if(this._checkBatchId(e),this._hierarchy){const t=this._hierarchy.classIds[e];return this._hierarchy.classes[t].name}}hasProperty(e,t){return this._checkBatchId(e),ci(typeof t=="string",t),Zo(this._properties[t])||this._hasPropertyInHierarchy(e,t)}getPropertyNames(e,t){this._checkBatchId(e),t=Zo(t)?t:[],t.length=0;const n=Object.keys(this._properties);return t.push(...n),this._hierarchy&&this._getPropertyNamesInHierarchy(e,t),t}getProperty(e,t){if(this._checkBatchId(e),ci(typeof t=="string",t),this._binaryProperties){const i=this._binaryProperties[t];if(Zo(i))return this._getBinaryProperty(i,e)}const n=this._properties[t];if(Zo(n))return Sx(n[e]);if(this._hierarchy){const i=this._getHierarchyProperty(e,t);if(Zo(i))return i}}setProperty(e,t,n){const i=this.featureCount;if(this._checkBatchId(e),ci(typeof t=="string",t),this._binaryProperties){const a=this._binaryProperties[t];if(a){this._setBinaryProperty(a,e,n);return}}if(this._hierarchy&&this._setHierarchyProperty(this,e,t,n))return;let s=this._properties[t];Zo(s)||(this._properties[t]=new Array(i),s=this._properties[t]),s[e]=Sx(n)}_checkBatchId(e){if(!(e>=0&&e<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}_getBinaryProperty(e,t){return e.unpack(e.typedArray,t)}_setBinaryProperty(e,t,n){e.pack(n,e.typedArray,t)}_initializeBinaryProperties(){let e=null;for(const t in this._properties){const n=this._properties[t],i=this._initializeBinaryProperty(t,n);i&&(e=e||{},e[t]=i)}return e}_initializeBinaryProperty(e,t){if("byteOffset"in t){const n=t;ci(this.binary,`Property ${e} requires a batch table binary.`),ci(n.type,`Property ${e} requires a type.`);const i=VMe(n,this.binary.buffer,this.binary.byteOffset|0,this.featureCount);return{typedArray:i.values,componentCount:i.size,unpack:i.unpacker,pack:i.packer}}return null}_hasPropertyInHierarchy(e,t){if(!this._hierarchy)return!1;const n=a0(this._hierarchy,e,(i,s)=>{const a=i.classIds[s],o=i.classes[a].instances;return Zo(o[t])});return Zo(n)}_getPropertyNamesInHierarchy(e,t){a0(this._hierarchy,e,(n,i)=>{const s=n.classIds[i],a=n.classes[s].instances;for(const o in a)a.hasOwnProperty(o)&&t.indexOf(o)===-1&&t.push(o)})}_getHierarchyProperty(e,t){return a0(this._hierarchy,e,(n,i)=>{const s=n.classIds[i],a=n.classes[s],o=n.classIndexes[i],u=a.instances[t];return Zo(u)?Zo(u.typedArray)?this._getBinaryProperty(u,o):Sx(u[o]):null})}_setHierarchyProperty(e,t,n,i){const s=a0(this._hierarchy,t,(a,o)=>{const u=a.classIds[o],f=a.classes[u],g=a.classIndexes[o],y=f.instances[n];return Zo(y)?(ci(o===t,`Inherited property "${n}" is read-only.`),Zo(y.typedArray)?this._setBinaryProperty(y,g,i):y[g]=Sx(i),!0):!1});return Zo(s)}}const IP=4;function r2(r,e,t=0){const n=new DataView(e);if(r.magic=n.getUint32(t,!0),t+=IP,r.version=n.getUint32(t,!0),t+=IP,r.byteLength=n.getUint32(t,!0),t+=IP,r.version!==1)throw new Error(`3D Tile Version ${r.version} not supported`);return t}const zg=4,r9="b3dm tile in legacy format.";function dD(r,e,t){const n=new DataView(e);let i;r.header=r.header||{};let s=n.getUint32(t,!0);t+=zg;let a=n.getUint32(t,!0);t+=zg;let o=n.getUint32(t,!0);t+=zg;let u=n.getUint32(t,!0);return t+=zg,o>=570425344?(t-=zg*2,i=s,o=a,u=0,s=0,a=0,console.warn(r9)):u>=570425344&&(t-=zg,i=o,o=s,u=a,s=0,a=0,console.warn(r9)),r.header.featureTableJsonByteLength=s,r.header.featureTableBinaryByteLength=a,r.header.batchTableJsonByteLength=o,r.header.batchTableBinaryByteLength=u,r.header.batchLength=i,t}function fD(r,e,t,n){return t=XMe(r,e,t),t=JMe(r,e,t),t}function XMe(r,e,t,n){const{featureTableJsonByteLength:i,featureTableBinaryByteLength:s,batchLength:a}=r.header||{};if(r.featureTableJson={BATCH_LENGTH:a||0},i&&i>0){const o=LJ(e,t,i);r.featureTableJson=JSON.parse(o)}return t+=i||0,r.featureTableBinary=new Uint8Array(e,t,s),t+=s||0,t}function JMe(r,e,t,n){const{batchTableJsonByteLength:i,batchTableBinaryByteLength:s}=r.header||{};if(i&&i>0){const a=LJ(e,t,i);r.batchTableJson=JSON.parse(a),t+=i,s&&s>0&&(r.batchTableBinary=new Uint8Array(e,t,s),r.batchTableBinary=new Uint8Array(r.batchTableBinary),t+=s)}return t}function UJ(r,e,t){if(!e&&(!r||!r.batchIds||!t))return null;const{batchIds:n,isRGB565:i,pointCount:s=0}=r;if(n&&t){const a=new Uint8ClampedArray(s*3);for(let o=0;o<s;o++){const u=n[o],g=t.getProperty(u,"dimensions").map(y=>y*255);a[o*3]=g[0],a[o*3+1]=g[1],a[o*3+2]=g[2]}return{type:vn.UNSIGNED_BYTE,value:a,size:3,normalized:!0}}if(e&&i){const a=new Uint8ClampedArray(s*3);for(let o=0;o<s;o++){const u=DMe(e[o]);a[o*3]=u[0],a[o*3+1]=u[1],a[o*3+2]=u[2]}return{type:vn.UNSIGNED_BYTE,value:a,size:3,normalized:!0}}return e&&e.length===s*3?{type:vn.UNSIGNED_BYTE,value:e,size:3,normalized:!0}:{type:vn.UNSIGNED_BYTE,value:e||new Uint8ClampedArray,size:4,normalized:!0}}const n9=new rt;function qMe(r,e){if(!e)return null;if(r.isOctEncoded16P){const t=new Float32Array((r.pointsLength||0)*3);for(let n=0;n<(r.pointsLength||0);n++)NMe(e[n*2],e[n*2+1],n9),n9.toArray(t,n*3);return{type:vn.FLOAT,size:2,value:t}}return{type:vn.FLOAT,size:2,value:e}}function YMe(r,e,t){return r.isQuantized?t["3d-tiles"]&&t["3d-tiles"].decodeQuantizedPositions?(r.isQuantized=!1,ZMe(r,e)):{type:vn.UNSIGNED_SHORT,value:e,size:3,normalized:!0}:e}function ZMe(r,e){const t=new rt,n=new Float32Array(r.pointCount*3);for(let i=0;i<r.pointCount;i++)t.set(e[i*3],e[i*3+1],e[i*3+2]).scale(1/r.quantizedRange).multiply(r.quantizedVolumeScale).add(r.quantizedVolumeOffset).toArray(n,i*3);return n}async function QMe(r,e,t,n,i){t=r2(r,e,t),t=dD(r,e,t),t=fD(r,e,t),eRe(r);const{featureTable:s,batchTable:a}=tRe(r);return await oRe(r,s,a,n,i),rRe(r,s,n),nRe(r,s,a),iRe(r,s),t}function eRe(r){r.attributes={positions:null,colors:null,normals:null,batchIds:null},r.isQuantized=!1,r.isTranslucent=!1,r.isRGB565=!1,r.isOctEncoded16P=!1}function tRe(r){const e=new hD(r.featureTableJson,r.featureTableBinary),t=e.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(t))throw new Error("POINTS_LENGTH must be defined");e.featuresLength=t,r.featuresLength=t,r.pointsLength=t,r.pointCount=t,r.rtcCenter=e.getGlobalProperty("RTC_CENTER",vn.FLOAT,3);const n=sRe(r,e);return{featureTable:e,batchTable:n}}function rRe(r,e,t){if(r.attributes=r.attributes||{positions:null,colors:null,normals:null,batchIds:null},!r.attributes.positions){if(e.hasProperty("POSITION"))r.attributes.positions=e.getPropertyArray("POSITION",vn.FLOAT,3);else if(e.hasProperty("POSITION_QUANTIZED")){const n=e.getPropertyArray("POSITION_QUANTIZED",vn.UNSIGNED_SHORT,3);if(r.isQuantized=!0,r.quantizedRange=65535,r.quantizedVolumeScale=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",vn.FLOAT,3),!r.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(r.quantizedVolumeOffset=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",vn.FLOAT,3),!r.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");r.attributes.positions=YMe(r,n,t)}}if(!r.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function nRe(r,e,t){if(r.attributes=r.attributes||{positions:null,colors:null,normals:null,batchIds:null},!r.attributes.colors){let n=null;e.hasProperty("RGBA")?(n=e.getPropertyArray("RGBA",vn.UNSIGNED_BYTE,4),r.isTranslucent=!0):e.hasProperty("RGB")?n=e.getPropertyArray("RGB",vn.UNSIGNED_BYTE,3):e.hasProperty("RGB565")&&(n=e.getPropertyArray("RGB565",vn.UNSIGNED_SHORT,1),r.isRGB565=!0),r.attributes.colors=UJ(r,n,t)}e.hasProperty("CONSTANT_RGBA")&&(r.constantRGBA=e.getGlobalProperty("CONSTANT_RGBA",vn.UNSIGNED_BYTE,4))}function iRe(r,e){if(r.attributes=r.attributes||{positions:null,colors:null,normals:null,batchIds:null},!r.attributes.normals){let t=null;e.hasProperty("NORMAL")?t=e.getPropertyArray("NORMAL",vn.FLOAT,3):e.hasProperty("NORMAL_OCT16P")&&(t=e.getPropertyArray("NORMAL_OCT16P",vn.UNSIGNED_BYTE,2),r.isOctEncoded16P=!0),r.attributes.normals=qMe(r,t)}}function sRe(r,e){let t=null;if(!r.batchIds&&e.hasProperty("BATCH_ID")&&(r.batchIds=e.getPropertyArray("BATCH_ID",vn.UNSIGNED_SHORT,1),r.batchIds)){const n=e.getGlobalProperty("BATCH_LENGTH");if(!n)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");const{batchTableJson:i,batchTableBinary:s}=r;t=new FJ(i,s,n)}return t}async function oRe(r,e,t,n,i){let s,a,o;const u=r.batchTableJson&&r.batchTableJson.extensions&&r.batchTableJson.extensions["3DTILES_draco_point_compression"];u&&(o=u.properties);const f=e.getExtension("3DTILES_draco_point_compression");if(f){a=f.properties;const y=f.byteOffset,A=f.byteLength;if(!a||!Number.isFinite(y)||!A)throw new Error("Draco properties, byteOffset, and byteLength must be defined");s=(r.featureTableBinary||[]).slice(y,y+A),r.hasPositions=Number.isFinite(a.POSITION),r.hasColors=Number.isFinite(a.RGB)||Number.isFinite(a.RGBA),r.hasNormals=Number.isFinite(a.NORMAL),r.hasBatchIds=Number.isFinite(a.BATCH_ID),r.isTranslucent=Number.isFinite(a.RGBA)}if(!s)return!0;const g={buffer:s,properties:{...a,...o},batchTableProperties:o};return await aRe(r,g,n,i)}async function aRe(r,e,t,n){if(!n)return;const i={...t,draco:{...t?.draco,extraAttributes:e.batchTableProperties||{}}};delete i["3d-tiles"];const s=await Wv(e.buffer,wJ,i,n),a=s.attributes.POSITION&&s.attributes.POSITION.value,o=s.attributes.COLOR_0&&s.attributes.COLOR_0.value,u=s.attributes.NORMAL&&s.attributes.NORMAL.value,f=s.attributes.BATCH_ID&&s.attributes.BATCH_ID.value,g=a&&s.attributes.POSITION.value.quantization,y=u&&s.attributes.NORMAL.value.quantization;if(g){const C=s.POSITION.data.quantization,M=C.range;r.quantizedVolumeScale=new rt(M,M,M),r.quantizedVolumeOffset=new rt(C.minValues),r.quantizedRange=(1<<C.quantizationBits)-1,r.isQuantizedDraco=!0}y&&(r.octEncodedRange=(1<<s.NORMAL.data.quantization.quantizationBits)-1,r.isOctEncodedDraco=!0);const A={};if(e.batchTableProperties)for(const C of Object.keys(e.batchTableProperties))s.attributes[C]&&s.attributes[C].value&&(A[C.toLowerCase()]=s.attributes[C].value);r.attributes={positions:a,colors:UJ(r,o,void 0),normals:u,batchIds:f,...A}}const tM={URI:0,EMBEDDED:1};function zJ(r,e,t,n){r.rotateYtoZ=!0;const i=(r.byteOffset||0)+(r.byteLength||0)-t;if(i===0)throw new Error("glTF byte length must be greater than 0.");return r.gltfUpAxis=n?.["3d-tiles"]&&n["3d-tiles"].assetGltfUpAxis?n["3d-tiles"].assetGltfUpAxis:"Y",r.gltfArrayBuffer=Uk(e,t,i),r.gltfByteOffset=0,r.gltfByteLength=i,t%4===0||console.warn(`${r.type}: embedded glb is not aligned to a 4-byte boundary.`),(r.byteOffset||0)+(r.byteLength||0)}async function VJ(r,e,t,n){const i=t?.["3d-tiles"]||{};if(lRe(r,e),i.loadGLTF){if(!n)return;if(r.gltfUrl){const{fetch:s}=n,a=await s(r.gltfUrl,t);r.gltfArrayBuffer=await a.arrayBuffer(),r.gltfByteOffset=0}if(r.gltfArrayBuffer){const s=await Wv(r.gltfArrayBuffer,rv,t,n);r.gltf=lD(s),r.gpuMemoryUsageInBytes=fJ(r.gltf),delete r.gltfArrayBuffer,delete r.gltfByteOffset,delete r.gltfByteLength}}}function lRe(r,e,t){switch(e){case tM.URI:if(r.gltfArrayBuffer){const n=new Uint8Array(r.gltfArrayBuffer,r.gltfByteOffset),s=new TextDecoder().decode(n);r.gltfUrl=s.replace(/[\s\0]+$/,"")}delete r.gltfArrayBuffer,delete r.gltfByteOffset,delete r.gltfByteLength;break;case tM.EMBEDDED:break;default:throw new Error("b3dm: Illegal glTF format field")}}async function cRe(r,e,t,n,i){t=uRe(r,e,t,n),await VJ(r,tM.EMBEDDED,n,i);const s=r?.gltf?.extensions;return s&&s.CESIUM_RTC&&(r.rtcCenter=s.CESIUM_RTC.center),t}function uRe(r,e,t,n,i){t=r2(r,e,t),t=dD(r,e,t),t=fD(r,e,t),t=zJ(r,e,t,n);const s=new hD(r.featureTableJson,r.featureTableBinary);return r.rtcCenter=s.getGlobalProperty("RTC_CENTER",vn.FLOAT,3),t}async function hRe(r,e,t,n,i){return t=dRe(r,e,t,n),await VJ(r,r.gltfFormat||0,n,i),t}function dRe(r,e,t,n,i){if(t=r2(r,e,t),r.version!==1)throw new Error(`Instanced 3D Model version ${r.version} is not supported`);t=dD(r,e,t);const s=new DataView(e);if(r.gltfFormat=s.getUint32(t,!0),t+=4,t=fD(r,e,t),t=zJ(r,e,t,n),!r?.header?.featureTableJsonByteLength||r.header.featureTableJsonByteLength===0)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");const a=new hD(r.featureTableJson,r.featureTableBinary),o=a.getGlobalProperty("INSTANCES_LENGTH");if(a.featuresLength=o,!Number.isFinite(o))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");r.eastNorthUp=a.getGlobalProperty("EAST_NORTH_UP"),r.rtcCenter=a.getGlobalProperty("RTC_CENTER",vn.FLOAT,3);const u=new FJ(r.batchTableJson,r.batchTableBinary,o);return fRe(r,a,u,o),t}function fRe(r,e,t,n){const i=new Array(n),s=new rt;new rt,new rt,new rt;const a=new Hi,o=new j_,u=new rt,f={},g=new $r,y=[],A=[],C=[],M=[];for(let k=0;k<n;k++){let D;if(e.hasProperty("POSITION"))D=e.getProperty("POSITION",vn.FLOAT,3,k,s);else if(e.hasProperty("POSITION_QUANTIZED")){D=e.getProperty("POSITION_QUANTIZED",vn.UNSIGNED_SHORT,3,k,s);const le=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",vn.FLOAT,3);if(!le)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const _e=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",vn.FLOAT,3);if(!_e)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const se=65535;for(let Y=0;Y<3;Y++)D[Y]=D[Y]/se*_e[Y]+le[Y]}if(!D)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");if(s.copy(D),f.translation=s,r.normalUp=e.getProperty("NORMAL_UP",vn.FLOAT,3,k,y),r.normalRight=e.getProperty("NORMAL_RIGHT",vn.FLOAT,3,k,A),r.normalUp){if(!r.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");r.hasCustomOrientation=!0}else{if(r.octNormalUp=e.getProperty("NORMAL_UP_OCT32P",vn.UNSIGNED_SHORT,2,k,y),r.octNormalRight=e.getProperty("NORMAL_RIGHT_OCT32P",vn.UNSIGNED_SHORT,2,k,A),r.octNormalUp)throw r.octNormalRight?new Error("i3dm: oct-encoded orientation not implemented"):new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");r.eastNorthUp?(ui.WGS84.eastNorthUpToFixedFrame(s,g),g.getRotationMatrix3(a)):a.identity()}o.fromMatrix3(a),f.rotation=o,u.set(1,1,1);const V=e.getProperty("SCALE",vn.FLOAT,1,k,C);Number.isFinite(V)&&u.multiplyByScalar(V);const W=e.getProperty("SCALE_NON_UNIFORM",vn.FLOAT,3,k,y);W&&u.scale(W),f.scale=u;let z=e.getProperty("BATCH_ID",vn.UNSIGNED_SHORT,1,k,M);z===void 0&&(z=k);const $=new $r().fromQuaternion(f.rotation);g.identity(),g.translate(f.translation),g.multiplyRight($),g.scale(f.scale);const te=g.clone();i[k]={modelMatrix:te,batchId:z}}r.instances=i}async function pRe(r,e,t,n,i,s){t=r2(r,e,t);const a=new DataView(e);for(r.tilesLength=a.getUint32(t,!0),t+=4,r.tiles=[];r.tiles.length<r.tilesLength&&(r.byteLength||0)-t>12;){const o={shape:"tile3d"};r.tiles.push(o),t=await s(e,t,n,i,o)}return t}async function gRe(r,e,t,n){if(r.rotateYtoZ=!0,r.gltfUpAxis=t?.["3d-tiles"]?.assetGltfUpAxis?t["3d-tiles"].assetGltfUpAxis:"Y",t?.["3d-tiles"]?.loadGLTF){if(!n)return e.byteLength;const i=await Wv(e,rv,t,n);r.gltf=lD(i),r.gpuMemoryUsageInBytes=fJ(r.gltf)}else r.gltfArrayBuffer=e;return e.byteLength}async function $J(r,e=0,t,n,i={shape:"tile3d"}){switch(i.byteOffset=e,i.type=MMe(r,e),i.type){case o0.COMPOSITE:return await pRe(i,r,e,t,n,$J);case o0.BATCHED_3D_MODEL:return await cRe(i,r,e,t,n);case o0.GLTF:return await gRe(i,r,t,n);case o0.INSTANCED_3D_MODEL:return await hRe(i,r,e,t,n);case o0.POINT_CLOUD:return await QMe(i,r,e,t,n);default:throw new Error(`3DTileLoader: unknown type ${i.type}`)}}const mRe=1952609651,yRe=1;async function bRe(r,e,t){if(new Uint32Array(r.slice(0,4))[0]!==mRe)throw new Error("Wrong subtree file magic number");if(new Uint32Array(r.slice(4,8))[0]!==yRe)throw new Error("Wrong subtree file verson, must be 1");const s=i9(r.slice(8,16)),a=new Uint8Array(r,24,s),u=new TextDecoder("utf8").decode(a),f=JSON.parse(u),g=i9(r.slice(16,24));let y=new ArrayBuffer(0);if(g&&(y=r.slice(24+s)),await Ex(f,f.tileAvailability,y,t),Array.isArray(f.contentAvailability))for(const A of f.contentAvailability)await Ex(f,A,y,t);else await Ex(f,f.contentAvailability,y,t);return await Ex(f,f.childSubtreeAvailability,y,t),f}async function Ex(r,e,t,n){const i=Number.isFinite(e.bitstream)?e.bitstream:e.bufferView;if(typeof i!="number")return;const s=r.bufferViews[i],a=r.buffers[s.buffer];if(!n?.baseUrl)throw new Error("Url is not provided");if(!n.fetch)throw new Error("fetch is not provided");if(a.uri){const u=`${n?.baseUrl||""}/${a.uri}`,g=await(await n.fetch(u)).arrayBuffer();e.explicitBitstream=new Uint8Array(g,s.byteOffset,s.byteLength);return}const o=r.buffers.slice(0,s.buffer).reduce((u,f)=>u+f.byteLength,0);e.explicitBitstream=new Uint8Array(t.slice(o,o+a.byteLength),s.byteOffset,s.byteLength)}function i9(r){const e=new DataView(r),t=e.getUint32(0,!0),n=e.getUint32(4,!0);return t+2**32*n}const jJ={dataType:null,batchType:null,id:"3d-tiles-subtree",name:"3D Tiles Subtree",module:"3d-tiles",version:DJ,extensions:["subtree"],mimeTypes:["application/octet-stream"],tests:["subtree"],parse:bRe,options:{}};/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var ul=null;try{ul=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function En(r,e,t){this.low=r|0,this.high=e|0,this.unsigned=!!t}En.prototype.__isLong__;Object.defineProperty(En.prototype,"__isLong__",{value:!0});function So(r){return(r&&r.__isLong__)===!0}function s9(r){var e=Math.clz32(r&-r);return r?31-e:e}En.isLong=So;var o9={},a9={};function wp(r,e){var t,n,i;return e?(r>>>=0,(i=0<=r&&r<256)&&(n=a9[r],n)?n:(t=xn(r,0,!0),i&&(a9[r]=t),t)):(r|=0,(i=-128<=r&&r<128)&&(n=o9[r],n)?n:(t=xn(r,r<0?-1:0,!1),i&&(o9[r]=t),t))}En.fromInt=wp;function hl(r,e){if(isNaN(r))return e?zu:Yl;if(e){if(r<0)return zu;if(r>=GJ)return KJ}else{if(r<=-c9)return ua;if(r+1>=c9)return WJ}return r<0?hl(-r,e).neg():xn(r%dy|0,r/dy|0,e)}En.fromNumber=hl;function xn(r,e,t){return new En(r,e,t)}En.fromBits=xn;var iT=Math.pow;function pD(r,e,t){if(r.length===0)throw Error("empty string");if(typeof e=="number"?(t=e,e=!1):e=!!e,r==="NaN"||r==="Infinity"||r==="+Infinity"||r==="-Infinity")return e?zu:Yl;if(t=t||10,t<2||36<t)throw RangeError("radix");var n;if((n=r.indexOf("-"))>0)throw Error("interior hyphen");if(n===0)return pD(r.substring(1),e,t).neg();for(var i=hl(iT(t,8)),s=Yl,a=0;a<r.length;a+=8){var o=Math.min(8,r.length-a),u=parseInt(r.substring(a,a+o),t);if(o<8){var f=hl(iT(t,o));s=s.mul(f).add(hl(u))}else s=s.mul(i),s=s.add(hl(u))}return s.unsigned=e,s}En.fromString=pD;function vl(r,e){return typeof r=="number"?hl(r,e):typeof r=="string"?pD(r,e):xn(r.low,r.high,typeof e=="boolean"?e:r.unsigned)}En.fromValue=vl;var l9=65536,_Re=1<<24,dy=l9*l9,GJ=dy*dy,c9=GJ/2,u9=wp(_Re),Yl=wp(0);En.ZERO=Yl;var zu=wp(0,!0);En.UZERO=zu;var Cm=wp(1);En.ONE=Cm;var HJ=wp(1,!0);En.UONE=HJ;var rM=wp(-1);En.NEG_ONE=rM;var WJ=xn(-1,2147483647,!1);En.MAX_VALUE=WJ;var KJ=xn(-1,-1,!0);En.MAX_UNSIGNED_VALUE=KJ;var ua=xn(0,-2147483648,!1);En.MIN_VALUE=ua;var jt=En.prototype;jt.toInt=function(){return this.unsigned?this.low>>>0:this.low};jt.toNumber=function(){return this.unsigned?(this.high>>>0)*dy+(this.low>>>0):this.high*dy+(this.low>>>0)};jt.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(ua)){var t=hl(e),n=this.div(t),i=n.mul(t).sub(this);return n.toString(e)+i.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var s=hl(iT(e,6),this.unsigned),a=this,o="";;){var u=a.div(s),f=a.sub(u.mul(s)).toInt()>>>0,g=f.toString(e);if(a=u,a.isZero())return g+o;for(;g.length<6;)g="0"+g;o=""+g+o}};jt.getHighBits=function(){return this.high};jt.getHighBitsUnsigned=function(){return this.high>>>0};jt.getLowBits=function(){return this.low};jt.getLowBitsUnsigned=function(){return this.low>>>0};jt.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ua)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return this.high!=0?t+33:t+1};jt.isSafeInteger=function(){var e=this.high>>21;return e?this.unsigned?!1:e===-1&&!(this.low===0&&this.high===-2097152):!0};jt.isZero=function(){return this.high===0&&this.low===0};jt.eqz=jt.isZero;jt.isNegative=function(){return!this.unsigned&&this.high<0};jt.isPositive=function(){return this.unsigned||this.high>=0};jt.isOdd=function(){return(this.low&1)===1};jt.isEven=function(){return(this.low&1)===0};jt.equals=function(e){return So(e)||(e=vl(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};jt.eq=jt.equals;jt.notEquals=function(e){return!this.eq(e)};jt.neq=jt.notEquals;jt.ne=jt.notEquals;jt.lessThan=function(e){return this.comp(e)<0};jt.lt=jt.lessThan;jt.lessThanOrEqual=function(e){return this.comp(e)<=0};jt.lte=jt.lessThanOrEqual;jt.le=jt.lessThanOrEqual;jt.greaterThan=function(e){return this.comp(e)>0};jt.gt=jt.greaterThan;jt.greaterThanOrEqual=function(e){return this.comp(e)>=0};jt.gte=jt.greaterThanOrEqual;jt.ge=jt.greaterThanOrEqual;jt.compare=function(e){if(So(e)||(e=vl(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};jt.comp=jt.compare;jt.negate=function(){return!this.unsigned&&this.eq(ua)?ua:this.not().add(Cm)};jt.neg=jt.negate;jt.add=function(e){So(e)||(e=vl(e));var t=this.high>>>16,n=this.high&65535,i=this.low>>>16,s=this.low&65535,a=e.high>>>16,o=e.high&65535,u=e.low>>>16,f=e.low&65535,g=0,y=0,A=0,C=0;return C+=s+f,A+=C>>>16,C&=65535,A+=i+u,y+=A>>>16,A&=65535,y+=n+o,g+=y>>>16,y&=65535,g+=t+a,g&=65535,xn(A<<16|C,g<<16|y,this.unsigned)};jt.subtract=function(e){return So(e)||(e=vl(e)),this.add(e.neg())};jt.sub=jt.subtract;jt.multiply=function(e){if(this.isZero())return this;if(So(e)||(e=vl(e)),ul){var t=ul.mul(this.low,this.high,e.low,e.high);return xn(t,ul.get_high(),this.unsigned)}if(e.isZero())return this.unsigned?zu:Yl;if(this.eq(ua))return e.isOdd()?ua:Yl;if(e.eq(ua))return this.isOdd()?ua:Yl;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(u9)&&e.lt(u9))return hl(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,i=this.high&65535,s=this.low>>>16,a=this.low&65535,o=e.high>>>16,u=e.high&65535,f=e.low>>>16,g=e.low&65535,y=0,A=0,C=0,M=0;return M+=a*g,C+=M>>>16,M&=65535,C+=s*g,A+=C>>>16,C&=65535,C+=a*f,A+=C>>>16,C&=65535,A+=i*g,y+=A>>>16,A&=65535,A+=s*f,y+=A>>>16,A&=65535,A+=a*u,y+=A>>>16,A&=65535,y+=n*g+i*f+s*u+a*o,y&=65535,xn(C<<16|M,y<<16|A,this.unsigned)};jt.mul=jt.multiply;jt.divide=function(e){if(So(e)||(e=vl(e)),e.isZero())throw Error("division by zero");if(ul){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?ul.div_u:ul.div_s)(this.low,this.high,e.low,e.high);return xn(t,ul.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?zu:Yl;var n,i,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return zu;if(e.gt(this.shru(1)))return HJ;s=zu}else{if(this.eq(ua)){if(e.eq(Cm)||e.eq(rM))return ua;if(e.eq(ua))return Cm;var a=this.shr(1);return n=a.div(e).shl(1),n.eq(Yl)?e.isNegative()?Cm:rM:(i=this.sub(e.mul(n)),s=n.add(i.div(e)),s)}else if(e.eq(ua))return this.unsigned?zu:Yl;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=Yl}for(i=this;i.gte(e);){n=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),u=o<=48?1:iT(2,o-48),f=hl(n),g=f.mul(e);g.isNegative()||g.gt(i);)n-=u,f=hl(n,this.unsigned),g=f.mul(e);f.isZero()&&(f=Cm),s=s.add(f),i=i.sub(g)}return s};jt.div=jt.divide;jt.modulo=function(e){if(So(e)||(e=vl(e)),ul){var t=(this.unsigned?ul.rem_u:ul.rem_s)(this.low,this.high,e.low,e.high);return xn(t,ul.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};jt.mod=jt.modulo;jt.rem=jt.modulo;jt.not=function(){return xn(~this.low,~this.high,this.unsigned)};jt.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32};jt.clz=jt.countLeadingZeros;jt.countTrailingZeros=function(){return this.low?s9(this.low):s9(this.high)+32};jt.ctz=jt.countTrailingZeros;jt.and=function(e){return So(e)||(e=vl(e)),xn(this.low&e.low,this.high&e.high,this.unsigned)};jt.or=function(e){return So(e)||(e=vl(e)),xn(this.low|e.low,this.high|e.high,this.unsigned)};jt.xor=function(e){return So(e)||(e=vl(e)),xn(this.low^e.low,this.high^e.high,this.unsigned)};jt.shiftLeft=function(e){return So(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?xn(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):xn(0,this.low<<e-32,this.unsigned)};jt.shl=jt.shiftLeft;jt.shiftRight=function(e){return So(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?xn(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):xn(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};jt.shr=jt.shiftRight;jt.shiftRightUnsigned=function(e){return So(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?xn(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):e===32?xn(this.high,0,this.unsigned):xn(this.high>>>e-32,0,this.unsigned)};jt.shru=jt.shiftRightUnsigned;jt.shr_u=jt.shiftRightUnsigned;jt.rotateLeft=function(e){var t;return So(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?xn(this.high,this.low,this.unsigned):e<32?(t=32-e,xn(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(e-=32,t=32-e,xn(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))};jt.rotl=jt.rotateLeft;jt.rotateRight=function(e){var t;return So(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?xn(this.high,this.low,this.unsigned):e<32?(t=32-e,xn(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(e-=32,t=32-e,xn(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))};jt.rotr=jt.rotateRight;jt.toSigned=function(){return this.unsigned?xn(this.low,this.high,!1):this};jt.toUnsigned=function(){return this.unsigned?this:xn(this.low,this.high,!0)};jt.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};jt.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};jt.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};En.fromBytes=function(e,t,n){return n?En.fromBytesLE(e,t):En.fromBytesBE(e,t)};En.fromBytesLE=function(e,t){return new En(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};En.fromBytesBE=function(e,t){return new En(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};typeof BigInt=="function"&&(En.fromBigInt=function(e,t){var n=Number(BigInt.asIntN(32,e)),i=Number(BigInt.asIntN(32,e>>BigInt(32)));return xn(n,i,t)},En.fromValue=function(e,t){return typeof e=="bigint"?En.fromBigInt(e,t):vl(e,t)},jt.toBigInt=function(){var e=BigInt(this.low>>>0),t=BigInt(this.unsigned?this.high>>>0:this.high);return t<<BigInt(32)|e});const vRe=16;function XJ(r){r==="X"&&(r="");const e=r.padEnd(vRe,"0");return En.fromString(e,!0,16)}function ARe(r){if(r.isZero())return"X";let e=r.countTrailingZeros();const t=e%4;e=(e-t)/4;const n=e;e*=4;const s=r.shiftRightUnsigned(e).toString(16).replace(/0+$/,"");return Array(17-n-s.length).join("0")+s}function xRe(r,e){const t=wRe(r).shiftRightUnsigned(2);return r.add(En.fromNumber(2*e+1-4).multiply(t))}function wRe(r){return r.and(r.not().add(1))}const CRe=3,TRe=30,SRe=2*TRe+1,h9=180/Math.PI;function ERe(r){if(r.length===0)throw new Error(`Invalid Hilbert quad key ${r}`);const e=r.split("/"),t=parseInt(e[0],10),n=e[1],i=n.length;let s=0;const a=[0,0];for(let o=i-1;o>=0;o--){s=i-o;const u=n[o];let f=0,g=0;u==="1"?g=1:u==="2"?(f=1,g=1):u==="3"&&(f=1);const y=Math.pow(2,s-1);PRe(y,a,f,g),a[0]+=y*f,a[1]+=y*g}if(t%2===1){const o=a[0];a[0]=a[1],a[1]=o}return{face:t,ij:a,level:s}}function IRe(r){if(r.isZero())return"";let e=r.toString(2);for(;e.length<CRe+SRe;)e="0"+e;const t=e.lastIndexOf("1"),n=e.substring(0,3),i=e.substring(3,t),s=i.length/2,a=En.fromString(n,!0,2).toString(10);let o="";if(s!==0)for(o=En.fromString(i,!0,2).toString(4);o.length<s;)o="0"+o;return`${a}/${o}`}function JJ(r,e,t){const n=1<<e;return[(r[0]+t[0])/n,(r[1]+t[1])/n]}function d9(r){return r>=.5?1/3*(4*r*r-1):1/3*(1-4*(1-r)*(1-r))}function qJ(r){return[d9(r[0]),d9(r[1])]}function YJ(r,[e,t]){switch(r){case 0:return[1,e,t];case 1:return[-e,1,t];case 2:return[-e,-t,1];case 3:return[-1,-t,-e];case 4:return[t,-1,-e];case 5:return[t,e,-1];default:throw new Error("Invalid face")}}function ZJ([r,e,t]){const n=Math.atan2(t,Math.sqrt(r*r+e*e));return[Math.atan2(e,r)*h9,n*h9]}function PRe(r,e,t,n){if(n===0){t===1&&(e[0]=r-1-e[0],e[1]=r-1-e[1]);const i=e[0];e[0]=e[1],e[1]=i}}function BRe(r){const e=JJ(r.ij,r.level,[.5,.5]),t=qJ(e),n=YJ(r.face,t);return ZJ(n)}const MRe=100;function f9(r){const{face:e,ij:t,level:n}=r,i=[[0,0],[0,1],[1,1],[1,0],[0,0]],s=Math.max(1,Math.ceil(MRe*Math.pow(2,-n))),a=new Float64Array(4*s*2+2);let o=0,u=0;for(let f=0;f<4;f++){const g=i[f].slice(0),y=i[f+1],A=(y[0]-g[0])/s,C=(y[1]-g[1])/s;for(let M=0;M<s;M++){g[0]+=A,g[1]+=C;const k=JJ(t,n,g),D=qJ(k),V=YJ(e,D),W=ZJ(V);Math.abs(W[1])>89.999&&(W[0]=u);const z=W[0]-u;W[0]+=z>180?-360:z<-180?360:0,a[o++]=W[0],a[o++]=W[1],u=W[0]}}return a[o++]=a[0],a[o++]=a[1],a}function gD(r){const e=RRe(r);return ERe(e)}function RRe(r){if(r.indexOf("/")>0)return r;const e=XJ(r);return IRe(e)}function kRe(r){const e=gD(r);return BRe(e)}function ORe(r){let e;if(r.face===2||r.face===5){let t=null,n=0;for(let i=0;i<4;i++){const s=`${r.face}/${i}`,a=gD(s),o=f9(a);(typeof t>"u"||t===null)&&(t=new Float64Array(4*o.length)),t.set(o,n),n+=o.length}e=p9(t)}else{const t=f9(r);e=p9(t)}return e}function p9(r){if(r.length%2!==0)throw new Error("Invalid corners");const e=[],t=[];for(let n=0;n<r.length;n+=2)e.push(r[n]),t.push(r[n+1]);return e.sort((n,i)=>n-i),t.sort((n,i)=>n-i),{west:e[0],east:e[e.length-1],north:t[t.length-1],south:t[0]}}function DRe(r,e){const t=e?.minimumHeight||0,n=e?.maximumHeight||0,i=gD(r),s=ORe(i),a=s.west,o=s.south,u=s.east,f=s.north,g=[];return g.push(new rt(a,f,t)),g.push(new rt(u,f,t)),g.push(new rt(u,o,t)),g.push(new rt(a,o,t)),g.push(new rt(a,f,n)),g.push(new rt(u,f,n)),g.push(new rt(u,o,n)),g.push(new rt(a,o,n)),g}function QJ(r){const e=r.token,t={minimumHeight:r.minimumHeight,maximumHeight:r.maximumHeight},n=DRe(e,t),i=kRe(e),s=i[0],a=i[1],o=ui.WGS84.cartographicToCartesian([s,a,t.maximumHeight]),u=new rt(o[0],o[1],o[2]);n.push(u);const f=eJ(n);return[...f.center,...f.halfAxes]}const LRe=4,NRe=8,FRe={QUADTREE:LRe,OCTREE:NRe};function URe(r,e,t){if(r?.box){const n=XJ(r.s2VolumeInfo.token),i=xRe(n,e),s=ARe(i),a={...r.s2VolumeInfo};switch(a.token=s,t){case"OCTREE":const f=r.s2VolumeInfo,g=f.maximumHeight-f.minimumHeight,y=g/2,A=f.minimumHeight+g/2;f.minimumHeight=A-y,f.maximumHeight=A+y;break}return{box:QJ(a),s2VolumeInfo:a}}}async function eq(r){const{subtree:e,subtreeData:t={level:0,x:0,y:0,z:0},parentData:n={mortonIndex:0,localLevel:-1,localX:0,localY:0,localZ:0},childIndex:i=0,implicitOptions:s,loaderOptions:a,s2VolumeBox:o}=r,{subdivisionScheme:u,subtreeLevels:f,maximumLevel:g,contentUrlTemplate:y,subtreesUriTemplate:A,basePath:C}=s,M={children:[],lodMetricValue:0,contentUrl:""};if(!g)return FH.once(`Missing 'maximumLevel' or 'availableLevels' property. The subtree ${y} won't be loaded...`),M;const k=n.localLevel+1,D=t.level+k;if(D>g)return M;const V=FRe[u],W=Math.log2(V),z=i&1,$=i>>1&1,te=i>>2&1,le=Tf(n.localX,z,1),_e=Tf(n.localY,$,1),se=Tf(n.localZ,te,1),Y=Tf(t.x,le,k),ce=Tf(t.y,_e,k),oe=Tf(t.z,se,k),Me=Tf(n.mortonIndex,i,W),ze=k===f&&PP(e.childSubtreeAvailability,Me);let Ve,lt,gt,At;if(ze){const xr=`${C}/${A}`,Er=nM(xr,D,Y,ce,oe);Ve=await Yu(Er,jJ,a),At=0,lt={level:D,x:Y,y:ce,z:oe},gt={mortonIndex:0,localLevel:0,localX:0,localY:0,localZ:0}}else Ve=e,At=(V**k-1)/(V-1)+Me,lt=t,gt={mortonIndex:Me,localLevel:k,localX:le,localY:_e,localZ:se};if(!PP(Ve.tileAvailability,At))return M;PP(Ve.contentAvailability,At)&&(M.contentUrl=nM(y,D,Y,ce,oe));for(let xr=0;xr<V;xr++){const Er=URe(o,xr,u),Jr=await eq({subtree:Ve,subtreeData:lt,parentData:gt,childIndex:xr,implicitOptions:s,loaderOptions:a,s2VolumeBox:Er});(Jr.contentUrl||Jr.children.length)&&M.children.push(Jr)}return M.contentUrl||M.children.length?zRe(M,{level:D,x:Y,y:ce,z:oe},s,o):M}function PP(r,e){let t;return Array.isArray(r)?(t=r[0],r.length>1&&FH.once('Not supported extension "3DTILES_multiple_contents" has been detected')):t=r,"constant"in t?!!t.constant:t.explicitBitstream?jRe(e,t.explicitBitstream):!1}function zRe(r,e,t,n){const{basePath:i,refine:s,getRefine:a,lodMetricType:o,getTileType:u,rootLodMetricValue:f,rootBoundingVolume:g}=t,y=r.contentUrl&&r.contentUrl.replace(`${i}/`,""),A=f/2**e.level,C=n?.box?{box:n.box}:g,M=VRe(C,e,t.subdivisionScheme);return{children:r.children,contentUrl:r.contentUrl,content:{uri:y},id:r.contentUrl,refine:a(s),type:u(r),lodMetricType:o,lodMetricValue:A,geometricError:A,transform:r.transform,boundingVolume:M}}function VRe(r,e,t){if(r.region){const{level:n,x:i,y:s,z:a}=e,[o,u,f,g,y,A]=r.region,C=2**n,M=(f-o)/C,[k,D]=[o+M*i,o+M*(i+1)],V=(g-u)/C,[W,z]=[u+V*s,u+V*(s+1)];let $,te;if(t==="OCTREE"){const le=(A-y)/C;[$,te]=[y+le*a,y+le*(a+1)]}else[$,te]=[y,A];return{region:[k,W,D,z,$,te]}}if(r.box)return r;throw new Error(`Unsupported bounding volume type ${JSON.stringify(r)}`)}function Tf(r,e,t){return(r<<t)+e}function nM(r,e,t,n,i){const s=$Re({level:e,x:t,y:n,z:i});return r.replace(/{level}|{x}|{y}|{z}/gi,a=>s[a])}function $Re(r){const e={};for(const t in r)e[`{${t}}`]=r[t];return e}function jRe(r,e){const t=Math.floor(r/8),n=r%8;return(e[t]>>n&1)===1}function mD(r,e=""){if(!e)return Uu.EMPTY;const n=e.split("?")[0].split(".").pop();switch(n){case"pnts":return Uu.POINTCLOUD;case"i3dm":case"b3dm":case"glb":case"gltf":return Uu.SCENEGRAPH;default:return n||Uu.EMPTY}}function yD(r){switch(r){case"REPLACE":case"replace":return ec.REPLACE;case"ADD":case"add":return ec.ADD;default:return r}}function iM(r,e){if(/^[a-z][0-9a-z+.-]*:/i.test(e)){const n=new URL(r,`${e}/`);return decodeURI(n.toString())}else if(r.startsWith("/"))return r;return Uhe(e,r)}function g9(r,e){if(!r)return null;let t;if(r.content){const i=r.content.uri||r.content?.url;typeof i<"u"&&(t=iM(i,e))}return{...r,id:t,contentUrl:t,lodMetricType:hy.GEOMETRIC_ERROR,lodMetricValue:r.geometricError,transformMatrix:r.transform,type:mD(r,t),refine:yD(r.refine)}}async function GRe(r,e,t){let n=null;const i=y9(r.root);i&&r.root?n=await m9(r.root,r,e,i,t):n=g9(r.root,e);const s=[];for(s.push(n);s.length>0;){const a=s.pop()||{},o=a.children||[],u=[];for(const f of o){const g=y9(f);let y;g?y=await m9(f,r,e,g,t):y=g9(f,e),y&&(u.push(y),s.push(y))}a.children=u}return n}async function m9(r,e,t,n,i){const{subdivisionScheme:s,maximumLevel:a,availableLevels:o,subtreeLevels:u,subtrees:{uri:f}}=n,g=nM(f,0,0,0,0),y=iM(g,t),A=await Yu(y,jJ,i),C=r.content?.uri,M=C?iM(C,t):"",k=e?.root?.refine,D=r.geometricError,V=r.boundingVolume.extensions?.["3DTILES_bounding_volume_S2"];if(V){const te={box:QJ(V),s2VolumeInfo:V};r.boundingVolume=te}const W=r.boundingVolume,z={contentUrlTemplate:M,subtreesUriTemplate:f,subdivisionScheme:s,subtreeLevels:u,maximumLevel:Number.isFinite(o)?o-1:a,refine:k,basePath:t,lodMetricType:hy.GEOMETRIC_ERROR,rootLodMetricValue:D,rootBoundingVolume:W,getTileType:mD,getRefine:yD};return await HRe(r,t,A,z,i)}async function HRe(r,e,t,n,i){if(!r)return null;const{children:s,contentUrl:a}=await eq({subtree:t,implicitOptions:n,loaderOptions:i});let o,u=null;return a&&(o=a,u={uri:a.replace(`${e}/`,"")}),{...r,id:o,contentUrl:o,lodMetricType:hy.GEOMETRIC_ERROR,lodMetricValue:r.geometricError,transformMatrix:r.transform,type:mD(r,o),refine:yD(r.refine),content:u||r.content,children:s}}function y9(r){return r?.extensions?.["3DTILES_implicit_tiling"]||r?.implicitTiling}const tq={dataType:null,batchType:null,id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:DJ,extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:WRe,options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}};async function WRe(r,e={},t){const n=e["3d-tiles"]||{};let i;return n.isTileset==="auto"?i=t?.url&&t.url.indexOf(".json")!==-1:i=n.isTileset,i?KRe(r,e,t):XRe(r,e,t)}async function KRe(r,e,t){const n=JSON.parse(new TextDecoder().decode(r)),i=t?.url||"",s=JRe(i),a=await GRe(n,s,e||{});return{...n,shape:"tileset3d",loader:tq,url:i,queryString:t?.queryString||"",basePath:s,root:a||n.root,type:na.TILES3D,lodMetricType:hy.GEOMETRIC_ERROR,lodMetricValue:n.root?.geometricError||0}}async function XRe(r,e,t){const n={content:{shape:"tile3d",featureIds:null}};return await $J(r,0,e,t,n.content),n.content}function JRe(r){return zk(r)}const b9=[0],qRe={getPointColor:{type:"accessor",value:[0,0,0,255]},pointSize:1,data:"",loader:tq,onTilesetLoad:{type:"function",value:r=>{}},onTileLoad:{type:"function",value:r=>{}},onTileUnload:{type:"function",value:r=>{}},onTileError:{type:"function",value:(r,e,t)=>{}},_getMeshColor:{type:"function",value:r=>[255,255,255]}};class bD extends Zc{initializeState(){"onTileLoadFail"in this.props&&Rr.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null,activeViewports:{},lastUpdatedViewports:null}}get isLoaded(){return!!(this.state?.tileset3d?.isLoaded()&&super.isLoaded)}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({props:e,oldProps:t,changeFlags:n}){if(e.data&&e.data!==t.data&&this._loadTileset(e.data),n.viewportChanged){const{activeViewports:i}=this.state;Object.keys(i).length&&(this._updateTileset(i),this.state.lastUpdatedViewports=i,this.state.activeViewports={})}if(n.propsChanged){const{layerMap:i}=this.state;for(const s in i)i[s].needsUpdate=!0}}activateViewport(e){const{activeViewports:t,lastUpdatedViewports:n}=this.state;this.internalState.viewport=e,t[e.id]=e;const i=n?.[e.id];(!i||!e.equals(i))&&(this.setChangeFlags({viewportChanged:!0}),this.setNeedsUpdate())}getPickingInfo({info:e,sourceLayer:t}){const n=t&&t.props.tile;return e.picked&&(e.object=n),e.sourceTile=n,e}filterSubLayer({layer:e,viewport:t}){const{tile:n}=e.props,{id:i}=t;return n.selected&&n.viewportIds.includes(i)}_updateAutoHighlight(e){const t=e.sourceTile,n=this.state.layerMap[t?.id];n&&n.layer&&n.layer.updateAutoHighlight(e)}async _loadTileset(e){const{loadOptions:t={}}=this.props,n=this.props.loader||this.props.loaders,i=Array.isArray(n)?n[0]:n,s={loadOptions:{...t}};let a=e;if(i.preload){const f=await i.preload(e,t);f.url&&(a=f.url),f.headers&&(s.loadOptions.fetch={...s.loadOptions.fetch,headers:f.headers}),Object.assign(s,f)}const o=await Yu(a,i,s.loadOptions),u=new BMe(o,{onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileError:this.props.onTileError,...s});this.setState({tileset3d:u,layerMap:{}}),this._updateTileset(this.state.activeViewports),this.props.onTilesetLoad(u)}_onTileLoad(e){const{lastUpdatedViewports:t}=this.state;this.props.onTileLoad(e),this._updateTileset(t),this.setNeedsUpdate()}_onTileUnload(e){delete this.state.layerMap[e.id],this.props.onTileUnload(e)}_updateTileset(e){if(!e)return;const{tileset3d:t}=this.state,{timeline:n}=this.context,i=Object.keys(e).length;!n||!i||!t||t.selectTiles(Object.values(e)).then(s=>{this.state.frameNumber!==s&&this.setState({frameNumber:s})})}_getSubLayer(e,t){if(!e.content)return null;switch(e.type){case Uu.POINTCLOUD:return this._makePointCloudLayer(e,t);case Uu.SCENEGRAPH:return this._make3DModelLayer(e);case Uu.MESH:return this._makeSimpleMeshLayer(e,t);default:throw new Error(`Tile3DLayer: Failed to render layer of type ${e.content.type}`)}}_makePointCloudLayer(e,t){const{attributes:n,pointCount:i,constantRGBA:s,cartographicOrigin:a,modelMatrix:o}=e.content,{positions:u,normals:f,colors:g}=n;if(!u)return null;const y=t&&t.props.data||{header:{vertexCount:i},attributes:{POSITION:u,NORMAL:f,COLOR_0:g}},{pointSize:A,getPointColor:C}=this.props,M=this.getSubLayerClass("pointcloud",$S);return new M({pointSize:A},this.getSubLayerProps({id:"pointcloud"}),{id:`${this.id}-pointcloud-${e.id}`,tile:e,data:y,coordinateSystem:Pr.METER_OFFSETS,coordinateOrigin:a,modelMatrix:o,getColor:s||C,_offset:0})}_make3DModelLayer(e){const{gltf:t,instances:n,cartographicOrigin:i,modelMatrix:s}=e.content,a=this.getSubLayerClass("scenegraph",cD);return new a({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:`${this.id}-scenegraph-${e.id}`,tile:e,data:n||b9,scenegraph:t,coordinateSystem:Pr.METER_OFFSETS,coordinateOrigin:i,modelMatrix:s,getTransformMatrix:o=>o.modelMatrix,getPosition:[0,0,0],_offset:0})}_makeSimpleMeshLayer(e,t){const n=e.content,{attributes:i,indices:s,modelMatrix:a,cartographicOrigin:o,coordinateSystem:u=Pr.METER_OFFSETS,material:f,featureIds:g}=n,{_getMeshColor:y}=this.props,A=t&&t.props.mesh||new To({topology:"triangle-list",attributes:YRe(i),indices:s}),C=this.getSubLayerClass("mesh",uD);return new C(this.getSubLayerProps({id:"mesh"}),{id:`${this.id}-mesh-${e.id}`,tile:e,mesh:A,data:b9,getColor:y(e),pbrMaterial:f,modelMatrix:a,coordinateOrigin:o,coordinateSystem:u,featureIds:g,_offset:0})}renderLayers(){const{tileset3d:e,layerMap:t}=this.state;return e?e.tiles.map(n=>{const i=t[n.id]=t[n.id]||{tile:n};let{layer:s}=i;return n.selected&&(s?i.needsUpdate&&(s=this._getSubLayer(n,s),i.needsUpdate=!1):s=this._getSubLayer(n)),i.layer=s,s}).filter(Boolean):null}}bD.defaultProps=qRe;bD.layerName="Tile3DLayer";function YRe(r){const e={};return e.positions={...r.positions,value:new Float32Array(r.positions.value)},r.normals&&(e.normals=r.normals),r.texCoords&&(e.texCoords=r.texCoords),r.colors&&(e.colors=r.colors),r.uvRegions&&(e.uvRegions=r.uvRegions),e}const ZRe="4.3.3",rq={dataType:null,batchType:null,name:"Terrain",id:"terrain",module:"terrain",version:ZRe,worker:!0,extensions:["png","pngraw","jpg","jpeg","gif","webp","bmp"],mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp"],options:{terrain:{tesselator:"auto",bounds:void 0,meshMaxError:10,elevationDecoder:{rScaler:1,gScaler:0,bScaler:0,offset:0},skirtHeight:void 0}}};({...rq});const _9=[1],QRe={...eA.defaultProps,elevationData:QC,texture:{...QC,optional:!0},meshMaxError:{type:"number",value:4},bounds:{type:"array",value:null,optional:!0,compare:!0},color:{type:"color",value:[255,255,255]},elevationDecoder:{type:"object",value:{rScaler:1,gScaler:0,bScaler:0,offset:0}},workerUrl:"",wireframe:!1,material:!0,loaders:[rq]};function v9(r){return Array.isArray(r)?r.join(";"):r||""}class _D extends Zc{updateState({props:e,oldProps:t}){const n=e.elevationData!==t.elevationData;if(n){const{elevationData:s}=e,a=s&&(Array.isArray(s)||eke(s));this.setState({isTiled:a})}const i=n||e.meshMaxError!==t.meshMaxError||e.elevationDecoder!==t.elevationDecoder||e.bounds!==t.bounds;if(!this.state.isTiled&&i){const s=this.loadTerrain(e);this.setState({terrain:s})}e.workerUrl&&Rr.removed("workerUrl","loadOptions.terrain.workerUrl")()}loadTerrain({elevationData:e,bounds:t,elevationDecoder:n,meshMaxError:i,signal:s}){if(!e)return null;let a=this.getLoadOptions();a={...a,terrain:{skirtHeight:this.state.isTiled?i*2:0,...a?.terrain,bounds:t,meshMaxError:i,elevationDecoder:n}};const{fetch:o}=this.props;return o(e,{propName:"elevationData",layer:this,loadOptions:a,signal:s})}getTiledTerrainData(e){const{elevationData:t,fetch:n,texture:i,elevationDecoder:s,meshMaxError:a}=this.props,{viewport:o}=this.context,u=eT(t,e),f=i&&eT(i,e),{signal:g}=e;let y=[0,0],A=[0,0];if(o.isGeospatial){const D=e.bbox;y=o.projectFlat([D.west,D.south]),A=o.projectFlat([D.east,D.north])}else{const D=e.bbox;y=[D.left,D.bottom],A=[D.right,D.top]}const C=[y[0],y[1],A[0],A[1]],M=this.loadTerrain({elevationData:u,bounds:C,elevationDecoder:s,meshMaxError:a,signal:g}),k=f?n(f,{propName:"texture",layer:this,loaders:[],signal:g}).catch(D=>null):Promise.resolve(null);return Promise.all([M,k])}renderSubLayers(e){const t=this.getSubLayerClass("mesh",ev),{color:n,wireframe:i,material:s}=this.props,{data:a}=e;if(!a)return null;const[o,u]=a;return new t(e,{data:_9,mesh:o,texture:u,_instanced:!1,coordinateSystem:Pr.CARTESIAN,getPosition:f=>[0,0,0],getColor:n,wireframe:i,material:s})}onViewportLoad(e){if(!e)return;const{zRange:t}=this.state,n=e.map(a=>a.content).filter(Boolean).map(a=>a[0].header.boundingBox.map(u=>u[2]));if(n.length===0)return;const i=Math.min(...n.map(a=>a[0])),s=Math.max(...n.map(a=>a[1]));(!t||i<t[0]||s>t[1])&&this.setState({zRange:[i,s]})}renderLayers(){const{color:e,material:t,elevationData:n,texture:i,wireframe:s,meshMaxError:a,elevationDecoder:o,tileSize:u,maxZoom:f,minZoom:g,extent:y,maxRequests:A,onTileLoad:C,onTileUnload:M,onTileError:k,maxCacheSize:D,maxCacheByteSize:V,refinementStrategy:W}=this.props;if(this.state.isTiled)return new eA(this.getSubLayerProps({id:"tiles"}),{getTileData:this.getTiledTerrainData.bind(this),renderSubLayers:this.renderSubLayers.bind(this),updateTriggers:{getTileData:{elevationData:v9(n),texture:v9(i),meshMaxError:a,elevationDecoder:o}},onViewportLoad:this.onViewportLoad.bind(this),zRange:this.state.zRange||null,tileSize:u,maxZoom:f,minZoom:g,extent:y,maxRequests:A,onTileLoad:C,onTileUnload:M,onTileError:k,maxCacheSize:D,maxCacheByteSize:V,refinementStrategy:W});if(!n)return null;const z=this.getSubLayerClass("mesh",ev);return new z(this.getSubLayerProps({id:"mesh"}),{data:_9,mesh:this.state.terrain,texture:i,_instanced:!1,getPosition:$=>[0,0,0],getColor:e,material:t,wireframe:s})}}_D.defaultProps=QRe;_D.layerName="TerrainLayer";const eke=r=>r.includes("{x}")&&(r.includes("{y}")||r.includes("{-y}")),tke={clipBounds:[0,0,1,1],clipByInstance:void 0},nq=`
uniform clipUniforms {
  vec4 bounds;
} clip;

bool clip_isInBounds(vec2 position) {
  return position.x >= clip.bounds[0] && position.y >= clip.bounds[1] && position.x < clip.bounds[2] && position.y < clip.bounds[3];
}
`,rke={name:"clip",vs:nq,uniformTypes:{bounds:"vec4<f32>"}},nke={"vs:#decl":`
out float clip_isVisible;
`,"vs:DECKGL_FILTER_GL_POSITION":`
  clip_isVisible = float(clip_isInBounds(geometry.worldPosition.xy));
`,"fs:#decl":`
in float clip_isVisible;
`,"fs:DECKGL_FILTER_COLOR":`
  if (clip_isVisible < 0.5) discard;
`},ike={name:"clip",fs:nq,uniformTypes:{bounds:"vec4<f32>"}},ske={"vs:#decl":`
out vec2 clip_commonPosition;
`,"vs:DECKGL_FILTER_GL_POSITION":`
  clip_commonPosition = geometry.position.xy;
`,"fs:#decl":`
in vec2 clip_commonPosition;
`,"fs:DECKGL_FILTER_COLOR":`
  if (!clip_isInBounds(clip_commonPosition)) discard;
`};class vD extends OO{getShaders(){let e="instancePositions"in this.getAttributeManager().attributes;return this.props.clipByInstance!==void 0&&(e=!!this.props.clipByInstance),this.state.clipByInstance=e,e?{modules:[rke],inject:nke}:{modules:[ike],inject:ske}}draw(){const{clipBounds:e}=this.props,t={};if(this.state.clipByInstance)t.bounds=e;else{const n=this.projectPosition([e[0],e[1],0]),i=this.projectPosition([e[2],e[3],0]);t.bounds=[Math.min(n[0],i[0]),Math.min(n[1],i[1]),Math.max(n[0],i[0]),Math.max(n[1],i[1])]}this.setShaderModuleProps({clip:t})}}vD.defaultProps=tke;vD.extensionName="ClipExtension";function A9(r,e){const t=e?.globalFeatureId;return t!==void 0?oke(r,t):ake(r,e?.type)}function oke(r,e){const t=iq(r);for(const n of t){let i=0,s=n.featureIds.value[0];for(let a=0;a<n.featureIds.value.length;a++){const o=n.featureIds.value[a];if(o!==s){if(e===n.globalFeatureIds.value[i])return sT(n,i,a);i=a,s=o}}if(e===n.globalFeatureIds.value[i])return sT(n,i,n.featureIds.value.length)}throw new Error(`featureId:${e} not found`)}function ake(r,e){const t=iq(r);return cke(t)}function lke(r,e,t){switch(r.type){case"Point":return fke(r,e,t);case"LineString":return dke(r,e,t);case"Polygon":return sq(r,e,t);default:const n=r;throw new Error(`Unsupported geometry type: ${n?.type}`)}}function iq(r,e){const t=[];return r.points&&(r.points.type="Point",t.push(r.points)),r.lines&&(r.lines.type="LineString",t.push(r.lines)),r.polygons&&(r.polygons.type="Polygon",t.push(r.polygons)),t}function cke(r){const e=[];for(const t of r){if(t.featureIds.value.length===0)continue;let n=0,i=t.featureIds.value[0];for(let s=0;s<t.featureIds.value.length;s++){const a=t.featureIds.value[s];a!==i&&(e.push(sT(t,n,s)),n=s,i=a)}e.push(sT(t,n,t.featureIds.value.length))}return e}function sT(r,e,t){const n=lke(r,e,t),i=hke(r,e),s=uke(r,e);return{type:"Feature",geometry:n,properties:i,...s}}function uke(r,e=0,t){return r.fields&&r.fields[r.featureIds.value[e]]}function hke(r,e=0,t){const n=Object.assign({},r.properties[r.featureIds.value[e]]);for(const i in r.numericProps)n[i]=r.numericProps[i].value[e];return n}function sq(r,e=-1/0,t=1/0){const{positions:n}=r,i=r.polygonIndices.value.filter(u=>u>=e&&u<=t),s=r.primitivePolygonIndices.value.filter(u=>u>=e&&u<=t);if(!(i.length>2)){const u=[];for(let f=0;f<s.length-1;f++){const g=s[f],y=s[f+1],A=oT(n,g,y);u.push(A)}return{type:"Polygon",coordinates:u}}const o=[];for(let u=0;u<i.length-1;u++){const f=i[u],g=i[u+1],y=sq(r,f,g).coordinates;o.push(y)}return{type:"MultiPolygon",coordinates:o}}function dke(r,e=-1/0,t=1/0){const{positions:n}=r,i=r.pathIndices.value.filter(o=>o>=e&&o<=t);if(!(i.length>2))return{type:"LineString",coordinates:oT(n,i[0],i[1])};const a=[];for(let o=0;o<i.length-1;o++){const u=oT(n,i[o],i[o+1]);a.push(u)}return{type:"MultiLineString",coordinates:a}}function fke(r,e,t){const{positions:n}=r,i=oT(n,e,t);return i.length>1?{type:"MultiPoint",coordinates:i}:{type:"Point",coordinates:i[0]}}function oT(r,e,t){e=e||0,t=t||r.value.length/r.size;const n=[];for(let i=e;i<t;i++){const s=Array();for(let a=i*r.size;a<(i+1)*r.size;a++)s.push(Number(r.value[a]));n.push(s)}return n}const pke="4.3.3",oq={dataType:null,batchType:null,name:"Mapbox Vector Tile",id:"mvt",module:"mvt",version:pke,extensions:["mvt","pbf"],mimeTypes:["application/vnd.mapbox-vector-tile","application/x-protobuf"],worker:!0,category:"geometry",options:{mvt:{shape:"geojson",coordinates:"local",layerProperty:"layerName",layers:void 0,tileIndex:void 0}}};({...oq});const gke={Point:aq,MultiPoint:mke,LineString:lq,MultiLineString:yke,Polygon:cq,MultiPolygon:bke};function aq([r,e],[t,n],i){const s=Hu(t[0],n[0],r),a=Hu(t[1],n[1],e);return i.unprojectFlat([s,a])}function AD(r,e,t){return r.map(n=>aq(n,e,t))}function mke(r,e,t){return AD(r,e,t)}function lq(r,e,t){return AD(r,e,t)}function yke(r,e,t){return r.map(n=>lq(n,e,t))}function cq(r,e,t){return r.map(n=>AD(n,e,t))}function bke(r,e,t){return r.map(n=>cq(n,e,t))}function _ke(r,e,t){const n=t.projectFlat([e.west,e.north]),i=t.projectFlat([e.east,e.south]),s=[n,i];return{...r,coordinates:gke[r.type](r.coordinates,s,t)}}const vke=["points","lines","polygons"];function Ake(r,e,t,n){for(const i of vke){const s=r[i]&&xke(r[i],e,t,n);if(s>=0)return s}return-1}function xke(r,e,t,n){const i=r.featureIds.value;if(!i.length)return-1;let s=0,a=i[i.length-1]+1;if(n){const u=wke(r,n);if(u)s=u[0],a=u[1]+1;else return-1}let o=-1;if(e in r.numericProps){const u=r.numericProps[e].value.findIndex((f,g)=>f===t&&i[g]>=s&&i[g]<a);return u>=0?r.globalFeatureIds.value[u]:-1}else e?o=x9(r.properties,u=>u[e]===t,s,a):r.fields&&(o=x9(r.fields,u=>u.id===t,s,a));return o>=0?Cke(r,o):-1}function wke(r,e){if(!r.__layers){const t={},{properties:n}=r;for(let i=0;i<n.length;i++){const{layerName:s}=n[i];s&&(t[s]?t[s][1]=i:t[s]=[i,i])}r.__layers=t}return r.__layers[e]}function Cke(r,e){if(!r.__ids){const t=[],n=r.featureIds.value,i=r.globalFeatureIds.value;for(let s=0;s<n.length;s++)t[n[s]]=i[s];r.__ids=t}return r.__ids[e]}function x9(r,e,t,n){for(let i=t;i<n;i++)if(e(r[i],i))return i;return-1}const BP=512,Tke={...Oy.defaultProps,data:QC,onDataLoad:{type:"function",value:null,optional:!0,compare:!1},uniqueIdProperty:"",highlightedFeatureId:null,loaders:[oq],binary:!0};class xD extends eA{initializeState(){super.initializeState();const e=this.context.viewport.resolution!==void 0?!1:this.props.binary;this.setState({binary:e,data:null,tileJSON:null,hoveredFeatureId:null,hoveredFeatureLayerName:null})}get isLoaded(){return!!(this.state?.data&&super.isLoaded)}updateState({props:e,oldProps:t,context:n,changeFlags:i}){i.dataChanged&&this._updateTileData(),this.state?.data&&(super.updateState({props:e,oldProps:t,context:n,changeFlags:i}),this._setWGS84PropertyForTiles());const{highlightColor:s}=e;s!==t.highlightColor&&Array.isArray(s)&&this.setState({highlightColor:s})}async _updateTileData(){let e=this.props.data,t=null;if(typeof e=="string"&&!tEe(e)){const{onDataLoad:n,fetch:i}=this.props;this.setState({data:null,tileJSON:null});try{t=await i(e,{propName:"data",layer:this,loaders:[]})}catch(s){this.raiseError(s,"loading TileJSON"),e=null}n&&n(t,{propName:"data",layer:this})}else e&&typeof e=="object"&&"tilejson"in e&&(t=e);t&&(e=t.tiles),this.setState({data:e,tileJSON:t})}_getTilesetOptions(){const e=super._getTilesetOptions(),t=this.state.tileJSON,{minZoom:n,maxZoom:i}=this.props;return t&&(Number.isFinite(t.minzoom)&&t.minzoom>n&&(e.minZoom=t.minzoom),Number.isFinite(t.maxzoom)&&(!Number.isFinite(i)||t.maxzoom<i)&&(e.maxZoom=t.maxzoom)),e}renderLayers(){return this.state?.data?super.renderLayers():null}getTileData(e){const{data:t,binary:n}=this.state,{index:i,signal:s}=e,a=eT(t,e);if(!a)return Promise.reject("Invalid URL");let o=this.getLoadOptions();const{fetch:u}=this.props;return o={...o,mimeType:"application/x-protobuf",mvt:{...o?.mvt,coordinates:this.context.viewport.resolution?"wgs84":"local",tileIndex:i},gis:n?{format:"binary"}:{}},u(a,{propName:"data",layer:this,loadOptions:o,signal:s})}renderSubLayers(e){const{x:t,y:n,z:i}=e.tile.index,s=Math.pow(2,i),a=BP/s,o=-a,u=BP*t/s,f=BP*(1-n/s),g=new $r().scale([a,o,1]);e.autoHighlight=!1,this.context.viewport.resolution||(e.modelMatrix=g,e.coordinateOrigin=[u,f,0],e.coordinateSystem=Pr.CARTESIAN,e.extensions=[...e.extensions||[],new vD]);const y=super.renderSubLayers(e);return this.state.binary&&!(y instanceof Oy)&&Rr.warn("renderSubLayers() must return GeoJsonLayer when using binary:true")(),y}_updateAutoHighlight(e){const{uniqueIdProperty:t}=this.props,{hoveredFeatureId:n,hoveredFeatureLayerName:i}=this.state,s=e.object;let a=null,o=null;s&&(a=MP(s,t),o=w9(s));let{highlightColor:u}=this.props;typeof u=="function"&&(u=u(e)),(n!==a||i!==o)&&this.setState({highlightColor:u,hoveredFeatureId:a,hoveredFeatureLayerName:o})}_isWGS84(){return!!this.context.viewport.resolution}getPickingInfo(e){const t=super.getPickingInfo(e);if(this.state.binary&&t.index!==-1){const{data:n}=e.sourceLayer.props;t.object=A9(n,{globalFeatureId:t.index})}return t.object&&!this._isWGS84()&&(t.object=T9(t.object,t.tile.bbox,this.context.viewport)),t}getSubLayerPropsByTile(e){return{highlightedObjectIndex:this.getHighlightedObjectIndex(e),highlightColor:this.state.highlightColor}}getHighlightedObjectIndex(e){const{hoveredFeatureId:t,hoveredFeatureLayerName:n,binary:i}=this.state,{uniqueIdProperty:s,highlightedFeatureId:a}=this.props,o=e.content,u=C9(a);if(!(C9(t)||u))return-1;const g=u?a:t;return Array.isArray(o)?o.findIndex(y=>{const A=MP(y,s)===g,C=u||w9(y)===n;return A&&C}):o&&i?Ake(o,s,g,u?"":n):-1}_pickObjects(e){const{deck:t,viewport:n}=this.context,i=n.width,s=n.height,a=n.x,o=n.y,u=[this.id];return t.pickObjects({x:a,y:o,width:i,height:s,layerIds:u,maxObjects:e})}getRenderedFeatures(e=null){const t=this._pickObjects(e),n=new Set,i=[];for(const s of t){const a=MP(s.object,this.props.uniqueIdProperty);a===void 0?i.push(s.object):n.has(a)||(n.add(a),i.push(s.object))}return i}_setWGS84PropertyForTiles(){const e="dataInWGS84";this.state.tileset.selectedTiles.forEach(n=>{n.hasOwnProperty(e)||Object.defineProperty(n,e,{get:()=>{if(!n.content)return null;if(this.state.binary&&Array.isArray(n.content)&&!n.content.length)return[];const{bbox:i}=n;if(n._contentWGS84===void 0&&rEe(i)){const s=this.state.binary?A9(n.content):n.content;n._contentWGS84=s.map(a=>T9(a,i,this.context.viewport))}return n._contentWGS84}})})}}xD.layerName="MVTLayer";xD.defaultProps=Tke;function MP(r,e){if(r.properties&&e)return r.properties[e];if("id"in r)return r.id}function w9(r){return r.properties?.layerName||null}function C9(r){return r!=null&&r!==""}function T9(r,e,t){const n={...r,geometry:{type:r.geometry.type}};return Object.defineProperty(n.geometry,"coordinates",{get:()=>_ke(r.geometry,e,t).coordinates}),n}function Ske({pointCount:r,getBinId:e}){const t=new Map;for(let n=0;n<r;n++){const i=e(n);if(i===null)continue;let s=t.get(String(i));s?s.points.push(n):(s={id:i,index:t.size,points:[n]},t.set(String(i),s))}return Array.from(t.values())}function Eke({bins:r,dimensions:e,target:t}){const n=r.length*e;(!t||t.length<n)&&(t=new Float32Array(n));for(let i=0;i<r.length;i++){const{id:s}=r[i];Array.isArray(s)?t.set(s,i*e):t[i]=s}return t}const Ike=r=>r.length,uq=(r,e)=>{let t=0;for(const n of r)t+=e(n);return t},Pke=(r,e)=>r.length===0?NaN:uq(r,e)/r.length,Bke=(r,e)=>{let t=1/0;for(const n of r){const i=e(n);i<t&&(t=i)}return t},Mke=(r,e)=>{let t=-1/0;for(const n of r){const i=e(n);i>t&&(t=i)}return t},Rke={COUNT:Ike,SUM:uq,MEAN:Pke,MIN:Bke,MAX:Mke};function kke({bins:r,getValue:e,operation:t,target:n}){(!n||n.length<r.length)&&(n=new Float32Array(r.length));let i=1/0,s=-1/0;for(let a=0;a<r.length;a++){const{points:o}=r[a];n[a]=t(o,e),n[a]<i&&(i=n[a]),n[a]>s&&(s=n[a])}return{value:n,domain:[i,s]}}function S9(r,e,t){const n={};for(const s of r.sources||[]){const a=e[s];if(a)n[s]=Oke(a);else throw new Error(`Cannot find attribute ${s}`)}const i={};return s=>{for(const a in n)i[a]=n[a](s);return r.getValue(i,s,t)}}function Oke(r){const e=r.value,{offset:t=0,stride:n,size:i}=r.getAccessor(),s=e.BYTES_PER_ELEMENT,a=t/s,o=n?n/s:i;if(i===1)return r.isConstant?()=>e[0]:f=>{const g=a+o*f;return e[g]};let u;return r.isConstant?(u=Array.from(e),()=>u):(u=new Array(i),f=>{const g=a+o*f;for(let y=0;y<i;y++)u[y]=e[g+y];return u})}class tA{constructor(e){this.bins=[],this.binIds=null,this.results=[],this.dimensions=e.dimensions,this.channelCount=e.getValue.length,this.props={...e,binOptions:{},pointCount:0,operations:[],customOperations:[],attributes:{}},this.needsUpdate=!0,this.setProps(e)}destroy(){}get binCount(){return this.bins.length}setProps(e){const t=this.props;if(e.binOptions&&(Ms(e.binOptions,t.binOptions,2)||this.setNeedsUpdate()),e.operations)for(let n=0;n<this.channelCount;n++)e.operations[n]!==t.operations[n]&&this.setNeedsUpdate(n);if(e.customOperations)for(let n=0;n<this.channelCount;n++)!!e.customOperations[n]!=!!t.customOperations[n]&&this.setNeedsUpdate(n);e.pointCount!==void 0&&e.pointCount!==t.pointCount&&this.setNeedsUpdate(),e.attributes&&(e.attributes={...t.attributes,...e.attributes}),Object.assign(this.props,e)}setNeedsUpdate(e){e===void 0?this.needsUpdate=!0:this.needsUpdate!==!0&&(this.needsUpdate=this.needsUpdate||[],this.needsUpdate[e]=!0)}update(){if(this.needsUpdate===!0){this.bins=Ske({pointCount:this.props.pointCount,getBinId:S9(this.props.getBin,this.props.attributes,this.props.binOptions)});const e=Eke({bins:this.bins,dimensions:this.dimensions,target:this.binIds?.value});this.binIds={value:e,type:"float32",size:this.dimensions}}for(let e=0;e<this.channelCount;e++)if(this.needsUpdate===!0||this.needsUpdate[e]){const t=this.props.customOperations[e]||Rke[this.props.operations[e]],{value:n,domain:i}=kke({bins:this.bins,getValue:S9(this.props.getValue[e],this.props.attributes,void 0),operation:t,target:this.results[e]?.value});this.results[e]={value:n,domain:i,type:"float32",size:1},this.props.onUpdate?.({channel:e})}this.needsUpdate=!1}preDraw(){}getBins(){return this.binIds}getResult(e){return this.results[e]}getResultDomain(e){return this.results[e]?.domain??[1/0,-1/0]}getBin(e){const t=this.bins[e];if(!t)return null;const n=new Array(this.channelCount);for(let i=0;i<n.length;i++){const s=this.results[i];n[i]=s?.value[e]}return{id:t.id,value:n,count:t.points.length,pointIndices:t.points}}}function hq(r,e,t){return r.createFramebuffer({width:e,height:t,colorAttachments:[r.createTexture({width:e,height:t,format:"rgba32float",sampler:{minFilter:"nearest",magFilter:"nearest"}})]})}const Dke=`uniform binSorterUniforms {
  ivec4 binIdRange;
  ivec2 targetSize;
} binSorter;
`,Lke={name:"binSorter",vs:Dke,uniformTypes:{binIdRange:"vec4<i32>",targetSize:"vec2<i32>"}},dq=[1,2,4,8],E9=3e38,Nke={SUM:0,MEAN:0,MIN:0,MAX:0,COUNT:0},zw=1024;class Fke{constructor(e,t){this.binsFBO=null,this.device=e,this.model=zke(e,t)}get texture(){return this.binsFBO?this.binsFBO.colorAttachments[0].texture:null}destroy(){this.model.destroy(),this.binsFBO?.colorAttachments[0].texture.destroy(),this.binsFBO?.destroy()}getBinValues(e){if(!this.binsFBO)return null;const t=e%zw,n=Math.floor(e/zw),i=this.device.readPixelsToArrayWebGL(this.binsFBO,{sourceX:t,sourceY:n,sourceWidth:1,sourceHeight:1}).buffer;return new Float32Array(i)}setDimensions(e,t){const n=zw,i=Math.ceil(e/n);this.binsFBO?this.binsFBO.height<i&&this.binsFBO.resize({width:n,height:i}):this.binsFBO=hq(this.device,n,i);const s={binIdRange:[t[0][0],t[0][1],t[1]?.[0]||0,t[1]?.[1]||0],targetSize:[this.binsFBO.width,this.binsFBO.height]};this.model.shaderInputs.setProps({binSorter:s})}setModelProps(e){const t=this.model;e.attributes&&t.setAttributes(e.attributes),e.constantAttributes&&t.setConstantAttributes(e.constantAttributes),e.vertexCount!==void 0&&t.setVertexCount(e.vertexCount),e.shaderModuleProps&&t.shaderInputs.setProps(e.shaderModuleProps)}update(e){if(!this.binsFBO)return;const t=Uke(e);this._updateBins("SUM",t.SUM+t.MEAN),this._updateBins("MIN",t.MIN),this._updateBins("MAX",t.MAX)}_updateBins(e,t){if(t===0)return;t|=dq[3];const n=this.model,i=this.binsFBO,s=e==="MAX"?-E9:e==="MIN"?E9:0,a=this.device.beginRenderPass({id:`gpu-aggregation-${e}`,framebuffer:i,parameters:{viewport:[0,0,i.width,i.height],colorMask:t},clearColor:[s,s,s,0],clearDepth:!1,clearStencil:!1});n.setParameters({blend:!0,blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one",blendColorOperation:e==="MAX"?"max":e==="MIN"?"min":"add",blendAlphaOperation:"add"}),n.draw(a),a.end()}}function Uke(r){const e={...Nke};for(let t=0;t<r.length;t++){const n=r[t];n&&(e[n]+=dq[t])}return e}function zke(r,e){let t=e.vs;e.dimensions===2&&(t+=`
void getBin(out int binId) {
  ivec2 binId2;
  getBin(binId2);
  if (binId2.x < binSorter.binIdRange.x || binId2.x >= binSorter.binIdRange.y) {
    binId = -1;
  } else {
    binId = (binId2.y - binSorter.binIdRange.z) * (binSorter.binIdRange.y - binSorter.binIdRange.x) + binId2.x;
  }
}
`);const n=`#version 300 es
#define SHADER_NAME gpu-aggregation-sort-bins-vertex

${t}

out vec3 v_Value;

void main() {
  int binIndex;
  getBin(binIndex);
  binIndex = binIndex - binSorter.binIdRange.x;
  if (binIndex < 0) {
    gl_Position = vec4(0.);
    return;
  }
  int row = binIndex / binSorter.targetSize.x;
  int col = binIndex - row * binSorter.targetSize.x;
  vec2 position = (vec2(col, row) + 0.5) / vec2(binSorter.targetSize) * 2.0 - 1.0;
  gl_Position = vec4(position, 0.0, 1.0);
  gl_PointSize = 1.0;

#if NUM_CHANNELS == 3
  getValue(v_Value);
#elif NUM_CHANNELS == 2
  getValue(v_Value.xy);
#else
  getValue(v_Value.x);
#endif
}
`,i=`#version 300 es
#define SHADER_NAME gpu-aggregation-sort-bins-fragment

precision highp float;

in vec3 v_Value;
out vec4 fragColor;

void main() {
  fragColor.xyz = v_Value;

  #ifdef MODULE_GEOMETRY
  geometry.uv = vec2(0.);
  DECKGL_FILTER_COLOR(fragColor, geometry);
  #endif

  fragColor.w = 1.0;
}
`;return new Mi(r,{bufferLayout:e.bufferLayout,modules:[...e.modules||[],Lke],defines:{...e.defines,NON_INSTANCED_MODEL:1,NUM_CHANNELS:e.channelCount},isInstanced:!1,vs:n,fs:i,topology:"point-list",disableWarnings:!0})}const Vke=`uniform aggregatorTransformUniforms {
  ivec4 binIdRange;
  bvec3 isCount;
  bvec3 isMean;
  float naN;
} aggregatorTransform;
`,$ke={name:"aggregatorTransform",vs:Vke,uniformTypes:{binIdRange:"vec4<i32>",isCount:"vec3<f32>",isMean:"vec3<f32>"}};class jke{constructor(e,t){this.binBuffer=null,this.valueBuffer=null,this._domains=null,this.device=e,this.channelCount=t.channelCount,this.transform=Gke(e,t),this.domainFBO=hq(e,2,1)}destroy(){this.transform.destroy(),this.binBuffer?.destroy(),this.valueBuffer?.destroy(),this.domainFBO.colorAttachments[0].texture.destroy(),this.domainFBO.destroy()}get domains(){if(!this._domains){const e=this.device.readPixelsToArrayWebGL(this.domainFBO).buffer,t=new Float32Array(e);this._domains=[[-t[4],t[0]],[-t[5],t[1]],[-t[6],t[2]]].slice(0,this.channelCount)}return this._domains}setDimensions(e,t){const{model:n,transformFeedback:i}=this.transform;n.setVertexCount(e);const s={binIdRange:[t[0][0],t[0][1],t[1]?.[0]||0,t[1]?.[1]||0]};n.shaderInputs.setProps({aggregatorTransform:s});const a=e*t.length*4;(!this.binBuffer||this.binBuffer.byteLength<a)&&(this.binBuffer?.destroy(),this.binBuffer=this.device.createBuffer({byteLength:a}),i.setBuffer("binIds",this.binBuffer));const o=e*this.channelCount*4;(!this.valueBuffer||this.valueBuffer.byteLength<o)&&(this.valueBuffer?.destroy(),this.valueBuffer=this.device.createBuffer({byteLength:o}),i.setBuffer("values",this.valueBuffer))}update(e,t){if(!e)return;const n=this.transform,i=this.domainFBO,s=[0,1,2].map(u=>t[u]==="COUNT"?1:0),a=[0,1,2].map(u=>t[u]==="MEAN"?1:0),o={isCount:s,isMean:a,bins:e};n.model.shaderInputs.setProps({aggregatorTransform:o}),n.run({id:"gpu-aggregation-domain",framebuffer:i,parameters:{viewport:[0,0,2,1]},clearColor:[-3e38,-3e38,-3e38,0],clearDepth:!1,clearStencil:!1}),this._domains=null}}function Gke(r,e){const t=`#version 300 es
#define SHADER_NAME gpu-aggregation-domain-vertex

uniform sampler2D bins;

#if NUM_DIMS == 1
out float binIds;
#else
out vec2 binIds;
#endif

#if NUM_CHANNELS == 1
flat out float values;
#elif NUM_CHANNELS == 2
flat out vec2 values;
#else
flat out vec3 values;
#endif

const float NAN = intBitsToFloat(-1);

void main() {
  int row = gl_VertexID / SAMPLER_WIDTH;
  int col = gl_VertexID - row * SAMPLER_WIDTH;
  vec4 weights = texelFetch(bins, ivec2(col, row), 0);
  vec3 value3 = mix(
    mix(weights.rgb, vec3(weights.a), aggregatorTransform.isCount),
    weights.rgb / max(weights.a, 1.0),
    aggregatorTransform.isMean
  );
  if (weights.a == 0.0) {
    value3 = vec3(NAN);
  }

#if NUM_DIMS == 1
  binIds = float(gl_VertexID + aggregatorTransform.binIdRange.x);
#else
  int y = gl_VertexID / (aggregatorTransform.binIdRange.y - aggregatorTransform.binIdRange.x);
  int x = gl_VertexID - y * (aggregatorTransform.binIdRange.y - aggregatorTransform.binIdRange.x);
  binIds.y = float(y + aggregatorTransform.binIdRange.z);
  binIds.x = float(x + aggregatorTransform.binIdRange.x);
#endif

#if NUM_CHANNELS == 3
  values = value3;
#elif NUM_CHANNELS == 2
  values = value3.xy;
#else
  values = value3.x;
#endif

  gl_Position = vec4(0., 0., 0., 1.);
  // This model renders into a 2x1 texture to obtain min and max simultaneously.
  // See comments in fragment shader
  gl_PointSize = 2.0;
}
`,n=`#version 300 es
#define SHADER_NAME gpu-aggregation-domain-fragment

precision highp float;

#if NUM_CHANNELS == 1
flat in float values;
#elif NUM_CHANNELS == 2
flat in vec2 values;
#else
flat in vec3 values;
#endif

out vec4 fragColor;

void main() {
  vec3 value3;
#if NUM_CHANNELS == 3
  value3 = values;
#elif NUM_CHANNELS == 2
  value3.xy = values;
#else
  value3.x = values;
#endif
  if (isnan(value3.x)) discard;
  // This shader renders into a 2x1 texture with blending=max
  // The left pixel yields the max value of each channel
  // The right pixel yields the min value of each channel
  if (gl_FragCoord.x < 1.0) {
    fragColor = vec4(value3, 1.0);
  } else {
    fragColor = vec4(-value3, 1.0);
  }
}
`;return new sy(r,{vs:t,fs:n,topology:"point-list",modules:[$ke],parameters:{blend:!0,blendColorSrcFactor:"one",blendColorDstFactor:"one",blendColorOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one",blendAlphaOperation:"max"},defines:{NUM_DIMS:e.dimensions,NUM_CHANNELS:e.channelCount,SAMPLER_WIDTH:zw},varyings:["binIds","values"],disableWarnings:!0})}class Zl{static isSupported(e){return e.features.has("float32-renderable-webgl")&&e.features.has("texture-blend-float-webgl")}constructor(e,t){this.binCount=0,this.binIds=null,this.results=[],this.device=e,this.dimensions=t.dimensions,this.channelCount=t.channelCount,this.props={...t,pointCount:0,binIdRange:[[0,0]],operations:[],attributes:{},binOptions:{}},this.needsUpdate=new Array(this.channelCount).fill(!0),this.binSorter=new Fke(e,t),this.aggregationTransform=new jke(e,t),this.setProps(t)}getBins(){const e=this.aggregationTransform.binBuffer;return e?(this.binIds?.buffer!==e&&(this.binIds={buffer:e,type:"float32",size:this.dimensions}),this.binIds):null}getResult(e){const t=this.aggregationTransform.valueBuffer;return!t||e>=this.channelCount?null:(this.results[e]?.buffer!==t&&(this.results[e]={buffer:t,type:"float32",size:1,stride:this.channelCount*4,offset:e*4}),this.results[e])}getResultDomain(e){return this.aggregationTransform.domains[e]}getBin(e){if(e<0||e>=this.binCount)return null;const{binIdRange:t}=this.props;let n;if(this.dimensions===1)n=[e+t[0][0]];else{const[[o,u],[f]]=t,g=u-o;n=[e%g+o,Math.floor(e/g)+f]}const i=this.binSorter.getBinValues(e);if(!i)return null;const s=i[3],a=[];for(let o=0;o<this.channelCount;o++){const u=this.props.operations[o];u==="COUNT"?a[o]=s:s===0?a[o]=NaN:a[o]=u==="MEAN"?i[o]/s:i[o]}return{id:n,value:a,count:s}}destroy(){this.binSorter.destroy(),this.aggregationTransform.destroy()}setProps(e){const t=this.props;if("binIdRange"in e&&!Ms(e.binIdRange,t.binIdRange,2)){const n=e.binIdRange;if(Rr.assert(n.length===this.dimensions),this.dimensions===1){const[[i,s]]=n;this.binCount=s-i}else{const[[i,s],[a,o]]=n;this.binCount=(s-i)*(o-a)}this.binSorter.setDimensions(this.binCount,n),this.aggregationTransform.setDimensions(this.binCount,n),this.setNeedsUpdate()}if(e.operations)for(let n=0;n<this.channelCount;n++)e.operations[n]!==t.operations[n]&&this.setNeedsUpdate(n);if(e.pointCount!==void 0&&e.pointCount!==t.pointCount&&(this.binSorter.setModelProps({vertexCount:e.pointCount}),this.setNeedsUpdate()),e.binOptions&&(Ms(e.binOptions,t.binOptions,2)||this.setNeedsUpdate(),this.binSorter.model.shaderInputs.setProps({binOptions:e.binOptions})),e.attributes){const n={},i={};for(const s of Object.values(e.attributes))for(const[a,o]of Object.entries(s.getValue()))ArrayBuffer.isView(o)?i[a]=o:o&&(n[a]=o);this.binSorter.setModelProps({attributes:n,constantAttributes:i})}e.shaderModuleProps&&this.binSorter.setModelProps({shaderModuleProps:e.shaderModuleProps}),Object.assign(this.props,e)}setNeedsUpdate(e){e===void 0?this.needsUpdate.fill(!0):this.needsUpdate[e]=!0}update(){}preDraw(){if(!this.needsUpdate.some(Boolean))return;const{operations:e}=this.props,t=this.needsUpdate.map((n,i)=>n?e[i]:null);this.binSorter.update(t),this.aggregationTransform.update(this.binSorter.texture,e);for(let n=0;n<this.channelCount;n++)this.needsUpdate[n]&&(this.needsUpdate[n]=!1,this.props.onUpdate?.({channel:n}))}}let rA=class extends Zc{get isDrawable(){return!0}initializeState(){this.getAttributeManager().remove(["instancePickingColors"])}updateState(e){super.updateState(e);const t=this.getAggregatorType();if(e.changeFlags.extensionsChanged||this.state.aggregatorType!==t){this.state.aggregator?.destroy();const n=this.createAggregator(t);return n.setProps({attributes:this.getAttributeManager()?.attributes}),this.setState({aggregator:n,aggregatorType:t}),!0}return!1}finalizeState(e){super.finalizeState(e),this.state.aggregator.destroy()}updateAttributes(e){const{aggregator:t}=this.state;t.setProps({attributes:e});for(const n in e)this.onAttributeChange(n);t.update()}draw({shaderModuleProps:e}){const{aggregator:t}=this.state;t.setProps({shaderModuleProps:e}),t.preDraw()}_getAttributeManager(){return new US(this.context.device,{id:this.props.id,stats:this.context.stats})}};rA.layerName="AggregationLayer";const n2=[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]];function fq(r,e=!1,t=Float32Array){let n;if(Number.isFinite(r[0]))n=new t(r);else{n=new t(r.length*4);let i=0;for(let s=0;s<r.length;s++){const a=r[s];n[i++]=a[0],n[i++]=a[1],n[i++]=a[2],n[i++]=Number.isFinite(a[3])?a[3]:255}}if(e)for(let i=0;i<n.length;i++)n[i]/=255;return n}const aT={linear:"linear",quantile:"nearest",quantize:"nearest",ordinal:"nearest"};function wD(r,e){r.setSampler({minFilter:aT[e],magFilter:aT[e]})}function CD(r,e,t="linear"){const n=fq(e,!1,Uint8Array);return r.createTexture({format:"rgba8unorm",sampler:{minFilter:aT[t],magFilter:aT[t],addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},data:n,width:n.length/4,height:1})}const Hke=`#version 300 es
#define SHADER_NAME screen-grid-layer-vertex-shader
#define RANGE_COUNT 6
in vec2 positions;
in vec2 instancePositions;
in float instanceWeights;
in vec3 instancePickingColors;
uniform sampler2D colorRange;
out vec4 vColor;
vec4 interp(float value, vec2 domain, sampler2D range) {
float r = (value - domain.x) / (domain.y - domain.x);
return texture(range, vec2(r, 0.5));
}
void main(void) {
if (isnan(instanceWeights)) {
gl_Position = vec4(0.);
return;
}
vec2 pos = instancePositions * screenGrid.gridSizeClipspace + positions * screenGrid.cellSizeClipspace;
pos.x = pos.x - 1.0;
pos.y = 1.0 - pos.y;
gl_Position = vec4(pos, 0., 1.);
vColor = interp(instanceWeights, screenGrid.colorDomain, colorRange);
vColor.a *= layer.opacity;
picking_setPickingColor(instancePickingColors);
}
`,Wke=`#version 300 es
#define SHADER_NAME screen-grid-layer-fragment-shader
precision highp float;
in vec4 vColor;
out vec4 fragColor;
void main(void) {
fragColor = vColor;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,Kke=`uniform screenGridUniforms {
  vec2 cellSizeClipspace;
  vec2 gridSizeClipspace;
  vec2 colorDomain;
} screenGrid;
`,Xke={name:"screenGrid",vs:Kke,uniformTypes:{cellSizeClipspace:"vec2<f32>",gridSizeClipspace:"vec2<f32>",colorDomain:"vec2<f32>"}};class pq extends oo{getShaders(){return super.getShaders({vs:Hke,fs:Wke,modules:[Ja,Xke]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:2,type:"float32",accessor:"getBin"},instanceWeights:{size:1,type:"float32",accessor:"getWeight"}}),this.state.model=this._getModel()}updateState(e){super.updateState(e);const{props:t,oldProps:n,changeFlags:i}=e,s=this.state.model;if(n.colorRange!==t.colorRange){this.state.colorTexture?.destroy(),this.state.colorTexture=CD(this.context.device,t.colorRange,t.colorScaleType);const a={colorRange:this.state.colorTexture};s.shaderInputs.setProps({screenGrid:a})}else n.colorScaleType!==t.colorScaleType&&wD(this.state.colorTexture,t.colorScaleType);if(n.cellMarginPixels!==t.cellMarginPixels||n.cellSizePixels!==t.cellSizePixels||i.viewportChanged){const{width:a,height:o}=this.context.viewport,{cellSizePixels:u,cellMarginPixels:f}=this.props,g=Math.max(u-f,0),y={gridSizeClipspace:[u/a*2,u/o*2],cellSizeClipspace:[g/a*2,g/o*2]};s.shaderInputs.setProps({screenGrid:y})}}finalizeState(e){super.finalizeState(e),this.state.colorTexture?.destroy()}draw({uniforms:e}){const t=this.props.colorDomain(),n=this.state.model,i={colorDomain:t};n.shaderInputs.setProps({screenGrid:i}),n.draw(this.context.renderPass)}_getModel(){return new Mi(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new To({topology:"triangle-strip",attributes:{positions:{value:new Float32Array([0,0,1,0,0,1,1,1]),size:2}}}),isInstanced:!0})}}pq.layerName="ScreenGridCellLayer";const Jke=`uniform binOptionsUniforms {
  float cellSizePixels;
} binOptions;
`,qke={name:"binOptions",vs:Jke,uniformTypes:{cellSizePixels:"f32"}},Yke={cellSizePixels:{type:"number",value:100,min:1},cellMarginPixels:{type:"number",value:2,min:0},colorRange:n2,colorScaleType:"linear",getPosition:{type:"accessor",value:r=>r.position},getWeight:{type:"accessor",value:1},gpuAggregation:!0,aggregation:"SUM"};class TD extends rA{getAggregatorType(){return this.props.gpuAggregation&&Zl.isSupported(this.context.device)?"gpu":"cpu"}createAggregator(e){return e==="cpu"||!Zl.isSupported(this.context.device)?new tA({dimensions:2,getBin:{sources:["positions"],getValue:({positions:t},n,i)=>{const s=this.context.viewport,a=s.project(t),o=i.cellSizePixels;return a[0]<0||a[0]>=s.width||a[1]<0||a[1]>=s.height?null:[Math.floor(a[0]/o),Math.floor(a[1]/o)]}},getValue:[{sources:["counts"],getValue:({counts:t})=>t}]}):new Zl(this.context.device,{dimensions:2,channelCount:1,bufferLayout:this.getAttributeManager().getBufferLayouts({isInstanced:!1}),...super.getShaders({modules:[$s,qke],vs:`
  in vec3 positions;
  in vec3 positions64Low;
  in float counts;
  
  void getBin(out ivec2 binId) {
    vec4 pos = project_position_to_clipspace(positions, positions64Low, vec3(0.0));
    vec2 screenCoords = vec2(pos.x / pos.w + 1.0, 1.0 - pos.y / pos.w) / 2.0 * project.viewportSize / project.devicePixelRatio;
    vec2 gridCoords = floor(screenCoords / binOptions.cellSizePixels);
    binId = ivec2(gridCoords);
  }
  void getValue(out float weight) {
    weight = counts;
  }
  `})})}initializeState(){super.initializeState(),this.getAttributeManager().add({positions:{size:3,accessor:"getPosition",type:"float64",fp64:this.use64bitPositions()},counts:{size:1,accessor:"getWeight"}})}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){const t=super.updateState(e),{props:n,oldProps:i,changeFlags:s}=e,{cellSizePixels:a,aggregation:o}=n;if(t||s.dataChanged||s.updateTriggersChanged||s.viewportChanged||o!==i.aggregation||a!==i.cellSizePixels){const{width:u,height:f}=this.context.viewport,{aggregator:g}=this.state;g instanceof Zl&&g.setProps({binIdRange:[[0,Math.ceil(u/a)],[0,Math.ceil(f/a)]]}),g.setProps({pointCount:this.getNumInstances(),operations:[o],binOptions:{cellSizePixels:a}})}return s.viewportChanged&&this.state.aggregator.setNeedsUpdate(),t}onAttributeChange(e){const{aggregator:t}=this.state;switch(e){case"positions":t.setNeedsUpdate();break;case"counts":t.setNeedsUpdate(0);break}}renderLayers(){const{aggregator:e}=this.state,t=this.getSubLayerClass("cells",pq),n=e.getBins(),i=e.getResult(0);return new t(this.props,this.getSubLayerProps({id:"cell-layer"}),{data:{length:e.binCount,attributes:{getBin:n,getWeight:i}},dataComparator:(s,a)=>s.length===a.length,updateTriggers:{getBin:[n],getWeight:[i]},parameters:{depthWriteEnabled:!1,...this.props.parameters},colorDomain:()=>this.props.colorDomain||e.getResultDomain(0),extensions:[]})}getPickingInfo(e){const t=e.info,{index:n}=t;if(n>=0){const i=this.state.aggregator.getBin(n);let s;i&&(s={col:i.id[0],row:i.id[1],value:i.value[0],count:i.count},i.pointIndices&&(s.pointIndices=i.pointIndices,s.points=Array.isArray(this.props.data)?i.pointIndices.map(a=>this.props.data[a]):[])),t.object=s}return t}}TD.layerName="ScreenGridLayer";TD.defaultProps=Yke;class lT{constructor(e,t){this.props={scaleType:"linear",lowerPercentile:0,upperPercentile:100},this.domain=null,this.cutoff=null,this.input=e,this.inputLength=t,this.attribute=e}getScalePercentile(){if(!this._percentile){const e=I9(this.input,this.inputLength);this._percentile=Qke(e)}return this._percentile}getScaleOrdinal(){if(!this._ordinal){const e=I9(this.input,this.inputLength);this._ordinal=Zke(e)}return this._ordinal}getCutoff({scaleType:e,lowerPercentile:t,upperPercentile:n}){if(e==="quantile")return[t,n-1];if(t>0||n<100){const{domain:i}=this.getScalePercentile();let s=i[Math.floor(t)-1]??-1/0,a=i[Math.floor(n)-1]??1/0;if(e==="ordinal"){const{domain:o}=this.getScaleOrdinal();s=o.findIndex(u=>u>=s),a=o.findIndex(u=>u>a)-1,a===-2&&(a=o.length-1)}return[s,a]}return null}update(e){const t=this.props;if(e.scaleType!==t.scaleType)switch(e.scaleType){case"quantile":{const{attribute:n}=this.getScalePercentile();this.attribute=n,this.domain=[0,99];break}case"ordinal":{const{attribute:n,domain:i}=this.getScaleOrdinal();this.attribute=n,this.domain=[0,i.length-1];break}default:this.attribute=this.input,this.domain=null}return(e.scaleType!==t.scaleType||e.lowerPercentile!==t.lowerPercentile||e.upperPercentile!==t.upperPercentile)&&(this.cutoff=this.getCutoff(e)),this.props=e,this}}function Zke(r){const e=new Set;for(const i of r)Number.isFinite(i)&&e.add(i);const t=Array.from(e).sort(),n=new Map;for(let i=0;i<t.length;i++)n.set(t[i],i);return{attribute:{value:r.map(i=>Number.isFinite(i)?n.get(i):NaN),type:"float32",size:1},domain:t}}function Qke(r,e=100){const t=Array.from(r).filter(Number.isFinite).sort(eOe);let n=0;const i=Math.max(1,e),s=new Array(i-1);for(;++n<i;)s[n-1]=tOe(t,n/i);return{attribute:{value:r.map(a=>Number.isFinite(a)?rOe(s,a):NaN),type:"float32",size:1},domain:s}}function I9(r,e){const t=(r.stride??4)/4,n=(r.offset??0)/4;let i=r.value;if(!i){const a=r.buffer?.readSyncWebGL(0,t*4*e);a&&(i=new Float32Array(a.buffer),r.value=i)}if(t===1)return i.subarray(0,e);const s=new Float32Array(e);for(let a=0;a<e;a++)s[a]=i[a*t+n];return s}function eOe(r,e){return r-e}function tOe(r,e){const t=r.length;if(e<=0||t<2)return r[0];if(e>=1)return r[t-1];const n=(t-1)*e,i=Math.floor(n),s=r[i],a=r[i+1];return s+(a-s)*(n-i)}function rOe(r,e){let t=0,n=r.length;for(;t<n;){const i=t+n>>>1;r[i]>e?n=i:t=i+1}return t}function SD({dataBounds:r,getBinId:e,padding:t=0}){const n=[r[0],r[1],[r[0][0],r[1][1]],[r[1][0],r[0][1]]].map(u=>e(u)),i=Math.min(...n.map(u=>u[0]))-t,s=Math.min(...n.map(u=>u[1]))-t,a=Math.max(...n.map(u=>u[0]))+t+1,o=Math.max(...n.map(u=>u[1]))+t+1;return[[i,a],[s,o]]}const gq=Math.PI/3,i2=2*Math.sin(gq),s2=1.5,nOe=Array.from({length:6},(r,e)=>{const t=e*gq;return[Math.sin(t),-Math.cos(t)]});function RP([r,e],t){let n=Math.round(e=e/t/s2),i=Math.round(r=r/t/i2-(n&1)/2);const s=e-n;if(Math.abs(s)*3>1){const a=r-i,o=i+(r<i?-1:1)/2,u=n+(e<n?-1:1),f=r-o,g=e-u;a*a+s*s>f*f+g*g&&(i=o+(n&1?1:-1)/2,n=u)}return[i,n]}const iOe=`
const vec2 DIST = vec2(${i2}, ${s2});

ivec2 pointToHexbin(vec2 p, float radius) {
  p /= radius * DIST;
  float pj = round(p.y);
  float pjm2 = mod(pj, 2.0);
  p.x -= pjm2 * 0.5;
  float pi = round(p.x);
  vec2 d1 = p - vec2(pi, pj);

  if (abs(d1.y) * 3. > 1.) {
    vec2 v2 = step(0.0, d1) - 0.5;
    v2.y *= 2.0;
    vec2 d2 = d1 - v2;
    if (dot(d1, d1) > dot(d2, d2)) {
      pi += v2.x + pjm2 - 0.5;
      pj += v2.y;
    }
  }
  return ivec2(pi, pj);
}
`;function P9([r,e],t){return[(r+(e&1)/2)*t*i2,e*t*s2]}const sOe=`
const vec2 DIST = vec2(${i2}, ${s2});

vec2 hexbinCentroid(vec2 binId, float radius) {
  binId.x += fract(binId.y * 0.5);
  return binId * DIST * radius;
}
`,oOe=`#version 300 es
#define SHADER_NAME hexagon-cell-layer-vertex-shader
in vec3 positions;
in vec3 normals;
in vec2 instancePositions;
in float instanceElevationValues;
in float instanceColorValues;
in vec3 instancePickingColors;
uniform sampler2D colorRange;
out vec4 vColor;
${sOe}
float interp(float value, vec2 domain, vec2 range) {
float r = min(max((value - domain.x) / (domain.y - domain.x), 0.), 1.);
return mix(range.x, range.y, r);
}
vec4 interp(float value, vec2 domain, sampler2D range) {
float r = (value - domain.x) / (domain.y - domain.x);
return texture(range, vec2(r, 0.5));
}
void main(void) {
geometry.pickingColor = instancePickingColors;
if (isnan(instanceColorValues) ||
instanceColorValues < hexagon.colorDomain.z ||
instanceColorValues > hexagon.colorDomain.w ||
instanceElevationValues < hexagon.elevationDomain.z ||
instanceElevationValues > hexagon.elevationDomain.w
) {
gl_Position = vec4(0.);
return;
}
vec2 commonPosition = hexbinCentroid(instancePositions, column.radius) + (hexagon.originCommon - project.commonOrigin.xy);
commonPosition += positions.xy * column.radius * column.coverage;
geometry.position = vec4(commonPosition, 0.0, 1.0);
geometry.normal = project_normal(normals);
float elevation = 0.0;
if (column.extruded) {
elevation = interp(instanceElevationValues, hexagon.elevationDomain.xy, hexagon.elevationRange);
elevation = project_size(elevation);
geometry.position.z = (positions.z + 1.0) / 2.0 * elevation;
}
gl_Position = project_common_position_to_clipspace(geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vColor = interp(instanceColorValues, hexagon.colorDomain.xy, colorRange);
vColor.a *= layer.opacity;
if (column.extruded) {
vColor.rgb = lighting_getLightColor(vColor.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,aOe=`uniform hexagonUniforms {
  vec4 colorDomain;
  vec4 elevationDomain;
  vec2 elevationRange;
  vec2 originCommon;
} hexagon;
`,lOe={name:"hexagon",vs:aOe,uniformTypes:{colorDomain:"vec4<f32>",elevationDomain:"vec4<f32>",elevationRange:"vec2<f32>",originCommon:"vec2<f32>"}};class mq extends Ry{getShaders(){const e=super.getShaders();return e.modules.push(lOe),{...e,vs:oOe}}initializeState(){super.initializeState();const e=this.getAttributeManager();e.remove(["instanceElevations","instanceFillColors","instanceLineColors","instanceStrokeWidths"]),e.addInstanced({instancePositions:{size:2,type:"float32",accessor:"getBin"},instanceColorValues:{size:1,type:"float32",accessor:"getColorValue"},instanceElevationValues:{size:1,type:"float32",accessor:"getElevationValue"}})}updateState(e){super.updateState(e);const{props:t,oldProps:n}=e,i=this.state.fillModel;if(n.colorRange!==t.colorRange){this.state.colorTexture?.destroy(),this.state.colorTexture=CD(this.context.device,t.colorRange,t.colorScaleType);const s={colorRange:this.state.colorTexture};i.shaderInputs.setProps({hexagon:s})}else n.colorScaleType!==t.colorScaleType&&wD(this.state.colorTexture,t.colorScaleType)}finalizeState(e){super.finalizeState(e),this.state.colorTexture?.destroy()}draw({uniforms:e}){const{radius:t,hexOriginCommon:n,elevationRange:i,elevationScale:s,extruded:a,coverage:o,colorDomain:u,elevationDomain:f}=this.props,g=this.props.colorCutoff||[-1/0,1/0],y=this.props.elevationCutoff||[-1/0,1/0],A=this.state.fillModel;A.vertexArray.indexBuffer&&A.setIndexBuffer(null),A.setVertexCount(this.state.fillVertexCount);const C={colorDomain:[Math.max(u[0],g[0]),Math.min(u[1],g[1]),Math.max(u[0]-1,g[0]),Math.min(u[1]+1,g[1])],elevationDomain:[Math.max(f[0],y[0]),Math.min(f[1],y[1]),Math.max(f[0]-1,y[0]),Math.min(f[1]+1,y[1])],elevationRange:[i[0]*s,i[1]*s],originCommon:n};A.shaderInputs.setProps({column:{extruded:a,coverage:o,radius:t},hexagon:C}),A.draw(this.context.renderPass)}}mq.layerName="HexagonCellLayer";const cOe=`uniform binOptionsUniforms {
  vec2 hexOriginCommon;
  float radiusCommon;
} binOptions;
`,uOe={name:"binOptions",vs:cOe,uniformTypes:{hexOriginCommon:"vec2<f32>",radiusCommon:"f32"}};function B9(){}const hOe={gpuAggregation:!0,colorDomain:null,colorRange:n2,getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",lowerPercentile:{type:"number",min:0,max:100,value:0},upperPercentile:{type:"number",min:0,max:100,value:100},colorScaleType:"quantize",onSetColorDomain:B9,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationScale:{type:"number",min:0,value:1},elevationLowerPercentile:{type:"number",min:0,max:100,value:0},elevationUpperPercentile:{type:"number",min:0,max:100,value:100},elevationScaleType:"linear",onSetElevationDomain:B9,radius:{type:"number",min:1,value:1e3},coverage:{type:"number",min:0,max:1,value:1},getPosition:{type:"accessor",value:r=>r.position},hexagonAggregator:{type:"function",optional:!0,value:null},extruded:!1,material:!0};class ED extends rA{getAggregatorType(){const{gpuAggregation:e,hexagonAggregator:t,getColorValue:n,getElevationValue:i}=this.props;return e&&(t||n||i)?(Rr.warn("Features not supported by GPU aggregation, falling back to CPU")(),"cpu"):e&&Zl.isSupported(this.context.device)?"gpu":"cpu"}createAggregator(e){if(e==="cpu"){const{hexagonAggregator:t,radius:n}=this.props;return new tA({dimensions:2,getBin:{sources:["positions"],getValue:({positions:i},s,a)=>{if(t)return t(i,n);const u=this.state.aggregatorViewport.projectPosition(i),{radiusCommon:f,hexOriginCommon:g}=a;return RP([u[0]-g[0],u[1]-g[1]],f)}},getValue:[{sources:["colorWeights"],getValue:({colorWeights:i})=>i},{sources:["elevationWeights"],getValue:({elevationWeights:i})=>i}]})}return new Zl(this.context.device,{dimensions:2,channelCount:2,bufferLayout:this.getAttributeManager().getBufferLayouts({isInstanced:!1}),...super.getShaders({modules:[$s,uOe],vs:`
  in vec3 positions;
  in vec3 positions64Low;
  in float colorWeights;
  in float elevationWeights;
  
  ${iOe}

  void getBin(out ivec2 binId) {
    vec3 positionCommon = project_position(positions, positions64Low);
    binId = pointToHexbin(positionCommon.xy, binOptions.radiusCommon);
  }
  void getValue(out vec2 value) {
    value = vec2(colorWeights, elevationWeights);
  }
  `})})}initializeState(){super.initializeState(),this.getAttributeManager().add({positions:{size:3,accessor:"getPosition",type:"float64",fp64:this.use64bitPositions()},colorWeights:{size:1,accessor:"getColorWeight"},elevationWeights:{size:1,accessor:"getElevationWeight"}})}updateState(e){const t=super.updateState(e),{props:n,oldProps:i,changeFlags:s}=e,{aggregator:a}=this.state;if((s.dataChanged||!this.state.dataAsArray)&&(n.getColorValue||n.getElevationValue)&&(this.state.dataAsArray=Array.from(Sd(n.data).iterable)),t||s.dataChanged||n.radius!==i.radius||n.getColorValue!==i.getColorValue||n.getElevationValue!==i.getElevationValue||n.colorAggregation!==i.colorAggregation||n.elevationAggregation!==i.elevationAggregation){this._updateBinOptions();const{radiusCommon:o,hexOriginCommon:u,binIdRange:f,dataAsArray:g}=this.state;if(a.setProps({binIdRange:f,pointCount:this.getNumInstances(),operations:[n.colorAggregation,n.elevationAggregation],binOptions:{radiusCommon:o,hexOriginCommon:u},onUpdate:this._onAggregationUpdate.bind(this)}),g){const{getColorValue:y,getElevationValue:A}=this.props;a.setProps({customOperations:[y&&(C=>y(C.map(M=>g[M]),{indices:C,data:n.data})),A&&(C=>A(C.map(M=>g[M]),{indices:C,data:n.data}))]})}}return s.updateTriggersChanged&&s.updateTriggersChanged.getColorValue&&a.setNeedsUpdate(0),s.updateTriggersChanged&&s.updateTriggersChanged.getElevationValue&&a.setNeedsUpdate(1),t}_updateBinOptions(){const e=this.getBounds();let t=1,n=[0,0],i=[[0,1],[0,1]],s=this.context.viewport;if(e&&Number.isFinite(e[0][0])){let a=[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2];const{radius:o}=this.props,{unitsPerMeter:u}=s.getDistanceScales(a);t=u[0]*o;const f=RP(s.projectFlat(a),t);a=s.unprojectFlat(P9(f,t));const g=s.constructor;s=s.isGeospatial?new g({longitude:a[0],latitude:a[1],zoom:12}):new nh({position:[a[0],a[1],0],zoom:12}),n=[Math.fround(s.center[0]),Math.fround(s.center[1])],i=SD({dataBounds:e,getBinId:y=>{const A=s.projectFlat(y);return A[0]-=n[0],A[1]-=n[1],RP(A,t)},padding:1})}this.setState({radiusCommon:t,hexOriginCommon:n,binIdRange:i,aggregatorViewport:s})}draw(e){e.shaderModuleProps.project&&(e.shaderModuleProps.project.viewport=this.state.aggregatorViewport),super.draw(e)}_onAggregationUpdate({channel:e}){const t=this.getCurrentLayer().props,{aggregator:n}=this.state;if(e===0){const i=n.getResult(0);this.setState({colors:new lT(i,n.binCount)}),t.onSetColorDomain(n.getResultDomain(0))}else if(e===1){const i=n.getResult(1);this.setState({elevations:new lT(i,n.binCount)}),t.onSetElevationDomain(n.getResultDomain(1))}}onAttributeChange(e){const{aggregator:t}=this.state;switch(e){case"positions":t.setNeedsUpdate(),this._updateBinOptions();const{radiusCommon:n,hexOriginCommon:i,binIdRange:s}=this.state;t.setProps({binIdRange:s,binOptions:{radiusCommon:n,hexOriginCommon:i}});break;case"colorWeights":t.setNeedsUpdate(0);break;case"elevationWeights":t.setNeedsUpdate(1);break}}renderLayers(){const{aggregator:e,radiusCommon:t,hexOriginCommon:n}=this.state,{elevationScale:i,colorRange:s,elevationRange:a,extruded:o,coverage:u,material:f,transitions:g,colorScaleType:y,lowerPercentile:A,upperPercentile:C,colorDomain:M,elevationScaleType:k,elevationLowerPercentile:D,elevationUpperPercentile:V,elevationDomain:W}=this.props,z=this.getSubLayerClass("cells",mq),$=e.getBins(),te=this.state.colors?.update({scaleType:y,lowerPercentile:A,upperPercentile:C}),le=this.state.elevations?.update({scaleType:k,lowerPercentile:D,upperPercentile:V});return!te||!le?null:new z(this.getSubLayerProps({id:"cells"}),{data:{length:e.binCount,attributes:{getBin:$,getColorValue:te.attribute,getElevationValue:le.attribute}},dataComparator:(_e,se)=>_e.length===se.length,updateTriggers:{getBin:[$],getColorValue:[te.attribute],getElevationValue:[le.attribute]},diskResolution:6,vertices:nOe,radius:t,hexOriginCommon:n,elevationScale:i,colorRange:s,colorScaleType:y,elevationRange:a,extruded:o,coverage:u,material:f,colorDomain:te.domain||M||e.getResultDomain(0),elevationDomain:le.domain||W||e.getResultDomain(1),colorCutoff:te.cutoff,elevationCutoff:le.cutoff,transitions:g&&{getFillColor:g.getColorValue||g.getColorWeight,getElevation:g.getElevationValue||g.getElevationWeight},extensions:[]})}getPickingInfo(e){const t=e.info,{index:n}=t;if(n>=0){const i=this.state.aggregator.getBin(n);let s;if(i){const a=P9(i.id,this.state.radiusCommon),o=this.context.viewport.unprojectFlat(a);s={col:i.id[0],row:i.id[1],position:o,colorValue:i.value[0],elevationValue:i.value[1],count:i.count},i.pointIndices&&(s.pointIndices=i.pointIndices,s.points=Array.isArray(this.props.data)?i.pointIndices.map(u=>this.props.data[u]):[])}t.object=s}return t}}ED.layerName="HexagonLayer";ED.defaultProps=hOe;const qt=.5,ur=1/6,ut={N:[0,qt],E:[qt,0],S:[0,-qt],W:[-qt,0],NE:[qt,qt],NW:[-qt,qt],SE:[qt,-qt],SW:[-qt,-qt]},Vg=[ut.W,ut.SW,ut.S],$g=[ut.S,ut.SE,ut.E],jg=[ut.E,ut.NE,ut.N],Gg=[ut.NW,ut.W,ut.N],Hg=[[-qt,ur],[-qt,-ur],[-ur,-qt],[ur,-qt]],Wg=[[-ur,-qt],[ur,-qt],[qt,-ur],[qt,ur]],Kg=[[qt,-ur],[qt,ur],[ur,qt],[-ur,qt]],Xg=[[-qt,ur],[-qt,-ur],[ur,qt],[-ur,qt]],M9=[ut.W,ut.SW,ut.SE,ut.E],R9=[ut.S,ut.SE,ut.NE,ut.N],k9=[ut.NW,ut.W,ut.E,ut.NE],O9=[ut.NW,ut.SW,ut.S,ut.N],D9=[[-qt,ur],[-qt,-ur],[qt,-ur],[qt,ur]],L9=[[-ur,-qt],[ur,-qt],[ur,qt],[-ur,qt]],dOe=[ut.NW,ut.SW,ut.SE,ut.NE],N9=[ut.NW,ut.SW,ut.SE,ut.E,ut.N],F9=[ut.W,ut.SW,ut.SE,ut.NE,ut.N],U9=[ut.NW,ut.W,ut.S,ut.SE,ut.NE],z9=[ut.NW,ut.SW,ut.S,ut.E,ut.NE],V9=[ut.NW,ut.W,[qt,-ur],[qt,ur],ut.N],$9=[[-ur,-qt],[ur,-qt],ut.E,ut.NE,ut.N],j9=[[-qt,ur],[-qt,-ur],ut.S,ut.SE,ut.E],G9=[ut.W,ut.SW,ut.S,[ur,qt],[-ur,qt]],H9=[ut.NW,ut.W,[-ur,-qt],[ur,-qt],ut.N],W9=[[-qt,ur],[-qt,-ur],ut.E,ut.NE,ut.N],K9=[ut.S,ut.SE,ut.E,[ur,qt],[-ur,qt]],X9=[ut.W,ut.SW,ut.S,[qt,-ur],[qt,ur]],J9=[ut.W,ut.SW,ut.SE,ut.E,[ur,qt],[-ur,qt]],q9=[[-qt,ur],[-qt,-ur],ut.S,ut.SE,ut.NE,ut.N],Y9=[ut.NW,ut.W,[-ur,-qt],[ur,-qt],ut.E,ut.NE],Z9=[ut.NW,ut.SW,ut.S,[qt,-ur],[qt,ur],ut.N],Jg=[ut.W,ut.SW,ut.S,ut.E,ut.NE,ut.N],qg=[ut.NW,ut.W,ut.S,ut.SE,ut.E,ut.N],Ix=[[-qt,ur],[-qt,-ur],[-ur,-qt],[ur,-qt],ut.E,ut.NE,ut.N],Px=[ut.W,ut.SW,ut.S,[qt,-ur],[qt,ur],[ur,qt],[-ur,qt]],Bx=[ut.NW,ut.W,[-ur,-qt],[ur,-qt],[qt,-ur],[qt,ur],ut.N],Mx=[[-qt,ur],[-qt,-ur],ut.S,ut.SE,ut.E,[ur,qt],[-ur,qt]],Q9=[[-qt,ur],[-qt,-ur],[-ur,-qt],[ur,-qt],[qt,-ur],[qt,ur],[ur,qt],[-ur,qt]],fOe={0:[],1:[[ut.W,ut.S]],2:[[ut.S,ut.E]],3:[[ut.W,ut.E]],4:[[ut.N,ut.E]],5:{0:[[ut.W,ut.S],[ut.N,ut.E]],1:[[ut.W,ut.N],[ut.S,ut.E]]},6:[[ut.N,ut.S]],7:[[ut.W,ut.N]],8:[[ut.W,ut.N]],9:[[ut.N,ut.S]],10:{0:[[ut.W,ut.N],[ut.S,ut.E]],1:[[ut.W,ut.S],[ut.N,ut.E]]},11:[[ut.N,ut.E]],12:[[ut.W,ut.E]],13:[[ut.S,ut.E]],14:[[ut.W,ut.S]],15:[]};function tr(r){return parseInt(r,4)}const pOe={[tr("0000")]:[],[tr("2222")]:[],[tr("2221")]:[Vg],[tr("2212")]:[$g],[tr("2122")]:[jg],[tr("1222")]:[Gg],[tr("0001")]:[Vg],[tr("0010")]:[$g],[tr("0100")]:[jg],[tr("1000")]:[Gg],[tr("2220")]:[Hg],[tr("2202")]:[Wg],[tr("2022")]:[Kg],[tr("0222")]:[Xg],[tr("0002")]:[Hg],[tr("0020")]:[Wg],[tr("0200")]:[Kg],[tr("2000")]:[Xg],[tr("0011")]:[M9],[tr("0110")]:[R9],[tr("1100")]:[k9],[tr("1001")]:[O9],[tr("2211")]:[M9],[tr("2112")]:[R9],[tr("1122")]:[k9],[tr("1221")]:[O9],[tr("2200")]:[D9],[tr("2002")]:[L9],[tr("0022")]:[D9],[tr("0220")]:[L9],[tr("1111")]:[dOe],[tr("1211")]:[N9],[tr("2111")]:[F9],[tr("1112")]:[U9],[tr("1121")]:[z9],[tr("1011")]:[N9],[tr("0111")]:[F9],[tr("1110")]:[U9],[tr("1101")]:[z9],[tr("1200")]:[V9],[tr("0120")]:[$9],[tr("0012")]:[j9],[tr("2001")]:[G9],[tr("1022")]:[V9],[tr("2102")]:[$9],[tr("2210")]:[j9],[tr("0221")]:[G9],[tr("1002")]:[H9],[tr("2100")]:[W9],[tr("0210")]:[K9],[tr("0021")]:[X9],[tr("1220")]:[H9],[tr("0122")]:[W9],[tr("2012")]:[K9],[tr("2201")]:[X9],[tr("0211")]:[J9],[tr("2110")]:[q9],[tr("1102")]:[Y9],[tr("1021")]:[Z9],[tr("2011")]:[J9],[tr("0112")]:[q9],[tr("1120")]:[Y9],[tr("1201")]:[Z9],[tr("2101")]:[Jg],[tr("0121")]:[Jg],[tr("1012")]:[qg],[tr("1210")]:[qg],[tr("0101")]:{0:[Vg,jg],1:[Jg],2:[Jg]},[tr("1010")]:{0:[Gg,$g],1:[qg],2:[qg]},[tr("2121")]:{0:[Jg],1:[Jg],2:[Vg,jg]},[tr("1212")]:{0:[qg],1:[qg],2:[Gg,$g]},[tr("2120")]:{0:[Ix],1:[Ix],2:[Hg,jg]},[tr("2021")]:{0:[Px],1:[Px],2:[Vg,Kg]},[tr("1202")]:{0:[Bx],1:[Bx],2:[Gg,Wg]},[tr("0212")]:{0:[Mx],1:[Mx],2:[$g,Xg]},[tr("0102")]:{0:[Hg,jg],1:[Ix],2:[Ix]},[tr("0201")]:{0:[Vg,Kg],1:[Px],2:[Px]},[tr("1020")]:{0:[Gg,Wg],1:[Bx],2:[Bx]},[tr("2010")]:{0:[$g,Xg],1:[Mx],2:[Mx]},[tr("2020")]:{0:[Xg,Wg],1:[Q9],2:[Hg,Kg]},[tr("0202")]:{0:[Kg,Hg],1:[Q9],2:[Xg,Wg]}};function l0(r,e){return Number.isNaN(r)?0:Array.isArray(e)?r<e[0]?0:r<e[1]?1:2:r>=e?1:0}function gOe(r){const{x:e,y:t,xRange:n,yRange:i,getValue:s,threshold:a}=r,o=e<n[0],u=e>=n[1]-1,f=t<i[0],g=t>=i[1]-1,y=o||u||f||g;let A=0,C,M,k,D;if(o||g)k=0;else{const z=s(e,t+1);k=l0(z,a),A+=z}if(u||g)D=0;else{const z=s(e+1,t+1);D=l0(z,a),A+=z}if(u||f)M=0;else{const z=s(e+1,t);M=l0(z,a),A+=z}if(o||f)C=0;else{const z=s(e,t);C=l0(z,a),A+=z}let V=-1;Number.isFinite(a)&&(V=k<<3|D<<2|M<<1|C),Array.isArray(a)&&(V=k<<6|D<<4|M<<2|C);let W=0;return y||(W=l0(A/4,a)),{code:V,meanCode:W}}function mOe(r){const{x:e,y:t,z:n,code:i,meanCode:s}=r;let a=pOe[i];Array.isArray(a)||(a=a[s]);const o=e+1,u=t+1,f=[];return a.forEach(g=>{const y=[];g.forEach(A=>{const C=o+A[0],M=u+A[1];y.push([C,M,n])}),f.push(y)}),f}function yOe(r){const{x:e,y:t,z:n,code:i,meanCode:s}=r;let a=fOe[i];Array.isArray(a)||(a=a[s]);const o=e+1,u=t+1,f=[];return a.forEach(g=>{g.forEach(y=>{const A=o+y[0],C=u+y[1];f.push([A,C,n])})}),f}function bOe({contours:r,getValue:e,xRange:t,yRange:n}){const i=[],s=[];let a=0,o=0;for(let u=0;u<r.length;u++){const f=r[u],g=f.zIndex??u,{threshold:y}=f;for(let A=t[0]-1;A<t[1];A++)for(let C=n[0]-1;C<n[1];C++){const{code:M,meanCode:k}=gOe({getValue:e,threshold:y,x:A,y:C,xRange:t,yRange:n}),D={x:A,y:C,z:g,code:M,meanCode:k};if(Array.isArray(y)){const V=mOe(D);for(const W of V)s[o++]={vertices:W,contour:f}}else{const V=yOe(D);V.length>0&&(i[a++]={vertices:V,contour:f})}}}return{lines:i,polygons:s}}function _Oe(r){const{aggregator:e,binIdRange:t,channel:n}=r;if(e instanceof Zl){const i=e.getResult(n)?.buffer;if(i){const s=new Float32Array(i.readSyncWebGL().buffer);return vOe(s,t)}}if(e instanceof tA){const i=e.getResult(n)?.value,s=e.getBins()?.value;if(s&&i)return AOe(i,s,e.binCount)}return null}function vOe(r,e){const[[t,n],[i,s]]=e,a=n-t,o=s-i;return(u,f)=>(u-=t,f-=i,u<0||u>=a||f<0||f>=o?NaN:r[f*a+u])}function AOe(r,e,t){const n={};for(let i=0;i<t;i++){const s=e[i*2],a=e[i*2+1];n[s]=n[s]||{},n[s][a]=r[i]}return(i,s)=>n[i]?.[s]??NaN}const xOe=`uniform binOptionsUniforms {
  vec2 cellOriginCommon;
  vec2 cellSizeCommon;
} binOptions;
`,wOe={name:"binOptions",vs:xOe,uniformTypes:{cellOriginCommon:"vec2<f32>",cellSizeCommon:"vec2<f32>"}},ez=[255,255,255,255],COe=1,TOe={cellSize:{type:"number",min:1,value:1e3},gridOrigin:{type:"array",compare:!0,value:[0,0]},getPosition:{type:"accessor",value:r=>r.position},getWeight:{type:"accessor",value:1},gpuAggregation:!0,aggregation:"SUM",contours:{type:"object",value:[{threshold:1}],optional:!0,compare:3},zOffset:.005};let ID=class extends rA{getAggregatorType(){return this.props.gpuAggregation&&Zl.isSupported(this.context.device)?"gpu":"cpu"}createAggregator(e){return e==="cpu"?new tA({dimensions:2,getBin:{sources:["positions"],getValue:({positions:t},n,i)=>{const a=this.state.aggregatorViewport.projectPosition(t),{cellSizeCommon:o,cellOriginCommon:u}=i;return[Math.floor((a[0]-u[0])/o[0]),Math.floor((a[1]-u[1])/o[1])]}},getValue:[{sources:["counts"],getValue:({counts:t})=>t}],onUpdate:this._onAggregationUpdate.bind(this)}):new Zl(this.context.device,{dimensions:2,channelCount:1,bufferLayout:this.getAttributeManager().getBufferLayouts({isInstanced:!1}),...super.getShaders({modules:[$s,wOe],vs:`
  in vec3 positions;
  in vec3 positions64Low;
  in float counts;

  void getBin(out ivec2 binId) {
    vec3 positionCommon = project_position(positions, positions64Low);
    vec2 gridCoords = floor(positionCommon.xy / binOptions.cellSizeCommon);
    binId = ivec2(gridCoords);
  }
  void getValue(out float value) {
    value = counts;
  }
  `}),onUpdate:this._onAggregationUpdate.bind(this)})}initializeState(){super.initializeState(),this.getAttributeManager().add({positions:{size:3,accessor:"getPosition",type:"float64",fp64:this.use64bitPositions()},counts:{size:1,accessor:"getWeight"}})}updateState(e){const t=super.updateState(e),{props:n,oldProps:i,changeFlags:s}=e,{aggregator:a}=this.state;if(t||s.dataChanged||n.cellSize!==i.cellSize||!Ms(n.gridOrigin,i.gridOrigin,1)||n.aggregation!==i.aggregation){this._updateBinOptions();const{cellSizeCommon:o,cellOriginCommon:u,binIdRange:f}=this.state;a.setProps({binIdRange:f,pointCount:this.getNumInstances(),operations:[n.aggregation],binOptions:{cellSizeCommon:o,cellOriginCommon:u}})}return Ms(i.contours,n.contours,2)||this.setState({contourData:null}),t}_updateBinOptions(){const e=this.getBounds(),t=[1,1];let n=[0,0],i=[[0,1],[0,1]],s=this.context.viewport;if(e&&Number.isFinite(e[0][0])){let a=[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2];const{cellSize:o,gridOrigin:u}=this.props,{unitsPerMeter:f}=s.getDistanceScales(a);t[0]=f[0]*o,t[1]=f[1]*o;const g=s.projectFlat(a);n=[Math.floor((g[0]-u[0])/t[0])*t[0]+u[0],Math.floor((g[1]-u[1])/t[1])*t[1]+u[1]],a=s.unprojectFlat(n);const y=s.constructor;s=s.isGeospatial?new y({longitude:a[0],latitude:a[1],zoom:12}):new nh({position:[a[0],a[1],0],zoom:12}),n=[Math.fround(s.center[0]),Math.fround(s.center[1])],i=SD({dataBounds:e,getBinId:A=>{const C=s.projectFlat(A);return[Math.floor((C[0]-n[0])/t[0]),Math.floor((C[1]-n[1])/t[1])]}})}this.setState({cellSizeCommon:t,cellOriginCommon:n,binIdRange:i,aggregatorViewport:s})}draw(e){e.shaderModuleProps.project&&(e.shaderModuleProps.project.viewport=this.state.aggregatorViewport),super.draw(e)}_onAggregationUpdate(){const{aggregator:e,binIdRange:t}=this.state;this.setState({aggregatedValueReader:_Oe({aggregator:e,binIdRange:t,channel:0}),contourData:null})}_getContours(){const{aggregatedValueReader:e}=this.state;if(!e)return null;if(!this.state.contourData){const{binIdRange:t}=this.state,{contours:n}=this.props,i=bOe({contours:n,getValue:e,xRange:t[0],yRange:t[1]});this.state.contourData=i}return this.state.contourData}onAttributeChange(e){const{aggregator:t}=this.state;switch(e){case"positions":t.setNeedsUpdate(),this._updateBinOptions();const{cellSizeCommon:n,cellOriginCommon:i,binIdRange:s}=this.state;t.setProps({binIdRange:s,binOptions:{cellSizeCommon:n,cellOriginCommon:i}});break;case"counts":t.setNeedsUpdate(0);break}}renderLayers(){const e=this._getContours();if(!e)return null;const{lines:t,polygons:n}=e,{zOffset:i}=this.props,{cellOriginCommon:s,cellSizeCommon:a}=this.state,o=this.getSubLayerClass("lines",xp),u=this.getSubLayerClass("bands",ky),f=new $r().translate([s[0],s[1],0]).scale([a[0],a[1],i]),g=t&&t.length>0&&new o(this.getSubLayerProps({id:"lines"}),{data:t,coordinateSystem:Pr.CARTESIAN,modelMatrix:f,getPath:A=>A.vertices,getColor:A=>A.contour.color??ez,getWidth:A=>A.contour.strokeWidth??COe,widthUnits:"pixels"}),y=n&&n.length>0&&new u(this.getSubLayerProps({id:"bands"}),{data:n,coordinateSystem:Pr.CARTESIAN,modelMatrix:f,getPolygon:A=>A.vertices,getFillColor:A=>A.contour.color??ez});return[g,y]}getPickingInfo(e){const t=e.info,{object:n}=t;return n&&(t.object={contour:n.contour}),t}};ID.layerName="ContourLayer";ID.defaultProps=TOe;const SOe=`#version 300 es
#define SHADER_NAME grid-cell-layer-vertex-shader
in vec3 positions;
in vec3 normals;
in vec2 instancePositions;
in float instanceElevationValues;
in float instanceColorValues;
in vec3 instancePickingColors;
uniform sampler2D colorRange;
out vec4 vColor;
float interp(float value, vec2 domain, vec2 range) {
float r = min(max((value - domain.x) / (domain.y - domain.x), 0.), 1.);
return mix(range.x, range.y, r);
}
vec4 interp(float value, vec2 domain, sampler2D range) {
float r = (value - domain.x) / (domain.y - domain.x);
return texture(range, vec2(r, 0.5));
}
void main(void) {
geometry.pickingColor = instancePickingColors;
if (isnan(instanceColorValues) ||
instanceColorValues < grid.colorDomain.z ||
instanceColorValues > grid.colorDomain.w ||
instanceElevationValues < grid.elevationDomain.z ||
instanceElevationValues > grid.elevationDomain.w
) {
gl_Position = vec4(0.);
return;
}
vec2 commonPosition = (instancePositions + (positions.xy + 1.0) / 2.0 * column.coverage) * grid.sizeCommon + grid.originCommon - project.commonOrigin.xy;
geometry.position = vec4(commonPosition, 0.0, 1.0);
geometry.normal = project_normal(normals);
float elevation = 0.0;
if (column.extruded) {
elevation = interp(instanceElevationValues, grid.elevationDomain.xy, grid.elevationRange);
elevation = project_size(elevation);
geometry.position.z = (positions.z + 1.0) / 2.0 * elevation;
}
gl_Position = project_common_position_to_clipspace(geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vColor = interp(instanceColorValues, grid.colorDomain.xy, colorRange);
vColor.a *= layer.opacity;
if (column.extruded) {
vColor.rgb = lighting_getLightColor(vColor.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,EOe=`uniform gridUniforms {
  vec4 colorDomain;
  vec4 elevationDomain;
  vec2 elevationRange;
  vec2 originCommon;
  vec2 sizeCommon;
} grid;
`,IOe={name:"grid",vs:EOe,uniformTypes:{colorDomain:"vec4<f32>",elevationDomain:"vec4<f32>",elevationRange:"vec2<f32>",originCommon:"vec2<f32>",sizeCommon:"vec2<f32>"}};class yq extends Ry{getShaders(){const e=super.getShaders();return e.modules.push(IOe),{...e,vs:SOe}}initializeState(){super.initializeState();const e=this.getAttributeManager();e.remove(["instanceElevations","instanceFillColors","instanceLineColors","instanceStrokeWidths"]),e.addInstanced({instancePositions:{size:2,type:"float32",accessor:"getBin"},instanceColorValues:{size:1,type:"float32",accessor:"getColorValue"},instanceElevationValues:{size:1,type:"float32",accessor:"getElevationValue"}})}updateState(e){super.updateState(e);const{props:t,oldProps:n}=e,i=this.state.fillModel;if(n.colorRange!==t.colorRange){this.state.colorTexture?.destroy(),this.state.colorTexture=CD(this.context.device,t.colorRange,t.colorScaleType);const s={colorRange:this.state.colorTexture};i.shaderInputs.setProps({grid:s})}else n.colorScaleType!==t.colorScaleType&&wD(this.state.colorTexture,t.colorScaleType)}finalizeState(e){super.finalizeState(e),this.state.colorTexture?.destroy()}_updateGeometry(){const e=new UK;this.state.fillModel.setGeometry(e)}draw({uniforms:e}){const{cellOriginCommon:t,cellSizeCommon:n,elevationRange:i,elevationScale:s,extruded:a,coverage:o,colorDomain:u,elevationDomain:f}=this.props,g=this.props.colorCutoff||[-1/0,1/0],y=this.props.elevationCutoff||[-1/0,1/0],A=this.state.fillModel,C={colorDomain:[Math.max(u[0],g[0]),Math.min(u[1],g[1]),Math.max(u[0]-1,g[0]),Math.min(u[1]+1,g[1])],elevationDomain:[Math.max(f[0],y[0]),Math.min(f[1],y[1]),Math.max(f[0]-1,y[0]),Math.min(f[1]+1,y[1])],elevationRange:[i[0]*s,i[1]*s],originCommon:t,sizeCommon:n};A.shaderInputs.setProps({column:{extruded:a,coverage:o},grid:C}),A.draw(this.context.renderPass)}}yq.layerName="GridCellLayer";const POe=`uniform binOptionsUniforms {
  vec2 cellOriginCommon;
  vec2 cellSizeCommon;
} binOptions;
`,BOe={name:"binOptions",vs:POe,uniformTypes:{cellOriginCommon:"vec2<f32>",cellSizeCommon:"vec2<f32>"}};function tz(){}const MOe={gpuAggregation:!0,colorDomain:null,colorRange:n2,getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",lowerPercentile:{type:"number",min:0,max:100,value:0},upperPercentile:{type:"number",min:0,max:100,value:100},colorScaleType:"quantize",onSetColorDomain:tz,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationScale:{type:"number",min:0,value:1},elevationLowerPercentile:{type:"number",min:0,max:100,value:0},elevationUpperPercentile:{type:"number",min:0,max:100,value:100},elevationScaleType:"linear",onSetElevationDomain:tz,cellSize:{type:"number",min:0,value:1e3},coverage:{type:"number",min:0,max:1,value:1},getPosition:{type:"accessor",value:r=>r.position},gridAggregator:{type:"function",optional:!0,value:null},extruded:!1,material:!0};class PD extends rA{getAggregatorType(){const{gpuAggregation:e,gridAggregator:t,getColorValue:n,getElevationValue:i}=this.props;return e&&(t||n||i)?(Rr.warn("Features not supported by GPU aggregation, falling back to CPU")(),"cpu"):e&&Zl.isSupported(this.context.device)?"gpu":"cpu"}createAggregator(e){if(e==="cpu"){const{gridAggregator:t,cellSize:n}=this.props;return new tA({dimensions:2,getBin:{sources:["positions"],getValue:({positions:i},s,a)=>{if(t)return t(i,n);const u=this.state.aggregatorViewport.projectPosition(i),{cellSizeCommon:f,cellOriginCommon:g}=a;return[Math.floor((u[0]-g[0])/f[0]),Math.floor((u[1]-g[1])/f[1])]}},getValue:[{sources:["colorWeights"],getValue:({colorWeights:i})=>i},{sources:["elevationWeights"],getValue:({elevationWeights:i})=>i}]})}return new Zl(this.context.device,{dimensions:2,channelCount:2,bufferLayout:this.getAttributeManager().getBufferLayouts({isInstanced:!1}),...super.getShaders({modules:[$s,BOe],vs:`
  in vec3 positions;
  in vec3 positions64Low;
  in float colorWeights;
  in float elevationWeights;

  void getBin(out ivec2 binId) {
    vec3 positionCommon = project_position(positions, positions64Low);
    vec2 gridCoords = floor(positionCommon.xy / binOptions.cellSizeCommon);
    binId = ivec2(gridCoords);
  }
  void getValue(out vec2 value) {
    value = vec2(colorWeights, elevationWeights);
  }
  `})})}initializeState(){super.initializeState(),this.getAttributeManager().add({positions:{size:3,accessor:"getPosition",type:"float64",fp64:this.use64bitPositions()},colorWeights:{size:1,accessor:"getColorWeight"},elevationWeights:{size:1,accessor:"getElevationWeight"}})}updateState(e){const t=super.updateState(e),{props:n,oldProps:i,changeFlags:s}=e,{aggregator:a}=this.state;if((s.dataChanged||!this.state.dataAsArray)&&(n.getColorValue||n.getElevationValue)&&(this.state.dataAsArray=Array.from(Sd(n.data).iterable)),t||s.dataChanged||n.cellSize!==i.cellSize||n.getColorValue!==i.getColorValue||n.getElevationValue!==i.getElevationValue||n.colorAggregation!==i.colorAggregation||n.elevationAggregation!==i.elevationAggregation){this._updateBinOptions();const{cellSizeCommon:o,cellOriginCommon:u,binIdRange:f,dataAsArray:g}=this.state;if(a.setProps({binIdRange:f,pointCount:this.getNumInstances(),operations:[n.colorAggregation,n.elevationAggregation],binOptions:{cellSizeCommon:o,cellOriginCommon:u},onUpdate:this._onAggregationUpdate.bind(this)}),g){const{getColorValue:y,getElevationValue:A}=this.props;a.setProps({customOperations:[y&&(C=>y(C.map(M=>g[M]),{indices:C,data:n.data})),A&&(C=>A(C.map(M=>g[M]),{indices:C,data:n.data}))]})}}return s.updateTriggersChanged&&s.updateTriggersChanged.getColorValue&&a.setNeedsUpdate(0),s.updateTriggersChanged&&s.updateTriggersChanged.getElevationValue&&a.setNeedsUpdate(1),t}_updateBinOptions(){const e=this.getBounds(),t=[1,1];let n=[0,0],i=[[0,1],[0,1]],s=this.context.viewport;if(e&&Number.isFinite(e[0][0])){let a=[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2];const{cellSize:o}=this.props,{unitsPerMeter:u}=s.getDistanceScales(a);t[0]=u[0]*o,t[1]=u[1]*o;const f=s.projectFlat(a);n=[Math.floor(f[0]/t[0])*t[0],Math.floor(f[1]/t[1])*t[1]],a=s.unprojectFlat(n);const g=s.constructor;s=s.isGeospatial?new g({longitude:a[0],latitude:a[1],zoom:12}):new nh({position:[a[0],a[1],0],zoom:12}),n=[Math.fround(s.center[0]),Math.fround(s.center[1])],i=SD({dataBounds:e,getBinId:y=>{const A=s.projectFlat(y);return[Math.floor((A[0]-n[0])/t[0]),Math.floor((A[1]-n[1])/t[1])]}})}this.setState({cellSizeCommon:t,cellOriginCommon:n,binIdRange:i,aggregatorViewport:s})}draw(e){e.shaderModuleProps.project&&(e.shaderModuleProps.project.viewport=this.state.aggregatorViewport),super.draw(e)}_onAggregationUpdate({channel:e}){const t=this.getCurrentLayer().props,{aggregator:n}=this.state;if(e===0){const i=n.getResult(0);this.setState({colors:new lT(i,n.binCount)}),t.onSetColorDomain(n.getResultDomain(0))}else if(e===1){const i=n.getResult(1);this.setState({elevations:new lT(i,n.binCount)}),t.onSetElevationDomain(n.getResultDomain(1))}}onAttributeChange(e){const{aggregator:t}=this.state;switch(e){case"positions":t.setNeedsUpdate(),this._updateBinOptions();const{cellSizeCommon:n,cellOriginCommon:i,binIdRange:s}=this.state;t.setProps({binIdRange:s,binOptions:{cellSizeCommon:n,cellOriginCommon:i}});break;case"colorWeights":t.setNeedsUpdate(0);break;case"elevationWeights":t.setNeedsUpdate(1);break}}renderLayers(){const{aggregator:e,cellOriginCommon:t,cellSizeCommon:n}=this.state,{elevationScale:i,colorRange:s,elevationRange:a,extruded:o,coverage:u,material:f,transitions:g,colorScaleType:y,lowerPercentile:A,upperPercentile:C,colorDomain:M,elevationScaleType:k,elevationLowerPercentile:D,elevationUpperPercentile:V,elevationDomain:W}=this.props,z=this.getSubLayerClass("cells",yq),$=e.getBins(),te=this.state.colors?.update({scaleType:y,lowerPercentile:A,upperPercentile:C}),le=this.state.elevations?.update({scaleType:k,lowerPercentile:D,upperPercentile:V});return!te||!le?null:new z(this.getSubLayerProps({id:"cells"}),{data:{length:e.binCount,attributes:{getBin:$,getColorValue:te.attribute,getElevationValue:le.attribute}},dataComparator:(_e,se)=>_e.length===se.length,updateTriggers:{getBin:[$],getColorValue:[te.attribute],getElevationValue:[le.attribute]},cellOriginCommon:t,cellSizeCommon:n,elevationScale:i,colorRange:s,colorScaleType:y,elevationRange:a,extruded:o,coverage:u,material:f,colorDomain:te.domain||M||e.getResultDomain(0),elevationDomain:le.domain||W||e.getResultDomain(1),colorCutoff:te.cutoff,elevationCutoff:le.cutoff,transitions:g&&{getFillColor:g.getColorValue||g.getColorWeight,getElevation:g.getElevationValue||g.getElevationWeight},extensions:[]})}getPickingInfo(e){const t=e.info,{index:n}=t;if(n>=0){const i=this.state.aggregator.getBin(n);let s;i&&(s={col:i.id[0],row:i.id[1],colorValue:i.value[0],elevationValue:i.value[1],count:i.count},i.pointIndices&&(s.pointIndices=i.pointIndices,s.points=Array.isArray(this.props.data)?i.pointIndices.map(a=>this.props.data[a]):[])),t.object=s}return t}}PD.layerName="GridLayer";PD.defaultProps=MOe;function ROe(r){const e=r.map(o=>o[0]),t=r.map(o=>o[1]),n=Math.min.apply(null,e),i=Math.max.apply(null,e),s=Math.min.apply(null,t),a=Math.max.apply(null,t);return[n,s,i,a]}function kOe(r,e){return e[0]>=r[0]&&e[2]<=r[2]&&e[1]>=r[1]&&e[3]<=r[3]}const rz=new Float32Array(12);function nz(r,e=2){let t=0;for(const n of r)for(let i=0;i<e;i++)rz[t++]=n[i]||0;return rz}function OOe(r,e,t){const[n,i,s,a]=r,o=s-n,u=a-i;let f=o,g=u;o/u<e/t?f=e/t*u:g=t/e*o,f<e&&(f=e,g=t);const y=(s+n)/2,A=(a+i)/2;return[y-f/2,A-g/2,y+f/2,A+g/2]}function DOe(r,e){const[t,n,i,s]=e;return[(r[0]-t)/(i-t),(r[1]-n)/(s-n)]}const LOe=`#version 300 es
#define SHADER_NAME heatp-map-layer-vertex-shader
uniform sampler2D maxTexture;
in vec3 positions;
in vec2 texCoords;
out vec2 vTexCoords;
out float vIntensityMin;
out float vIntensityMax;
void main(void) {
gl_Position = project_position_to_clipspace(positions, vec3(0.0), vec3(0.0));
vTexCoords = texCoords;
vec4 maxTexture = texture(maxTexture, vec2(0.5));
float maxValue = triangle.aggregationMode < 0.5 ? maxTexture.r : maxTexture.g;
float minValue = maxValue * triangle.threshold;
if (triangle.colorDomain[1] > 0.) {
maxValue = triangle.colorDomain[1];
minValue = triangle.colorDomain[0];
}
vIntensityMax = triangle.intensity / maxValue;
vIntensityMin = triangle.intensity / minValue;
}
`,NOe=`#version 300 es
#define SHADER_NAME triangle-layer-fragment-shader
precision highp float;
uniform sampler2D weightsTexture;
uniform sampler2D colorTexture;
in vec2 vTexCoords;
in float vIntensityMin;
in float vIntensityMax;
out vec4 fragColor;
vec4 getLinearColor(float value) {
float factor = clamp(value * vIntensityMax, 0., 1.);
vec4 color = texture(colorTexture, vec2(factor, 0.5));
color.a *= min(value * vIntensityMin, 1.0);
return color;
}
void main(void) {
vec4 weights = texture(weightsTexture, vTexCoords);
float weight = weights.r;
if (triangle.aggregationMode > 0.5) {
weight /= max(1.0, weights.a);
}
if (weight <= 0.) {
discard;
}
vec4 linearColor = getLinearColor(weight);
linearColor.a *= layer.opacity;
fragColor = linearColor;
}
`,iz=`uniform triangleUniforms {
  float aggregationMode;
  vec2 colorDomain;
  float intensity;
  float threshold;
} triangle;
`,FOe={name:"triangle",vs:iz,fs:iz,uniformTypes:{aggregationMode:"f32",colorDomain:"vec2<f32>",intensity:"f32",threshold:"f32"}};class bq extends oo{getShaders(){return super.getShaders({vs:LOe,fs:NOe,modules:[$s,FOe]})}initializeState({device:e}){this.setState({model:this._getModel(e)})}_getModel(e){const{vertexCount:t,data:n}=this.props;return new Mi(e,{...this.getShaders(),id:this.props.id,attributes:n.attributes,bufferLayout:[{name:"positions",format:"float32x3"},{name:"texCoords",format:"float32x2"}],topology:"triangle-strip",vertexCount:t})}draw(){const{model:e}=this.state,{aggregationMode:t,colorDomain:n,intensity:i,threshold:s,colorTexture:a,maxTexture:o,weightsTexture:u}=this.props,f={aggregationMode:t,colorDomain:n,intensity:i,threshold:s,colorTexture:a,maxTexture:o,weightsTexture:u};e.shaderInputs.setProps({triangle:f}),e.draw(this.context.renderPass)}}bq.layerName="TriangleLayer";function UOe(r,e){const t={};for(const n in r)e.includes(n)||(t[n]=r[n]);return t}class _q extends Zc{initializeAggregationLayer(e){super.initializeState(this.context),this.setState({ignoreProps:UOe(this.constructor._propTypes,e.data.props),dimensions:e})}updateState(e){super.updateState(e);const{changeFlags:t}=e;if(t.extensionsChanged){const n=this.getShaders({});n&&n.defines&&(n.defines.NON_INSTANCED_MODEL=1),this.updateShaders(n)}this._updateAttributes()}updateAttributes(e){this.setState({changedAttributes:e})}getAttributes(){return this.getAttributeManager().getAttributes()}getModuleSettings(){const{viewport:e,mousePosition:t,device:n}=this.context;return Object.assign(Object.create(this.props),{viewport:e,mousePosition:t,picking:{isActive:0},devicePixelRatio:n.canvasContext.cssToDeviceRatio()})}updateShaders(e){}isAggregationDirty(e,t={}){const{props:n,oldProps:i,changeFlags:s}=e,{compareAll:a=!1,dimension:o}=t,{ignoreProps:u}=this.state,{props:f,accessors:g=[]}=o,{updateTriggersChanged:y}=s;if(s.dataChanged)return!0;if(y){if(y.all)return!0;for(const A of g)if(y[A])return!0}if(a)return s.extensionsChanged?!0:RO({oldProps:i,newProps:n,ignoreProps:u,propTypes:this.constructor._propTypes});for(const A of f)if(n[A]!==i[A])return!0;return!1}isAttributeChanged(e){const{changedAttributes:t}=this.state;return e?t&&t[e]!==void 0:!zOe(t)}_getAttributeManager(){return new US(this.context.device,{id:this.props.id,stats:this.context.stats})}}_q.layerName="AggregationLayer";function zOe(r){let e=!0;for(const t in r){e=!1;break}return e}const kP=`#version 300 es
in vec3 positions;
in vec3 positions64Low;
in float weights;
out vec4 weightsTexture;
void main()
{
weightsTexture = vec4(weights * weight.weightsScale, 0., 0., 1.);
float radiusTexels = project_pixel_size(weight.radiusPixels) * weight.textureWidth / (weight.commonBounds.z - weight.commonBounds.x);
gl_PointSize = radiusTexels * 2.;
vec3 commonPosition = project_position(positions, positions64Low);
gl_Position.xy = (commonPosition.xy - weight.commonBounds.xy) / (weight.commonBounds.zw - weight.commonBounds.xy) ;
gl_Position.xy = (gl_Position.xy * 2.) - (1.);
gl_Position.w = 1.0;
}
`,OP=`#version 300 es
in vec4 weightsTexture;
out vec4 fragColor;
float gaussianKDE(float u){
return pow(2.71828, -u*u/0.05555)/(1.77245385*0.166666);
}
void main()
{
float dist = length(gl_PointCoord - vec2(0.5, 0.5));
if (dist > 0.5) {
discard;
}
fragColor = weightsTexture * gaussianKDE(2. * dist);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,VOe=`#version 300 es
uniform sampler2D inTexture;
out vec4 outTexture;
void main()
{
int yIndex = gl_VertexID / int(maxWeight.textureSize);
int xIndex = gl_VertexID - (yIndex * int(maxWeight.textureSize));
vec2 uv = (0.5 + vec2(float(xIndex), float(yIndex))) / maxWeight.textureSize;
outTexture = texture(inTexture, uv);
gl_Position = vec4(0.0, 0.0, 0.0, 1.0);
gl_PointSize = 1.0;
}
`,$Oe=`#version 300 es
in vec4 outTexture;
out vec4 fragColor;
void main() {
fragColor = outTexture;
fragColor.g = outTexture.r / max(1.0, outTexture.a);
}
`,jOe=`uniform weightUniforms {
  vec4 commonBounds;
  float radiusPixels;
  float textureWidth;
  float weightsScale;
} weight;
`,GOe={name:"weight",vs:jOe,uniformTypes:{commonBounds:"vec4<f32>",radiusPixels:"f32",textureWidth:"f32",weightsScale:"f32"}},HOe={name:"maxWeight",vs:`uniform maxWeightUniforms {
  float textureSize;
} maxWeight;
`,uniformTypes:{textureSize:"f32"}},WOe=2,DP={format:"rgba8unorm",dimension:"2d",width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}},sz=[0,0],KOe={SUM:0,MEAN:1},XOe={getPosition:{type:"accessor",value:r=>r.position},getWeight:{type:"accessor",value:1},intensity:{type:"number",min:0,value:1},radiusPixels:{type:"number",min:1,max:100,value:50},colorRange:n2,threshold:{type:"number",min:0,max:1,value:.05},colorDomain:{type:"array",value:null,optional:!0},aggregation:"SUM",weightsTextureSize:{type:"number",min:128,max:2048,value:2048},debounceTimeout:{type:"number",min:0,max:1e3,value:500}},JOe=["float32-renderable-webgl","texture-blend-float-webgl"],qOe={data:{props:["radiusPixels"]}};class BD extends _q{getShaders(e){let t=[$s];return e.modules&&(t=[...t,...e.modules]),super.getShaders({...e,modules:t})}initializeState(){super.initializeAggregationLayer(qOe),this.setState({colorDomain:sz}),this._setupTextureParams(),this._setupAttributes(),this._setupResources()}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){super.updateState(e),this._updateHeatmapState(e)}_updateHeatmapState(e){const{props:t,oldProps:n}=e,i=this._getChangeFlags(e);if((i.dataChanged||i.viewportChanged)&&(i.boundsChanged=this._updateBounds(i.dataChanged),this._updateTextureRenderingBounds()),i.dataChanged||i.boundsChanged){if(clearTimeout(this.state.updateTimer),this.setState({isWeightMapDirty:!0}),i.dataChanged){const s=this.getShaders({vs:kP,fs:OP});this._createWeightsTransform(s)}}else i.viewportZoomChanged&&this._debouncedUpdateWeightmap();t.colorRange!==n.colorRange&&this._updateColorTexture(e),this.state.isWeightMapDirty&&this._updateWeightmap(),this.setState({zoom:e.context.viewport.zoom})}renderLayers(){const{weightsTexture:e,triPositionBuffer:t,triTexCoordBuffer:n,maxWeightsTexture:i,colorTexture:s,colorDomain:a}=this.state,{updateTriggers:o,intensity:u,threshold:f,aggregation:g}=this.props,y=this.getSubLayerClass("triangle",bq);return new y(this.getSubLayerProps({id:"triangle-layer",updateTriggers:o}),{coordinateSystem:Pr.DEFAULT,data:{attributes:{positions:t,texCoords:n}},vertexCount:4,maxTexture:i,colorTexture:s,aggregationMode:KOe[g]||0,weightsTexture:e,intensity:u,threshold:f,colorDomain:a})}finalizeState(e){super.finalizeState(e);const{weightsTransform:t,weightsTexture:n,maxWeightTransform:i,maxWeightsTexture:s,triPositionBuffer:a,triTexCoordBuffer:o,colorTexture:u,updateTimer:f}=this.state;t?.destroy(),n?.destroy(),i?.destroy(),s?.destroy(),a?.destroy(),o?.destroy(),u?.destroy(),f&&clearTimeout(f)}_getAttributeManager(){return new US(this.context.device,{id:this.props.id,stats:this.context.stats})}_getChangeFlags(e){const t={},{dimensions:n}=this.state;t.dataChanged=this.isAttributeChanged()&&"attribute changed"||this.isAggregationDirty(e,{compareAll:!0,dimension:n.data})&&"aggregation is dirty",t.viewportChanged=e.changeFlags.viewportChanged;const{zoom:i}=this.state;return(!e.context.viewport||e.context.viewport.zoom!==i)&&(t.viewportZoomChanged=!0),t}_createTextures(){const{textureSize:e,format:t}=this.state;this.setState({weightsTexture:this.context.device.createTexture({...DP,width:e,height:e,format:t}),maxWeightsTexture:this.context.device.createTexture({...DP,width:1,height:1,format:t})})}_setupAttributes(){this.getAttributeManager().add({positions:{size:3,type:"float64",accessor:"getPosition"},weights:{size:1,accessor:"getWeight"}}),this.setState({positionAttributeName:"positions"})}_setupTextureParams(){const{device:e}=this.context,{weightsTextureSize:t}=this.props,n=Math.min(t,e.limits.maxTextureDimension2D),i=JOe.every(o=>e.features.has(o)),s=i?"rgba32float":"rgba8unorm",a=i?1:1/255;this.setState({textureSize:n,format:s,weightsScale:a}),i||Rr.warn(`HeatmapLayer: ${this.id} rendering to float texture not supported, falling back to low precision format`)()}_createWeightsTransform(e){let{weightsTransform:t}=this.state;const{weightsTexture:n}=this.state,i=this.getAttributeManager();t?.destroy(),t=new A5(this.context.device,{id:`${this.id}-weights-transform`,bufferLayout:i.getBufferLayouts(),vertexCount:1,targetTexture:n,parameters:{depthWriteEnabled:!1,blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"},topology:"point-list",...e,modules:[...e.modules,GOe]}),this.setState({weightsTransform:t})}_setupResources(){this._createTextures();const{device:e}=this.context,{textureSize:t,weightsTexture:n,maxWeightsTexture:i}=this.state,s=this.getShaders({vs:kP,fs:OP});this._createWeightsTransform(s);const a=this.getShaders({vs:VOe,fs:$Oe,modules:[HOe]}),o=new A5(e,{id:`${this.id}-max-weights-transform`,targetTexture:i,...a,vertexCount:t*t,topology:"point-list",parameters:{depthWriteEnabled:!1,blendColorOperation:"max",blendAlphaOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}}),u={inTexture:n,textureSize:t};o.model.shaderInputs.setProps({maxWeight:u}),this.setState({weightsTexture:n,maxWeightsTexture:i,maxWeightTransform:o,zoom:null,triPositionBuffer:e.createBuffer({byteLength:48}),triTexCoordBuffer:e.createBuffer({byteLength:48})})}updateShaders(e){this._createWeightsTransform({vs:kP,fs:OP,...e})}_updateMaxWeightValue(){const{maxWeightTransform:e}=this.state;e.run({parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]})}_updateBounds(e=!1){const{viewport:t}=this.context,n=[t.unproject([0,0]),t.unproject([t.width,0]),t.unproject([0,t.height]),t.unproject([t.width,t.height])].map(o=>o.map(Math.fround)),i=ROe(n),s={visibleWorldBounds:i,viewportCorners:n};let a=!1;if(e||!this.state.worldBounds||!kOe(this.state.worldBounds,i)){const o=this._worldToCommonBounds(i),u=this._commonToWorldBounds(o);this.props.coordinateSystem===Pr.LNGLAT&&(u[1]=Math.max(u[1],-85.051129),u[3]=Math.min(u[3],85.051129),u[0]=Math.max(u[0],-360),u[2]=Math.min(u[2],360));const f=this._worldToCommonBounds(u);s.worldBounds=u,s.normalizedCommonBounds=f,a=!0}return this.setState(s),a}_updateTextureRenderingBounds(){const{triPositionBuffer:e,triTexCoordBuffer:t,normalizedCommonBounds:n,viewportCorners:i}=this.state,{viewport:s}=this.context;e.write(nz(i,3));const a=i.map(o=>DOe(s.projectPosition(o),n));t.write(nz(a,2))}_updateColorTexture(e){const{colorRange:t}=e.props;let{colorTexture:n}=this.state;const i=fq(t,!1,Uint8Array);n?.destroy(),n=this.context.device.createTexture({...DP,data:i,width:t.length,height:1}),this.setState({colorTexture:n})}_updateWeightmap(){const{radiusPixels:e,colorDomain:t,aggregation:n}=this.props,{worldBounds:i,textureSize:s,weightsScale:a,weightsTexture:o}=this.state,u=this.state.weightsTransform;this.state.isWeightMapDirty=!1;const f=this._worldToCommonBounds(i,{useLayerCoordinateSystem:!0});if(t&&n==="SUM"){const{viewport:z}=this.context,$=z.distanceScales.metersPerUnit[2]*(f[2]-f[0])/s;this.state.colorDomain=t.map(te=>te*$*a)}else this.state.colorDomain=t||sz;const y=this.getAttributeManager().getAttributes(),A=this.getModuleSettings();this._setModelAttributes(u.model,y),u.model.setVertexCount(this.getNumInstances());const C={radiusPixels:e,commonBounds:f,textureWidth:s,weightsScale:a,weightsTexture:o},{viewport:M,devicePixelRatio:k,coordinateSystem:D,coordinateOrigin:V}=A,{modelMatrix:W}=this.props;u.model.shaderInputs.setProps({project:{viewport:M,devicePixelRatio:k,modelMatrix:W,coordinateSystem:D,coordinateOrigin:V},weight:C}),u.run({parameters:{viewport:[0,0,s,s]},clearColor:[0,0,0,0]}),this._updateMaxWeightValue()}_debouncedUpdateWeightmap(e=!1){let{updateTimer:t}=this.state;const{debounceTimeout:n}=this.props;e?(t=null,this._updateBounds(!0),this._updateTextureRenderingBounds(),this.setState({isWeightMapDirty:!0})):(this.setState({isWeightMapDirty:!1}),clearTimeout(t),t=setTimeout(this._debouncedUpdateWeightmap.bind(this,!0),n)),this.setState({updateTimer:t})}_worldToCommonBounds(e,t={}){const{useLayerCoordinateSystem:n=!1}=t,[i,s,a,o]=e,{viewport:u}=this.context,{textureSize:f}=this.state,{coordinateSystem:g}=this.props,y=n&&(g===Pr.LNGLAT_OFFSETS||g===Pr.METER_OFFSETS),A=y?u.projectPosition(this.props.coordinateOrigin):[0,0],C=f*WOe/u.scale;let M,k;return n&&!y?(M=this.projectPosition([i,s,0]),k=this.projectPosition([a,o,0])):(M=u.projectPosition([i,s,0]),k=u.projectPosition([a,o,0])),OOe([M[0]-A[0],M[1]-A[1],k[0]-A[0],k[1]-A[1]],C,C)}_commonToWorldBounds(e){const[t,n,i,s]=e,{viewport:a}=this.context,o=a.unprojectPosition([t,n]),u=a.unprojectPosition([i,s]);return o.slice(0,2).concat(u.slice(0,2))}}BD.layerName="HeatmapLayer";BD.defaultProps=XOe;var YOe=Object.defineProperty,ZOe=(r,e,t)=>e in r?YOe(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Cr=(r,e,t)=>ZOe(r,typeof e!="symbol"?e+"":e,t);const Wi={id:{type:String,required:!0},data:{type:[Object,String]},visible:{type:Boolean,default:!0},opacity:{type:Number,default:1},extensions:{type:Array},pickable:{type:Boolean,default:!1},highlightColor:{type:[Array,Function],default:()=>[0,0,128,128]},highlightedObjectIndex:{type:[Number,null],default:null},autoHighlight:{type:Boolean,default:!1},coordinateSystem:{type:Number,default:Pr.DEFAULT},coordinateOrigin:{type:Array,default:()=>[0,0,0]},wrapLongitude:{type:Boolean,default:!1},modelMatrix:{type:Array,default:void 0},dataComparator:{type:Function},_dataDiff:{type:Function},dataTransform:{type:Function,default:void 0},positionFormat:{type:String,default:"XYZ"},colorFormat:{type:String,default:"RGBA"},numInstances:{type:Number,default:void 0},updateTriggers:{type:Object},transitions:{type:Object}},Ki=["id","data","visible","opacity","extensions","pickable","highlightColor","highlightedObjectIndex","autoHighlight","coordinateSystem","coordinateOrigin","wrapLongitude","modelMatrix","dataComparator","_dataDiff","dataTransform","positionFormat","colorFormat","numInstances","transitions"],QOe={...Wi,greatCircle:{type:Boolean,default:!1},numSegments:{type:Number,default:50},widthUnits:{type:String,default:"pixels"},widthScale:{type:Number,default:1},widthMinPixels:{type:Number,default:0},widthMaxPixels:{type:Number,default:Number.MAX_SAFE_INTEGER},getSourcePosition:{type:Function,default:r=>r?.sourcePosition},getTargetPosition:{type:Function,default:r=>r?.targetPosition},getSourceColor:{type:Function,default:()=>[0,0,0,255]},getTargetColor:{type:Function,default:()=>[0,0,0,255]},getWidth:{type:Number,default:1},getHeight:{type:Number,default:1},getTilt:{type:Number,default:0}},eDe=[...Ki,"greatCircle","numSegments","widthUnits","widthScale","widthMinPixels","widthMaxPixels","getSourcePosition","getTargetPosition","getSourceColor","getTargetColor","getWidth","getHeight","getTilt"];function tDe(r,e,t){for(const n of Object.keys(r))(r[n]===void 0||!e.includes(n))&&delete r[n];return{...r,onClick:(...n)=>t("click",...n),onHover:(...n)=>t("hover",...n),onDrag:(...n)=>t("drag",...n),onDragStart:(...n)=>t("dragStart",...n),onDragEnd:(...n)=>t("dragEnd",...n),onError:(...n)=>t("error",...n),onDataLoad:(...n)=>t("dataLoad",...n)}}const Ni=(r,e,t,n)=>{const i=I.inject("addLayer"),s=I.inject("removeLayer"),a=I.ref(null);if(!i||!s)throw new Error("DeckGL context is missing. Ensure you are using this within a DeckGL parent component.");const o=()=>{const f=tDe({...e},t,n);a.value&&(s(a.value),a.value=null),a.value=I.markRaw(r(f)),i(a.value)},u=()=>{if(a.value)try{s(a.value),a.value.context&&a.value.finalizeState(a.value.context),a.value=null}catch(f){console.error("Error finalizing layer:",f)}};return I.watch(e,()=>{o()},{deep:!0,immediate:!0}),I.onUnmounted(u),{layer:a}};I.defineComponent({name:"ArcLayer",props:{...QOe},emits:["hover","click","drag","dragStart","dragEnd","dataLoad","error"],setup(r,{emit:e,expose:t}){const{layer:n}=Ni(i=>new NO(i),r,eDe,e);return t({layer:n}),()=>[]}});const rDe={...Wi,diskResolution:{type:Number},radius:{type:Number,default:1e3},angle:{type:Number,default:0},vertices:{type:Array,default:null},offset:{type:Array,default:()=>[0,0]},coverage:{type:Number,default:1},elevationScale:{type:Number,default:1},filled:{type:Boolean,default:!0},stroked:{type:Boolean,default:!1},extruded:{type:Boolean,default:!0},wireframe:{type:Boolean,default:!1},flatShading:{type:Boolean,default:!1},radiusUnits:{type:String,default:"meters"},lineWidthUnits:{type:String,default:"meters"},lineWidthScale:{type:Number,default:1},lineWidthMinPixels:{type:Number,default:0},lineWidthMaxPixels:{type:Number,default:Number.MAX_SAFE_INTEGER},material:{type:[Object,Boolean],default:()=>!0},getPosition:{type:Function,default:r=>r.position},getFillColor:{type:[Function,Array],default:[0,0,0,255]},getLineColor:{type:[Function,Array],default:[0,0,0,255]},getElevation:{type:[Function,Number],default:1e3},getLineWidth:{type:[Function,Number],default:1}},nDe=[...Ki,"diskResolution","radius","angle","vertices","offset","coverage","elevationScale","filled","stroked","extruded","wireframe","flatShading","radiusUnits","lineWidthUnits","lineWidthScale","lineWidthMinPixels","lineWidthMaxPixels","material","getPosition","getFillColor","getLineColor","getElevation","getLineWidth"],oz=I.defineComponent({name:"ColumnLayer",props:{...rDe},emits:["hover","click","drag","dragStart","dragEnd","dataLoad","error"],setup(r,{emit:e,expose:t}){const{layer:n}=Ni(i=>new Ry(i),r,nDe,e);return t({layer:n}),()=>[]}}),iDe={...Wi,pointType:{type:String,default:"circle"},filled:{type:Boolean,default:!0},stroked:{type:Boolean,default:!0},extruded:{type:Boolean,default:!1},wireframe:{type:Boolean,default:!1},elevationScale:{type:Number,default:1},lineWidthUnits:{type:String,default:"meters"},lineWidthScale:{type:Number,default:1},lineWidthMinPixels:{type:Number,default:0},lineWidthMaxPixels:{type:Number,default:Number.MAX_SAFE_INTEGER},lineJointRounded:{type:Boolean,default:!1},lineMiterLimit:{type:Number,default:4},lineCapRounded:{type:Boolean,default:!1},lineBillboard:{type:Boolean,default:!1},getFillColor:{type:[Function,Array],default:()=>[0,0,0,255]},getLineColor:{type:[Function,Array],default:()=>[0,0,0,255]},getElevation:{type:[Function,Number],default:()=>1e3},getLineWidth:{type:[Function,Number],default:()=>1},material:{type:Object,default:void 0},getPointRadius:{type:[Function,Number],default:()=>1},pointRadiusUnits:{type:String,default:"meters"},pointRadiusScale:{type:Number,default:1},pointRadiusMinPixels:{type:Number,default:0},pointRadiusMaxPixels:{type:Number,default:Number.MAX_SAFE_INTEGER},pointAntialiasing:{type:Boolean,default:!0},pointBillboard:{type:Boolean,default:!1},iconAtlas:{type:Object,default:null},iconMapping:{type:Object,default:()=>({})},getIcon:{type:Function,default:()=>null},getIconSize:{type:Function,default:()=>1},getIconColor:{type:Function,default:()=>[0,0,0,255]},getIconAngle:{type:Function,default:()=>0},iconBillboard:{type:Boolean,default:!1},getText:{type:Function,default:()=>""},getTextColor:{type:[Function,Array],default:()=>[0,0,0,255]},getTextSize:{type:[Function,Number],default:()=>12},textSizeUnits:{type:String,default:"pixels"},textBackground:{type:Boolean,default:!1}},sDe=[...Ki,"pointType","filled","stroked","extruded","wireframe","elevationScale","lineWidthUnits","lineWidthScale","lineWidthMinPixels","lineWidthMaxPixels","lineJointRounded","lineMiterLimit","lineCapRounded","lineBillboard","getFillColor","getLineColor","getElevation","getLineWidth","material","getPointRadius","pointRadiusUnits","pointRadiusScale","pointRadiusMinPixels","pointRadiusMaxPixels","pointAntialiasing","pointBillboard","iconAtlas","iconMapping","getIcon","getIconSize","getIconColor","getIconAngle","iconBillboard","getText","getTextColor","getTextSize","textSizeUnits","textBackground"];I.defineComponent({name:"GeoJsonLayer",props:{...iDe},emits:["hover","click","drag","dragStart","dragEnd","dataLoad","error"],setup(r,{emit:e,expose:t}){const{layer:n}=Ni(i=>new Oy(i),r,sDe,e);return t({layer:n}),()=>[]}});const vq={...Wi,widthUnits:{type:String,default:"meters"},widthScale:{type:Number,default:1},widthMinPixels:{type:Number,default:0},widthMaxPixels:{type:Number,default:Number.MAX_SAFE_INTEGER},jointRounded:{type:Boolean,default:!1},capRounded:{type:Boolean,default:!1},miterLimit:{type:Number,default:4},billboard:{type:Boolean,default:!1},_pathType:{type:String,default:null},getPath:{type:Function,default:r=>r.path},getColor:{type:[Function,Array],default:()=>[0,0,0,255]},getWidth:{type:[Function,Number],default:1}},Aq=[...Ki,"widthUnits","widthScale","widthMinPixels","widthMaxPixels","jointRounded","capRounded","miterLimit","billboard","_pathType","getPath","getColor","getWidth"];I.defineComponent({name:"PathLayer",props:{...vq},emits:["hover","click","drag","dragStart","dragEnd","dataLoad","error"],setup(r,{emit:e,expose:t}){const{layer:n}=Ni(i=>new xp(i),r,Aq,e);return t({layer:n}),()=>[]}});const oDe={...vq,fadeTrail:{type:Boolean,default:!0},trailLength:{type:Number,default:120},currentTime:{type:Number,default:0},getTimestamps:{type:Function,default:r=>r.timestamps}},aDe=[...Aq,"fadeTrail","trailLength","currentTime","getTimestamps"];I.defineComponent({name:"TripsLayer",props:{...oDe},emits:["hover","click","drag","dragStart","dragEnd","dataLoad","error"],setup(r,{emit:e,expose:t}){const{layer:n}=Ni(i=>new rD(i),r,aDe,e);return t({layer:n}),()=>[]}});const lDe={...Wi,data:{type:[String,Object],required:!0},serviceType:{type:String,default:"auto"},layers:{type:Array,default:()=>[]},srs:{type:String,default:"auto"},onMetadataLoad:{type:Function,default:()=>{}},onMetadataLoadError:{type:Function,default:r=>console.error(r)},onImageLoadStart:{type:Function,default:()=>{}},onImageLoad:{type:Function,default:()=>{}},onImageLoadError:{type:Function,default:(r,e)=>console.error("Error loading image:",e,"Request ID:",r)}},cDe=[...Ki,"data","serviceType","layers","srs","onMetadataLoad","onMetadataLoadError","onImageLoadStart","onImageLoad","onImageLoadError"];I.defineComponent({name:"WMSLayer",props:{...lDe},emits:["hover","click","drag","dragStart","dragEnd","dataLoad","error"],setup(r,{emit:e,expose:t}){const{layer:n}=Ni(i=>new qO(i),r,cDe,e);return t({layer:n}),()=>[]}});const uDe={...Wi,gpuAggregation:{type:Boolean,default:!1},colorAggregation:{type:String,default:"SUM"},elevationAggregation:{type:String,default:"SUM"},hexagonAggregator:{type:Function,default:null},radius:{type:Number,default:1e3},elevationScale:{type:Number,default:1},coverage:{type:Number,default:1},lowerPercentile:{type:Number,default:0},upperPercentile:{type:Number,default:100},getPosition:{type:Function,default:r=>r?.position},getColorWeight:{type:[Function,Number],default:1},getColorValue:{type:Function,default:null},colorScaleType:{type:String,default:"quantile"},colorDomain:{type:Array,default:null},colorRange:{type:Array},elevationScaleType:{type:String,default:"linear"},elevationDomain:{type:Array,default:null},elevationRange:{type:Array,default:[0,1e3]},elevationUpperPercentile:{type:Number,default:100},elevationLowerPercentile:{type:Number,default:0},material:{type:[Object,Boolean],default:!0},extruded:{type:Boolean,default:!1},getElevationWeight:{type:[Function,Number],default:1}},hDe=[...Ki,"gpuAggregation","colorAggregation","elevationAggregation","hexagonAggregator","radius","elevationScale","coverage","lowerPercentile","upperPercentile","getPosition","getColorWeight","getColorValue","colorScaleType","colorDomain","colorRange","elevationScaleType","elevationDomain","elevationRange","elevationUpperPercentile","elevationLowerPercentile","material","getElevationWeight","extruded"];I.defineComponent({name:"HexagonLayer",props:{...uDe},emits:["hover","click","drag","dragStart","dragEnd","dataLoad","error"],setup(r,{emit:e,expose:t}){const{layer:n}=Ni(i=>new ED(i),r,hDe,e);return t({layer:n}),()=>[]}});const dDe={...Wi,sizeScale:{type:Number,default:1},sizeUnits:{type:String,default:"meters"},sizeMinPixels:{type:Number,default:0},sizeMaxPixels:{type:Number,default:Number.MAX_SAFE_INTEGER},iconAtlas:{type:String},iconMapping:{type:[Object,String]},billboard:{type:Boolean,default:!0},alphaCutoff:{type:Number,default:.5},loadOptions:{type:Object},textureParameters:{type:Object},getAngle:{type:[Function,Number],default:0},getPosition:{type:Function,default:r=>r?.position},getSize:{type:[Function,Number],default:1},getColor:{type:[Function,Array],default:[255,255,255,255]},getIcon:{type:Function,default:r=>r?.icon},onIconError:{type:Function}},fDe=[...Ki,"sizeScale","sizeUnits","sizeMinPixels","sizeMaxPixels","iconAtlas","iconMapping","billboard","alphaCutoff","loadOptions","textureParameters","getAngle","getPosition","getSize","getColor","getIcon","onIconError"];I.defineComponent({name:"IconLayer",props:{...dDe},emits:["hover","click","drag","dragStart","dragEnd","dataLoad","error"],setup(r,{emit:e,expose:t}){const{layer:n}=Ni(i=>new Yv(i),r,fDe,e);return t({layer:n}),()=>[]}});const pDe={...Wi,gpuAggregation:{type:Boolean,default:!1},colorAggregation:{type:String,default:"SUM"},elevationAggregation:{type:String,default:"SUM"},gridAggregator:{type:Function,default:null},colorScaleType:{type:String,default:"quantile"},cellSize:{type:Number,default:1e3},colorDomain:{type:Array,default:null},colorRange:{type:Array},coverage:{type:Number,default:1},elevationDomain:{type:Array},elevationScale:{type:Number,default:1},elevationScaleType:{type:String,default:"linear"},elevationRange:{type:Array,default:[0,1e3]},extruded:{type:Boolean,default:!0},upperPercentile:{type:Number,default:100},lowerPercentile:{type:Number,default:0},elevationUpperPercentile:{type:Number,default:100},elevationLowerPercentile:{type:Number,default:0},getPosition:{type:Function,default:r=>r?.position},getColorWeight:{type:[Function,Number],default:1},getColorValue:{type:Function,default:null},getElevationWeight:{type:[Function,Number],default:1},getElevationValue:{type:Function,default:null},material:{type:Boolean,default:!0},onSetColorDomain:Function,onSetElevationDomain:Function},gDe=[...Ki,"gpuAggregation","colorAggregation","elevationAggregation","gridAggregator","colorScaleType","cellSize","colorDomain","colorRange","coverage","elevationDomain","elevationScale","elevationScaleType","elevationRange","extruded","upperPercentile","lowerPercentile","elevationUpperPercentile","elevationLowerPercentile","getPosition","getColorWeight","getColorValue","getElevationWeight","getElevationValue","material","onSetColorDomain","onSetElevationDomain"];I.defineComponent({name:"GridLayer",props:{...pDe},emits:["hover","click","drag","dragStart","dragEnd","dataLoad","error"],setup(r,{emit:e,expose:t}){const{layer:n}=Ni(i=>new PD(i),r,gDe,e);return t({layer:n}),()=>[]}});const mDe={...Wi,sizeUnits:{type:String,default:"pixels"},pointSize:{type:Number,default:10},material:{type:[Boolean,Object],default:!0},getPosition:{type:Function,default:r=>r?.position},getNormal:{type:[Function,Array],default:[0,0,1]},getColor:{type:[Function,Array],default:[0,0,0,255]}},yDe=[...Ki,"sizeUnits","pointSize","material","getPosition","getNormal","getColor"];I.defineComponent({name:"PointCloudLayer",props:{...mDe},emits:["hover","click","drag","dragStart","dragEnd","dataLoad","error"],setup(r,{emit:e,expose:t}){const{layer:n}=Ni(i=>new $S(i),r,yDe,e);return t({layer:n}),()=>[]}});const bDe={...Wi,stroked:{type:Boolean,default:!0},filled:{type:Boolean,default:!0},extruded:{type:Boolean,default:!1},elevationScale:{type:Number,default:1},wireframe:{type:Boolean,default:!1},lineWidthUnits:{type:String,default:"meters"},lineWidthScale:{type:Number,default:1},lineWidthMinPixels:{type:Number,default:0},lineWidthMaxPixels:{type:Number,default:Number.MAX_SAFE_INTEGER},lineJointRounded:{type:Boolean,default:!1},lineMiterLimit:{type:Number,default:4},lineDashJustified:{type:Boolean,default:void 0},getPolygon:{type:Function,default:r=>r.polygon},getFillColor:{type:[Function,Array],default:[0,0,0,255]},getLineColor:{type:[Function,Array],default:[0,0,0,255]},getLineWidth:{type:[Function,Number],default:1},getElevation:{type:[Function,Number],default:1e3},material:{type:[Object,Boolean],default:!0},_normalize:{type:Boolean,default:!0},_windingOrder:{type:String,default:"CW"}},_De=[...Ki,"stroked","filled","extruded","elevationScale","wireframe","lineWidthUnits","lineWidthScale","lineWidthMinPixels","lineWidthMaxPixels","lineJointRounded","lineMiterLimit","lineDashJustified","getPolygon","getFillColor","getLineColor","getLineWidth","getElevation","material","_normalize","_windingOrder"];I.defineComponent({name:"PolygonLayer",props:{...bDe},emits:["hover","click","drag","dragStart","dragEnd","dataLoad","error"],setup(r,{emit:e,expose:t}){const{layer:n}=Ni(i=>new jO(i),r,_De,e);return t({layer:n}),()=>[]}});const vDe={...Wi,cellSize:{type:Number,default:1e3},gpuAggregation:{type:Boolean,default:!0},aggregation:{type:String,default:"SUM"},contours:{type:Array,default:()=>[{threshold:1}]},getPosition:{type:Function,default:r=>r?.position},getWeight:{type:Function,default:()=>1},zOffset:{type:Number,default:.005}},ADe=[...Ki,"cellSize","gpuAggregation","aggregation","contours","getPosition","getWeight","zOffset"];I.defineComponent({name:"ContourLayer",props:{...vDe},emits:["hover","click","drag","dragStart","dragEnd","dataLoad","error"],setup(r,{emit:e,expose:t}){const{layer:n}=Ni(i=>new ID(i),r,ADe,e);return t({layer:n}),()=>[]}});const xDe={...Wi,radiusUnits:{type:String,default:"meters"},radiusScale:{type:Number,default:1},radiusMinPixels:{type:Number,default:0},radiusMaxPixels:{type:Number,default:Number.MAX_SAFE_INTEGER},lineWidthUnits:{type:String,default:"meters"},lineWidthScale:{type:Number,default:1},lineWidthMinPixels:{type:Number,default:0},lineWidthMaxPixels:{type:Number,default:Number.MAX_SAFE_INTEGER},stroked:{type:Boolean,default:!1},filled:{type:Boolean,default:!0},billboard:{type:Boolean,default:!1},antialiasing:{type:Boolean,default:!0},getPosition:{type:Function,default:r=>r?.position},getRadius:{type:[Function,Number],default:1},getFillColor:{type:[Function,Array],default:[0,0,0,255]},getLineColor:{type:[Function,Array],default:[0,0,0,255]},getLineWidth:{type:[Function,Number],default:1}},wDe=[...Ki,"radiusUnits","radiusScale","radiusMinPixels","radiusMaxPixels","lineWidthUnits","lineWidthScale","lineWidthMinPixels","lineWidthMaxPixels","stroked","filled","billboard","antialiasing","getPosition","getRadius","getFillColor","getLineColor","getLineWidth"];I.defineComponent({name:"ScatterplotLayer",props:{...xDe},emits:["hover","click","drag","dragStart","dragEnd","dataLoad","error"],setup(r,{emit:e,expose:t}){const{layer:n}=Ni(i=>new jS(i),r,wDe,e);return t({layer:n}),()=>[]}});const CDe={...Wi,intensity:{type:Number,default:1},radiusPixels:{type:Number,default:30},colorRange:{type:Array},threshold:{type:Number,default:.05},colorDomain:{type:Array,default:null},aggregation:{type:String,default:"SUM"},weightsTextureSize:{type:Number,default:2048},debounceTimeout:{type:Number,default:500},getPosition:{type:Function,default:r=>r?.position},getWeight:{type:[Function,Number],default:1}},TDe=[...Ki,"intensity","radiusPixels","colorRange","threshold","colorDomain","aggregation","weightsTextureSize","debounceTimeout","getPosition","getWeight"];I.defineComponent({name:"HeatmapLayer",props:{...CDe},emits:["hover","click","drag","dragStart","dragEnd","dataLoad","error"],setup(r,{emit:e,expose:t}){const{layer:n}=Ni(i=>new BD(i),r,TDe,e);return t({layer:n}),()=>[]}});const SDe={...Wi,image:{type:[String,Object],required:!0},bounds:{type:Array,required:!0},desaturate:{type:Number,default:0},transparentColor:{type:Array,default:()=>[0,0,0,0]},tintColor:{type:Array,default:()=>[255,255,255]}},EDe=[...Ki,"image","bounds","desaturate","transparentColor","tintColor"];I.defineComponent({name:"BitmapLayer",props:{...SDe},emits:["hover","click","drag","dragStart","dragEnd","dataLoad","error"],setup(r,{emit:e,expose:t}){const{layer:n}=Ni(i=>new VS(i),r,EDe,e);return t({layer:n}),()=>[]}});const IDe={...Wi,widthUnits:{type:String,default:"meters"},widthScale:{type:Number,default:1},widthMinPixels:{type:Number,default:0},widthMaxPixels:{type:Number,default:Number.MAX_SAFE_INTEGER},getSourcePosition:{type:Function,default:r=>r?.sourcePosition},getTargetPosition:{type:Function,default:r=>r?.targetPosition},getColor:{type:[Function,Array],default:()=>[0,0,0,255]},getWidth:{type:[Function,Number],default:1}},PDe=[...Ki,"widthUnits","widthScale","widthMinPixels","widthMaxPixels","getSourcePosition","getTargetPosition","getColor","getWidth"];I.defineComponent({name:"LineLayer",props:{...IDe},emits:["hover","click","drag","dragStart","dragEnd","dataLoad","error"],setup(r,{emit:e,expose:t}){const{layer:n}=Ni(i=>new FO(i),r,PDe,e);return t({layer:n}),()=>[]}});async function nA(r,e,t,n){return n._parse(r,e,t,n)}function ys(r,e){if(!r)throw new Error(e||"loader assertion failed.")}const o2=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),az=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);az&&parseFloat(az[1]);const LP=globalThis,Rx=globalThis.process||{};function BDe(r){var e,t;if(typeof window<"u"&&((e=window.process)==null?void 0:e.type)==="renderer"||typeof process<"u"&&(t=process.versions)!=null&&t.electron)return!0;const n=typeof navigator<"u"&&navigator.userAgent;return!!(n&&n.indexOf("Electron")>=0)}function MD(){return!(typeof process=="object"&&String(process)==="[object process]"&&!(process!=null&&process.browser))||BDe()}const xq="4.1.0";function MDe(r){try{const e=window[r],t="__storage_test__";return e.setItem(t,t),e.removeItem(t),e}catch{return null}}class RDe{constructor(e,t,n="sessionStorage"){this.storage=MDe(n),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function kDe(r){let e;return r<10?e=`${r.toFixed(2)}ms`:r<100?e=`${r.toFixed(1)}ms`:r<1e3?e=`${r.toFixed(0)}ms`:e=`${(r/1e3).toFixed(2)}s`,e}function ODe(r,e=8){const t=Math.max(e-r.length,0);return`${" ".repeat(t)}${r}`}var cT;(function(r){r[r.BLACK=30]="BLACK",r[r.RED=31]="RED",r[r.GREEN=32]="GREEN",r[r.YELLOW=33]="YELLOW",r[r.BLUE=34]="BLUE",r[r.MAGENTA=35]="MAGENTA",r[r.CYAN=36]="CYAN",r[r.WHITE=37]="WHITE",r[r.BRIGHT_BLACK=90]="BRIGHT_BLACK",r[r.BRIGHT_RED=91]="BRIGHT_RED",r[r.BRIGHT_GREEN=92]="BRIGHT_GREEN",r[r.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",r[r.BRIGHT_BLUE=94]="BRIGHT_BLUE",r[r.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",r[r.BRIGHT_CYAN=96]="BRIGHT_CYAN",r[r.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(cT||(cT={}));const DDe=10;function lz(r){return typeof r!="string"?r:(r=r.toUpperCase(),cT[r]||cT.WHITE)}function LDe(r,e,t){return!MD&&typeof r=="string"&&(e&&(r=`\x1B[${lz(e)}m${r}\x1B[39m`),t&&(r=`\x1B[${lz(t)+DDe}m${r}\x1B[49m`)),r}function NDe(r,e=["constructor"]){const t=Object.getPrototypeOf(r),n=Object.getOwnPropertyNames(t),i=r;for(const s of n){const a=i[s];typeof a=="function"&&(e.find(o=>s===o)||(i[s]=a.bind(r)))}}function RD(r,e){if(!r)throw new Error("Assertion failed")}function Yg(){var r,e,t;let n;if(MD()&&LP.performance)n=(e=(r=LP?.performance)==null?void 0:r.now)==null?void 0:e.call(r);else if("hrtime"in Rx){const i=(t=Rx?.hrtime)==null?void 0:t.call(Rx);n=i[0]*1e3+i[1]/1e6}else n=Date.now();return n}const Zg={debug:MD()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},FDe={enabled:!0,level:0};function Qg(){}const cz={},uz={once:!0};let a2=class{constructor({id:e}={id:""}){this.VERSION=xq,this._startTs=Yg(),this._deltaTs=Yg(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new RDe(`__probe-${this.id}__`,FDe),this.timeStamp(`${this.id} started`),NDe(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Yg()-this._startTs).toPrecision(10))}getDelta(){return Number((Yg()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){if(!e)throw new Error(t||"Assertion failed")}warn(e){return this._getLogFunction(0,e,Zg.warn,arguments,uz)}error(e){return this._getLogFunction(0,e,Zg.error,arguments)}deprecated(e,t){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${t}\` instead`)}removed(e,t){return this.error(`\`${e}\` has been removed. Use \`${t}\` instead`)}probe(e,t){return this._getLogFunction(e,t,Zg.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,Zg.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){return this._getLogFunction(e,t,Zg.debug||Zg.info,arguments,uz)}table(e,t,n){return t?this._getLogFunction(e,t,console.table||Qg,n&&[n],{tag:zDe(t)}):Qg}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||Qg)}group(e,t,n={collapsed:!1}){const i=hz({logLevel:e,message:t,opts:n}),{collapsed:s}=n;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,t,n={}){return this.group(e,t,Object.assign({},n,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Qg)}withGroup(e,t,n){this.group(e,t)();try{n()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=wq(e)}_getLogFunction(e,t,n,i,s){if(this._shouldLog(e)){s=hz({logLevel:e,message:t,args:i,opts:s}),n=n||s.method,RD(n),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Yg();const a=s.tag||s.message;if(s.once&&a)if(!cz[a])cz[a]=Yg();else return Qg;return t=UDe(this.id,s.message,s),n.bind(console,t,...s.args)}return Qg}};a2.VERSION=xq;function wq(r){if(!r)return 0;let e;switch(typeof r){case"number":e=r;break;case"object":e=r.logLevel||r.priority||0;break;default:return 0}return RD(Number.isFinite(e)&&e>=0),e}function hz(r){const{logLevel:e,message:t}=r;r.logLevel=wq(e);const n=r.args?Array.from(r.args):[];for(;n.length&&n.shift()!==t;);switch(typeof e){case"string":case"function":t!==void 0&&n.unshift(t),r.message=e;break;case"object":Object.assign(r,e);break}typeof r.message=="function"&&(r.message=r.message());const i=typeof r.message;return RD(i==="string"||i==="object"),Object.assign(r,{args:n},r.opts)}function UDe(r,e,t){if(typeof e=="string"){const n=t.time?ODe(kDe(t.total)):"";e=t.time?`${r}: ${n}  ${e}`:`${r}: ${e}`,e=LDe(e,t.color,t.background)}return e}function zDe(r){for(const e in r)for(const t in r[e])return t||"untitled";return"empty"}globalThis.probe={};const Cq=new a2({id:"@probe.gl/log"}),NP="4.3.2",VDe=NP[0]>="0"&&NP[0]<="9"?`v${NP}`:"";function $De(){const r=new a2({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=r,globalThis.loaders.version=VDe,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=r,r}const jDe=$De();function GDe(r,e){return Tq(r||{},e)}function Tq(r,e,t=0){if(t>3)return e;const n={...r};for(const[i,s]of Object.entries(e))s&&typeof s=="object"&&!Array.isArray(s)?n[i]=Tq(n[i]||{},e[i],t+1):n[i]=e[i];return n}function HDe(r){var e;globalThis.loaders||(globalThis.loaders={}),(e=globalThis.loaders).modules||(e.modules={}),Object.assign(globalThis.loaders.modules,r)}function WDe(r){var e,t;return((t=(e=globalThis.loaders)==null?void 0:e.modules)==null?void 0:t[r])||null}const KDe="latest";function XDe(){var r;return(r=globalThis._loadersgl_)!=null&&r.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.2"),globalThis._loadersgl_.version}const Sq=XDe();function th(r,e){if(!r)throw new Error(e||"loaders.gl assertion failed.")}const bl=typeof process!="object"||String(process)!=="[object process]"||process.browser,kD=typeof importScripts=="function",JDe=typeof window<"u"&&typeof window.orientation<"u",dz=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);dz&&parseFloat(dz[1]);class qDe{constructor(e,t){Cr(this,"name"),Cr(this,"workerThread"),Cr(this,"isRunning",!0),Cr(this,"result"),Cr(this,"_resolve",()=>{}),Cr(this,"_reject",()=>{}),this.name=e,this.workerThread=t,this.result=new Promise((n,i)=>{this._resolve=n,this._reject=i})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){th(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){th(this.isRunning),this.isRunning=!1,this._reject(e)}}let FP=class{terminate(){}};const UP=new Map;function YDe(r){th(r.source&&!r.url||!r.source&&r.url);let e=UP.get(r.source||r.url);return e||(r.url&&(e=ZDe(r.url),UP.set(r.url,e)),r.source&&(e=Eq(r.source),UP.set(r.source,e))),th(e),e}function ZDe(r){if(!r.startsWith("http"))return r;const e=QDe(r);return Eq(e)}function Eq(r){const e=new Blob([r],{type:"application/javascript"});return URL.createObjectURL(e)}function QDe(r){return`try {
  importScripts('${r}');
} catch (error) {
  console.error(error);
  throw error;
}`}function Iq(r,e=!0,t){const n=t||new Set;if(r){if(fz(r))n.add(r);else if(fz(r.buffer))n.add(r.buffer);else if(!ArrayBuffer.isView(r)&&e&&typeof r=="object")for(const i in r)Iq(r[i],e,n)}return t===void 0?Array.from(n):[]}function fz(r){return r?r instanceof ArrayBuffer||typeof MessagePort<"u"&&r instanceof MessagePort||typeof ImageBitmap<"u"&&r instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas:!1}const zP=()=>{};class sM{constructor(e){Cr(this,"name"),Cr(this,"source"),Cr(this,"url"),Cr(this,"terminated",!1),Cr(this,"worker"),Cr(this,"onMessage"),Cr(this,"onError"),Cr(this,"_loadableURL","");const{name:t,source:n,url:i}=e;th(n||i),this.name=t,this.source=n,this.url=i,this.onMessage=zP,this.onError=s=>console.log(s),this.worker=bl?this._createBrowserWorker():this._createNodeWorker()}static isSupported(){return typeof Worker<"u"&&bl||typeof FP<"u"&&!bl}destroy(){this.onMessage=zP,this.onError=zP,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,t){t=t||Iq(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+=`worker ${this.name} from ${this.url}. `,e.message&&(t+=`${e.message} in `),e.lineno&&(t+=`:${e.lineno}:${e.colno}`),new Error(t)}_createBrowserWorker(){this._loadableURL=YDe({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},e.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},e.onmessageerror=t=>console.error(t),e}_createNodeWorker(){let e;if(this.url){const t=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new FP(t,{eval:!1})}else if(this.source)e=new FP(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",t=>{this.onMessage(t)}),e.on("error",t=>{this.onError(t)}),e.on("exit",t=>{}),e}}class eLe{constructor(e){Cr(this,"name","unnamed"),Cr(this,"source"),Cr(this,"url"),Cr(this,"maxConcurrency",1),Cr(this,"maxMobileConcurrency",1),Cr(this,"onDebug",()=>{}),Cr(this,"reuseWorkers",!0),Cr(this,"props",{}),Cr(this,"jobQueue",[]),Cr(this,"idleQueue",[]),Cr(this,"count",0),Cr(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}static isSupported(){return sM.isSupported()}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,t=(i,s,a)=>i.done(a),n=(i,s)=>i.error(s)){const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:t,onError:n,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:"Starting job",name:t.name,workerThread:e,backlog:this.jobQueue.length});const n=new qDe(t.name,e);e.onMessage=i=>t.onMessage(n,i.type,i.payload),e.onError=i=>t.onError(n,i),t.onStart(n);try{await n.result}catch(i){console.error(`Worker exception: ${i}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!bl||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new sM({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return JDe?this.maxMobileConcurrency:this.maxConcurrency}}const tLe={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}},Pq=class am{constructor(e){Cr(this,"props"),Cr(this,"workerPools",new Map),this.props={...tLe},this.setProps(e),this.workerPools=new Map}static isSupported(){return sM.isSupported()}static getWorkerFarm(e={}){return am._workerFarm=am._workerFarm||new am({}),am._workerFarm.setProps(e),am._workerFarm}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:n,url:i}=e;let s=this.workerPools.get(t);return s||(s=new eLe({name:t,source:n,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}};Cr(Pq,"_workerFarm");let Bq=Pq;function rLe(r,e={}){const t=e[r.id]||{},n=bl?`${r.id}-worker.js`:`${r.id}-worker-node.js`;let i=t.workerUrl;if(!i&&r.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(bl?i=`modules/${r.module}/dist/${n}`:i=`modules/${r.module}/src/workers/${r.id}-worker-node.ts`),!i){let s=r.version;s==="latest"&&(s=KDe);const a=s?`@${s}`:"";i=`https://unpkg.com/@loaders.gl/${r.module}${a}/dist/${n}`}return th(i),i}function nLe(r,e=Sq){th(r,"no worker provided");const t=r.version;return!(!e||!t)}const VP={};async function Qf(r,e=null,t={},n=null){return e&&(r=iLe(r,e,t,n)),VP[r]=VP[r]||sLe(r),await VP[r]}function iLe(r,e,t={},n=null){if(!t.useLocalLibraries&&r.startsWith("http"))return r;n=n||r;const i=t.modules||{};return i[n]?i[n]:bl?t.CDN?(th(t.CDN.startsWith("http")),`${t.CDN}/${e}@${Sq}/dist/libs/${n}`):kD?`../src/libs/${n}`:`modules/${e}/src/libs/${n}`:`modules/${e}/dist/libs/${n}`}async function sLe(r){if(r.endsWith("wasm"))return await aLe(r);if(!bl)try{const{requireFromFile:t}=globalThis.loaders||{};return await t?.(r)}catch(t){return console.error(t),null}if(kD)return importScripts(r);const e=await lLe(r);return oLe(e,r)}function oLe(r,e){if(!bl){const{requireFromString:n}=globalThis.loaders||{};return n?.(r,e)}if(kD)return eval.call(globalThis,r),null;const t=document.createElement("script");t.id=e;try{t.appendChild(document.createTextNode(r))}catch{t.text=r}return document.body.appendChild(t),null}async function aLe(r){const{readFileAsArrayBuffer:e}=globalThis.loaders||{};return bl||!e||r.startsWith("http")?await(await fetch(r)).arrayBuffer():await e(r)}async function lLe(r){const{readFileAsText:e}=globalThis.loaders||{};return bl||!e||r.startsWith("http")?await(await fetch(r)).text():await e(r)}function cLe(r,e){return!Bq.isSupported()||!bl&&!(e!=null&&e._nodeWorkers)?!1:r.worker&&e?.worker}async function uLe(r,e,t,n,i){const s=r.id,a=rLe(r,t),o=Bq.getWorkerFarm(t).getWorkerPool({name:s,url:a});t=JSON.parse(JSON.stringify(t)),n=JSON.parse(JSON.stringify(n||{}));const u=await o.startJob("process-on-worker",hLe.bind(null,i));return u.postMessage("process",{input:e,options:t,context:n}),await(await u.result).result}async function hLe(r,e,t,n){switch(t){case"done":e.done(n);break;case"error":e.error(new Error(n.error));break;case"process":const{id:i,input:s,options:a}=n;try{const o=await r(s,a);e.postMessage("done",{id:i,result:o})}catch(o){const u=o instanceof Error?o.message:"unknown error";e.postMessage("error",{id:i,error:u})}break;default:console.warn(`parse-with-worker unknown message ${t}`)}}function dLe(r,e=5){return typeof r=="string"?r.slice(0,e):ArrayBuffer.isView(r)?pz(r.buffer,r.byteOffset,e):r instanceof ArrayBuffer?pz(r,0,e):""}function pz(r,e,t){if(r.byteLength<=e+t)return"";const n=new DataView(r);let i="";for(let s=0;s<t;s++)i+=String.fromCharCode(n.getUint8(e+s));return i}function fLe(r){try{return JSON.parse(r)}catch{throw new Error(`Failed to parse JSON from data starting with "${dLe(r)}"`)}}function pLe(r,e,t){if(t=t||r.byteLength,r.byteLength<t||e.byteLength<t)return!1;const n=new Uint8Array(r),i=new Uint8Array(e);for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}function gLe(...r){return mLe(r)}function mLe(r){const e=r.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),t=e.reduce((s,a)=>s+a.byteLength,0),n=new Uint8Array(t);let i=0;for(const s of e)n.set(s,i),i+=s.byteLength;return n.buffer}function OD(r,e,t){const n=t!==void 0?new Uint8Array(r).subarray(e,e+t):new Uint8Array(r).subarray(e);return new Uint8Array(n).buffer}function iA(r,e){return ys(r>=0),ys(e>0),r+(e-1)&-4}function yLe(r,e,t){let n;if(r instanceof ArrayBuffer)n=new Uint8Array(r);else{const i=r.byteOffset,s=r.byteLength;n=new Uint8Array(r.buffer||r.arrayBuffer,i,s)}return e.set(n,t),t+iA(n.byteLength,4)}async function bLe(r){const e=[];for await(const t of r)e.push(t);return gLe(...e)}let _Le="";const gz={};function vLe(r){for(const e in gz)if(r.startsWith(e)){const t=gz[e];r=r.replace(e,t)}return!r.startsWith("http://")&&!r.startsWith("https://")&&(r=`${_Le}${r}`),r}function ALe(r){return r&&typeof r=="object"&&r.isBuffer}function Mq(r){if(ALe(r)||r instanceof ArrayBuffer)return r;if(ArrayBuffer.isView(r))return r.byteOffset===0&&r.byteLength===r.buffer.byteLength?r.buffer:r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength);if(typeof r=="string"){const e=r;return new TextEncoder().encode(e).buffer}if(r&&typeof r=="object"&&r._toArrayBuffer)return r._toArrayBuffer();throw new Error("toArrayBuffer")}function xLe(){var r;if(typeof process<"u"&&typeof process.cwd<"u")return process.cwd();const e=(r=window.location)==null?void 0:r.pathname;return e?.slice(0,e.lastIndexOf("/")+1)||""}function Rq(r){const e=r?r.lastIndexOf("/"):-1;return e>=0?r.substr(e+1):""}function kq(r){const e=r?r.lastIndexOf("/"):-1;return e>=0?r.substr(0,e):""}function wLe(...r){const e=[];for(let s=0;s<r.length;s++)e[s]=r[s];let t="",n=!1,i;for(let s=e.length-1;s>=-1&&!n;s--){let a;s>=0?a=e[s]:(i===void 0&&(i=xLe()),a=i),a.length!==0&&(t=`${a}/${t}`,n=a.charCodeAt(0)===O0)}return t=CLe(t,!n),n?`/${t}`:t.length>0?t:"."}const O0=47,$P=46;function CLe(r,e){let t="",n=-1,i=0,s,a=!1;for(let o=0;o<=r.length;++o){if(o<r.length)s=r.charCodeAt(o);else{if(s===O0)break;s=O0}if(s===O0){if(!(n===o-1||i===1))if(n!==o-1&&i===2){if(t.length<2||!a||t.charCodeAt(t.length-1)!==$P||t.charCodeAt(t.length-2)!==$P){if(t.length>2){const u=t.length-1;let f=u;for(;f>=0&&t.charCodeAt(f)!==O0;--f);if(f!==u){t=f===-1?"":t.slice(0,f),n=o,i=0,a=!1;continue}}else if(t.length===2||t.length===1){t="",n=o,i=0,a=!1;continue}}e&&(t.length>0?t+="/..":t="..",a=!0)}else{const u=r.slice(n+1,o);t.length>0?t+=`/${u}`:t=u,a=!1}n=o,i=0}else s===$P&&i!==-1?++i:i=-1}return t}const TLe=1/Math.PI*180,SLe=1/180*Math.PI,ELe={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...ELe}};const Rs=globalThis.mathgl.config;function ILe(r,{precision:e=Rs.precision}={}){return r=OLe(r),`${parseFloat(r.toPrecision(e))}`}function mp(r){return Array.isArray(r)||ArrayBuffer.isView(r)&&!(r instanceof DataView)}function PLe(r){return MLe(r)}function BLe(r){return RLe(r)}function MLe(r,e){return DD(r,t=>t*SLe,e)}function RLe(r,e){return DD(r,t=>t*TLe,e)}function kLe(r,e,t){return DD(r,n=>Math.max(e,Math.min(t,n)))}function nv(r,e,t){const n=Rs.EPSILON;t&&(Rs.EPSILON=t);try{if(r===e)return!0;if(mp(r)&&mp(e)){if(r.length!==e.length)return!1;for(let i=0;i<r.length;++i)if(!nv(r[i],e[i]))return!1;return!0}return r&&r.equals?r.equals(e):e&&e.equals?e.equals(r):typeof r=="number"&&typeof e=="number"?Math.abs(r-e)<=Rs.EPSILON*Math.max(1,Math.abs(r),Math.abs(e)):!1}finally{Rs.EPSILON=n}}function OLe(r){return Math.round(r/Rs.EPSILON)*Rs.EPSILON}function DLe(r){return r.clone?r.clone():new Array(r.length)}function DD(r,e,t){if(mp(r)){const n=r;t=t||DLe(n);for(let i=0;i<t.length&&i<n.length;++i){const s=typeof r=="number"?r:r[i];t[i]=e(s,i,t)}return t}return e(r)}class LD extends Array{clone(){return new this.constructor().copy(this)}fromArray(e,t=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=e[n+t];return this.check()}toArray(e=[],t=0){for(let n=0;n<this.ELEMENTS;++n)e[t+n]=this[n];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:mp(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Rs)}formatString(e){let t="";for(let n=0;n<this.ELEMENTS;++n)t+=(n>0?", ":"")+ILe(this[n],e);return`${e.printTypes?this.constructor.name:""}[${t}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!nv(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,n){if(n===void 0)return this.lerp(this,e,t);for(let i=0;i<this.ELEMENTS;++i){const s=e[i],a=typeof t=="number"?t:t[i];this[i]=s+n*(a-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e[n]),t[n]);return this.check()}add(...e){for(const t of e)for(let n=0;n<this.ELEMENTS;++n)this[n]+=t[n];return this.check()}subtract(...e){for(const t of e)for(let n=0;n<this.ELEMENTS;++n)this[n]-=t[n];return this.check()}scale(e){if(typeof e=="number")for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;else for(let t=0;t<this.ELEMENTS&&t<e.length;++t)this[t]*=e[t];return this.check()}multiplyByScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}check(){if(Rs.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,t){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],e),t);return this.check()}get elements(){return this}}function LLe(r,e){if(r.length!==e)return!1;for(let t=0;t<r.length;++t)if(!Number.isFinite(r[t]))return!1;return!0}function Nn(r){if(!Number.isFinite(r))throw new Error(`Invalid number ${JSON.stringify(r)}`);return r}function l_(r,e,t=""){if(Rs.debug&&!LLe(r,e))throw new Error(`math.gl: ${t} some fields set to invalid numbers'`);return r}function td(r,e){if(!r)throw new Error(`math.gl assertion ${e}`)}class ND extends LD{get x(){return this[0]}set x(e){this[0]=Nn(e)}get y(){return this[1]}set y(e){this[1]=Nn(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let n=0;n<this.ELEMENTS;++n){const i=this[n]-e[n];t+=i*i}return Nn(t)}dot(e){let t=0;for(let n=0;n<this.ELEMENTS;++n)t+=this[n]*e[n];return Nn(t)}normalize(){const e=this.magnitude();if(e!==0)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let n=0;n<this.ELEMENTS;++n)this[n]*=t[n];return this.check()}divide(...e){for(const t of e)for(let n=0;n<this.ELEMENTS;++n)this[n]/=t[n];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return td(e>=0&&e<this.ELEMENTS,"index is out of range"),Nn(this[e])}setComponent(e,t){return td(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}const c_=1e-6;let nc=typeof Float32Array<"u"?Float32Array:Array;function NLe(){const r=new nc(2);return nc!=Float32Array&&(r[0]=0,r[1]=0),r}function FLe(r,e,t){const n=e[0],i=e[1];return r[0]=t[0]*n+t[2]*i,r[1]=t[1]*n+t[3]*i,r}function ULe(r,e,t){const n=e[0],i=e[1];return r[0]=t[0]*n+t[2]*i+t[4],r[1]=t[1]*n+t[3]*i+t[5],r}function Oq(r,e,t){const n=e[0],i=e[1];return r[0]=t[0]*n+t[3]*i+t[6],r[1]=t[1]*n+t[4]*i+t[7],r}function Dq(r,e,t){const n=e[0],i=e[1];return r[0]=t[0]*n+t[4]*i+t[12],r[1]=t[1]*n+t[5]*i+t[13],r}(function(){const r=NLe();return function(e,t,n,i,s,a){let o,u;for(t||(t=2),n||(n=0),i?u=Math.min(i*t+n,e.length):u=e.length,o=n;o<u;o+=t)r[0]=e[o],r[1]=e[o+1],s(r,r,a),e[o]=r[0],e[o+1]=r[1];return e}})();function Lq(r,e,t){const n=e[0],i=e[1],s=t[3]*n+t[7]*i||1;return r[0]=(t[0]*n+t[4]*i)/s,r[1]=(t[1]*n+t[5]*i)/s,r}function Nq(r,e,t){const n=e[0],i=e[1],s=e[2],a=t[3]*n+t[7]*i+t[11]*s||1;return r[0]=(t[0]*n+t[4]*i+t[8]*s)/a,r[1]=(t[1]*n+t[5]*i+t[9]*s)/a,r[2]=(t[2]*n+t[6]*i+t[10]*s)/a,r}function zLe(r,e,t){const n=e[0],i=e[1];return r[0]=t[0]*n+t[2]*i,r[1]=t[1]*n+t[3]*i,r[2]=e[2],r}function VLe(r,e,t){const n=e[0],i=e[1];return r[0]=t[0]*n+t[2]*i,r[1]=t[1]*n+t[3]*i,r[2]=e[2],r[3]=e[3],r}function Fq(r,e,t){const n=e[0],i=e[1],s=e[2];return r[0]=t[0]*n+t[3]*i+t[6]*s,r[1]=t[1]*n+t[4]*i+t[7]*s,r[2]=t[2]*n+t[5]*i+t[8]*s,r[3]=e[3],r}class FD extends ND{constructor(e=0,t=0){super(2),mp(e)&&arguments.length===1?this.copy(e):(Rs.debug&&(Nn(e),Nn(t)),this[0]=e,this[1]=t)}set(e,t){return this[0]=e,this[1]=t,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this.check()}fromObject(e){return Rs.debug&&(Nn(e.x),Nn(e.y)),this[0]=e.x,this[1]=e.y,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return Dq(this,this,e),this.check()}transformAsVector(e){return Lq(this,this,e),this.check()}transformByMatrix3(e){return Oq(this,this,e),this.check()}transformByMatrix2x3(e){return ULe(this,this,e),this.check()}transformByMatrix2(e){return FLe(this,this,e),this.check()}}function Uq(){const r=new nc(3);return nc!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function zq(r){const e=r[0],t=r[1],n=r[2];return Math.sqrt(e*e+t*t+n*n)}function mz(r,e,t){const n=new nc(3);return n[0]=r,n[1]=e,n[2]=t,n}function $Le(r,e){const t=e[0],n=e[1],i=e[2];let s=t*t+n*n+i*i;return s>0&&(s=1/Math.sqrt(s)),r[0]=e[0]*s,r[1]=e[1]*s,r[2]=e[2]*s,r}function UD(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]}function Vw(r,e,t){const n=e[0],i=e[1],s=e[2],a=t[0],o=t[1],u=t[2];return r[0]=i*u-s*o,r[1]=s*a-n*u,r[2]=n*o-i*a,r}function zD(r,e,t){const n=e[0],i=e[1],s=e[2];let a=t[3]*n+t[7]*i+t[11]*s+t[15];return a=a||1,r[0]=(t[0]*n+t[4]*i+t[8]*s+t[12])/a,r[1]=(t[1]*n+t[5]*i+t[9]*s+t[13])/a,r[2]=(t[2]*n+t[6]*i+t[10]*s+t[14])/a,r}function Vq(r,e,t){const n=e[0],i=e[1],s=e[2];return r[0]=n*t[0]+i*t[3]+s*t[6],r[1]=n*t[1]+i*t[4]+s*t[7],r[2]=n*t[2]+i*t[5]+s*t[8],r}function $q(r,e,t){const n=t[0],i=t[1],s=t[2],a=t[3],o=e[0],u=e[1],f=e[2];let g=i*f-s*u,y=s*o-n*f,A=n*u-i*o,C=i*A-s*y,M=s*g-n*A,k=n*y-i*g;const D=a*2;return g*=D,y*=D,A*=D,C*=2,M*=2,k*=2,r[0]=o+g+C,r[1]=u+y+M,r[2]=f+A+k,r}function jLe(r,e,t,n){const i=[],s=[];return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],s[0]=i[0],s[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),s[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),r[0]=s[0]+t[0],r[1]=s[1]+t[1],r[2]=s[2]+t[2],r}function GLe(r,e,t,n){const i=[],s=[];return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],s[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),s[1]=i[1],s[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),r[0]=s[0]+t[0],r[1]=s[1]+t[1],r[2]=s[2]+t[2],r}function HLe(r,e,t,n){const i=[],s=[];return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],s[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),s[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),s[2]=i[2],r[0]=s[0]+t[0],r[1]=s[1]+t[1],r[2]=s[2]+t[2],r}function WLe(r,e){const t=r[0],n=r[1],i=r[2],s=e[0],a=e[1],o=e[2],u=Math.sqrt((t*t+n*n+i*i)*(s*s+a*a+o*o)),f=u&&UD(r,e)/u;return Math.acos(Math.min(Math.max(f,-1),1))}const KLe=zq;(function(){const r=Uq();return function(e,t,n,i,s,a){let o,u;for(t||(t=3),n||(n=0),i?u=Math.min(i*t+n,e.length):u=e.length,o=n;o<u;o+=t)r[0]=e[o],r[1]=e[o+1],r[2]=e[o+2],s(r,r,a),e[o]=r[0],e[o+1]=r[1],e[o+2]=r[2];return e}})();const jP=[0,0,0];let kx,zt=class jq extends ND{static get ZERO(){return kx||(kx=new jq(0,0,0),Object.freeze(kx)),kx}constructor(e=0,t=0,n=0){super(-0,-0,-0),arguments.length===1&&mp(e)?this.copy(e):(Rs.debug&&(Nn(e),Nn(t),Nn(n)),this[0]=e,this[1]=t,this[2]=n)}set(e,t,n){return this[0]=e,this[1]=t,this[2]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Rs.debug&&(Nn(e.x),Nn(e.y),Nn(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Nn(e)}angle(e){return WLe(this,e)}cross(e){return Vw(this,this,e),this.check()}rotateX({radians:e,origin:t=jP}){return jLe(this,this,t,e),this.check()}rotateY({radians:e,origin:t=jP}){return GLe(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=jP}){return HLe(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return zD(this,this,e),this.check()}transformAsVector(e){return Nq(this,this,e),this.check()}transformByMatrix3(e){return Vq(this,this,e),this.check()}transformByMatrix2(e){return zLe(this,this,e),this.check()}transformByQuaternion(e){return $q(this,this,e),this.check()}},Ox;class VD extends ND{static get ZERO(){return Ox||(Ox=new VD(0,0,0,0),Object.freeze(Ox)),Ox}constructor(e=0,t=0,n=0,i=0){super(-0,-0,-0,-0),mp(e)&&arguments.length===1?this.copy(e):(Rs.debug&&(Nn(e),Nn(t),Nn(n),Nn(i)),this[0]=e,this[1]=t,this[2]=n,this[3]=i)}set(e,t,n,i){return this[0]=e,this[1]=t,this[2]=n,this[3]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return Rs.debug&&(Nn(e.x),Nn(e.y),Nn(e.z),Nn(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=Nn(e)}get w(){return this[3]}set w(e){this[3]=Nn(e)}transform(e){return zD(this,this,e),this.check()}transformByMatrix3(e){return Fq(this,this,e),this.check()}transformByMatrix2(e){return VLe(this,this,e),this.check()}transformByQuaternion(e){return $q(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}class Gq extends LD{toString(){let e="[";if(Rs.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let n=0;n<this.RANK;++n)e+=` ${this[n*this.RANK+t]}`}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=` ${this[t]}`}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,n){return this[t*this.RANK+e]=Nn(n),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const n=e*this.RANK;for(let i=0;i<this.RANK;++i)t[i]=this[n+i];return t}setColumn(e,t){const n=e*this.RANK;for(let i=0;i<this.RANK;++i)this[n+i]=t[i];return this}}function XLe(){const r=new nc(9);return nc!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function JLe(r,e){if(r===e){const t=e[1],n=e[2],i=e[5];r[1]=e[3],r[2]=e[6],r[3]=t,r[5]=e[7],r[6]=n,r[7]=i}else r[0]=e[0],r[1]=e[3],r[2]=e[6],r[3]=e[1],r[4]=e[4],r[5]=e[7],r[6]=e[2],r[7]=e[5],r[8]=e[8];return r}function qLe(r,e){const t=e[0],n=e[1],i=e[2],s=e[3],a=e[4],o=e[5],u=e[6],f=e[7],g=e[8],y=g*a-o*f,A=-g*s+o*u,C=f*s-a*u;let M=t*y+n*A+i*C;return M?(M=1/M,r[0]=y*M,r[1]=(-g*n+i*f)*M,r[2]=(o*n-i*a)*M,r[3]=A*M,r[4]=(g*t-i*u)*M,r[5]=(-o*t+i*s)*M,r[6]=C*M,r[7]=(-f*t+n*u)*M,r[8]=(a*t-n*s)*M,r):null}function YLe(r){const e=r[0],t=r[1],n=r[2],i=r[3],s=r[4],a=r[5],o=r[6],u=r[7],f=r[8];return e*(f*s-a*u)+t*(-f*i+a*o)+n*(u*i-s*o)}function yz(r,e,t){const n=e[0],i=e[1],s=e[2],a=e[3],o=e[4],u=e[5],f=e[6],g=e[7],y=e[8],A=t[0],C=t[1],M=t[2],k=t[3],D=t[4],V=t[5],W=t[6],z=t[7],$=t[8];return r[0]=A*n+C*a+M*f,r[1]=A*i+C*o+M*g,r[2]=A*s+C*u+M*y,r[3]=k*n+D*a+V*f,r[4]=k*i+D*o+V*g,r[5]=k*s+D*u+V*y,r[6]=W*n+z*a+$*f,r[7]=W*i+z*o+$*g,r[8]=W*s+z*u+$*y,r}function ZLe(r,e,t){const n=e[0],i=e[1],s=e[2],a=e[3],o=e[4],u=e[5],f=e[6],g=e[7],y=e[8],A=t[0],C=t[1];return r[0]=n,r[1]=i,r[2]=s,r[3]=a,r[4]=o,r[5]=u,r[6]=A*n+C*a+f,r[7]=A*i+C*o+g,r[8]=A*s+C*u+y,r}function QLe(r,e,t){const n=e[0],i=e[1],s=e[2],a=e[3],o=e[4],u=e[5],f=e[6],g=e[7],y=e[8],A=Math.sin(t),C=Math.cos(t);return r[0]=C*n+A*a,r[1]=C*i+A*o,r[2]=C*s+A*u,r[3]=C*a-A*n,r[4]=C*o-A*i,r[5]=C*u-A*s,r[6]=f,r[7]=g,r[8]=y,r}function bz(r,e,t){const n=t[0],i=t[1];return r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=i*e[3],r[4]=i*e[4],r[5]=i*e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function eNe(r,e){const t=e[0],n=e[1],i=e[2],s=e[3],a=t+t,o=n+n,u=i+i,f=t*a,g=n*a,y=n*o,A=i*a,C=i*o,M=i*u,k=s*a,D=s*o,V=s*u;return r[0]=1-y-M,r[3]=g-V,r[6]=A+D,r[1]=g+V,r[4]=1-f-M,r[7]=C-k,r[2]=A-D,r[5]=C+k,r[8]=1-f-y,r}var oM;(function(r){r[r.COL0ROW0=0]="COL0ROW0",r[r.COL0ROW1=1]="COL0ROW1",r[r.COL0ROW2=2]="COL0ROW2",r[r.COL1ROW0=3]="COL1ROW0",r[r.COL1ROW1=4]="COL1ROW1",r[r.COL1ROW2=5]="COL1ROW2",r[r.COL2ROW0=6]="COL2ROW0",r[r.COL2ROW1=7]="COL2ROW1",r[r.COL2ROW2=8]="COL2ROW2"})(oM||(oM={}));const tNe=Object.freeze([1,0,0,0,1,0,0,0,1]);let rs=class extends Gq{static get IDENTITY(){return nNe()}static get ZERO(){return rNe()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return oM}constructor(e,...t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):t.length>0?this.copy([e,...t]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(tNe)}fromObject(e){return this.check()}fromQuaternion(e){return eNe(this,e),this.check()}set(e,t,n,i,s,a,o,u,f){return this[0]=e,this[1]=t,this[2]=n,this[3]=i,this[4]=s,this[5]=a,this[6]=o,this[7]=u,this[8]=f,this.check()}setRowMajor(e,t,n,i,s,a,o,u,f){return this[0]=e,this[1]=i,this[2]=o,this[3]=t,this[4]=s,this[5]=u,this[6]=n,this[7]=a,this[8]=f,this.check()}determinant(){return YLe(this)}transpose(){return JLe(this,this),this.check()}invert(){return qLe(this,this),this.check()}multiplyLeft(e){return yz(this,e,this),this.check()}multiplyRight(e){return yz(this,this,e),this.check()}rotate(e){return QLe(this,this,e),this.check()}scale(e){return Array.isArray(e)?bz(this,this,e):bz(this,this,[e,e]),this.check()}translate(e){return ZLe(this,this,e),this.check()}transform(e,t){let n;switch(e.length){case 2:n=Oq(t||[-0,-0],e,this);break;case 3:n=Vq(t||[-0,-0,-0],e,this);break;case 4:n=Fq(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return l_(n,e.length),n}transformVector(e,t){return this.transform(e,t)}transformVector2(e,t){return this.transform(e,t)}transformVector3(e,t){return this.transform(e,t)}},Dx,Lx=null;function rNe(){return Dx||(Dx=new rs([0,0,0,0,0,0,0,0,0]),Object.freeze(Dx)),Dx}function nNe(){return Lx||(Lx=new rs,Object.freeze(Lx)),Lx}function iNe(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function sNe(r,e){if(r===e){const t=e[1],n=e[2],i=e[3],s=e[6],a=e[7],o=e[11];r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=t,r[6]=e[9],r[7]=e[13],r[8]=n,r[9]=s,r[11]=e[14],r[12]=i,r[13]=a,r[14]=o}else r[0]=e[0],r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=e[1],r[5]=e[5],r[6]=e[9],r[7]=e[13],r[8]=e[2],r[9]=e[6],r[10]=e[10],r[11]=e[14],r[12]=e[3],r[13]=e[7],r[14]=e[11],r[15]=e[15];return r}function oNe(r,e){const t=e[0],n=e[1],i=e[2],s=e[3],a=e[4],o=e[5],u=e[6],f=e[7],g=e[8],y=e[9],A=e[10],C=e[11],M=e[12],k=e[13],D=e[14],V=e[15],W=t*o-n*a,z=t*u-i*a,$=t*f-s*a,te=n*u-i*o,le=n*f-s*o,_e=i*f-s*u,se=g*k-y*M,Y=g*D-A*M,ce=g*V-C*M,oe=y*D-A*k,Me=y*V-C*k,ze=A*V-C*D;let Ve=W*ze-z*Me+$*oe+te*ce-le*Y+_e*se;return Ve?(Ve=1/Ve,r[0]=(o*ze-u*Me+f*oe)*Ve,r[1]=(i*Me-n*ze-s*oe)*Ve,r[2]=(k*_e-D*le+V*te)*Ve,r[3]=(A*le-y*_e-C*te)*Ve,r[4]=(u*ce-a*ze-f*Y)*Ve,r[5]=(t*ze-i*ce+s*Y)*Ve,r[6]=(D*$-M*_e-V*z)*Ve,r[7]=(g*_e-A*$+C*z)*Ve,r[8]=(a*Me-o*ce+f*se)*Ve,r[9]=(n*ce-t*Me-s*se)*Ve,r[10]=(M*le-k*$+V*W)*Ve,r[11]=(y*$-g*le-C*W)*Ve,r[12]=(o*Y-a*oe-u*se)*Ve,r[13]=(t*oe-n*Y+i*se)*Ve,r[14]=(k*z-M*te-D*W)*Ve,r[15]=(g*te-y*z+A*W)*Ve,r):null}function aNe(r){const e=r[0],t=r[1],n=r[2],i=r[3],s=r[4],a=r[5],o=r[6],u=r[7],f=r[8],g=r[9],y=r[10],A=r[11],C=r[12],M=r[13],k=r[14],D=r[15],V=e*a-t*s,W=e*o-n*s,z=t*o-n*a,$=f*M-g*C,te=f*k-y*C,le=g*k-y*M,_e=e*le-t*te+n*$,se=s*le-a*te+o*$,Y=f*z-g*W+y*V,ce=C*z-M*W+k*V;return u*_e-i*se+D*Y-A*ce}function _z(r,e,t){const n=e[0],i=e[1],s=e[2],a=e[3],o=e[4],u=e[5],f=e[6],g=e[7],y=e[8],A=e[9],C=e[10],M=e[11],k=e[12],D=e[13],V=e[14],W=e[15];let z=t[0],$=t[1],te=t[2],le=t[3];return r[0]=z*n+$*o+te*y+le*k,r[1]=z*i+$*u+te*A+le*D,r[2]=z*s+$*f+te*C+le*V,r[3]=z*a+$*g+te*M+le*W,z=t[4],$=t[5],te=t[6],le=t[7],r[4]=z*n+$*o+te*y+le*k,r[5]=z*i+$*u+te*A+le*D,r[6]=z*s+$*f+te*C+le*V,r[7]=z*a+$*g+te*M+le*W,z=t[8],$=t[9],te=t[10],le=t[11],r[8]=z*n+$*o+te*y+le*k,r[9]=z*i+$*u+te*A+le*D,r[10]=z*s+$*f+te*C+le*V,r[11]=z*a+$*g+te*M+le*W,z=t[12],$=t[13],te=t[14],le=t[15],r[12]=z*n+$*o+te*y+le*k,r[13]=z*i+$*u+te*A+le*D,r[14]=z*s+$*f+te*C+le*V,r[15]=z*a+$*g+te*M+le*W,r}function lNe(r,e,t){const n=t[0],i=t[1],s=t[2];let a,o,u,f,g,y,A,C,M,k,D,V;return e===r?(r[12]=e[0]*n+e[4]*i+e[8]*s+e[12],r[13]=e[1]*n+e[5]*i+e[9]*s+e[13],r[14]=e[2]*n+e[6]*i+e[10]*s+e[14],r[15]=e[3]*n+e[7]*i+e[11]*s+e[15]):(a=e[0],o=e[1],u=e[2],f=e[3],g=e[4],y=e[5],A=e[6],C=e[7],M=e[8],k=e[9],D=e[10],V=e[11],r[0]=a,r[1]=o,r[2]=u,r[3]=f,r[4]=g,r[5]=y,r[6]=A,r[7]=C,r[8]=M,r[9]=k,r[10]=D,r[11]=V,r[12]=a*n+g*i+M*s+e[12],r[13]=o*n+y*i+k*s+e[13],r[14]=u*n+A*i+D*s+e[14],r[15]=f*n+C*i+V*s+e[15]),r}function cNe(r,e,t){const n=t[0],i=t[1],s=t[2];return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r[4]=e[4]*i,r[5]=e[5]*i,r[6]=e[6]*i,r[7]=e[7]*i,r[8]=e[8]*s,r[9]=e[9]*s,r[10]=e[10]*s,r[11]=e[11]*s,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function uNe(r,e,t,n){let i=n[0],s=n[1],a=n[2],o=Math.sqrt(i*i+s*s+a*a),u,f,g,y,A,C,M,k,D,V,W,z,$,te,le,_e,se,Y,ce,oe,Me,ze,Ve,lt;return o<c_?null:(o=1/o,i*=o,s*=o,a*=o,f=Math.sin(t),u=Math.cos(t),g=1-u,y=e[0],A=e[1],C=e[2],M=e[3],k=e[4],D=e[5],V=e[6],W=e[7],z=e[8],$=e[9],te=e[10],le=e[11],_e=i*i*g+u,se=s*i*g+a*f,Y=a*i*g-s*f,ce=i*s*g-a*f,oe=s*s*g+u,Me=a*s*g+i*f,ze=i*a*g+s*f,Ve=s*a*g-i*f,lt=a*a*g+u,r[0]=y*_e+k*se+z*Y,r[1]=A*_e+D*se+$*Y,r[2]=C*_e+V*se+te*Y,r[3]=M*_e+W*se+le*Y,r[4]=y*ce+k*oe+z*Me,r[5]=A*ce+D*oe+$*Me,r[6]=C*ce+V*oe+te*Me,r[7]=M*ce+W*oe+le*Me,r[8]=y*ze+k*Ve+z*lt,r[9]=A*ze+D*Ve+$*lt,r[10]=C*ze+V*Ve+te*lt,r[11]=M*ze+W*Ve+le*lt,e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r)}function hNe(r,e,t){const n=Math.sin(t),i=Math.cos(t),s=e[4],a=e[5],o=e[6],u=e[7],f=e[8],g=e[9],y=e[10],A=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=s*i+f*n,r[5]=a*i+g*n,r[6]=o*i+y*n,r[7]=u*i+A*n,r[8]=f*i-s*n,r[9]=g*i-a*n,r[10]=y*i-o*n,r[11]=A*i-u*n,r}function dNe(r,e,t){const n=Math.sin(t),i=Math.cos(t),s=e[0],a=e[1],o=e[2],u=e[3],f=e[8],g=e[9],y=e[10],A=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=s*i-f*n,r[1]=a*i-g*n,r[2]=o*i-y*n,r[3]=u*i-A*n,r[8]=s*n+f*i,r[9]=a*n+g*i,r[10]=o*n+y*i,r[11]=u*n+A*i,r}function fNe(r,e,t){const n=Math.sin(t),i=Math.cos(t),s=e[0],a=e[1],o=e[2],u=e[3],f=e[4],g=e[5],y=e[6],A=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=s*i+f*n,r[1]=a*i+g*n,r[2]=o*i+y*n,r[3]=u*i+A*n,r[4]=f*i-s*n,r[5]=g*i-a*n,r[6]=y*i-o*n,r[7]=A*i-u*n,r}function pNe(r,e){const t=e[0],n=e[1],i=e[2],s=e[4],a=e[5],o=e[6],u=e[8],f=e[9],g=e[10];return r[0]=Math.sqrt(t*t+n*n+i*i),r[1]=Math.sqrt(s*s+a*a+o*o),r[2]=Math.sqrt(u*u+f*f+g*g),r}function gNe(r,e){const t=e[0],n=e[1],i=e[2],s=e[3],a=t+t,o=n+n,u=i+i,f=t*a,g=n*a,y=n*o,A=i*a,C=i*o,M=i*u,k=s*a,D=s*o,V=s*u;return r[0]=1-y-M,r[1]=g+V,r[2]=A-D,r[3]=0,r[4]=g-V,r[5]=1-f-M,r[6]=C+k,r[7]=0,r[8]=A+D,r[9]=C-k,r[10]=1-f-y,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function mNe(r,e,t,n,i,s,a){const o=1/(t-e),u=1/(i-n),f=1/(s-a);return r[0]=s*2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s*2*u,r[6]=0,r[7]=0,r[8]=(t+e)*o,r[9]=(i+n)*u,r[10]=(a+s)*f,r[11]=-1,r[12]=0,r[13]=0,r[14]=a*s*2*f,r[15]=0,r}function yNe(r,e,t,n,i){const s=1/Math.tan(e/2);if(r[0]=s/t,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0){const a=1/(n-i);r[10]=(i+n)*a,r[14]=2*i*n*a}else r[10]=-1,r[14]=-2*n;return r}const bNe=yNe;function _Ne(r,e,t,n,i,s,a){const o=1/(e-t),u=1/(n-i),f=1/(s-a);return r[0]=-2*o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*u,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*f,r[11]=0,r[12]=(e+t)*o,r[13]=(i+n)*u,r[14]=(a+s)*f,r[15]=1,r}const vNe=_Ne;function ANe(r,e,t,n){let i,s,a,o,u,f,g,y,A,C;const M=e[0],k=e[1],D=e[2],V=n[0],W=n[1],z=n[2],$=t[0],te=t[1],le=t[2];return Math.abs(M-$)<c_&&Math.abs(k-te)<c_&&Math.abs(D-le)<c_?iNe(r):(y=M-$,A=k-te,C=D-le,i=1/Math.sqrt(y*y+A*A+C*C),y*=i,A*=i,C*=i,s=W*C-z*A,a=z*y-V*C,o=V*A-W*y,i=Math.sqrt(s*s+a*a+o*o),i?(i=1/i,s*=i,a*=i,o*=i):(s=0,a=0,o=0),u=A*o-C*a,f=C*s-y*o,g=y*a-A*s,i=Math.sqrt(u*u+f*f+g*g),i?(i=1/i,u*=i,f*=i,g*=i):(u=0,f=0,g=0),r[0]=s,r[1]=u,r[2]=y,r[3]=0,r[4]=a,r[5]=f,r[6]=A,r[7]=0,r[8]=o,r[9]=g,r[10]=C,r[11]=0,r[12]=-(s*M+a*k+o*D),r[13]=-(u*M+f*k+g*D),r[14]=-(y*M+A*k+C*D),r[15]=1,r)}function xNe(){const r=new nc(4);return nc!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function wNe(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r}function CNe(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r}function TNe(r){const e=r[0],t=r[1],n=r[2],i=r[3];return Math.sqrt(e*e+t*t+n*n+i*i)}function SNe(r){const e=r[0],t=r[1],n=r[2],i=r[3];return e*e+t*t+n*n+i*i}function ENe(r,e){const t=e[0],n=e[1],i=e[2],s=e[3];let a=t*t+n*n+i*i+s*s;return a>0&&(a=1/Math.sqrt(a)),r[0]=t*a,r[1]=n*a,r[2]=i*a,r[3]=s*a,r}function INe(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]*e[3]}function PNe(r,e,t,n){const i=e[0],s=e[1],a=e[2],o=e[3];return r[0]=i+n*(t[0]-i),r[1]=s+n*(t[1]-s),r[2]=a+n*(t[2]-a),r[3]=o+n*(t[3]-o),r}function BNe(r,e,t){const n=e[0],i=e[1],s=e[2],a=e[3];return r[0]=t[0]*n+t[4]*i+t[8]*s+t[12]*a,r[1]=t[1]*n+t[5]*i+t[9]*s+t[13]*a,r[2]=t[2]*n+t[6]*i+t[10]*s+t[14]*a,r[3]=t[3]*n+t[7]*i+t[11]*s+t[15]*a,r}function MNe(r,e,t){const n=e[0],i=e[1],s=e[2],a=t[0],o=t[1],u=t[2],f=t[3],g=f*n+o*s-u*i,y=f*i+u*n-a*s,A=f*s+a*i-o*n,C=-a*n-o*i-u*s;return r[0]=g*f+C*-a+y*-u-A*-o,r[1]=y*f+C*-o+A*-a-g*-u,r[2]=A*f+C*-u+g*-o-y*-a,r[3]=e[3],r}(function(){const r=xNe();return function(e,t,n,i,s,a){let o,u;for(t||(t=4),n||(n=0),i?u=Math.min(i*t+n,e.length):u=e.length,o=n;o<u;o+=t)r[0]=e[o],r[1]=e[o+1],r[2]=e[o+2],r[3]=e[o+3],s(r,r,a),e[o]=r[0],e[o+1]=r[1],e[o+2]=r[2],e[o+3]=r[3];return e}})();var aM;(function(r){r[r.COL0ROW0=0]="COL0ROW0",r[r.COL0ROW1=1]="COL0ROW1",r[r.COL0ROW2=2]="COL0ROW2",r[r.COL0ROW3=3]="COL0ROW3",r[r.COL1ROW0=4]="COL1ROW0",r[r.COL1ROW1=5]="COL1ROW1",r[r.COL1ROW2=6]="COL1ROW2",r[r.COL1ROW3=7]="COL1ROW3",r[r.COL2ROW0=8]="COL2ROW0",r[r.COL2ROW1=9]="COL2ROW1",r[r.COL2ROW2=10]="COL2ROW2",r[r.COL2ROW3=11]="COL2ROW3",r[r.COL3ROW0=12]="COL3ROW0",r[r.COL3ROW1=13]="COL3ROW1",r[r.COL3ROW2=14]="COL3ROW2",r[r.COL3ROW3=15]="COL3ROW3"})(aM||(aM={}));const RNe=45*Math.PI/180,kNe=1,GP=.1,HP=500,ONe=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class fy extends Gq{static get IDENTITY(){return LNe()}static get ZERO(){return DNe()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return aM}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,n,i,s,a,o,u,f,g,y,A,C,M,k,D){return this[0]=e,this[1]=t,this[2]=n,this[3]=i,this[4]=s,this[5]=a,this[6]=o,this[7]=u,this[8]=f,this[9]=g,this[10]=y,this[11]=A,this[12]=C,this[13]=M,this[14]=k,this[15]=D,this.check()}setRowMajor(e,t,n,i,s,a,o,u,f,g,y,A,C,M,k,D){return this[0]=e,this[1]=s,this[2]=f,this[3]=C,this[4]=t,this[5]=a,this[6]=g,this[7]=M,this[8]=n,this[9]=o,this[10]=y,this[11]=k,this[12]=i,this[13]=u,this[14]=A,this[15]=D,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(ONe)}fromObject(e){return this.check()}fromQuaternion(e){return gNe(this,e),this.check()}frustum(e){const{left:t,right:n,bottom:i,top:s,near:a=GP,far:o=HP}=e;return o===1/0?NNe(this,t,n,i,s,a):mNe(this,t,n,i,s,a,o),this.check()}lookAt(e){const{eye:t,center:n=[0,0,0],up:i=[0,1,0]}=e;return ANe(this,t,n,i),this.check()}ortho(e){const{left:t,right:n,bottom:i,top:s,near:a=GP,far:o=HP}=e;return vNe(this,t,n,i,s,a,o),this.check()}orthographic(e){const{fovy:t=RNe,aspect:n=kNe,focalDistance:i=1,near:s=GP,far:a=HP}=e;vz(t);const o=t/2,u=i*Math.tan(o),f=u*n;return this.ortho({left:-f,right:f,bottom:-u,top:u,near:s,far:a})}perspective(e){const{fovy:t=45*Math.PI/180,aspect:n=1,near:i=.1,far:s=500}=e;return vz(t),bNe(this,t,n,i,s),this.check()}determinant(){return aNe(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const n=this.getScale(t),i=1/n[0],s=1/n[1],a=1/n[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*a,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*a,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const n=this.getScale(t),i=1/n[0],s=1/n[1],a=1/n[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*a,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*a,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*a,e}transpose(){return sNe(this,this),this.check()}invert(){return oNe(this,this),this.check()}multiplyLeft(e){return _z(this,e,this),this.check()}multiplyRight(e){return _z(this,this,e),this.check()}rotateX(e){return hNe(this,this,e),this.check()}rotateY(e){return dNe(this,this,e),this.check()}rotateZ(e){return fNe(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,t){return uNe(this,this,e,t),this.check()}scale(e){return cNe(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return lNe(this,this,e),this.check()}transform(e,t){return e.length===4?(t=BNe(t||[-0,-0,-0,-0],e,this),l_(t,4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:n}=e;let i;switch(n){case 2:i=Dq(t||[-0,-0],e,this);break;case 3:i=zD(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return l_(i,e.length),i}transformAsVector(e,t){let n;switch(e.length){case 2:n=Lq(t||[-0,-0],e,this);break;case 3:n=Nq(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return l_(n,e.length),n}transformPoint(e,t){return this.transformAsPoint(e,t)}transformVector(e,t){return this.transformAsPoint(e,t)}transformDirection(e,t){return this.transformAsVector(e,t)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,n){return this.identity().translate([e,t,n])}}let Nx,Fx;function DNe(){return Nx||(Nx=new fy([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Nx)),Nx}function LNe(){return Fx||(Fx=new fy,Object.freeze(Fx)),Fx}function vz(r){if(r>Math.PI*2)throw Error("expected radians")}function NNe(r,e,t,n,i,s){const a=2*s/(t-e),o=2*s/(i-n),u=(t+e)/(t-e),f=(i+n)/(i-n),g=-1,y=-1,A=-2*s;return r[0]=a,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=o,r[6]=0,r[7]=0,r[8]=u,r[9]=f,r[10]=g,r[11]=y,r[12]=0,r[13]=0,r[14]=A,r[15]=0,r}function Az(){const r=new nc(4);return nc!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function FNe(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r}function Hq(r,e,t){t=t*.5;const n=Math.sin(t);return r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=Math.cos(t),r}function xz(r,e,t){const n=e[0],i=e[1],s=e[2],a=e[3],o=t[0],u=t[1],f=t[2],g=t[3];return r[0]=n*g+a*o+i*f-s*u,r[1]=i*g+a*u+s*o-n*f,r[2]=s*g+a*f+n*u-i*o,r[3]=a*g-n*o-i*u-s*f,r}function UNe(r,e,t){t*=.5;const n=e[0],i=e[1],s=e[2],a=e[3],o=Math.sin(t),u=Math.cos(t);return r[0]=n*u+a*o,r[1]=i*u+s*o,r[2]=s*u-i*o,r[3]=a*u-n*o,r}function zNe(r,e,t){t*=.5;const n=e[0],i=e[1],s=e[2],a=e[3],o=Math.sin(t),u=Math.cos(t);return r[0]=n*u-s*o,r[1]=i*u+a*o,r[2]=s*u+n*o,r[3]=a*u-i*o,r}function VNe(r,e,t){t*=.5;const n=e[0],i=e[1],s=e[2],a=e[3],o=Math.sin(t),u=Math.cos(t);return r[0]=n*u+i*o,r[1]=i*u-n*o,r[2]=s*u+a*o,r[3]=a*u-s*o,r}function $Ne(r,e){const t=e[0],n=e[1],i=e[2];return r[0]=t,r[1]=n,r[2]=i,r[3]=Math.sqrt(Math.abs(1-t*t-n*n-i*i)),r}function $w(r,e,t,n){const i=e[0],s=e[1],a=e[2],o=e[3];let u=t[0],f=t[1],g=t[2],y=t[3],A,C,M,k,D;return A=i*u+s*f+a*g+o*y,A<0&&(A=-A,u=-u,f=-f,g=-g,y=-y),1-A>c_?(C=Math.acos(A),D=Math.sin(C),M=Math.sin((1-n)*C)/D,k=Math.sin(n*C)/D):(M=1-n,k=n),r[0]=M*i+k*u,r[1]=M*s+k*f,r[2]=M*a+k*g,r[3]=M*o+k*y,r}function jNe(r,e){const t=e[0],n=e[1],i=e[2],s=e[3],a=t*t+n*n+i*i+s*s,o=a?1/a:0;return r[0]=-t*o,r[1]=-n*o,r[2]=-i*o,r[3]=s*o,r}function GNe(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=e[3],r}function Wq(r,e){const t=e[0]+e[4]+e[8];let n;if(t>0)n=Math.sqrt(t+1),r[3]=.5*n,n=.5/n,r[0]=(e[5]-e[7])*n,r[1]=(e[6]-e[2])*n,r[2]=(e[1]-e[3])*n;else{let i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);const s=(i+1)%3,a=(i+2)%3;n=Math.sqrt(e[i*3+i]-e[s*3+s]-e[a*3+a]+1),r[i]=.5*n,n=.5/n,r[3]=(e[s*3+a]-e[a*3+s])*n,r[s]=(e[s*3+i]+e[i*3+s])*n,r[a]=(e[a*3+i]+e[i*3+a])*n}return r}const HNe=wNe,WNe=CNe,KNe=INe,XNe=PNe,JNe=TNe,qNe=SNe,Kq=ENe,YNe=function(){const r=Uq(),e=mz(1,0,0),t=mz(0,1,0);return function(n,i,s){const a=UD(i,s);return a<-.999999?(Vw(r,e,i),KLe(r)<1e-6&&Vw(r,t,i),$Le(r,r),Hq(n,r,Math.PI),n):a>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(Vw(r,i,s),n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=1+a,Kq(n,n))}}();(function(){const r=Az(),e=Az();return function(t,n,i,s,a,o){return $w(r,n,a,o),$w(e,i,s,o),$w(t,r,e,2*o*(1-o)),t}})();(function(){const r=XLe();return function(e,t,n,i){return r[0]=n[0],r[3]=n[1],r[6]=n[2],r[1]=i[0],r[4]=i[1],r[7]=i[2],r[2]=-t[0],r[5]=-t[1],r[8]=-t[2],Kq(e,Wq(e,r))}})();const ZNe=[0,0,0,1];class lM extends LD{constructor(e=0,t=0,n=0,i=1){super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,t,n,i)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,n,i){return this[0]=e,this[1]=t,this[2]=n,this[3]=i,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return Wq(this,e),this.check()}fromAxisRotation(e,t){return Hq(this,e,t),this.check()}identity(){return FNe(this),this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=Nn(e)}get y(){return this[1]}set y(e){this[1]=Nn(e)}get z(){return this[2]}set z(e){this[2]=Nn(e)}get w(){return this[3]}set w(e){this[3]=Nn(e)}len(){return JNe(this)}lengthSquared(){return qNe(this)}dot(e){return KNe(this,e)}rotationTo(e,t){return YNe(this,e,t),this.check()}add(e){return HNe(this,this,e),this.check()}calculateW(){return $Ne(this,this),this.check()}conjugate(){return GNe(this,this),this.check()}invert(){return jNe(this,this),this.check()}lerp(e,t,n){return n===void 0?this.lerp(this,e,t):(XNe(this,e,t,n),this.check())}multiplyRight(e){return xz(this,this,e),this.check()}multiplyLeft(e){return xz(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,e===0&&(this[3]=1),this.check()}rotateX(e){return UNe(this,this,e),this.check()}rotateY(e){return zNe(this,this,e),this.check()}rotateZ(e){return VNe(this,this,e),this.check()}scale(e){return WNe(this,this,e),this.check()}slerp(e,t,n){let i,s,a;switch(arguments.length){case 1:({start:i=ZNe,target:s,ratio:a}=e);break;case 2:i=this,s=e,a=t;break;default:i=e,s=t,a=n}return $w(this,i,s,a),this.check()}transformVector4(e,t=new VD){return MNe(t,e,this),l_(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}const QNe=.1,eFe=1e-12,Xq=1e-15,tFe=1e-20,rFe=6378137,nFe=6378137,iFe=6356752314245179e-9;function l2(r){return r}new zt;function sFe(r,e=[],t=l2){return"longitude"in r?(e[0]=t(r.longitude),e[1]=t(r.latitude),e[2]=r.height):"x"in r?(e[0]=t(r.x),e[1]=t(r.y),e[2]=r.z):(e[0]=t(r[0]),e[1]=t(r[1]),e[2]=r[2]),e}function oFe(r,e=[]){return sFe(r,e,Rs._cartographicRadians?l2:PLe)}function aFe(r,e,t=l2){return"longitude"in e?(e.longitude=t(r[0]),e.latitude=t(r[1]),e.height=r[2]):"x"in e?(e.x=t(r[0]),e.y=t(r[1]),e.z=r[2]):(e[0]=t(r[0]),e[1]=t(r[1]),e[2]=r[2]),e}function lFe(r,e){return aFe(r,e,Rs._cartographicRadians?l2:BLe)}const wz=1e-14,cFe=new zt,Cz={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},WP={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},c0={east:new zt,north:new zt,up:new zt,west:new zt,south:new zt,down:new zt},uFe=new zt,hFe=new zt,dFe=new zt;function Tz(r,e,t,n,i,s){const a=Cz[e]&&Cz[e][t];td(a&&(!n||n===a));let o,u,f;const g=cFe.copy(i);if(nv(g.x,0,wz)&&nv(g.y,0,wz)){const y=Math.sign(g.z);o=uFe.fromArray(WP[e]),e!=="east"&&e!=="west"&&o.scale(y),u=hFe.fromArray(WP[t]),t!=="east"&&t!=="west"&&u.scale(y),f=dFe.fromArray(WP[n]),n!=="east"&&n!=="west"&&f.scale(y)}else{const{up:y,east:A,north:C}=c0;A.set(-g.y,g.x,0).normalize(),r.geodeticSurfaceNormal(g,y),C.copy(y).cross(A);const{down:M,west:k,south:D}=c0;M.copy(y).scale(-1),k.copy(A).scale(-1),D.copy(C).scale(-1),o=c0[e],u=c0[t],f=c0[n]}return s[0]=o.x,s[1]=o.y,s[2]=o.z,s[3]=0,s[4]=u.x,s[5]=u.y,s[6]=u.z,s[7]=0,s[8]=f.x,s[9]=f.y,s[10]=f.z,s[11]=0,s[12]=g.x,s[13]=g.y,s[14]=g.z,s[15]=1,s}const em=new zt,fFe=new zt,pFe=new zt;function gFe(r,e,t=[]){const{oneOverRadii:n,oneOverRadiiSquared:i,centerToleranceSquared:s}=e;em.from(r);const a=em.x,o=em.y,u=em.z,f=n.x,g=n.y,y=n.z,A=a*a*f*f,C=o*o*g*g,M=u*u*y*y,k=A+C+M,D=Math.sqrt(1/k);if(!Number.isFinite(D))return;const V=fFe;if(V.copy(r).scale(D),k<s)return V.to(t);const W=i.x,z=i.y,$=i.z,te=pFe;te.set(V.x*W*2,V.y*z*2,V.z*$*2);let le=(1-D)*em.len()/(.5*te.len()),_e=0,se,Y,ce,oe;do{le-=_e,se=1/(1+le*W),Y=1/(1+le*z),ce=1/(1+le*$);const Me=se*se,ze=Y*Y,Ve=ce*ce,lt=Me*se,gt=ze*Y,At=Ve*ce;oe=A*Me+C*ze+M*Ve-1;const Tt=-2*(A*lt*W+C*gt*z+M*At*$);_e=oe/Tt}while(Math.abs(oe)>eFe);return em.scale([se,Y,ce]).to(t)}const Ux=new zt,Sz=new zt,mFe=new zt,Ll=new zt,yFe=new zt,zx=new zt;let uT=class{constructor(e=0,t=0,n=0){this.centerToleranceSquared=QNe,td(e>=0),td(t>=0),td(n>=0),this.radii=new zt(e,t,n),this.radiiSquared=new zt(e*e,t*t,n*n),this.radiiToTheFourth=new zt(e*e*e*e,t*t*t*t,n*n*n*n),this.oneOverRadii=new zt(e===0?0:1/e,t===0?0:1/t,n===0?0:1/n),this.oneOverRadiiSquared=new zt(e===0?0:1/(e*e),t===0?0:1/(t*t),n===0?0:1/(n*n)),this.minimumRadius=Math.min(e,t,n),this.maximumRadius=Math.max(e,t,n),this.radiiSquared.z!==0&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}equals(e){return this===e||!!(e&&this.radii.equals(e.radii))}toString(){return this.radii.toString()}cartographicToCartesian(e,t=[0,0,0]){const n=Sz,i=mFe,[,,s]=e;this.geodeticSurfaceNormalCartographic(e,n),i.copy(this.radiiSquared).scale(n);const a=Math.sqrt(n.dot(i));return i.scale(1/a),n.scale(s),i.add(n),i.to(t)}cartesianToCartographic(e,t=[0,0,0]){zx.from(e);const n=this.scaleToGeodeticSurface(zx,Ll);if(!n)return;const i=this.geodeticSurfaceNormal(n,Sz),s=yFe;s.copy(zx).subtract(n);const a=Math.atan2(i.y,i.x),o=Math.asin(i.z),u=Math.sign(UD(s,zx))*zq(s);return lFe([a,o,u],t)}eastNorthUpToFixedFrame(e,t=new fy){return Tz(this,"east","north","up",e,t)}localFrameToFixedFrame(e,t,n,i,s=new fy){return Tz(this,e,t,n,i,s)}geocentricSurfaceNormal(e,t=[0,0,0]){return Ux.from(e).normalize().to(t)}geodeticSurfaceNormalCartographic(e,t=[0,0,0]){const n=oFe(e),i=n[0],s=n[1],a=Math.cos(s);return Ux.set(a*Math.cos(i),a*Math.sin(i),Math.sin(s)).normalize(),Ux.to(t)}geodeticSurfaceNormal(e,t=[0,0,0]){return Ux.from(e).scale(this.oneOverRadiiSquared).normalize().to(t)}scaleToGeodeticSurface(e,t){return gFe(e,this,t)}scaleToGeocentricSurface(e,t=[0,0,0]){Ll.from(e);const n=Ll.x,i=Ll.y,s=Ll.z,a=this.oneOverRadiiSquared,o=1/Math.sqrt(n*n*a.x+i*i*a.y+s*s*a.z);return Ll.multiplyScalar(o).to(t)}transformPositionToScaledSpace(e,t=[0,0,0]){return Ll.from(e).scale(this.oneOverRadii).to(t)}transformPositionFromScaledSpace(e,t=[0,0,0]){return Ll.from(e).scale(this.radii).to(t)}getSurfaceNormalIntersectionWithZAxis(e,t=0,n=[0,0,0]){td(nv(this.radii.x,this.radii.y,Xq)),td(this.radii.z>0),Ll.from(e);const i=Ll.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(i)>=this.radii.z-t))return Ll.set(0,0,i).to(n)}};uT.WGS84=new uT(rFe,nFe,iFe);const $m={OUTSIDE:-1,INTERSECTING:0,INSIDE:1};new zt;new zt;const u0=new zt,Ez=new zt;class $D{constructor(e=[0,0,0],t=0){this.radius=-0,this.center=new zt,this.fromCenterRadius(e,t)}fromCenterRadius(e,t){return this.center.from(e),this.radius=t,this}fromCornerPoints(e,t){return t=u0.from(t),this.center=new zt().from(e).add(t).scale(.5),this.radius=this.center.distance(t),this}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new $D(this.center,this.radius)}union(e){const t=this.center,n=this.radius,i=e.center,s=e.radius,a=u0.copy(i).subtract(t),o=a.magnitude();if(n>=o+s)return this.clone();if(s>=o+n)return e.clone();const u=(n+o+s)*.5;return Ez.copy(a).scale((-n+u)/o).add(t),this.center.copy(Ez),this.radius=u,this}expand(e){const t=u0.from(e).subtract(this.center).magnitude();return t>this.radius&&(this.radius=t),this}transform(e){this.center.transform(e);const t=pNe(u0,e);return this.radius=Math.max(t[0],Math.max(t[1],t[2]))*this.radius,this}distanceSquaredTo(e){const t=this.distanceTo(e);return t*t}distanceTo(e){const t=u0.from(e).subtract(this.center);return Math.max(0,t.len()-this.radius)}intersectPlane(e){const t=this.center,n=this.radius,i=e.normal.dot(t)+e.distance;return i<-n?$m.OUTSIDE:i<n?$m.INTERSECTING:$m.INSIDE}}const bFe=new zt,_Fe=new zt,Vx=new zt,$x=new zt,jx=new zt,vFe=new zt,AFe=new zt,Iu={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class jD{constructor(e=[0,0,0],t=[0,0,0,0,0,0,0,0,0]){this.center=new zt().from(e),this.halfAxes=new rs(t)}get halfSize(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2);return[new zt(e).len(),new zt(t).len(),new zt(n).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2),i=new zt(e).normalize(),s=new zt(t).normalize(),a=new zt(n).normalize();return new lM().fromMatrix3(new rs([...i,...s,...a]))}fromCenterHalfSizeQuaternion(e,t,n){const i=new lM(n),s=new rs().fromQuaternion(i);return s[0]=s[0]*t[0],s[1]=s[1]*t[0],s[2]=s[2]*t[0],s[3]=s[3]*t[1],s[4]=s[4]*t[1],s[5]=s[5]*t[1],s[6]=s[6]*t[2],s[7]=s[7]*t[2],s[8]=s[8]*t[2],this.center=new zt().from(e),this.halfAxes=s,this}clone(){return new jD(this.center,this.halfAxes)}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new $D){const t=this.halfAxes,n=t.getColumn(0,Vx),i=t.getColumn(1,$x),s=t.getColumn(2,jx),a=bFe.copy(n).add(i).add(s);return e.center.copy(this.center),e.radius=a.magnitude(),e}intersectPlane(e){const t=this.center,n=e.normal,i=this.halfAxes,s=n.x,a=n.y,o=n.z,u=Math.abs(s*i[Iu.COLUMN0ROW0]+a*i[Iu.COLUMN0ROW1]+o*i[Iu.COLUMN0ROW2])+Math.abs(s*i[Iu.COLUMN1ROW0]+a*i[Iu.COLUMN1ROW1]+o*i[Iu.COLUMN1ROW2])+Math.abs(s*i[Iu.COLUMN2ROW0]+a*i[Iu.COLUMN2ROW1]+o*i[Iu.COLUMN2ROW2]),f=n.dot(t)+e.distance;return f<=-u?$m.OUTSIDE:f>=u?$m.INSIDE:$m.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const t=_Fe.from(e).subtract(this.center),n=this.halfAxes,i=n.getColumn(0,Vx),s=n.getColumn(1,$x),a=n.getColumn(2,jx),o=i.magnitude(),u=s.magnitude(),f=a.magnitude();i.normalize(),s.normalize(),a.normalize();let g=0,y;return y=Math.abs(t.dot(i))-o,y>0&&(g+=y*y),y=Math.abs(t.dot(s))-u,y>0&&(g+=y*y),y=Math.abs(t.dot(a))-f,y>0&&(g+=y*y),g}computePlaneDistances(e,t,n=[-0,-0]){let i=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const a=this.center,o=this.halfAxes,u=o.getColumn(0,Vx),f=o.getColumn(1,$x),g=o.getColumn(2,jx),y=vFe.copy(u).add(f).add(g).add(a),A=AFe.copy(y).subtract(e);let C=t.dot(A);return i=Math.min(C,i),s=Math.max(C,s),y.copy(a).add(u).add(f).subtract(g),A.copy(y).subtract(e),C=t.dot(A),i=Math.min(C,i),s=Math.max(C,s),y.copy(a).add(u).subtract(f).add(g),A.copy(y).subtract(e),C=t.dot(A),i=Math.min(C,i),s=Math.max(C,s),y.copy(a).add(u).subtract(f).subtract(g),A.copy(y).subtract(e),C=t.dot(A),i=Math.min(C,i),s=Math.max(C,s),a.copy(y).subtract(u).add(f).add(g),A.copy(y).subtract(e),C=t.dot(A),i=Math.min(C,i),s=Math.max(C,s),a.copy(y).subtract(u).add(f).subtract(g),A.copy(y).subtract(e),C=t.dot(A),i=Math.min(C,i),s=Math.max(C,s),a.copy(y).subtract(u).subtract(f).add(g),A.copy(y).subtract(e),C=t.dot(A),i=Math.min(C,i),s=Math.max(C,s),a.copy(y).subtract(u).subtract(f).subtract(g),A.copy(y).subtract(e),C=t.dot(A),i=Math.min(C,i),s=Math.max(C,s),n[0]=i,n[1]=s,n}transform(e){this.center.transformAsPoint(e);const t=this.halfAxes.getColumn(0,Vx);t.transformAsPoint(e);const n=this.halfAxes.getColumn(1,$x);n.transformAsPoint(e);const i=this.halfAxes.getColumn(2,jx);return i.transformAsPoint(e),this.halfAxes=new rs([...t,...n,...i]),this}getTransform(){throw new Error("not implemented")}}new zt;new zt;new zt([1,0,0]),new zt([0,1,0]),new zt([0,0,1]);new zt;new zt;new zt;new zt;new zt;new zt;new zt;new zt;new zt;new zt;new zt;new zt;new zt;new zt;new zt;new zt;new zt;new zt;new zt;const Bc=new rs,xFe=new rs,wFe=new rs,Gx=new rs,Iz=new rs;function CFe(r,e={}){const t=tFe,n=10;let i=0,s=0;const a=xFe,o=wFe;a.identity(),o.copy(r);const u=t*TFe(o);for(;s<n&&SFe(o)>u;)EFe(o,Gx),Iz.copy(Gx).transpose(),o.multiplyRight(Gx),o.multiplyLeft(Iz),a.multiplyRight(Gx),++i>2&&(++s,i=0);return e.unitary=a.toTarget(e.unitary),e.diagonal=o.toTarget(e.diagonal),e}function TFe(r){let e=0;for(let t=0;t<9;++t){const n=r[t];e+=n*n}return Math.sqrt(e)}const cM=[1,0,0],uM=[2,2,1];function SFe(r){let e=0;for(let t=0;t<3;++t){const n=r[Bc.getElementIndex(uM[t],cM[t])];e+=2*n*n}return Math.sqrt(e)}function EFe(r,e){const t=Xq;let n=0,i=1;for(let f=0;f<3;++f){const g=Math.abs(r[Bc.getElementIndex(uM[f],cM[f])]);g>n&&(i=f,n=g)}const s=cM[i],a=uM[i];let o=1,u=0;if(Math.abs(r[Bc.getElementIndex(a,s)])>t){const f=r[Bc.getElementIndex(a,a)],g=r[Bc.getElementIndex(s,s)],y=r[Bc.getElementIndex(a,s)],A=(f-g)/2/y;let C;A<0?C=-1/(-A+Math.sqrt(1+A*A)):C=1/(A+Math.sqrt(1+A*A)),o=1/Math.sqrt(1+C*C),u=C*o}return rs.IDENTITY.to(e),e[Bc.getElementIndex(s,s)]=e[Bc.getElementIndex(a,a)]=o,e[Bc.getElementIndex(a,s)]=u,e[Bc.getElementIndex(s,a)]=-u,e}const Hh=new zt,IFe=new zt,PFe=new zt,BFe=new zt,MFe=new zt,RFe=new rs,kFe={diagonal:new rs,unitary:new rs};function OFe(r,e=new jD){if(!r||r.length===0)return e.halfAxes=new rs([0,0,0,0,0,0,0,0,0]),e.center=new zt,e;const t=r.length,n=new zt(0,0,0);for(const Y of r)n.add(Y);const i=1/t;n.multiplyByScalar(i);let s=0,a=0,o=0,u=0,f=0,g=0;for(const Y of r){const ce=Hh.copy(Y).subtract(n);s+=ce.x*ce.x,a+=ce.x*ce.y,o+=ce.x*ce.z,u+=ce.y*ce.y,f+=ce.y*ce.z,g+=ce.z*ce.z}s*=i,a*=i,o*=i,u*=i,f*=i,g*=i;const y=RFe;y[0]=s,y[1]=a,y[2]=o,y[3]=a,y[4]=u,y[5]=f,y[6]=o,y[7]=f,y[8]=g;const{unitary:A}=CFe(y,kFe),C=e.halfAxes.copy(A);let M=C.getColumn(0,PFe),k=C.getColumn(1,BFe),D=C.getColumn(2,MFe),V=-Number.MAX_VALUE,W=-Number.MAX_VALUE,z=-Number.MAX_VALUE,$=Number.MAX_VALUE,te=Number.MAX_VALUE,le=Number.MAX_VALUE;for(const Y of r)Hh.copy(Y),V=Math.max(Hh.dot(M),V),W=Math.max(Hh.dot(k),W),z=Math.max(Hh.dot(D),z),$=Math.min(Hh.dot(M),$),te=Math.min(Hh.dot(k),te),le=Math.min(Hh.dot(D),le);M=M.multiplyByScalar(.5*($+V)),k=k.multiplyByScalar(.5*(te+W)),D=D.multiplyByScalar(.5*(le+z)),e.center.copy(M).add(k).add(D);const _e=IFe.set(V-$,W-te,z-le).multiplyByScalar(.5),se=new rs([_e[0],0,0,0,_e[1],0,0,0,_e[2]]);return e.halfAxes.multiplyRight(se),e}const DFe=r=>typeof r=="boolean",u_=r=>typeof r=="function",sA=r=>r!==null&&typeof r=="object",Pz=r=>sA(r)&&r.constructor==={}.constructor,LFe=r=>!!r&&typeof r[Symbol.iterator]=="function",NFe=r=>r&&typeof r[Symbol.asyncIterator]=="function",Cp=r=>typeof Response<"u"&&r instanceof Response||r&&r.arrayBuffer&&r.text&&r.json,Tp=r=>typeof Blob<"u"&&r instanceof Blob,FFe=r=>r&&typeof r=="object"&&r.isBuffer,UFe=r=>typeof ReadableStream<"u"&&r instanceof ReadableStream||sA(r)&&u_(r.tee)&&u_(r.cancel)&&u_(r.getReader),zFe=r=>sA(r)&&u_(r.read)&&u_(r.pipe)&&DFe(r.readable),Jq=r=>UFe(r)||zFe(r);class VFe extends Error{constructor(e,t){super(e),Cr(this,"reason"),Cr(this,"url"),Cr(this,"response"),this.reason=t.reason,this.url=t.url,this.response=t.response}}const $Fe=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,jFe=/^([-\w.]+\/[-\w.+]+)/;function Bz(r,e){return r.toLowerCase()===e.toLowerCase()}function GFe(r){const e=jFe.exec(r);return e?e[1]:r}function Mz(r){const e=$Fe.exec(r);return e?e[1]:""}const qq=/\?.*/;function HFe(r){const e=r.match(qq);return e&&e[0]}function GD(r){return r.replace(qq,"")}function WFe(r){if(r.length<50)return r;const e=r.slice(r.length-15);return`${r.substr(0,32)}...${e}`}function c2(r){return Cp(r)?r.url:Tp(r)?r.name||"":typeof r=="string"?r:""}function HD(r){if(Cp(r)){const e=r,t=e.headers.get("content-type")||"",n=GD(e.url);return GFe(t)||Mz(n)}return Tp(r)?r.type||"":typeof r=="string"?Mz(r):""}function KFe(r){return Cp(r)?r.headers["content-length"]||-1:Tp(r)?r.size:typeof r=="string"?r.length:r instanceof ArrayBuffer||ArrayBuffer.isView(r)?r.byteLength:-1}async function Yq(r){if(Cp(r))return r;const e={},t=KFe(r);t>=0&&(e["content-length"]=String(t));const n=c2(r),i=HD(r);i&&(e["content-type"]=i);const s=await qFe(r);s&&(e["x-first-bytes"]=s),typeof r=="string"&&(r=new TextEncoder().encode(r));const a=new Response(r,{headers:e});return Object.defineProperty(a,"url",{value:n}),a}async function XFe(r){if(!r.ok)throw await JFe(r)}async function JFe(r){const e=WFe(r.url);let t=`Failed to fetch resource (${r.status}) ${r.statusText}: ${e}`;t=t.length>100?`${t.slice(0,100)}...`:t;const n={reason:r.statusText,url:r.url,response:r};try{const i=r.headers.get("Content-Type");n.reason=!r.bodyUsed&&i!=null&&i.includes("application/json")?await r.json():await r.text()}catch{}return new VFe(t,n)}async function qFe(r){if(typeof r=="string")return`data:,${r.slice(0,5)}`;if(r instanceof Blob){const e=r.slice(0,5);return await new Promise(t=>{const n=new FileReader;n.onload=i=>{var s;return t((s=i?.target)==null?void 0:s.result)},n.readAsDataURL(e)})}if(r instanceof ArrayBuffer){const e=r.slice(0,5);return`data:base64,${YFe(e)}`}return null}function YFe(r){let e="";const t=new Uint8Array(r);for(let n=0;n<t.byteLength;n++)e+=String.fromCharCode(t[n]);return btoa(e)}function ZFe(r){return!QFe(r)&&!e4e(r)}function QFe(r){return r.startsWith("http:")||r.startsWith("https:")}function e4e(r){return r.startsWith("data:")}async function Rz(r,e){var t,n;if(typeof r=="string"){const i=vLe(r);return ZFe(i)&&(t=globalThis.loaders)!=null&&t.fetchNode?(n=globalThis.loaders)==null?void 0:n.fetchNode(i,e):await fetch(i,e)}return await Yq(r)}const kz=new a2({id:"loaders.gl"});class t4e{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class r4e{constructor(){Cr(this,"console"),this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}}const Zq={fetch:null,mimeType:void 0,nothrow:!1,log:new r4e,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:o2,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},n4e={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function Qq(){globalThis.loaders=globalThis.loaders||{};const{loaders:r}=globalThis;return r._state||(r._state={}),r._state}function eY(){const r=Qq();return r.globalOptions=r.globalOptions||{...Zq},r.globalOptions}function i4e(r,e,t,n){return t=t||[],t=Array.isArray(t)?t:[t],s4e(r,t),a4e(e,r,n)}function s4e(r,e){Oz(r,null,Zq,n4e,e);for(const t of e){const n=r&&r[t.id]||{},i=t.options&&t.options[t.id]||{},s=t.deprecatedOptions&&t.deprecatedOptions[t.id]||{};Oz(n,t.id,i,s,e)}}function Oz(r,e,t,n,i){const s=e||"Top level",a=e?`${e}.`:"";for(const o in r){const u=!e&&sA(r[o]),f=o==="baseUri"&&!e,g=o==="workerUrl"&&e;if(!(o in t)&&!f&&!g){if(o in n)kz.warn(`${s} loader option '${a}${o}' no longer supported, use '${n[o]}'`)();else if(!u){const y=o4e(o,i);kz.warn(`${s} loader option '${a}${o}' not recognized. ${y}`)()}}}}function o4e(r,e){const t=r.toLowerCase();let n="";for(const i of e)for(const s in i.options){if(r===s)return`Did you mean '${i.id}.${s}'?`;const a=s.toLowerCase();(t.startsWith(a)||a.startsWith(t))&&(n=n||`Did you mean '${i.id}.${s}'?`)}return n}function a4e(r,e,t){const n={...r.options||{}};return l4e(n,t),n.log===null&&(n.log=new t4e),Dz(n,eY()),Dz(n,e),n}function Dz(r,e){for(const t in e)if(t in e){const n=e[t];Pz(n)&&Pz(r[t])?r[t]={...r[t],...e[t]}:r[t]=e[t]}}function l4e(r,e){e&&!("baseUri"in r)&&(r.baseUri=e)}function WD(r){return r?(Array.isArray(r)&&(r=r[0]),Array.isArray(r?.extensions)):!1}function tY(r){ys(r,"null loader"),ys(WD(r),"invalid loader");let e;return Array.isArray(r)&&(e=r[1],r=r[0],r={...r,options:{...r.options,...e}}),(r!=null&&r.parseTextSync||r!=null&&r.parseText)&&(r.text=!0),r.text||(r.binary=!0),r}const c4e=()=>{const r=Qq();return r.loaderRegistry=r.loaderRegistry||[],r.loaderRegistry};function u4e(){return c4e()}const h4e=/\.([^.]+)$/;async function d4e(r,e=[],t,n){if(!rY(r))return null;let i=Lz(r,e,{...t,nothrow:!0});if(i)return i;if(Tp(r)&&(r=await r.slice(0,10).arrayBuffer(),i=Lz(r,e,t)),!i&&!(t!=null&&t.nothrow))throw new Error(nY(r));return i}function Lz(r,e=[],t,n){if(!rY(r))return null;if(e&&!Array.isArray(e))return tY(e);let i=[];e&&(i=i.concat(e)),t!=null&&t.ignoreRegisteredLoaders||i.push(...u4e()),p4e(i);const s=f4e(r,i,t);if(!s&&!(t!=null&&t.nothrow))throw new Error(nY(r));return s}function f4e(r,e,t,n){const i=c2(r),s=HD(r),a=GD(i)||void 0;let o=null,u="";return t!=null&&t.mimeType&&(o=KP(e,t?.mimeType),u=`match forced by supplied MIME type ${t?.mimeType}`),o=o||g4e(e,a),u=u||(o?`matched url ${a}`:""),o=o||KP(e,s),u=u||(o?`matched MIME type ${s}`:""),o=o||y4e(e,r),u=u||(o?`matched initial data ${iY(r)}`:""),t!=null&&t.fallbackMimeType&&(o=o||KP(e,t?.fallbackMimeType),u=u||(o?`matched fallback MIME type ${s}`:"")),u&&jDe.log(1,`selectLoader selected ${o?.name}: ${u}.`),o}function rY(r){return!(r instanceof Response&&r.status===204)}function nY(r){const e=c2(r),t=HD(r);let n="No valid loader found (";n+=e?`${Rq(e)}, `:"no url provided, ",n+=`MIME type: ${t?`"${t}"`:"not provided"}, `;const i=r?iY(r):"";return n+=i?` first bytes: "${i}"`:"first bytes: not available",n+=")",n}function p4e(r){for(const e of r)tY(e)}function g4e(r,e){const t=e&&h4e.exec(e),n=t&&t[1];return n?m4e(r,n):null}function m4e(r,e){e=e.toLowerCase();for(const t of r)for(const n of t.extensions)if(n.toLowerCase()===e)return t;return null}function KP(r,e){var t;for(const n of r)if((t=n.mimeTypes)!=null&&t.some(i=>Bz(e,i))||Bz(e,`application/x.${n.id}`))return n;return null}function y4e(r,e){if(!e)return null;for(const t of r)if(typeof e=="string"){if(b4e(e,t))return t}else if(ArrayBuffer.isView(e)){if(Nz(e.buffer,e.byteOffset,t))return t}else if(e instanceof ArrayBuffer&&Nz(e,0,t))return t;return null}function b4e(r,e){return e.testText?e.testText(r):(Array.isArray(e.tests)?e.tests:[e.tests]).some(t=>r.startsWith(t))}function Nz(r,e,t){return(Array.isArray(t.tests)?t.tests:[t.tests]).some(n=>_4e(r,e,t,n))}function _4e(r,e,t,n){if(n instanceof ArrayBuffer)return pLe(n,r,n.byteLength);switch(typeof n){case"function":return n(r);case"string":const i=hM(r,e,n.length);return n===i;default:return!1}}function iY(r,e=5){return typeof r=="string"?r.slice(0,e):ArrayBuffer.isView(r)?hM(r.buffer,r.byteOffset,e):r instanceof ArrayBuffer?hM(r,0,e):""}function hM(r,e,t){if(r.byteLength<e+t)return"";const n=new DataView(r);let i="";for(let s=0;s<t;s++)i+=String.fromCharCode(n.getUint8(e+s));return i}const v4e=256*1024;function*A4e(r,e){const t=e?.chunkSize||v4e;let n=0;const i=new TextEncoder;for(;n<r.length;){const s=Math.min(r.length-n,t),a=r.slice(n,n+s);n+=s,yield i.encode(a)}}const x4e=256*1024;function*w4e(r,e={}){const{chunkSize:t=x4e}=e;let n=0;for(;n<r.byteLength;){const i=Math.min(r.byteLength-n,t),s=new ArrayBuffer(i),a=new Uint8Array(r,n,i);new Uint8Array(s).set(a),n+=i,yield s}}const C4e=1024*1024;async function*T4e(r,e){const t=e?.chunkSize||C4e;let n=0;for(;n<r.size;){const i=n+t,s=await r.slice(n,i).arrayBuffer();n=i,yield s}}function Fz(r,e){return o2?S4e(r,e):E4e(r)}async function*S4e(r,e){const t=r.getReader();let n;try{for(;;){const i=n||t.read();e!=null&&e._streamReadAhead&&(n=t.read());const{done:s,value:a}=await i;if(s)return;yield Mq(a)}}catch{t.releaseLock()}}async function*E4e(r,e){for await(const t of r)yield Mq(t)}function I4e(r,e){if(typeof r=="string")return A4e(r,e);if(r instanceof ArrayBuffer)return w4e(r,e);if(Tp(r))return T4e(r,e);if(Jq(r))return Fz(r,e);if(Cp(r))return Fz(r.body,e);throw new Error("makeIterator")}const sY="Cannot convert supplied data type";function P4e(r,e,t){if(e.text&&typeof r=="string")return r;if(FFe(r)&&(r=r.buffer),r instanceof ArrayBuffer){const n=r;return e.text&&!e.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(r)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(r);let n=r.buffer;const i=r.byteLength||r.length;return(r.byteOffset!==0||i!==n.byteLength)&&(n=n.slice(r.byteOffset,r.byteOffset+i)),n}throw new Error(sY)}async function B4e(r,e,t){const n=r instanceof ArrayBuffer||ArrayBuffer.isView(r);if(typeof r=="string"||n)return P4e(r,e);if(Tp(r)&&(r=await Yq(r)),Cp(r)){const i=r;return await XFe(i),e.binary?await i.arrayBuffer():await i.text()}if(Jq(r)&&(r=I4e(r,t)),LFe(r)||NFe(r))return bLe(r);throw new Error(sY)}function oY(r,e){const t=eY(),n=r||t;return typeof n.fetch=="function"?n.fetch:sA(n.fetch)?i=>Rz(i,n.fetch):e!=null&&e.fetch?e?.fetch:Rz}function M4e(r,e,t){if(t)return t;const n={fetch:oY(e,r),...r};if(n.url){const i=GD(n.url);n.baseUrl=i,n.queryString=HFe(n.url),n.filename=Rq(i),n.baseUrl=kq(i)}return Array.isArray(n.loaders)||(n.loaders=null),n}function R4e(r,e){if(r&&!Array.isArray(r))return r;let t;if(r&&(t=Array.isArray(r)?r:[r]),e&&e.loaders){const n=Array.isArray(e.loaders)?e.loaders:[e.loaders];t=t?[...t,...n]:n}return t&&t.length?t:void 0}async function hT(r,e,t,n){e&&!Array.isArray(e)&&!WD(e)&&(n=void 0,t=e,e=void 0),r=await r,t=t||{};const i=c2(r),s=R4e(e,n),a=await d4e(r,s,t);return a?(t=i4e(t,a,s,i),n=M4e({url:i,_parse:hT,loaders:s},t,n||null),await k4e(a,r,t,n)):null}async function k4e(r,e,t,n){if(nLe(r),t=GDe(r.options,t),Cp(e)){const s=e,{ok:a,redirected:o,status:u,statusText:f,type:g,url:y}=s,A=Object.fromEntries(s.headers.entries());n.response={headers:A,ok:a,redirected:o,status:u,statusText:f,type:g,url:y}}e=await B4e(e,r,t);const i=r;if(i.parseTextSync&&typeof e=="string")return i.parseTextSync(e,t,n);if(cLe(r,t))return await uLe(r,e,t,n,hT);if(i.parseText&&typeof e=="string")return await i.parseText(e,t,n);if(i.parse)return await i.parse(e,t,n);throw th(!i.parseSync),new Error(`${r.id} loader - no parser found and worker is disabled`)}function O4e(r){switch(r.constructor){case Int8Array:return"int8";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int16Array:return"int16";case Uint16Array:return"uint16";case Int32Array:return"int32";case Uint32Array:return"uint32";case Float32Array:return"float32";case Float64Array:return"float64";default:return"null"}}function D4e(r){let e=1/0,t=1/0,n=1/0,i=-1/0,s=-1/0,a=-1/0;const o=r.POSITION?r.POSITION.value:[],u=o&&o.length;for(let f=0;f<u;f+=3){const g=o[f],y=o[f+1],A=o[f+2];e=g<e?g:e,t=y<t?y:t,n=A<n?A:n,i=g>i?g:i,s=y>s?y:s,a=A>a?A:a}return[[e,t,n],[i,s,a]]}function L4e(r,e,t){const n=O4e(e.value),i=t||N4e(e);return{name:r,type:{type:"fixed-size-list",listSize:e.size,children:[{name:"value",type:n}]},nullable:!1,metadata:i}}function N4e(r){const e={};return"byteOffset"in r&&(e.byteOffset=r.byteOffset.toString(10)),"byteStride"in r&&(e.byteStride=r.byteStride.toString(10)),"normalized"in r&&(e.normalized=r.normalized.toString()),e}async function aY(r,e,t,n){let i,s;!Array.isArray(e)&&!WD(e)?(i=[],s=e):(i=e,s=t);const a=oY(s);let o=r;return typeof r=="string"&&(o=await a(r)),Tp(r)&&(o=await a(r)),Array.isArray(i)?await hT(o,i,s):await hT(o,i,s)}var dT;(function(r){r[r.ADD=1]="ADD",r[r.REPLACE=2]="REPLACE"})(dT||(dT={}));var Tm;(function(r){r.EMPTY="empty",r.SCENEGRAPH="scenegraph",r.POINTCLOUD="pointcloud",r.MESH="mesh"})(Tm||(Tm={}));var dM;(function(r){r.I3S="I3S",r.TILES3D="TILES3D"})(dM||(dM={}));var py;(function(r){r.GEOMETRIC_ERROR="geometricError",r.MAX_SCREEN_THRESHOLD="maxScreenThreshold"})(py||(py={}));const lY="4.3.2",h0={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GLTF:"glTF"};function cY(r,e,t){ys(r instanceof ArrayBuffer);const n=new TextDecoder("utf8"),i=new Uint8Array(r,e,t);return n.decode(i)}function F4e(r,e=0){const t=new DataView(r);return`${String.fromCharCode(t.getUint8(e+0))}${String.fromCharCode(t.getUint8(e+1))}${String.fromCharCode(t.getUint8(e+2))}${String.fromCharCode(t.getUint8(e+3))}`}const U4e="4.3.2",z4e={dataType:null,batchType:null,name:"Draco",id:"draco",module:"draco",version:U4e,worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:typeof WebAssembly=="object"?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};function V4e(r,e,t){const n=uY(e.metadata),i=[],s=$4e(e.attributes);for(const a in r){const o=r[a],u=Uz(a,o,s[a]);i.push(u)}if(t){const a=Uz("indices",t);i.push(a)}return{fields:i,metadata:n}}function $4e(r){const e={};for(const t in r){const n=r[t];e[n.name||"undefined"]=n}return e}function Uz(r,e,t){const n=t?uY(t.metadata):void 0;return L4e(r,e,n)}function uY(r){Object.entries(r);const e={};for(const t in r)e[`${t}.string`]=JSON.stringify(r[t]);return e}const zz={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},j4e={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},G4e=4;class H4e{constructor(e){Cr(this,"draco"),Cr(this,"decoder"),Cr(this,"metadataQuerier"),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e,t={}){const n=new this.draco.DecoderBuffer;n.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(t);const i=this.decoder.GetEncodedGeometryType(n),s=i===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let a;switch(i){case this.draco.TRIANGULAR_MESH:a=this.decoder.DecodeBufferToMesh(n,s);break;case this.draco.POINT_CLOUD:a=this.decoder.DecodeBufferToPointCloud(n,s);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!a.ok()||!s.ptr){const y=`DRACO decompression failed: ${a.error_msg()}`;throw new Error(y)}const o=this._getDracoLoaderData(s,i,t),u=this._getMeshData(s,o,t),f=D4e(u.attributes),g=V4e(u.attributes,o,u.indices);return{loader:"draco",loaderData:o,header:{vertexCount:s.num_points(),boundingBox:f},...u,schema:g}}finally{this.draco.destroy(n),s&&this.draco.destroy(s)}}_getDracoLoaderData(e,t,n){const i=this._getTopLevelMetadata(e),s=this._getDracoAttributes(e,n);return{geometry_type:t,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:i,attributes:s}}_getDracoAttributes(e,t){const n={};for(let i=0;i<e.num_attributes();i++){const s=this.decoder.GetAttribute(e,i),a=this._getAttributeMetadata(e,i);n[s.unique_id()]={unique_id:s.unique_id(),attribute_type:s.attribute_type(),data_type:s.data_type(),num_components:s.num_components(),byte_offset:s.byte_offset(),byte_stride:s.byte_stride(),normalized:s.normalized(),attribute_index:i,metadata:a};const o=this._getQuantizationTransform(s,t);o&&(n[s.unique_id()].quantization_transform=o);const u=this._getOctahedronTransform(s,t);u&&(n[s.unique_id()].octahedron_transform=u)}return n}_getMeshData(e,t,n){const i=this._getMeshAttributes(t,e,n);if(!i.POSITION)throw new Error("DRACO: No position attribute found.");if(e instanceof this.draco.Mesh)switch(n.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:i,indices:{value:this._getTriangleStripIndices(e),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:i,indices:{value:this._getTriangleListIndices(e),size:1}}}return{topology:"point-list",mode:0,attributes:i}}_getMeshAttributes(e,t,n){const i={};for(const s of Object.values(e.attributes)){const a=this._deduceAttributeName(s,n);s.name=a;const o=this._getAttributeValues(t,s);if(o){const{value:u,size:f}=o;i[a]={value:u,size:f,byteOffset:s.byte_offset,byteStride:s.byte_stride,normalized:s.normalized}}}return i}_getTriangleListIndices(e){const t=e.num_faces()*3,n=t*G4e,i=this.draco._malloc(n);try{return this.decoder.GetTrianglesUInt32Array(e,n,i),new Uint32Array(this.draco.HEAPF32.buffer,i,t).slice()}finally{this.draco._free(i)}}_getTriangleStripIndices(e){const t=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,t),X4e(t)}finally{this.draco.destroy(t)}}_getAttributeValues(e,t){const n=j4e[t.data_type];if(!n)return console.warn(`DRACO: Unsupported attribute type ${t.data_type}`),null;const i=t.num_components,s=e.num_points()*i,a=s*n.BYTES_PER_ELEMENT,o=W4e(this.draco,n);let u;const f=this.draco._malloc(a);try{const g=this.decoder.GetAttribute(e,t.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,g,o,a,f),u=new n(this.draco.HEAPF32.buffer,f,s).slice()}finally{this.draco._free(f)}return{value:u,size:i}}_deduceAttributeName(e,t){const n=e.unique_id;for(const[a,o]of Object.entries(t.extraAttributes||{}))if(o===n)return a;const i=e.attribute_type;for(const a in zz)if(this.draco[a]===i)return zz[a];const s=t.attributeNameEntry||"name";return e.metadata[s]?e.metadata[s].string:`CUSTOM_ATTRIBUTE_${n}`}_getTopLevelMetadata(e){const t=this.decoder.GetMetadata(e);return this._getDracoMetadata(t)}_getAttributeMetadata(e,t){const n=this.decoder.GetAttributeMetadata(e,t);return this._getDracoMetadata(n)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const t={},n=this.metadataQuerier.NumEntries(e);for(let i=0;i<n;i++){const s=this.metadataQuerier.GetEntryName(e,i);t[s]=this._getDracoMetadataField(e,s)}return t}_getDracoMetadataField(e,t){const n=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,t,n);const i=K4e(n);return{int:this.metadataQuerier.GetIntEntry(e,t),string:this.metadataQuerier.GetStringEntry(e,t),double:this.metadataQuerier.GetDoubleEntry(e,t),intArray:i}}finally{this.draco.destroy(n)}}_disableAttributeTransforms(e){const{quantizedAttributes:t=[],octahedronAttributes:n=[]}=e,i=[...t,...n];for(const s of i)this.decoder.SkipAttributeTransform(this.draco[s])}_getQuantizationTransform(e,t){const{quantizedAttributes:n=[]}=t,i=e.attribute_type();if(n.map(s=>this.decoder[s]).includes(i)){const s=new this.draco.AttributeQuantizationTransform;try{if(s.InitFromAttribute(e))return{quantization_bits:s.quantization_bits(),range:s.range(),min_values:new Float32Array([1,2,3]).map(a=>s.min_value(a))}}finally{this.draco.destroy(s)}}return null}_getOctahedronTransform(e,t){const{octahedronAttributes:n=[]}=t,i=e.attribute_type();if(n.map(s=>this.decoder[s]).includes(i)){const s=new this.draco.AttributeQuantizationTransform;try{if(s.InitFromAttribute(e))return{quantization_bits:s.quantization_bits()}}finally{this.draco.destroy(s)}}return null}}function W4e(r,e){switch(e){case Float32Array:return r.DT_FLOAT32;case Int8Array:return r.DT_INT8;case Int16Array:return r.DT_INT16;case Int32Array:return r.DT_INT32;case Uint8Array:return r.DT_UINT8;case Uint16Array:return r.DT_UINT16;case Uint32Array:return r.DT_UINT32;default:return r.DT_INVALID}}function K4e(r){const e=r.size(),t=new Int32Array(e);for(let n=0;n<e;n++)t[n]=r.GetValue(n);return t}function X4e(r){const e=r.size(),t=new Int32Array(e);for(let n=0;n<e;n++)t[n]=r.GetValue(n);return t}const J4e="1.5.6",q4e="1.4.1",XP=`https://www.gstatic.com/draco/versioned/decoders/${J4e}`,sa={DECODER:"draco_wasm_wrapper.js",DECODER_WASM:"draco_decoder.wasm",FALLBACK_DECODER:"draco_decoder.js",ENCODER:"draco_encoder.js"},JP={[sa.DECODER]:`${XP}/${sa.DECODER}`,[sa.DECODER_WASM]:`${XP}/${sa.DECODER_WASM}`,[sa.FALLBACK_DECODER]:`${XP}/${sa.FALLBACK_DECODER}`,[sa.ENCODER]:`https://raw.githubusercontent.com/google/draco/${q4e}/javascript/${sa.ENCODER}`};let d0;async function Y4e(r){const e=r.modules||{};return e.draco3d?d0||(d0=e.draco3d.createDecoderModule({}).then(t=>({draco:t}))):d0||(d0=Z4e(r)),await d0}async function Z4e(r){let e,t;switch(r.draco&&r.draco.decoderType){case"js":e=await Qf(JP[sa.FALLBACK_DECODER],"draco",r,sa.FALLBACK_DECODER);break;case"wasm":default:[e,t]=await Promise.all([await Qf(JP[sa.DECODER],"draco",r,sa.DECODER),await Qf(JP[sa.DECODER_WASM],"draco",r,sa.DECODER_WASM)])}return e=e||globalThis.DracoDecoderModule,await Q4e(e,t)}function Q4e(r,e){const t={};return e&&(t.wasmBinary=e),new Promise(n=>{r({...t,onModuleLoaded:i=>n({draco:i})})})}const hY={...z4e,parse:e6e};async function e6e(r,e){const{draco:t}=await Y4e(e),n=new H4e(t);try{return n.parseSync(r,e?.draco)}finally{n.destroy()}}const t6e={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},_s={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},An={...t6e,..._s},qP={[_s.DOUBLE]:Float64Array,[_s.FLOAT]:Float32Array,[_s.UNSIGNED_SHORT]:Uint16Array,[_s.UNSIGNED_INT]:Uint32Array,[_s.UNSIGNED_BYTE]:Uint8Array,[_s.BYTE]:Int8Array,[_s.SHORT]:Int16Array,[_s.INT]:Int32Array},r6e={DOUBLE:_s.DOUBLE,FLOAT:_s.FLOAT,UNSIGNED_SHORT:_s.UNSIGNED_SHORT,UNSIGNED_INT:_s.UNSIGNED_INT,UNSIGNED_BYTE:_s.UNSIGNED_BYTE,BYTE:_s.BYTE,SHORT:_s.SHORT,INT:_s.INT},YP="Failed to convert GL type";class jc{static fromTypedArray(e){e=ArrayBuffer.isView(e)?e.constructor:e;for(const t in qP)if(qP[t]===e)return t;throw new Error(YP)}static fromName(e){const t=r6e[e];if(!t)throw new Error(YP);return t}static getArrayType(e){switch(e){case _s.UNSIGNED_SHORT_5_6_5:case _s.UNSIGNED_SHORT_4_4_4_4:case _s.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:const t=qP[e];if(!t)throw new Error(YP);return t}}static getByteSize(e){return jc.getArrayType(e).BYTES_PER_ELEMENT}static validate(e){return!!jc.getArrayType(e)}static createTypedArray(e,t,n=0,i){i===void 0&&(i=(t.byteLength-n)/jc.getByteSize(e));const s=jc.getArrayType(e);return new s(t,n,i)}}function n6e(r,e){if(!r)throw new Error(`math.gl assertion failed. ${e}`)}function i6e(r,e=[0,0,0]){const t=r>>11&31,n=r>>5&63,i=r&31;return e[0]=t<<3,e[1]=n<<2,e[2]=i<<3,e}new FD;new zt;new FD;new FD;function Vz(r,e=255){return kLe(r,0,e)/e*2-1}function $z(r){return r<0?-1:1}function s6e(r,e,t,n){if(n6e(n),r<0||r>t||e<0||e>t)throw new Error(`x and y must be unsigned normalized integers between 0 and ${t}`);if(n.x=Vz(r,t),n.y=Vz(e,t),n.z=1-(Math.abs(n.x)+Math.abs(n.y)),n.z<0){const i=n.x;n.x=(1-Math.abs(n.y))*$z(i),n.y=(1-Math.abs(i))*$z(n.y)}return n.normalize()}function o6e(r,e,t){return s6e(r,e,255,t)}class KD{constructor(e,t){Cr(this,"json"),Cr(this,"buffer"),Cr(this,"featuresLength",0),Cr(this,"_cachedTypedArrays",{}),this.json=e,this.buffer=t}getExtension(e){return this.json.extensions&&this.json.extensions[e]}hasProperty(e){return!!this.json[e]}getGlobalProperty(e,t=An.UNSIGNED_INT,n=1){const i=this.json[e];return i&&Number.isFinite(i.byteOffset)?this._getTypedArrayFromBinary(e,t,n,1,i.byteOffset):i}getPropertyArray(e,t,n){const i=this.json[e];return i&&Number.isFinite(i.byteOffset)?("componentType"in i&&(t=jc.fromName(i.componentType)),this._getTypedArrayFromBinary(e,t,n,this.featuresLength,i.byteOffset)):this._getTypedArrayFromArray(e,t,i)}getProperty(e,t,n,i,s){const a=this.json[e];if(!a)return a;const o=this.getPropertyArray(e,t,n);if(n===1)return o[i];for(let u=0;u<n;++u)s[u]=o[n*i+u];return s}_getTypedArrayFromBinary(e,t,n,i,s){const a=this._cachedTypedArrays;let o=a[e];return o||(o=jc.createTypedArray(t,this.buffer.buffer,this.buffer.byteOffset+s,i*n),a[e]=o),o}_getTypedArrayFromArray(e,t,n){const i=this._cachedTypedArrays;let s=i[e];return s||(s=jc.createTypedArray(t,n),i[e]=s),s}}const a6e={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},l6e={SCALAR:(r,e)=>r[e],VEC2:(r,e)=>[r[2*e+0],r[2*e+1]],VEC3:(r,e)=>[r[3*e+0],r[3*e+1],r[3*e+2]],VEC4:(r,e)=>[r[4*e+0],r[4*e+1],r[4*e+2],r[4*e+3]],MAT2:(r,e)=>[r[4*e+0],r[4*e+1],r[4*e+2],r[4*e+3]],MAT3:(r,e)=>[r[9*e+0],r[9*e+1],r[9*e+2],r[9*e+3],r[9*e+4],r[9*e+5],r[9*e+6],r[9*e+7],r[9*e+8]],MAT4:(r,e)=>[r[16*e+0],r[16*e+1],r[16*e+2],r[16*e+3],r[16*e+4],r[16*e+5],r[16*e+6],r[16*e+7],r[16*e+8],r[16*e+9],r[16*e+10],r[16*e+11],r[16*e+12],r[16*e+13],r[16*e+14],r[16*e+15]]},c6e={SCALAR:(r,e,t)=>{e[t]=r},VEC2:(r,e,t)=>{e[2*t+0]=r[0],e[2*t+1]=r[1]},VEC3:(r,e,t)=>{e[3*t+0]=r[0],e[3*t+1]=r[1],e[3*t+2]=r[2]},VEC4:(r,e,t)=>{e[4*t+0]=r[0],e[4*t+1]=r[1],e[4*t+2]=r[2],e[4*t+3]=r[3]},MAT2:(r,e,t)=>{e[4*t+0]=r[0],e[4*t+1]=r[1],e[4*t+2]=r[2],e[4*t+3]=r[3]},MAT3:(r,e,t)=>{e[9*t+0]=r[0],e[9*t+1]=r[1],e[9*t+2]=r[2],e[9*t+3]=r[3],e[9*t+4]=r[4],e[9*t+5]=r[5],e[9*t+6]=r[6],e[9*t+7]=r[7],e[9*t+8]=r[8],e[9*t+9]=r[9]},MAT4:(r,e,t)=>{e[16*t+0]=r[0],e[16*t+1]=r[1],e[16*t+2]=r[2],e[16*t+3]=r[3],e[16*t+4]=r[4],e[16*t+5]=r[5],e[16*t+6]=r[6],e[16*t+7]=r[7],e[16*t+8]=r[8],e[16*t+9]=r[9],e[16*t+10]=r[10],e[16*t+11]=r[11],e[16*t+12]=r[12],e[16*t+13]=r[13],e[16*t+14]=r[14],e[16*t+15]=r[15]}};function u6e(r,e,t,n){const{componentType:i}=r;ys(r.componentType);const s=typeof i=="string"?jc.fromName(i):i,a=a6e[r.type],o=l6e[r.type],u=c6e[r.type];return t+=r.byteOffset,{values:jc.createTypedArray(s,e,t,a*n),type:s,size:a,unpacker:o,packer:u}}const Fc=r=>r!==void 0;function h6e(r,e,t){if(!e)return null;let n=r.getExtension("3DTILES_batch_table_hierarchy");const i=e.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),e.extensions=e.extensions||{},e.extensions["3DTILES_batch_table_hierarchy"]=i,n=i),n?d6e(n,t):null}function d6e(r,e){let t,n,i;const s=r.instancesLength,a=r.classes;let o=r.classIds,u=r.parentCounts,f=r.parentIds,g=s;Fc(o.byteOffset)&&(o.componentType=defaultValue(o.componentType,GL.UNSIGNED_SHORT),o.type=AttributeType.SCALAR,i=getBinaryAccessor(o),o=i.createArrayBufferView(e.buffer,e.byteOffset+o.byteOffset,s));let y;if(Fc(u))for(Fc(u.byteOffset)&&(u.componentType=defaultValue(u.componentType,GL.UNSIGNED_SHORT),u.type=AttributeType.SCALAR,i=getBinaryAccessor(u),u=i.createArrayBufferView(e.buffer,e.byteOffset+u.byteOffset,s)),y=new Uint16Array(s),g=0,t=0;t<s;++t)y[t]=g,g+=u[t];Fc(f)&&Fc(f.byteOffset)&&(f.componentType=defaultValue(f.componentType,GL.UNSIGNED_SHORT),f.type=AttributeType.SCALAR,i=getBinaryAccessor(f),f=i.createArrayBufferView(e.buffer,e.byteOffset+f.byteOffset,g));const A=a.length;for(t=0;t<A;++t){const D=a[t].length,V=a[t].instances,W=getBinaryProperties(D,V,e);a[t].instances=combine(W,V)}const C=new Array(A).fill(0),M=new Uint16Array(s);for(t=0;t<s;++t)n=o[t],M[t]=C[n],++C[n];const k={classes:a,classIds:o,classIndexes:M,parentCounts:u,parentIndexes:y,parentIds:f};return g6e(k),k}function f0(r,e,t){if(!r)return;const n=r.parentCounts;return r.parentIds?t(r,e):n>0?f6e(r,e,t):p6e(r,e,t)}function f6e(r,e,t){const n=r.classIds,i=r.parentCounts,s=r.parentIds,a=r.parentIndexes,o=n.length,u=scratchVisited;u.length=Math.max(u.length,o);const f=++marker,g=scratchStack;for(g.length=0,g.push(e);g.length>0;){if(e=g.pop(),u[e]===f)continue;u[e]=f;const y=t(r,e);if(Fc(y))return y;const A=i[e],C=a[e];for(let M=0;M<A;++M){const k=s[C+M];k!==e&&g.push(k)}}return null}function p6e(r,e,t){let n=!0;for(;n;){const i=t(r,e);if(Fc(i))return i;const s=r.parentIds[e];n=s!==e,e=s}throw new Error("traverseHierarchySingleParent")}function g6e(r){const e=r.classIds.length;for(let t=0;t<e;++t)dY(r,t,stack)}function dY(r,e,t){const n=r.parentCounts,i=r.parentIds,s=r.parentIndexes,a=r.classIds.length;if(!Fc(i))return;assert(e<a,`Parent index ${e} exceeds the total number of instances: ${a}`),assert(t.indexOf(e)===-1,"Circular dependency detected in the batch table hierarchy."),t.push(e);const o=Fc(n)?n[e]:1,u=Fc(n)?s[e]:e;for(let f=0;f<o;++f){const g=i[u+f];g!==e&&dY(r,g,t)}t.pop(e)}function Qo(r){return r!=null}const Hx=(r,e)=>r,m6e={HIERARCHY:!0,extensions:!0,extras:!0};class fY{constructor(e,t,n,i={}){Cr(this,"json"),Cr(this,"binary"),Cr(this,"featureCount"),Cr(this,"_extensions"),Cr(this,"_properties"),Cr(this,"_binaryProperties"),Cr(this,"_hierarchy");var s;ys(n>=0),this.json=e||{},this.binary=t,this.featureCount=n,this._extensions=((s=this.json)==null?void 0:s.extensions)||{},this._properties={};for(const a in this.json)m6e[a]||(this._properties[a]=this.json[a]);this._binaryProperties=this._initializeBinaryProperties(),i["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=h6e(this,this.json,this.binary))}getExtension(e){return this.json&&this.json.extensions&&this.json.extensions[e]}memorySizeInBytes(){return 0}isClass(e,t){if(this._checkBatchId(e),ys(typeof t=="string",t),this._hierarchy){const n=f0(this._hierarchy,e,(i,s)=>{const a=i.classIds[s];return i.classes[a].name===t});return Qo(n)}return!1}isExactClass(e,t){return ys(typeof t=="string",t),this.getExactClassName(e)===t}getExactClassName(e){if(this._checkBatchId(e),this._hierarchy){const t=this._hierarchy.classIds[e];return this._hierarchy.classes[t].name}}hasProperty(e,t){return this._checkBatchId(e),ys(typeof t=="string",t),Qo(this._properties[t])||this._hasPropertyInHierarchy(e,t)}getPropertyNames(e,t){this._checkBatchId(e),t=Qo(t)?t:[],t.length=0;const n=Object.keys(this._properties);return t.push(...n),this._hierarchy&&this._getPropertyNamesInHierarchy(e,t),t}getProperty(e,t){if(this._checkBatchId(e),ys(typeof t=="string",t),this._binaryProperties){const i=this._binaryProperties[t];if(Qo(i))return this._getBinaryProperty(i,e)}const n=this._properties[t];if(Qo(n))return Hx(n[e]);if(this._hierarchy){const i=this._getHierarchyProperty(e,t);if(Qo(i))return i}}setProperty(e,t,n){const i=this.featureCount;if(this._checkBatchId(e),ys(typeof t=="string",t),this._binaryProperties){const a=this._binaryProperties[t];if(a){this._setBinaryProperty(a,e,n);return}}if(this._hierarchy&&this._setHierarchyProperty(this,e,t,n))return;let s=this._properties[t];Qo(s)||(this._properties[t]=new Array(i),s=this._properties[t]),s[e]=Hx(n)}_checkBatchId(e){if(!(e>=0&&e<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}_getBinaryProperty(e,t){return e.unpack(e.typedArray,t)}_setBinaryProperty(e,t,n){e.pack(n,e.typedArray,t)}_initializeBinaryProperties(){let e=null;for(const t in this._properties){const n=this._properties[t],i=this._initializeBinaryProperty(t,n);i&&(e=e||{},e[t]=i)}return e}_initializeBinaryProperty(e,t){if("byteOffset"in t){const n=t;ys(this.binary,`Property ${e} requires a batch table binary.`),ys(n.type,`Property ${e} requires a type.`);const i=u6e(n,this.binary.buffer,this.binary.byteOffset|0,this.featureCount);return{typedArray:i.values,componentCount:i.size,unpack:i.unpacker,pack:i.packer}}return null}_hasPropertyInHierarchy(e,t){if(!this._hierarchy)return!1;const n=f0(this._hierarchy,e,(i,s)=>{const a=i.classIds[s],o=i.classes[a].instances;return Qo(o[t])});return Qo(n)}_getPropertyNamesInHierarchy(e,t){f0(this._hierarchy,e,(n,i)=>{const s=n.classIds[i],a=n.classes[s].instances;for(const o in a)a.hasOwnProperty(o)&&t.indexOf(o)===-1&&t.push(o)})}_getHierarchyProperty(e,t){return f0(this._hierarchy,e,(n,i)=>{const s=n.classIds[i],a=n.classes[s],o=n.classIndexes[i],u=a.instances[t];return Qo(u)?Qo(u.typedArray)?this._getBinaryProperty(u,o):Hx(u[o]):null})}_setHierarchyProperty(e,t,n,i){const s=f0(this._hierarchy,t,(a,o)=>{const u=a.classIds[o],f=a.classes[u],g=a.classIndexes[o],y=f.instances[n];return Qo(y)?(ys(o===t,`Inherited property "${n}" is read-only.`),Qo(y.typedArray)?this._setBinaryProperty(y,g,i):y[g]=Hx(i),!0):!1});return Qo(s)}}const ZP=4;function u2(r,e,t=0){const n=new DataView(e);if(r.magic=n.getUint32(t,!0),t+=ZP,r.version=n.getUint32(t,!0),t+=ZP,r.byteLength=n.getUint32(t,!0),t+=ZP,r.version!==1)throw new Error(`3D Tile Version ${r.version} not supported`);return t}const tm=4,jz="b3dm tile in legacy format.";function XD(r,e,t){const n=new DataView(e);let i;r.header=r.header||{};let s=n.getUint32(t,!0);t+=tm;let a=n.getUint32(t,!0);t+=tm;let o=n.getUint32(t,!0);t+=tm;let u=n.getUint32(t,!0);return t+=tm,o>=570425344?(t-=tm*2,i=s,o=a,u=0,s=0,a=0,console.warn(jz)):u>=570425344&&(t-=tm,i=o,o=s,u=a,s=0,a=0,console.warn(jz)),r.header.featureTableJsonByteLength=s,r.header.featureTableBinaryByteLength=a,r.header.batchTableJsonByteLength=o,r.header.batchTableBinaryByteLength=u,r.header.batchLength=i,t}function JD(r,e,t,n){return t=y6e(r,e,t),t=b6e(r,e,t),t}function y6e(r,e,t,n){const{featureTableJsonByteLength:i,featureTableBinaryByteLength:s,batchLength:a}=r.header||{};if(r.featureTableJson={BATCH_LENGTH:a||0},i&&i>0){const o=cY(e,t,i);r.featureTableJson=JSON.parse(o)}return t+=i||0,r.featureTableBinary=new Uint8Array(e,t,s),t+=s||0,t}function b6e(r,e,t,n){const{batchTableJsonByteLength:i,batchTableBinaryByteLength:s}=r.header||{};if(i&&i>0){const a=cY(e,t,i);r.batchTableJson=JSON.parse(a),t+=i,s&&s>0&&(r.batchTableBinary=new Uint8Array(e,t,s),r.batchTableBinary=new Uint8Array(r.batchTableBinary),t+=s)}return t}function pY(r,e,t){if(!e&&(!r||!r.batchIds||!t))return null;const{batchIds:n,isRGB565:i,pointCount:s=0}=r;if(n&&t){const a=new Uint8ClampedArray(s*3);for(let o=0;o<s;o++){const u=n[o],f=t.getProperty(u,"dimensions").map(g=>g*255);a[o*3]=f[0],a[o*3+1]=f[1],a[o*3+2]=f[2]}return{type:An.UNSIGNED_BYTE,value:a,size:3,normalized:!0}}if(e&&i){const a=new Uint8ClampedArray(s*3);for(let o=0;o<s;o++){const u=i6e(e[o]);a[o*3]=u[0],a[o*3+1]=u[1],a[o*3+2]=u[2]}return{type:An.UNSIGNED_BYTE,value:a,size:3,normalized:!0}}return e&&e.length===s*3?{type:An.UNSIGNED_BYTE,value:e,size:3,normalized:!0}:{type:An.UNSIGNED_BYTE,value:e||new Uint8ClampedArray,size:4,normalized:!0}}const Gz=new zt;function _6e(r,e){if(!e)return null;if(r.isOctEncoded16P){const t=new Float32Array((r.pointsLength||0)*3);for(let n=0;n<(r.pointsLength||0);n++)o6e(e[n*2],e[n*2+1],Gz),Gz.toArray(t,n*3);return{type:An.FLOAT,size:2,value:t}}return{type:An.FLOAT,size:2,value:e}}function v6e(r,e,t){return r.isQuantized?t["3d-tiles"]&&t["3d-tiles"].decodeQuantizedPositions?(r.isQuantized=!1,A6e(r,e)):{type:An.UNSIGNED_SHORT,value:e,size:3,normalized:!0}:e}function A6e(r,e){const t=new zt,n=new Float32Array(r.pointCount*3);for(let i=0;i<r.pointCount;i++)t.set(e[i*3],e[i*3+1],e[i*3+2]).scale(1/r.quantizedRange).multiply(r.quantizedVolumeScale).add(r.quantizedVolumeOffset).toArray(n,i*3);return n}async function x6e(r,e,t,n,i){t=u2(r,e,t),t=XD(r,e,t),t=JD(r,e,t),w6e(r);const{featureTable:s,batchTable:a}=C6e(r);return await P6e(r,s,a,n,i),T6e(r,s,n),S6e(r,s,a),E6e(r,s),t}function w6e(r){r.attributes={positions:null,colors:null,normals:null,batchIds:null},r.isQuantized=!1,r.isTranslucent=!1,r.isRGB565=!1,r.isOctEncoded16P=!1}function C6e(r){const e=new KD(r.featureTableJson,r.featureTableBinary),t=e.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(t))throw new Error("POINTS_LENGTH must be defined");e.featuresLength=t,r.featuresLength=t,r.pointsLength=t,r.pointCount=t,r.rtcCenter=e.getGlobalProperty("RTC_CENTER",An.FLOAT,3);const n=I6e(r,e);return{featureTable:e,batchTable:n}}function T6e(r,e,t){if(r.attributes=r.attributes||{positions:null,colors:null,normals:null,batchIds:null},!r.attributes.positions){if(e.hasProperty("POSITION"))r.attributes.positions=e.getPropertyArray("POSITION",An.FLOAT,3);else if(e.hasProperty("POSITION_QUANTIZED")){const n=e.getPropertyArray("POSITION_QUANTIZED",An.UNSIGNED_SHORT,3);if(r.isQuantized=!0,r.quantizedRange=65535,r.quantizedVolumeScale=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",An.FLOAT,3),!r.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(r.quantizedVolumeOffset=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",An.FLOAT,3),!r.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");r.attributes.positions=v6e(r,n,t)}}if(!r.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function S6e(r,e,t){if(r.attributes=r.attributes||{positions:null,colors:null,normals:null,batchIds:null},!r.attributes.colors){let n=null;e.hasProperty("RGBA")?(n=e.getPropertyArray("RGBA",An.UNSIGNED_BYTE,4),r.isTranslucent=!0):e.hasProperty("RGB")?n=e.getPropertyArray("RGB",An.UNSIGNED_BYTE,3):e.hasProperty("RGB565")&&(n=e.getPropertyArray("RGB565",An.UNSIGNED_SHORT,1),r.isRGB565=!0),r.attributes.colors=pY(r,n,t)}e.hasProperty("CONSTANT_RGBA")&&(r.constantRGBA=e.getGlobalProperty("CONSTANT_RGBA",An.UNSIGNED_BYTE,4))}function E6e(r,e){if(r.attributes=r.attributes||{positions:null,colors:null,normals:null,batchIds:null},!r.attributes.normals){let t=null;e.hasProperty("NORMAL")?t=e.getPropertyArray("NORMAL",An.FLOAT,3):e.hasProperty("NORMAL_OCT16P")&&(t=e.getPropertyArray("NORMAL_OCT16P",An.UNSIGNED_BYTE,2),r.isOctEncoded16P=!0),r.attributes.normals=_6e(r,t)}}function I6e(r,e){let t=null;if(!r.batchIds&&e.hasProperty("BATCH_ID")&&(r.batchIds=e.getPropertyArray("BATCH_ID",An.UNSIGNED_SHORT,1),r.batchIds)){const n=e.getGlobalProperty("BATCH_LENGTH");if(!n)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");const{batchTableJson:i,batchTableBinary:s}=r;t=new fY(i,s,n)}return t}async function P6e(r,e,t,n,i){let s,a,o;const u=r.batchTableJson&&r.batchTableJson.extensions&&r.batchTableJson.extensions["3DTILES_draco_point_compression"];u&&(o=u.properties);const f=e.getExtension("3DTILES_draco_point_compression");if(f){a=f.properties;const y=f.byteOffset,A=f.byteLength;if(!a||!Number.isFinite(y)||!A)throw new Error("Draco properties, byteOffset, and byteLength must be defined");s=(r.featureTableBinary||[]).slice(y,y+A),r.hasPositions=Number.isFinite(a.POSITION),r.hasColors=Number.isFinite(a.RGB)||Number.isFinite(a.RGBA),r.hasNormals=Number.isFinite(a.NORMAL),r.hasBatchIds=Number.isFinite(a.BATCH_ID),r.isTranslucent=Number.isFinite(a.RGBA)}if(!s)return!0;const g={buffer:s,properties:{...a,...o},batchTableProperties:o};return await B6e(r,g,n,i)}async function B6e(r,e,t,n){if(!n)return;const i={...t,draco:{...t?.draco,extraAttributes:e.batchTableProperties||{}}};delete i["3d-tiles"];const s=await nA(e.buffer,hY,i,n),a=s.attributes.POSITION&&s.attributes.POSITION.value,o=s.attributes.COLOR_0&&s.attributes.COLOR_0.value,u=s.attributes.NORMAL&&s.attributes.NORMAL.value,f=s.attributes.BATCH_ID&&s.attributes.BATCH_ID.value,g=a&&s.attributes.POSITION.value.quantization,y=u&&s.attributes.NORMAL.value.quantization;if(g){const C=s.POSITION.data.quantization,M=C.range;r.quantizedVolumeScale=new zt(M,M,M),r.quantizedVolumeOffset=new zt(C.minValues),r.quantizedRange=(1<<C.quantizationBits)-1,r.isQuantizedDraco=!0}y&&(r.octEncodedRange=(1<<s.NORMAL.data.quantization.quantizationBits)-1,r.isOctEncodedDraco=!0);const A={};if(e.batchTableProperties)for(const C of Object.keys(e.batchTableProperties))s.attributes[C]&&s.attributes[C].value&&(A[C.toLowerCase()]=s.attributes[C].value);r.attributes={positions:a,colors:pY(r,o,void 0),normals:u,batchIds:f,...A}}const M6e="4.3.2";var Hz;const R6e=(Hz=globalThis.loaders)==null?void 0:Hz.parseImageNode,fM=typeof Image<"u",pM=typeof ImageBitmap<"u",k6e=!!R6e,gM=o2?!0:k6e;function O6e(r){switch(r){case"auto":return pM||fM||gM;case"imagebitmap":return pM;case"image":return fM;case"data":return gM;default:throw new Error(`@loaders.gl/images: image ${r} not supported in this environment`)}}function D6e(){if(pM)return"imagebitmap";if(fM)return"image";if(gM)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function L6e(r){const e=N6e(r);if(!e)throw new Error("Not an image");return e}function gY(r){switch(L6e(r)){case"data":return r;case"image":case"imagebitmap":const e=document.createElement("canvas"),t=e.getContext("2d");if(!t)throw new Error("getImageData");return e.width=r.width,e.height=r.height,t.drawImage(r,0,0),t.getImageData(0,0,r.width,r.height);default:throw new Error("getImageData")}}function N6e(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&r instanceof Image?"image":r&&typeof r=="object"&&r.data&&r.width&&r.height?"data":null}const F6e=/^data:image\/svg\+xml/,U6e=/\.svg((\?|#).*)?$/;function qD(r){return r&&(F6e.test(r)||U6e.test(r))}function z6e(r,e){if(qD(e)){let t=new TextDecoder().decode(r);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(t=unescape(encodeURIComponent(t)))}catch(n){throw new Error(n.message)}return`data:image/svg+xml;base64,${btoa(t)}`}return mY(r,e)}function mY(r,e){if(qD(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(r)])}async function yY(r,e,t){const n=z6e(r,t),i=self.URL||self.webkitURL,s=typeof n!="string"&&i.createObjectURL(n);try{return await V6e(s||n,e)}finally{s&&i.revokeObjectURL(s)}}async function V6e(r,e){const t=new Image;return t.src=r,e.image&&e.image.decode&&t.decode?(await t.decode(),t):await new Promise((n,i)=>{try{t.onload=()=>n(t),t.onerror=s=>{const a=s instanceof Error?s.message:"error";i(new Error(a))}}catch(s){i(s)}})}const $6e={};let Wz=!0;async function j6e(r,e,t){let n;qD(t)?n=await yY(r,e,t):n=mY(r,t);const i=e&&e.imagebitmap;return await G6e(n,i)}async function G6e(r,e=null){if((H6e(e)||!Wz)&&(e=null),e)try{return await createImageBitmap(r,e)}catch(t){console.warn(t),Wz=!1}return await createImageBitmap(r)}function H6e(r){for(const e in r||$6e)return!1;return!0}function W6e(r){return!q6e(r,"ftyp",4)||!(r[8]&96)?null:K6e(r)}function K6e(r){switch(X6e(r,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function X6e(r,e,t){return String.fromCharCode(...r.slice(e,t))}function J6e(r){return[...r].map(e=>e.charCodeAt(0))}function q6e(r,e,t=0){const n=J6e(e);for(let i=0;i<n.length;++i)if(n[i]!==r[i+t])return!1;return!0}const Uc=!1,h_=!0;function YD(r){const e=oA(r);return Z6e(e)||t5e(e)||Q6e(e)||e5e(e)||Y6e(e)}function Y6e(r){const e=new Uint8Array(r instanceof DataView?r.buffer:r),t=W6e(e);return t?{mimeType:t.mimeType,width:0,height:0}:null}function Z6e(r){const e=oA(r);return e.byteLength>=24&&e.getUint32(0,Uc)===2303741511?{mimeType:"image/png",width:e.getUint32(16,Uc),height:e.getUint32(20,Uc)}:null}function Q6e(r){const e=oA(r);return e.byteLength>=10&&e.getUint32(0,Uc)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,h_),height:e.getUint16(8,h_)}:null}function e5e(r){const e=oA(r);return e.byteLength>=14&&e.getUint16(0,Uc)===16973&&e.getUint32(2,h_)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,h_),height:e.getUint32(22,h_)}:null}function t5e(r){const e=oA(r);if(!(e.byteLength>=3&&e.getUint16(0,Uc)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:t,sofMarkers:n}=r5e();let i=2;for(;i+9<e.byteLength;){const s=e.getUint16(i,Uc);if(n.has(s))return{mimeType:"image/jpeg",height:e.getUint16(i+5,Uc),width:e.getUint16(i+7,Uc)};if(!t.has(s))return null;i+=2,i+=e.getUint16(i,Uc)}return null}function r5e(){const r=new Set([65499,65476,65484,65501,65534]);for(let e=65504;e<65520;++e)r.add(e);return{tableMarkers:r,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function oA(r){if(r instanceof DataView)return r;if(ArrayBuffer.isView(r))return new DataView(r.buffer);if(r instanceof ArrayBuffer)return new DataView(r);throw new Error("toDataView")}async function n5e(r,e){var t;const{mimeType:n}=YD(r)||{},i=(t=globalThis.loaders)==null?void 0:t.parseImageNode;return ys(i),await i(r,n)}async function i5e(r,e,t){e=e||{};const n=(e.image||{}).type||"auto",{url:i}=t||{},s=s5e(n);let a;switch(s){case"imagebitmap":a=await j6e(r,e,i);break;case"image":a=await yY(r,e,i);break;case"data":a=await n5e(r);break;default:ys(!1)}return n==="data"&&(a=gY(a)),a}function s5e(r){switch(r){case"auto":case"data":return D6e();default:return O6e(r),r}}const o5e=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],a5e=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],l5e={image:{type:"auto",decode:!0}},c5e={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:M6e,mimeTypes:a5e,extensions:o5e,parse:i5e,tests:[r=>!!YD(new DataView(r))],options:l5e},QP={};function u5e(r){if(QP[r]===void 0){const e=o2?d5e(r):h5e(r);QP[r]=e}return QP[r]}function h5e(r){var e,t;const n=["image/png","image/jpeg","image/gif"],i=((e=globalThis.loaders)==null?void 0:e.imageFormatsNode)||n;return!!((t=globalThis.loaders)!=null&&t.parseImageNode)&&i.includes(r)}function d5e(r){switch(r){case"image/avif":case"image/webp":return f5e(r);default:return!0}}function f5e(r){try{return document.createElement("canvas").toDataURL(r).indexOf(`data:${r}`)===0}catch{return!1}}function ja(r,e){if(!r)throw new Error(e||"assert failed: gltf")}const bY={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},_Y={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},p5e=1.33,Kz=["SCALAR","VEC2","VEC3","VEC4"],g5e=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],m5e=new Map(g5e),y5e={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},b5e={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},_5e={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function vY(r){return Kz[r-1]||Kz[0]}function h2(r){const e=m5e.get(r.constructor);if(!e)throw new Error("Illegal typed array");return e}function ZD(r,e){const t=_5e[r.componentType],n=y5e[r.type],i=b5e[r.componentType],s=r.count*n,a=r.count*n*i;ja(a>=0&&a<=e.byteLength);const o=_Y[r.componentType],u=bY[r.type];return{ArrayType:t,length:s,byteLength:a,componentByteSize:o,numberOfComponentsInElement:u}}function AY(r){let{images:e,bufferViews:t}=r;e=e||[],t=t||[];const n=e.map(a=>a.bufferView);t=t.filter(a=>!n.includes(a));const i=t.reduce((a,o)=>a+o.byteLength,0),s=e.reduce((a,o)=>{const{width:u,height:f}=o.image;return a+u*f},0);return i+Math.ceil(4*s*p5e)}function v5e(r,e,t){const n=r.bufferViews[t];ja(n);const i=n.buffer,s=e[i];ja(s);const a=(n.byteOffset||0)+s.byteOffset;return new Uint8Array(s.arrayBuffer,a,n.byteLength)}function A5e(r,e,t){var n,i;const s=typeof t=="number"?(n=r.accessors)==null?void 0:n[t]:t;if(!s)throw new Error(`No gltf accessor ${JSON.stringify(t)}`);const a=(i=r.bufferViews)==null?void 0:i[s.bufferView||0];if(!a)throw new Error(`No gltf buffer view for accessor ${a}`);const{arrayBuffer:o,byteOffset:u}=e[a.buffer],f=(u||0)+(s.byteOffset||0)+(a.byteOffset||0),{ArrayType:g,length:y,componentByteSize:A,numberOfComponentsInElement:C}=ZD(s,a),M=A*C,k=a.byteStride||M;if(typeof a.byteStride>"u"||a.byteStride===M)return new g(o,f,y);const D=new g(y);for(let V=0;V<s.count;V++){const W=new g(o,f+V*k,C);D.set(W,V*C)}return D}function x5e(){return{asset:{version:"2.0",generator:"loaders.gl"},buffers:[],extensions:{},extensionsRequired:[],extensionsUsed:[]}}let Gs=class{constructor(e){Cr(this,"gltf"),Cr(this,"sourceBuffers"),Cr(this,"byteLength"),this.gltf={json:e?.json||x5e(),buffers:e?.buffers||[],images:e?.images||[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}hasExtension(e){const t=this.getUsedExtensions().find(i=>i===e),n=this.getRequiredExtensions().find(i=>i===e);return typeof t=="string"||typeof n=="string"}getExtension(e){const t=this.getUsedExtensions().find(i=>i===e),n=this.json.extensions||{};return t?n[e]:null}getRequiredExtension(e){return this.getRequiredExtensions().find(t=>t===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getRemovedExtensions(){return this.json.extensionsRemoved||[]}getObjectExtension(e,t){return(e.extensions||{})[t]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,t){if(typeof t=="object")return t;const n=this.json[e]&&this.json[e][t];if(!n)throw new Error(`glTF file error: Could not find ${e}[${t}]`);return n}getTypedArrayForBufferView(e){e=this.getBufferView(e);const t=e.buffer,n=this.gltf.buffers[t];ja(n);const i=(e.byteOffset||0)+n.byteOffset;return new Uint8Array(n.arrayBuffer,i,e.byteLength)}getTypedArrayForAccessor(e){const t=this.getAccessor(e);return A5e(this.gltf.json,this.gltf.buffers,t)}getTypedArrayForImageData(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),n=this.getBuffer(t.buffer).data,i=t.byteOffset||0;return new Uint8Array(n,i,t.byteLength)}addApplicationData(e,t){return this.json[e]=t,this}addExtraData(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this}addObjectExtension(e,t,n){return e.extensions=e.extensions||{},e.extensions[t]=n,this.registerUsedExtension(t),this}setObjectExtension(e,t,n){const i=e.extensions||{};i[t]=n}removeObjectExtension(e,t){const n=e?.extensions||{};if(n[t]){this.json.extensionsRemoved=this.json.extensionsRemoved||[];const i=this.json.extensionsRemoved;i.includes(t)||i.push(t)}delete n[t]}addExtension(e,t={}){return ja(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t}addRequiredExtension(e,t={}){return ja(t),this.addExtension(e,t),this.registerRequiredExtension(e),t}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(t=>t===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(t=>t===e)||this.json.extensionsRequired.push(e)}removeExtension(e){var t;if((t=this.json.extensions)!=null&&t[e]){this.json.extensionsRemoved=this.json.extensionsRemoved||[];const n=this.json.extensionsRemoved;n.includes(e)||n.push(e)}this.json.extensions&&delete this.json.extensions[e],this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e)}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:t}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:t}),this.json.scenes.length-1}addNode(e){const{meshIndex:t,matrix:n}=e;this.json.nodes=this.json.nodes||[];const i={mesh:t};return n&&(i.matrix=n),this.json.nodes.push(i),this.json.nodes.length-1}addMesh(e){const{attributes:t,indices:n,material:i,mode:s=4}=e,a={primitives:[{attributes:this._addAttributes(t),mode:s}]};if(n){const o=this._addIndices(n);a.primitives[0].indices=o}return Number.isFinite(i)&&(a.primitives[0].material=i),this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}addPointCloud(e){const t={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(t),this.json.meshes.length-1}addImage(e,t){const n=YD(e),i=t||n?.mimeType,s={bufferView:this.addBufferView(e),mimeType:i};return this.json.images=this.json.images||[],this.json.images.push(s),this.json.images.length-1}addBufferView(e,t=0,n=this.byteLength){const i=e.byteLength;ja(Number.isFinite(i)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const s={buffer:t,byteOffset:n,byteLength:i};return this.byteLength+=iA(i,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(s),this.json.bufferViews.length-1}addAccessor(e,t){const n={bufferView:e,type:vY(t.size),componentType:t.componentType,count:t.count,max:t.max,min:t.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(n),this.json.accessors.length-1}addBinaryBuffer(e,t={size:3}){const n=this.addBufferView(e);let i={min:t.min,max:t.max};(!i.min||!i.max)&&(i=this._getAccessorMinMax(e,t.size));const s={size:t.size,componentType:h2(e),count:Math.round(e.length/t.size),min:i.min,max:i.max};return this.addAccessor(n,Object.assign(s,t))}addTexture(e){const{imageIndex:t}=e,n={source:t};return this.json.textures=this.json.textures||[],this.json.textures.push(n),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,t;const n=this.byteLength,i=new ArrayBuffer(n),s=new Uint8Array(i);let a=0;for(const o of this.sourceBuffers||[])a=yLe(o,s,a);(t=(e=this.json)==null?void 0:e.buffers)!=null&&t[0]?this.json.buffers[0].byteLength=n:this.json.buffers=[{byteLength:n}],this.gltf.binary=i,this.sourceBuffers=[i],this.gltf.buffers=[{arrayBuffer:i,byteOffset:0,byteLength:i.byteLength}]}_removeStringFromArray(e,t){let n=!0;for(;n;){const i=e.indexOf(t);i>-1?e.splice(i,1):n=!1}}_addAttributes(e={}){const t={};for(const n in e){const i=e[n],s=this._getGltfAttributeName(n),a=this.addBinaryBuffer(i.value,i);t[s]=a}return t}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,t){const n={min:null,max:null};if(e.length<t)return n;n.min=[],n.max=[];const i=e.subarray(0,t);for(const s of i)n.min.push(s),n.max.push(s);for(let s=t;s<e.length;s+=t)for(let a=0;a<t;a++)n.min[0+a]=Math.min(n.min[0+a],e[s+a]),n.max[0+a]=Math.max(n.max[0+a],e[s+a]);return n}};function Xz(r){return(r%1+1)%1}const xY={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16,BOOLEAN:1,STRING:1,ENUM:1},w5e={INT8:Int8Array,UINT8:Uint8Array,INT16:Int16Array,UINT16:Uint16Array,INT32:Int32Array,UINT32:Uint32Array,INT64:BigInt64Array,UINT64:BigUint64Array,FLOAT32:Float32Array,FLOAT64:Float64Array},wY={INT8:1,UINT8:1,INT16:2,UINT16:2,INT32:4,UINT32:4,INT64:8,UINT64:8,FLOAT32:4,FLOAT64:8};function QD(r,e){return wY[e]*xY[r]}function d2(r,e,t,n){if(t!=="UINT8"&&t!=="UINT16"&&t!=="UINT32"&&t!=="UINT64")return null;const i=r.getTypedArrayForBufferView(e),s=f2(i,"SCALAR",t,n+1);return s instanceof BigInt64Array||s instanceof BigUint64Array?null:s}function f2(r,e,t,n=1){const i=xY[e],s=w5e[t],a=wY[t],o=n*i,u=o*a;let f=r.buffer,g=r.byteOffset;return g%a!==0&&(f=new Uint8Array(f).slice(g,g+u).buffer,g=0),new s(f,g,o)}function eL(r,e,t){var n,i,s,a,o;const u=`TEXCOORD_${e.texCoord||0}`,f=t.attributes[u],g=r.getTypedArrayForAccessor(f),y=r.gltf.json,A=e.index,C=(i=(n=y.textures)==null?void 0:n[A])==null?void 0:i.source;if(typeof C<"u"){const M=(a=(s=y.images)==null?void 0:s[C])==null?void 0:a.mimeType,k=(o=r.gltf.images)==null?void 0:o[C];if(k&&typeof k.width<"u"){const D=[];for(let V=0;V<g.length;V+=2){const W=C5e(k,M,g,V,e.channels);D.push(W)}return D}}return[]}function CY(r,e,t,n,i){if(!(t!=null&&t.length))return;const s=[];for(const g of t){let y=n.findIndex(A=>A===g);y===-1&&(y=n.push(g)-1),s.push(y)}const a=new Uint32Array(s),o=r.gltf.buffers.push({arrayBuffer:a.buffer,byteOffset:a.byteOffset,byteLength:a.byteLength})-1,u=r.addBufferView(a,o,0),f=r.addAccessor(u,{size:1,componentType:h2(a),count:a.length});i.attributes[e]=f}function C5e(r,e,t,n,i=[0]){const s={r:{offset:0,shift:0},g:{offset:1,shift:8},b:{offset:2,shift:16},a:{offset:3,shift:24}},a=t[n],o=t[n+1];let u=1;e&&(e.indexOf("image/jpeg")!==-1||e.indexOf("image/png")!==-1)&&(u=4);const f=T5e(a,o,r,u);let g=0;for(const y of i){const A=typeof y=="number"?Object.values(s)[y]:s[y],C=f+A.offset,M=gY(r);if(M.data.length<=C)throw new Error(`${M.data.length} <= ${C}`);const k=M.data[C];g|=k<<A.shift}return g}function T5e(r,e,t,n=1){const i=t.width,s=Xz(r)*(i-1),a=Math.round(s),o=t.height,u=Xz(e)*(o-1),f=Math.round(u),g=t.components?t.components:n;return(f*i+a)*g}function TY(r,e,t,n,i){const s=[];for(let a=0;a<e;a++){const o=t[a],u=t[a+1]-t[a];if(u+o>n)break;const f=o/i,g=u/i;s.push(r.slice(f,f+g))}return s}function SY(r,e,t){const n=[];for(let i=0;i<e;i++){const s=i*t;n.push(r.slice(s,s+t))}return n}function EY(r,e,t,n){if(t)throw new Error("Not implemented - arrayOffsets for strings is specified");if(n){const i=[],s=new TextDecoder("utf8");let a=0;for(let o=0;o<r;o++){const u=n[o+1]-n[o];if(u+a<=e.length){const f=e.subarray(a,u+a),g=s.decode(f);i.push(g),a+=u}}return i}return[]}const jm="EXT_mesh_features",S5e=jm;async function E5e(r,e){const t=new Gs(r);P5e(t,e)}function I5e(r,e){const t=new Gs(r);return M5e(t),t.createBinaryChunk(),t.gltf}function P5e(r,e){const t=r.gltf.json;if(t.meshes)for(const n of t.meshes)for(const i of n.primitives)B5e(r,i,e)}function B5e(r,e,t){var n,i,s;if(!((n=t?.gltf)!=null&&n.loadBuffers))return;const a=(i=e.extensions)==null?void 0:i[jm],o=a?.featureIds;if(o)for(const u of o){let f;if(typeof u.attribute<"u"){const g=`_FEATURE_ID_${u.attribute}`,y=e.attributes[g];f=r.getTypedArrayForAccessor(y)}else typeof u.texture<"u"&&(s=t?.gltf)!=null&&s.loadImages?f=eL(r,u.texture,e):f=[];u.data=f}}function M5e(r,e){const t=r.gltf.json.meshes;if(t)for(const n of t)for(const i of n.primitives)k5e(r,i)}function R5e(r,e,t,n){e.extensions||(e.extensions={});let i=e.extensions[jm];i||(i={featureIds:[]},e.extensions[jm]=i);const{featureIds:s}=i,a={featureCount:t.length,propertyTable:n,data:t};s.push(a),r.addObjectExtension(e,jm,i)}function k5e(r,e){var t;const n=(t=e.extensions)==null?void 0:t[jm];if(!n)return;const i=n.featureIds;i.forEach((s,a)=>{if(s.data){const{accessorKey:o,index:u}=O5e(e.attributes),f=new Uint32Array(s.data);i[a]={featureCount:f.length,propertyTable:s.propertyTable,attribute:u},r.gltf.buffers.push({arrayBuffer:f.buffer,byteOffset:f.byteOffset,byteLength:f.byteLength});const g=r.addBufferView(f),y=r.addAccessor(g,{size:1,componentType:h2(f),count:f.length});e.attributes[o]=y}})}function O5e(r){const e="_FEATURE_ID_",t=Object.keys(r).filter(i=>i.indexOf(e)===0);let n=-1;for(const i of t){const s=Number(i.substring(e.length));s>n&&(n=s)}return n++,{accessorKey:`${e}${n}`,index:n}}const D5e=Object.freeze(Object.defineProperty({__proto__:null,createExtMeshFeatures:R5e,decode:E5e,encode:I5e,name:S5e},Symbol.toStringTag,{value:"Module"})),gy="EXT_structural_metadata",L5e=gy;async function N5e(r,e){const t=new Gs(r);U5e(t,e)}function F5e(r,e){const t=new Gs(r);return t8e(t),t.createBinaryChunk(),t.gltf}function U5e(r,e){var t,n;if(!((t=e.gltf)!=null&&t.loadBuffers))return;const i=r.getExtension(gy);i&&((n=e.gltf)!=null&&n.loadImages&&z5e(r,i),V5e(r,i))}function z5e(r,e){const t=e.propertyTextures,n=r.gltf.json;if(t&&n.meshes)for(const i of n.meshes)for(const s of i.primitives)j5e(r,t,s,e)}function V5e(r,e){const t=e.schema;if(!t)return;const n=t.classes,i=e.propertyTables;if(n&&i)for(const s in n){const a=$5e(i,s);a&&H5e(r,t,a)}}function $5e(r,e){for(const t of r)if(t.class===e)return t;return null}function j5e(r,e,t,n){var i;if(!e)return;const s=(i=t.extensions)==null?void 0:i[gy],a=s?.propertyTextures;if(a)for(const o of a){const u=e[o];G5e(r,u,t,n)}}function G5e(r,e,t,n){var i;if(!e.properties)return;n.dataAttributeNames||(n.dataAttributeNames=[]);const s=e.class;for(const a in e.properties){const o=`${s}_${a}`,u=(i=e.properties)==null?void 0:i[a];if(!u)continue;u.data||(u.data=[]);const f=u.data,g=eL(r,u,t);g!==null&&(CY(r,o,g,f,t),u.data=f,n.dataAttributeNames.push(o))}}function H5e(r,e,t){var n,i;const s=(n=e.classes)==null?void 0:n[t.class];if(!s)throw new Error(`Incorrect data in the EXT_structural_metadata extension: no schema class with name ${t.class}`);const a=t.count;for(const o in s.properties){const u=s.properties[o],f=(i=t.properties)==null?void 0:i[o];if(f){const g=W5e(r,e,u,a,f);f.data=g}}}function W5e(r,e,t,n,i){let s=[];const a=i.values,o=r.getTypedArrayForBufferView(a),u=K5e(r,t,i,n),f=X5e(r,i,n);switch(t.type){case"SCALAR":case"VEC2":case"VEC3":case"VEC4":case"MAT2":case"MAT3":case"MAT4":{s=J5e(t,n,o,u);break}case"BOOLEAN":throw new Error(`Not implemented - classProperty.type=${t.type}`);case"STRING":{s=EY(n,o,u,f);break}case"ENUM":{s=q5e(e,t,n,o,u);break}default:throw new Error(`Unknown classProperty type ${t.type}`)}return s}function K5e(r,e,t,n){return e.array&&typeof e.count>"u"&&typeof t.arrayOffsets<"u"?d2(r,t.arrayOffsets,t.arrayOffsetType||"UINT32",n):null}function X5e(r,e,t){return typeof e.stringOffsets<"u"?d2(r,e.stringOffsets,e.stringOffsetType||"UINT32",t):null}function J5e(r,e,t,n){const i=r.array,s=r.count,a=QD(r.type,r.componentType),o=t.byteLength/a;let u;return r.componentType?u=f2(t,r.type,r.componentType,o):u=t,i?n?TY(u,e,n,t.length,a):s?SY(u,e,s):[]:u}function q5e(r,e,t,n,i){var s;const a=e.enumType;if(!a)throw new Error("Incorrect data in the EXT_structural_metadata extension: classProperty.enumType is not set for type ENUM");const o=(s=r.enums)==null?void 0:s[a];if(!o)throw new Error(`Incorrect data in the EXT_structural_metadata extension: schema.enums does't contain ${a}`);const u=o.valueType||"UINT16",f=QD(e.type,u),g=n.byteLength/f;let y=f2(n,e.type,u,g);if(y||(y=n),e.array){if(i)return Y5e({valuesData:y,numberOfElements:t,arrayOffsets:i,valuesDataBytesLength:n.length,elementSize:f,enumEntry:o});const A=e.count;return A?Z5e(y,t,A,o):[]}return tL(y,0,t,o)}function Y5e(r){const{valuesData:e,numberOfElements:t,arrayOffsets:n,valuesDataBytesLength:i,elementSize:s,enumEntry:a}=r,o=[];for(let u=0;u<t;u++){const f=n[u],g=n[u+1]-n[u];if(g+f>i)break;const y=f/s,A=g/s,C=tL(e,y,A,a);o.push(C)}return o}function Z5e(r,e,t,n){const i=[];for(let s=0;s<e;s++){const a=t*s,o=tL(r,a,t,n);i.push(o)}return i}function tL(r,e,t,n){const i=[];for(let s=0;s<t;s++)if(r instanceof BigInt64Array||r instanceof BigUint64Array)i.push("");else{const a=r[e+s],o=Q5e(n,a);o?i.push(o.name):i.push("")}return i}function Q5e(r,e){for(const t of r.values)if(t.value===e)return t;return null}const e8e="schemaClassId";function t8e(r,e){var t,n;const i=r.getExtension(gy);if(i&&i.propertyTables)for(const s of i.propertyTables){const a=s.class,o=(n=(t=i.schema)==null?void 0:t.classes)==null?void 0:n[a];s.properties&&o&&r8e(s,o,r)}}function r8e(r,e,t){for(const n in r.properties){const i=r.properties[n].data;if(i){const s=e.properties[n];if(s){const a=o8e(i,s,t);r.properties[n]=a}}}}function n8e(r,e,t=e8e){let n=r.getExtension(gy);n||(n=r.addExtension(gy)),n.schema=i8e(e,t,n.schema);const i=s8e(e,t,n.schema);return n.propertyTables||(n.propertyTables=[]),n.propertyTables.push(i)-1}function i8e(r,e,t){const n=t??{id:"schema_id"},i={properties:{}};for(const s of r){const a={type:s.elementType,componentType:s.componentType};i.properties[s.name]=a}return n.classes={},n.classes[e]=i,n}function s8e(r,e,t){var n;const i={class:e,count:0};let s=0;const a=(n=t.classes)==null?void 0:n[e];for(const o of r){if(s===0&&(s=o.values.length),s!==o.values.length&&o.values.length)throw new Error("Illegal values in attributes");a?.properties[o.name]&&(i.properties||(i.properties={}),i.properties[o.name]={values:0,data:o.values})}return i.count=s,i}function o8e(r,e,t){const n={values:0};if(e.type==="STRING"){const{stringData:i,stringOffsets:s}=c8e(r);n.stringOffsets=e3(s,t),n.values=e3(i,t)}else if(e.type==="SCALAR"&&e.componentType){const i=l8e(r,e.componentType);n.values=e3(i,t)}return n}const a8e={INT8:Int8Array,UINT8:Uint8Array,INT16:Int16Array,UINT16:Uint16Array,INT32:Int32Array,UINT32:Uint32Array,INT64:Int32Array,UINT64:Uint32Array,FLOAT32:Float32Array,FLOAT64:Float64Array};function l8e(r,e){const t=[];for(const i of r)t.push(Number(i));const n=a8e[e];if(!n)throw new Error("Illegal component type");return new n(t)}function c8e(r){const e=new TextEncoder,t=[];let n=0;for(const u of r){const f=e.encode(u);n+=f.length,t.push(f)}const i=new Uint8Array(n),s=[];let a=0;for(const u of t)i.set(u,a),s.push(a),a+=u.length;s.push(a);const o=new Uint32Array(s);return{stringData:i,stringOffsets:o}}function e3(r,e){return e.gltf.buffers.push({arrayBuffer:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength}),e.addBufferView(r)}const u8e=Object.freeze(Object.defineProperty({__proto__:null,createExtStructuralMetadata:n8e,decode:N5e,encode:F5e,name:L5e},Symbol.toStringTag,{value:"Module"})),IY="EXT_feature_metadata",h8e=IY;async function d8e(r,e){const t=new Gs(r);f8e(t,e)}function f8e(r,e){var t,n;if(!((t=e.gltf)!=null&&t.loadBuffers))return;const i=r.getExtension(IY);i&&((n=e.gltf)!=null&&n.loadImages&&p8e(r,i),g8e(r,i))}function p8e(r,e){const t=e.schema;if(!t)return;const n=t.classes,{featureTextures:i}=e;if(n&&i)for(const s in n){const a=n[s],o=y8e(i,s);o&&_8e(r,o,a)}}function g8e(r,e){const t=e.schema;if(!t)return;const n=t.classes,i=e.featureTables;if(n&&i)for(const s in n){const a=m8e(i,s);a&&b8e(r,t,a)}}function m8e(r,e){for(const t in r){const n=r[t];if(n.class===e)return n}return null}function y8e(r,e){for(const t in r){const n=r[t];if(n.class===e)return n}return null}function b8e(r,e,t){var n,i;if(!t.class)return;const s=(n=e.classes)==null?void 0:n[t.class];if(!s)throw new Error(`Incorrect data in the EXT_structural_metadata extension: no schema class with name ${t.class}`);const a=t.count;for(const o in s.properties){const u=s.properties[o],f=(i=t.properties)==null?void 0:i[o];if(f){const g=v8e(r,e,u,a,f);f.data=g}}}function _8e(r,e,t){var n;const i=e.class;for(const s in t.properties){const a=(n=e?.properties)==null?void 0:n[s];if(a){const o=T8e(r,a,i);a.data=o}}}function v8e(r,e,t,n,i){let s=[];const a=i.bufferView,o=r.getTypedArrayForBufferView(a),u=A8e(r,t,i,n),f=x8e(r,t,i,n);return t.type==="STRING"||t.componentType==="STRING"?s=EY(n,o,u,f):w8e(t)&&(s=C8e(t,n,o,u)),s}function A8e(r,e,t,n){return e.type==="ARRAY"&&typeof e.componentCount>"u"&&typeof t.arrayOffsetBufferView<"u"?d2(r,t.arrayOffsetBufferView,t.offsetType||"UINT32",n):null}function x8e(r,e,t,n){return typeof t.stringOffsetBufferView<"u"?d2(r,t.stringOffsetBufferView,t.offsetType||"UINT32",n):null}function w8e(r){const e=["UINT8","INT16","UINT16","INT32","UINT32","INT64","UINT64","FLOAT32","FLOAT64"];return e.includes(r.type)||typeof r.componentType<"u"&&e.includes(r.componentType)}function C8e(r,e,t,n){const i=r.type==="ARRAY",s=r.componentCount,a="SCALAR",o=r.componentType||r.type,u=QD(a,o),f=t.byteLength/u,g=f2(t,a,o,f);return i?n?TY(g,e,n,t.length,u):s?SY(g,e,s):[]:g}function T8e(r,e,t){const n=r.gltf.json;if(!n.meshes)return[];const i=[];for(const s of n.meshes)for(const a of s.primitives)S8e(r,t,e,i,a);return i}function S8e(r,e,t,n,i){const s={channels:t.channels,...t.texture},a=eL(r,s,i);a&&CY(r,e,a,n,i)}const E8e=Object.freeze(Object.defineProperty({__proto__:null,decode:d8e,name:h8e},Symbol.toStringTag,{value:"Module"})),I8e="4.3.2",P8e="4.3.2",fT={TRANSCODER:"basis_transcoder.js",TRANSCODER_WASM:"basis_transcoder.wasm",ENCODER:"basis_encoder.js",ENCODER_WASM:"basis_encoder.wasm"};let t3;async function Jz(r){return HDe(r.modules),WDe("basis")||(t3||(t3=B8e(r)),await t3)}async function B8e(r){let e=null,t=null;return[e,t]=await Promise.all([await Qf(fT.TRANSCODER,"textures",r),await Qf(fT.TRANSCODER_WASM,"textures",r)]),e=e||globalThis.BASIS,await M8e(e,t)}function M8e(r,e){const t={};return e&&(t.wasmBinary=e),new Promise(n=>{r(t).then(i=>{const{BasisFile:s,initializeBasis:a}=i;a(),n({BasisFile:s})})})}let r3;async function qz(r){const e=r.modules||{};return e.basisEncoder?e.basisEncoder:(r3=r3||R8e(r),await r3)}async function R8e(r){let e=null,t=null;return[e,t]=await Promise.all([await Qf(fT.ENCODER,"textures",r),await Qf(fT.ENCODER_WASM,"textures",r)]),e=e||globalThis.BASIS,await k8e(e,t)}function k8e(r,e){const t={};return e&&(t.wasmBinary=e),new Promise(n=>{r(t).then(i=>{const{BasisFile:s,KTX2File:a,initializeBasis:o,BasisEncoder:u}=i;o(),n({BasisFile:s,KTX2File:a,BasisEncoder:u})})})}const rm={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGBA_ASTC_4X4_KHR:37808},O8e=["","WEBKIT_","MOZ_"],Yz={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"};let Wx=null;function D8e(r){if(!Wx){r=r||L8e()||void 0,Wx=new Set;for(const e of O8e)for(const t in Yz)if(r&&r.getExtension(`${e}${t}`)){const n=Yz[t];Wx.add(n)}}return Wx}function L8e(){try{return document.createElement("canvas").getContext("webgl")}catch{return null}}const Ra=[171,75,84,88,32,50,48,187,13,10,26,10];function N8e(r){const e=new Uint8Array(r);return!(e.byteLength<Ra.length||e[0]!==Ra[0]||e[1]!==Ra[1]||e[2]!==Ra[2]||e[3]!==Ra[3]||e[4]!==Ra[4]||e[5]!==Ra[5]||e[6]!==Ra[6]||e[7]!==Ra[7]||e[8]!==Ra[8]||e[9]!==Ra[9]||e[10]!==Ra[10]||e[11]!==Ra[11])}const F8e={etc1:{basisFormat:0,compressed:!0,format:rm.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:rm.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:rm.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:rm.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:rm.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:rm.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};async function U8e(r,e){if(e.basis.containerFormat==="auto"){if(N8e(r)){const n=await qz(e);return Zz(n.KTX2File,r,e)}const{BasisFile:t}=await Jz(e);return n3(t,r,e)}switch(e.basis.module){case"encoder":const t=await qz(e);switch(e.basis.containerFormat){case"ktx2":return Zz(t.KTX2File,r,e);case"basis":default:return n3(t.BasisFile,r,e)}case"transcoder":default:const{BasisFile:n}=await Jz(e);return n3(n,r,e)}}function n3(r,e,t){const n=new r(new Uint8Array(e));try{if(!n.startTranscoding())throw new Error("Failed to start basis transcoding");const i=n.getNumImages(),s=[];for(let a=0;a<i;a++){const o=n.getNumLevels(a),u=[];for(let f=0;f<o;f++)u.push(z8e(n,a,f,t));s.push(u)}return s}finally{n.close(),n.delete()}}function z8e(r,e,t,n){const i=r.getImageWidth(e,t),s=r.getImageHeight(e,t),a=r.getHasAlpha(),{compressed:o,format:u,basisFormat:f}=PY(n,a),g=r.getImageTranscodedSizeInBytes(e,t,f),y=new Uint8Array(g);if(!r.transcodeImage(y,e,t,f,0,0))throw new Error("failed to start Basis transcoding");return{width:i,height:s,data:y,compressed:o,format:u,hasAlpha:a}}function Zz(r,e,t){const n=new r(new Uint8Array(e));try{if(!n.startTranscoding())throw new Error("failed to start KTX2 transcoding");const i=n.getLevels(),s=[];for(let a=0;a<i;a++)s.push(V8e(n,a,t));return[s]}finally{n.close(),n.delete()}}function V8e(r,e,t){const{alphaFlag:n,height:i,width:s}=r.getImageLevelInfo(e,0,0),{compressed:a,format:o,basisFormat:u}=PY(t,n),f=r.getImageTranscodedSizeInBytes(e,0,0,u),g=new Uint8Array(f);if(!r.transcodeImage(g,e,0,0,u,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:s,height:i,data:g,compressed:a,levelSize:f,hasAlpha:n,format:o}}function PY(r,e){let t=r&&r.basis&&r.basis.format;return t==="auto"&&(t=BY()),typeof t=="object"&&(t=e?t.alpha:t.noAlpha),t=t.toLowerCase(),F8e[t]}function BY(){const r=D8e();return r.has("astc")?"astc-4x4":r.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:r.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:r.has("etc1")?"etc1":r.has("etc2")?"etc2":"rgb565"}const $8e={dataType:null,batchType:null,name:"Basis",id:"basis",module:"textures",version:P8e,worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},j8e={...$8e,parse:U8e},my=!0,Qz=1735152710,rL=12,pT=8,G8e=1313821514,H8e=5130562,W8e=0,K8e=0,X8e=1;function J8e(r,e=0){return`${String.fromCharCode(r.getUint8(e+0))}${String.fromCharCode(r.getUint8(e+1))}${String.fromCharCode(r.getUint8(e+2))}${String.fromCharCode(r.getUint8(e+3))}`}function q8e(r,e=0,t={}){const n=new DataView(r),{magic:i=Qz}=t,s=n.getUint32(e,!1);return s===i||s===Qz}function Y8e(r,e,t=0,n={}){const i=new DataView(e),s=J8e(i,t+0),a=i.getUint32(t+4,my),o=i.getUint32(t+8,my);switch(Object.assign(r,{header:{byteOffset:t,byteLength:o,hasBinChunk:!1},type:s,version:a,json:{},binChunks:[]}),t+=rL,r.version){case 1:return Z8e(r,i,t);case 2:return Q8e(r,i,t,n={});default:throw new Error(`Invalid GLB version ${r.version}. Only supports version 1 and 2.`)}}function Z8e(r,e,t){ys(r.header.byteLength>rL+pT);const n=e.getUint32(t+0,my),i=e.getUint32(t+4,my);return t+=pT,ys(i===W8e),mM(r,e,t,n),t+=n,t+=yM(r,e,t,r.header.byteLength),t}function Q8e(r,e,t,n){return ys(r.header.byteLength>rL+pT),eUe(r,e,t,n),t+r.header.byteLength}function eUe(r,e,t,n){for(;t+8<=r.header.byteLength;){const i=e.getUint32(t+0,my),s=e.getUint32(t+4,my);switch(t+=pT,s){case G8e:mM(r,e,t,i);break;case H8e:yM(r,e,t,i);break;case K8e:n.strict||mM(r,e,t,i);break;case X8e:n.strict||yM(r,e,t,i);break}t+=iA(i,4)}return t}function mM(r,e,t,n){const i=new Uint8Array(e.buffer,t,n),s=new TextDecoder("utf8").decode(i);return r.json=JSON.parse(s),iA(n,4)}function yM(r,e,t,n){return r.header.hasBinChunk=!0,r.binChunks.push({byteOffset:t,byteLength:n,arrayBuffer:e.buffer}),iA(n,4)}function MY(r,e){if(r.startsWith("data:")||r.startsWith("http:")||r.startsWith("https:"))return r;const t=e.baseUri||e.uri;if(!t)throw new Error(`'baseUri' must be provided to resolve relative url ${r}`);return t.substr(0,t.lastIndexOf("/")+1)+r}const tUe="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",rUe="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",nUe=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),iUe=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),sUe={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},oUe={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};async function aUe(r,e,t,n,i,s="NONE"){const a=await lUe();hUe(a,a.exports[oUe[i]],r,e,t,n,a.exports[sUe[s||"NONE"]])}let i3;async function lUe(){return i3||(i3=cUe()),i3}async function cUe(){let r=tUe;WebAssembly.validate(nUe)&&(r=rUe,console.log("Warning: meshopt_decoder is using experimental SIMD support"));const e=await WebAssembly.instantiate(uUe(r),{});return await e.instance.exports.__wasm_call_ctors(),e.instance}function uUe(r){const e=new Uint8Array(r.length);for(let n=0;n<r.length;++n){const i=r.charCodeAt(n);e[n]=i>96?i-71:i>64?i-65:i>47?i+4:i>46?63:62}let t=0;for(let n=0;n<r.length;++n)e[t++]=e[n]<60?iUe[e[n]]:(e[n]-60)*64+e[++n];return e.buffer.slice(0,t)}function hUe(r,e,t,n,i,s,a){const o=r.exports.sbrk,u=n+3&-4,f=o(u*i),g=o(s.length),y=new Uint8Array(r.exports.memory.buffer);y.set(s,g);const A=e(f,n,i,g,s.length);if(A===0&&a&&a(f,u,i),t.set(y.subarray(f,f+n*i)),o(f-o(0)),A!==0)throw new Error(`Malformed buffer data: ${A}`)}const gT="EXT_meshopt_compression",dUe=gT;async function fUe(r,e){var t,n;const i=new Gs(r);if(!((t=e?.gltf)!=null&&t.decompressMeshes)||!((n=e.gltf)!=null&&n.loadBuffers))return;const s=[];for(const a of r.json.bufferViews||[])s.push(pUe(i,a));await Promise.all(s),i.removeExtension(gT)}async function pUe(r,e){const t=r.getObjectExtension(e,gT);if(t){const{byteOffset:n=0,byteLength:i=0,byteStride:s,count:a,mode:o,filter:u="NONE",buffer:f}=t,g=r.gltf.buffers[f],y=new Uint8Array(g.arrayBuffer,g.byteOffset+n,i),A=new Uint8Array(r.gltf.buffers[e.buffer].arrayBuffer,e.byteOffset,e.byteLength);await aUe(A,a,s,y,o,u),r.removeObjectExtension(e,gT)}}const gUe=Object.freeze(Object.defineProperty({__proto__:null,decode:fUe,name:dUe},Symbol.toStringTag,{value:"Module"})),lm="EXT_texture_webp",mUe=lm;function yUe(r,e){const t=new Gs(r);if(!u5e("image/webp")){if(t.getRequiredExtensions().includes(lm))throw new Error(`gltf: Required extension ${lm} not supported by browser`);return}const{json:n}=t;for(const i of n.textures||[]){const s=t.getObjectExtension(i,lm);s&&(i.source=s.source),t.removeObjectExtension(i,lm)}t.removeExtension(lm)}const bUe=Object.freeze(Object.defineProperty({__proto__:null,name:mUe,preprocess:yUe},Symbol.toStringTag,{value:"Module"})),jw="KHR_texture_basisu",_Ue=jw;function vUe(r,e){const t=new Gs(r),{json:n}=t;for(const i of n.textures||[]){const s=t.getObjectExtension(i,jw);s&&(i.source=s.source,t.removeObjectExtension(i,jw))}t.removeExtension(jw)}const AUe=Object.freeze(Object.defineProperty({__proto__:null,name:_Ue,preprocess:vUe},Symbol.toStringTag,{value:"Module"}));function xUe(r){const e={};for(const t in r){const n=r[t];if(t!=="indices"){const i=RY(n);e[t]=i}}return e}function RY(r){const{buffer:e,size:t,count:n}=wUe(r);return{value:e,size:t,byteOffset:0,count:n,type:vY(t),componentType:h2(e)}}function wUe(r){let e=r,t=1,n=0;return r&&r.value&&(e=r.value,t=r.size||1),e&&(ArrayBuffer.isView(e)||(e=CUe(e,Float32Array)),n=e.length/t),{buffer:e,size:t,count:n}}function CUe(r,e,t=!1){return r?Array.isArray(r)?new e(r):t&&!(r instanceof e)?new e(r):r:null}const Cd="KHR_draco_mesh_compression",TUe=Cd;function SUe(r,e,t){const n=new Gs(r);for(const i of kY(n))n.getObjectExtension(i,Cd)}async function EUe(r,e,t){var n;if(!((n=e?.gltf)!=null&&n.decompressMeshes))return;const i=new Gs(r),s=[];for(const a of kY(i))i.getObjectExtension(a,Cd)&&s.push(PUe(i,a,e,t));await Promise.all(s),i.removeExtension(Cd)}function IUe(r,e={}){const t=new Gs(r);for(const n of t.json.meshes||[])BUe(n),t.addRequiredExtension(Cd)}async function PUe(r,e,t,n){const i=r.getObjectExtension(e,Cd);if(!i)return;const s=r.getTypedArrayForBufferView(i.bufferView),a=OD(s.buffer,s.byteOffset),o={...t};delete o["3d-tiles"];const u=await nA(a,hY,o,n),f=xUe(u.attributes);for(const[g,y]of Object.entries(f))if(g in e.attributes){const A=e.attributes[g],C=r.getAccessor(A);C!=null&&C.min&&C!=null&&C.max&&(y.min=C.min,y.max=C.max)}e.attributes=f,u.indices&&(e.indices=RY(u.indices)),r.removeObjectExtension(e,Cd),MUe(e)}function BUe(r,e,t=4,n,i){var s;if(!n.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const a=n.DracoWriter.encodeSync({attributes:r}),o=(s=void 0)==null?void 0:s.call(i,{attributes:r}),u=n._addFauxAttributes(o.attributes),f=n.addBufferView(a);return{primitives:[{attributes:u,mode:t,extensions:{[Cd]:{bufferView:f,attributes:u}}}]}}function MUe(r){if(!r.attributes&&Object.keys(r.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*kY(r){for(const e of r.json.meshes||[])for(const t of e.primitives)yield t}const RUe=Object.freeze(Object.defineProperty({__proto__:null,decode:EUe,encode:IUe,name:TUe,preprocess:SUe},Symbol.toStringTag,{value:"Module"})),p2="KHR_texture_transform",kUe=p2,Kx=new zt,OUe=new rs,DUe=new rs;async function LUe(r,e){var t;if(!new Gs(r).hasExtension(p2)||!((t=e.gltf)!=null&&t.loadBuffers))return;const n=r.json.materials||[];for(let i=0;i<n.length;i++)NUe(i,r)}function NUe(r,e){var t,n,i,s;const a=(t=e.json.materials)==null?void 0:t[r],o=[(n=a?.pbrMetallicRoughness)==null?void 0:n.baseColorTexture,a?.emissiveTexture,a?.normalTexture,a?.occlusionTexture,(i=a?.pbrMetallicRoughness)==null?void 0:i.metallicRoughnessTexture],u=[];for(const f of o)f&&(s=f?.extensions)!=null&&s[p2]&&FUe(e,r,f,u)}function FUe(r,e,t,n){const i=UUe(t,n);if(!i)return;const s=r.json.meshes||[];for(const a of s)for(const o of a.primitives){const u=o.material;Number.isFinite(u)&&e===u&&zUe(r,o,i)}}function UUe(r,e){var t;const n=(t=r.extensions)==null?void 0:t[p2],{texCoord:i=0}=r,{texCoord:s=i}=n;if(e.findIndex(([a,o])=>a===i&&o===s)===-1){const a=jUe(n);return i!==s&&(r.texCoord=s),e.push([i,s]),{originalTexCoord:i,texCoord:s,matrix:a}}return null}function zUe(r,e,t){var n,i;const{originalTexCoord:s,texCoord:a,matrix:o}=t,u=e.attributes[`TEXCOORD_${s}`];if(Number.isFinite(u)){const f=(n=r.json.accessors)==null?void 0:n[u];if(f&&f.bufferView){const g=(i=r.json.bufferViews)==null?void 0:i[f.bufferView];if(g){const{arrayBuffer:y,byteOffset:A}=r.buffers[g.buffer],C=(A||0)+(f.byteOffset||0)+(g.byteOffset||0),{ArrayType:M,length:k}=ZD(f,g),D=_Y[f.componentType],V=bY[f.type],W=g.byteStride||D*V,z=new Float32Array(k);for(let $=0;$<f.count;$++){const te=new M(y,C+$*W,2);Kx.set(te[0],te[1],1),Kx.transformByMatrix3(o),z.set([Kx[0],Kx[1]],$*V)}s===a?VUe(f,g,r.buffers,z):$Ue(a,f,e,r,z)}}}}function VUe(r,e,t,n){r.componentType=5126,t.push({arrayBuffer:n.buffer,byteOffset:0,byteLength:n.buffer.byteLength}),e.buffer=t.length-1,e.byteLength=n.buffer.byteLength,e.byteOffset=0,delete e.byteStride}function $Ue(r,e,t,n,i){n.buffers.push({arrayBuffer:i.buffer,byteOffset:0,byteLength:i.buffer.byteLength});const s=n.json.bufferViews;if(!s)return;s.push({buffer:n.buffers.length-1,byteLength:i.buffer.byteLength,byteOffset:0});const a=n.json.accessors;a&&(a.push({bufferView:s?.length-1,byteOffset:0,componentType:5126,count:e.count,type:"VEC2"}),t.attributes[`TEXCOORD_${r}`]=a.length-1)}function jUe(r){const{offset:e=[0,0],rotation:t=0,scale:n=[1,1]}=r,i=new rs().set(1,0,0,0,1,0,e[0],e[1],1),s=OUe.set(Math.cos(t),Math.sin(t),0,-Math.sin(t),Math.cos(t),0,0,0,1),a=DUe.set(n[0],0,0,0,n[1],0,0,0,1);return i.multiplyRight(s).multiplyRight(a)}const GUe=Object.freeze(Object.defineProperty({__proto__:null,decode:LUe,name:kUe},Symbol.toStringTag,{value:"Module"})),$f="KHR_lights_punctual",HUe=$f;async function WUe(r){const e=new Gs(r),{json:t}=e,n=e.getExtension($f);n&&(e.json.lights=n.lights,e.removeExtension($f));for(const i of t.nodes||[]){const s=e.getObjectExtension(i,$f);s&&(i.light=s.light),e.removeObjectExtension(i,$f)}}async function KUe(r){const e=new Gs(r),{json:t}=e;if(t.lights){const n=e.addExtension($f);ja(!n.lights),n.lights=t.lights,delete t.lights}if(e.json.lights){for(const n of e.json.lights){const i=n.node;e.addObjectExtension(i,$f,n)}delete e.json.lights}}const XUe=Object.freeze(Object.defineProperty({__proto__:null,decode:WUe,encode:KUe,name:HUe},Symbol.toStringTag,{value:"Module"})),iv="KHR_materials_unlit",JUe=iv;async function qUe(r){const e=new Gs(r),{json:t}=e;for(const n of t.materials||[])n.extensions&&n.extensions.KHR_materials_unlit&&(n.unlit=!0),e.removeObjectExtension(n,iv);e.removeExtension(iv)}function YUe(r){const e=new Gs(r),{json:t}=e;if(e.materials)for(const n of t.materials||[])n.unlit&&(delete n.unlit,e.addObjectExtension(n,iv,{}),e.addExtension(iv))}const ZUe=Object.freeze(Object.defineProperty({__proto__:null,decode:qUe,encode:YUe,name:JUe},Symbol.toStringTag,{value:"Module"})),D0="KHR_techniques_webgl",QUe=D0;async function e9e(r){const e=new Gs(r),{json:t}=e,n=e.getExtension(D0);if(n){const i=r9e(n,e);for(const s of t.materials||[]){const a=e.getObjectExtension(s,D0);a&&(s.technique=Object.assign({},a,i[a.technique]),s.technique.values=n9e(s.technique,e)),e.removeObjectExtension(s,D0)}e.removeExtension(D0)}}async function t9e(r,e){}function r9e(r,e){const{programs:t=[],shaders:n=[],techniques:i=[]}=r,s=new TextDecoder;return n.forEach(a=>{if(Number.isFinite(a.bufferView))a.code=s.decode(e.getTypedArrayForBufferView(a.bufferView));else throw new Error("KHR_techniques_webgl: no shader code")}),t.forEach(a=>{a.fragmentShader=n[a.fragmentShader],a.vertexShader=n[a.vertexShader]}),i.forEach(a=>{a.program=t[a.program]}),i}function n9e(r,e){const t=Object.assign({},r.values);return Object.keys(r.uniforms||{}).forEach(n=>{r.uniforms[n].value&&!(n in t)&&(t[n]=r.uniforms[n].value)}),Object.keys(t).forEach(n=>{typeof t[n]=="object"&&t[n].index!==void 0&&(t[n].texture=e.getTexture(t[n].index))}),t}const i9e=Object.freeze(Object.defineProperty({__proto__:null,decode:e9e,encode:t9e,name:QUe},Symbol.toStringTag,{value:"Module"})),OY=[u8e,D5e,gUe,bUe,AUe,RUe,XUe,ZUe,i9e,GUe,E8e];function s9e(r,e={},t){var n;const i=OY.filter(s=>DY(s.name,e));for(const s of i)(n=s.preprocess)==null||n.call(s,r,e,t)}async function o9e(r,e={},t){var n;const i=OY.filter(s=>DY(s.name,e));for(const s of i)await((n=s.decode)==null?void 0:n.call(s,r,e,t))}function DY(r,e){var t;const n=((t=e?.gltf)==null?void 0:t.excludeExtensions)||{};return!(r in n&&!n[r])}const s3="KHR_binary_glTF";function a9e(r){const e=new Gs(r),{json:t}=e;for(const n of t.images||[]){const i=e.getObjectExtension(n,s3);i&&Object.assign(n,i),e.removeObjectExtension(n,s3)}t.buffers&&t.buffers[0]&&delete t.buffers[0].uri,e.removeExtension(s3)}const eV={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},l9e={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class c9e{constructor(){Cr(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}),Cr(this,"json")}normalize(e,t){this.json=e.json;const n=e.json;switch(n.asset&&n.asset.version){case"2.0":return;case void 0:case"1.0":break;default:console.warn(`glTF: Unknown version ${n.asset.version}`);return}if(!t.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(n),this._convertTopLevelObjectsToArrays(n),a9e(e),this._convertObjectIdsToArrayIndices(n),this._updateObjects(n),this._updateMaterial(n)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const t in eV)this._convertTopLevelObjectToArray(e,t)}_convertTopLevelObjectToArray(e,t){const n=e[t];if(!(!n||Array.isArray(n))){e[t]=[];for(const i in n){const s=n[i];s.id=s.id||i;const a=e[t].length;e[t].push(s),this.idToIndexMap[t][i]=a}}}_convertObjectIdsToArrayIndices(e){for(const t in eV)this._convertIdsToIndices(e,t);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const t of e.textures)this._convertTextureIds(t);for(const t of e.meshes)this._convertMeshIds(t);for(const t of e.nodes)this._convertNodeIds(t);for(const t of e.scenes)this._convertSceneIds(t)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const t of e.primitives){const{attributes:n,indices:i,material:s}=t;for(const a in n)n[a]=this._convertIdToIndex(n[a],"accessor");i&&(t.indices=this._convertIdToIndex(i,"accessor")),s&&(t.material=this._convertIdToIndex(s,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(t=>this._convertIdToIndex(t,"node"))),e.meshes&&(e.meshes=e.meshes.map(t=>this._convertIdToIndex(t,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(t=>this._convertIdToIndex(t,"node")))}_convertIdsToIndices(e,t){e[t]||(console.warn(`gltf v1: json doesn't contain attribute ${t}`),e[t]=[]);for(const n of e[t])for(const i in n){const s=n[i],a=this._convertIdToIndex(s,i);n[i]=a}}_convertIdToIndex(e,t){const n=l9e[t];if(n in this.idToIndexMap){const i=this.idToIndexMap[n][e];if(!Number.isFinite(i))throw new Error(`gltf v1: failed to resolve ${t} with id ${e}`);return i}return e}_updateObjects(e){for(const t of this.json.buffers)delete t.type}_updateMaterial(e){var t,n,i;for(const s of e.materials){s.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const a=((t=s.values)==null?void 0:t.tex)||((n=s.values)==null?void 0:n.texture2d_0)||((i=s.values)==null?void 0:i.diffuseTex),o=e.textures.findIndex(u=>u.id===a);o!==-1&&(s.pbrMetallicRoughness.baseColorTexture={index:o})}}}function u9e(r,e={}){return new c9e().normalize(r,e)}async function h9e(r,e,t=0,n,i){var s,a,o;return d9e(r,e,t,n),u9e(r,{normalize:(s=n?.gltf)==null?void 0:s.normalize}),s9e(r,n,i),(a=n?.gltf)!=null&&a.loadBuffers&&r.json.buffers&&await f9e(r,n,i),(o=n?.gltf)!=null&&o.loadImages&&await p9e(r,n,i),await o9e(r,n,i),r}function d9e(r,e,t,n){if(n.uri&&(r.baseUri=n.uri),e instanceof ArrayBuffer&&!q8e(e,t,n)&&(e=new TextDecoder().decode(e)),typeof e=="string")r.json=fLe(e);else if(e instanceof ArrayBuffer){const a={};t=Y8e(a,e,t,n.glb),ja(a.type==="glTF",`Invalid GLB magic string ${a.type}`),r._glb=a,r.json=a.json}else ja(!1,"GLTF: must be ArrayBuffer or string");const i=r.json.buffers||[];if(r.buffers=new Array(i.length).fill(null),r._glb&&r._glb.header.hasBinChunk){const{binChunks:a}=r._glb;r.buffers[0]={arrayBuffer:a[0].arrayBuffer,byteOffset:a[0].byteOffset,byteLength:a[0].byteLength}}const s=r.json.images||[];r.images=new Array(s.length).fill({})}async function f9e(r,e,t){var n,i;const s=r.json.buffers||[];for(let a=0;a<s.length;++a){const o=s[a];if(o.uri){const{fetch:u}=t;ja(u);const f=MY(o.uri,e),g=await((n=t?.fetch)==null?void 0:n.call(t,f)),y=await((i=g?.arrayBuffer)==null?void 0:i.call(g));r.buffers[a]={arrayBuffer:y,byteOffset:0,byteLength:y.byteLength},delete o.uri}else r.buffers[a]===null&&(r.buffers[a]={arrayBuffer:new ArrayBuffer(o.byteLength),byteOffset:0,byteLength:o.byteLength})}}async function p9e(r,e,t){const n=g9e(r),i=r.json.images||[],s=[];for(const a of n)s.push(m9e(r,i[a],a,e,t));return await Promise.all(s)}function g9e(r){const e=new Set,t=r.json.textures||[];for(const n of t)n.source!==void 0&&e.add(n.source);return Array.from(e).sort()}async function m9e(r,e,t,n,i){let s;if(e.uri&&!e.hasOwnProperty("bufferView")){const o=MY(e.uri,n),{fetch:u}=i;s=await(await u(o)).arrayBuffer(),e.bufferView={data:s}}if(Number.isFinite(e.bufferView)){const o=v5e(r.json,r.buffers,e.bufferView);s=OD(o.buffer,o.byteOffset,o.byteLength)}ja(s,"glTF image has no data");let a=await nA(s,[c5e,j8e],{...n,mimeType:e.mimeType,basis:n.basis||{format:BY()}},i);a&&a[0]&&(a={compressed:!0,mipmaps:!1,width:a[0].width,height:a[0].height,data:a[0]}),r.images=r.images||[],r.images[t]=a}const mT={dataType:null,batchType:null,name:"glTF",id:"gltf",module:"gltf",version:I8e,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:y9e,options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0},log:console}};async function y9e(r,e={},t){e={...mT.options,...e},e.gltf={...mT.options.gltf,...e.gltf};const{byteOffset:n=0}=e;return await h9e({},r,n,e,t)}const b9e={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},_9e={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},cl={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},v9e={magFilter:cl.TEXTURE_MAG_FILTER,minFilter:cl.TEXTURE_MIN_FILTER,wrapS:cl.TEXTURE_WRAP_S,wrapT:cl.TEXTURE_WRAP_T},A9e={[cl.TEXTURE_MAG_FILTER]:cl.LINEAR,[cl.TEXTURE_MIN_FILTER]:cl.NEAREST_MIPMAP_LINEAR,[cl.TEXTURE_WRAP_S]:cl.REPEAT,[cl.TEXTURE_WRAP_T]:cl.REPEAT};function x9e(){return{id:"default-sampler",parameters:A9e}}function w9e(r){return _9e[r]}function C9e(r){return b9e[r]}class T9e{constructor(){Cr(this,"baseUri",""),Cr(this,"jsonUnprocessed"),Cr(this,"json"),Cr(this,"buffers",[]),Cr(this,"images",[])}postProcess(e,t={}){const{json:n,buffers:i=[],images:s=[]}=e,{baseUri:a=""}=e;return ja(n),this.baseUri=a,this.buffers=i,this.images=s,this.jsonUnprocessed=n,this.json=this._resolveTree(e.json,t),this.json}_resolveTree(e,t={}){const n={...e};return this.json=n,e.bufferViews&&(n.bufferViews=e.bufferViews.map((i,s)=>this._resolveBufferView(i,s))),e.images&&(n.images=e.images.map((i,s)=>this._resolveImage(i,s))),e.samplers&&(n.samplers=e.samplers.map((i,s)=>this._resolveSampler(i,s))),e.textures&&(n.textures=e.textures.map((i,s)=>this._resolveTexture(i,s))),e.accessors&&(n.accessors=e.accessors.map((i,s)=>this._resolveAccessor(i,s))),e.materials&&(n.materials=e.materials.map((i,s)=>this._resolveMaterial(i,s))),e.meshes&&(n.meshes=e.meshes.map((i,s)=>this._resolveMesh(i,s))),e.nodes&&(n.nodes=e.nodes.map((i,s)=>this._resolveNode(i,s)),n.nodes=n.nodes.map((i,s)=>this._resolveNodeChildren(i))),e.skins&&(n.skins=e.skins.map((i,s)=>this._resolveSkin(i,s))),e.scenes&&(n.scenes=e.scenes.map((i,s)=>this._resolveScene(i,s))),typeof this.json.scene=="number"&&n.scenes&&(n.scene=n.scenes[this.json.scene]),n}getScene(e){return this._get(this.json.scenes,e)}getNode(e){return this._get(this.json.nodes,e)}getSkin(e){return this._get(this.json.skins,e)}getMesh(e){return this._get(this.json.meshes,e)}getMaterial(e){return this._get(this.json.materials,e)}getAccessor(e){return this._get(this.json.accessors,e)}getCamera(e){return this._get(this.json.cameras,e)}getTexture(e){return this._get(this.json.textures,e)}getSampler(e){return this._get(this.json.samplers,e)}getImage(e){return this._get(this.json.images,e)}getBufferView(e){return this._get(this.json.bufferViews,e)}getBuffer(e){return this._get(this.json.buffers,e)}_get(e,t){if(typeof t=="object")return t;const n=e&&e[t];return n||console.warn(`glTF file error: Could not find ${e}[${t}]`),n}_resolveScene(e,t){return{...e,id:e.id||`scene-${t}`,nodes:(e.nodes||[]).map(n=>this.getNode(n))}}_resolveNode(e,t){const n={...e,id:e?.id||`node-${t}`};return e.mesh!==void 0&&(n.mesh=this.getMesh(e.mesh)),e.camera!==void 0&&(n.camera=this.getCamera(e.camera)),e.skin!==void 0&&(n.skin=this.getSkin(e.skin)),e.meshes!==void 0&&e.meshes.length&&(n.mesh=e.meshes.reduce((i,s)=>{const a=this.getMesh(s);return i.id=a.id,i.primitives=i.primitives.concat(a.primitives),i},{primitives:[]})),n}_resolveNodeChildren(e){return e.children&&(e.children=e.children.map(t=>this.getNode(t))),e}_resolveSkin(e,t){const n=typeof e.inverseBindMatrices=="number"?this.getAccessor(e.inverseBindMatrices):void 0;return{...e,id:e.id||`skin-${t}`,inverseBindMatrices:n}}_resolveMesh(e,t){const n={...e,id:e.id||`mesh-${t}`,primitives:[]};return e.primitives&&(n.primitives=e.primitives.map(i=>{const s={...i,attributes:{},indices:void 0,material:void 0},a=i.attributes;for(const o in a)s.attributes[o]=this.getAccessor(a[o]);return i.indices!==void 0&&(s.indices=this.getAccessor(i.indices)),i.material!==void 0&&(s.material=this.getMaterial(i.material)),s})),n}_resolveMaterial(e,t){const n={...e,id:e.id||`material-${t}`};if(n.normalTexture&&(n.normalTexture={...n.normalTexture},n.normalTexture.texture=this.getTexture(n.normalTexture.index)),n.occlusionTexture&&(n.occlusionTexture={...n.occlusionTexture},n.occlusionTexture.texture=this.getTexture(n.occlusionTexture.index)),n.emissiveTexture&&(n.emissiveTexture={...n.emissiveTexture},n.emissiveTexture.texture=this.getTexture(n.emissiveTexture.index)),n.emissiveFactor||(n.emissiveFactor=n.emissiveTexture?[1,1,1]:[0,0,0]),n.pbrMetallicRoughness){n.pbrMetallicRoughness={...n.pbrMetallicRoughness};const i=n.pbrMetallicRoughness;i.baseColorTexture&&(i.baseColorTexture={...i.baseColorTexture},i.baseColorTexture.texture=this.getTexture(i.baseColorTexture.index)),i.metallicRoughnessTexture&&(i.metallicRoughnessTexture={...i.metallicRoughnessTexture},i.metallicRoughnessTexture.texture=this.getTexture(i.metallicRoughnessTexture.index))}return n}_resolveAccessor(e,t){const n=w9e(e.componentType),i=C9e(e.type),s=n*i,a={...e,id:e.id||`accessor-${t}`,bytesPerComponent:n,components:i,bytesPerElement:s,value:void 0,bufferView:void 0,sparse:void 0};if(e.bufferView!==void 0&&(a.bufferView=this.getBufferView(e.bufferView)),a.bufferView){const o=a.bufferView.buffer,{ArrayType:u,byteLength:f}=ZD(a,a.bufferView),g=(a.bufferView.byteOffset||0)+(a.byteOffset||0)+o.byteOffset;let y=o.arrayBuffer.slice(g,g+f);a.bufferView.byteStride&&(y=this._getValueFromInterleavedBuffer(o,g,a.bufferView.byteStride,a.bytesPerElement,a.count)),a.value=new u(y)}return a}_getValueFromInterleavedBuffer(e,t,n,i,s){const a=new Uint8Array(s*i);for(let o=0;o<s;o++){const u=t+o*n;a.set(new Uint8Array(e.arrayBuffer.slice(u,u+i)),o*i)}return a.buffer}_resolveTexture(e,t){return{...e,id:e.id||`texture-${t}`,sampler:typeof e.sampler=="number"?this.getSampler(e.sampler):x9e(),source:typeof e.source=="number"?this.getImage(e.source):void 0}}_resolveSampler(e,t){const n={id:e.id||`sampler-${t}`,...e,parameters:{}};for(const i in n){const s=this._enumSamplerParameter(i);s!==void 0&&(n.parameters[s]=n[i])}return n}_enumSamplerParameter(e){return v9e[e]}_resolveImage(e,t){const n={...e,id:e.id||`image-${t}`,image:null,bufferView:e.bufferView!==void 0?this.getBufferView(e.bufferView):void 0},i=this.images[t];return i&&(n.image=i),n}_resolveBufferView(e,t){const n=e.buffer,i=this.buffers[n].arrayBuffer;let s=this.buffers[n].byteOffset||0;return e.byteOffset&&(s+=e.byteOffset),{id:`bufferView-${t}`,...e,buffer:this.buffers[n],data:new Uint8Array(i,s,e.byteLength)}}_resolveCamera(e,t){const n={...e,id:e.id||`camera-${t}`};return n.perspective,n.orthographic,n}}function LY(r,e){return new T9e().postProcess(r,e)}const bM={URI:0,EMBEDDED:1};function NY(r,e,t,n){r.rotateYtoZ=!0;const i=(r.byteOffset||0)+(r.byteLength||0)-t;if(i===0)throw new Error("glTF byte length must be greater than 0.");return r.gltfUpAxis=n!=null&&n["3d-tiles"]&&n["3d-tiles"].assetGltfUpAxis?n["3d-tiles"].assetGltfUpAxis:"Y",r.gltfArrayBuffer=OD(e,t,i),r.gltfByteOffset=0,r.gltfByteLength=i,t%4===0||console.warn(`${r.type}: embedded glb is not aligned to a 4-byte boundary.`),(r.byteOffset||0)+(r.byteLength||0)}async function FY(r,e,t,n){const i=t?.["3d-tiles"]||{};if(S9e(r,e),i.loadGLTF){if(!n)return;if(r.gltfUrl){const{fetch:s}=n,a=await s(r.gltfUrl,t);r.gltfArrayBuffer=await a.arrayBuffer(),r.gltfByteOffset=0}if(r.gltfArrayBuffer){const s=await nA(r.gltfArrayBuffer,mT,t,n);r.gltf=LY(s),r.gpuMemoryUsageInBytes=AY(r.gltf),delete r.gltfArrayBuffer,delete r.gltfByteOffset,delete r.gltfByteLength}}}function S9e(r,e,t){switch(e){case bM.URI:if(r.gltfArrayBuffer){const n=new Uint8Array(r.gltfArrayBuffer,r.gltfByteOffset),i=new TextDecoder().decode(n);r.gltfUrl=i.replace(/[\s\0]+$/,"")}delete r.gltfArrayBuffer,delete r.gltfByteOffset,delete r.gltfByteLength;break;case bM.EMBEDDED:break;default:throw new Error("b3dm: Illegal glTF format field")}}async function E9e(r,e,t,n,i){var s;t=I9e(r,e,t,n),await FY(r,bM.EMBEDDED,n,i);const a=(s=r?.gltf)==null?void 0:s.extensions;return a&&a.CESIUM_RTC&&(r.rtcCenter=a.CESIUM_RTC.center),t}function I9e(r,e,t,n,i){t=u2(r,e,t),t=XD(r,e,t),t=JD(r,e,t),t=NY(r,e,t,n);const s=new KD(r.featureTableJson,r.featureTableBinary);return r.rtcCenter=s.getGlobalProperty("RTC_CENTER",An.FLOAT,3),t}async function P9e(r,e,t,n,i){return t=B9e(r,e,t,n),await FY(r,r.gltfFormat||0,n,i),t}function B9e(r,e,t,n,i){var s;if(t=u2(r,e,t),r.version!==1)throw new Error(`Instanced 3D Model version ${r.version} is not supported`);t=XD(r,e,t);const a=new DataView(e);if(r.gltfFormat=a.getUint32(t,!0),t+=4,t=JD(r,e,t),t=NY(r,e,t,n),!((s=r?.header)!=null&&s.featureTableJsonByteLength)||r.header.featureTableJsonByteLength===0)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");const o=new KD(r.featureTableJson,r.featureTableBinary),u=o.getGlobalProperty("INSTANCES_LENGTH");if(o.featuresLength=u,!Number.isFinite(u))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");r.eastNorthUp=o.getGlobalProperty("EAST_NORTH_UP"),r.rtcCenter=o.getGlobalProperty("RTC_CENTER",An.FLOAT,3);const f=new fY(r.batchTableJson,r.batchTableBinary,u);return M9e(r,o,f,u),t}function M9e(r,e,t,n){const i=new Array(n),s=new zt;new zt,new zt,new zt;const a=new rs,o=new lM,u=new zt,f={},g=new fy,y=[],A=[],C=[],M=[];for(let k=0;k<n;k++){let D;if(e.hasProperty("POSITION"))D=e.getProperty("POSITION",An.FLOAT,3,k,s);else if(e.hasProperty("POSITION_QUANTIZED")){D=e.getProperty("POSITION_QUANTIZED",An.UNSIGNED_SHORT,3,k,s);const le=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",An.FLOAT,3);if(!le)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const _e=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",An.FLOAT,3);if(!_e)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const se=65535;for(let Y=0;Y<3;Y++)D[Y]=D[Y]/se*_e[Y]+le[Y]}if(!D)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");if(s.copy(D),f.translation=s,r.normalUp=e.getProperty("NORMAL_UP",An.FLOAT,3,k,y),r.normalRight=e.getProperty("NORMAL_RIGHT",An.FLOAT,3,k,A),r.normalUp){if(!r.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");r.hasCustomOrientation=!0}else{if(r.octNormalUp=e.getProperty("NORMAL_UP_OCT32P",An.UNSIGNED_SHORT,2,k,y),r.octNormalRight=e.getProperty("NORMAL_RIGHT_OCT32P",An.UNSIGNED_SHORT,2,k,A),r.octNormalUp)throw r.octNormalRight?new Error("i3dm: oct-encoded orientation not implemented"):new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");r.eastNorthUp?(uT.WGS84.eastNorthUpToFixedFrame(s,g),g.getRotationMatrix3(a)):a.identity()}o.fromMatrix3(a),f.rotation=o,u.set(1,1,1);const V=e.getProperty("SCALE",An.FLOAT,1,k,C);Number.isFinite(V)&&u.multiplyByScalar(V);const W=e.getProperty("SCALE_NON_UNIFORM",An.FLOAT,3,k,y);W&&u.scale(W),f.scale=u;let z=e.getProperty("BATCH_ID",An.UNSIGNED_SHORT,1,k,M);z===void 0&&(z=k);const $=new fy().fromQuaternion(f.rotation);g.identity(),g.translate(f.translation),g.multiplyRight($),g.scale(f.scale);const te=g.clone();i[k]={modelMatrix:te,batchId:z}}r.instances=i}async function R9e(r,e,t,n,i,s){t=u2(r,e,t);const a=new DataView(e);for(r.tilesLength=a.getUint32(t,!0),t+=4,r.tiles=[];r.tiles.length<r.tilesLength&&(r.byteLength||0)-t>12;){const o={shape:"tile3d"};r.tiles.push(o),t=await s(e,t,n,i,o)}return t}async function k9e(r,e,t,n){var i,s;if(r.rotateYtoZ=!0,r.gltfUpAxis=(i=t?.["3d-tiles"])!=null&&i.assetGltfUpAxis?t["3d-tiles"].assetGltfUpAxis:"Y",(s=t?.["3d-tiles"])!=null&&s.loadGLTF){if(!n)return e.byteLength;const a=await nA(e,mT,t,n);r.gltf=LY(a),r.gpuMemoryUsageInBytes=AY(r.gltf)}else r.gltfArrayBuffer=e;return e.byteLength}async function UY(r,e=0,t,n,i={shape:"tile3d"}){switch(i.byteOffset=e,i.type=F4e(r,e),i.type){case h0.COMPOSITE:return await R9e(i,r,e,t,n,UY);case h0.BATCHED_3D_MODEL:return await E9e(i,r,e,t,n);case h0.GLTF:return await k9e(i,r,t,n);case h0.INSTANCED_3D_MODEL:return await P9e(i,r,e,t,n);case h0.POINT_CLOUD:return await x6e(i,r,e,t,n);default:throw new Error(`3DTileLoader: unknown type ${i.type}`)}}const O9e=1952609651,D9e=1;async function L9e(r,e,t){if(new Uint32Array(r.slice(0,4))[0]!==O9e)throw new Error("Wrong subtree file magic number");if(new Uint32Array(r.slice(4,8))[0]!==D9e)throw new Error("Wrong subtree file verson, must be 1");const n=tV(r.slice(8,16)),i=new Uint8Array(r,24,n),s=new TextDecoder("utf8").decode(i),a=JSON.parse(s),o=tV(r.slice(16,24));let u=new ArrayBuffer(0);if(o&&(u=r.slice(24+n)),await Xx(a,a.tileAvailability,u,t),Array.isArray(a.contentAvailability))for(const f of a.contentAvailability)await Xx(a,f,u,t);else await Xx(a,a.contentAvailability,u,t);return await Xx(a,a.childSubtreeAvailability,u,t),a}async function Xx(r,e,t,n){const i=Number.isFinite(e.bitstream)?e.bitstream:e.bufferView;if(typeof i!="number")return;const s=r.bufferViews[i],a=r.buffers[s.buffer];if(!(n!=null&&n.baseUrl))throw new Error("Url is not provided");if(!n.fetch)throw new Error("fetch is not provided");if(a.uri){const u=`${n?.baseUrl||""}/${a.uri}`,f=await(await n.fetch(u)).arrayBuffer();e.explicitBitstream=new Uint8Array(f,s.byteOffset,s.byteLength);return}const o=r.buffers.slice(0,s.buffer).reduce((u,f)=>u+f.byteLength,0);e.explicitBitstream=new Uint8Array(t.slice(o,o+a.byteLength),s.byteOffset,s.byteLength)}function tV(r){const e=new DataView(r),t=e.getUint32(0,!0),n=e.getUint32(4,!0);return t+2**32*n}const zY={dataType:null,batchType:null,id:"3d-tiles-subtree",name:"3D Tiles Subtree",module:"3d-tiles",version:lY,extensions:["subtree"],mimeTypes:["application/octet-stream"],tests:["subtree"],parse:L9e,options:{}};/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var dl=null;try{dl=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Fn(r,e,t){this.low=r|0,this.high=e|0,this.unsigned=!!t}Fn.prototype.__isLong__;Object.defineProperty(Fn.prototype,"__isLong__",{value:!0});function Eo(r){return(r&&r.__isLong__)===!0}function rV(r){var e=Math.clz32(r&-r);return r?31-e:e}Fn.isLong=Eo;var nV={},iV={};function Sp(r,e){var t,n,i;return e?(r>>>=0,(i=0<=r&&r<256)&&(n=iV[r],n)?n:(t=wn(r,0,!0),i&&(iV[r]=t),t)):(r|=0,(i=-128<=r&&r<128)&&(n=nV[r],n)?n:(t=wn(r,r<0?-1:0,!1),i&&(nV[r]=t),t))}Fn.fromInt=Sp;function fl(r,e){if(isNaN(r))return e?Vu:Ql;if(e){if(r<0)return Vu;if(r>=VY)return GY}else{if(r<=-9223372036854776e3)return ha;if(r+1>=F9e)return jY}return r<0?fl(-r,e).neg():wn(r%yy|0,r/yy|0,e)}Fn.fromNumber=fl;function wn(r,e,t){return new Fn(r,e,t)}Fn.fromBits=wn;var yT=Math.pow;function nL(r,e,t){if(r.length===0)throw Error("empty string");if(typeof e=="number"?(t=e,e=!1):e=!!e,r==="NaN"||r==="Infinity"||r==="+Infinity"||r==="-Infinity")return e?Vu:Ql;if(t=t||10,t<2||36<t)throw RangeError("radix");var n;if((n=r.indexOf("-"))>0)throw Error("interior hyphen");if(n===0)return nL(r.substring(1),e,t).neg();for(var i=fl(yT(t,8)),s=Ql,a=0;a<r.length;a+=8){var o=Math.min(8,r.length-a),u=parseInt(r.substring(a,a+o),t);if(o<8){var f=fl(yT(t,o));s=s.mul(f).add(fl(u))}else s=s.mul(i),s=s.add(fl(u))}return s.unsigned=e,s}Fn.fromString=nL;function Al(r,e){return typeof r=="number"?fl(r,e):typeof r=="string"?nL(r,e):wn(r.low,r.high,typeof e=="boolean"?e:r.unsigned)}Fn.fromValue=Al;var sV=65536,N9e=1<<24,yy=sV*sV,VY=yy*yy,F9e=VY/2,oV=Sp(N9e),Ql=Sp(0);Fn.ZERO=Ql;var Vu=Sp(0,!0);Fn.UZERO=Vu;var Sm=Sp(1);Fn.ONE=Sm;var $Y=Sp(1,!0);Fn.UONE=$Y;var _M=Sp(-1);Fn.NEG_ONE=_M;var jY=wn(-1,2147483647,!1);Fn.MAX_VALUE=jY;var GY=wn(-1,-1,!0);Fn.MAX_UNSIGNED_VALUE=GY;var ha=wn(0,-2147483648,!1);Fn.MIN_VALUE=ha;var Gt=Fn.prototype;Gt.toInt=function(){return this.unsigned?this.low>>>0:this.low};Gt.toNumber=function(){return this.unsigned?(this.high>>>0)*yy+(this.low>>>0):this.high*yy+(this.low>>>0)};Gt.toString=function(r){if(r=r||10,r<2||36<r)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(ha)){var e=fl(r),t=this.div(e),n=t.mul(e).sub(this);return t.toString(r)+n.toInt().toString(r)}else return"-"+this.neg().toString(r);for(var i=fl(yT(r,6),this.unsigned),s=this,a="";;){var o=s.div(i),u=s.sub(o.mul(i)).toInt()>>>0,f=u.toString(r);if(s=o,s.isZero())return f+a;for(;f.length<6;)f="0"+f;a=""+f+a}};Gt.getHighBits=function(){return this.high};Gt.getHighBitsUnsigned=function(){return this.high>>>0};Gt.getLowBits=function(){return this.low};Gt.getLowBitsUnsigned=function(){return this.low>>>0};Gt.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ha)?64:this.neg().getNumBitsAbs();for(var r=this.high!=0?this.high:this.low,e=31;e>0&&!(r&1<<e);e--);return this.high!=0?e+33:e+1};Gt.isSafeInteger=function(){var r=this.high>>21;return r?this.unsigned?!1:r===-1&&!(this.low===0&&this.high===-2097152):!0};Gt.isZero=function(){return this.high===0&&this.low===0};Gt.eqz=Gt.isZero;Gt.isNegative=function(){return!this.unsigned&&this.high<0};Gt.isPositive=function(){return this.unsigned||this.high>=0};Gt.isOdd=function(){return(this.low&1)===1};Gt.isEven=function(){return(this.low&1)===0};Gt.equals=function(r){return Eo(r)||(r=Al(r)),this.unsigned!==r.unsigned&&this.high>>>31===1&&r.high>>>31===1?!1:this.high===r.high&&this.low===r.low};Gt.eq=Gt.equals;Gt.notEquals=function(r){return!this.eq(r)};Gt.neq=Gt.notEquals;Gt.ne=Gt.notEquals;Gt.lessThan=function(r){return this.comp(r)<0};Gt.lt=Gt.lessThan;Gt.lessThanOrEqual=function(r){return this.comp(r)<=0};Gt.lte=Gt.lessThanOrEqual;Gt.le=Gt.lessThanOrEqual;Gt.greaterThan=function(r){return this.comp(r)>0};Gt.gt=Gt.greaterThan;Gt.greaterThanOrEqual=function(r){return this.comp(r)>=0};Gt.gte=Gt.greaterThanOrEqual;Gt.ge=Gt.greaterThanOrEqual;Gt.compare=function(r){if(Eo(r)||(r=Al(r)),this.eq(r))return 0;var e=this.isNegative(),t=r.isNegative();return e&&!t?-1:!e&&t?1:this.unsigned?r.high>>>0>this.high>>>0||r.high===this.high&&r.low>>>0>this.low>>>0?-1:1:this.sub(r).isNegative()?-1:1};Gt.comp=Gt.compare;Gt.negate=function(){return!this.unsigned&&this.eq(ha)?ha:this.not().add(Sm)};Gt.neg=Gt.negate;Gt.add=function(r){Eo(r)||(r=Al(r));var e=this.high>>>16,t=this.high&65535,n=this.low>>>16,i=this.low&65535,s=r.high>>>16,a=r.high&65535,o=r.low>>>16,u=r.low&65535,f=0,g=0,y=0,A=0;return A+=i+u,y+=A>>>16,A&=65535,y+=n+o,g+=y>>>16,y&=65535,g+=t+a,f+=g>>>16,g&=65535,f+=e+s,f&=65535,wn(y<<16|A,f<<16|g,this.unsigned)};Gt.subtract=function(r){return Eo(r)||(r=Al(r)),this.add(r.neg())};Gt.sub=Gt.subtract;Gt.multiply=function(r){if(this.isZero())return this;if(Eo(r)||(r=Al(r)),dl){var e=dl.mul(this.low,this.high,r.low,r.high);return wn(e,dl.get_high(),this.unsigned)}if(r.isZero())return this.unsigned?Vu:Ql;if(this.eq(ha))return r.isOdd()?ha:Ql;if(r.eq(ha))return this.isOdd()?ha:Ql;if(this.isNegative())return r.isNegative()?this.neg().mul(r.neg()):this.neg().mul(r).neg();if(r.isNegative())return this.mul(r.neg()).neg();if(this.lt(oV)&&r.lt(oV))return fl(this.toNumber()*r.toNumber(),this.unsigned);var t=this.high>>>16,n=this.high&65535,i=this.low>>>16,s=this.low&65535,a=r.high>>>16,o=r.high&65535,u=r.low>>>16,f=r.low&65535,g=0,y=0,A=0,C=0;return C+=s*f,A+=C>>>16,C&=65535,A+=i*f,y+=A>>>16,A&=65535,A+=s*u,y+=A>>>16,A&=65535,y+=n*f,g+=y>>>16,y&=65535,y+=i*u,g+=y>>>16,y&=65535,y+=s*o,g+=y>>>16,y&=65535,g+=t*f+n*u+i*o+s*a,g&=65535,wn(A<<16|C,g<<16|y,this.unsigned)};Gt.mul=Gt.multiply;Gt.divide=function(r){if(Eo(r)||(r=Al(r)),r.isZero())throw Error("division by zero");if(dl){if(!this.unsigned&&this.high===-2147483648&&r.low===-1&&r.high===-1)return this;var e=(this.unsigned?dl.div_u:dl.div_s)(this.low,this.high,r.low,r.high);return wn(e,dl.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Vu:Ql;var t,n,i;if(this.unsigned){if(r.unsigned||(r=r.toUnsigned()),r.gt(this))return Vu;if(r.gt(this.shru(1)))return $Y;i=Vu}else{if(this.eq(ha)){if(r.eq(Sm)||r.eq(_M))return ha;if(r.eq(ha))return Sm;var s=this.shr(1);return t=s.div(r).shl(1),t.eq(Ql)?r.isNegative()?Sm:_M:(n=this.sub(r.mul(t)),i=t.add(n.div(r)),i)}else if(r.eq(ha))return this.unsigned?Vu:Ql;if(this.isNegative())return r.isNegative()?this.neg().div(r.neg()):this.neg().div(r).neg();if(r.isNegative())return this.div(r.neg()).neg();i=Ql}for(n=this;n.gte(r);){t=Math.max(1,Math.floor(n.toNumber()/r.toNumber()));for(var a=Math.ceil(Math.log(t)/Math.LN2),o=a<=48?1:yT(2,a-48),u=fl(t),f=u.mul(r);f.isNegative()||f.gt(n);)t-=o,u=fl(t,this.unsigned),f=u.mul(r);u.isZero()&&(u=Sm),i=i.add(u),n=n.sub(f)}return i};Gt.div=Gt.divide;Gt.modulo=function(r){if(Eo(r)||(r=Al(r)),dl){var e=(this.unsigned?dl.rem_u:dl.rem_s)(this.low,this.high,r.low,r.high);return wn(e,dl.get_high(),this.unsigned)}return this.sub(this.div(r).mul(r))};Gt.mod=Gt.modulo;Gt.rem=Gt.modulo;Gt.not=function(){return wn(~this.low,~this.high,this.unsigned)};Gt.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32};Gt.clz=Gt.countLeadingZeros;Gt.countTrailingZeros=function(){return this.low?rV(this.low):rV(this.high)+32};Gt.ctz=Gt.countTrailingZeros;Gt.and=function(r){return Eo(r)||(r=Al(r)),wn(this.low&r.low,this.high&r.high,this.unsigned)};Gt.or=function(r){return Eo(r)||(r=Al(r)),wn(this.low|r.low,this.high|r.high,this.unsigned)};Gt.xor=function(r){return Eo(r)||(r=Al(r)),wn(this.low^r.low,this.high^r.high,this.unsigned)};Gt.shiftLeft=function(r){return Eo(r)&&(r=r.toInt()),(r&=63)===0?this:r<32?wn(this.low<<r,this.high<<r|this.low>>>32-r,this.unsigned):wn(0,this.low<<r-32,this.unsigned)};Gt.shl=Gt.shiftLeft;Gt.shiftRight=function(r){return Eo(r)&&(r=r.toInt()),(r&=63)===0?this:r<32?wn(this.low>>>r|this.high<<32-r,this.high>>r,this.unsigned):wn(this.high>>r-32,this.high>=0?0:-1,this.unsigned)};Gt.shr=Gt.shiftRight;Gt.shiftRightUnsigned=function(r){return Eo(r)&&(r=r.toInt()),(r&=63)===0?this:r<32?wn(this.low>>>r|this.high<<32-r,this.high>>>r,this.unsigned):r===32?wn(this.high,0,this.unsigned):wn(this.high>>>r-32,0,this.unsigned)};Gt.shru=Gt.shiftRightUnsigned;Gt.shr_u=Gt.shiftRightUnsigned;Gt.rotateLeft=function(r){var e;return Eo(r)&&(r=r.toInt()),(r&=63)===0?this:r===32?wn(this.high,this.low,this.unsigned):r<32?(e=32-r,wn(this.low<<r|this.high>>>e,this.high<<r|this.low>>>e,this.unsigned)):(r-=32,e=32-r,wn(this.high<<r|this.low>>>e,this.low<<r|this.high>>>e,this.unsigned))};Gt.rotl=Gt.rotateLeft;Gt.rotateRight=function(r){var e;return Eo(r)&&(r=r.toInt()),(r&=63)===0?this:r===32?wn(this.high,this.low,this.unsigned):r<32?(e=32-r,wn(this.high<<e|this.low>>>r,this.low<<e|this.high>>>r,this.unsigned)):(r-=32,e=32-r,wn(this.low<<e|this.high>>>r,this.high<<e|this.low>>>r,this.unsigned))};Gt.rotr=Gt.rotateRight;Gt.toSigned=function(){return this.unsigned?wn(this.low,this.high,!1):this};Gt.toUnsigned=function(){return this.unsigned?this:wn(this.low,this.high,!0)};Gt.toBytes=function(r){return r?this.toBytesLE():this.toBytesBE()};Gt.toBytesLE=function(){var r=this.high,e=this.low;return[e&255,e>>>8&255,e>>>16&255,e>>>24,r&255,r>>>8&255,r>>>16&255,r>>>24]};Gt.toBytesBE=function(){var r=this.high,e=this.low;return[r>>>24,r>>>16&255,r>>>8&255,r&255,e>>>24,e>>>16&255,e>>>8&255,e&255]};Fn.fromBytes=function(r,e,t){return t?Fn.fromBytesLE(r,e):Fn.fromBytesBE(r,e)};Fn.fromBytesLE=function(r,e){return new Fn(r[0]|r[1]<<8|r[2]<<16|r[3]<<24,r[4]|r[5]<<8|r[6]<<16|r[7]<<24,e)};Fn.fromBytesBE=function(r,e){return new Fn(r[4]<<24|r[5]<<16|r[6]<<8|r[7],r[0]<<24|r[1]<<16|r[2]<<8|r[3],e)};typeof BigInt=="function"&&(Fn.fromBigInt=function(r,e){var t=Number(BigInt.asIntN(32,r)),n=Number(BigInt.asIntN(32,r>>BigInt(32)));return wn(t,n,e)},Fn.fromValue=function(r,e){return typeof r=="bigint"?fromBigInt(r,e):Al(r,e)},Gt.toBigInt=function(){var r=BigInt(this.low>>>0),e=BigInt(this.unsigned?this.high>>>0:this.high);return e<<BigInt(32)|r});const U9e=16;function HY(r){r==="X"&&(r="");const e=r.padEnd(U9e,"0");return Fn.fromString(e,!0,16)}function z9e(r){if(r.isZero())return"X";let e=r.countTrailingZeros();const t=e%4;e=(e-t)/4;const n=e;e*=4;const i=r.shiftRightUnsigned(e).toString(16).replace(/0+$/,"");return Array(17-n-i.length).join("0")+i}function V9e(r,e){const t=$9e(r).shiftRightUnsigned(2);return r.add(Fn.fromNumber(2*e+1-4).multiply(t))}function $9e(r){return r.and(r.not().add(1))}const j9e=3,G9e=30,H9e=2*G9e+1,aV=180/Math.PI;function W9e(r){if(r.length===0)throw new Error(`Invalid Hilbert quad key ${r}`);const e=r.split("/"),t=parseInt(e[0],10),n=e[1],i=n.length;let s=0;const a=[0,0];for(let o=i-1;o>=0;o--){s=i-o;const u=n[o];let f=0,g=0;u==="1"?g=1:u==="2"?(f=1,g=1):u==="3"&&(f=1);const y=Math.pow(2,s-1);X9e(y,a,f,g),a[0]+=y*f,a[1]+=y*g}if(t%2===1){const o=a[0];a[0]=a[1],a[1]=o}return{face:t,ij:a,level:s}}function K9e(r){if(r.isZero())return"";let e=r.toString(2);for(;e.length<j9e+H9e;)e="0"+e;const t=e.lastIndexOf("1"),n=e.substring(0,3),i=e.substring(3,t),s=i.length/2,a=Fn.fromString(n,!0,2).toString(10);let o="";if(s!==0)for(o=Fn.fromString(i,!0,2).toString(4);o.length<s;)o="0"+o;return`${a}/${o}`}function WY(r,e,t){const n=1<<e;return[(r[0]+t[0])/n,(r[1]+t[1])/n]}function lV(r){return r>=.5?1/3*(4*r*r-1):1/3*(1-4*(1-r)*(1-r))}function KY(r){return[lV(r[0]),lV(r[1])]}function XY(r,[e,t]){switch(r){case 0:return[1,e,t];case 1:return[-e,1,t];case 2:return[-e,-t,1];case 3:return[-1,-t,-e];case 4:return[t,-1,-e];case 5:return[t,e,-1];default:throw new Error("Invalid face")}}function JY([r,e,t]){const n=Math.atan2(t,Math.sqrt(r*r+e*e));return[Math.atan2(e,r)*aV,n*aV]}function X9e(r,e,t,n){if(n===0){t===1&&(e[0]=r-1-e[0],e[1]=r-1-e[1]);const i=e[0];e[0]=e[1],e[1]=i}}function J9e(r){const e=WY(r.ij,r.level,[.5,.5]),t=KY(e),n=XY(r.face,t);return JY(n)}const q9e=100;function cV(r){const{face:e,ij:t,level:n}=r,i=[[0,0],[0,1],[1,1],[1,0],[0,0]],s=Math.max(1,Math.ceil(q9e*Math.pow(2,-n))),a=new Float64Array(4*s*2+2);let o=0,u=0;for(let f=0;f<4;f++){const g=i[f].slice(0),y=i[f+1],A=(y[0]-g[0])/s,C=(y[1]-g[1])/s;for(let M=0;M<s;M++){g[0]+=A,g[1]+=C;const k=WY(t,n,g),D=KY(k),V=XY(e,D),W=JY(V);Math.abs(W[1])>89.999&&(W[0]=u);const z=W[0]-u;W[0]+=z>180?-360:z<-180?360:0,a[o++]=W[0],a[o++]=W[1],u=W[0]}}return a[o++]=a[0],a[o++]=a[1],a}function iL(r){const e=Y9e(r);return W9e(e)}function Y9e(r){if(r.indexOf("/")>0)return r;const e=HY(r);return K9e(e)}function Z9e(r){const e=iL(r);return J9e(e)}function Q9e(r){let e;if(r.face===2||r.face===5){let t=null,n=0;for(let i=0;i<4;i++){const s=`${r.face}/${i}`,a=iL(s),o=cV(a);(typeof t>"u"||t===null)&&(t=new Float64Array(4*o.length)),t.set(o,n),n+=o.length}e=uV(t)}else{const t=cV(r);e=uV(t)}return e}function uV(r){if(r.length%2!==0)throw new Error("Invalid corners");const e=[],t=[];for(let n=0;n<r.length;n+=2)e.push(r[n]),t.push(r[n+1]);return e.sort((n,i)=>n-i),t.sort((n,i)=>n-i),{west:e[0],east:e[e.length-1],north:t[t.length-1],south:t[0]}}function eze(r,e){const t=e?.minimumHeight||0,n=e?.maximumHeight||0,i=iL(r),s=Q9e(i),a=s.west,o=s.south,u=s.east,f=s.north,g=[];return g.push(new zt(a,f,t)),g.push(new zt(u,f,t)),g.push(new zt(u,o,t)),g.push(new zt(a,o,t)),g.push(new zt(a,f,n)),g.push(new zt(u,f,n)),g.push(new zt(u,o,n)),g.push(new zt(a,o,n)),g}function qY(r){const e=r.token,t={minimumHeight:r.minimumHeight,maximumHeight:r.maximumHeight},n=eze(e,t),i=Z9e(e),s=i[0],a=i[1],o=uT.WGS84.cartographicToCartesian([s,a,t.maximumHeight]),u=new zt(o[0],o[1],o[2]);n.push(u);const f=OFe(n);return[...f.center,...f.halfAxes]}const tze=4,rze=8,nze={QUADTREE:tze,OCTREE:rze};function ize(r,e,t){if(r!=null&&r.box){const n=HY(r.s2VolumeInfo.token),i=V9e(n,e),s=z9e(i),a={...r.s2VolumeInfo};switch(a.token=s,t){case"OCTREE":const o=r.s2VolumeInfo,u=o.maximumHeight-o.minimumHeight,f=u/2,g=o.minimumHeight+u/2;o.minimumHeight=g-f,o.maximumHeight=g+f;break}return{box:qY(a),s2VolumeInfo:a}}}async function YY(r){const{subtree:e,subtreeData:t={level:0,x:0,y:0,z:0},parentData:n={mortonIndex:0,localLevel:-1,localX:0,localY:0,localZ:0},childIndex:i=0,implicitOptions:s,loaderOptions:a,s2VolumeBox:o}=r,{subdivisionScheme:u,subtreeLevels:f,maximumLevel:g,contentUrlTemplate:y,subtreesUriTemplate:A,basePath:C}=s,M={children:[],lodMetricValue:0,contentUrl:""};if(!g)return Cq.once(`Missing 'maximumLevel' or 'availableLevels' property. The subtree ${y} won't be loaded...`),M;const k=n.localLevel+1,D=t.level+k;if(D>g)return M;const V=nze[u],W=Math.log2(V),z=i&1,$=i>>1&1,te=i>>2&1,le=Sf(n.localX,z,1),_e=Sf(n.localY,$,1),se=Sf(n.localZ,te,1),Y=Sf(t.x,le,k),ce=Sf(t.y,_e,k),oe=Sf(t.z,se,k),Me=Sf(n.mortonIndex,i,W),ze=k===f&&o3(e.childSubtreeAvailability,Me);let Ve,lt,gt,At;if(ze){const Tt=`${C}/${A}`,Ut=vM(Tt,D,Y,ce,oe);Ve=await aY(Ut,zY,a),At=0,lt={level:D,x:Y,y:ce,z:oe},gt={mortonIndex:0,localLevel:0,localX:0,localY:0,localZ:0}}else Ve=e,At=(V**k-1)/(V-1)+Me,lt=t,gt={mortonIndex:Me,localLevel:k,localX:le,localY:_e,localZ:se};if(!o3(Ve.tileAvailability,At))return M;o3(Ve.contentAvailability,At)&&(M.contentUrl=vM(y,D,Y,ce,oe));for(let Tt=0;Tt<V;Tt++){const Ut=ize(o,Tt,u),xr=await YY({subtree:Ve,subtreeData:lt,parentData:gt,childIndex:Tt,implicitOptions:s,loaderOptions:a,s2VolumeBox:Ut});(xr.contentUrl||xr.children.length)&&M.children.push(xr)}return M.contentUrl||M.children.length?sze(M,{level:D,x:Y,y:ce,z:oe},s,o):M}function o3(r,e){let t;return Array.isArray(r)?(t=r[0],r.length>1&&Cq.once('Not supported extension "3DTILES_multiple_contents" has been detected')):t=r,"constant"in t?!!t.constant:t.explicitBitstream?lze(e,t.explicitBitstream):!1}function sze(r,e,t,n){const{basePath:i,refine:s,getRefine:a,lodMetricType:o,getTileType:u,rootLodMetricValue:f,rootBoundingVolume:g}=t,y=r.contentUrl&&r.contentUrl.replace(`${i}/`,""),A=f/2**e.level,C=n!=null&&n.box?{box:n.box}:g,M=oze(C,e,t.subdivisionScheme);return{children:r.children,contentUrl:r.contentUrl,content:{uri:y},id:r.contentUrl,refine:a(s),type:u(r),lodMetricType:o,lodMetricValue:A,geometricError:A,transform:r.transform,boundingVolume:M}}function oze(r,e,t){if(r.region){const{level:n,x:i,y:s,z:a}=e,[o,u,f,g,y,A]=r.region,C=2**n,M=(f-o)/C,[k,D]=[o+M*i,o+M*(i+1)],V=(g-u)/C,[W,z]=[u+V*s,u+V*(s+1)];let $,te;if(t==="OCTREE"){const le=(A-y)/C;[$,te]=[y+le*a,y+le*(a+1)]}else[$,te]=[y,A];return{region:[k,W,D,z,$,te]}}if(r.box)return r;throw new Error(`Unsupported bounding volume type ${JSON.stringify(r)}`)}function Sf(r,e,t){return(r<<t)+e}function vM(r,e,t,n,i){const s=aze({level:e,x:t,y:n,z:i});return r.replace(/{level}|{x}|{y}|{z}/gi,a=>s[a])}function aze(r){const e={};for(const t in r)e[`{${t}}`]=r[t];return e}function lze(r,e){const t=Math.floor(r/8),n=r%8;return(e[t]>>n&1)===1}function sL(r,e=""){if(!e)return Tm.EMPTY;const t=e.split("?")[0].split(".").pop();switch(t){case"pnts":return Tm.POINTCLOUD;case"i3dm":case"b3dm":case"glb":case"gltf":return Tm.SCENEGRAPH;default:return t||Tm.EMPTY}}function oL(r){switch(r){case"REPLACE":case"replace":return dT.REPLACE;case"ADD":case"add":return dT.ADD;default:return r}}function AM(r,e){if(/^[a-z][0-9a-z+.-]*:/i.test(e)){const t=new URL(r,`${e}/`);return decodeURI(t.toString())}else if(r.startsWith("/"))return r;return wLe(e,r)}function hV(r,e){var t;if(!r)return null;let n;if(r.content){const i=r.content.uri||((t=r.content)==null?void 0:t.url);typeof i<"u"&&(n=AM(i,e))}return{...r,id:n,contentUrl:n,lodMetricType:py.GEOMETRIC_ERROR,lodMetricValue:r.geometricError,transformMatrix:r.transform,type:sL(r,n),refine:oL(r.refine)}}async function cze(r,e,t){let n=null;const i=fV(r.root);i&&r.root?n=await dV(r.root,r,e,i,t):n=hV(r.root,e);const s=[];for(s.push(n);s.length>0;){const a=s.pop()||{},o=a.children||[],u=[];for(const f of o){const g=fV(f);let y;g?y=await dV(f,r,e,g,t):y=hV(f,e),y&&(u.push(y),s.push(y))}a.children=u}return n}async function dV(r,e,t,n,i){var s,a,o;const{subdivisionScheme:u,maximumLevel:f,availableLevels:g,subtreeLevels:y,subtrees:{uri:A}}=n,C=vM(A,0,0,0,0),M=AM(C,t),k=await aY(M,zY,i),D=(s=r.content)==null?void 0:s.uri,V=D?AM(D,t):"",W=(a=e?.root)==null?void 0:a.refine,z=r.geometricError,$=(o=r.boundingVolume.extensions)==null?void 0:o["3DTILES_bounding_volume_S2"];if($){const _e={box:qY($),s2VolumeInfo:$};r.boundingVolume=_e}const te=r.boundingVolume,le={contentUrlTemplate:V,subtreesUriTemplate:A,subdivisionScheme:u,subtreeLevels:y,maximumLevel:Number.isFinite(g)?g-1:f,refine:W,basePath:t,lodMetricType:py.GEOMETRIC_ERROR,rootLodMetricValue:z,rootBoundingVolume:te,getTileType:sL,getRefine:oL};return await uze(r,t,k,le,i)}async function uze(r,e,t,n,i){if(!r)return null;const{children:s,contentUrl:a}=await YY({subtree:t,implicitOptions:n,loaderOptions:i});let o,u=null;return a&&(o=a,u={uri:a.replace(`${e}/`,"")}),{...r,id:o,contentUrl:o,lodMetricType:py.GEOMETRIC_ERROR,lodMetricValue:r.geometricError,transformMatrix:r.transform,type:sL(r,o),refine:oL(r.refine),content:u||r.content,children:s}}function fV(r){var e;return((e=r?.extensions)==null?void 0:e["3DTILES_implicit_tiling"])||r?.implicitTiling}const ZY={dataType:null,batchType:null,id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:lY,extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:hze,options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}};async function hze(r,e={},t){const n=e["3d-tiles"]||{};let i;return n.isTileset==="auto"?i=t?.url&&t.url.indexOf(".json")!==-1:i=n.isTileset,i?dze(r,e,t):fze(r,e,t)}async function dze(r,e,t){var n;const i=JSON.parse(new TextDecoder().decode(r)),s=t?.url||"",a=pze(s),o=await cze(i,a,e||{});return{...i,shape:"tileset3d",loader:ZY,url:s,queryString:t?.queryString||"",basePath:a,root:o||i.root,type:dM.TILES3D,lodMetricType:py.GEOMETRIC_ERROR,lodMetricValue:((n=i.root)==null?void 0:n.geometricError)||0}}async function fze(r,e,t){const n={content:{shape:"tile3d",featureIds:null}};return await UY(r,0,e,t,n.content),n.content}function pze(r){return kq(r)}const gze={...Wi,data:{type:String,default:void 0},loadOptions:{type:Object,default:void 0},getPointColor:{type:[Function,Array],default:()=>[0,0,0,255]},pointSize:{type:Number,default:1},loader:{type:Object,default:ZY},onTilesetLoad:{type:Function,default:void 0},onTileLoad:{type:Function,default:void 0},onTileUnload:{type:Function,default:void 0},onTileError:{type:Function,default:void 0},_getMeshColor:{type:Function,default:()=>[255,255,255]}},mze=[...Ki,"data","getPointColor","pointSize","loader","loadOptions","onTilesetLoad","onTileLoad","onTileUnload","onTileError","_getMeshColor"];I.defineComponent({name:"Tile3DLayer",props:{...gze},emits:["hover","click","drag","dragStart","dragEnd","dataLoad","error"],setup(r,{emit:e,expose:t}){const{layer:n}=Ni(i=>new bD(i),r,mze,e);return t({layer:n}),()=>[]}});const yze={...Wi,filled:{type:Boolean,default:!0},extruded:{type:Boolean,default:!1},wireframe:{type:Boolean,default:!1},elevationScale:{type:Number,default:1},material:{type:Object},getPolygon:{type:Function,default:r=>r?.polygon||r?.contour||r?.coordinates},getElevation:{type:[Function,Number],default:1e3},getFillColor:{type:[Function,Array],default:()=>[0,0,0,255]},getLineColor:{type:[Function,Array],default:()=>[255,255,255,255]}},bze=[...Ki,"filled","extruded","wireframe","elevationScale","material","getPolygon","getElevation","getFillColor","getLineColor"];I.defineComponent({name:"SolidPolygonLayer",props:{...yze},emits:["hover","click","drag","dragStart","dragEnd","dataLoad","error"],setup(r,{emit:e,expose:t}){const{layer:n}=Ni(i=>new ky(i),r,bze,e);return t({layer:n}),()=>[]}});const _ze={...Wi,sizeUnits:{type:String,default:"meters"},sizeScale:{type:Number,default:1},sizeMinPixels:{type:Number,default:0},billboard:{type:Boolean,default:!0},fontFamily:{type:String,default:"Monaco, monospace"},maxWidth:{type:Number,default:-1},lineHeight:{type:Number,default:1},getText:{type:[Function,String],default:r=>r?.text},getPosition:{type:Function,default:r=>r?.position},getColor:{type:[Function,Array],default:()=>[255,255,255,255]},getSize:{type:[Function,Number],default:32},getAngle:{type:[Function,Number],default:0},getTextAnchor:{type:[Function,String],default:"middle"},getAlignmentBaseline:{type:[Function,String],default:"center"},getPixelOffset:{type:[Function,Array],default:()=>[0,0]}},vze=[...Ki,"sizeUnits","sizeScale","sizeMinPixels","billboard","fontFamily","maxWidth","lineHeight","getText","getPosition","getColor","getSize","getAngle","getTextAnchor","getAlignmentBaseline","getPixelOffset"];I.defineComponent({name:"TextLayer",props:{..._ze},emits:["hover","click","drag","dragStart","dragEnd","dataLoad","error"],setup(r,{emit:e,expose:t}){const{layer:n}=Ni(i=>new WS(i),r,vze,e);return t({layer:n}),()=>[]}});const Aze={...Wi,cellSize:{type:Number,default:20},getPosition:{type:Function,default:r=>r?.position},getFillColor:{type:[Function,Array],default:()=>[0,0,0,255]},getElevation:{type:[Function,Number],default:0}},xze=[...Ki,"cellSize","getPosition","getFillColor","getElevation"];I.defineComponent({name:"GridCellLayer",props:{...Aze},emits:["hover","click","drag","dragStart","dragEnd","dataLoad","error"],setup(r,{emit:e,expose:t}){const{layer:n}=Ni(i=>new VO(i),r,xze,e);return t({layer:n}),()=>[]}});const wze={...Wi,cellSizePixels:{type:Number,default:20},colorRange:{type:Array},colorDomain:{type:Array},getPosition:{type:Function,default:r=>r?.position},getWeight:{type:[Function,Number],default:1}},Cze=[...Ki,"cellSizePixels","colorRange","colorDomain","getPosition","getWeight"];I.defineComponent({name:"ScreenGridLayer",props:{...wze},emits:["hover","click","drag","dragStart","dragEnd","dataLoad","error"],setup(r,{emit:e,expose:t}){const{layer:n}=Ni(i=>new TD(i),r,Cze,e);return t({layer:n}),()=>[]}});const Tze={...Wi,data:{type:[String,Object]},maxZoom:{type:Number},minZoom:{type:Number},getLineColor:{type:[Function,Array],default:()=>[0,0,0,255]},getFillColor:{type:[Function,Array],default:()=>[200,200,200,255]},getPointRadius:{type:[Function,Number],default:2},lineWidthMinPixels:{type:Number,default:1}},Sze=[...Ki,"data","maxZoom","minZoom","getLineColor","getFillColor","getPointRadius","lineWidthMinPixels"];I.defineComponent({name:"MVTLayer",props:{...Tze},emits:["hover","click","drag","dragStart","dragEnd","dataLoad","error"],setup(r,{emit:e,expose:t}){const{layer:n}=Ni(i=>new xD(i),r,Sze,e);return t({layer:n}),()=>[]}});const Eze={...Wi,elevationDecoder:{type:Object,required:!0},elevationData:{type:String,required:!0},texture:{type:String},bounds:{type:Array},meshMaxError:{type:Number}},Ize=[...Ki,"elevationDecoder","elevationData","texture","bounds","meshMaxError"];I.defineComponent({name:"TerrainLayer",props:{...Eze},emits:["hover","click","drag","dragStart","dragEnd","dataLoad","error"],setup(r,{emit:e,expose:t}){const{layer:n}=Ni(i=>new _D(i),r,Ize,e);return t({layer:n}),()=>[]}});const pV="/static/liberty.json",aL={__name:"BeaconMap",__ssrInlineRender:!0,setup(r){return(e,t,n,i)=>{t(Fo(I.unref(twe),I.mergeProps({getTooltip:({object:s})=>s&&`height: ${s.value*5e3}m`},i),{default:I.withCtx((s,a,o,u)=>{if(a)a(Fo(I.unref(o8),{height:"100vh",style:pV,center:[120.596,16.4023],zoom:12,"max-zoom":20,pitch:30,bearing:0},null,o,u)),a(Fo(I.unref(oz),{id:"ColumnLayer",data:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/hexagons.json",diskResolution:12,extruded:!0,radius:250,elevationScale:5e3,getElevation:f=>f.value,getFillColor:f=>[48,128,f.value*255,255],getPosition:f=>f.centroid,pickable:!0},null,o,u));else return[I.createVNode(I.unref(o8),{height:"100vh",style:pV,center:[120.596,16.4023],zoom:12,"max-zoom":20,pitch:30,bearing:0}),I.createVNode(I.unref(oz),{id:"ColumnLayer",data:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/hexagons.json",diskResolution:12,extruded:!0,radius:250,elevationScale:5e3,getElevation:f=>f.value,getFillColor:f=>[48,128,f.value*255,255],getPosition:f=>f.centroid,pickable:!0},null,8,["getElevation","getFillColor","getPosition"])]}),_:1},n))}}},gV=aL.setup;aL.setup=(r,e)=>{const t=I.useSSRContext();return(t.modules||(t.modules=new Set)).add("vue/BeaconMap.vue"),gV?gV(r,e):void 0};const Pze=Object.freeze(Object.defineProperty({__proto__:null,default:aL},Symbol.toStringTag,{value:"Module"})),Bze=({createApp:r,component:e,props:t,slots:n,plugin:i,el:s})=>{const a=r({render:()=>I.h(e,t,n)});return a.use(i),a.mount(s),a},Mze=(r,e={})=>"resolve"in r&&"setup"in r?r:(console.warn(`deprecation warning:

Instead of passing components, use createLiveVue({resolve, setup})`),QY({resolve:t=>{for(const[n,i]of Object.entries(r))if(n.endsWith(`${t}.vue`)||n.endsWith(`${t}/index.vue`))return i},setup:e.initializeApp})),Rze=async r=>(typeof r=="function"?r=await r():r instanceof Promise&&(r=await r),r&&"default"in r&&(r=r.default),r),QY=({resolve:r,setup:e})=>({setup:e||Bze,resolve:async t=>{let n=r(t);if(!n)throw new Error(`Component ${t} not found!`);return await Rze(n)}}),kze="_live_vue",bT=()=>{const r=I.inject(kze);if(!r)throw new Error("LiveVue not provided. Are you using this inside a LiveVue component?");return r};function mV(r,e){let t=null;I.onMounted(()=>{t=bT().handleEvent(r,e)}),I.onUnmounted(()=>{const n=bT();t&&n.removeHandleEvent(t),t=null})}const Oze=()=>{const e=bT().liveSocket;if(!e)throw new Error("LiveSocket not initialized");return{patch:(i,s={})=>{let a=typeof i=="string"?i:window.location.pathname;if(typeof i=="object"){const o=new URLSearchParams(i);a=`${a}?${o.toString()}`}e.pushHistoryPatch(new Event("click"),a,s.replace?"replace":"push",null)},navigate:(i,s={})=>{e.historyRedirect(new Event("click"),i,s.replace?"replace":"push",null,null)}}},Dze=(r,e)=>Object.entries(r).reduce((t,[n,i])=>(t[n]=e(i,n,r),t),{}),Lze=(r,e)=>{for(const[n,i]of Object.entries(r))if(n.endsWith(`${e}.vue`)||n.endsWith(`${e}/index.vue`))return i;const t=Object.keys(r).map(n=>n.replace("../../lib/","").replace("/index.vue","").replace(".vue","").replace("./","")).filter(n=>!n.startsWith("_build")).join(`
`);throw new Error(`Component '${e}' not found! Available components:

${t}

`)};I.defineComponent({props:{href:{type:String,default:null},patch:{type:String,default:null},navigate:{type:String,default:null},replace:{type:Boolean,default:!1}},setup(r,{attrs:e,slots:t}){const n=I.computed(()=>!r.patch&&!r.navigate?{href:r.href||"#"}:{href:(r.navigate?r.navigate:r.patch)||"#","data-phx-link":r.navigate?"redirect":"patch","data-phx-link-state":r.replace?"replace":"push"});return()=>I.h("a",{...e,...n.value},t)}});function wo(...r){if(r){let e=[];for(let t=0;t<r.length;t++){let n=r[t];if(!n)continue;let i=typeof n;if(i==="string"||i==="number")e.push(n);else if(i==="object"){let s=Array.isArray(n)?[wo(...n)]:Object.entries(n).map(([a,o])=>o?a:void 0);e=s.length?e.concat(s.filter(a=>!!a)):e}}return e.join(" ").trim()}}function Nze(r,e){return r?r.classList?r.classList.contains(e):new RegExp("(^| )"+e+"( |$)","gi").test(r.className):!1}function L0(r,e){if(r&&e){let t=n=>{Nze(r,n)||(r.classList?r.classList.add(n):r.className+=" "+n)};[e].flat().filter(Boolean).forEach(n=>n.split(" ").forEach(t))}}function Fze(r){if(r){let e=document.createElement("a");if(e.download!==void 0){let{name:t,src:n}=r;return e.setAttribute("href",n),e.setAttribute("download",t),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e),!0}}return!1}function Uze(r,e){let t=new Blob([r],{type:"application/csv;charset=utf-8;"});window.navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(t,e+".csv"):Fze({name:e+".csv",src:URL.createObjectURL(t)})||(r="data:text/csv;charset=utf-8,"+r,window.open(encodeURI(r)))}function rd(r,e){if(r&&e){let t=n=>{r.classList?r.classList.remove(n):r.className=r.className.replace(new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi")," ")};[e].flat().filter(Boolean).forEach(n=>n.split(" ").forEach(t))}}function xM(r){for(let e of document?.styleSheets)try{for(let t of e?.cssRules)for(let n of t?.style)if(r.test(n))return{name:n,value:t.style.getPropertyValue(n).trim()}}catch{}return null}function eZ(r){let e={width:0,height:0};if(r){let[t,n]=[r.style.visibility,r.style.display],i=r.getBoundingClientRect();r.style.visibility="hidden",r.style.display="block",e.width=i.width||r.offsetWidth,e.height=i.height||r.offsetHeight,r.style.display=n,r.style.visibility=t}return e}function tZ(){let r=window,e=document,t=e.documentElement,n=e.getElementsByTagName("body")[0],i=r.innerWidth||t.clientWidth||n.clientWidth,s=r.innerHeight||t.clientHeight||n.clientHeight;return{width:i,height:s}}function wM(r){return r?Math.abs(r.scrollLeft):0}function zze(){let r=document.documentElement;return(window.pageXOffset||wM(r))-(r.clientLeft||0)}function Vze(){let r=document.documentElement;return(window.pageYOffset||r.scrollTop)-(r.clientTop||0)}function rZ(r){return r?getComputedStyle(r).direction==="rtl":!1}function nZ(r,e,t=!0){var n,i,s,a;if(r){let o=r.offsetParent?{width:r.offsetWidth,height:r.offsetHeight}:eZ(r),u=o.height,f=o.width,g=e.offsetHeight,y=e.offsetWidth,A=e.getBoundingClientRect(),C=Vze(),M=zze(),k=tZ(),D,V,W="top";A.top+g+u>k.height?(D=A.top+C-u,W="bottom",D<0&&(D=C)):D=g+A.top+C,A.left+f>k.width?V=Math.max(0,A.left+M+y-f):V=A.left+M,rZ(r)?r.style.insetInlineEnd=V+"px":r.style.insetInlineStart=V+"px",r.style.top=D+"px",r.style.transformOrigin=W,t&&(r.style.marginTop=W==="bottom"?`calc(${(i=(n=xM(/-anchor-gutter$/))==null?void 0:n.value)!=null?i:"2px"} * -1)`:(a=(s=xM(/-anchor-gutter$/))==null?void 0:s.value)!=null?a:"")}}function _T(r,e){r&&(typeof e=="string"?r.style.cssText=e:Object.entries(e||{}).forEach(([t,n])=>r.style[t]=n))}function da(r,e){return r instanceof HTMLElement?r.offsetWidth:0}function $ze(r,e,t=!0,n=void 0){var i;if(r){let s=r.offsetParent?{width:r.offsetWidth,height:r.offsetHeight}:eZ(r),a=e.offsetHeight,o=e.getBoundingClientRect(),u=tZ(),f,g,y=n??"top";if(!n&&o.top+a+s.height>u.height?(f=-1*s.height,y="bottom",o.top+f<0&&(f=-1*o.top)):f=a,s.width>u.width?g=o.left*-1:o.left+s.width>u.width?g=(o.left+s.width-u.width)*-1:g=0,r.style.top=f+"px",r.style.insetInlineStart=g+"px",r.style.transformOrigin=y,t){let A=(i=xM(/-anchor-gutter$/))==null?void 0:i.value;r.style.marginTop=y==="bottom"?`calc(${A??"2px"} * -1)`:A??""}}}function lL(r){if(r){let e=r.parentNode;return e&&e instanceof ShadowRoot&&e.host&&(e=e.host),e}return null}function jze(r){return!!(r!==null&&typeof r<"u"&&r.nodeName&&lL(r))}function Ep(r){return typeof Element<"u"?r instanceof Element:r!==null&&typeof r=="object"&&r.nodeType===1&&typeof r.nodeName=="string"}function Gw(){if(window.getSelection){let r=window.getSelection()||{};r.empty?r.empty():r.removeAllRanges&&r.rangeCount>0&&r.getRangeAt(0).getClientRects().length>0&&r.removeAllRanges()}}function vT(r,e={}){if(Ep(r)){let t=(n,i)=>{var s,a;let o=(s=r?.$attrs)!=null&&s[n]?[(a=r?.$attrs)==null?void 0:a[n]]:[];return[i].flat().reduce((u,f)=>{if(f!=null){let g=typeof f;if(g==="string"||g==="number")u.push(f);else if(g==="object"){let y=Array.isArray(f)?t(n,f):Object.entries(f).map(([A,C])=>n==="style"&&(C||C===0)?`${A.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}:${C}`:C?A:void 0);u=y.length?u.concat(y.filter(A=>!!A)):u}}return u},o)};Object.entries(e).forEach(([n,i])=>{if(i!=null){let s=n.match(/^on(.+)/);s?r.addEventListener(s[1].toLowerCase(),i):n==="p-bind"||n==="pBind"?vT(r,i):(i=n==="class"?[...new Set(t("class",i))].join(" ").trim():n==="style"?t("style",i).join(";").trim():i,(r.$attrs=r.$attrs||{})&&(r.$attrs[n]=i),r.setAttribute(n,i))}})}}function iZ(r,e={},...t){{let n=document.createElement(r);return vT(n,e),n.append(...t),n}}function cm(r,e){return Ep(r)?Array.from(r.querySelectorAll(e)):[]}function cd(r,e){return Ep(r)?r.matches(e)?r:r.querySelector(e):null}function oa(r,e){r&&document.activeElement!==r&&r.focus(e)}function zs(r,e){if(Ep(r)){let t=r.getAttribute(e);return isNaN(t)?t==="true"||t==="false"?t==="true":t:+t}}function cL(r,e=""){let t=cm(r,`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            [href]:not([tabindex = "-1"]):not([style*="display:none"]):not([hidden])${e},
            input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e}`),n=[];for(let i of t)getComputedStyle(i).display!="none"&&getComputedStyle(i).visibility!="hidden"&&n.push(i);return n}function kf(r,e){let t=cL(r,e);return t.length>0?t[0]:null}function Of(r){if(r){let e=r.offsetHeight,t=getComputedStyle(r);return e-=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)+parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth),e}return 0}function Gze(r){if(r){let[e,t]=[r.style.visibility,r.style.display];r.style.visibility="hidden",r.style.display="block";let n=r.offsetHeight;return r.style.display=t,r.style.visibility=e,n}return 0}function Hze(r){if(r){let[e,t]=[r.style.visibility,r.style.display];r.style.visibility="hidden",r.style.display="block";let n=r.offsetWidth;return r.style.display=t,r.style.visibility=e,n}return 0}function Hw(r){var e;if(r){let t=(e=lL(r))==null?void 0:e.childNodes,n=0;if(t)for(let i=0;i<t.length;i++){if(t[i]===r)return n;t[i].nodeType===1&&n++}}return-1}function sZ(r,e){let t=cL(r,e);return t.length>0?t[t.length-1]:null}function g2(r,e){let t=r.nextElementSibling;for(;t;){if(t.matches(e))return t;t=t.nextElementSibling}return null}function um(r){if(r){let e=r.getBoundingClientRect();return{top:e.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:e.left+(window.pageXOffset||wM(document.documentElement)||wM(document.body)||0)}}return{top:"auto",left:"auto"}}function AT(r,e){return r?r.offsetHeight:0}function oZ(r,e=[]){let t=lL(r);return t===null?e:oZ(t,e.concat([t]))}function m2(r,e){let t=r.previousElementSibling;for(;t;){if(t.matches(e))return t;t=t.previousElementSibling}return null}function Wze(r){let e=[];if(r){let t=oZ(r),n=/(auto|scroll)/,i=s=>{try{let a=window.getComputedStyle(s,null);return n.test(a.getPropertyValue("overflow"))||n.test(a.getPropertyValue("overflowX"))||n.test(a.getPropertyValue("overflowY"))}catch{return!1}};for(let s of t){let a=s.nodeType===1&&s.dataset.scrollselectors;if(a){let o=a.split(",");for(let u of o){let f=cd(s,u);f&&i(f)&&e.push(f)}}s.nodeType!==9&&i(s)&&e.push(s)}}return e}function yV(){if(window.getSelection)return window.getSelection().toString();if(document.getSelection)return document.getSelection().toString()}function Df(r){if(r){let e=r.offsetWidth,t=getComputedStyle(r);return e-=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight)+parseFloat(t.borderLeftWidth)+parseFloat(t.borderRightWidth),e}return 0}function bV(r,e,t){let n=r[e];typeof n=="function"&&n.apply(r,[])}function Kze(){return/(android)/i.test(navigator.userAgent)}function a3(r){if(r){let e=r.nodeName,t=r.parentElement&&r.parentElement.nodeName;return e==="INPUT"||e==="TEXTAREA"||e==="BUTTON"||e==="A"||t==="INPUT"||t==="TEXTAREA"||t==="BUTTON"||t==="A"||!!r.closest(".p-button, .p-checkbox, .p-radiobutton")}return!1}function aZ(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function _V(r,e=""){return Ep(r)?r.matches(`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e}`):!1}function xT(r){return!!(r&&r.offsetParent!=null)}function lZ(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}function uL(r,e="",t){Ep(r)&&t!==null&&t!==void 0&&r.setAttribute(e,t)}function hL(){let r=new Map;return{on(e,t){let n=r.get(e);return n?n.push(t):n=[t],r.set(e,n),this},off(e,t){let n=r.get(e);return n&&n.splice(n.indexOf(t)>>>0,1),this},emit(e,t){let n=r.get(e);n&&n.forEach(i=>{i(t)})},clear(){r.clear()}}}var Xze=Object.defineProperty,vV=Object.getOwnPropertySymbols,Jze=Object.prototype.hasOwnProperty,qze=Object.prototype.propertyIsEnumerable,AV=(r,e,t)=>e in r?Xze(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Yze=(r,e)=>{for(var t in e||(e={}))Jze.call(e,t)&&AV(r,t,e[t]);if(vV)for(var t of vV(e))qze.call(e,t)&&AV(r,t,e[t]);return r};function pa(r){return r==null||r===""||Array.isArray(r)&&r.length===0||!(r instanceof Date)&&typeof r=="object"&&Object.keys(r).length===0}function Zze(r,e,t,n=1){let i=-1,s=pa(r),a=pa(e);return s&&a?i=0:s?i=n:a?i=-n:typeof r=="string"&&typeof e=="string"?i=t(r,e):i=r<e?-1:r>e?1:0,i}function CM(r,e,t=new WeakSet){if(r===e)return!0;if(!r||!e||typeof r!="object"||typeof e!="object"||t.has(r)||t.has(e))return!1;t.add(r).add(e);let n=Array.isArray(r),i=Array.isArray(e),s,a,o;if(n&&i){if(a=r.length,a!=e.length)return!1;for(s=a;s--!==0;)if(!CM(r[s],e[s],t))return!1;return!0}if(n!=i)return!1;let u=r instanceof Date,f=e instanceof Date;if(u!=f)return!1;if(u&&f)return r.getTime()==e.getTime();let g=r instanceof RegExp,y=e instanceof RegExp;if(g!=y)return!1;if(g&&y)return r.toString()==e.toString();let A=Object.keys(r);if(a=A.length,a!==Object.keys(e).length)return!1;for(s=a;s--!==0;)if(!Object.prototype.hasOwnProperty.call(e,A[s]))return!1;for(s=a;s--!==0;)if(o=A[s],!CM(r[o],e[o],t))return!1;return!0}function Qze(r,e){return CM(r,e)}function y2(r){return typeof r=="function"&&"call"in r&&"apply"in r}function Xr(r){return!pa(r)}function hn(r,e){if(!r||!e)return null;try{let t=r[e];if(Xr(t))return t}catch{}if(Object.keys(r).length){if(y2(e))return e(r);if(e.indexOf(".")===-1)return r[e];{let t=e.split("."),n=r;for(let i=0,s=t.length;i<s;++i){if(n==null)return null;n=n[t[i]]}return n}}return null}function Ip(r,e,t){return t?hn(r,t)===hn(e,t):Qze(r,e)}function eVe(r,e){if(r!=null&&e&&e.length){for(let t of e)if(Ip(r,t))return!0}return!1}function Gc(r,e=!0){return r instanceof Object&&r.constructor===Object&&(e||Object.keys(r).length!==0)}function cZ(r={},e={}){let t=Yze({},r);return Object.keys(e).forEach(n=>{let i=n;Gc(e[i])&&i in r&&Gc(r[i])?t[i]=cZ(r[i],e[i]):t[i]=e[i]}),t}function tVe(...r){return r.reduce((e,t,n)=>n===0?t:cZ(e,t),{})}function l3(r,e){let t=-1;if(e){for(let n=0;n<e.length;n++)if(e[n]===r){t=n;break}}return t}function xV(r,e){let t=-1;if(Xr(r))try{t=r.findLastIndex(e)}catch{t=r.lastIndexOf([...r].reverse().find(e))}return t}function Ga(r,...e){return y2(r)?r(...e):r}function fa(r,e=!0){return typeof r=="string"&&(e||r!=="")}function zc(r){return fa(r)?r.replace(/(-|_)/g,"").toLowerCase():r}function dL(r,e="",t={}){let n=zc(e).split("."),i=n.shift();if(i){if(Gc(r)){let s=Object.keys(r).find(a=>zc(a)===i)||"";return dL(Ga(r[s],t),n.join("."),t)}return}return Ga(r,t)}function uZ(r,e=!0){return Array.isArray(r)&&(e||r.length!==0)}function rVe(r){return Xr(r)&&!isNaN(r)}function nVe(r=""){return Xr(r)&&r.length===1&&!!r.match(/\S| /)}function wV(){return new Intl.Collator(void 0,{numeric:!0}).compare}function ep(r,e){if(e){let t=e.test(r);return e.lastIndex=0,t}return!1}function iVe(...r){return tVe(...r)}function d_(r){return r&&r.replace(/\/\*(?:(?!\*\/)[\s\S])*\*\/|[\r\n\t]+/g,"").replace(/ {2,}/g," ").replace(/ ([{:}]) /g,"$1").replace(/([;,]) /g,"$1").replace(/ !/g,"!").replace(/: /g,":").trim()}function sl(r){if(r&&/[\xC0-\xFF\u0100-\u017E]/.test(r)){let e={A:/[\xC0-\xC5\u0100\u0102\u0104]/g,AE:/[\xC6]/g,C:/[\xC7\u0106\u0108\u010A\u010C]/g,D:/[\xD0\u010E\u0110]/g,E:/[\xC8-\xCB\u0112\u0114\u0116\u0118\u011A]/g,G:/[\u011C\u011E\u0120\u0122]/g,H:/[\u0124\u0126]/g,I:/[\xCC-\xCF\u0128\u012A\u012C\u012E\u0130]/g,IJ:/[\u0132]/g,J:/[\u0134]/g,K:/[\u0136]/g,L:/[\u0139\u013B\u013D\u013F\u0141]/g,N:/[\xD1\u0143\u0145\u0147\u014A]/g,O:/[\xD2-\xD6\xD8\u014C\u014E\u0150]/g,OE:/[\u0152]/g,R:/[\u0154\u0156\u0158]/g,S:/[\u015A\u015C\u015E\u0160]/g,T:/[\u0162\u0164\u0166]/g,U:/[\xD9-\xDC\u0168\u016A\u016C\u016E\u0170\u0172]/g,W:/[\u0174]/g,Y:/[\xDD\u0176\u0178]/g,Z:/[\u0179\u017B\u017D]/g,a:/[\xE0-\xE5\u0101\u0103\u0105]/g,ae:/[\xE6]/g,c:/[\xE7\u0107\u0109\u010B\u010D]/g,d:/[\u010F\u0111]/g,e:/[\xE8-\xEB\u0113\u0115\u0117\u0119\u011B]/g,g:/[\u011D\u011F\u0121\u0123]/g,i:/[\xEC-\xEF\u0129\u012B\u012D\u012F\u0131]/g,ij:/[\u0133]/g,j:/[\u0135]/g,k:/[\u0137,\u0138]/g,l:/[\u013A\u013C\u013E\u0140\u0142]/g,n:/[\xF1\u0144\u0146\u0148\u014B]/g,p:/[\xFE]/g,o:/[\xF2-\xF6\xF8\u014D\u014F\u0151]/g,oe:/[\u0153]/g,r:/[\u0155\u0157\u0159]/g,s:/[\u015B\u015D\u015F\u0161]/g,t:/[\u0163\u0165\u0167]/g,u:/[\xF9-\xFC\u0169\u016B\u016D\u016F\u0171\u0173]/g,w:/[\u0175]/g,y:/[\xFD\xFF\u0177]/g,z:/[\u017A\u017C\u017E]/g};for(let t in e)r=r.replace(e[t],t)}return r}function CV(r,e,t){r&&e!==t&&(t>=r.length&&(t%=r.length,e%=r.length),r.splice(t,0,r.splice(e,1)[0]))}function TV(r,e,t=1,n,i=1){let s=Zze(r,e,n,t),a=t;return(pa(r)||pa(e))&&(a=i===1?t:i),a*s}function sVe(r){return fa(r,!1)?r[0].toUpperCase()+r.slice(1):r}function hZ(r){return fa(r)?r.replace(/(_)/g,"-").replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase():r}var Jx={};function oVe(r="pui_id_"){return Object.hasOwn(Jx,r)||(Jx[r]=0),Jx[r]++,`${r}${Jx[r]}`}function aVe(){let r=[],e=(a,o,u=999)=>{let f=i(a,o,u),g=f.value+(f.key===a?0:u)+1;return r.push({key:a,value:g}),g},t=a=>{r=r.filter(o=>o.value!==a)},n=(a,o)=>i(a).value,i=(a,o,u=0)=>[...r].reverse().find(f=>!0)||{key:a,value:u},s=a=>a&&parseInt(a.style.zIndex,10)||0;return{get:s,set:(a,o,u)=>{o&&(o.style.zIndex=String(e(a,!0,u)))},clear:a=>{a&&(t(s(a)),a.style.zIndex="")},getCurrent:a=>n(a)}}var Gm=aVe(),Fs={STARTS_WITH:"startsWith",CONTAINS:"contains",NOT_CONTAINS:"notContains",ENDS_WITH:"endsWith",EQUALS:"equals",NOT_EQUALS:"notEquals",LESS_THAN:"lt",LESS_THAN_OR_EQUAL_TO:"lte",GREATER_THAN:"gt",GREATER_THAN_OR_EQUAL_TO:"gte",DATE_IS:"dateIs",DATE_IS_NOT:"dateIsNot",DATE_BEFORE:"dateBefore",DATE_AFTER:"dateAfter"},wT={AND:"and",OR:"or"};function SV(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=lVe(r))||e){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(f){throw f},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,a=!0,o=!1;return{s:function(){t=t.call(r)},n:function(){var f=t.next();return a=f.done,f},e:function(f){o=!0,s=f},f:function(){try{a||t.return==null||t.return()}finally{if(o)throw s}}}}function lVe(r,e){if(r){if(typeof r=="string")return EV(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?EV(r,e):void 0}}function EV(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}var TM={filter:function(e,t,n,i,s){var a=[];if(!e)return a;var o=SV(e),u;try{for(o.s();!(u=o.n()).done;){var f=u.value;if(typeof f=="string"){if(this.filters[i](f,n,s)){a.push(f);continue}}else{var g=SV(t),y;try{for(g.s();!(y=g.n()).done;){var A=y.value,C=hn(f,A);if(this.filters[i](C,n,s)){a.push(f);break}}}catch(M){g.e(M)}finally{g.f()}}}}catch(M){o.e(M)}finally{o.f()}return a},filters:{startsWith:function(e,t,n){if(t==null||t==="")return!0;if(e==null)return!1;var i=sl(t.toString()).toLocaleLowerCase(n),s=sl(e.toString()).toLocaleLowerCase(n);return s.slice(0,i.length)===i},contains:function(e,t,n){if(t==null||t==="")return!0;if(e==null)return!1;var i=sl(t.toString()).toLocaleLowerCase(n),s=sl(e.toString()).toLocaleLowerCase(n);return s.indexOf(i)!==-1},notContains:function(e,t,n){if(t==null||t==="")return!0;if(e==null)return!1;var i=sl(t.toString()).toLocaleLowerCase(n),s=sl(e.toString()).toLocaleLowerCase(n);return s.indexOf(i)===-1},endsWith:function(e,t,n){if(t==null||t==="")return!0;if(e==null)return!1;var i=sl(t.toString()).toLocaleLowerCase(n),s=sl(e.toString()).toLocaleLowerCase(n);return s.indexOf(i,s.length-i.length)!==-1},equals:function(e,t,n){return t==null||t===""?!0:e==null?!1:e.getTime&&t.getTime?e.getTime()===t.getTime():sl(e.toString()).toLocaleLowerCase(n)==sl(t.toString()).toLocaleLowerCase(n)},notEquals:function(e,t,n){return t==null||t===""?!1:e==null?!0:e.getTime&&t.getTime?e.getTime()!==t.getTime():sl(e.toString()).toLocaleLowerCase(n)!=sl(t.toString()).toLocaleLowerCase(n)},in:function(e,t){if(t==null||t.length===0)return!0;for(var n=0;n<t.length;n++)if(Ip(e,t[n]))return!0;return!1},between:function(e,t){return t==null||t[0]==null||t[1]==null?!0:e==null?!1:e.getTime?t[0].getTime()<=e.getTime()&&e.getTime()<=t[1].getTime():t[0]<=e&&e<=t[1]},lt:function(e,t){return t==null?!0:e==null?!1:e.getTime&&t.getTime?e.getTime()<t.getTime():e<t},lte:function(e,t){return t==null?!0:e==null?!1:e.getTime&&t.getTime?e.getTime()<=t.getTime():e<=t},gt:function(e,t){return t==null?!0:e==null?!1:e.getTime&&t.getTime?e.getTime()>t.getTime():e>t},gte:function(e,t){return t==null?!0:e==null?!1:e.getTime&&t.getTime?e.getTime()>=t.getTime():e>=t},dateIs:function(e,t){return t==null?!0:e==null?!1:e.toDateString()===t.toDateString()},dateIsNot:function(e,t){return t==null?!0:e==null?!1:e.toDateString()!==t.toDateString()},dateBefore:function(e,t){return t==null?!0:e==null?!1:e.getTime()<t.getTime()},dateAfter:function(e,t){return t==null?!0:e==null?!1:e.getTime()>t.getTime()}},register:function(e,t){this.filters[e]=t}};function sv(r){"@babel/helpers - typeof";return sv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sv(r)}function cVe(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function uVe(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,dVe(n.key),n)}}function hVe(r,e,t){return e&&uVe(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function dVe(r){var e=fVe(r,"string");return sv(e)=="symbol"?e:e+""}function fVe(r,e){if(sv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(sv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var dZ=function(){function r(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){};cVe(this,r),this.element=e,this.listener=t}return hVe(r,[{key:"bindScrollListener",value:function(){this.scrollableParents=Wze(this.element);for(var t=0;t<this.scrollableParents.length;t++)this.scrollableParents[t].addEventListener("scroll",this.listener)}},{key:"unbindScrollListener",value:function(){if(this.scrollableParents)for(var t=0;t<this.scrollableParents.length;t++)this.scrollableParents[t].removeEventListener("scroll",this.listener)}},{key:"destroy",value:function(){this.unbindScrollListener(),this.element=null,this.listener=null,this.scrollableParents=null}}])}();function ov(r){"@babel/helpers - typeof";return ov=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ov(r)}function pVe(r){return bVe(r)||yVe(r)||mVe(r)||gVe()}function gVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mVe(r,e){if(r){if(typeof r=="string")return SM(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?SM(r,e):void 0}}function yVe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function bVe(r){if(Array.isArray(r))return SM(r)}function SM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function _Ve(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function vVe(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,fZ(n.key),n)}}function AVe(r,e,t){return e&&vVe(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function IV(r,e,t){return(e=fZ(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function fZ(r){var e=xVe(r,"string");return ov(e)=="symbol"?e:e+""}function xVe(r,e){if(ov(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(ov(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var by=function(){function r(e){var t=e.init,n=e.type;_Ve(this,r),IV(this,"helpers",void 0),IV(this,"type",void 0),this.helpers=new Set(t),this.type=n}return AVe(r,[{key:"add",value:function(t){this.helpers.add(t)}},{key:"update",value:function(){}},{key:"delete",value:function(t){this.helpers.delete(t)}},{key:"clear",value:function(){this.helpers.clear()}},{key:"get",value:function(t,n){var i=this._get(t,n),s=i?this._recursive(pVe(this.helpers),i):null;return Xr(s)?s:null}},{key:"_isMatched",value:function(t,n){var i,s=t?.parent;return(s==null||(i=s.vnode)===null||i===void 0?void 0:i.key)===n||s&&this._isMatched(s,n)||!1}},{key:"_get",value:function(t,n){var i,s;return((i=n||t?.$slots)===null||i===void 0||(s=i.default)===null||s===void 0?void 0:s.call(i))||null}},{key:"_recursive",value:function(){var t=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=[];return i.forEach(function(a){a.children instanceof Array?s=s.concat(t._recursive(n,a.children)):a.type.name===t.type?s.push(a):Xr(a.key)&&(s=s.concat(n.filter(function(o){return t._isMatched(o,a.key)}).map(function(o){return o.vnode})))}),s}}])}();function Id(r,e){if(r){var t=r.props;if(t){var n=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),i=Object.prototype.hasOwnProperty.call(t,n)?n:e;return r.type.extends.props[e].type===Boolean&&t[i]===""?!0:t[i]}}return null}var wVe=Object.defineProperty,CVe=Object.defineProperties,TVe=Object.getOwnPropertyDescriptors,CT=Object.getOwnPropertySymbols,pZ=Object.prototype.hasOwnProperty,gZ=Object.prototype.propertyIsEnumerable,PV=(r,e,t)=>e in r?wVe(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,$l=(r,e)=>{for(var t in e||(e={}))pZ.call(e,t)&&PV(r,t,e[t]);if(CT)for(var t of CT(e))gZ.call(e,t)&&PV(r,t,e[t]);return r},c3=(r,e)=>CVe(r,TVe(e)),Pu=(r,e)=>{var t={};for(var n in r)pZ.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&CT)for(var n of CT(r))e.indexOf(n)<0&&gZ.call(r,n)&&(t[n]=r[n]);return t},SVe=hL(),eo=SVe,av=/{([^}]*)}/g,mZ=/(\d+\s+[\+\-\*\/]\s+\d+)/g,yZ=/var\([^)]+\)/g;function BV(r){return fa(r)?r.replace(/[A-Z]/g,(e,t)=>t===0?e:"."+e.toLowerCase()).toLowerCase():r}function EVe(r){return Gc(r)&&r.hasOwnProperty("$value")&&r.hasOwnProperty("$type")?r.$value:r}function IVe(r){return r.replaceAll(/ /g,"").replace(/[^\w]/g,"-")}function EM(r="",e=""){return IVe(`${fa(r,!1)&&fa(e,!1)?`${r}-`:r}${e}`)}function bZ(r="",e=""){return`--${EM(r,e)}`}function PVe(r=""){let e=(r.match(/{/g)||[]).length,t=(r.match(/}/g)||[]).length;return(e+t)%2!==0}function _Z(r,e="",t="",n=[],i){if(fa(r)){let s=r.trim();if(PVe(s))return;if(ep(s,av)){let a=s.replaceAll(av,o=>{let u=o.replace(/{|}/g,"").split(".").filter(f=>!n.some(g=>ep(f,g)));return`var(${bZ(t,hZ(u.join("-")))}${Xr(i)?`, ${i}`:""})`});return ep(a.replace(yZ,"0"),mZ)?`calc(${a})`:a}return s}else if(rVe(r))return r}function BVe(r,e,t){fa(e,!1)&&r.push(`${e}:${t};`)}function hm(r,e){return r?`${r}{${e}}`:""}function vZ(r,e){if(r.indexOf("dt(")===-1)return r;function t(a,o){let u=[],f=0,g="",y=null,A=0;for(;f<=a.length;){let C=a[f];if((C==='"'||C==="'"||C==="`")&&a[f-1]!=="\\"&&(y=y===C?null:C),!y&&(C==="("&&A++,C===")"&&A--,(C===","||f===a.length)&&A===0)){let M=g.trim();M.startsWith("dt(")?u.push(vZ(M,o)):u.push(n(M)),g="",f++;continue}C!==void 0&&(g+=C),f++}return u}function n(a){let o=a[0];if((o==='"'||o==="'"||o==="`")&&a[a.length-1]===o)return a.slice(1,-1);let u=Number(a);return isNaN(u)?a:u}let i=[],s=[];for(let a=0;a<r.length;a++)if(r[a]==="d"&&r.slice(a,a+3)==="dt(")s.push(a),a+=2;else if(r[a]===")"&&s.length>0){let o=s.pop();s.length===0&&i.push([o,a])}if(!i.length)return r;for(let a=i.length-1;a>=0;a--){let[o,u]=i[a],f=r.slice(o+3,u),g=t(f,e),y=e(...g);r=r.slice(0,o)+y+r.slice(u+1)}return r}var tp=(...r)=>MVe(ei.getTheme(),...r),MVe=(r={},e,t,n)=>{if(e){let{variable:i,options:s}=ei.defaults||{},{prefix:a,transform:o}=r?.options||s||{},u=ep(e,av)?e:`{${e}}`;return n==="value"||pa(n)&&o==="strict"?ei.getTokenValue(e):_Z(u,void 0,a,[i.excludedKeyRegex],t)}return""};function qx(r,...e){if(r instanceof Array){let t=r.reduce((n,i,s)=>{var a;return n+i+((a=Ga(e[s],{dt:tp}))!=null?a:"")},"");return vZ(t,tp)}return Ga(r,{dt:tp})}function RVe(r,e={}){let t=ei.defaults.variable,{prefix:n=t.prefix,selector:i=t.selector,excludedKeyRegex:s=t.excludedKeyRegex}=e,a=[],o=[],u=[{node:r,path:n}];for(;u.length;){let{node:g,path:y}=u.pop();for(let A in g){let C=g[A],M=EVe(C),k=ep(A,s)?EM(y):EM(y,hZ(A));if(Gc(M))u.push({node:M,path:k});else{let D=bZ(k),V=_Z(M,k,n,[s]);BVe(o,D,V);let W=k;n&&W.startsWith(n+"-")&&(W=W.slice(n.length+1)),a.push(W.replace(/-/g,"."))}}}let f=o.join("");return{value:o,tokens:a,declarations:f,css:hm(i,f)}}var Nl={regex:{rules:{class:{pattern:/^\.([a-zA-Z][\w-]*)$/,resolve(r){return{type:"class",selector:r,matched:this.pattern.test(r.trim())}}},attr:{pattern:/^\[(.*)\]$/,resolve(r){return{type:"attr",selector:`:root${r},:host${r}`,matched:this.pattern.test(r.trim())}}},media:{pattern:/^@media (.*)$/,resolve(r){return{type:"media",selector:r,matched:this.pattern.test(r.trim())}}},system:{pattern:/^system$/,resolve(r){return{type:"system",selector:"@media (prefers-color-scheme: dark)",matched:this.pattern.test(r.trim())}}},custom:{resolve(r){return{type:"custom",selector:r,matched:!0}}}},resolve(r){let e=Object.keys(this.rules).filter(t=>t!=="custom").map(t=>this.rules[t]);return[r].flat().map(t=>{var n;return(n=e.map(i=>i.resolve(t)).find(i=>i.matched))!=null?n:this.rules.custom.resolve(t)})}},_toVariables(r,e){return RVe(r,{prefix:e?.prefix})},getCommon({name:r="",theme:e={},params:t,set:n,defaults:i}){var s,a,o,u,f,g,y;let{preset:A,options:C}=e,M,k,D,V,W,z,$;if(Xr(A)&&C.transform!=="strict"){let{primitive:te,semantic:le,extend:_e}=A,se=le||{},{colorScheme:Y}=se,ce=Pu(se,["colorScheme"]),oe=_e||{},{colorScheme:Me}=oe,ze=Pu(oe,["colorScheme"]),Ve=Y||{},{dark:lt}=Ve,gt=Pu(Ve,["dark"]),At=Me||{},{dark:Tt}=At,Ut=Pu(At,["dark"]),xr=Xr(te)?this._toVariables({primitive:te},C):{},Er=Xr(ce)?this._toVariables({semantic:ce},C):{},Jr=Xr(gt)?this._toVariables({light:gt},C):{},Xn=Xr(lt)?this._toVariables({dark:lt},C):{},mi=Xr(ze)?this._toVariables({semantic:ze},C):{},Pn=Xr(Ut)?this._toVariables({light:Ut},C):{},Bn=Xr(Tt)?this._toVariables({dark:Tt},C):{},[Jn,Mn]=[(s=xr.declarations)!=null?s:"",xr.tokens],[_t,kt]=[(a=Er.declarations)!=null?a:"",Er.tokens||[]],[nr,fr]=[(o=Jr.declarations)!=null?o:"",Jr.tokens||[]],[ve,Ee]=[(u=Xn.declarations)!=null?u:"",Xn.tokens||[]],[He,wt]=[(f=mi.declarations)!=null?f:"",mi.tokens||[]],[Qe,mt]=[(g=Pn.declarations)!=null?g:"",Pn.tokens||[]],[$t,Dt]=[(y=Bn.declarations)!=null?y:"",Bn.tokens||[]];M=this.transformCSS(r,Jn,"light","variable",C,n,i),k=Mn;let Nt=this.transformCSS(r,`${_t}${nr}`,"light","variable",C,n,i),It=this.transformCSS(r,`${ve}`,"dark","variable",C,n,i);D=`${Nt}${It}`,V=[...new Set([...kt,...fr,...Ee])];let mr=this.transformCSS(r,`${He}${Qe}color-scheme:light`,"light","variable",C,n,i),Qt=this.transformCSS(r,`${$t}color-scheme:dark`,"dark","variable",C,n,i);W=`${mr}${Qt}`,z=[...new Set([...wt,...mt,...Dt])],$=Ga(A.css,{dt:tp})}return{primitive:{css:M,tokens:k},semantic:{css:D,tokens:V},global:{css:W,tokens:z},style:$}},getPreset({name:r="",preset:e={},options:t,params:n,set:i,defaults:s,selector:a}){var o,u,f;let g,y,A;if(Xr(e)&&t.transform!=="strict"){let C=r.replace("-directive",""),M=e,{colorScheme:k,extend:D,css:V}=M,W=Pu(M,["colorScheme","extend","css"]),z=D||{},{colorScheme:$}=z,te=Pu(z,["colorScheme"]),le=k||{},{dark:_e}=le,se=Pu(le,["dark"]),Y=$||{},{dark:ce}=Y,oe=Pu(Y,["dark"]),Me=Xr(W)?this._toVariables({[C]:$l($l({},W),te)},t):{},ze=Xr(se)?this._toVariables({[C]:$l($l({},se),oe)},t):{},Ve=Xr(_e)?this._toVariables({[C]:$l($l({},_e),ce)},t):{},[lt,gt]=[(o=Me.declarations)!=null?o:"",Me.tokens||[]],[At,Tt]=[(u=ze.declarations)!=null?u:"",ze.tokens||[]],[Ut,xr]=[(f=Ve.declarations)!=null?f:"",Ve.tokens||[]],Er=this.transformCSS(C,`${lt}${At}`,"light","variable",t,i,s,a),Jr=this.transformCSS(C,Ut,"dark","variable",t,i,s,a);g=`${Er}${Jr}`,y=[...new Set([...gt,...Tt,...xr])],A=Ga(V,{dt:tp})}return{css:g,tokens:y,style:A}},getPresetC({name:r="",theme:e={},params:t,set:n,defaults:i}){var s;let{preset:a,options:o}=e,u=(s=a?.components)==null?void 0:s[r];return this.getPreset({name:r,preset:u,options:o,params:t,set:n,defaults:i})},getPresetD({name:r="",theme:e={},params:t,set:n,defaults:i}){var s,a;let o=r.replace("-directive",""),{preset:u,options:f}=e,g=((s=u?.components)==null?void 0:s[o])||((a=u?.directives)==null?void 0:a[o]);return this.getPreset({name:o,preset:g,options:f,params:t,set:n,defaults:i})},applyDarkColorScheme(r){return!(r.darkModeSelector==="none"||r.darkModeSelector===!1)},getColorSchemeOption(r,e){var t;return this.applyDarkColorScheme(r)?this.regex.resolve(r.darkModeSelector===!0?e.options.darkModeSelector:(t=r.darkModeSelector)!=null?t:e.options.darkModeSelector):[]},getLayerOrder(r,e={},t,n){let{cssLayer:i}=e;return i?`@layer ${Ga(i.order||i.name||"primeui",t)}`:""},getCommonStyleSheet({name:r="",theme:e={},params:t,props:n={},set:i,defaults:s}){let a=this.getCommon({name:r,theme:e,params:t,set:i,defaults:s}),o=Object.entries(n).reduce((u,[f,g])=>u.push(`${f}="${g}"`)&&u,[]).join(" ");return Object.entries(a||{}).reduce((u,[f,g])=>{if(Gc(g)&&Object.hasOwn(g,"css")){let y=d_(g.css),A=`${f}-variables`;u.push(`<style type="text/css" data-primevue-style-id="${A}" ${o}>${y}</style>`)}return u},[]).join("")},getStyleSheet({name:r="",theme:e={},params:t,props:n={},set:i,defaults:s}){var a;let o={name:r,theme:e,params:t,set:i,defaults:s},u=(a=r.includes("-directive")?this.getPresetD(o):this.getPresetC(o))==null?void 0:a.css,f=Object.entries(n).reduce((g,[y,A])=>g.push(`${y}="${A}"`)&&g,[]).join(" ");return u?`<style type="text/css" data-primevue-style-id="${r}-variables" ${f}>${d_(u)}</style>`:""},createTokens(r={},e,t="",n="",i={}){let s=function(o,u={},f=[]){if(f.includes(this.path))return console.warn(`Circular reference detected at ${this.path}`),{colorScheme:o,path:this.path,paths:u,value:void 0};f.push(this.path),u.name=this.path,u.binding||(u.binding={});let g=this.value;if(typeof this.value=="string"&&av.test(this.value)){let y=this.value.trim().replace(av,A=>{var C;let M=A.slice(1,-1),k=this.tokens[M];if(!k)return console.warn(`Token not found for path: ${M}`),"__UNRESOLVED__";let D=k.computed(o,u,f);return Array.isArray(D)&&D.length===2?`light-dark(${D[0].value},${D[1].value})`:(C=D?.value)!=null?C:"__UNRESOLVED__"});g=mZ.test(y.replace(yZ,"0"))?`calc(${y})`:y}return pa(u.binding)&&delete u.binding,f.pop(),{colorScheme:o,path:this.path,paths:u,value:g.includes("__UNRESOLVED__")?void 0:g}},a=(o,u,f)=>{Object.entries(o).forEach(([g,y])=>{let A=ep(g,e.variable.excludedKeyRegex)?u:u?`${u}.${BV(g)}`:BV(g),C=f?`${f}.${g}`:g;Gc(y)?a(y,A,C):(i[A]||(i[A]={paths:[],computed:(M,k={},D=[])=>{if(i[A].paths.length===1)return i[A].paths[0].computed(i[A].paths[0].scheme,k.binding,D);if(M&&M!=="none")for(let V=0;V<i[A].paths.length;V++){let W=i[A].paths[V];if(W.scheme===M)return W.computed(M,k.binding,D)}return i[A].paths.map(V=>V.computed(V.scheme,k[V.scheme],D))}}),i[A].paths.push({path:C,value:y,scheme:C.includes("colorScheme.light")?"light":C.includes("colorScheme.dark")?"dark":"none",computed:s,tokens:i}))})};return a(r,t,n),i},getTokenValue(r,e,t){var n;let i=(o=>o.split(".").filter(u=>!ep(u.toLowerCase(),t.variable.excludedKeyRegex)).join("."))(e),s=e.includes("colorScheme.light")?"light":e.includes("colorScheme.dark")?"dark":void 0,a=[(n=r[i])==null?void 0:n.computed(s)].flat().filter(o=>o);return a.length===1?a[0].value:a.reduce((o={},u)=>{let f=u,{colorScheme:g}=f,y=Pu(f,["colorScheme"]);return o[g]=y,o},void 0)},getSelectorRule(r,e,t,n){return t==="class"||t==="attr"?hm(Xr(e)?`${r}${e},${r} ${e}`:r,n):hm(r,hm(e??":root,:host",n))},transformCSS(r,e,t,n,i={},s,a,o){if(Xr(e)){let{cssLayer:u}=i;if(n!=="style"){let f=this.getColorSchemeOption(i,a);e=t==="dark"?f.reduce((g,{type:y,selector:A})=>(Xr(A)&&(g+=A.includes("[CSS]")?A.replace("[CSS]",e):this.getSelectorRule(A,o,y,e)),g),""):hm(o??":root,:host",e)}if(u){let f={name:"primeui"};Gc(u)&&(f.name=Ga(u.name,{name:r,type:n})),Xr(f.name)&&(e=hm(`@layer ${f.name}`,e),s?.layerNames(f.name))}return e}return""}},ei={defaults:{variable:{prefix:"p",selector:":root,:host",excludedKeyRegex:/^(primitive|semantic|components|directives|variables|colorscheme|light|dark|common|root|states|extend|css)$/gi},options:{prefix:"p",darkModeSelector:"system",cssLayer:!1}},_theme:void 0,_layerNames:new Set,_loadedStyleNames:new Set,_loadingStyles:new Set,_tokens:{},update(r={}){let{theme:e}=r;e&&(this._theme=c3($l({},e),{options:$l($l({},this.defaults.options),e.options)}),this._tokens=Nl.createTokens(this.preset,this.defaults),this.clearLoadedStyleNames())},get theme(){return this._theme},get preset(){var r;return((r=this.theme)==null?void 0:r.preset)||{}},get options(){var r;return((r=this.theme)==null?void 0:r.options)||{}},get tokens(){return this._tokens},getTheme(){return this.theme},setTheme(r){this.update({theme:r}),eo.emit("theme:change",r)},getPreset(){return this.preset},setPreset(r){this._theme=c3($l({},this.theme),{preset:r}),this._tokens=Nl.createTokens(r,this.defaults),this.clearLoadedStyleNames(),eo.emit("preset:change",r),eo.emit("theme:change",this.theme)},getOptions(){return this.options},setOptions(r){this._theme=c3($l({},this.theme),{options:r}),this.clearLoadedStyleNames(),eo.emit("options:change",r),eo.emit("theme:change",this.theme)},getLayerNames(){return[...this._layerNames]},setLayerNames(r){this._layerNames.add(r)},getLoadedStyleNames(){return this._loadedStyleNames},isStyleNameLoaded(r){return this._loadedStyleNames.has(r)},setLoadedStyleName(r){this._loadedStyleNames.add(r)},deleteLoadedStyleName(r){this._loadedStyleNames.delete(r)},clearLoadedStyleNames(){this._loadedStyleNames.clear()},getTokenValue(r){return Nl.getTokenValue(this.tokens,r,this.defaults)},getCommon(r="",e){return Nl.getCommon({name:r,theme:this.theme,params:e,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}})},getComponent(r="",e){let t={name:r,theme:this.theme,params:e,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}};return Nl.getPresetC(t)},getDirective(r="",e){let t={name:r,theme:this.theme,params:e,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}};return Nl.getPresetD(t)},getCustomPreset(r="",e,t,n){let i={name:r,preset:e,options:this.options,selector:t,params:n,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}};return Nl.getPreset(i)},getLayerOrderCSS(r=""){return Nl.getLayerOrder(r,this.options,{names:this.getLayerNames()},this.defaults)},transformCSS(r="",e,t="style",n){return Nl.transformCSS(r,e,n,t,this.options,{layerNames:this.setLayerNames.bind(this)},this.defaults)},getCommonStyleSheet(r="",e,t={}){return Nl.getCommonStyleSheet({name:r,theme:this.theme,params:e,props:t,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}})},getStyleSheet(r,e,t={}){return Nl.getStyleSheet({name:r,theme:this.theme,params:e,props:t,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}})},onStyleMounted(r){this._loadingStyles.add(r)},onStyleUpdated(r){this._loadingStyles.add(r)},onStyleLoaded(r,{name:e}){this._loadingStyles.size&&(this._loadingStyles.delete(e),eo.emit(`theme:${e}:load`,r),!this._loadingStyles.size&&eo.emit("theme:load"))}},nd={_loadedStyleNames:new Set,getLoadedStyleNames:function(){return this._loadedStyleNames},isStyleNameLoaded:function(e){return this._loadedStyleNames.has(e)},setLoadedStyleName:function(e){this._loadedStyleNames.add(e)},deleteLoadedStyleName:function(e){this._loadedStyleNames.delete(e)},clearLoadedStyleNames:function(){this._loadedStyleNames.clear()}},kVe=`
    *,
    ::before,
    ::after {
        box-sizing: border-box;
    }

    .p-collapsible-enter-active {
        animation: p-animate-collapsible-expand 0.2s ease-out;
        overflow: hidden;
    }

    .p-collapsible-leave-active {
        animation: p-animate-collapsible-collapse 0.2s ease-out;
        overflow: hidden;
    }

    @keyframes p-animate-collapsible-expand {
        from {
            grid-template-rows: 0fr;
        }
        to {
            grid-template-rows: 1fr;
        }
    }

    @keyframes p-animate-collapsible-collapse {
        from {
            grid-template-rows: 1fr;
        }
        to {
            grid-template-rows: 0fr;
        }
    }

    .p-disabled,
    .p-disabled * {
        cursor: default;
        pointer-events: none;
        user-select: none;
    }

    .p-disabled,
    .p-component:disabled {
        opacity: dt('disabled.opacity');
    }

    .pi {
        font-size: dt('icon.size');
    }

    .p-icon {
        width: dt('icon.size');
        height: dt('icon.size');
    }

    .p-overlay-mask {
        background: var(--px-mask-background, dt('mask.background'));
        color: dt('mask.color');
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
    }

    .p-overlay-mask-enter-active {
        animation: p-animate-overlay-mask-enter dt('mask.transition.duration') forwards;
    }

    .p-overlay-mask-leave-active {
        animation: p-animate-overlay-mask-leave dt('mask.transition.duration') forwards;
    }

    @keyframes p-animate-overlay-mask-enter {
        from {
            background: transparent;
        }
        to {
            background: var(--px-mask-background, dt('mask.background'));
        }
    }
    @keyframes p-animate-overlay-mask-leave {
        from {
            background: var(--px-mask-background, dt('mask.background'));
        }
        to {
            background: transparent;
        }
    }

    .p-anchored-overlay-enter-active {
        animation: p-animate-anchored-overlay-enter 300ms cubic-bezier(.19,1,.22,1);
    }

    .p-anchored-overlay-leave-active {
        animation: p-animate-anchored-overlay-leave 300ms cubic-bezier(.19,1,.22,1);
    }

    @keyframes p-animate-anchored-overlay-enter {
        from {
            opacity: 0;
            transform: scale(0.93);
        }
    }

    @keyframes p-animate-anchored-overlay-leave {
        to {
            opacity: 0;
            transform: scale(0.93);
        }
    }
`;function lv(r){"@babel/helpers - typeof";return lv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lv(r)}function MV(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function RV(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?MV(Object(t),!0).forEach(function(n){OVe(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):MV(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function OVe(r,e,t){return(e=DVe(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function DVe(r){var e=LVe(r,"string");return lv(e)=="symbol"?e:e+""}function LVe(r,e){if(lv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(lv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function NVe(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;I.getCurrentInstance()&&I.getCurrentInstance().components?I.onMounted(r):e?r():I.nextTick(r)}var FVe=0;function UVe(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=I.ref(!1),n=I.ref(r),i=I.ref(null),s=aZ()?window.document:void 0,a=e.document,o=a===void 0?s:a,u=e.immediate,f=u===void 0?!0:u,g=e.manual,y=g===void 0?!1:g,A=e.name,C=A===void 0?"style_".concat(++FVe):A,M=e.id,k=M===void 0?void 0:M,D=e.media,V=D===void 0?void 0:D,W=e.nonce,z=W===void 0?void 0:W,$=e.first,te=$===void 0?!1:$,le=e.onMounted,_e=le===void 0?void 0:le,se=e.onUpdated,Y=se===void 0?void 0:se,ce=e.onLoad,oe=ce===void 0?void 0:ce,Me=e.props,ze=Me===void 0?{}:Me,Ve=function(){},lt=function(Tt){var Ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(o){var xr=RV(RV({},ze),Ut),Er=xr.name||C,Jr=xr.id||k,Xn=xr.nonce||z;i.value=o.querySelector('style[data-primevue-style-id="'.concat(Er,'"]'))||o.getElementById(Jr)||o.createElement("style"),i.value.isConnected||(n.value=Tt||r,vT(i.value,{type:"text/css",id:Jr,media:V,nonce:Xn}),te?o.head.prepend(i.value):o.head.appendChild(i.value),uL(i.value,"data-primevue-style-id",Er),vT(i.value,xr),i.value.onload=function(mi){return oe?.(mi,{name:Er})},_e?.(Er)),!t.value&&(Ve=I.watch(n,function(mi){i.value.textContent=mi,Y?.(Er)},{immediate:!0}),t.value=!0)}},gt=function(){!o||!t.value||(Ve(),jze(i.value)&&o.head.removeChild(i.value),t.value=!1,i.value=null)};return f&&!y&&NVe(lt),{id:k,name:C,el:i,css:n,unload:gt,load:lt,isLoaded:I.readonly(t)}}function cv(r){"@babel/helpers - typeof";return cv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cv(r)}var kV,OV,DV,LV;function NV(r,e){return jVe(r)||$Ve(r,e)||VVe(r,e)||zVe()}function zVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VVe(r,e){if(r){if(typeof r=="string")return FV(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?FV(r,e):void 0}}function FV(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function $Ve(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n,i,s,a,o=[],u=!0,f=!1;try{if(s=(t=t.call(r)).next,e!==0)for(;!(u=(n=s.call(t)).done)&&(o.push(n.value),o.length!==e);u=!0);}catch(g){f=!0,i=g}finally{try{if(!u&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(f)throw i}}return o}}function jVe(r){if(Array.isArray(r))return r}function UV(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function u3(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?UV(Object(t),!0).forEach(function(n){GVe(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):UV(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function GVe(r,e,t){return(e=HVe(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function HVe(r){var e=WVe(r,"string");return cv(e)=="symbol"?e:e+""}function WVe(r,e){if(cv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(cv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function Yx(r,e){return e||(e=r.slice(0)),Object.freeze(Object.defineProperties(r,{raw:{value:Object.freeze(e)}}))}var KVe=function(e){var t=e.dt;return`
.p-hidden-accessible {
    border: 0;
    clip: rect(0 0 0 0);
    height: 1px;
    margin: -1px;
    opacity: 0;
    overflow: hidden;
    padding: 0;
    pointer-events: none;
    position: absolute;
    white-space: nowrap;
    width: 1px;
}

.p-overflow-hidden {
    overflow: hidden;
    padding-right: `.concat(t("scrollbar.width"),`;
}
`)},XVe={},JVe={},cn={name:"base",css:KVe,style:kVe,classes:XVe,inlineStyles:JVe,load:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(s){return s},i=n(qx(kV||(kV=Yx(["",""])),e));return Xr(i)?UVe(d_(i),u3({name:this.name},t)):{}},loadCSS:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.load(this.css,e)},loadStyle:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return this.load(this.style,t,function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return ei.transformCSS(t.name||e.name,"".concat(i).concat(qx(OV||(OV=Yx(["",""])),n)))})},getCommonTheme:function(e){return ei.getCommon(this.name,e)},getComponentTheme:function(e){return ei.getComponent(this.name,e)},getDirectiveTheme:function(e){return ei.getDirective(this.name,e)},getPresetTheme:function(e,t,n){return ei.getCustomPreset(this.name,e,t,n)},getLayerOrderThemeCSS:function(){return ei.getLayerOrderCSS(this.name)},getStyleSheet:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.css){var n=Ga(this.css,{dt:tp})||"",i=d_(qx(DV||(DV=Yx(["","",""])),n,e)),s=Object.entries(t).reduce(function(a,o){var u=NV(o,2),f=u[0],g=u[1];return a.push("".concat(f,'="').concat(g,'"'))&&a},[]).join(" ");return Xr(i)?'<style type="text/css" data-primevue-style-id="'.concat(this.name,'" ').concat(s,">").concat(i,"</style>"):""}return""},getCommonThemeStyleSheet:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ei.getCommonStyleSheet(this.name,e,t)},getThemeStyleSheet:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=[ei.getStyleSheet(this.name,e,t)];if(this.style){var i=this.name==="base"?"global-style":"".concat(this.name,"-style"),s=qx(LV||(LV=Yx(["",""])),Ga(this.style,{dt:tp})),a=d_(ei.transformCSS(i,s)),o=Object.entries(t).reduce(function(u,f){var g=NV(f,2),y=g[0],A=g[1];return u.push("".concat(y,'="').concat(A,'"'))&&u},[]).join(" ");Xr(a)&&n.push('<style type="text/css" data-primevue-style-id="'.concat(i,'" ').concat(o,">").concat(a,"</style>"))}return n.join("")},extend:function(e){return u3(u3({},this),{},{css:void 0,style:void 0},e)}};function qVe(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"pc",e=I.useId();return"".concat(r).concat(e.replace("v-","").replaceAll("-","_"))}var zV=cn.extend({name:"common"});function uv(r){"@babel/helpers - typeof";return uv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uv(r)}function YVe(r){return wZ(r)||ZVe(r)||xZ(r)||AZ()}function ZVe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function p0(r,e){return wZ(r)||QVe(r,e)||xZ(r,e)||AZ()}function AZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xZ(r,e){if(r){if(typeof r=="string")return IM(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?IM(r,e):void 0}}function IM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function QVe(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n,i,s,a,o=[],u=!0,f=!1;try{if(s=(t=t.call(r)).next,e===0){if(Object(t)!==t)return;u=!1}else for(;!(u=(n=s.call(t)).done)&&(o.push(n.value),o.length!==e);u=!0);}catch(g){f=!0,i=g}finally{try{if(!u&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(f)throw i}}return o}}function wZ(r){if(Array.isArray(r))return r}function VV(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function un(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?VV(Object(t),!0).forEach(function(n){N0(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):VV(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function N0(r,e,t){return(e=e$e(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function e$e(r){var e=t$e(r,"string");return uv(e)=="symbol"?e:e+""}function t$e(r,e){if(uv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(uv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var In={name:"BaseComponent",props:{pt:{type:Object,default:void 0},ptOptions:{type:Object,default:void 0},unstyled:{type:Boolean,default:void 0},dt:{type:Object,default:void 0}},inject:{$parentInstance:{default:void 0}},watch:{isUnstyled:{immediate:!0,handler:function(e){eo.off("theme:change",this._loadCoreStyles),e||(this._loadCoreStyles(),this._themeChangeListener(this._loadCoreStyles))}},dt:{immediate:!0,handler:function(e,t){var n=this;eo.off("theme:change",this._themeScopedListener),e?(this._loadScopedThemeStyles(e),this._themeScopedListener=function(){return n._loadScopedThemeStyles(e)},this._themeChangeListener(this._themeScopedListener)):this._unloadScopedThemeStyles()}}},scopedStyleEl:void 0,rootEl:void 0,uid:void 0,$attrSelector:void 0,beforeCreate:function(){var e,t,n,i,s,a,o,u,f,g,y,A=(e=this.pt)===null||e===void 0?void 0:e._usept,C=A?(t=this.pt)===null||t===void 0||(t=t.originalValue)===null||t===void 0?void 0:t[this.$.type.name]:void 0,M=A?(n=this.pt)===null||n===void 0||(n=n.value)===null||n===void 0?void 0:n[this.$.type.name]:this.pt;(i=M||C)===null||i===void 0||(i=i.hooks)===null||i===void 0||(s=i.onBeforeCreate)===null||s===void 0||s.call(i);var k=(a=this.$primevueConfig)===null||a===void 0||(a=a.pt)===null||a===void 0?void 0:a._usept,D=k?(o=this.$primevue)===null||o===void 0||(o=o.config)===null||o===void 0||(o=o.pt)===null||o===void 0?void 0:o.originalValue:void 0,V=k?(u=this.$primevue)===null||u===void 0||(u=u.config)===null||u===void 0||(u=u.pt)===null||u===void 0?void 0:u.value:(f=this.$primevue)===null||f===void 0||(f=f.config)===null||f===void 0?void 0:f.pt;(g=V||D)===null||g===void 0||(g=g[this.$.type.name])===null||g===void 0||(g=g.hooks)===null||g===void 0||(y=g.onBeforeCreate)===null||y===void 0||y.call(g),this.$attrSelector=qVe(),this.uid=this.$attrs.id||this.$attrSelector.replace("pc","pv_id_")},created:function(){this._hook("onCreated")},beforeMount:function(){var e;this.rootEl=cd(Ep(this.$el)?this.$el:(e=this.$el)===null||e===void 0?void 0:e.parentElement,"[".concat(this.$attrSelector,"]")),this.rootEl&&(this.rootEl.$pc=un({name:this.$.type.name,attrSelector:this.$attrSelector},this.$params)),this._loadStyles(),this._hook("onBeforeMount")},mounted:function(){this._hook("onMounted")},beforeUpdate:function(){this._hook("onBeforeUpdate")},updated:function(){this._hook("onUpdated")},beforeUnmount:function(){this._hook("onBeforeUnmount")},unmounted:function(){this._removeThemeListeners(),this._unloadScopedThemeStyles(),this._hook("onUnmounted")},methods:{_hook:function(e){if(!this.$options.hostName){var t=this._usePT(this._getPT(this.pt,this.$.type.name),this._getOptionValue,"hooks.".concat(e)),n=this._useDefaultPT(this._getOptionValue,"hooks.".concat(e));t?.(),n?.()}},_mergeProps:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return y2(e)?e.apply(void 0,n):I.mergeProps.apply(void 0,n)},_load:function(){nd.isStyleNameLoaded("base")||(cn.loadCSS(this.$styleOptions),this._loadGlobalStyles(),nd.setLoadedStyleName("base")),this._loadThemeStyles()},_loadStyles:function(){this._load(),this._themeChangeListener(this._load)},_loadCoreStyles:function(){var e,t;!nd.isStyleNameLoaded((e=this.$style)===null||e===void 0?void 0:e.name)&&(t=this.$style)!==null&&t!==void 0&&t.name&&(zV.loadCSS(this.$styleOptions),this.$options.style&&this.$style.loadCSS(this.$styleOptions),nd.setLoadedStyleName(this.$style.name))},_loadGlobalStyles:function(){var e=this._useGlobalPT(this._getOptionValue,"global.css",this.$params);Xr(e)&&cn.load(e,un({name:"global"},this.$styleOptions))},_loadThemeStyles:function(){var e,t;if(!(this.isUnstyled||this.$theme==="none")){if(!ei.isStyleNameLoaded("common")){var n,i,s=((n=this.$style)===null||n===void 0||(i=n.getCommonTheme)===null||i===void 0?void 0:i.call(n))||{},a=s.primitive,o=s.semantic,u=s.global,f=s.style;cn.load(a?.css,un({name:"primitive-variables"},this.$styleOptions)),cn.load(o?.css,un({name:"semantic-variables"},this.$styleOptions)),cn.load(u?.css,un({name:"global-variables"},this.$styleOptions)),cn.loadStyle(un({name:"global-style"},this.$styleOptions),f),ei.setLoadedStyleName("common")}if(!ei.isStyleNameLoaded((e=this.$style)===null||e===void 0?void 0:e.name)&&(t=this.$style)!==null&&t!==void 0&&t.name){var g,y,A,C,M=((g=this.$style)===null||g===void 0||(y=g.getComponentTheme)===null||y===void 0?void 0:y.call(g))||{},k=M.css,D=M.style;(A=this.$style)===null||A===void 0||A.load(k,un({name:"".concat(this.$style.name,"-variables")},this.$styleOptions)),(C=this.$style)===null||C===void 0||C.loadStyle(un({name:"".concat(this.$style.name,"-style")},this.$styleOptions),D),ei.setLoadedStyleName(this.$style.name)}if(!ei.isStyleNameLoaded("layer-order")){var V,W,z=(V=this.$style)===null||V===void 0||(W=V.getLayerOrderThemeCSS)===null||W===void 0?void 0:W.call(V);cn.load(z,un({name:"layer-order",first:!0},this.$styleOptions)),ei.setLoadedStyleName("layer-order")}}},_loadScopedThemeStyles:function(e){var t,n,i,s=((t=this.$style)===null||t===void 0||(n=t.getPresetTheme)===null||n===void 0?void 0:n.call(t,e,"[".concat(this.$attrSelector,"]")))||{},a=s.css,o=(i=this.$style)===null||i===void 0?void 0:i.load(a,un({name:"".concat(this.$attrSelector,"-").concat(this.$style.name)},this.$styleOptions));this.scopedStyleEl=o.el},_unloadScopedThemeStyles:function(){var e;(e=this.scopedStyleEl)===null||e===void 0||(e=e.value)===null||e===void 0||e.remove()},_themeChangeListener:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};nd.clearLoadedStyleNames(),eo.on("theme:change",e)},_removeThemeListeners:function(){eo.off("theme:change",this._loadCoreStyles),eo.off("theme:change",this._load),eo.off("theme:change",this._themeScopedListener)},_getHostInstance:function(e){return e?this.$options.hostName?e.$.type.name===this.$options.hostName?e:this._getHostInstance(e.$parentInstance):e.$parentInstance:void 0},_getPropValue:function(e){var t;return this[e]||((t=this._getHostInstance(this))===null||t===void 0?void 0:t[e])},_getOptionValue:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return dL(e,t,n)},_getPTValue:function(){var e,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=/./g.test(n)&&!!i[n.split(".")[0]],o=this._getPropValue("ptOptions")||((e=this.$primevueConfig)===null||e===void 0?void 0:e.ptOptions)||{},u=o.mergeSections,f=u===void 0?!0:u,g=o.mergeProps,y=g===void 0?!1:g,A=s?a?this._useGlobalPT(this._getPTClassValue,n,i):this._useDefaultPT(this._getPTClassValue,n,i):void 0,C=a?void 0:this._getPTSelf(t,this._getPTClassValue,n,un(un({},i),{},{global:A||{}})),M=this._getPTDatasets(n);return f||!f&&C?y?this._mergeProps(y,A,C,M):un(un(un({},A),C),M):un(un({},C),M)},_getPTSelf:function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return I.mergeProps(this._usePT.apply(this,[this._getPT(e,this.$name)].concat(n)),this._usePT.apply(this,[this.$_attrsPT].concat(n)))},_getPTDatasets:function(){var e,t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i="data-pc-",s=n==="root"&&Xr((e=this.pt)===null||e===void 0?void 0:e["data-pc-section"]);return n!=="transition"&&un(un({},n==="root"&&un(un(N0({},"".concat(i,"name"),zc(s?(t=this.pt)===null||t===void 0?void 0:t["data-pc-section"]:this.$.type.name)),s&&N0({},"".concat(i,"extend"),zc(this.$.type.name))),{},N0({},"".concat(this.$attrSelector),""))),{},N0({},"".concat(i,"section"),zc(n)))},_getPTClassValue:function(){var e=this._getOptionValue.apply(this,arguments);return fa(e)||uZ(e)?{class:e}:e},_getPT:function(e){var t=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0,s=function(o){var u,f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,g=i?i(o):o,y=zc(n),A=zc(t.$name);return(u=f?y!==A?g?.[y]:void 0:g?.[y])!==null&&u!==void 0?u:g};return e!=null&&e.hasOwnProperty("_usept")?{_usept:e._usept,originalValue:s(e.originalValue),value:s(e.value)}:s(e,!0)},_usePT:function(e,t,n,i){var s=function(k){return t(k,n,i)};if(e!=null&&e.hasOwnProperty("_usept")){var a,o=e._usept||((a=this.$primevueConfig)===null||a===void 0?void 0:a.ptOptions)||{},u=o.mergeSections,f=u===void 0?!0:u,g=o.mergeProps,y=g===void 0?!1:g,A=s(e.originalValue),C=s(e.value);return A===void 0&&C===void 0?void 0:fa(C)?C:fa(A)?A:f||!f&&C?y?this._mergeProps(y,A,C):un(un({},A),C):C}return s(e)},_useGlobalPT:function(e,t,n){return this._usePT(this.globalPT,e,t,n)},_useDefaultPT:function(e,t,n){return this._usePT(this.defaultPT,e,t,n)},ptm:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._getPTValue(this.pt,e,un(un({},this.$params),t))},ptmi:function(){var e,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=I.mergeProps(this.$_attrsWithoutPT,this.ptm(t,n));return i?.hasOwnProperty("id")&&((e=i.id)!==null&&e!==void 0||(i.id=this.$id)),i},ptmo:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this._getPTValue(e,t,un({instance:this},n),!1)},cx:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.isUnstyled?void 0:this._getOptionValue(this.$style.classes,e,un(un({},this.$params),t))},sx:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(t){var i=this._getOptionValue(this.$style.inlineStyles,e,un(un({},this.$params),n)),s=this._getOptionValue(zV.inlineStyles,e,un(un({},this.$params),n));return[s,i]}}},computed:{globalPT:function(){var e,t=this;return this._getPT((e=this.$primevueConfig)===null||e===void 0?void 0:e.pt,void 0,function(n){return Ga(n,{instance:t})})},defaultPT:function(){var e,t=this;return this._getPT((e=this.$primevueConfig)===null||e===void 0?void 0:e.pt,void 0,function(n){return t._getOptionValue(n,t.$name,un({},t.$params))||Ga(n,un({},t.$params))})},isUnstyled:function(){var e;return this.unstyled!==void 0?this.unstyled:(e=this.$primevueConfig)===null||e===void 0?void 0:e.unstyled},$id:function(){return this.$attrs.id||this.uid},$inProps:function(){var e,t=Object.keys(((e=this.$.vnode)===null||e===void 0?void 0:e.props)||{});return Object.fromEntries(Object.entries(this.$props).filter(function(n){var i=p0(n,1),s=i[0];return t?.includes(s)}))},$theme:function(){var e;return(e=this.$primevueConfig)===null||e===void 0?void 0:e.theme},$style:function(){return un(un({classes:void 0,inlineStyles:void 0,load:function(){},loadCSS:function(){},loadStyle:function(){}},(this._getHostInstance(this)||{}).$style),this.$options.style)},$styleOptions:function(){var e;return{nonce:(e=this.$primevueConfig)===null||e===void 0||(e=e.csp)===null||e===void 0?void 0:e.nonce}},$primevueConfig:function(){var e;return(e=this.$primevue)===null||e===void 0?void 0:e.config},$name:function(){return this.$options.hostName||this.$.type.name},$params:function(){var e=this._getHostInstance(this)||this.$parent;return{instance:this,props:this.$props,state:this.$data,attrs:this.$attrs,parent:{instance:e,props:e?.$props,state:e?.$data,attrs:e?.$attrs}}},$_attrsPT:function(){return Object.entries(this.$attrs||{}).filter(function(e){var t=p0(e,1),n=t[0];return n?.startsWith("pt:")}).reduce(function(e,t){var n=p0(t,2),i=n[0],s=n[1],a=i.split(":"),o=YVe(a),u=IM(o).slice(1);return u?.reduce(function(f,g,y,A){return!f[g]&&(f[g]=y===A.length-1?s:{}),f[g]},e),e},{})},$_attrsWithoutPT:function(){return Object.entries(this.$attrs||{}).filter(function(e){var t=p0(e,1),n=t[0];return!(n!=null&&n.startsWith("pt:"))}).reduce(function(e,t){var n=p0(t,2),i=n[0],s=n[1];return e[i]=s,e},{})}}},r$e=`
.p-icon {
    display: inline-block;
    vertical-align: baseline;
    flex-shrink: 0;
}

.p-icon-spin {
    -webkit-animation: p-icon-spin 2s infinite linear;
    animation: p-icon-spin 2s infinite linear;
}

@-webkit-keyframes p-icon-spin {
    0% {
        -webkit-transform: rotate(0deg);
        transform: rotate(0deg);
    }
    100% {
        -webkit-transform: rotate(359deg);
        transform: rotate(359deg);
    }
}

@keyframes p-icon-spin {
    0% {
        -webkit-transform: rotate(0deg);
        transform: rotate(0deg);
    }
    100% {
        -webkit-transform: rotate(359deg);
        transform: rotate(359deg);
    }
}
`,n$e=cn.extend({name:"baseicon",css:r$e});function hv(r){"@babel/helpers - typeof";return hv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hv(r)}function $V(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function jV(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?$V(Object(t),!0).forEach(function(n){i$e(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):$V(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function i$e(r,e,t){return(e=s$e(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function s$e(r){var e=o$e(r,"string");return hv(e)=="symbol"?e:e+""}function o$e(r,e){if(hv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(hv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var gi={name:"BaseIcon",extends:In,props:{label:{type:String,default:void 0},spin:{type:Boolean,default:!1}},style:n$e,provide:function(){return{$pcIcon:this,$parentInstance:this}},methods:{pti:function(){var e=pa(this.label);return jV(jV({},!this.isUnstyled&&{class:["p-icon",{"p-icon-spin":this.spin}]}),{},{role:e?void 0:"img","aria-label":e?void 0:this.label,"aria-hidden":e})}}},CZ={name:"ArrowDownIcon",extends:gi};function a$e(r){return h$e(r)||u$e(r)||c$e(r)||l$e()}function l$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c$e(r,e){if(r){if(typeof r=="string")return PM(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?PM(r,e):void 0}}function u$e(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function h$e(r){if(Array.isArray(r))return PM(r)}function PM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function d$e(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),a$e(e[0]||(e[0]=[I.createElementVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.99994 14C6.91097 14.0004 6.82281 13.983 6.74064 13.9489C6.65843 13.9148 6.58387 13.8646 6.52133 13.8013L1.10198 8.38193C0.982318 8.25351 0.917175 8.08367 0.920272 7.90817C0.923368 7.73267 0.994462 7.56523 1.11858 7.44111C1.24269 7.317 1.41014 7.2459 1.58563 7.2428C1.76113 7.23971 1.93098 7.30485 2.0594 7.42451L6.32263 11.6877V0.677419C6.32263 0.497756 6.394 0.325452 6.52104 0.198411C6.64808 0.0713706 6.82039 0 7.00005 0C7.17971 0 7.35202 0.0713706 7.47906 0.198411C7.6061 0.325452 7.67747 0.497756 7.67747 0.677419V11.6877L11.9407 7.42451C12.0691 7.30485 12.2389 7.23971 12.4144 7.2428C12.5899 7.2459 12.7574 7.317 12.8815 7.44111C13.0056 7.56523 13.0767 7.73267 13.0798 7.90817C13.0829 8.08367 13.0178 8.25351 12.8981 8.38193L7.47875 13.8013C7.41621 13.8646 7.34164 13.9148 7.25944 13.9489C7.17727 13.983 7.08912 14.0004 7.00015 14C7.00012 14 7.00009 14 7.00005 14C7.00001 14 6.99998 14 6.99994 14Z",fill:"currentColor"},null,-1)])),16)}CZ.render=d$e;var TZ={name:"ArrowUpIcon",extends:gi};function f$e(r){return y$e(r)||m$e(r)||g$e(r)||p$e()}function p$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function g$e(r,e){if(r){if(typeof r=="string")return BM(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?BM(r,e):void 0}}function m$e(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function y$e(r){if(Array.isArray(r))return BM(r)}function BM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function b$e(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),f$e(e[0]||(e[0]=[I.createElementVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.51551 13.799C6.64205 13.9255 6.813 13.9977 6.99193 14C7.17087 13.9977 7.34182 13.9255 7.46835 13.799C7.59489 13.6725 7.66701 13.5015 7.66935 13.3226V2.31233L11.9326 6.57554C11.9951 6.63887 12.0697 6.68907 12.1519 6.72319C12.2341 6.75731 12.3223 6.77467 12.4113 6.77425C12.5003 6.77467 12.5885 6.75731 12.6707 6.72319C12.7529 6.68907 12.8274 6.63887 12.89 6.57554C13.0168 6.44853 13.0881 6.27635 13.0881 6.09683C13.0881 5.91732 13.0168 5.74514 12.89 5.61812L7.48846 0.216594C7.48274 0.210436 7.4769 0.204374 7.47094 0.198411C7.3439 0.0713707 7.1716 0 6.99193 0C6.81227 0 6.63997 0.0713707 6.51293 0.198411C6.50704 0.204296 6.50128 0.210278 6.49563 0.216354L1.09386 5.61812C0.974201 5.74654 0.909057 5.91639 0.912154 6.09189C0.91525 6.26738 0.986345 6.43483 1.11046 6.55894C1.23457 6.68306 1.40202 6.75415 1.57752 6.75725C1.75302 6.76035 1.92286 6.6952 2.05128 6.57554L6.31451 2.31231V13.3226C6.31685 13.5015 6.38898 13.6725 6.51551 13.799Z",fill:"currentColor"},null,-1)])),16)}TZ.render=b$e;var aA={name:"SpinnerIcon",extends:gi};function _$e(r){return w$e(r)||x$e(r)||A$e(r)||v$e()}function v$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function A$e(r,e){if(r){if(typeof r=="string")return MM(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?MM(r,e):void 0}}function x$e(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function w$e(r){if(Array.isArray(r))return MM(r)}function MM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function C$e(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),_$e(e[0]||(e[0]=[I.createElementVNode("path",{d:"M6.99701 14C5.85441 13.999 4.72939 13.7186 3.72012 13.1832C2.71084 12.6478 1.84795 11.8737 1.20673 10.9284C0.565504 9.98305 0.165424 8.89526 0.041387 7.75989C-0.0826496 6.62453 0.073125 5.47607 0.495122 4.4147C0.917119 3.35333 1.59252 2.4113 2.46241 1.67077C3.33229 0.930247 4.37024 0.413729 5.4857 0.166275C6.60117 -0.0811796 7.76026 -0.0520535 8.86188 0.251112C9.9635 0.554278 10.9742 1.12227 11.8057 1.90555C11.915 2.01493 11.9764 2.16319 11.9764 2.31778C11.9764 2.47236 11.915 2.62062 11.8057 2.73C11.7521 2.78503 11.688 2.82877 11.6171 2.85864C11.5463 2.8885 11.4702 2.90389 11.3933 2.90389C11.3165 2.90389 11.2404 2.8885 11.1695 2.85864C11.0987 2.82877 11.0346 2.78503 10.9809 2.73C9.9998 1.81273 8.73246 1.26138 7.39226 1.16876C6.05206 1.07615 4.72086 1.44794 3.62279 2.22152C2.52471 2.99511 1.72683 4.12325 1.36345 5.41602C1.00008 6.70879 1.09342 8.08723 1.62775 9.31926C2.16209 10.5513 3.10478 11.5617 4.29713 12.1803C5.48947 12.7989 6.85865 12.988 8.17414 12.7157C9.48963 12.4435 10.6711 11.7264 11.5196 10.6854C12.3681 9.64432 12.8319 8.34282 12.8328 7C12.8328 6.84529 12.8943 6.69692 13.0038 6.58752C13.1132 6.47812 13.2616 6.41667 13.4164 6.41667C13.5712 6.41667 13.7196 6.47812 13.8291 6.58752C13.9385 6.69692 14 6.84529 14 7C14 8.85651 13.2622 10.637 11.9489 11.9497C10.6356 13.2625 8.85432 14 6.99701 14Z",fill:"currentColor"},null,-1)])),16)}aA.render=C$e;var T$e=`
    .p-paginator {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-wrap: wrap;
        background: dt('paginator.background');
        color: dt('paginator.color');
        padding: dt('paginator.padding');
        border-radius: dt('paginator.border.radius');
        gap: dt('paginator.gap');
    }

    .p-paginator-content {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-wrap: wrap;
        gap: dt('paginator.gap');
    }

    .p-paginator-content-start {
        margin-inline-end: auto;
    }

    .p-paginator-content-end {
        margin-inline-start: auto;
    }

    .p-paginator-page,
    .p-paginator-next,
    .p-paginator-last,
    .p-paginator-first,
    .p-paginator-prev {
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        line-height: 1;
        user-select: none;
        overflow: hidden;
        position: relative;
        background: dt('paginator.nav.button.background');
        border: 0 none;
        color: dt('paginator.nav.button.color');
        min-width: dt('paginator.nav.button.width');
        height: dt('paginator.nav.button.height');
        transition:
            background dt('paginator.transition.duration'),
            color dt('paginator.transition.duration'),
            outline-color dt('paginator.transition.duration'),
            box-shadow dt('paginator.transition.duration');
        border-radius: dt('paginator.nav.button.border.radius');
        padding: 0;
        margin: 0;
    }

    .p-paginator-page:focus-visible,
    .p-paginator-next:focus-visible,
    .p-paginator-last:focus-visible,
    .p-paginator-first:focus-visible,
    .p-paginator-prev:focus-visible {
        box-shadow: dt('paginator.nav.button.focus.ring.shadow');
        outline: dt('paginator.nav.button.focus.ring.width') dt('paginator.nav.button.focus.ring.style') dt('paginator.nav.button.focus.ring.color');
        outline-offset: dt('paginator.nav.button.focus.ring.offset');
    }

    .p-paginator-page:not(.p-disabled):not(.p-paginator-page-selected):hover,
    .p-paginator-first:not(.p-disabled):hover,
    .p-paginator-prev:not(.p-disabled):hover,
    .p-paginator-next:not(.p-disabled):hover,
    .p-paginator-last:not(.p-disabled):hover {
        background: dt('paginator.nav.button.hover.background');
        color: dt('paginator.nav.button.hover.color');
    }

    .p-paginator-page.p-paginator-page-selected {
        background: dt('paginator.nav.button.selected.background');
        color: dt('paginator.nav.button.selected.color');
    }

    .p-paginator-current {
        color: dt('paginator.current.page.report.color');
    }

    .p-paginator-pages {
        display: flex;
        align-items: center;
        gap: dt('paginator.gap');
    }

    .p-paginator-jtp-input .p-inputtext {
        max-width: dt('paginator.jump.to.page.input.max.width');
    }

    .p-paginator-first:dir(rtl),
    .p-paginator-prev:dir(rtl),
    .p-paginator-next:dir(rtl),
    .p-paginator-last:dir(rtl) {
        transform: rotate(180deg);
    }
`;function dv(r){"@babel/helpers - typeof";return dv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dv(r)}function S$e(r,e,t){return(e=E$e(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function E$e(r){var e=I$e(r,"string");return dv(e)=="symbol"?e:e+""}function I$e(r,e){if(dv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(dv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var P$e={paginator:function(e){var t=e.instance,n=e.key;return["p-paginator p-component",S$e({"p-paginator-default":!t.hasBreakpoints()},"p-paginator-".concat(n),t.hasBreakpoints())]},content:"p-paginator-content",contentStart:"p-paginator-content-start",contentEnd:"p-paginator-content-end",first:function(e){var t=e.instance;return["p-paginator-first",{"p-disabled":t.$attrs.disabled}]},firstIcon:"p-paginator-first-icon",prev:function(e){var t=e.instance;return["p-paginator-prev",{"p-disabled":t.$attrs.disabled}]},prevIcon:"p-paginator-prev-icon",next:function(e){var t=e.instance;return["p-paginator-next",{"p-disabled":t.$attrs.disabled}]},nextIcon:"p-paginator-next-icon",last:function(e){var t=e.instance;return["p-paginator-last",{"p-disabled":t.$attrs.disabled}]},lastIcon:"p-paginator-last-icon",pages:"p-paginator-pages",page:function(e){var t=e.props,n=e.pageLink;return["p-paginator-page",{"p-paginator-page-selected":n-1===t.page}]},current:"p-paginator-current",pcRowPerPageDropdown:"p-paginator-rpp-dropdown",pcJumpToPageDropdown:"p-paginator-jtp-dropdown",pcJumpToPageInputText:"p-paginator-jtp-input"},B$e=cn.extend({name:"paginator",style:T$e,classes:P$e}),SZ={name:"AngleDoubleLeftIcon",extends:gi};function M$e(r){return D$e(r)||O$e(r)||k$e(r)||R$e()}function R$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k$e(r,e){if(r){if(typeof r=="string")return RM(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?RM(r,e):void 0}}function O$e(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function D$e(r){if(Array.isArray(r))return RM(r)}function RM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function L$e(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),M$e(e[0]||(e[0]=[I.createElementVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.71602 11.164C5.80782 11.2021 5.9063 11.2215 6.00569 11.221C6.20216 11.2301 6.39427 11.1612 6.54025 11.0294C6.68191 10.8875 6.76148 10.6953 6.76148 10.4948C6.76148 10.2943 6.68191 10.1021 6.54025 9.96024L3.51441 6.9344L6.54025 3.90855C6.624 3.76126 6.65587 3.59011 6.63076 3.42254C6.60564 3.25498 6.525 3.10069 6.40175 2.98442C6.2785 2.86815 6.11978 2.79662 5.95104 2.7813C5.78229 2.76598 5.61329 2.80776 5.47112 2.89994L1.97123 6.39983C1.82957 6.54167 1.75 6.73393 1.75 6.9344C1.75 7.13486 1.82957 7.32712 1.97123 7.46896L5.47112 10.9991C5.54096 11.0698 5.62422 11.1259 5.71602 11.164ZM11.0488 10.9689C11.1775 11.1156 11.3585 11.2061 11.5531 11.221C11.7477 11.2061 11.9288 11.1156 12.0574 10.9689C12.1815 10.8302 12.25 10.6506 12.25 10.4645C12.25 10.2785 12.1815 10.0989 12.0574 9.96024L9.03158 6.93439L12.0574 3.90855C12.1248 3.76739 12.1468 3.60881 12.1204 3.45463C12.0939 3.30045 12.0203 3.15826 11.9097 3.04765C11.7991 2.93703 11.6569 2.86343 11.5027 2.83698C11.3486 2.81053 11.19 2.83252 11.0488 2.89994L7.51865 6.36957C7.37699 6.51141 7.29742 6.70367 7.29742 6.90414C7.29742 7.1046 7.37699 7.29686 7.51865 7.4387L11.0488 10.9689Z",fill:"currentColor"},null,-1)])),16)}SZ.render=L$e;var ud=hL();function fv(r){"@babel/helpers - typeof";return fv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fv(r)}function GV(r,e){return z$e(r)||U$e(r,e)||F$e(r,e)||N$e()}function N$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function F$e(r,e){if(r){if(typeof r=="string")return HV(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?HV(r,e):void 0}}function HV(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function U$e(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n,i,s,a,o=[],u=!0,f=!1;try{if(s=(t=t.call(r)).next,e!==0)for(;!(u=(n=s.call(t)).done)&&(o.push(n.value),o.length!==e);u=!0);}catch(g){f=!0,i=g}finally{try{if(!u&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(f)throw i}}return o}}function z$e(r){if(Array.isArray(r))return r}function WV(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function _n(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?WV(Object(t),!0).forEach(function(n){kM(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):WV(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function kM(r,e,t){return(e=V$e(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function V$e(r){var e=$$e(r,"string");return fv(e)=="symbol"?e:e+""}function $$e(r,e){if(fv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(fv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Yr={_getMeta:function(){return[Gc(arguments.length<=0?void 0:arguments[0])||arguments.length<=0?void 0:arguments[0],Ga(Gc(arguments.length<=0?void 0:arguments[0])?arguments.length<=0?void 0:arguments[0]:arguments.length<=1?void 0:arguments[1])]},_getConfig:function(e,t){var n,i,s;return(n=(e==null||(i=e.instance)===null||i===void 0?void 0:i.$primevue)||(t==null||(s=t.ctx)===null||s===void 0||(s=s.appContext)===null||s===void 0||(s=s.config)===null||s===void 0||(s=s.globalProperties)===null||s===void 0?void 0:s.$primevue))===null||n===void 0?void 0:n.config},_getOptionValue:dL,_getPTValue:function(){var e,t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,u=function(){var W=Yr._getOptionValue.apply(Yr,arguments);return fa(W)||uZ(W)?{class:W}:W},f=((e=n.binding)===null||e===void 0||(e=e.value)===null||e===void 0?void 0:e.ptOptions)||((t=n.$primevueConfig)===null||t===void 0?void 0:t.ptOptions)||{},g=f.mergeSections,y=g===void 0?!0:g,A=f.mergeProps,C=A===void 0?!1:A,M=o?Yr._useDefaultPT(n,n.defaultPT(),u,s,a):void 0,k=Yr._usePT(n,Yr._getPT(i,n.$name),u,s,_n(_n({},a),{},{global:M||{}})),D=Yr._getPTDatasets(n,s);return y||!y&&k?C?Yr._mergeProps(n,C,M,k,D):_n(_n(_n({},M),k),D):_n(_n({},k),D)},_getPTDatasets:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n="data-pc-";return _n(_n({},t==="root"&&kM({},"".concat(n,"name"),zc(e.$name))),{},kM({},"".concat(n,"section"),zc(t)))},_getPT:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,i=function(a){var o,u=n?n(a):a,f=zc(t);return(o=u?.[f])!==null&&o!==void 0?o:u};return e&&Object.hasOwn(e,"_usept")?{_usept:e._usept,originalValue:i(e.originalValue),value:i(e.value)}:i(e)},_usePT:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,a=function(D){return n(D,i,s)};if(t&&Object.hasOwn(t,"_usept")){var o,u=t._usept||((o=e.$primevueConfig)===null||o===void 0?void 0:o.ptOptions)||{},f=u.mergeSections,g=f===void 0?!0:f,y=u.mergeProps,A=y===void 0?!1:y,C=a(t.originalValue),M=a(t.value);return C===void 0&&M===void 0?void 0:fa(M)?M:fa(C)?C:g||!g&&M?A?Yr._mergeProps(e,A,C,M):_n(_n({},C),M):M}return a(t)},_useDefaultPT:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;return Yr._usePT(e,t,n,i,s)},_loadStyles:function(){var e,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,s=Yr._getConfig(n,i),a={nonce:s==null||(e=s.csp)===null||e===void 0?void 0:e.nonce};Yr._loadCoreStyles(t,a),Yr._loadThemeStyles(t,a),Yr._loadScopedThemeStyles(t,a),Yr._removeThemeListeners(t),t.$loadStyles=function(){return Yr._loadThemeStyles(t,a)},Yr._themeChangeListener(t.$loadStyles)},_loadCoreStyles:function(){var e,t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;if(!nd.isStyleNameLoaded((e=n.$style)===null||e===void 0?void 0:e.name)&&(t=n.$style)!==null&&t!==void 0&&t.name){var s;cn.loadCSS(i),(s=n.$style)===null||s===void 0||s.loadCSS(i),nd.setLoadedStyleName(n.$style.name)}},_loadThemeStyles:function(){var e,t,n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;if(!(i!=null&&i.isUnstyled()||(i==null||(e=i.theme)===null||e===void 0?void 0:e.call(i))==="none")){if(!ei.isStyleNameLoaded("common")){var a,o,u=((a=i.$style)===null||a===void 0||(o=a.getCommonTheme)===null||o===void 0?void 0:o.call(a))||{},f=u.primitive,g=u.semantic,y=u.global,A=u.style;cn.load(f?.css,_n({name:"primitive-variables"},s)),cn.load(g?.css,_n({name:"semantic-variables"},s)),cn.load(y?.css,_n({name:"global-variables"},s)),cn.loadStyle(_n({name:"global-style"},s),A),ei.setLoadedStyleName("common")}if(!ei.isStyleNameLoaded((t=i.$style)===null||t===void 0?void 0:t.name)&&(n=i.$style)!==null&&n!==void 0&&n.name){var C,M,k,D,V=((C=i.$style)===null||C===void 0||(M=C.getDirectiveTheme)===null||M===void 0?void 0:M.call(C))||{},W=V.css,z=V.style;(k=i.$style)===null||k===void 0||k.load(W,_n({name:"".concat(i.$style.name,"-variables")},s)),(D=i.$style)===null||D===void 0||D.loadStyle(_n({name:"".concat(i.$style.name,"-style")},s),z),ei.setLoadedStyleName(i.$style.name)}if(!ei.isStyleNameLoaded("layer-order")){var $,te,le=($=i.$style)===null||$===void 0||(te=$.getLayerOrderThemeCSS)===null||te===void 0?void 0:te.call($);cn.load(le,_n({name:"layer-order",first:!0},s)),ei.setLoadedStyleName("layer-order")}}},_loadScopedThemeStyles:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=e.preset();if(n&&e.$attrSelector){var i,s,a,o=((i=e.$style)===null||i===void 0||(s=i.getPresetTheme)===null||s===void 0?void 0:s.call(i,n,"[".concat(e.$attrSelector,"]")))||{},u=o.css,f=(a=e.$style)===null||a===void 0?void 0:a.load(u,_n({name:"".concat(e.$attrSelector,"-").concat(e.$style.name)},t));e.scopedStyleEl=f.el}},_themeChangeListener:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};nd.clearLoadedStyleNames(),eo.on("theme:change",e)},_removeThemeListeners:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};eo.off("theme:change",e.$loadStyles),e.$loadStyles=void 0},_hook:function(e,t,n,i,s,a){var o,u,f="on".concat(sVe(t)),g=Yr._getConfig(i,s),y=n?.$instance,A=Yr._usePT(y,Yr._getPT(i==null||(o=i.value)===null||o===void 0?void 0:o.pt,e),Yr._getOptionValue,"hooks.".concat(f)),C=Yr._useDefaultPT(y,g==null||(u=g.pt)===null||u===void 0||(u=u.directives)===null||u===void 0?void 0:u[e],Yr._getOptionValue,"hooks.".concat(f)),M={el:n,binding:i,vnode:s,prevVnode:a};A?.(y,M),C?.(y,M)},_mergeProps:function(){for(var e=arguments.length>1?arguments[1]:void 0,t=arguments.length,n=new Array(t>2?t-2:0),i=2;i<t;i++)n[i-2]=arguments[i];return y2(e)?e.apply(void 0,n):I.mergeProps.apply(void 0,n)},_extend:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=function(o,u,f,g,y){var A,C,M,k;u._$instances=u._$instances||{};var D=Yr._getConfig(f,g),V=u._$instances[e]||{},W=pa(V)?_n(_n({},t),t?.methods):{};u._$instances[e]=_n(_n({},V),{},{$name:e,$host:u,$binding:f,$modifiers:f?.modifiers,$value:f?.value,$el:V.$el||u||void 0,$style:_n({classes:void 0,inlineStyles:void 0,load:function(){},loadCSS:function(){},loadStyle:function(){}},t?.style),$primevueConfig:D,$attrSelector:(A=u.$pd)===null||A===void 0||(A=A[e])===null||A===void 0?void 0:A.attrSelector,defaultPT:function(){return Yr._getPT(D?.pt,void 0,function($){var te;return $==null||(te=$.directives)===null||te===void 0?void 0:te[e]})},isUnstyled:function(){var $,te;return(($=u._$instances[e])===null||$===void 0||($=$.$binding)===null||$===void 0||($=$.value)===null||$===void 0?void 0:$.unstyled)!==void 0?(te=u._$instances[e])===null||te===void 0||(te=te.$binding)===null||te===void 0||(te=te.value)===null||te===void 0?void 0:te.unstyled:D?.unstyled},theme:function(){var $;return($=u._$instances[e])===null||$===void 0||($=$.$primevueConfig)===null||$===void 0?void 0:$.theme},preset:function(){var $;return($=u._$instances[e])===null||$===void 0||($=$.$binding)===null||$===void 0||($=$.value)===null||$===void 0?void 0:$.dt},ptm:function(){var $,te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",le=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Yr._getPTValue(u._$instances[e],($=u._$instances[e])===null||$===void 0||($=$.$binding)===null||$===void 0||($=$.value)===null||$===void 0?void 0:$.pt,te,_n({},le))},ptmo:function(){var $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",le=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Yr._getPTValue(u._$instances[e],$,te,le,!1)},cx:function(){var $,te,le=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",_e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return($=u._$instances[e])!==null&&$!==void 0&&$.isUnstyled()?void 0:Yr._getOptionValue((te=u._$instances[e])===null||te===void 0||(te=te.$style)===null||te===void 0?void 0:te.classes,le,_n({},_e))},sx:function(){var $,te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",le=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,_e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return le?Yr._getOptionValue(($=u._$instances[e])===null||$===void 0||($=$.$style)===null||$===void 0?void 0:$.inlineStyles,te,_n({},_e)):void 0}},W),u.$instance=u._$instances[e],(C=(M=u.$instance)[o])===null||C===void 0||C.call(M,u,f,g,y),u["$".concat(e)]=u.$instance,Yr._hook(e,o,u,f,g,y),u.$pd||(u.$pd={}),u.$pd[e]=_n(_n({},(k=u.$pd)===null||k===void 0?void 0:k[e]),{},{name:e,instance:u._$instances[e]})},i=function(o){var u,f,g,y=o._$instances[e],A=y?.watch,C=function(D){var V,W=D.newValue,z=D.oldValue;return A==null||(V=A.config)===null||V===void 0?void 0:V.call(y,W,z)},M=function(D){var V,W=D.newValue,z=D.oldValue;return A==null||(V=A["config.ripple"])===null||V===void 0?void 0:V.call(y,W,z)};y.$watchersCallback={config:C,"config.ripple":M},A==null||(u=A.config)===null||u===void 0||u.call(y,y?.$primevueConfig),ud.on("config:change",C),A==null||(f=A["config.ripple"])===null||f===void 0||f.call(y,y==null||(g=y.$primevueConfig)===null||g===void 0?void 0:g.ripple),ud.on("config:ripple:change",M)},s=function(o){var u=o._$instances[e].$watchersCallback;u&&(ud.off("config:change",u.config),ud.off("config:ripple:change",u["config.ripple"]),o._$instances[e].$watchersCallback=void 0)};return{created:function(o,u,f,g){o.$pd||(o.$pd={}),o.$pd[e]={name:e,attrSelector:oVe("pd")},n("created",o,u,f,g)},beforeMount:function(o,u,f,g){var y;Yr._loadStyles((y=o.$pd[e])===null||y===void 0?void 0:y.instance,u,f),n("beforeMount",o,u,f,g),i(o)},mounted:function(o,u,f,g){var y;Yr._loadStyles((y=o.$pd[e])===null||y===void 0?void 0:y.instance,u,f),n("mounted",o,u,f,g)},beforeUpdate:function(o,u,f,g){n("beforeUpdate",o,u,f,g)},updated:function(o,u,f,g){var y;Yr._loadStyles((y=o.$pd[e])===null||y===void 0?void 0:y.instance,u,f),n("updated",o,u,f,g)},beforeUnmount:function(o,u,f,g){var y;s(o),Yr._removeThemeListeners((y=o.$pd[e])===null||y===void 0?void 0:y.instance),n("beforeUnmount",o,u,f,g)},unmounted:function(o,u,f,g){var y;(y=o.$pd[e])===null||y===void 0||(y=y.instance)===null||y===void 0||(y=y.scopedStyleEl)===null||y===void 0||(y=y.value)===null||y===void 0||y.remove(),n("unmounted",o,u,f,g)}}},extend:function(){var e=Yr._getMeta.apply(Yr,arguments),t=GV(e,2),n=t[0],i=t[1];return _n({extend:function(){var a=Yr._getMeta.apply(Yr,arguments),o=GV(a,2),u=o[0],f=o[1];return Yr.extend(u,_n(_n(_n({},i),i?.methods),f))}},Yr._extend(n,i))}},j$e=`
    .p-ink {
        display: block;
        position: absolute;
        background: dt('ripple.background');
        border-radius: 100%;
        transform: scale(0);
        pointer-events: none;
    }

    .p-ink-active {
        animation: ripple 0.4s linear;
    }

    @keyframes ripple {
        100% {
            opacity: 0;
            transform: scale(2.5);
        }
    }
`,G$e={root:"p-ink"},H$e=cn.extend({name:"ripple-directive",style:j$e,classes:G$e}),W$e=Yr.extend({style:H$e});function pv(r){"@babel/helpers - typeof";return pv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pv(r)}function K$e(r){return Y$e(r)||q$e(r)||J$e(r)||X$e()}function X$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function J$e(r,e){if(r){if(typeof r=="string")return OM(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?OM(r,e):void 0}}function q$e(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Y$e(r){if(Array.isArray(r))return OM(r)}function OM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function KV(r,e,t){return(e=Z$e(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Z$e(r){var e=Q$e(r,"string");return pv(e)=="symbol"?e:e+""}function Q$e(r,e){if(pv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(pv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Pd=W$e.extend("ripple",{watch:{"config.ripple":function(e){e?(this.createRipple(this.$host),this.bindEvents(this.$host),this.$host.setAttribute("data-pd-ripple",!0),this.$host.style.overflow="hidden",this.$host.style.position="relative"):(this.remove(this.$host),this.$host.removeAttribute("data-pd-ripple"))}},unmounted:function(e){this.remove(e)},timeout:void 0,methods:{bindEvents:function(e){e.addEventListener("mousedown",this.onMouseDown.bind(this))},unbindEvents:function(e){e.removeEventListener("mousedown",this.onMouseDown.bind(this))},createRipple:function(e){var t=this.getInk(e);t||(t=iZ("span",KV(KV({role:"presentation","aria-hidden":!0,"data-p-ink":!0,"data-p-ink-active":!1,class:!this.isUnstyled()&&this.cx("root"),onAnimationEnd:this.onAnimationEnd.bind(this)},this.$attrSelector,""),"p-bind",this.ptm("root"))),e.appendChild(t),this.$el=t)},remove:function(e){var t=this.getInk(e);t&&(this.$host.style.overflow="",this.$host.style.position="",this.unbindEvents(e),t.removeEventListener("animationend",this.onAnimationEnd),t.remove())},onMouseDown:function(e){var t=this,n=e.currentTarget,i=this.getInk(n);if(!(!i||getComputedStyle(i,null).display==="none")){if(!this.isUnstyled()&&rd(i,"p-ink-active"),i.setAttribute("data-p-ink-active","false"),!Of(i)&&!Df(i)){var s=Math.max(da(n),AT(n));i.style.height=s+"px",i.style.width=s+"px"}var a=um(n),o=e.pageX-a.left+document.body.scrollTop-Df(i)/2,u=e.pageY-a.top+document.body.scrollLeft-Of(i)/2;i.style.top=u+"px",i.style.left=o+"px",!this.isUnstyled()&&L0(i,"p-ink-active"),i.setAttribute("data-p-ink-active","true"),this.timeout=setTimeout(function(){i&&(!t.isUnstyled()&&rd(i,"p-ink-active"),i.setAttribute("data-p-ink-active","false"))},401)}},onAnimationEnd:function(e){this.timeout&&clearTimeout(this.timeout),!this.isUnstyled()&&rd(e.currentTarget,"p-ink-active"),e.currentTarget.setAttribute("data-p-ink-active","false")},getInk:function(e){return e&&e.children?K$e(e.children).find(function(t){return zs(t,"data-pc-name")==="ripple"}):void 0}}}),EZ={name:"BlankIcon",extends:gi};function eje(r){return ije(r)||nje(r)||rje(r)||tje()}function tje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rje(r,e){if(r){if(typeof r=="string")return DM(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?DM(r,e):void 0}}function nje(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function ije(r){if(Array.isArray(r))return DM(r)}function DM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function sje(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),eje(e[0]||(e[0]=[I.createElementVNode("rect",{width:"1",height:"1",fill:"currentColor","fill-opacity":"0"},null,-1)])),16)}EZ.render=sje;var Dy={name:"CheckIcon",extends:gi};function oje(r){return uje(r)||cje(r)||lje(r)||aje()}function aje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lje(r,e){if(r){if(typeof r=="string")return LM(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?LM(r,e):void 0}}function cje(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function uje(r){if(Array.isArray(r))return LM(r)}function LM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function hje(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),oje(e[0]||(e[0]=[I.createElementVNode("path",{d:"M4.86199 11.5948C4.78717 11.5923 4.71366 11.5745 4.64596 11.5426C4.57826 11.5107 4.51779 11.4652 4.46827 11.4091L0.753985 7.69483C0.683167 7.64891 0.623706 7.58751 0.580092 7.51525C0.536478 7.44299 0.509851 7.36177 0.502221 7.27771C0.49459 7.19366 0.506156 7.10897 0.536046 7.03004C0.565935 6.95111 0.613367 6.88 0.674759 6.82208C0.736151 6.76416 0.8099 6.72095 0.890436 6.69571C0.970973 6.67046 1.05619 6.66385 1.13966 6.67635C1.22313 6.68886 1.30266 6.72017 1.37226 6.76792C1.44186 6.81567 1.4997 6.8786 1.54141 6.95197L4.86199 10.2503L12.6397 2.49483C12.7444 2.42694 12.8689 2.39617 12.9932 2.40745C13.1174 2.41873 13.2343 2.47141 13.3251 2.55705C13.4159 2.64268 13.4753 2.75632 13.4938 2.87973C13.5123 3.00315 13.4888 3.1292 13.4271 3.23768L5.2557 11.4091C5.20618 11.4652 5.14571 11.5107 5.07801 11.5426C5.01031 11.5745 4.9368 11.5923 4.86199 11.5948Z",fill:"currentColor"},null,-1)])),16)}Dy.render=hje;var b2={name:"ChevronDownIcon",extends:gi};function dje(r){return mje(r)||gje(r)||pje(r)||fje()}function fje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pje(r,e){if(r){if(typeof r=="string")return NM(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?NM(r,e):void 0}}function gje(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function mje(r){if(Array.isArray(r))return NM(r)}function NM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function yje(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),dje(e[0]||(e[0]=[I.createElementVNode("path",{d:"M7.01744 10.398C6.91269 10.3985 6.8089 10.378 6.71215 10.3379C6.61541 10.2977 6.52766 10.2386 6.45405 10.1641L1.13907 4.84913C1.03306 4.69404 0.985221 4.5065 1.00399 4.31958C1.02276 4.13266 1.10693 3.95838 1.24166 3.82747C1.37639 3.69655 1.55301 3.61742 1.74039 3.60402C1.92777 3.59062 2.11386 3.64382 2.26584 3.75424L7.01744 8.47394L11.769 3.75424C11.9189 3.65709 12.097 3.61306 12.2748 3.62921C12.4527 3.64535 12.6199 3.72073 12.7498 3.84328C12.8797 3.96582 12.9647 4.12842 12.9912 4.30502C13.0177 4.48162 12.9841 4.662 12.8958 4.81724L7.58083 10.1322C7.50996 10.2125 7.42344 10.2775 7.32656 10.3232C7.22968 10.3689 7.12449 10.3944 7.01744 10.398Z",fill:"currentColor"},null,-1)])),16)}b2.render=yje;var IZ={name:"SearchIcon",extends:gi};function bje(r){return xje(r)||Aje(r)||vje(r)||_je()}function _je(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vje(r,e){if(r){if(typeof r=="string")return FM(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?FM(r,e):void 0}}function Aje(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function xje(r){if(Array.isArray(r))return FM(r)}function FM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function wje(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),bje(e[0]||(e[0]=[I.createElementVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M2.67602 11.0265C3.6661 11.688 4.83011 12.0411 6.02086 12.0411C6.81149 12.0411 7.59438 11.8854 8.32483 11.5828C8.87005 11.357 9.37808 11.0526 9.83317 10.6803L12.9769 13.8241C13.0323 13.8801 13.0983 13.9245 13.171 13.9548C13.2438 13.985 13.3219 14.0003 13.4007 14C13.4795 14.0003 13.5575 13.985 13.6303 13.9548C13.7031 13.9245 13.7691 13.8801 13.8244 13.8241C13.9367 13.7116 13.9998 13.5592 13.9998 13.4003C13.9998 13.2414 13.9367 13.089 13.8244 12.9765L10.6807 9.8328C11.053 9.37773 11.3573 8.86972 11.5831 8.32452C11.8857 7.59408 12.0414 6.81119 12.0414 6.02056C12.0414 4.8298 11.6883 3.66579 11.0268 2.67572C10.3652 1.68564 9.42494 0.913972 8.32483 0.45829C7.22472 0.00260857 6.01418 -0.116618 4.84631 0.115686C3.67844 0.34799 2.60568 0.921393 1.76369 1.76338C0.921698 2.60537 0.348296 3.67813 0.115991 4.84601C-0.116313 6.01388 0.00291375 7.22441 0.458595 8.32452C0.914277 9.42464 1.68595 10.3649 2.67602 11.0265ZM3.35565 2.0158C4.14456 1.48867 5.07206 1.20731 6.02086 1.20731C7.29317 1.20731 8.51338 1.71274 9.41304 2.6124C10.3127 3.51206 10.8181 4.73226 10.8181 6.00457C10.8181 6.95337 10.5368 7.88088 10.0096 8.66978C9.48251 9.45868 8.73328 10.0736 7.85669 10.4367C6.98011 10.7997 6.01554 10.8947 5.08496 10.7096C4.15439 10.5245 3.2996 10.0676 2.62869 9.39674C1.95778 8.72583 1.50089 7.87104 1.31579 6.94046C1.13068 6.00989 1.22568 5.04532 1.58878 4.16874C1.95187 3.29215 2.56675 2.54292 3.35565 2.0158Z",fill:"currentColor"},null,-1)])),16)}IZ.render=wje;var _2={name:"TimesIcon",extends:gi};function Cje(r){return Ije(r)||Eje(r)||Sje(r)||Tje()}function Tje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sje(r,e){if(r){if(typeof r=="string")return UM(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?UM(r,e):void 0}}function Eje(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Ije(r){if(Array.isArray(r))return UM(r)}function UM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function Pje(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),Cje(e[0]||(e[0]=[I.createElementVNode("path",{d:"M8.01186 7.00933L12.27 2.75116C12.341 2.68501 12.398 2.60524 12.4375 2.51661C12.4769 2.42798 12.4982 2.3323 12.4999 2.23529C12.5016 2.13827 12.4838 2.0419 12.4474 1.95194C12.4111 1.86197 12.357 1.78024 12.2884 1.71163C12.2198 1.64302 12.138 1.58893 12.0481 1.55259C11.9581 1.51625 11.8617 1.4984 11.7647 1.50011C11.6677 1.50182 11.572 1.52306 11.4834 1.56255C11.3948 1.60204 11.315 1.65898 11.2488 1.72997L6.99067 5.98814L2.7325 1.72997C2.59553 1.60234 2.41437 1.53286 2.22718 1.53616C2.03999 1.53946 1.8614 1.61529 1.72901 1.74767C1.59663 1.88006 1.5208 2.05865 1.5175 2.24584C1.5142 2.43303 1.58368 2.61419 1.71131 2.75116L5.96948 7.00933L1.71131 11.2675C1.576 11.403 1.5 11.5866 1.5 11.7781C1.5 11.9696 1.576 12.1532 1.71131 12.2887C1.84679 12.424 2.03043 12.5 2.2219 12.5C2.41338 12.5 2.59702 12.424 2.7325 12.2887L6.99067 8.03052L11.2488 12.2887C11.3843 12.424 11.568 12.5 11.7594 12.5C11.9509 12.5 12.1346 12.424 12.27 12.2887C12.4053 12.1532 12.4813 11.9696 12.4813 11.7781C12.4813 11.5866 12.4053 11.403 12.27 11.2675L8.01186 7.00933Z",fill:"currentColor"},null,-1)])),16)}_2.render=Pje;var Bje=`
    .p-iconfield {
        position: relative;
        display: block;
    }

    .p-inputicon {
        position: absolute;
        top: 50%;
        margin-top: calc(-1 * (dt('icon.size') / 2));
        color: dt('iconfield.icon.color');
        line-height: 1;
        z-index: 1;
    }

    .p-iconfield .p-inputicon:first-child {
        inset-inline-start: dt('form.field.padding.x');
    }

    .p-iconfield .p-inputicon:last-child {
        inset-inline-end: dt('form.field.padding.x');
    }

    .p-iconfield .p-inputtext:not(:first-child),
    .p-iconfield .p-inputwrapper:not(:first-child) .p-inputtext {
        padding-inline-start: calc((dt('form.field.padding.x') * 2) + dt('icon.size'));
    }

    .p-iconfield .p-inputtext:not(:last-child) {
        padding-inline-end: calc((dt('form.field.padding.x') * 2) + dt('icon.size'));
    }

    .p-iconfield:has(.p-inputfield-sm) .p-inputicon {
        font-size: dt('form.field.sm.font.size');
        width: dt('form.field.sm.font.size');
        height: dt('form.field.sm.font.size');
        margin-top: calc(-1 * (dt('form.field.sm.font.size') / 2));
    }

    .p-iconfield:has(.p-inputfield-lg) .p-inputicon {
        font-size: dt('form.field.lg.font.size');
        width: dt('form.field.lg.font.size');
        height: dt('form.field.lg.font.size');
        margin-top: calc(-1 * (dt('form.field.lg.font.size') / 2));
    }
`,Mje={root:"p-iconfield"},Rje=cn.extend({name:"iconfield",style:Bje,classes:Mje}),kje={name:"BaseIconField",extends:In,style:Rje,provide:function(){return{$pcIconField:this,$parentInstance:this}}},PZ={name:"IconField",extends:kje,inheritAttrs:!1};function Oje(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("div",I.mergeProps({class:r.cx("root")},r.ptmi("root")),[I.renderSlot(r.$slots,"default")],16)}PZ.render=Oje;var Dje={root:"p-inputicon"},Lje=cn.extend({name:"inputicon",classes:Dje}),Nje={name:"BaseInputIcon",extends:In,style:Lje,props:{class:null},provide:function(){return{$pcInputIcon:this,$parentInstance:this}}},BZ={name:"InputIcon",extends:Nje,inheritAttrs:!1,computed:{containerClass:function(){return[this.cx("root"),this.class]}}};function Fje(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("span",I.mergeProps({class:s.containerClass},r.ptmi("root"),{"aria-hidden":"true"}),[I.renderSlot(r.$slots,"default")],16)}BZ.render=Fje;var Uje={name:"BaseEditableHolder",extends:In,emits:["update:modelValue","value-change"],props:{modelValue:{type:null,default:void 0},defaultValue:{type:null,default:void 0},name:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},disabled:{type:Boolean,default:!1},formControl:{type:Object,default:void 0}},inject:{$parentInstance:{default:void 0},$pcForm:{default:void 0},$pcFormField:{default:void 0}},data:function(){return{d_value:this.defaultValue!==void 0?this.defaultValue:this.modelValue}},watch:{modelValue:{deep:!0,handler:function(e){this.d_value=e}},defaultValue:function(e){this.d_value=e},$formName:{immediate:!0,handler:function(e){var t,n;this.formField=((t=this.$pcForm)===null||t===void 0||(n=t.register)===null||n===void 0?void 0:n.call(t,e,this.$formControl))||{}}},$formControl:{immediate:!0,handler:function(e){var t,n;this.formField=((t=this.$pcForm)===null||t===void 0||(n=t.register)===null||n===void 0?void 0:n.call(t,this.$formName,e))||{}}},$formDefaultValue:{immediate:!0,handler:function(e){this.d_value!==e&&(this.d_value=e)}},$formValue:{immediate:!1,handler:function(e){var t;(t=this.$pcForm)!==null&&t!==void 0&&t.getFieldState(this.$formName)&&e!==this.d_value&&(this.d_value=e)}}},formField:{},methods:{writeValue:function(e,t){var n,i;this.controlled&&(this.d_value=e,this.$emit("update:modelValue",e)),this.$emit("value-change",e),(n=(i=this.formField).onChange)===null||n===void 0||n.call(i,{originalEvent:t,value:e})},findNonEmpty:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.find(Xr)}},computed:{$filled:function(){return Xr(this.d_value)},$invalid:function(){var e,t;return!this.$formNovalidate&&this.findNonEmpty(this.invalid,(e=this.$pcFormField)===null||e===void 0||(e=e.$field)===null||e===void 0?void 0:e.invalid,(t=this.$pcForm)===null||t===void 0||(t=t.getFieldState(this.$formName))===null||t===void 0?void 0:t.invalid)},$formName:function(){var e;return this.$formNovalidate?void 0:this.name||((e=this.$formControl)===null||e===void 0?void 0:e.name)},$formControl:function(){var e;return this.formControl||((e=this.$pcFormField)===null||e===void 0?void 0:e.formControl)},$formNovalidate:function(){var e;return(e=this.$formControl)===null||e===void 0?void 0:e.novalidate},$formDefaultValue:function(){var e,t;return this.findNonEmpty(this.d_value,(e=this.$pcFormField)===null||e===void 0?void 0:e.initialValue,(t=this.$pcForm)===null||t===void 0||(t=t.initialValues)===null||t===void 0?void 0:t[this.$formName])},$formValue:function(){var e,t;return this.findNonEmpty((e=this.$pcFormField)===null||e===void 0||(e=e.$field)===null||e===void 0?void 0:e.value,(t=this.$pcForm)===null||t===void 0||(t=t.getFieldState(this.$formName))===null||t===void 0?void 0:t.value)},controlled:function(){return this.$inProps.hasOwnProperty("modelValue")||!this.$inProps.hasOwnProperty("modelValue")&&!this.$inProps.hasOwnProperty("defaultValue")},filled:function(){return this.$filled}}},lA={name:"BaseInput",extends:Uje,props:{size:{type:String,default:null},fluid:{type:Boolean,default:null},variant:{type:String,default:null}},inject:{$parentInstance:{default:void 0},$pcFluid:{default:void 0}},computed:{$variant:function(){var e;return(e=this.variant)!==null&&e!==void 0?e:this.$primevue.config.inputStyle||this.$primevue.config.inputVariant},$fluid:function(){var e;return(e=this.fluid)!==null&&e!==void 0?e:!!this.$pcFluid},hasFluid:function(){return this.$fluid}}},zje=`
    .p-inputtext {
        font-family: inherit;
        font-feature-settings: inherit;
        font-size: 1rem;
        color: dt('inputtext.color');
        background: dt('inputtext.background');
        padding-block: dt('inputtext.padding.y');
        padding-inline: dt('inputtext.padding.x');
        border: 1px solid dt('inputtext.border.color');
        transition:
            background dt('inputtext.transition.duration'),
            color dt('inputtext.transition.duration'),
            border-color dt('inputtext.transition.duration'),
            outline-color dt('inputtext.transition.duration'),
            box-shadow dt('inputtext.transition.duration');
        appearance: none;
        border-radius: dt('inputtext.border.radius');
        outline-color: transparent;
        box-shadow: dt('inputtext.shadow');
    }

    .p-inputtext:enabled:hover {
        border-color: dt('inputtext.hover.border.color');
    }

    .p-inputtext:enabled:focus {
        border-color: dt('inputtext.focus.border.color');
        box-shadow: dt('inputtext.focus.ring.shadow');
        outline: dt('inputtext.focus.ring.width') dt('inputtext.focus.ring.style') dt('inputtext.focus.ring.color');
        outline-offset: dt('inputtext.focus.ring.offset');
    }

    .p-inputtext.p-invalid {
        border-color: dt('inputtext.invalid.border.color');
    }

    .p-inputtext.p-variant-filled {
        background: dt('inputtext.filled.background');
    }

    .p-inputtext.p-variant-filled:enabled:hover {
        background: dt('inputtext.filled.hover.background');
    }

    .p-inputtext.p-variant-filled:enabled:focus {
        background: dt('inputtext.filled.focus.background');
    }

    .p-inputtext:disabled {
        opacity: 1;
        background: dt('inputtext.disabled.background');
        color: dt('inputtext.disabled.color');
    }

    .p-inputtext::placeholder {
        color: dt('inputtext.placeholder.color');
    }

    .p-inputtext.p-invalid::placeholder {
        color: dt('inputtext.invalid.placeholder.color');
    }

    .p-inputtext-sm {
        font-size: dt('inputtext.sm.font.size');
        padding-block: dt('inputtext.sm.padding.y');
        padding-inline: dt('inputtext.sm.padding.x');
    }

    .p-inputtext-lg {
        font-size: dt('inputtext.lg.font.size');
        padding-block: dt('inputtext.lg.padding.y');
        padding-inline: dt('inputtext.lg.padding.x');
    }

    .p-inputtext-fluid {
        width: 100%;
    }
`,Vje={root:function(e){var t=e.instance,n=e.props;return["p-inputtext p-component",{"p-filled":t.$filled,"p-inputtext-sm p-inputfield-sm":n.size==="small","p-inputtext-lg p-inputfield-lg":n.size==="large","p-invalid":t.$invalid,"p-variant-filled":t.$variant==="filled","p-inputtext-fluid":t.$fluid}]}},$je=cn.extend({name:"inputtext",style:zje,classes:Vje}),jje={name:"BaseInputText",extends:lA,style:$je,provide:function(){return{$pcInputText:this,$parentInstance:this}}};function gv(r){"@babel/helpers - typeof";return gv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gv(r)}function Gje(r,e,t){return(e=Hje(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Hje(r){var e=Wje(r,"string");return gv(e)=="symbol"?e:e+""}function Wje(r,e){if(gv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(gv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var mv={name:"InputText",extends:jje,inheritAttrs:!1,methods:{onInput:function(e){this.writeValue(e.target.value,e)}},computed:{attrs:function(){return I.mergeProps(this.ptmi("root",{context:{filled:this.$filled,disabled:this.disabled}}),this.formField)},dataP:function(){return wo(Gje({invalid:this.$invalid,fluid:this.$fluid,filled:this.$variant==="filled"},this.size,this.size))}}},Kje=["value","name","disabled","aria-invalid","data-p"];function Xje(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("input",I.mergeProps({type:"text",class:r.cx("root"),value:r.d_value,name:r.name,disabled:r.disabled,"aria-invalid":r.$invalid||void 0,"data-p":s.dataP,onInput:e[0]||(e[0]=function(){return s.onInput&&s.onInput.apply(s,arguments)})},s.attrs),null,16,Kje)}mv.render=Xje;var hd=hL(),fL={name:"Portal",props:{appendTo:{type:[String,Object],default:"body"},disabled:{type:Boolean,default:!1}},data:function(){return{mounted:!1}},mounted:function(){this.mounted=aZ()},computed:{inline:function(){return this.disabled||this.appendTo==="self"}}};function Jje(r,e,t,n,i,s){return s.inline?I.renderSlot(r.$slots,"default",{key:0}):i.mounted?(I.openBlock(),I.createBlock(I.Teleport,{key:1,to:t.appendTo},[I.renderSlot(r.$slots,"default")],8,["to"])):I.createCommentVNode("",!0)}fL.render=Jje;var qje=`
    .p-virtualscroller-loader {
        background: dt('virtualscroller.loader.mask.background');
        color: dt('virtualscroller.loader.mask.color');
    }

    .p-virtualscroller-loading-icon {
        font-size: dt('virtualscroller.loader.icon.size');
        width: dt('virtualscroller.loader.icon.size');
        height: dt('virtualscroller.loader.icon.size');
    }
`,Yje=`
.p-virtualscroller {
    position: relative;
    overflow: auto;
    contain: strict;
    transform: translateZ(0);
    will-change: scroll-position;
    outline: 0 none;
}

.p-virtualscroller-content {
    position: absolute;
    top: 0;
    left: 0;
    min-height: 100%;
    min-width: 100%;
    will-change: transform;
}

.p-virtualscroller-spacer {
    position: absolute;
    top: 0;
    left: 0;
    height: 1px;
    width: 1px;
    transform-origin: 0 0;
    pointer-events: none;
}

.p-virtualscroller-loader {
    position: sticky;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

.p-virtualscroller-loader-mask {
    display: flex;
    align-items: center;
    justify-content: center;
}

.p-virtualscroller-horizontal > .p-virtualscroller-content {
    display: flex;
}

.p-virtualscroller-inline .p-virtualscroller-content {
    position: static;
}

.p-virtualscroller .p-virtualscroller-loading {
    transform: none !important;
    min-height: 0;
    position: sticky;
    inset-block-start: 0;
    inset-inline-start: 0;
}
`,XV=cn.extend({name:"virtualscroller",css:Yje,style:qje}),Zje={name:"BaseVirtualScroller",extends:In,props:{id:{type:String,default:null},style:null,class:null,items:{type:Array,default:null},itemSize:{type:[Number,Array],default:0},scrollHeight:null,scrollWidth:null,orientation:{type:String,default:"vertical"},numToleratedItems:{type:Number,default:null},delay:{type:Number,default:0},resizeDelay:{type:Number,default:10},lazy:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loaderDisabled:{type:Boolean,default:!1},columns:{type:Array,default:null},loading:{type:Boolean,default:!1},showSpacer:{type:Boolean,default:!0},showLoader:{type:Boolean,default:!1},tabindex:{type:Number,default:0},inline:{type:Boolean,default:!1},step:{type:Number,default:0},appendOnly:{type:Boolean,default:!1},autoSize:{type:Boolean,default:!1}},style:XV,provide:function(){return{$pcVirtualScroller:this,$parentInstance:this}},beforeMount:function(){var e;XV.loadCSS({nonce:(e=this.$primevueConfig)===null||e===void 0||(e=e.csp)===null||e===void 0?void 0:e.nonce})}};function yv(r){"@babel/helpers - typeof";return yv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yv(r)}function JV(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function g0(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?JV(Object(t),!0).forEach(function(n){MZ(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):JV(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function MZ(r,e,t){return(e=Qje(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Qje(r){var e=e7e(r,"string");return yv(e)=="symbol"?e:e+""}function e7e(r,e){if(yv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(yv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var pL={name:"VirtualScroller",extends:Zje,inheritAttrs:!1,emits:["update:numToleratedItems","scroll","scroll-index-change","lazy-load"],data:function(){var e=this.isBoth();return{first:e?{rows:0,cols:0}:0,last:e?{rows:0,cols:0}:0,page:e?{rows:0,cols:0}:0,numItemsInViewport:e?{rows:0,cols:0}:0,lastScrollPos:e?{top:0,left:0}:0,d_numToleratedItems:this.numToleratedItems,d_loading:this.loading,loaderArr:[],spacerStyle:{},contentStyle:{}}},element:null,content:null,lastScrollPos:null,scrollTimeout:null,resizeTimeout:null,defaultWidth:0,defaultHeight:0,defaultContentWidth:0,defaultContentHeight:0,isRangeChanged:!1,lazyLoadState:{},resizeListener:null,resizeObserver:null,initialized:!1,watch:{numToleratedItems:function(e){this.d_numToleratedItems=e},loading:function(e,t){this.lazy&&e!==t&&e!==this.d_loading&&(this.d_loading=e)},items:{handler:function(e,t){(!t||t.length!==(e||[]).length)&&(this.init(),this.calculateAutoSize())},deep:!0},itemSize:function(){this.init(),this.calculateAutoSize()},orientation:function(){this.lastScrollPos=this.isBoth()?{top:0,left:0}:0},scrollHeight:function(){this.init(),this.calculateAutoSize()},scrollWidth:function(){this.init(),this.calculateAutoSize()}},mounted:function(){this.viewInit(),this.lastScrollPos=this.isBoth()?{top:0,left:0}:0,this.lazyLoadState=this.lazyLoadState||{}},updated:function(){!this.initialized&&this.viewInit()},unmounted:function(){this.unbindResizeListener(),this.initialized=!1},methods:{viewInit:function(){xT(this.element)&&(this.setContentEl(this.content),this.init(),this.calculateAutoSize(),this.defaultWidth=Df(this.element),this.defaultHeight=Of(this.element),this.defaultContentWidth=Df(this.content),this.defaultContentHeight=Of(this.content),this.initialized=!0),this.element&&this.bindResizeListener()},init:function(){this.disabled||(this.setSize(),this.calculateOptions(),this.setSpacerSize())},isVertical:function(){return this.orientation==="vertical"},isHorizontal:function(){return this.orientation==="horizontal"},isBoth:function(){return this.orientation==="both"},scrollTo:function(e){this.element&&this.element.scrollTo(e)},scrollToIndex:function(e){var t=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto",i=this.isBoth(),s=this.isHorizontal(),a=i?e.every(function(_e){return _e>-1}):e>-1;if(a){var o=this.first,u=this.element,f=u.scrollTop,g=f===void 0?0:f,y=u.scrollLeft,A=y===void 0?0:y,C=this.calculateNumItems(),M=C.numToleratedItems,k=this.getContentPosition(),D=this.itemSize,V=function(){var se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,Y=arguments.length>1?arguments[1]:void 0;return se<=Y?0:se},W=function(se,Y,ce){return se*Y+ce},z=function(){var se=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,Y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return t.scrollTo({left:se,top:Y,behavior:n})},$=i?{rows:0,cols:0}:0,te=!1,le=!1;i?($={rows:V(e[0],M[0]),cols:V(e[1],M[1])},z(W($.cols,D[1],k.left),W($.rows,D[0],k.top)),le=this.lastScrollPos.top!==g||this.lastScrollPos.left!==A,te=$.rows!==o.rows||$.cols!==o.cols):($=V(e,M),s?z(W($,D,k.left),g):z(A,W($,D,k.top)),le=this.lastScrollPos!==(s?A:g),te=$!==o),this.isRangeChanged=te,le&&(this.first=$)}},scrollInView:function(e,t){var n=this,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"auto";if(t){var s=this.isBoth(),a=this.isHorizontal(),o=s?e.every(function(D){return D>-1}):e>-1;if(o){var u=this.getRenderedRange(),f=u.first,g=u.viewport,y=function(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return n.scrollTo({left:V,top:W,behavior:i})},A=t==="to-start",C=t==="to-end";if(A){if(s)g.first.rows-f.rows>e[0]?y(g.first.cols*this.itemSize[1],(g.first.rows-1)*this.itemSize[0]):g.first.cols-f.cols>e[1]&&y((g.first.cols-1)*this.itemSize[1],g.first.rows*this.itemSize[0]);else if(g.first-f>e){var M=(g.first-1)*this.itemSize;a?y(M,0):y(0,M)}}else if(C){if(s)g.last.rows-f.rows<=e[0]+1?y(g.first.cols*this.itemSize[1],(g.first.rows+1)*this.itemSize[0]):g.last.cols-f.cols<=e[1]+1&&y((g.first.cols+1)*this.itemSize[1],g.first.rows*this.itemSize[0]);else if(g.last-f<=e+1){var k=(g.first+1)*this.itemSize;a?y(k,0):y(0,k)}}}}else this.scrollToIndex(e,i)},getRenderedRange:function(){var e=function(y,A){return Math.floor(y/(A||y))},t=this.first,n=0;if(this.element){var i=this.isBoth(),s=this.isHorizontal(),a=this.element,o=a.scrollTop,u=a.scrollLeft;if(i)t={rows:e(o,this.itemSize[0]),cols:e(u,this.itemSize[1])},n={rows:t.rows+this.numItemsInViewport.rows,cols:t.cols+this.numItemsInViewport.cols};else{var f=s?u:o;t=e(f,this.itemSize),n=t+this.numItemsInViewport}}return{first:this.first,last:this.last,viewport:{first:t,last:n}}},calculateNumItems:function(){var e=this.isBoth(),t=this.isHorizontal(),n=this.itemSize,i=this.getContentPosition(),s=this.element?this.element.offsetWidth-i.left:0,a=this.element?this.element.offsetHeight-i.top:0,o=function(A,C){return Math.ceil(A/(C||A))},u=function(A){return Math.ceil(A/2)},f=e?{rows:o(a,n[0]),cols:o(s,n[1])}:o(t?s:a,n),g=this.d_numToleratedItems||(e?[u(f.rows),u(f.cols)]:u(f));return{numItemsInViewport:f,numToleratedItems:g}},calculateOptions:function(){var e=this,t=this.isBoth(),n=this.first,i=this.calculateNumItems(),s=i.numItemsInViewport,a=i.numToleratedItems,o=function(g,y,A){var C=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return e.getLast(g+y+(g<A?2:3)*A,C)},u=t?{rows:o(n.rows,s.rows,a[0]),cols:o(n.cols,s.cols,a[1],!0)}:o(n,s,a);this.last=u,this.numItemsInViewport=s,this.d_numToleratedItems=a,this.$emit("update:numToleratedItems",this.d_numToleratedItems),this.showLoader&&(this.loaderArr=t?Array.from({length:s.rows}).map(function(){return Array.from({length:s.cols})}):Array.from({length:s})),this.lazy&&Promise.resolve().then(function(){var f;e.lazyLoadState={first:e.step?t?{rows:0,cols:n.cols}:0:n,last:Math.min(e.step?e.step:u,((f=e.items)===null||f===void 0?void 0:f.length)||0)},e.$emit("lazy-load",e.lazyLoadState)})},calculateAutoSize:function(){var e=this;this.autoSize&&!this.d_loading&&Promise.resolve().then(function(){if(e.content){var t=e.isBoth(),n=e.isHorizontal(),i=e.isVertical();e.content.style.minHeight=e.content.style.minWidth="auto",e.content.style.position="relative",e.element.style.contain="none";var s=[Df(e.element),Of(e.element)],a=s[0],o=s[1];(t||n)&&(e.element.style.width=a<e.defaultWidth?a+"px":e.scrollWidth||e.defaultWidth+"px"),(t||i)&&(e.element.style.height=o<e.defaultHeight?o+"px":e.scrollHeight||e.defaultHeight+"px"),e.content.style.minHeight=e.content.style.minWidth="",e.content.style.position="",e.element.style.contain=""}})},getLast:function(){var e,t,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1?arguments[1]:void 0;return this.items?Math.min(i?((e=this.columns||this.items[0])===null||e===void 0?void 0:e.length)||0:((t=this.items)===null||t===void 0?void 0:t.length)||0,n):0},getContentPosition:function(){if(this.content){var e=getComputedStyle(this.content),t=parseFloat(e.paddingLeft)+Math.max(parseFloat(e.left)||0,0),n=parseFloat(e.paddingRight)+Math.max(parseFloat(e.right)||0,0),i=parseFloat(e.paddingTop)+Math.max(parseFloat(e.top)||0,0),s=parseFloat(e.paddingBottom)+Math.max(parseFloat(e.bottom)||0,0);return{left:t,right:n,top:i,bottom:s,x:t+n,y:i+s}}return{left:0,right:0,top:0,bottom:0,x:0,y:0}},setSize:function(){var e=this;if(this.element){var t=this.isBoth(),n=this.isHorizontal(),i=this.element.parentElement,s=this.scrollWidth||"".concat(this.element.offsetWidth||i.offsetWidth,"px"),a=this.scrollHeight||"".concat(this.element.offsetHeight||i.offsetHeight,"px"),o=function(f,g){return e.element.style[f]=g};t||n?(o("height",a),o("width",s)):o("height",a)}},setSpacerSize:function(){var e=this,t=this.items;if(t){var n=this.isBoth(),i=this.isHorizontal(),s=this.getContentPosition(),a=function(u,f,g){var y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return e.spacerStyle=g0(g0({},e.spacerStyle),MZ({},"".concat(u),(f||[]).length*g+y+"px"))};n?(a("height",t,this.itemSize[0],s.y),a("width",this.columns||t[1],this.itemSize[1],s.x)):i?a("width",this.columns||t,this.itemSize,s.x):a("height",t,this.itemSize,s.y)}},setContentPosition:function(e){var t=this;if(this.content&&!this.appendOnly){var n=this.isBoth(),i=this.isHorizontal(),s=e?e.first:this.first,a=function(g,y){return g*y},o=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return t.contentStyle=g0(g0({},t.contentStyle),{transform:"translate3d(".concat(g,"px, ").concat(y,"px, 0)")})};if(n)o(a(s.cols,this.itemSize[1]),a(s.rows,this.itemSize[0]));else{var u=a(s,this.itemSize);i?o(u,0):o(0,u)}}},onScrollPositionChange:function(e){var t=this,n=e.target,i=this.isBoth(),s=this.isHorizontal(),a=this.getContentPosition(),o=function(oe,Me){return oe?oe>Me?oe-Me:oe:0},u=function(oe,Me){return Math.floor(oe/(Me||oe))},f=function(oe,Me,ze,Ve,lt,gt){return oe<=lt?lt:gt?ze-Ve-lt:Me+lt-1},g=function(oe,Me,ze,Ve,lt,gt,At,Tt){if(oe<=gt)return 0;var Ut=Math.max(0,At?oe<Me?ze:oe-gt:oe>Me?ze:oe-2*gt),xr=t.getLast(Ut,Tt);return Ut>xr?xr-lt:Ut},y=function(oe,Me,ze,Ve,lt,gt){var At=Me+Ve+2*lt;return oe>=lt&&(At+=lt+1),t.getLast(At,gt)},A=o(n.scrollTop,a.top),C=o(n.scrollLeft,a.left),M=i?{rows:0,cols:0}:0,k=this.last,D=!1,V=this.lastScrollPos;if(i){var W=this.lastScrollPos.top<=A,z=this.lastScrollPos.left<=C;if(!this.appendOnly||this.appendOnly&&(W||z)){var $={rows:u(A,this.itemSize[0]),cols:u(C,this.itemSize[1])},te={rows:f($.rows,this.first.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0],W),cols:f($.cols,this.first.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],z)};M={rows:g($.rows,te.rows,this.first.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0],W),cols:g($.cols,te.cols,this.first.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],z,!0)},k={rows:y($.rows,M.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0]),cols:y($.cols,M.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],!0)},D=M.rows!==this.first.rows||k.rows!==this.last.rows||M.cols!==this.first.cols||k.cols!==this.last.cols||this.isRangeChanged,V={top:A,left:C}}}else{var le=s?C:A,_e=this.lastScrollPos<=le;if(!this.appendOnly||this.appendOnly&&_e){var se=u(le,this.itemSize),Y=f(se,this.first,this.last,this.numItemsInViewport,this.d_numToleratedItems,_e);M=g(se,Y,this.first,this.last,this.numItemsInViewport,this.d_numToleratedItems,_e),k=y(se,M,this.last,this.numItemsInViewport,this.d_numToleratedItems),D=M!==this.first||k!==this.last||this.isRangeChanged,V=le}}return{first:M,last:k,isRangeChanged:D,scrollPos:V}},onScrollChange:function(e){var t=this.onScrollPositionChange(e),n=t.first,i=t.last,s=t.isRangeChanged,a=t.scrollPos;if(s){var o={first:n,last:i};if(this.setContentPosition(o),this.first=n,this.last=i,this.lastScrollPos=a,this.$emit("scroll-index-change",o),this.lazy&&this.isPageChanged(n)){var u,f,g={first:this.step?Math.min(this.getPageByFirst(n)*this.step,(((u=this.items)===null||u===void 0?void 0:u.length)||0)-this.step):n,last:Math.min(this.step?(this.getPageByFirst(n)+1)*this.step:i,((f=this.items)===null||f===void 0?void 0:f.length)||0)},y=this.lazyLoadState.first!==g.first||this.lazyLoadState.last!==g.last;y&&this.$emit("lazy-load",g),this.lazyLoadState=g}}},onScroll:function(e){var t=this;if(this.$emit("scroll",e),this.delay){if(this.scrollTimeout&&clearTimeout(this.scrollTimeout),this.isPageChanged()){if(!this.d_loading&&this.showLoader){var n=this.onScrollPositionChange(e),i=n.isRangeChanged,s=i||(this.step?this.isPageChanged():!1);s&&(this.d_loading=!0)}this.scrollTimeout=setTimeout(function(){t.onScrollChange(e),t.d_loading&&t.showLoader&&(!t.lazy||t.loading===void 0)&&(t.d_loading=!1,t.page=t.getPageByFirst())},this.delay)}}else this.onScrollChange(e)},onResize:function(){var e=this;this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){if(xT(e.element)){var t=e.isBoth(),n=e.isVertical(),i=e.isHorizontal(),s=[Df(e.element),Of(e.element)],a=s[0],o=s[1],u=a!==e.defaultWidth,f=o!==e.defaultHeight,g=t?u||f:i?u:n?f:!1;g&&(e.d_numToleratedItems=e.numToleratedItems,e.defaultWidth=a,e.defaultHeight=o,e.defaultContentWidth=Df(e.content),e.defaultContentHeight=Of(e.content),e.init())}},this.resizeDelay)},bindResizeListener:function(){var e=this;this.resizeListener||(this.resizeListener=this.onResize.bind(this),window.addEventListener("resize",this.resizeListener),window.addEventListener("orientationchange",this.resizeListener),this.resizeObserver=new ResizeObserver(function(){e.onResize()}),this.resizeObserver.observe(this.element))},unbindResizeListener:function(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),window.removeEventListener("orientationchange",this.resizeListener),this.resizeListener=null),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)},getOptions:function(e){var t=(this.items||[]).length,n=this.isBoth()?this.first.rows+e:this.first+e;return{index:n,count:t,first:n===0,last:n===t-1,even:n%2===0,odd:n%2!==0}},getLoaderOptions:function(e,t){var n=this.loaderArr.length;return g0({index:e,count:n,first:e===0,last:e===n-1,even:e%2===0,odd:e%2!==0},t)},getPageByFirst:function(e){return Math.floor(((e??this.first)+this.d_numToleratedItems*4)/(this.step||1))},isPageChanged:function(e){return this.step&&!this.lazy?this.page!==this.getPageByFirst(e??this.first):!0},setContentEl:function(e){this.content=e||this.content||cd(this.element,'[data-pc-section="content"]')},elementRef:function(e){this.element=e},contentRef:function(e){this.content=e}},computed:{containerClass:function(){return["p-virtualscroller",this.class,{"p-virtualscroller-inline":this.inline,"p-virtualscroller-both p-both-scroll":this.isBoth(),"p-virtualscroller-horizontal p-horizontal-scroll":this.isHorizontal()}]},contentClass:function(){return["p-virtualscroller-content",{"p-virtualscroller-loading":this.d_loading}]},loaderClass:function(){return["p-virtualscroller-loader",{"p-virtualscroller-loader-mask":!this.$slots.loader}]},loadedItems:function(){var e=this;return this.items&&!this.d_loading?this.isBoth()?this.items.slice(this.appendOnly?0:this.first.rows,this.last.rows).map(function(t){return e.columns?t:t.slice(e.appendOnly?0:e.first.cols,e.last.cols)}):this.isHorizontal()&&this.columns?this.items:this.items.slice(this.appendOnly?0:this.first,this.last):[]},loadedRows:function(){return this.d_loading?this.loaderDisabled?this.loaderArr:[]:this.loadedItems},loadedColumns:function(){if(this.columns){var e=this.isBoth(),t=this.isHorizontal();if(e||t)return this.d_loading&&this.loaderDisabled?e?this.loaderArr[0]:this.loaderArr:this.columns.slice(e?this.first.cols:this.first,e?this.last.cols:this.last)}return this.columns}},components:{SpinnerIcon:aA}},t7e=["tabindex"];function r7e(r,e,t,n,i,s){var a=I.resolveComponent("SpinnerIcon");return r.disabled?(I.openBlock(),I.createElementBlock(I.Fragment,{key:1},[I.renderSlot(r.$slots,"default"),I.renderSlot(r.$slots,"content",{items:r.items,rows:r.items,columns:s.loadedColumns})],64)):(I.openBlock(),I.createElementBlock("div",I.mergeProps({key:0,ref:s.elementRef,class:s.containerClass,tabindex:r.tabindex,style:r.style,onScroll:e[0]||(e[0]=function(){return s.onScroll&&s.onScroll.apply(s,arguments)})},r.ptmi("root")),[I.renderSlot(r.$slots,"content",{styleClass:s.contentClass,items:s.loadedItems,getItemOptions:s.getOptions,loading:i.d_loading,getLoaderOptions:s.getLoaderOptions,itemSize:r.itemSize,rows:s.loadedRows,columns:s.loadedColumns,contentRef:s.contentRef,spacerStyle:i.spacerStyle,contentStyle:i.contentStyle,vertical:s.isVertical(),horizontal:s.isHorizontal(),both:s.isBoth()},function(){return[I.createElementVNode("div",I.mergeProps({ref:s.contentRef,class:s.contentClass,style:i.contentStyle},r.ptm("content")),[(I.openBlock(!0),I.createElementBlock(I.Fragment,null,I.renderList(s.loadedItems,function(o,u){return I.renderSlot(r.$slots,"item",{key:u,item:o,options:s.getOptions(u)})}),128))],16)]}),r.showSpacer?(I.openBlock(),I.createElementBlock("div",I.mergeProps({key:0,class:"p-virtualscroller-spacer",style:i.spacerStyle},r.ptm("spacer")),null,16)):I.createCommentVNode("",!0),!r.loaderDisabled&&r.showLoader&&i.d_loading?(I.openBlock(),I.createElementBlock("div",I.mergeProps({key:1,class:s.loaderClass},r.ptm("loader")),[r.$slots&&r.$slots.loader?(I.openBlock(!0),I.createElementBlock(I.Fragment,{key:0},I.renderList(i.loaderArr,function(o,u){return I.renderSlot(r.$slots,"loader",{key:u,options:s.getLoaderOptions(u,s.isBoth()&&{numCols:r.d_numItemsInViewport.cols})})}),128)):I.createCommentVNode("",!0),I.renderSlot(r.$slots,"loadingicon",{},function(){return[I.createVNode(a,I.mergeProps({spin:"",class:"p-virtualscroller-loading-icon"},r.ptm("loadingIcon")),null,16)]})],16)):I.createCommentVNode("",!0)],16,t7e))}pL.render=r7e;var n7e=`
    .p-select {
        display: inline-flex;
        cursor: pointer;
        position: relative;
        user-select: none;
        background: dt('select.background');
        border: 1px solid dt('select.border.color');
        transition:
            background dt('select.transition.duration'),
            color dt('select.transition.duration'),
            border-color dt('select.transition.duration'),
            outline-color dt('select.transition.duration'),
            box-shadow dt('select.transition.duration');
        border-radius: dt('select.border.radius');
        outline-color: transparent;
        box-shadow: dt('select.shadow');
    }

    .p-select:not(.p-disabled):hover {
        border-color: dt('select.hover.border.color');
    }

    .p-select:not(.p-disabled).p-focus {
        border-color: dt('select.focus.border.color');
        box-shadow: dt('select.focus.ring.shadow');
        outline: dt('select.focus.ring.width') dt('select.focus.ring.style') dt('select.focus.ring.color');
        outline-offset: dt('select.focus.ring.offset');
    }

    .p-select.p-variant-filled {
        background: dt('select.filled.background');
    }

    .p-select.p-variant-filled:not(.p-disabled):hover {
        background: dt('select.filled.hover.background');
    }

    .p-select.p-variant-filled:not(.p-disabled).p-focus {
        background: dt('select.filled.focus.background');
    }

    .p-select.p-invalid {
        border-color: dt('select.invalid.border.color');
    }

    .p-select.p-disabled {
        opacity: 1;
        background: dt('select.disabled.background');
    }

    .p-select-clear-icon {
        align-self: center;
        color: dt('select.clear.icon.color');
        inset-inline-end: dt('select.dropdown.width');
    }

    .p-select-dropdown {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
        background: transparent;
        color: dt('select.dropdown.color');
        width: dt('select.dropdown.width');
        border-start-end-radius: dt('select.border.radius');
        border-end-end-radius: dt('select.border.radius');
    }

    .p-select-label {
        display: block;
        white-space: nowrap;
        overflow: hidden;
        flex: 1 1 auto;
        width: 1%;
        padding: dt('select.padding.y') dt('select.padding.x');
        text-overflow: ellipsis;
        cursor: pointer;
        color: dt('select.color');
        background: transparent;
        border: 0 none;
        outline: 0 none;
        font-size: 1rem;
    }

    .p-select-label.p-placeholder {
        color: dt('select.placeholder.color');
    }

    .p-select.p-invalid .p-select-label.p-placeholder {
        color: dt('select.invalid.placeholder.color');
    }

    .p-select.p-disabled .p-select-label {
        color: dt('select.disabled.color');
    }

    .p-select-label-empty {
        overflow: hidden;
        opacity: 0;
    }

    input.p-select-label {
        cursor: default;
    }

    .p-select-overlay {
        position: absolute;
        top: 0;
        left: 0;
        background: dt('select.overlay.background');
        color: dt('select.overlay.color');
        border: 1px solid dt('select.overlay.border.color');
        border-radius: dt('select.overlay.border.radius');
        box-shadow: dt('select.overlay.shadow');
        min-width: 100%;
        transform-origin: inherit;
        will-change: transform;
    }

    .p-select-header {
        padding: dt('select.list.header.padding');
    }

    .p-select-filter {
        width: 100%;
    }

    .p-select-list-container {
        overflow: auto;
    }

    .p-select-option-group {
        cursor: auto;
        margin: 0;
        padding: dt('select.option.group.padding');
        background: dt('select.option.group.background');
        color: dt('select.option.group.color');
        font-weight: dt('select.option.group.font.weight');
    }

    .p-select-list {
        margin: 0;
        padding: 0;
        list-style-type: none;
        padding: dt('select.list.padding');
        gap: dt('select.list.gap');
        display: flex;
        flex-direction: column;
    }

    .p-select-option {
        cursor: pointer;
        font-weight: normal;
        white-space: nowrap;
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: center;
        padding: dt('select.option.padding');
        border: 0 none;
        color: dt('select.option.color');
        background: transparent;
        transition:
            background dt('select.transition.duration'),
            color dt('select.transition.duration'),
            border-color dt('select.transition.duration'),
            box-shadow dt('select.transition.duration'),
            outline-color dt('select.transition.duration');
        border-radius: dt('select.option.border.radius');
    }

    .p-select-option:not(.p-select-option-selected):not(.p-disabled).p-focus {
        background: dt('select.option.focus.background');
        color: dt('select.option.focus.color');
    }

    .p-select-option:not(.p-select-option-selected):not(.p-disabled):hover {
        background: dt('select.option.focus.background');
        color: dt('select.option.focus.color');
    }

    .p-select-option.p-select-option-selected {
        background: dt('select.option.selected.background');
        color: dt('select.option.selected.color');
    }

    .p-select-option.p-select-option-selected.p-focus {
        background: dt('select.option.selected.focus.background');
        color: dt('select.option.selected.focus.color');
    }
   
    .p-select-option-blank-icon {
        flex-shrink: 0;
    }

    .p-select-option-check-icon {
        position: relative;
        flex-shrink: 0;
        margin-inline-start: dt('select.checkmark.gutter.start');
        margin-inline-end: dt('select.checkmark.gutter.end');
        color: dt('select.checkmark.color');
    }

    .p-select-empty-message {
        padding: dt('select.empty.message.padding');
    }

    .p-select-fluid {
        display: flex;
        width: 100%;
    }

    .p-select-sm .p-select-label {
        font-size: dt('select.sm.font.size');
        padding-block: dt('select.sm.padding.y');
        padding-inline: dt('select.sm.padding.x');
    }

    .p-select-sm .p-select-dropdown .p-icon {
        font-size: dt('select.sm.font.size');
        width: dt('select.sm.font.size');
        height: dt('select.sm.font.size');
    }

    .p-select-lg .p-select-label {
        font-size: dt('select.lg.font.size');
        padding-block: dt('select.lg.padding.y');
        padding-inline: dt('select.lg.padding.x');
    }

    .p-select-lg .p-select-dropdown .p-icon {
        font-size: dt('select.lg.font.size');
        width: dt('select.lg.font.size');
        height: dt('select.lg.font.size');
    }

    .p-floatlabel-in .p-select-filter {
        padding-block-start: dt('select.padding.y');
        padding-block-end: dt('select.padding.y');
    }
`,i7e={root:function(e){var t=e.instance,n=e.props,i=e.state;return["p-select p-component p-inputwrapper",{"p-disabled":n.disabled,"p-invalid":t.$invalid,"p-variant-filled":t.$variant==="filled","p-focus":i.focused,"p-inputwrapper-filled":t.$filled,"p-inputwrapper-focus":i.focused||i.overlayVisible,"p-select-open":i.overlayVisible,"p-select-fluid":t.$fluid,"p-select-sm p-inputfield-sm":n.size==="small","p-select-lg p-inputfield-lg":n.size==="large"}]},label:function(e){var t,n=e.instance,i=e.props;return["p-select-label",{"p-placeholder":!i.editable&&n.label===i.placeholder,"p-select-label-empty":!i.editable&&!n.$slots.value&&(n.label==="p-emptylabel"||((t=n.label)===null||t===void 0?void 0:t.length)===0)}]},clearIcon:"p-select-clear-icon",dropdown:"p-select-dropdown",loadingicon:"p-select-loading-icon",dropdownIcon:"p-select-dropdown-icon",overlay:"p-select-overlay p-component",header:"p-select-header",pcFilter:"p-select-filter",listContainer:"p-select-list-container",list:"p-select-list",optionGroup:"p-select-option-group",optionGroupLabel:"p-select-option-group-label",option:function(e){var t=e.instance,n=e.props,i=e.state,s=e.option,a=e.focusedOption;return["p-select-option",{"p-select-option-selected":t.isSelected(s)&&n.highlightOnSelect,"p-focus":i.focusedOptionIndex===a,"p-disabled":t.isOptionDisabled(s)}]},optionLabel:"p-select-option-label",optionCheckIcon:"p-select-option-check-icon",optionBlankIcon:"p-select-option-blank-icon",emptyMessage:"p-select-empty-message"},s7e=cn.extend({name:"select",style:n7e,classes:i7e}),o7e={name:"BaseSelect",extends:lA,props:{options:Array,optionLabel:[String,Function],optionValue:[String,Function],optionDisabled:[String,Function],optionGroupLabel:[String,Function],optionGroupChildren:[String,Function],scrollHeight:{type:String,default:"14rem"},filter:Boolean,filterPlaceholder:String,filterLocale:String,filterMatchMode:{type:String,default:"contains"},filterFields:{type:Array,default:null},editable:Boolean,placeholder:{type:String,default:null},dataKey:null,showClear:{type:Boolean,default:!1},inputId:{type:String,default:null},inputClass:{type:[String,Object],default:null},inputStyle:{type:Object,default:null},labelId:{type:String,default:null},labelClass:{type:[String,Object],default:null},labelStyle:{type:Object,default:null},panelClass:{type:[String,Object],default:null},overlayStyle:{type:Object,default:null},overlayClass:{type:[String,Object],default:null},panelStyle:{type:Object,default:null},appendTo:{type:[String,Object],default:"body"},loading:{type:Boolean,default:!1},clearIcon:{type:String,default:void 0},dropdownIcon:{type:String,default:void 0},filterIcon:{type:String,default:void 0},loadingIcon:{type:String,default:void 0},resetFilterOnHide:{type:Boolean,default:!1},resetFilterOnClear:{type:Boolean,default:!1},virtualScrollerOptions:{type:Object,default:null},autoOptionFocus:{type:Boolean,default:!1},autoFilterFocus:{type:Boolean,default:!1},selectOnFocus:{type:Boolean,default:!1},focusOnHover:{type:Boolean,default:!0},highlightOnSelect:{type:Boolean,default:!0},checkmark:{type:Boolean,default:!1},filterMessage:{type:String,default:null},selectionMessage:{type:String,default:null},emptySelectionMessage:{type:String,default:null},emptyFilterMessage:{type:String,default:null},emptyMessage:{type:String,default:null},tabindex:{type:Number,default:0},ariaLabel:{type:String,default:null},ariaLabelledby:{type:String,default:null}},style:s7e,provide:function(){return{$pcSelect:this,$parentInstance:this}}};function bv(r){"@babel/helpers - typeof";return bv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bv(r)}function a7e(r){return h7e(r)||u7e(r)||c7e(r)||l7e()}function l7e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c7e(r,e){if(r){if(typeof r=="string")return zM(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?zM(r,e):void 0}}function u7e(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function h7e(r){if(Array.isArray(r))return zM(r)}function zM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function qV(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function YV(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?qV(Object(t),!0).forEach(function(n){Mf(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):qV(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function Mf(r,e,t){return(e=d7e(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function d7e(r){var e=f7e(r,"string");return bv(e)=="symbol"?e:e+""}function f7e(r,e){if(bv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(bv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var rp={name:"Select",extends:o7e,inheritAttrs:!1,emits:["change","focus","blur","before-show","before-hide","show","hide","filter"],outsideClickListener:null,scrollHandler:null,resizeListener:null,labelClickListener:null,matchMediaOrientationListener:null,overlay:null,list:null,virtualScroller:null,searchTimeout:null,searchValue:null,isModelValueChanged:!1,data:function(){return{clicked:!1,focused:!1,focusedOptionIndex:-1,filterValue:null,overlayVisible:!1,queryOrientation:null}},watch:{modelValue:function(){this.isModelValueChanged=!0},options:function(){this.autoUpdateModel()}},mounted:function(){this.autoUpdateModel(),this.bindLabelClickListener(),this.bindMatchMediaOrientationListener()},updated:function(){this.overlayVisible&&this.isModelValueChanged&&this.scrollInView(this.findSelectedOptionIndex()),this.isModelValueChanged=!1},beforeUnmount:function(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.unbindLabelClickListener(),this.unbindMatchMediaOrientationListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.overlay&&(Gm.clear(this.overlay),this.overlay=null)},methods:{getOptionIndex:function(e,t){return this.virtualScrollerDisabled?e:t&&t(e).index},getOptionLabel:function(e){return this.optionLabel?hn(e,this.optionLabel):e},getOptionValue:function(e){return this.optionValue?hn(e,this.optionValue):e},getOptionRenderKey:function(e,t){return(this.dataKey?hn(e,this.dataKey):this.getOptionLabel(e))+"_"+t},getPTItemOptions:function(e,t,n,i){return this.ptm(i,{context:{option:e,index:n,selected:this.isSelected(e),focused:this.focusedOptionIndex===this.getOptionIndex(n,t),disabled:this.isOptionDisabled(e)}})},isOptionDisabled:function(e){return this.optionDisabled?hn(e,this.optionDisabled):!1},isOptionGroup:function(e){return this.optionGroupLabel&&e.optionGroup&&e.group},getOptionGroupLabel:function(e){return hn(e,this.optionGroupLabel)},getOptionGroupChildren:function(e){return hn(e,this.optionGroupChildren)},getAriaPosInset:function(e){var t=this;return(this.optionGroupLabel?e-this.visibleOptions.slice(0,e).filter(function(n){return t.isOptionGroup(n)}).length:e)+1},show:function(e){this.$emit("before-show"),this.overlayVisible=!0,this.focusedOptionIndex=this.focusedOptionIndex!==-1?this.focusedOptionIndex:this.autoOptionFocus?this.findFirstFocusedOptionIndex():this.editable?-1:this.findSelectedOptionIndex(),e&&oa(this.$refs.focusInput)},hide:function(e){var t=this,n=function(){t.$emit("before-hide"),t.overlayVisible=!1,t.clicked=!1,t.focusedOptionIndex=-1,t.searchValue="",t.resetFilterOnHide&&(t.filterValue=null),e&&oa(t.$refs.focusInput)};setTimeout(function(){n()},0)},onFocus:function(e){this.disabled||(this.focused=!0,this.overlayVisible&&(this.focusedOptionIndex=this.focusedOptionIndex!==-1?this.focusedOptionIndex:this.autoOptionFocus?this.findFirstFocusedOptionIndex():this.editable?-1:this.findSelectedOptionIndex(),this.scrollInView(this.focusedOptionIndex)),this.$emit("focus",e))},onBlur:function(e){var t=this;setTimeout(function(){var n,i;t.focused=!1,t.focusedOptionIndex=-1,t.searchValue="",t.$emit("blur",e),(n=(i=t.formField).onBlur)===null||n===void 0||n.call(i,e)},100)},onKeyDown:function(e){if(this.disabled){e.preventDefault();return}if(Kze())switch(e.code){case"Backspace":this.onBackspaceKey(e,this.editable);break;case"Enter":case"NumpadDecimal":this.onEnterKey(e);break;default:e.preventDefault();return}var t=e.metaKey||e.ctrlKey;switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e,this.editable);break;case"ArrowLeft":case"ArrowRight":this.onArrowLeftKey(e,this.editable);break;case"Home":this.onHomeKey(e,this.editable);break;case"End":this.onEndKey(e,this.editable);break;case"PageDown":this.onPageDownKey(e);break;case"PageUp":this.onPageUpKey(e);break;case"Space":this.onSpaceKey(e,this.editable);break;case"Enter":case"NumpadEnter":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e);break;case"Backspace":this.onBackspaceKey(e,this.editable);break;case"ShiftLeft":case"ShiftRight":break;default:!t&&nVe(e.key)&&(!this.overlayVisible&&this.show(),!this.editable&&this.searchOptions(e,e.key),this.filter&&(this.filterValue=e.key));break}this.clicked=!1},onEditableInput:function(e){var t=e.target.value;this.searchValue="";var n=this.searchOptions(e,t);!n&&(this.focusedOptionIndex=-1),this.updateModel(e,t),!this.overlayVisible&&Xr(t)&&this.show()},onContainerClick:function(e){this.disabled||this.loading||e.target.tagName==="INPUT"||e.target.getAttribute("data-pc-section")==="clearicon"||e.target.closest('[data-pc-section="clearicon"]')||((!this.overlay||!this.overlay.contains(e.target))&&(this.overlayVisible?this.hide(!0):this.show(!0)),this.clicked=!0)},onClearClick:function(e){this.updateModel(e,null),this.resetFilterOnClear&&(this.filterValue=null)},onFirstHiddenFocus:function(e){var t=e.relatedTarget===this.$refs.focusInput?kf(this.overlay,':not([data-p-hidden-focusable="true"])'):this.$refs.focusInput;oa(t)},onLastHiddenFocus:function(e){var t=e.relatedTarget===this.$refs.focusInput?sZ(this.overlay,':not([data-p-hidden-focusable="true"])'):this.$refs.focusInput;oa(t)},onOptionSelect:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=this.getOptionValue(t);this.updateModel(e,i),n&&this.hide(!0)},onOptionMouseMove:function(e,t){this.focusOnHover&&this.changeFocusedOptionIndex(e,t)},onFilterChange:function(e){var t=e.target.value;this.filterValue=t,this.focusedOptionIndex=-1,this.$emit("filter",{originalEvent:e,value:t}),!this.virtualScrollerDisabled&&this.virtualScroller.scrollToIndex(0)},onFilterKeyDown:function(e){if(!e.isComposing)switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e,!0);break;case"ArrowLeft":case"ArrowRight":this.onArrowLeftKey(e,!0);break;case"Home":this.onHomeKey(e,!0);break;case"End":this.onEndKey(e,!0);break;case"Enter":case"NumpadEnter":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e);break}},onFilterBlur:function(){this.focusedOptionIndex=-1},onFilterUpdated:function(){this.overlayVisible&&this.alignOverlay()},onOverlayClick:function(e){hd.emit("overlay-click",{originalEvent:e,target:this.$el})},onOverlayKeyDown:function(e){switch(e.code){case"Escape":this.onEscapeKey(e);break}},onArrowDownKey:function(e){if(!this.overlayVisible)this.show(),this.editable&&this.changeFocusedOptionIndex(e,this.findSelectedOptionIndex());else{var t=this.focusedOptionIndex!==-1?this.findNextOptionIndex(this.focusedOptionIndex):this.clicked?this.findFirstOptionIndex():this.findFirstFocusedOptionIndex();this.changeFocusedOptionIndex(e,t)}e.preventDefault()},onArrowUpKey:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.altKey&&!t)this.focusedOptionIndex!==-1&&this.onOptionSelect(e,this.visibleOptions[this.focusedOptionIndex]),this.overlayVisible&&this.hide(),e.preventDefault();else{var n=this.focusedOptionIndex!==-1?this.findPrevOptionIndex(this.focusedOptionIndex):this.clicked?this.findLastOptionIndex():this.findLastFocusedOptionIndex();this.changeFocusedOptionIndex(e,n),!this.overlayVisible&&this.show(),e.preventDefault()}},onArrowLeftKey:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;t&&(this.focusedOptionIndex=-1)},onHomeKey:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(t){var n=e.currentTarget;e.shiftKey?n.setSelectionRange(0,e.target.selectionStart):(n.setSelectionRange(0,0),this.focusedOptionIndex=-1)}else this.changeFocusedOptionIndex(e,this.findFirstOptionIndex()),!this.overlayVisible&&this.show();e.preventDefault()},onEndKey:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(t){var n=e.currentTarget;if(e.shiftKey)n.setSelectionRange(e.target.selectionStart,n.value.length);else{var i=n.value.length;n.setSelectionRange(i,i),this.focusedOptionIndex=-1}}else this.changeFocusedOptionIndex(e,this.findLastOptionIndex()),!this.overlayVisible&&this.show();e.preventDefault()},onPageUpKey:function(e){this.scrollInView(0),e.preventDefault()},onPageDownKey:function(e){this.scrollInView(this.visibleOptions.length-1),e.preventDefault()},onEnterKey:function(e){this.overlayVisible?(this.focusedOptionIndex!==-1&&this.onOptionSelect(e,this.visibleOptions[this.focusedOptionIndex]),this.hide(!0)):(this.focusedOptionIndex=-1,this.onArrowDownKey(e)),e.preventDefault()},onSpaceKey:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;!t&&this.onEnterKey(e)},onEscapeKey:function(e){this.overlayVisible&&this.hide(!0),e.preventDefault(),e.stopPropagation()},onTabKey:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;t||(this.overlayVisible&&this.hasFocusableElements()?(oa(this.$refs.firstHiddenFocusableElementOnOverlay),e.preventDefault()):(this.focusedOptionIndex!==-1&&this.onOptionSelect(e,this.visibleOptions[this.focusedOptionIndex]),this.overlayVisible&&this.hide(this.filter)))},onBackspaceKey:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;t&&!this.overlayVisible&&this.show()},onOverlayEnter:function(e){var t=this;Gm.set("overlay",e,this.$primevue.config.zIndex.overlay),_T(e,{position:"absolute",top:"0"}),this.alignOverlay(),this.scrollInView(),this.$attrSelector&&e.setAttribute(this.$attrSelector,""),setTimeout(function(){t.autoFilterFocus&&t.filter&&oa(t.$refs.filterInput.$el),t.autoUpdateModel()},1)},onOverlayAfterEnter:function(){this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.$emit("show")},onOverlayLeave:function(){var e=this;this.unbindOutsideClickListener(),this.unbindScrollListener(),this.unbindResizeListener(),this.autoFilterFocus&&this.filter&&!this.editable&&this.$nextTick(function(){e.$refs.filterInput&&oa(e.$refs.filterInput.$el)}),this.$emit("hide"),this.overlay=null},onOverlayAfterLeave:function(e){Gm.clear(e)},alignOverlay:function(){this.appendTo==="self"?$ze(this.overlay,this.$el):this.overlay&&(this.overlay.style.minWidth=da(this.$el)+"px",nZ(this.overlay,this.$el))},bindOutsideClickListener:function(){var e=this;this.outsideClickListener||(this.outsideClickListener=function(t){var n=t.composedPath();e.overlayVisible&&e.overlay&&!n.includes(e.$el)&&!n.includes(e.overlay)&&e.hide()},document.addEventListener("click",this.outsideClickListener,!0))},unbindOutsideClickListener:function(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener,!0),this.outsideClickListener=null)},bindScrollListener:function(){var e=this;this.scrollHandler||(this.scrollHandler=new dZ(this.$refs.container,function(){e.overlayVisible&&e.hide()})),this.scrollHandler.bindScrollListener()},unbindScrollListener:function(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener:function(){var e=this;this.resizeListener||(this.resizeListener=function(){e.overlayVisible&&!lZ()&&e.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener:function(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},bindLabelClickListener:function(){var e=this;if(!this.editable&&!this.labelClickListener){var t=document.querySelector('label[for="'.concat(this.labelId,'"]'));t&&xT(t)&&(this.labelClickListener=function(){oa(e.$refs.focusInput)},t.addEventListener("click",this.labelClickListener))}},unbindLabelClickListener:function(){if(this.labelClickListener){var e=document.querySelector('label[for="'.concat(this.labelId,'"]'));e&&xT(e)&&e.removeEventListener("click",this.labelClickListener)}},bindMatchMediaOrientationListener:function(){var e=this;if(!this.matchMediaOrientationListener){var t=matchMedia("(orientation: portrait)");this.queryOrientation=t,this.matchMediaOrientationListener=function(){e.alignOverlay()},this.queryOrientation.addEventListener("change",this.matchMediaOrientationListener)}},unbindMatchMediaOrientationListener:function(){this.matchMediaOrientationListener&&(this.queryOrientation.removeEventListener("change",this.matchMediaOrientationListener),this.queryOrientation=null,this.matchMediaOrientationListener=null)},hasFocusableElements:function(){return cL(this.overlay,':not([data-p-hidden-focusable="true"])').length>0},isOptionExactMatched:function(e){var t;return this.isValidOption(e)&&typeof this.getOptionLabel(e)=="string"&&((t=this.getOptionLabel(e))===null||t===void 0?void 0:t.toLocaleLowerCase(this.filterLocale))==this.searchValue.toLocaleLowerCase(this.filterLocale)},isOptionStartsWith:function(e){var t;return this.isValidOption(e)&&typeof this.getOptionLabel(e)=="string"&&((t=this.getOptionLabel(e))===null||t===void 0?void 0:t.toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue.toLocaleLowerCase(this.filterLocale)))},isValidOption:function(e){return Xr(e)&&!(this.isOptionDisabled(e)||this.isOptionGroup(e))},isValidSelectedOption:function(e){return this.isValidOption(e)&&this.isSelected(e)},isSelected:function(e){return Ip(this.d_value,this.getOptionValue(e),this.equalityKey)},findFirstOptionIndex:function(){var e=this;return this.visibleOptions.findIndex(function(t){return e.isValidOption(t)})},findLastOptionIndex:function(){var e=this;return xV(this.visibleOptions,function(t){return e.isValidOption(t)})},findNextOptionIndex:function(e){var t=this,n=e<this.visibleOptions.length-1?this.visibleOptions.slice(e+1).findIndex(function(i){return t.isValidOption(i)}):-1;return n>-1?n+e+1:e},findPrevOptionIndex:function(e){var t=this,n=e>0?xV(this.visibleOptions.slice(0,e),function(i){return t.isValidOption(i)}):-1;return n>-1?n:e},findSelectedOptionIndex:function(){var e=this;return this.visibleOptions.findIndex(function(t){return e.isValidSelectedOption(t)})},findFirstFocusedOptionIndex:function(){var e=this.findSelectedOptionIndex();return e<0?this.findFirstOptionIndex():e},findLastFocusedOptionIndex:function(){var e=this.findSelectedOptionIndex();return e<0?this.findLastOptionIndex():e},searchOptions:function(e,t){var n=this;this.searchValue=(this.searchValue||"")+t;var i=-1,s=!1;return Xr(this.searchValue)&&(i=this.visibleOptions.findIndex(function(a){return n.isOptionExactMatched(a)}),i===-1&&(i=this.visibleOptions.findIndex(function(a){return n.isOptionStartsWith(a)})),i!==-1&&(s=!0),i===-1&&this.focusedOptionIndex===-1&&(i=this.findFirstFocusedOptionIndex()),i!==-1&&this.changeFocusedOptionIndex(e,i)),this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(function(){n.searchValue="",n.searchTimeout=null},500),s},changeFocusedOptionIndex:function(e,t){this.focusedOptionIndex!==t&&(this.focusedOptionIndex=t,this.scrollInView(),this.selectOnFocus&&this.onOptionSelect(e,this.visibleOptions[t],!1))},scrollInView:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:-1;this.$nextTick(function(){var n=t!==-1?"".concat(e.$id,"_").concat(t):e.focusedOptionId,i=cd(e.list,'li[id="'.concat(n,'"]'));i?i.scrollIntoView&&i.scrollIntoView({block:"nearest",inline:"nearest"}):e.virtualScrollerDisabled||e.virtualScroller&&e.virtualScroller.scrollToIndex(t!==-1?t:e.focusedOptionIndex)})},autoUpdateModel:function(){this.autoOptionFocus&&(this.focusedOptionIndex=this.findFirstFocusedOptionIndex()),this.selectOnFocus&&this.autoOptionFocus&&!this.$filled&&this.onOptionSelect(null,this.visibleOptions[this.focusedOptionIndex],!1)},updateModel:function(e,t){this.writeValue(t,e),this.$emit("change",{originalEvent:e,value:t})},flatOptions:function(e){var t=this;return(e||[]).reduce(function(n,i,s){n.push({optionGroup:i,group:!0,index:s});var a=t.getOptionGroupChildren(i);return a&&a.forEach(function(o){return n.push(o)}),n},[])},overlayRef:function(e){this.overlay=e},listRef:function(e,t){this.list=e,t&&t(e)},virtualScrollerRef:function(e){this.virtualScroller=e}},computed:{visibleOptions:function(){var e=this,t=this.optionGroupLabel?this.flatOptions(this.options):this.options||[];if(this.filterValue){var n=TM.filter(t,this.searchFields,this.filterValue,this.filterMatchMode,this.filterLocale);if(this.optionGroupLabel){var i=this.options||[],s=[];return i.forEach(function(a){var o=e.getOptionGroupChildren(a),u=o.filter(function(f){return n.includes(f)});u.length>0&&s.push(YV(YV({},a),{},Mf({},typeof e.optionGroupChildren=="string"?e.optionGroupChildren:"items",a7e(u))))}),this.flatOptions(s)}return n}return t},hasSelectedOption:function(){return this.$filled},label:function(){var e=this.findSelectedOptionIndex();return e!==-1?this.getOptionLabel(this.visibleOptions[e]):this.placeholder||"p-emptylabel"},editableInputValue:function(){var e=this.findSelectedOptionIndex();return e!==-1?this.getOptionLabel(this.visibleOptions[e]):this.d_value||""},equalityKey:function(){return this.optionValue?null:this.dataKey},searchFields:function(){return this.filterFields||[this.optionLabel]},filterResultMessageText:function(){return Xr(this.visibleOptions)?this.filterMessageText.replaceAll("{0}",this.visibleOptions.length):this.emptyFilterMessageText},filterMessageText:function(){return this.filterMessage||this.$primevue.config.locale.searchMessage||""},emptyFilterMessageText:function(){return this.emptyFilterMessage||this.$primevue.config.locale.emptySearchMessage||this.$primevue.config.locale.emptyFilterMessage||""},emptyMessageText:function(){return this.emptyMessage||this.$primevue.config.locale.emptyMessage||""},selectionMessageText:function(){return this.selectionMessage||this.$primevue.config.locale.selectionMessage||""},emptySelectionMessageText:function(){return this.emptySelectionMessage||this.$primevue.config.locale.emptySelectionMessage||""},selectedMessageText:function(){return this.$filled?this.selectionMessageText.replaceAll("{0}","1"):this.emptySelectionMessageText},focusedOptionId:function(){return this.focusedOptionIndex!==-1?"".concat(this.$id,"_").concat(this.focusedOptionIndex):null},ariaSetSize:function(){var e=this;return this.visibleOptions.filter(function(t){return!e.isOptionGroup(t)}).length},isClearIconVisible:function(){return this.showClear&&this.d_value!=null&&!this.disabled&&!this.loading},virtualScrollerDisabled:function(){return!this.virtualScrollerOptions},containerDataP:function(){return wo(Mf({invalid:this.$invalid,disabled:this.disabled,focus:this.focused,fluid:this.$fluid,filled:this.$variant==="filled"},this.size,this.size))},labelDataP:function(){return wo(Mf(Mf({placeholder:!this.editable&&this.label===this.placeholder,clearable:this.showClear,disabled:this.disabled,editable:this.editable},this.size,this.size),"empty",!this.editable&&!this.$slots.value&&(this.label==="p-emptylabel"||this.label.length===0)))},dropdownIconDataP:function(){return wo(Mf({},this.size,this.size))},overlayDataP:function(){return wo(Mf({},"portal-"+this.appendTo,"portal-"+this.appendTo))}},directives:{ripple:Pd},components:{InputText:mv,VirtualScroller:pL,Portal:fL,InputIcon:BZ,IconField:PZ,TimesIcon:_2,ChevronDownIcon:b2,SpinnerIcon:aA,SearchIcon:IZ,CheckIcon:Dy,BlankIcon:EZ}},p7e=["id","data-p"],g7e=["name","id","value","placeholder","tabindex","disabled","aria-label","aria-labelledby","aria-expanded","aria-controls","aria-activedescendant","aria-invalid","data-p"],m7e=["name","id","tabindex","aria-label","aria-labelledby","aria-expanded","aria-controls","aria-activedescendant","aria-invalid","aria-disabled","data-p"],y7e=["data-p"],b7e=["id"],_7e=["id"],v7e=["id","aria-label","aria-selected","aria-disabled","aria-setsize","aria-posinset","onMousedown","onMousemove","data-p-selected","data-p-focused","data-p-disabled"];function A7e(r,e,t,n,i,s){var a=I.resolveComponent("SpinnerIcon"),o=I.resolveComponent("InputText"),u=I.resolveComponent("SearchIcon"),f=I.resolveComponent("InputIcon"),g=I.resolveComponent("IconField"),y=I.resolveComponent("CheckIcon"),A=I.resolveComponent("BlankIcon"),C=I.resolveComponent("VirtualScroller"),M=I.resolveComponent("Portal"),k=I.resolveDirective("ripple");return I.openBlock(),I.createElementBlock("div",I.mergeProps({ref:"container",id:r.$id,class:r.cx("root"),onClick:e[12]||(e[12]=function(){return s.onContainerClick&&s.onContainerClick.apply(s,arguments)}),"data-p":s.containerDataP},r.ptmi("root")),[r.editable?(I.openBlock(),I.createElementBlock("input",I.mergeProps({key:0,ref:"focusInput",name:r.name,id:r.labelId||r.inputId,type:"text",class:[r.cx("label"),r.inputClass,r.labelClass],style:[r.inputStyle,r.labelStyle],value:s.editableInputValue,placeholder:r.placeholder,tabindex:r.disabled?-1:r.tabindex,disabled:r.disabled,autocomplete:"off",role:"combobox","aria-label":r.ariaLabel,"aria-labelledby":r.ariaLabelledby,"aria-haspopup":"listbox","aria-expanded":i.overlayVisible,"aria-controls":i.overlayVisible?r.$id+"_list":void 0,"aria-activedescendant":i.focused?s.focusedOptionId:void 0,"aria-invalid":r.invalid||void 0,onFocus:e[0]||(e[0]=function(){return s.onFocus&&s.onFocus.apply(s,arguments)}),onBlur:e[1]||(e[1]=function(){return s.onBlur&&s.onBlur.apply(s,arguments)}),onKeydown:e[2]||(e[2]=function(){return s.onKeyDown&&s.onKeyDown.apply(s,arguments)}),onInput:e[3]||(e[3]=function(){return s.onEditableInput&&s.onEditableInput.apply(s,arguments)}),"data-p":s.labelDataP},r.ptm("label")),null,16,g7e)):(I.openBlock(),I.createElementBlock("span",I.mergeProps({key:1,ref:"focusInput",name:r.name,id:r.labelId||r.inputId,class:[r.cx("label"),r.inputClass,r.labelClass],style:[r.inputStyle,r.labelStyle],tabindex:r.disabled?-1:r.tabindex,role:"combobox","aria-label":r.ariaLabel||(s.label==="p-emptylabel"?void 0:s.label),"aria-labelledby":r.ariaLabelledby,"aria-haspopup":"listbox","aria-expanded":i.overlayVisible,"aria-controls":r.$id+"_list","aria-activedescendant":i.focused?s.focusedOptionId:void 0,"aria-invalid":r.invalid||void 0,"aria-disabled":r.disabled,onFocus:e[4]||(e[4]=function(){return s.onFocus&&s.onFocus.apply(s,arguments)}),onBlur:e[5]||(e[5]=function(){return s.onBlur&&s.onBlur.apply(s,arguments)}),onKeydown:e[6]||(e[6]=function(){return s.onKeyDown&&s.onKeyDown.apply(s,arguments)}),"data-p":s.labelDataP},r.ptm("label")),[I.renderSlot(r.$slots,"value",{value:r.d_value,placeholder:r.placeholder},function(){var D;return[I.createTextVNode(I.toDisplayString(s.label==="p-emptylabel"?"":(D=s.label)!==null&&D!==void 0?D:"empty"),1)]})],16,m7e)),s.isClearIconVisible?I.renderSlot(r.$slots,"clearicon",{key:2,class:I.normalizeClass(r.cx("clearIcon")),clearCallback:s.onClearClick},function(){return[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(r.clearIcon?"i":"TimesIcon"),I.mergeProps({ref:"clearIcon",class:[r.cx("clearIcon"),r.clearIcon],onClick:s.onClearClick},r.ptm("clearIcon"),{"data-pc-section":"clearicon"}),null,16,["class","onClick"]))]}):I.createCommentVNode("",!0),I.createElementVNode("div",I.mergeProps({class:r.cx("dropdown")},r.ptm("dropdown")),[r.loading?I.renderSlot(r.$slots,"loadingicon",{key:0,class:I.normalizeClass(r.cx("loadingIcon"))},function(){return[r.loadingIcon?(I.openBlock(),I.createElementBlock("span",I.mergeProps({key:0,class:[r.cx("loadingIcon"),"pi-spin",r.loadingIcon],"aria-hidden":"true"},r.ptm("loadingIcon")),null,16)):(I.openBlock(),I.createBlock(a,I.mergeProps({key:1,class:r.cx("loadingIcon"),spin:"","aria-hidden":"true"},r.ptm("loadingIcon")),null,16,["class"]))]}):I.renderSlot(r.$slots,"dropdownicon",{key:1,class:I.normalizeClass(r.cx("dropdownIcon"))},function(){return[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(r.dropdownIcon?"span":"ChevronDownIcon"),I.mergeProps({class:[r.cx("dropdownIcon"),r.dropdownIcon],"aria-hidden":"true","data-p":s.dropdownIconDataP},r.ptm("dropdownIcon")),null,16,["class","data-p"]))]})],16),I.createVNode(M,{appendTo:r.appendTo},{default:I.withCtx(function(){return[I.createVNode(I.Transition,I.mergeProps({name:"p-anchored-overlay",onEnter:s.onOverlayEnter,onAfterEnter:s.onOverlayAfterEnter,onLeave:s.onOverlayLeave,onAfterLeave:s.onOverlayAfterLeave},r.ptm("transition")),{default:I.withCtx(function(){return[i.overlayVisible?(I.openBlock(),I.createElementBlock("div",I.mergeProps({key:0,ref:s.overlayRef,class:[r.cx("overlay"),r.panelClass,r.overlayClass],style:[r.panelStyle,r.overlayStyle],onClick:e[10]||(e[10]=function(){return s.onOverlayClick&&s.onOverlayClick.apply(s,arguments)}),onKeydown:e[11]||(e[11]=function(){return s.onOverlayKeyDown&&s.onOverlayKeyDown.apply(s,arguments)}),"data-p":s.overlayDataP},r.ptm("overlay")),[I.createElementVNode("span",I.mergeProps({ref:"firstHiddenFocusableElementOnOverlay",role:"presentation","aria-hidden":"true",class:"p-hidden-accessible p-hidden-focusable",tabindex:0,onFocus:e[7]||(e[7]=function(){return s.onFirstHiddenFocus&&s.onFirstHiddenFocus.apply(s,arguments)})},r.ptm("hiddenFirstFocusableEl"),{"data-p-hidden-accessible":!0,"data-p-hidden-focusable":!0}),null,16),I.renderSlot(r.$slots,"header",{value:r.d_value,options:s.visibleOptions}),r.filter?(I.openBlock(),I.createElementBlock("div",I.mergeProps({key:0,class:r.cx("header")},r.ptm("header")),[I.createVNode(g,{unstyled:r.unstyled,pt:r.ptm("pcFilterContainer")},{default:I.withCtx(function(){return[I.createVNode(o,{ref:"filterInput",type:"text",value:i.filterValue,onVnodeMounted:s.onFilterUpdated,onVnodeUpdated:s.onFilterUpdated,class:I.normalizeClass(r.cx("pcFilter")),placeholder:r.filterPlaceholder,variant:r.variant,unstyled:r.unstyled,role:"searchbox",autocomplete:"off","aria-owns":r.$id+"_list","aria-activedescendant":s.focusedOptionId,onKeydown:s.onFilterKeyDown,onBlur:s.onFilterBlur,onInput:s.onFilterChange,pt:r.ptm("pcFilter"),formControl:{novalidate:!0}},null,8,["value","onVnodeMounted","onVnodeUpdated","class","placeholder","variant","unstyled","aria-owns","aria-activedescendant","onKeydown","onBlur","onInput","pt"]),I.createVNode(f,{unstyled:r.unstyled,pt:r.ptm("pcFilterIconContainer")},{default:I.withCtx(function(){return[I.renderSlot(r.$slots,"filtericon",{},function(){return[r.filterIcon?(I.openBlock(),I.createElementBlock("span",I.mergeProps({key:0,class:r.filterIcon},r.ptm("filterIcon")),null,16)):(I.openBlock(),I.createBlock(u,I.normalizeProps(I.mergeProps({key:1},r.ptm("filterIcon"))),null,16))]})]}),_:3},8,["unstyled","pt"])]}),_:3},8,["unstyled","pt"]),I.createElementVNode("span",I.mergeProps({role:"status","aria-live":"polite",class:"p-hidden-accessible"},r.ptm("hiddenFilterResult"),{"data-p-hidden-accessible":!0}),I.toDisplayString(s.filterResultMessageText),17)],16)):I.createCommentVNode("",!0),I.createElementVNode("div",I.mergeProps({class:r.cx("listContainer"),style:{"max-height":s.virtualScrollerDisabled?r.scrollHeight:""}},r.ptm("listContainer")),[I.createVNode(C,I.mergeProps({ref:s.virtualScrollerRef},r.virtualScrollerOptions,{items:s.visibleOptions,style:{height:r.scrollHeight},tabindex:-1,disabled:s.virtualScrollerDisabled,pt:r.ptm("virtualScroller")}),I.createSlots({content:I.withCtx(function(D){var V=D.styleClass,W=D.contentRef,z=D.items,$=D.getItemOptions,te=D.contentStyle,le=D.itemSize;return[I.createElementVNode("ul",I.mergeProps({ref:function(se){return s.listRef(se,W)},id:r.$id+"_list",class:[r.cx("list"),V],style:te,role:"listbox"},r.ptm("list")),[(I.openBlock(!0),I.createElementBlock(I.Fragment,null,I.renderList(z,function(_e,se){return I.openBlock(),I.createElementBlock(I.Fragment,{key:s.getOptionRenderKey(_e,s.getOptionIndex(se,$))},[s.isOptionGroup(_e)?(I.openBlock(),I.createElementBlock("li",I.mergeProps({key:0,id:r.$id+"_"+s.getOptionIndex(se,$),style:{height:le?le+"px":void 0},class:r.cx("optionGroup"),role:"option"},{ref_for:!0},r.ptm("optionGroup")),[I.renderSlot(r.$slots,"optiongroup",{option:_e.optionGroup,index:s.getOptionIndex(se,$)},function(){return[I.createElementVNode("span",I.mergeProps({class:r.cx("optionGroupLabel")},{ref_for:!0},r.ptm("optionGroupLabel")),I.toDisplayString(s.getOptionGroupLabel(_e.optionGroup)),17)]})],16,_7e)):I.withDirectives((I.openBlock(),I.createElementBlock("li",I.mergeProps({key:1,id:r.$id+"_"+s.getOptionIndex(se,$),class:r.cx("option",{option:_e,focusedOption:s.getOptionIndex(se,$)}),style:{height:le?le+"px":void 0},role:"option","aria-label":s.getOptionLabel(_e),"aria-selected":s.isSelected(_e),"aria-disabled":s.isOptionDisabled(_e),"aria-setsize":s.ariaSetSize,"aria-posinset":s.getAriaPosInset(s.getOptionIndex(se,$)),onMousedown:function(ce){return s.onOptionSelect(ce,_e)},onMousemove:function(ce){return s.onOptionMouseMove(ce,s.getOptionIndex(se,$))},onClick:e[8]||(e[8]=I.withModifiers(function(){},["stop"])),"data-p-selected":!r.checkmark&&s.isSelected(_e),"data-p-focused":i.focusedOptionIndex===s.getOptionIndex(se,$),"data-p-disabled":s.isOptionDisabled(_e)},{ref_for:!0},s.getPTItemOptions(_e,$,se,"option")),[r.checkmark?(I.openBlock(),I.createElementBlock(I.Fragment,{key:0},[s.isSelected(_e)?(I.openBlock(),I.createBlock(y,I.mergeProps({key:0,class:r.cx("optionCheckIcon")},{ref_for:!0},r.ptm("optionCheckIcon")),null,16,["class"])):(I.openBlock(),I.createBlock(A,I.mergeProps({key:1,class:r.cx("optionBlankIcon")},{ref_for:!0},r.ptm("optionBlankIcon")),null,16,["class"]))],64)):I.createCommentVNode("",!0),I.renderSlot(r.$slots,"option",{option:_e,selected:s.isSelected(_e),index:s.getOptionIndex(se,$)},function(){return[I.createElementVNode("span",I.mergeProps({class:r.cx("optionLabel")},{ref_for:!0},r.ptm("optionLabel")),I.toDisplayString(s.getOptionLabel(_e)),17)]})],16,v7e)),[[k]])],64)}),128)),i.filterValue&&(!z||z&&z.length===0)?(I.openBlock(),I.createElementBlock("li",I.mergeProps({key:0,class:r.cx("emptyMessage"),role:"option"},r.ptm("emptyMessage"),{"data-p-hidden-accessible":!0}),[I.renderSlot(r.$slots,"emptyfilter",{},function(){return[I.createTextVNode(I.toDisplayString(s.emptyFilterMessageText),1)]})],16)):!r.options||r.options&&r.options.length===0?(I.openBlock(),I.createElementBlock("li",I.mergeProps({key:1,class:r.cx("emptyMessage"),role:"option"},r.ptm("emptyMessage"),{"data-p-hidden-accessible":!0}),[I.renderSlot(r.$slots,"empty",{},function(){return[I.createTextVNode(I.toDisplayString(s.emptyMessageText),1)]})],16)):I.createCommentVNode("",!0)],16,b7e)]}),_:2},[r.$slots.loader?{name:"loader",fn:I.withCtx(function(D){var V=D.options;return[I.renderSlot(r.$slots,"loader",{options:V})]}),key:"0"}:void 0]),1040,["items","style","disabled","pt"])],16),I.renderSlot(r.$slots,"footer",{value:r.d_value,options:s.visibleOptions}),!r.options||r.options&&r.options.length===0?(I.openBlock(),I.createElementBlock("span",I.mergeProps({key:1,role:"status","aria-live":"polite",class:"p-hidden-accessible"},r.ptm("hiddenEmptyMessage"),{"data-p-hidden-accessible":!0}),I.toDisplayString(s.emptyMessageText),17)):I.createCommentVNode("",!0),I.createElementVNode("span",I.mergeProps({role:"status","aria-live":"polite",class:"p-hidden-accessible"},r.ptm("hiddenSelectedMessage"),{"data-p-hidden-accessible":!0}),I.toDisplayString(s.selectedMessageText),17),I.createElementVNode("span",I.mergeProps({ref:"lastHiddenFocusableElementOnOverlay",role:"presentation","aria-hidden":"true",class:"p-hidden-accessible p-hidden-focusable",tabindex:0,onFocus:e[9]||(e[9]=function(){return s.onLastHiddenFocus&&s.onLastHiddenFocus.apply(s,arguments)})},r.ptm("hiddenLastFocusableEl"),{"data-p-hidden-accessible":!0,"data-p-hidden-focusable":!0}),null,16)],16,y7e)):I.createCommentVNode("",!0)]}),_:3},16,["onEnter","onAfterEnter","onLeave","onAfterLeave"])]}),_:3},8,["appendTo"])],16,p7e)}rp.render=A7e;var RZ={name:"AngleDownIcon",extends:gi};function x7e(r){return S7e(r)||T7e(r)||C7e(r)||w7e()}function w7e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function C7e(r,e){if(r){if(typeof r=="string")return VM(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?VM(r,e):void 0}}function T7e(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function S7e(r){if(Array.isArray(r))return VM(r)}function VM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function E7e(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),x7e(e[0]||(e[0]=[I.createElementVNode("path",{d:"M3.58659 4.5007C3.68513 4.50023 3.78277 4.51945 3.87379 4.55723C3.9648 4.59501 4.04735 4.65058 4.11659 4.7207L7.11659 7.7207L10.1166 4.7207C10.2619 4.65055 10.4259 4.62911 10.5843 4.65956C10.7427 4.69002 10.8871 4.77074 10.996 4.88976C11.1049 5.00877 11.1726 5.15973 11.1889 5.32022C11.2052 5.48072 11.1693 5.6422 11.0866 5.7807L7.58659 9.2807C7.44597 9.42115 7.25534 9.50004 7.05659 9.50004C6.85784 9.50004 6.66722 9.42115 6.52659 9.2807L3.02659 5.7807C2.88614 5.64007 2.80725 5.44945 2.80725 5.2507C2.80725 5.05195 2.88614 4.86132 3.02659 4.7207C3.09932 4.64685 3.18675 4.58911 3.28322 4.55121C3.37969 4.51331 3.48305 4.4961 3.58659 4.5007Z",fill:"currentColor"},null,-1)])),16)}RZ.render=E7e;var kZ={name:"AngleUpIcon",extends:gi};function I7e(r){return R7e(r)||M7e(r)||B7e(r)||P7e()}function P7e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function B7e(r,e){if(r){if(typeof r=="string")return $M(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?$M(r,e):void 0}}function M7e(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function R7e(r){if(Array.isArray(r))return $M(r)}function $M(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function k7e(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),I7e(e[0]||(e[0]=[I.createElementVNode("path",{d:"M10.4134 9.49931C10.3148 9.49977 10.2172 9.48055 10.1262 9.44278C10.0352 9.405 9.95263 9.34942 9.88338 9.27931L6.88338 6.27931L3.88338 9.27931C3.73811 9.34946 3.57409 9.3709 3.41567 9.34044C3.25724 9.30999 3.11286 9.22926 3.00395 9.11025C2.89504 8.99124 2.82741 8.84028 2.8111 8.67978C2.79478 8.51928 2.83065 8.35781 2.91338 8.21931L6.41338 4.71931C6.55401 4.57886 6.74463 4.49997 6.94338 4.49997C7.14213 4.49997 7.33276 4.57886 7.47338 4.71931L10.9734 8.21931C11.1138 8.35994 11.1927 8.55056 11.1927 8.74931C11.1927 8.94806 11.1138 9.13868 10.9734 9.27931C10.9007 9.35315 10.8132 9.41089 10.7168 9.44879C10.6203 9.48669 10.5169 9.5039 10.4134 9.49931Z",fill:"currentColor"},null,-1)])),16)}kZ.render=k7e;var O7e=`
    .p-inputnumber {
        display: inline-flex;
        position: relative;
    }

    .p-inputnumber-button {
        display: flex;
        align-items: center;
        justify-content: center;
        flex: 0 0 auto;
        cursor: pointer;
        background: dt('inputnumber.button.background');
        color: dt('inputnumber.button.color');
        width: dt('inputnumber.button.width');
        transition:
            background dt('inputnumber.transition.duration'),
            color dt('inputnumber.transition.duration'),
            border-color dt('inputnumber.transition.duration'),
            outline-color dt('inputnumber.transition.duration');
    }

    .p-inputnumber-button:disabled {
        cursor: auto;
    }

    .p-inputnumber-button:not(:disabled):hover {
        background: dt('inputnumber.button.hover.background');
        color: dt('inputnumber.button.hover.color');
    }

    .p-inputnumber-button:not(:disabled):active {
        background: dt('inputnumber.button.active.background');
        color: dt('inputnumber.button.active.color');
    }

    .p-inputnumber-stacked .p-inputnumber-button {
        position: relative;
        flex: 1 1 auto;
        border: 0 none;
    }

    .p-inputnumber-stacked .p-inputnumber-button-group {
        display: flex;
        flex-direction: column;
        position: absolute;
        inset-block-start: 1px;
        inset-inline-end: 1px;
        height: calc(100% - 2px);
        z-index: 1;
    }

    .p-inputnumber-stacked .p-inputnumber-increment-button {
        padding: 0;
        border-start-end-radius: calc(dt('inputnumber.button.border.radius') - 1px);
    }

    .p-inputnumber-stacked .p-inputnumber-decrement-button {
        padding: 0;
        border-end-end-radius: calc(dt('inputnumber.button.border.radius') - 1px);
    }

    .p-inputnumber-stacked .p-inputnumber-input {
        padding-inline-end: calc(dt('inputnumber.button.width') + dt('form.field.padding.x'));
    }

    .p-inputnumber-horizontal .p-inputnumber-button {
        border: 1px solid dt('inputnumber.button.border.color');
    }

    .p-inputnumber-horizontal .p-inputnumber-button:hover {
        border-color: dt('inputnumber.button.hover.border.color');
    }

    .p-inputnumber-horizontal .p-inputnumber-button:active {
        border-color: dt('inputnumber.button.active.border.color');
    }

    .p-inputnumber-horizontal .p-inputnumber-increment-button {
        order: 3;
        border-start-end-radius: dt('inputnumber.button.border.radius');
        border-end-end-radius: dt('inputnumber.button.border.radius');
        border-inline-start: 0 none;
    }

    .p-inputnumber-horizontal .p-inputnumber-input {
        order: 2;
        border-radius: 0;
    }

    .p-inputnumber-horizontal .p-inputnumber-decrement-button {
        order: 1;
        border-start-start-radius: dt('inputnumber.button.border.radius');
        border-end-start-radius: dt('inputnumber.button.border.radius');
        border-inline-end: 0 none;
    }

    .p-floatlabel:has(.p-inputnumber-horizontal) label {
        margin-inline-start: dt('inputnumber.button.width');
    }

    .p-inputnumber-vertical {
        flex-direction: column;
    }

    .p-inputnumber-vertical .p-inputnumber-button {
        border: 1px solid dt('inputnumber.button.border.color');
        padding: dt('inputnumber.button.vertical.padding');
    }

    .p-inputnumber-vertical .p-inputnumber-button:hover {
        border-color: dt('inputnumber.button.hover.border.color');
    }

    .p-inputnumber-vertical .p-inputnumber-button:active {
        border-color: dt('inputnumber.button.active.border.color');
    }

    .p-inputnumber-vertical .p-inputnumber-increment-button {
        order: 1;
        border-start-start-radius: dt('inputnumber.button.border.radius');
        border-start-end-radius: dt('inputnumber.button.border.radius');
        width: 100%;
        border-block-end: 0 none;
    }

    .p-inputnumber-vertical .p-inputnumber-input {
        order: 2;
        border-radius: 0;
        text-align: center;
    }

    .p-inputnumber-vertical .p-inputnumber-decrement-button {
        order: 3;
        border-end-start-radius: dt('inputnumber.button.border.radius');
        border-end-end-radius: dt('inputnumber.button.border.radius');
        width: 100%;
        border-block-start: 0 none;
    }

    .p-inputnumber-input {
        flex: 1 1 auto;
    }

    .p-inputnumber-fluid {
        width: 100%;
    }

    .p-inputnumber-fluid .p-inputnumber-input {
        width: 1%;
    }

    .p-inputnumber-fluid.p-inputnumber-vertical .p-inputnumber-input {
        width: 100%;
    }

    .p-inputnumber:has(.p-inputtext-sm) .p-inputnumber-button .p-icon {
        font-size: dt('form.field.sm.font.size');
        width: dt('form.field.sm.font.size');
        height: dt('form.field.sm.font.size');
    }

    .p-inputnumber:has(.p-inputtext-lg) .p-inputnumber-button .p-icon {
        font-size: dt('form.field.lg.font.size');
        width: dt('form.field.lg.font.size');
        height: dt('form.field.lg.font.size');
    }

    .p-inputnumber-clear-icon {
        position: absolute;
        top: 50%;
        margin-top: -0.5rem;
        cursor: pointer;
        inset-inline-end: dt('form.field.padding.x');
        color: dt('form.field.icon.color');
    }

    .p-inputnumber:has(.p-inputnumber-clear-icon) .p-inputnumber-input {
        padding-inline-end: calc((dt('form.field.padding.x') * 2) + dt('icon.size'));
    }

    .p-inputnumber-stacked .p-inputnumber-clear-icon {
        inset-inline-end: calc(dt('inputnumber.button.width') + dt('form.field.padding.x'));
    }

    .p-inputnumber-stacked:has(.p-inputnumber-clear-icon) .p-inputnumber-input {
        padding-inline-end: calc(dt('inputnumber.button.width') + (dt('form.field.padding.x') * 2) + dt('icon.size'));
    }

    .p-inputnumber-horizontal .p-inputnumber-clear-icon {
        inset-inline-end: calc(dt('inputnumber.button.width') + dt('form.field.padding.x'));
    }
`,D7e={root:function(e){var t=e.instance,n=e.props;return["p-inputnumber p-component p-inputwrapper",{"p-invalid":t.$invalid,"p-inputwrapper-filled":t.$filled||n.allowEmpty===!1,"p-inputwrapper-focus":t.focused,"p-inputnumber-stacked":n.showButtons&&n.buttonLayout==="stacked","p-inputnumber-horizontal":n.showButtons&&n.buttonLayout==="horizontal","p-inputnumber-vertical":n.showButtons&&n.buttonLayout==="vertical","p-inputnumber-fluid":t.$fluid}]},pcInputText:"p-inputnumber-input",clearIcon:"p-inputnumber-clear-icon",buttonGroup:"p-inputnumber-button-group",incrementButton:function(e){var t=e.instance,n=e.props;return["p-inputnumber-button p-inputnumber-increment-button",{"p-disabled":n.showButtons&&n.max!==null&&t.maxBoundry()}]},decrementButton:function(e){var t=e.instance,n=e.props;return["p-inputnumber-button p-inputnumber-decrement-button",{"p-disabled":n.showButtons&&n.min!==null&&t.minBoundry()}]}},L7e=cn.extend({name:"inputnumber",style:O7e,classes:D7e}),N7e={name:"BaseInputNumber",extends:lA,props:{format:{type:Boolean,default:!0},showButtons:{type:Boolean,default:!1},buttonLayout:{type:String,default:"stacked"},incrementButtonClass:{type:String,default:null},decrementButtonClass:{type:String,default:null},incrementButtonIcon:{type:String,default:void 0},incrementIcon:{type:String,default:void 0},decrementButtonIcon:{type:String,default:void 0},decrementIcon:{type:String,default:void 0},locale:{type:String,default:void 0},localeMatcher:{type:String,default:void 0},mode:{type:String,default:"decimal"},prefix:{type:String,default:null},suffix:{type:String,default:null},currency:{type:String,default:void 0},currencyDisplay:{type:String,default:void 0},useGrouping:{type:Boolean,default:!0},minFractionDigits:{type:Number,default:void 0},maxFractionDigits:{type:Number,default:void 0},roundingMode:{type:String,default:"halfExpand",validator:function(e){return["ceil","floor","expand","trunc","halfCeil","halfFloor","halfExpand","halfTrunc","halfEven"].includes(e)}},min:{type:Number,default:null},max:{type:Number,default:null},step:{type:Number,default:1},allowEmpty:{type:Boolean,default:!0},highlightOnFocus:{type:Boolean,default:!1},showClear:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},placeholder:{type:String,default:null},inputId:{type:String,default:null},inputClass:{type:[String,Object],default:null},inputStyle:{type:Object,default:null},ariaLabelledby:{type:String,default:null},ariaLabel:{type:String,default:null},required:{type:Boolean,default:!1}},style:L7e,provide:function(){return{$pcInputNumber:this,$parentInstance:this}}};function _v(r){"@babel/helpers - typeof";return _v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_v(r)}function ZV(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function QV(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ZV(Object(t),!0).forEach(function(n){jM(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ZV(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function jM(r,e,t){return(e=F7e(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function F7e(r){var e=U7e(r,"string");return _v(e)=="symbol"?e:e+""}function U7e(r,e){if(_v(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(_v(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function z7e(r){return G7e(r)||j7e(r)||$7e(r)||V7e()}function V7e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $7e(r,e){if(r){if(typeof r=="string")return GM(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?GM(r,e):void 0}}function j7e(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function G7e(r){if(Array.isArray(r))return GM(r)}function GM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}var OZ={name:"InputNumber",extends:N7e,inheritAttrs:!1,emits:["input","focus","blur"],inject:{$pcFluid:{default:null}},numberFormat:null,_numeral:null,_decimal:null,_group:null,_minusSign:null,_currency:null,_suffix:null,_prefix:null,_index:null,groupChar:"",isSpecialChar:null,prefixChar:null,suffixChar:null,timer:null,data:function(){return{d_modelValue:this.d_value,focused:!1}},watch:{d_value:{immediate:!0,handler:function(e){var t;this.d_modelValue=e,(t=this.$refs.clearIcon)!==null&&t!==void 0&&(t=t.$el)!==null&&t!==void 0&&t.style&&(this.$refs.clearIcon.$el.style.display=pa(e)?"none":"block")}},locale:function(e,t){this.updateConstructParser(e,t)},localeMatcher:function(e,t){this.updateConstructParser(e,t)},mode:function(e,t){this.updateConstructParser(e,t)},currency:function(e,t){this.updateConstructParser(e,t)},currencyDisplay:function(e,t){this.updateConstructParser(e,t)},useGrouping:function(e,t){this.updateConstructParser(e,t)},minFractionDigits:function(e,t){this.updateConstructParser(e,t)},maxFractionDigits:function(e,t){this.updateConstructParser(e,t)},suffix:function(e,t){this.updateConstructParser(e,t)},prefix:function(e,t){this.updateConstructParser(e,t)}},created:function(){this.constructParser()},mounted:function(){var e;(e=this.$refs.clearIcon)!==null&&e!==void 0&&(e=e.$el)!==null&&e!==void 0&&e.style&&(this.$refs.clearIcon.$el.style.display=this.$filled?"block":"none")},methods:{getOptions:function(){return{localeMatcher:this.localeMatcher,style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,useGrouping:this.useGrouping,minimumFractionDigits:this.minFractionDigits,maximumFractionDigits:this.maxFractionDigits,roundingMode:this.roundingMode}},constructParser:function(){this.numberFormat=new Intl.NumberFormat(this.locale,this.getOptions());var e=z7e(new Intl.NumberFormat(this.locale,{useGrouping:!1}).format(9876543210)).reverse(),t=new Map(e.map(function(n,i){return[n,i]}));this._numeral=new RegExp("[".concat(e.join(""),"]"),"g"),this._group=this.getGroupingExpression(),this._minusSign=this.getMinusSignExpression(),this._currency=this.getCurrencyExpression(),this._decimal=this.getDecimalExpression(),this._suffix=this.getSuffixExpression(),this._prefix=this.getPrefixExpression(),this._index=function(n){return t.get(n)}},updateConstructParser:function(e,t){e!==t&&this.constructParser()},escapeRegExp:function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},getDecimalExpression:function(){var e=new Intl.NumberFormat(this.locale,QV(QV({},this.getOptions()),{},{useGrouping:!1}));return new RegExp("[".concat(e.format(1.1).replace(this._currency,"").trim().replace(this._numeral,""),"]"),"g")},getGroupingExpression:function(){var e=new Intl.NumberFormat(this.locale,{useGrouping:!0});return this.groupChar=e.format(1e6).trim().replace(this._numeral,"").charAt(0),new RegExp("[".concat(this.groupChar,"]"),"g")},getMinusSignExpression:function(){var e=new Intl.NumberFormat(this.locale,{useGrouping:!1});return new RegExp("[".concat(e.format(-1).trim().replace(this._numeral,""),"]"),"g")},getCurrencyExpression:function(){if(this.currency){var e=new Intl.NumberFormat(this.locale,{style:"currency",currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0,roundingMode:this.roundingMode});return new RegExp("[".concat(e.format(1).replace(/\s/g,"").replace(this._numeral,"").replace(this._group,""),"]"),"g")}return new RegExp("[]","g")},getPrefixExpression:function(){if(this.prefix)this.prefixChar=this.prefix;else{var e=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay});this.prefixChar=e.format(1).split("1")[0]}return new RegExp("".concat(this.escapeRegExp(this.prefixChar||"")),"g")},getSuffixExpression:function(){if(this.suffix)this.suffixChar=this.suffix;else{var e=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0,roundingMode:this.roundingMode});this.suffixChar=e.format(1).split("1")[1]}return new RegExp("".concat(this.escapeRegExp(this.suffixChar||"")),"g")},formatValue:function(e){if(e!=null){if(e==="-")return e;if(this.format){var t=new Intl.NumberFormat(this.locale,this.getOptions()),n=t.format(e);return this.prefix&&(n=this.prefix+n),this.suffix&&(n=n+this.suffix),n}return e.toString()}return""},parseValue:function(e){var t=e.replace(this._suffix,"").replace(this._prefix,"").trim().replace(/\s/g,"").replace(this._currency,"").replace(this._group,"").replace(this._minusSign,"-").replace(this._decimal,".").replace(this._numeral,this._index);if(t){if(t==="-")return t;var n=+t;return isNaN(n)?null:n}return null},repeat:function(e,t,n){var i=this;if(!this.readonly){var s=t||500;this.clearTimer(),this.timer=setTimeout(function(){i.repeat(e,40,n)},s),this.spin(e,n)}},addWithPrecision:function(e,t){var n=e.toString(),i=t.toString(),s=n.includes(".")?n.split(".")[1].length:0,a=i.includes(".")?i.split(".")[1].length:0,o=Math.max(s,a),u=Math.pow(10,o);return Math.round((e+t)*u)/u},spin:function(e,t){if(this.$refs.input){var n=this.step*t,i=this.parseValue(this.$refs.input.$el.value)||0,s=this.validateValue(this.addWithPrecision(i,n));this.updateInput(s,null,"spin"),this.updateModel(e,s),this.handleOnInput(e,i,s)}},onUpButtonMouseDown:function(e){this.disabled||(this.$refs.input.$el.focus(),this.repeat(e,null,1),e.preventDefault())},onUpButtonMouseUp:function(){this.disabled||this.clearTimer()},onUpButtonMouseLeave:function(){this.disabled||this.clearTimer()},onUpButtonKeyUp:function(){this.disabled||this.clearTimer()},onUpButtonKeyDown:function(e){(e.code==="Space"||e.code==="Enter"||e.code==="NumpadEnter")&&this.repeat(e,null,1)},onDownButtonMouseDown:function(e){this.disabled||(this.$refs.input.$el.focus(),this.repeat(e,null,-1),e.preventDefault())},onDownButtonMouseUp:function(){this.disabled||this.clearTimer()},onDownButtonMouseLeave:function(){this.disabled||this.clearTimer()},onDownButtonKeyUp:function(){this.disabled||this.clearTimer()},onDownButtonKeyDown:function(e){(e.code==="Space"||e.code==="Enter"||e.code==="NumpadEnter")&&this.repeat(e,null,-1)},onUserInput:function(){this.isSpecialChar&&(this.$refs.input.$el.value=this.lastValue),this.isSpecialChar=!1},onInputKeyDown:function(e){if(!this.readonly&&!e.isComposing){if(e.altKey||e.ctrlKey||e.metaKey){this.isSpecialChar=!0,this.lastValue=this.$refs.input.$el.value;return}this.lastValue=e.target.value;var t=e.target.selectionStart,n=e.target.selectionEnd,i=n-t,s=e.target.value,a=null,o=e.code||e.key;switch(o){case"ArrowUp":this.spin(e,1),e.preventDefault();break;case"ArrowDown":this.spin(e,-1),e.preventDefault();break;case"ArrowLeft":if(i>1){var u=this.isNumeralChar(s.charAt(t))?t+1:t+2;this.$refs.input.$el.setSelectionRange(u,u)}else this.isNumeralChar(s.charAt(t-1))||e.preventDefault();break;case"ArrowRight":if(i>1){var f=n-1;this.$refs.input.$el.setSelectionRange(f,f)}else this.isNumeralChar(s.charAt(t))||e.preventDefault();break;case"Tab":case"Enter":case"NumpadEnter":a=this.validateValue(this.parseValue(s)),this.$refs.input.$el.value=this.formatValue(a),this.$refs.input.$el.setAttribute("aria-valuenow",a),this.updateModel(e,a);break;case"Backspace":{if(e.preventDefault(),t===n){t>=s.length&&this.suffixChar!==null&&(t=s.length-this.suffixChar.length,this.$refs.input.$el.setSelectionRange(t,t));var g=s.charAt(t-1),y=this.getDecimalCharIndexes(s),A=y.decimalCharIndex,C=y.decimalCharIndexWithoutPrefix;if(this.isNumeralChar(g)){var M=this.getDecimalLength(s);if(this._group.test(g))this._group.lastIndex=0,a=s.slice(0,t-2)+s.slice(t-1);else if(this._decimal.test(g))this._decimal.lastIndex=0,M?this.$refs.input.$el.setSelectionRange(t-1,t-1):a=s.slice(0,t-1)+s.slice(t);else if(A>0&&t>A){var k=this.isDecimalMode()&&(this.minFractionDigits||0)<M?"":"0";a=s.slice(0,t-1)+k+s.slice(t)}else C===1?(a=s.slice(0,t-1)+"0"+s.slice(t),a=this.parseValue(a)>0?a:""):a=s.slice(0,t-1)+s.slice(t)}this.updateValue(e,a,null,"delete-single")}else a=this.deleteRange(s,t,n),this.updateValue(e,a,null,"delete-range");break}case"Delete":if(e.preventDefault(),t===n){var D=s.charAt(t),V=this.getDecimalCharIndexes(s),W=V.decimalCharIndex,z=V.decimalCharIndexWithoutPrefix;if(this.isNumeralChar(D)){var $=this.getDecimalLength(s);if(this._group.test(D))this._group.lastIndex=0,a=s.slice(0,t)+s.slice(t+2);else if(this._decimal.test(D))this._decimal.lastIndex=0,$?this.$refs.input.$el.setSelectionRange(t+1,t+1):a=s.slice(0,t)+s.slice(t+1);else if(W>0&&t>W){var te=this.isDecimalMode()&&(this.minFractionDigits||0)<$?"":"0";a=s.slice(0,t)+te+s.slice(t+1)}else z===1?(a=s.slice(0,t)+"0"+s.slice(t+1),a=this.parseValue(a)>0?a:""):a=s.slice(0,t)+s.slice(t+1)}this.updateValue(e,a,null,"delete-back-single")}else a=this.deleteRange(s,t,n),this.updateValue(e,a,null,"delete-range");break;case"Home":e.preventDefault(),Xr(this.min)&&this.updateModel(e,this.min);break;case"End":e.preventDefault(),Xr(this.max)&&this.updateModel(e,this.max);break}}},onInputKeyPress:function(e){if(!this.readonly){var t=e.key,n=this.isDecimalSign(t),i=this.isMinusSign(t);e.code!=="Enter"&&e.preventDefault(),(Number(t)>=0&&Number(t)<=9||i||n)&&this.insert(e,t,{isDecimalSign:n,isMinusSign:i})}},onPaste:function(e){if(!this.readonly){e.preventDefault();var t=(e.clipboardData||window.clipboardData).getData("Text");if(!(this.inputId==="integeronly"&&/[^\d-]/.test(t))&&t){var n=this.parseValue(t);n!=null&&this.insert(e,n.toString())}}},onClearClick:function(e){this.updateModel(e,null),this.$refs.input.$el.focus()},allowMinusSign:function(){return this.min===null||this.min<0},isMinusSign:function(e){return this._minusSign.test(e)||e==="-"?(this._minusSign.lastIndex=0,!0):!1},isDecimalSign:function(e){var t;return(t=this.locale)!==null&&t!==void 0&&t.includes("fr")&&[".",","].includes(e)||this._decimal.test(e)?(this._decimal.lastIndex=0,!0):!1},isDecimalMode:function(){return this.mode==="decimal"},getDecimalCharIndexes:function(e){var t=e.search(this._decimal);this._decimal.lastIndex=0;var n=e.replace(this._prefix,"").trim().replace(/\s/g,"").replace(this._currency,""),i=n.search(this._decimal);return this._decimal.lastIndex=0,{decimalCharIndex:t,decimalCharIndexWithoutPrefix:i}},getCharIndexes:function(e){var t=e.search(this._decimal);this._decimal.lastIndex=0;var n=e.search(this._minusSign);this._minusSign.lastIndex=0;var i=e.search(this._suffix);this._suffix.lastIndex=0;var s=e.search(this._currency);return this._currency.lastIndex=0,{decimalCharIndex:t,minusCharIndex:n,suffixCharIndex:i,currencyCharIndex:s}},insert:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{isDecimalSign:!1,isMinusSign:!1},i=t.search(this._minusSign);if(this._minusSign.lastIndex=0,!(!this.allowMinusSign()&&i!==-1)){var s=this.$refs.input.$el.selectionStart,a=this.$refs.input.$el.selectionEnd,o=this.$refs.input.$el.value.trim(),u=this.getCharIndexes(o),f=u.decimalCharIndex,g=u.minusCharIndex,y=u.suffixCharIndex,A=u.currencyCharIndex,C;if(n.isMinusSign){var M=g===-1;(s===0||s===A+1)&&(C=o,(M||a!==0)&&(C=this.insertText(o,t,0,a)),this.updateValue(e,C,t,"insert"))}else if(n.isDecimalSign)f>0&&s===f?this.updateValue(e,o,t,"insert"):f>s&&f<a?(C=this.insertText(o,t,s,a),this.updateValue(e,C,t,"insert")):f===-1&&this.maxFractionDigits&&(C=this.insertText(o,t,s,a),this.updateValue(e,C,t,"insert"));else{var k=this.numberFormat.resolvedOptions().maximumFractionDigits,D=s!==a?"range-insert":"insert";if(f>0&&s>f){if(s+t.length-(f+1)<=k){var V=A>=s?A-1:y>=s?y:o.length;C=o.slice(0,s)+t+o.slice(s+t.length,V)+o.slice(V),this.updateValue(e,C,t,D)}}else C=this.insertText(o,t,s,a),this.updateValue(e,C,t,D)}}},insertText:function(e,t,n,i){var s=t==="."?t:t.split(".");if(s.length===2){var a=e.slice(n,i).search(this._decimal);return this._decimal.lastIndex=0,a>0?e.slice(0,n)+this.formatValue(t)+e.slice(i):this.formatValue(t)||e}else return i-n===e.length?this.formatValue(t):n===0?t+e.slice(i):i===e.length?e.slice(0,n)+t:e.slice(0,n)+t+e.slice(i)},deleteRange:function(e,t,n){var i;return n-t===e.length?i="":t===0?i=e.slice(n):n===e.length?i=e.slice(0,t):i=e.slice(0,t)+e.slice(n),i},initCursor:function(){var e=this.$refs.input.$el.selectionStart,t=this.$refs.input.$el.value,n=t.length,i=null,s=(this.prefixChar||"").length;t=t.replace(this._prefix,""),e=e-s;var a=t.charAt(e);if(this.isNumeralChar(a))return e+s;for(var o=e-1;o>=0;)if(a=t.charAt(o),this.isNumeralChar(a)){i=o+s;break}else o--;if(i!==null)this.$refs.input.$el.setSelectionRange(i+1,i+1);else{for(o=e;o<n;)if(a=t.charAt(o),this.isNumeralChar(a)){i=o+s;break}else o++;i!==null&&this.$refs.input.$el.setSelectionRange(i,i)}return i||0},onInputClick:function(){var e=this.$refs.input.$el.value;!this.readonly&&e!==yV()&&this.initCursor()},isNumeralChar:function(e){return e.length===1&&(this._numeral.test(e)||this._decimal.test(e)||this._group.test(e)||this._minusSign.test(e))?(this.resetRegex(),!0):!1},resetRegex:function(){this._numeral.lastIndex=0,this._decimal.lastIndex=0,this._group.lastIndex=0,this._minusSign.lastIndex=0},updateValue:function(e,t,n,i){var s=this.$refs.input.$el.value,a=null;t!=null&&(a=this.parseValue(t),a=!a&&!this.allowEmpty?0:a,this.updateInput(a,n,i,t),this.handleOnInput(e,s,a))},handleOnInput:function(e,t,n){if(this.isValueChanged(t,n)){var i,s;this.$emit("input",{originalEvent:e,value:n,formattedValue:t}),(i=(s=this.formField).onInput)===null||i===void 0||i.call(s,{originalEvent:e,value:n})}},isValueChanged:function(e,t){if(t===null&&e!==null)return!0;if(t!=null){var n=typeof e=="string"?this.parseValue(e):e;return t!==n}return!1},validateValue:function(e){return e==="-"||e==null?null:this.min!=null&&e<this.min?this.min:this.max!=null&&e>this.max?this.max:e},updateInput:function(e,t,n,i){var s;t=t||"";var a=this.$refs.input.$el.value,o=this.formatValue(e),u=a.length;if(o!==i&&(o=this.concatValues(o,i)),u===0){this.$refs.input.$el.value=o,this.$refs.input.$el.setSelectionRange(0,0);var f=this.initCursor(),g=f+t.length;this.$refs.input.$el.setSelectionRange(g,g)}else{var y=this.$refs.input.$el.selectionStart,A=this.$refs.input.$el.selectionEnd;this.$refs.input.$el.value=o;var C=o.length;if(n==="range-insert"){var M=this.parseValue((a||"").slice(0,y)),k=M!==null?M.toString():"",D=k.split("").join("(".concat(this.groupChar,")?")),V=new RegExp(D,"g");V.test(o);var W=t.split("").join("(".concat(this.groupChar,")?")),z=new RegExp(W,"g");z.test(o.slice(V.lastIndex)),A=V.lastIndex+z.lastIndex,this.$refs.input.$el.setSelectionRange(A,A)}else if(C===u)n==="insert"||n==="delete-back-single"?this.$refs.input.$el.setSelectionRange(A+1,A+1):n==="delete-single"?this.$refs.input.$el.setSelectionRange(A-1,A-1):(n==="delete-range"||n==="spin")&&this.$refs.input.$el.setSelectionRange(A,A);else if(n==="delete-back-single"){var $=a.charAt(A-1),te=a.charAt(A),le=u-C,_e=this._group.test(te);_e&&le===1?A+=1:!_e&&this.isNumeralChar($)&&(A+=-1*le+1),this._group.lastIndex=0,this.$refs.input.$el.setSelectionRange(A,A)}else if(a==="-"&&n==="insert"){this.$refs.input.$el.setSelectionRange(0,0);var se=this.initCursor(),Y=se+t.length+1;this.$refs.input.$el.setSelectionRange(Y,Y)}else A=A+(C-u),this.$refs.input.$el.setSelectionRange(A,A)}this.$refs.input.$el.setAttribute("aria-valuenow",e),(s=this.$refs.clearIcon)!==null&&s!==void 0&&(s=s.$el)!==null&&s!==void 0&&s.style&&(this.$refs.clearIcon.$el.style.display=pa(o)?"none":"block")},concatValues:function(e,t){if(e&&t){var n=t.search(this._decimal);return this._decimal.lastIndex=0,this.suffixChar?n!==-1?e.replace(this.suffixChar,"").split(this._decimal)[0]+t.replace(this.suffixChar,"").slice(n)+this.suffixChar:e:n!==-1?e.split(this._decimal)[0]+t.slice(n):e}return e},getDecimalLength:function(e){if(e){var t=e.split(this._decimal);if(t.length===2)return t[1].replace(this._suffix,"").trim().replace(/\s/g,"").replace(this._currency,"").length}return 0},updateModel:function(e,t){this.writeValue(t,e)},onInputFocus:function(e){this.focused=!0,!this.disabled&&!this.readonly&&this.$refs.input.$el.value!==yV()&&this.highlightOnFocus&&e.target.select(),this.$emit("focus",e)},onInputBlur:function(e){var t,n;this.focused=!1;var i=e.target,s=this.validateValue(this.parseValue(i.value));this.$emit("blur",{originalEvent:e,value:i.value}),(t=(n=this.formField).onBlur)===null||t===void 0||t.call(n,e),i.value=this.formatValue(s),i.setAttribute("aria-valuenow",s),this.updateModel(e,s),!this.disabled&&!this.readonly&&this.highlightOnFocus&&Gw()},clearTimer:function(){this.timer&&clearTimeout(this.timer)},maxBoundry:function(){return this.d_value>=this.max},minBoundry:function(){return this.d_value<=this.min}},computed:{upButtonListeners:function(){var e=this;return{mousedown:function(n){return e.onUpButtonMouseDown(n)},mouseup:function(n){return e.onUpButtonMouseUp(n)},mouseleave:function(n){return e.onUpButtonMouseLeave(n)},keydown:function(n){return e.onUpButtonKeyDown(n)},keyup:function(n){return e.onUpButtonKeyUp(n)}}},downButtonListeners:function(){var e=this;return{mousedown:function(n){return e.onDownButtonMouseDown(n)},mouseup:function(n){return e.onDownButtonMouseUp(n)},mouseleave:function(n){return e.onDownButtonMouseLeave(n)},keydown:function(n){return e.onDownButtonKeyDown(n)},keyup:function(n){return e.onDownButtonKeyUp(n)}}},formattedValue:function(){var e=!this.d_value&&!this.allowEmpty?0:this.d_value;return this.formatValue(e)},getFormatter:function(){return this.numberFormat},dataP:function(){return wo(jM(jM({invalid:this.$invalid,fluid:this.$fluid,filled:this.$variant==="filled"},this.size,this.size),this.buttonLayout,this.showButtons&&this.buttonLayout))}},components:{InputText:mv,AngleUpIcon:kZ,AngleDownIcon:RZ,TimesIcon:_2}},H7e=["data-p"],W7e=["data-p"],K7e=["disabled","data-p"],X7e=["disabled","data-p"],J7e=["disabled","data-p"],q7e=["disabled","data-p"];function Y7e(r,e,t,n,i,s){var a=I.resolveComponent("InputText"),o=I.resolveComponent("TimesIcon");return I.openBlock(),I.createElementBlock("span",I.mergeProps({class:r.cx("root")},r.ptmi("root"),{"data-p":s.dataP}),[I.createVNode(a,{ref:"input",id:r.inputId,name:r.$formName,role:"spinbutton",class:I.normalizeClass([r.cx("pcInputText"),r.inputClass]),style:I.normalizeStyle(r.inputStyle),defaultValue:s.formattedValue,"aria-valuemin":r.min,"aria-valuemax":r.max,"aria-valuenow":r.d_value,inputmode:r.mode==="decimal"&&!r.minFractionDigits?"numeric":"decimal",disabled:r.disabled,readonly:r.readonly,placeholder:r.placeholder,"aria-labelledby":r.ariaLabelledby,"aria-label":r.ariaLabel,required:r.required,size:r.size,invalid:r.invalid,variant:r.variant,onInput:s.onUserInput,onKeydown:s.onInputKeyDown,onKeypress:s.onInputKeyPress,onPaste:s.onPaste,onClick:s.onInputClick,onFocus:s.onInputFocus,onBlur:s.onInputBlur,pt:r.ptm("pcInputText"),unstyled:r.unstyled,"data-p":s.dataP},null,8,["id","name","class","style","defaultValue","aria-valuemin","aria-valuemax","aria-valuenow","inputmode","disabled","readonly","placeholder","aria-labelledby","aria-label","required","size","invalid","variant","onInput","onKeydown","onKeypress","onPaste","onClick","onFocus","onBlur","pt","unstyled","data-p"]),r.showClear&&r.buttonLayout!=="vertical"?I.renderSlot(r.$slots,"clearicon",{key:0,class:I.normalizeClass(r.cx("clearIcon")),clearCallback:s.onClearClick},function(){return[I.createVNode(o,I.mergeProps({ref:"clearIcon",class:[r.cx("clearIcon")],onClick:s.onClearClick},r.ptm("clearIcon")),null,16,["class","onClick"])]}):I.createCommentVNode("",!0),r.showButtons&&r.buttonLayout==="stacked"?(I.openBlock(),I.createElementBlock("span",I.mergeProps({key:1,class:r.cx("buttonGroup")},r.ptm("buttonGroup"),{"data-p":s.dataP}),[I.renderSlot(r.$slots,"incrementbutton",{listeners:s.upButtonListeners},function(){return[I.createElementVNode("button",I.mergeProps({class:[r.cx("incrementButton"),r.incrementButtonClass]},I.toHandlers(s.upButtonListeners,!0),{disabled:r.disabled,tabindex:-1,"aria-hidden":"true",type:"button"},r.ptm("incrementButton"),{"data-p":s.dataP}),[I.renderSlot(r.$slots,r.$slots.incrementicon?"incrementicon":"incrementbuttonicon",{},function(){return[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(r.incrementIcon||r.incrementButtonIcon?"span":"AngleUpIcon"),I.mergeProps({class:[r.incrementIcon,r.incrementButtonIcon]},r.ptm("incrementIcon"),{"data-pc-section":"incrementicon"}),null,16,["class"]))]})],16,K7e)]}),I.renderSlot(r.$slots,"decrementbutton",{listeners:s.downButtonListeners},function(){return[I.createElementVNode("button",I.mergeProps({class:[r.cx("decrementButton"),r.decrementButtonClass]},I.toHandlers(s.downButtonListeners,!0),{disabled:r.disabled,tabindex:-1,"aria-hidden":"true",type:"button"},r.ptm("decrementButton"),{"data-p":s.dataP}),[I.renderSlot(r.$slots,r.$slots.decrementicon?"decrementicon":"decrementbuttonicon",{},function(){return[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(r.decrementIcon||r.decrementButtonIcon?"span":"AngleDownIcon"),I.mergeProps({class:[r.decrementIcon,r.decrementButtonIcon]},r.ptm("decrementIcon"),{"data-pc-section":"decrementicon"}),null,16,["class"]))]})],16,X7e)]})],16,W7e)):I.createCommentVNode("",!0),I.renderSlot(r.$slots,"incrementbutton",{listeners:s.upButtonListeners},function(){return[r.showButtons&&r.buttonLayout!=="stacked"?(I.openBlock(),I.createElementBlock("button",I.mergeProps({key:0,class:[r.cx("incrementButton"),r.incrementButtonClass]},I.toHandlers(s.upButtonListeners,!0),{disabled:r.disabled,tabindex:-1,"aria-hidden":"true",type:"button"},r.ptm("incrementButton"),{"data-p":s.dataP}),[I.renderSlot(r.$slots,r.$slots.incrementicon?"incrementicon":"incrementbuttonicon",{},function(){return[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(r.incrementIcon||r.incrementButtonIcon?"span":"AngleUpIcon"),I.mergeProps({class:[r.incrementIcon,r.incrementButtonIcon]},r.ptm("incrementIcon"),{"data-pc-section":"incrementicon"}),null,16,["class"]))]})],16,J7e)):I.createCommentVNode("",!0)]}),I.renderSlot(r.$slots,"decrementbutton",{listeners:s.downButtonListeners},function(){return[r.showButtons&&r.buttonLayout!=="stacked"?(I.openBlock(),I.createElementBlock("button",I.mergeProps({key:0,class:[r.cx("decrementButton"),r.decrementButtonClass]},I.toHandlers(s.downButtonListeners,!0),{disabled:r.disabled,tabindex:-1,"aria-hidden":"true",type:"button"},r.ptm("decrementButton"),{"data-p":s.dataP}),[I.renderSlot(r.$slots,r.$slots.decrementicon?"decrementicon":"decrementbuttonicon",{},function(){return[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(r.decrementIcon||r.decrementButtonIcon?"span":"AngleDownIcon"),I.mergeProps({class:[r.decrementIcon,r.decrementButtonIcon]},r.ptm("decrementIcon"),{"data-pc-section":"decrementicon"}),null,16,["class"]))]})],16,q7e)):I.createCommentVNode("",!0)]})],16,H7e)}OZ.render=Y7e;var DZ={name:"AngleDoubleRightIcon",extends:gi};function Z7e(r){return rGe(r)||tGe(r)||eGe(r)||Q7e()}function Q7e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eGe(r,e){if(r){if(typeof r=="string")return HM(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?HM(r,e):void 0}}function tGe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function rGe(r){if(Array.isArray(r))return HM(r)}function HM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function nGe(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),Z7e(e[0]||(e[0]=[I.createElementVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7.68757 11.1451C7.7791 11.1831 7.8773 11.2024 7.9764 11.2019C8.07769 11.1985 8.17721 11.1745 8.26886 11.1312C8.36052 11.088 8.44238 11.0265 8.50943 10.9505L12.0294 7.49085C12.1707 7.34942 12.25 7.15771 12.25 6.95782C12.25 6.75794 12.1707 6.56622 12.0294 6.42479L8.50943 2.90479C8.37014 2.82159 8.20774 2.78551 8.04633 2.80192C7.88491 2.81833 7.73309 2.88635 7.6134 2.99588C7.4937 3.10541 7.41252 3.25061 7.38189 3.40994C7.35126 3.56927 7.37282 3.73423 7.44337 3.88033L10.4605 6.89748L7.44337 9.91463C7.30212 10.0561 7.22278 10.2478 7.22278 10.4477C7.22278 10.6475 7.30212 10.8393 7.44337 10.9807C7.51301 11.0512 7.59603 11.1071 7.68757 11.1451ZM1.94207 10.9505C2.07037 11.0968 2.25089 11.1871 2.44493 11.2019C2.63898 11.1871 2.81949 11.0968 2.94779 10.9505L6.46779 7.49085C6.60905 7.34942 6.68839 7.15771 6.68839 6.95782C6.68839 6.75793 6.60905 6.56622 6.46779 6.42479L2.94779 2.90479C2.80704 2.83757 2.6489 2.81563 2.49517 2.84201C2.34143 2.86839 2.19965 2.94178 2.08936 3.05207C1.97906 3.16237 1.90567 3.30415 1.8793 3.45788C1.85292 3.61162 1.87485 3.76975 1.94207 3.9105L4.95922 6.92765L1.94207 9.9448C1.81838 10.0831 1.75 10.2621 1.75 10.4477C1.75 10.6332 1.81838 10.8122 1.94207 10.9505Z",fill:"currentColor"},null,-1)])),16)}DZ.render=nGe;var LZ={name:"AngleRightIcon",extends:gi};function iGe(r){return lGe(r)||aGe(r)||oGe(r)||sGe()}function sGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oGe(r,e){if(r){if(typeof r=="string")return WM(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?WM(r,e):void 0}}function aGe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function lGe(r){if(Array.isArray(r))return WM(r)}function WM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function cGe(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),iGe(e[0]||(e[0]=[I.createElementVNode("path",{d:"M5.25 11.1728C5.14929 11.1694 5.05033 11.1455 4.9592 11.1025C4.86806 11.0595 4.78666 10.9984 4.72 10.9228C4.57955 10.7822 4.50066 10.5916 4.50066 10.3928C4.50066 10.1941 4.57955 10.0035 4.72 9.86283L7.72 6.86283L4.72 3.86283C4.66067 3.71882 4.64765 3.55991 4.68275 3.40816C4.71785 3.25642 4.79932 3.11936 4.91585 3.01602C5.03238 2.91268 5.17819 2.84819 5.33305 2.83149C5.4879 2.81479 5.64411 2.84671 5.78 2.92283L9.28 6.42283C9.42045 6.56346 9.49934 6.75408 9.49934 6.95283C9.49934 7.15158 9.42045 7.34221 9.28 7.48283L5.78 10.9228C5.71333 10.9984 5.63193 11.0595 5.5408 11.1025C5.44966 11.1455 5.35071 11.1694 5.25 11.1728Z",fill:"currentColor"},null,-1)])),16)}LZ.render=cGe;var NZ={name:"AngleLeftIcon",extends:gi};function uGe(r){return pGe(r)||fGe(r)||dGe(r)||hGe()}function hGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dGe(r,e){if(r){if(typeof r=="string")return KM(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?KM(r,e):void 0}}function fGe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function pGe(r){if(Array.isArray(r))return KM(r)}function KM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function gGe(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),uGe(e[0]||(e[0]=[I.createElementVNode("path",{d:"M8.75 11.185C8.65146 11.1854 8.55381 11.1662 8.4628 11.1284C8.37179 11.0906 8.28924 11.0351 8.22 10.965L4.72 7.46496C4.57955 7.32433 4.50066 7.13371 4.50066 6.93496C4.50066 6.73621 4.57955 6.54558 4.72 6.40496L8.22 2.93496C8.36095 2.84357 8.52851 2.80215 8.69582 2.81733C8.86312 2.83252 9.02048 2.90344 9.14268 3.01872C9.26487 3.134 9.34483 3.28696 9.36973 3.4531C9.39463 3.61924 9.36303 3.78892 9.28 3.93496L6.28 6.93496L9.28 9.93496C9.42045 10.0756 9.49934 10.2662 9.49934 10.465C9.49934 10.6637 9.42045 10.8543 9.28 10.995C9.13526 11.1257 8.9448 11.1939 8.75 11.185Z",fill:"currentColor"},null,-1)])),16)}NZ.render=gGe;var mGe={name:"BasePaginator",extends:In,props:{totalRecords:{type:Number,default:0},rows:{type:Number,default:0},first:{type:Number,default:0},pageLinkSize:{type:Number,default:5},rowsPerPageOptions:{type:Array,default:null},template:{type:[Object,String],default:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown"},currentPageReportTemplate:{type:null,default:"({currentPage} of {totalPages})"},alwaysShow:{type:Boolean,default:!0}},style:B$e,provide:function(){return{$pcPaginator:this,$parentInstance:this}}},FZ={name:"CurrentPageReport",hostName:"Paginator",extends:In,props:{pageCount:{type:Number,default:0},currentPage:{type:Number,default:0},page:{type:Number,default:0},first:{type:Number,default:0},rows:{type:Number,default:0},totalRecords:{type:Number,default:0},template:{type:String,default:"({currentPage} of {totalPages})"}},computed:{text:function(){var e=this.template.replace("{currentPage}",this.currentPage).replace("{totalPages}",this.pageCount).replace("{first}",this.pageCount>0?this.first+1:0).replace("{last}",Math.min(this.first+this.rows,this.totalRecords)).replace("{rows}",this.rows).replace("{totalRecords}",this.totalRecords);return e}}};function yGe(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("span",I.mergeProps({class:r.cx("current")},r.ptm("current")),I.toDisplayString(s.text),17)}FZ.render=yGe;var UZ={name:"FirstPageLink",hostName:"Paginator",extends:In,props:{template:{type:Function,default:null}},methods:{getPTOptions:function(e){return this.ptm(e,{context:{disabled:this.$attrs.disabled}})}},components:{AngleDoubleLeftIcon:SZ},directives:{ripple:Pd}};function bGe(r,e,t,n,i,s){var a=I.resolveDirective("ripple");return I.withDirectives((I.openBlock(),I.createElementBlock("button",I.mergeProps({class:r.cx("first"),type:"button"},s.getPTOptions("first"),{"data-pc-group-section":"pagebutton"}),[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.template||"AngleDoubleLeftIcon"),I.mergeProps({class:r.cx("firstIcon")},s.getPTOptions("firstIcon")),null,16,["class"]))],16)),[[a]])}UZ.render=bGe;var zZ={name:"JumpToPageDropdown",hostName:"Paginator",extends:In,emits:["page-change"],props:{page:Number,pageCount:Number,disabled:Boolean,templates:null},methods:{onChange:function(e){this.$emit("page-change",e)}},computed:{pageOptions:function(){for(var e=[],t=0;t<this.pageCount;t++)e.push({label:String(t+1),value:t});return e}},components:{JTPSelect:rp}};function _Ge(r,e,t,n,i,s){var a=I.resolveComponent("JTPSelect");return I.openBlock(),I.createBlock(a,{modelValue:t.page,options:s.pageOptions,optionLabel:"label",optionValue:"value","onUpdate:modelValue":e[0]||(e[0]=function(o){return s.onChange(o)}),class:I.normalizeClass(r.cx("pcJumpToPageDropdown")),disabled:t.disabled,unstyled:r.unstyled,pt:r.ptm("pcJumpToPageDropdown"),"data-pc-group-section":"pagedropdown"},I.createSlots({_:2},[t.templates.jumptopagedropdownicon?{name:"dropdownicon",fn:I.withCtx(function(o){return[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.templates.jumptopagedropdownicon),{class:I.normalizeClass(o.class)},null,8,["class"]))]}),key:"0"}:void 0]),1032,["modelValue","options","class","disabled","unstyled","pt"])}zZ.render=_Ge;var VZ={name:"JumpToPageInput",hostName:"Paginator",extends:In,inheritAttrs:!1,emits:["page-change"],props:{page:Number,pageCount:Number,disabled:Boolean},data:function(){return{d_page:this.page}},watch:{page:function(e){this.d_page=e}},methods:{onChange:function(e){e!==this.page&&(this.d_page=e,this.$emit("page-change",e-1))}},computed:{inputArialabel:function(){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.jumpToPageInputLabel:void 0}},components:{JTPInput:OZ}};function vGe(r,e,t,n,i,s){var a=I.resolveComponent("JTPInput");return I.openBlock(),I.createBlock(a,{ref:"jtpInput",modelValue:i.d_page,class:I.normalizeClass(r.cx("pcJumpToPageInputText")),"aria-label":s.inputArialabel,disabled:t.disabled,"onUpdate:modelValue":s.onChange,unstyled:r.unstyled,pt:r.ptm("pcJumpToPageInputText")},null,8,["modelValue","class","aria-label","disabled","onUpdate:modelValue","unstyled","pt"])}VZ.render=vGe;var $Z={name:"LastPageLink",hostName:"Paginator",extends:In,props:{template:{type:Function,default:null}},methods:{getPTOptions:function(e){return this.ptm(e,{context:{disabled:this.$attrs.disabled}})}},components:{AngleDoubleRightIcon:DZ},directives:{ripple:Pd}};function AGe(r,e,t,n,i,s){var a=I.resolveDirective("ripple");return I.withDirectives((I.openBlock(),I.createElementBlock("button",I.mergeProps({class:r.cx("last"),type:"button"},s.getPTOptions("last"),{"data-pc-group-section":"pagebutton"}),[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.template||"AngleDoubleRightIcon"),I.mergeProps({class:r.cx("lastIcon")},s.getPTOptions("lastIcon")),null,16,["class"]))],16)),[[a]])}$Z.render=AGe;var jZ={name:"NextPageLink",hostName:"Paginator",extends:In,props:{template:{type:Function,default:null}},methods:{getPTOptions:function(e){return this.ptm(e,{context:{disabled:this.$attrs.disabled}})}},components:{AngleRightIcon:LZ},directives:{ripple:Pd}};function xGe(r,e,t,n,i,s){var a=I.resolveDirective("ripple");return I.withDirectives((I.openBlock(),I.createElementBlock("button",I.mergeProps({class:r.cx("next"),type:"button"},s.getPTOptions("next"),{"data-pc-group-section":"pagebutton"}),[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.template||"AngleRightIcon"),I.mergeProps({class:r.cx("nextIcon")},s.getPTOptions("nextIcon")),null,16,["class"]))],16)),[[a]])}jZ.render=xGe;var GZ={name:"PageLinks",hostName:"Paginator",extends:In,inheritAttrs:!1,emits:["click"],props:{value:Array,page:Number},methods:{getPTOptions:function(e,t){return this.ptm(t,{context:{active:e===this.page}})},onPageLinkClick:function(e,t){this.$emit("click",{originalEvent:e,value:t})},ariaPageLabel:function(e){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.pageLabel.replace(/{page}/g,e):void 0}},directives:{ripple:Pd}},wGe=["aria-label","aria-current","onClick","data-p-active"];function CGe(r,e,t,n,i,s){var a=I.resolveDirective("ripple");return I.openBlock(),I.createElementBlock("span",I.mergeProps({class:r.cx("pages")},r.ptm("pages")),[(I.openBlock(!0),I.createElementBlock(I.Fragment,null,I.renderList(t.value,function(o){return I.withDirectives((I.openBlock(),I.createElementBlock("button",I.mergeProps({key:o,class:r.cx("page",{pageLink:o}),type:"button","aria-label":s.ariaPageLabel(o),"aria-current":o-1===t.page?"page":void 0,onClick:function(f){return s.onPageLinkClick(f,o)}},{ref_for:!0},s.getPTOptions(o-1,"page"),{"data-p-active":o-1===t.page}),[I.createTextVNode(I.toDisplayString(o),1)],16,wGe)),[[a]])}),128))],16)}GZ.render=CGe;var HZ={name:"PrevPageLink",hostName:"Paginator",extends:In,props:{template:{type:Function,default:null}},methods:{getPTOptions:function(e){return this.ptm(e,{context:{disabled:this.$attrs.disabled}})}},components:{AngleLeftIcon:NZ},directives:{ripple:Pd}};function TGe(r,e,t,n,i,s){var a=I.resolveDirective("ripple");return I.withDirectives((I.openBlock(),I.createElementBlock("button",I.mergeProps({class:r.cx("prev"),type:"button"},s.getPTOptions("prev"),{"data-pc-group-section":"pagebutton"}),[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.template||"AngleLeftIcon"),I.mergeProps({class:r.cx("prevIcon")},s.getPTOptions("prevIcon")),null,16,["class"]))],16)),[[a]])}HZ.render=TGe;var WZ={name:"RowsPerPageDropdown",hostName:"Paginator",extends:In,emits:["rows-change"],props:{options:Array,rows:Number,disabled:Boolean,templates:null},methods:{onChange:function(e){this.$emit("rows-change",e)}},computed:{rowsOptions:function(){var e=[];if(this.options)for(var t=0;t<this.options.length;t++)e.push({label:String(this.options[t]),value:this.options[t]});return e}},components:{RPPSelect:rp}};function SGe(r,e,t,n,i,s){var a=I.resolveComponent("RPPSelect");return I.openBlock(),I.createBlock(a,{modelValue:t.rows,options:s.rowsOptions,optionLabel:"label",optionValue:"value","onUpdate:modelValue":e[0]||(e[0]=function(o){return s.onChange(o)}),class:I.normalizeClass(r.cx("pcRowPerPageDropdown")),disabled:t.disabled,unstyled:r.unstyled,pt:r.ptm("pcRowPerPageDropdown"),"data-pc-group-section":"pagedropdown"},I.createSlots({_:2},[t.templates.rowsperpagedropdownicon?{name:"dropdownicon",fn:I.withCtx(function(o){return[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.templates.rowsperpagedropdownicon),{class:I.normalizeClass(o.class)},null,8,["class"]))]}),key:"0"}:void 0]),1032,["modelValue","options","class","disabled","unstyled","pt"])}WZ.render=SGe;function XM(r){"@babel/helpers - typeof";return XM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},XM(r)}function e$(r,e){return BGe(r)||PGe(r,e)||IGe(r,e)||EGe()}function EGe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IGe(r,e){if(r){if(typeof r=="string")return t$(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?t$(r,e):void 0}}function t$(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function PGe(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n,i,s,a,o=[],u=!0,f=!1;try{if(s=(t=t.call(r)).next,e===0){if(Object(t)!==t)return;u=!1}else for(;!(u=(n=s.call(t)).done)&&(o.push(n.value),o.length!==e);u=!0);}catch(g){f=!0,i=g}finally{try{if(!u&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(f)throw i}}return o}}function BGe(r){if(Array.isArray(r))return r}var KZ={name:"Paginator",extends:mGe,inheritAttrs:!1,emits:["update:first","update:rows","page"],data:function(){return{d_first:this.first,d_rows:this.rows}},watch:{first:function(e){this.d_first=e},rows:function(e){this.d_rows=e},totalRecords:function(e){this.page>0&&e&&this.d_first>=e&&this.changePage(this.pageCount-1)}},mounted:function(){this.createStyle()},methods:{changePage:function(e){var t=this.pageCount;if(e>=0&&e<t){this.d_first=this.d_rows*e;var n={page:e,first:this.d_first,rows:this.d_rows,pageCount:t};this.$emit("update:first",this.d_first),this.$emit("update:rows",this.d_rows),this.$emit("page",n)}},changePageToFirst:function(e){this.isFirstPage||this.changePage(0),e.preventDefault()},changePageToPrev:function(e){this.changePage(this.page-1),e.preventDefault()},changePageLink:function(e){this.changePage(e.value-1),e.originalEvent.preventDefault()},changePageToNext:function(e){this.changePage(this.page+1),e.preventDefault()},changePageToLast:function(e){this.isLastPage||this.changePage(this.pageCount-1),e.preventDefault()},onRowChange:function(e){this.d_rows=e,this.changePage(this.page)},createStyle:function(){var e=this;if(this.hasBreakpoints()&&!this.isUnstyled){var t;this.styleElement=document.createElement("style"),this.styleElement.type="text/css",uL(this.styleElement,"nonce",(t=this.$primevue)===null||t===void 0||(t=t.config)===null||t===void 0||(t=t.csp)===null||t===void 0?void 0:t.nonce),document.body.appendChild(this.styleElement);var n="",i=Object.keys(this.template),s={};i.sort(function(M,k){return parseInt(M)-parseInt(k)}).forEach(function(M){s[M]=e.template[M]});for(var a=0,o=Object.entries(Object.entries(s));a<o.length;a++){var u=e$(o[a],2),f=u[0],g=e$(u[1],1),y=g[0],A=void 0,C=void 0;y!=="default"&&typeof Object.keys(s)[f-1]=="string"?C=Number(Object.keys(s)[f-1].slice(0,-2))+1+"px":C=Object.keys(s)[f-1],A=Object.entries(s)[f-1]?"and (min-width:".concat(C,")"):"",y==="default"?n+=`
                            @media screen `.concat(A,` {
                                .p-paginator[`).concat(this.$attrSelector,`],
                                    display: flex;
                                }
                            }
                        `):n+=`
.p-paginator-`.concat(y,` {
    display: none;
}
@media screen `).concat(A," and (max-width: ").concat(y,`) {
    .p-paginator-`).concat(y,` {
        display: flex;
    }

    .p-paginator-default{
        display: none;
    }
}
                    `)}this.styleElement.innerHTML=n}},hasBreakpoints:function(){return XM(this.template)==="object"},getAriaLabel:function(e){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria[e]:void 0}},computed:{templateItems:function(){var e={};if(this.hasBreakpoints()){e=this.template,e.default||(e.default="FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown");for(var t in e)e[t]=this.template[t].split(" ").map(function(n){return n.trim()});return e}return e.default=this.template.split(" ").map(function(n){return n.trim()}),e},page:function(){return Math.floor(this.d_first/this.d_rows)},pageCount:function(){return Math.ceil(this.totalRecords/this.d_rows)},isFirstPage:function(){return this.page===0},isLastPage:function(){return this.page===this.pageCount-1},calculatePageLinkBoundaries:function(){var e=this.pageCount,t=Math.min(this.pageLinkSize,e),n=Math.max(0,Math.ceil(this.page-t/2)),i=Math.min(e-1,n+t-1),s=this.pageLinkSize-(i-n+1);return n=Math.max(0,n-s),[n,i]},pageLinks:function(){for(var e=[],t=this.calculatePageLinkBoundaries,n=t[0],i=t[1],s=n;s<=i;s++)e.push(s+1);return e},currentState:function(){return{page:this.page,first:this.d_first,rows:this.d_rows}},empty:function(){return this.pageCount===0},currentPage:function(){return this.pageCount>0?this.page+1:0},last:function(){return Math.min(this.d_first+this.rows,this.totalRecords)}},components:{CurrentPageReport:FZ,FirstPageLink:UZ,LastPageLink:$Z,NextPageLink:jZ,PageLinks:GZ,PrevPageLink:HZ,RowsPerPageDropdown:WZ,JumpToPageDropdown:zZ,JumpToPageInput:VZ}};function MGe(r,e,t,n,i,s){var a=I.resolveComponent("FirstPageLink"),o=I.resolveComponent("PrevPageLink"),u=I.resolveComponent("NextPageLink"),f=I.resolveComponent("LastPageLink"),g=I.resolveComponent("PageLinks"),y=I.resolveComponent("CurrentPageReport"),A=I.resolveComponent("RowsPerPageDropdown"),C=I.resolveComponent("JumpToPageDropdown"),M=I.resolveComponent("JumpToPageInput");return r.alwaysShow||s.pageLinks&&s.pageLinks.length>1?(I.openBlock(),I.createElementBlock("nav",I.normalizeProps(I.mergeProps({key:0},r.ptmi("paginatorContainer"))),[(I.openBlock(!0),I.createElementBlock(I.Fragment,null,I.renderList(s.templateItems,function(k,D){return I.openBlock(),I.createElementBlock("div",I.mergeProps({key:D,ref_for:!0,ref:"paginator",class:r.cx("paginator",{key:D})},{ref_for:!0},r.ptm("root")),[r.$slots.container?I.renderSlot(r.$slots,"container",{key:0,first:i.d_first+1,last:s.last,rows:i.d_rows,page:s.page,pageCount:s.pageCount,pageLinks:s.pageLinks,totalRecords:r.totalRecords,firstPageCallback:s.changePageToFirst,lastPageCallback:s.changePageToLast,prevPageCallback:s.changePageToPrev,nextPageCallback:s.changePageToNext,rowChangeCallback:s.onRowChange,changePageCallback:s.changePage}):(I.openBlock(),I.createElementBlock(I.Fragment,{key:1},[r.$slots.start?(I.openBlock(),I.createElementBlock("div",I.mergeProps({key:0,class:r.cx("contentStart")},{ref_for:!0},r.ptm("contentStart")),[I.renderSlot(r.$slots,"start",{state:s.currentState})],16)):I.createCommentVNode("",!0),I.createElementVNode("div",I.mergeProps({class:r.cx("content")},{ref_for:!0},r.ptm("content")),[(I.openBlock(!0),I.createElementBlock(I.Fragment,null,I.renderList(k,function(V){return I.openBlock(),I.createElementBlock(I.Fragment,{key:V},[V==="FirstPageLink"?(I.openBlock(),I.createBlock(a,{key:0,"aria-label":s.getAriaLabel("firstPageLabel"),template:r.$slots.firsticon||r.$slots.firstpagelinkicon,onClick:e[0]||(e[0]=function(W){return s.changePageToFirst(W)}),disabled:s.isFirstPage||s.empty,unstyled:r.unstyled,pt:r.pt},null,8,["aria-label","template","disabled","unstyled","pt"])):V==="PrevPageLink"?(I.openBlock(),I.createBlock(o,{key:1,"aria-label":s.getAriaLabel("prevPageLabel"),template:r.$slots.previcon||r.$slots.prevpagelinkicon,onClick:e[1]||(e[1]=function(W){return s.changePageToPrev(W)}),disabled:s.isFirstPage||s.empty,unstyled:r.unstyled,pt:r.pt},null,8,["aria-label","template","disabled","unstyled","pt"])):V==="NextPageLink"?(I.openBlock(),I.createBlock(u,{key:2,"aria-label":s.getAriaLabel("nextPageLabel"),template:r.$slots.nexticon||r.$slots.nextpagelinkicon,onClick:e[2]||(e[2]=function(W){return s.changePageToNext(W)}),disabled:s.isLastPage||s.empty,unstyled:r.unstyled,pt:r.pt},null,8,["aria-label","template","disabled","unstyled","pt"])):V==="LastPageLink"?(I.openBlock(),I.createBlock(f,{key:3,"aria-label":s.getAriaLabel("lastPageLabel"),template:r.$slots.lasticon||r.$slots.lastpagelinkicon,onClick:e[3]||(e[3]=function(W){return s.changePageToLast(W)}),disabled:s.isLastPage||s.empty,unstyled:r.unstyled,pt:r.pt},null,8,["aria-label","template","disabled","unstyled","pt"])):V==="PageLinks"?(I.openBlock(),I.createBlock(g,{key:4,"aria-label":s.getAriaLabel("pageLabel"),value:s.pageLinks,page:s.page,onClick:e[4]||(e[4]=function(W){return s.changePageLink(W)}),unstyled:r.unstyled,pt:r.pt},null,8,["aria-label","value","page","unstyled","pt"])):V==="CurrentPageReport"?(I.openBlock(),I.createBlock(y,{key:5,"aria-live":"polite",template:r.currentPageReportTemplate,currentPage:s.currentPage,page:s.page,pageCount:s.pageCount,first:i.d_first,rows:i.d_rows,totalRecords:r.totalRecords,unstyled:r.unstyled,pt:r.pt},null,8,["template","currentPage","page","pageCount","first","rows","totalRecords","unstyled","pt"])):V==="RowsPerPageDropdown"&&r.rowsPerPageOptions?(I.openBlock(),I.createBlock(A,{key:6,"aria-label":s.getAriaLabel("rowsPerPageLabel"),rows:i.d_rows,options:r.rowsPerPageOptions,onRowsChange:e[5]||(e[5]=function(W){return s.onRowChange(W)}),disabled:s.empty,templates:r.$slots,unstyled:r.unstyled,pt:r.pt},null,8,["aria-label","rows","options","disabled","templates","unstyled","pt"])):V==="JumpToPageDropdown"?(I.openBlock(),I.createBlock(C,{key:7,"aria-label":s.getAriaLabel("jumpToPageDropdownLabel"),page:s.page,pageCount:s.pageCount,onPageChange:e[6]||(e[6]=function(W){return s.changePage(W)}),disabled:s.empty,templates:r.$slots,unstyled:r.unstyled,pt:r.pt},null,8,["aria-label","page","pageCount","disabled","templates","unstyled","pt"])):V==="JumpToPageInput"?(I.openBlock(),I.createBlock(M,{key:8,page:s.currentPage,onPageChange:e[7]||(e[7]=function(W){return s.changePage(W)}),disabled:s.empty,unstyled:r.unstyled,pt:r.pt},null,8,["page","disabled","unstyled","pt"])):I.createCommentVNode("",!0)],64)}),128))],16),r.$slots.end?(I.openBlock(),I.createElementBlock("div",I.mergeProps({key:1,class:r.cx("contentEnd")},{ref_for:!0},r.ptm("contentEnd")),[I.renderSlot(r.$slots,"end",{state:s.currentState})],16)):I.createCommentVNode("",!0)],64))],16)}),128))],16)):I.createCommentVNode("",!0)}KZ.render=MGe;var RGe=`
    .p-datatable {
        position: relative;
        display: block;
    }

    .p-datatable-table {
        border-spacing: 0;
        border-collapse: separate;
        width: 100%;
    }

    .p-datatable-scrollable > .p-datatable-table-container {
        position: relative;
    }

    .p-datatable-scrollable-table > .p-datatable-thead {
        inset-block-start: 0;
        z-index: 1;
    }

    .p-datatable-scrollable-table > .p-datatable-frozen-tbody {
        position: sticky;
        z-index: 1;
    }

    .p-datatable-scrollable-table > .p-datatable-tfoot {
        inset-block-end: 0;
        z-index: 1;
    }

    .p-datatable-scrollable .p-datatable-frozen-column {
        position: sticky;
    }

    .p-datatable-scrollable th.p-datatable-frozen-column {
        z-index: 1;
    }

    .p-datatable-scrollable td.p-datatable-frozen-column {
        background: inherit;
    }

    .p-datatable-scrollable > .p-datatable-table-container > .p-datatable-table > .p-datatable-thead,
    .p-datatable-scrollable > .p-datatable-table-container > .p-virtualscroller > .p-datatable-table > .p-datatable-thead {
        background: dt('datatable.header.cell.background');
    }

    .p-datatable-scrollable > .p-datatable-table-container > .p-datatable-table > .p-datatable-tfoot,
    .p-datatable-scrollable > .p-datatable-table-container > .p-virtualscroller > .p-datatable-table > .p-datatable-tfoot {
        background: dt('datatable.footer.cell.background');
    }

    .p-datatable-flex-scrollable {
        display: flex;
        flex-direction: column;
        height: 100%;
    }

    .p-datatable-flex-scrollable > .p-datatable-table-container {
        display: flex;
        flex-direction: column;
        flex: 1;
        height: 100%;
    }

    .p-datatable-scrollable-table > .p-datatable-tbody > .p-datatable-row-group-header {
        position: sticky;
        z-index: 1;
    }

    .p-datatable-resizable-table > .p-datatable-thead > tr > th,
    .p-datatable-resizable-table > .p-datatable-tfoot > tr > td,
    .p-datatable-resizable-table > .p-datatable-tbody > tr > td {
        overflow: hidden;
        white-space: nowrap;
    }

    .p-datatable-resizable-table > .p-datatable-thead > tr > th.p-datatable-resizable-column:not(.p-datatable-frozen-column) {
        background-clip: padding-box;
        position: relative;
    }

    .p-datatable-resizable-table-fit > .p-datatable-thead > tr > th.p-datatable-resizable-column:last-child .p-datatable-column-resizer {
        display: none;
    }

    .p-datatable-column-resizer {
        display: block;
        position: absolute;
        inset-block-start: 0;
        inset-inline-end: 0;
        margin: 0;
        width: dt('datatable.column.resizer.width');
        height: 100%;
        padding: 0;
        cursor: col-resize;
        border: 1px solid transparent;
    }

    .p-datatable-column-header-content {
        display: flex;
        align-items: center;
        gap: dt('datatable.header.cell.gap');
    }

    .p-datatable-column-resize-indicator {
        width: dt('datatable.resize.indicator.width');
        position: absolute;
        z-index: 10;
        display: none;
        background: dt('datatable.resize.indicator.color');
    }

    .p-datatable-row-reorder-indicator-up,
    .p-datatable-row-reorder-indicator-down {
        position: absolute;
        display: none;
    }

    .p-datatable-reorderable-column,
    .p-datatable-reorderable-row-handle {
        cursor: move;
    }

    .p-datatable-mask {
        position: absolute;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 2;
    }

    .p-datatable-inline-filter {
        display: flex;
        align-items: center;
        width: 100%;
        gap: dt('datatable.filter.inline.gap');
    }

    .p-datatable-inline-filter .p-datatable-filter-element-container {
        flex: 1 1 auto;
        width: 1%;
    }

    .p-datatable-filter-overlay {
        background: dt('datatable.filter.overlay.select.background');
        color: dt('datatable.filter.overlay.select.color');
        border: 1px solid dt('datatable.filter.overlay.select.border.color');
        border-radius: dt('datatable.filter.overlay.select.border.radius');
        box-shadow: dt('datatable.filter.overlay.select.shadow');
        min-width: 12.5rem;
    }

    .p-datatable-filter-constraint-list {
        margin: 0;
        list-style: none;
        display: flex;
        flex-direction: column;
        padding: dt('datatable.filter.constraint.list.padding');
        gap: dt('datatable.filter.constraint.list.gap');
    }

    .p-datatable-filter-constraint {
        padding: dt('datatable.filter.constraint.padding');
        color: dt('datatable.filter.constraint.color');
        border-radius: dt('datatable.filter.constraint.border.radius');
        cursor: pointer;
        transition:
            background dt('datatable.transition.duration'),
            color dt('datatable.transition.duration'),
            border-color dt('datatable.transition.duration'),
            box-shadow dt('datatable.transition.duration');
    }

    .p-datatable-filter-constraint-selected {
        background: dt('datatable.filter.constraint.selected.background');
        color: dt('datatable.filter.constraint.selected.color');
    }

    .p-datatable-filter-constraint:not(.p-datatable-filter-constraint-selected):not(.p-disabled):hover {
        background: dt('datatable.filter.constraint.focus.background');
        color: dt('datatable.filter.constraint.focus.color');
    }

    .p-datatable-filter-constraint:focus-visible {
        outline: 0 none;
        background: dt('datatable.filter.constraint.focus.background');
        color: dt('datatable.filter.constraint.focus.color');
    }

    .p-datatable-filter-constraint-selected:focus-visible {
        outline: 0 none;
        background: dt('datatable.filter.constraint.selected.focus.background');
        color: dt('datatable.filter.constraint.selected.focus.color');
    }

    .p-datatable-filter-constraint-separator {
        border-block-start: 1px solid dt('datatable.filter.constraint.separator.border.color');
    }

    .p-datatable-popover-filter {
        display: inline-flex;
        margin-inline-start: auto;
    }

    .p-datatable-filter-overlay-popover {
        background: dt('datatable.filter.overlay.popover.background');
        color: dt('datatable.filter.overlay.popover.color');
        border: 1px solid dt('datatable.filter.overlay.popover.border.color');
        border-radius: dt('datatable.filter.overlay.popover.border.radius');
        box-shadow: dt('datatable.filter.overlay.popover.shadow');
        min-width: 12.5rem;
        padding: dt('datatable.filter.overlay.popover.padding');
        display: flex;
        flex-direction: column;
        gap: dt('datatable.filter.overlay.popover.gap');
    }

    .p-datatable-filter-operator-dropdown {
        width: 100%;
    }

    .p-datatable-filter-rule-list,
    .p-datatable-filter-rule {
        display: flex;
        flex-direction: column;
        gap: dt('datatable.filter.overlay.popover.gap');
    }

    .p-datatable-filter-rule {
        border-block-end: 1px solid dt('datatable.filter.rule.border.color');
        padding-bottom: dt('datatable.filter.overlay.popover.gap');
    }

    .p-datatable-filter-rule:last-child {
        border-block-end: 0 none;
        padding-bottom: 0;
    }

    .p-datatable-filter-add-rule-button {
        width: 100%;
    }

    .p-datatable-filter-remove-rule-button {
        width: 100%;
    }

    .p-datatable-filter-buttonbar {
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .p-datatable-virtualscroller-spacer {
        display: flex;
    }

    .p-datatable .p-virtualscroller .p-virtualscroller-loading {
        transform: none !important;
        min-height: 0;
        position: sticky;
        inset-block-start: 0;
        inset-inline-start: 0;
    }

    .p-datatable-paginator-top {
        border-color: dt('datatable.paginator.top.border.color');
        border-style: solid;
        border-width: dt('datatable.paginator.top.border.width');
    }

    .p-datatable-paginator-bottom {
        border-color: dt('datatable.paginator.bottom.border.color');
        border-style: solid;
        border-width: dt('datatable.paginator.bottom.border.width');
    }

    .p-datatable-header {
        background: dt('datatable.header.background');
        color: dt('datatable.header.color');
        border-color: dt('datatable.header.border.color');
        border-style: solid;
        border-width: dt('datatable.header.border.width');
        padding: dt('datatable.header.padding');
    }

    .p-datatable-footer {
        background: dt('datatable.footer.background');
        color: dt('datatable.footer.color');
        border-color: dt('datatable.footer.border.color');
        border-style: solid;
        border-width: dt('datatable.footer.border.width');
        padding: dt('datatable.footer.padding');
    }

    .p-datatable-header-cell {
        padding: dt('datatable.header.cell.padding');
        background: dt('datatable.header.cell.background');
        border-color: dt('datatable.header.cell.border.color');
        border-style: solid;
        border-width: 0 0 1px 0;
        color: dt('datatable.header.cell.color');
        font-weight: normal;
        text-align: start;
        transition:
            background dt('datatable.transition.duration'),
            color dt('datatable.transition.duration'),
            border-color dt('datatable.transition.duration'),
            outline-color dt('datatable.transition.duration'),
            box-shadow dt('datatable.transition.duration');
    }

    .p-datatable-column-title {
        font-weight: dt('datatable.column.title.font.weight');
    }

    .p-datatable-tbody > tr {
        outline-color: transparent;
        background: dt('datatable.row.background');
        color: dt('datatable.row.color');
        transition:
            background dt('datatable.transition.duration'),
            color dt('datatable.transition.duration'),
            border-color dt('datatable.transition.duration'),
            outline-color dt('datatable.transition.duration'),
            box-shadow dt('datatable.transition.duration');
    }

    .p-datatable-tbody > tr > td {
        text-align: start;
        border-color: dt('datatable.body.cell.border.color');
        border-style: solid;
        border-width: 0 0 1px 0;
        padding: dt('datatable.body.cell.padding');
    }

    .p-datatable-hoverable .p-datatable-tbody > tr:not(.p-datatable-row-selected):hover {
        background: dt('datatable.row.hover.background');
        color: dt('datatable.row.hover.color');
    }

    .p-datatable-tbody > tr.p-datatable-row-selected {
        background: dt('datatable.row.selected.background');
        color: dt('datatable.row.selected.color');
    }

    .p-datatable-tbody > tr:has(+ .p-datatable-row-selected) > td {
        border-block-end-color: dt('datatable.body.cell.selected.border.color');
    }

    .p-datatable-tbody > tr.p-datatable-row-selected > td {
        border-block-end-color: dt('datatable.body.cell.selected.border.color');
    }

    .p-datatable-tbody > tr:focus-visible,
    .p-datatable-tbody > tr.p-datatable-contextmenu-row-selected {
        box-shadow: dt('datatable.row.focus.ring.shadow');
        outline: dt('datatable.row.focus.ring.width') dt('datatable.row.focus.ring.style') dt('datatable.row.focus.ring.color');
        outline-offset: dt('datatable.row.focus.ring.offset');
    }

    .p-datatable-tfoot > tr > td {
        text-align: start;
        padding: dt('datatable.footer.cell.padding');
        border-color: dt('datatable.footer.cell.border.color');
        border-style: solid;
        border-width: 0 0 1px 0;
        color: dt('datatable.footer.cell.color');
        background: dt('datatable.footer.cell.background');
    }

    .p-datatable-column-footer {
        font-weight: dt('datatable.column.footer.font.weight');
    }

    .p-datatable-sortable-column {
        cursor: pointer;
        user-select: none;
        outline-color: transparent;
    }

    .p-datatable-column-title,
    .p-datatable-sort-icon,
    .p-datatable-sort-badge {
        vertical-align: middle;
    }

    .p-datatable-sort-icon {
        color: dt('datatable.sort.icon.color');
        font-size: dt('datatable.sort.icon.size');
        width: dt('datatable.sort.icon.size');
        height: dt('datatable.sort.icon.size');
        transition: color dt('datatable.transition.duration');
    }

    .p-datatable-sortable-column:not(.p-datatable-column-sorted):hover {
        background: dt('datatable.header.cell.hover.background');
        color: dt('datatable.header.cell.hover.color');
    }

    .p-datatable-sortable-column:not(.p-datatable-column-sorted):hover .p-datatable-sort-icon {
        color: dt('datatable.sort.icon.hover.color');
    }

    .p-datatable-column-sorted {
        background: dt('datatable.header.cell.selected.background');
        color: dt('datatable.header.cell.selected.color');
    }

    .p-datatable-column-sorted .p-datatable-sort-icon {
        color: dt('datatable.header.cell.selected.color');
    }

    .p-datatable-sortable-column:focus-visible {
        box-shadow: dt('datatable.header.cell.focus.ring.shadow');
        outline: dt('datatable.header.cell.focus.ring.width') dt('datatable.header.cell.focus.ring.style') dt('datatable.header.cell.focus.ring.color');
        outline-offset: dt('datatable.header.cell.focus.ring.offset');
    }

    .p-datatable-hoverable .p-datatable-selectable-row {
        cursor: pointer;
    }

    .p-datatable-tbody > tr.p-datatable-dragpoint-top > td {
        box-shadow: inset 0 2px 0 0 dt('datatable.drop.point.color');
    }

    .p-datatable-tbody > tr.p-datatable-dragpoint-bottom > td {
        box-shadow: inset 0 -2px 0 0 dt('datatable.drop.point.color');
    }

    .p-datatable-loading-icon {
        font-size: dt('datatable.loading.icon.size');
        width: dt('datatable.loading.icon.size');
        height: dt('datatable.loading.icon.size');
    }

    .p-datatable-gridlines .p-datatable-header {
        border-width: 1px 1px 0 1px;
    }

    .p-datatable-gridlines .p-datatable-footer {
        border-width: 0 1px 1px 1px;
    }

    .p-datatable-gridlines .p-datatable-paginator-top {
        border-width: 1px 1px 0 1px;
    }

    .p-datatable-gridlines .p-datatable-paginator-bottom {
        border-width: 0 1px 1px 1px;
    }

    .p-datatable-gridlines .p-datatable-thead > tr > th {
        border-width: 1px 0 1px 1px;
    }

    .p-datatable-gridlines .p-datatable-thead > tr > th:last-child {
        border-width: 1px;
    }

    .p-datatable-gridlines .p-datatable-tbody > tr > td {
        border-width: 1px 0 0 1px;
    }

    .p-datatable-gridlines .p-datatable-tbody > tr > td:last-child {
        border-width: 1px 1px 0 1px;
    }

    .p-datatable-gridlines .p-datatable-tbody > tr:last-child > td {
        border-width: 1px 0 1px 1px;
    }

    .p-datatable-gridlines .p-datatable-tbody > tr:last-child > td:last-child {
        border-width: 1px;
    }

    .p-datatable-gridlines .p-datatable-tfoot > tr > td {
        border-width: 1px 0 1px 1px;
    }

    .p-datatable-gridlines .p-datatable-tfoot > tr > td:last-child {
        border-width: 1px 1px 1px 1px;
    }

    .p-datatable.p-datatable-gridlines .p-datatable-thead + .p-datatable-tfoot > tr > td {
        border-width: 0 0 1px 1px;
    }

    .p-datatable.p-datatable-gridlines .p-datatable-thead + .p-datatable-tfoot > tr > td:last-child {
        border-width: 0 1px 1px 1px;
    }

    .p-datatable.p-datatable-gridlines:has(.p-datatable-thead):has(.p-datatable-tbody) .p-datatable-tbody > tr > td {
        border-width: 0 0 1px 1px;
    }

    .p-datatable.p-datatable-gridlines:has(.p-datatable-thead):has(.p-datatable-tbody) .p-datatable-tbody > tr > td:last-child {
        border-width: 0 1px 1px 1px;
    }

    .p-datatable.p-datatable-gridlines:has(.p-datatable-tbody):has(.p-datatable-tfoot) .p-datatable-tbody > tr:last-child > td {
        border-width: 0 0 0 1px;
    }

    .p-datatable.p-datatable-gridlines:has(.p-datatable-tbody):has(.p-datatable-tfoot) .p-datatable-tbody > tr:last-child > td:last-child {
        border-width: 0 1px 0 1px;
    }

    .p-datatable.p-datatable-striped .p-datatable-tbody > tr.p-row-odd {
        background: dt('datatable.row.striped.background');
    }

    .p-datatable.p-datatable-striped .p-datatable-tbody > tr.p-row-odd.p-datatable-row-selected {
        background: dt('datatable.row.selected.background');
        color: dt('datatable.row.selected.color');
    }

    .p-datatable-striped.p-datatable-hoverable .p-datatable-tbody > tr:not(.p-datatable-row-selected):hover {
        background: dt('datatable.row.hover.background');
        color: dt('datatable.row.hover.color');
    }

    .p-datatable.p-datatable-sm .p-datatable-header {
        padding: dt('datatable.header.sm.padding');
    }

    .p-datatable.p-datatable-sm .p-datatable-thead > tr > th {
        padding: dt('datatable.header.cell.sm.padding');
    }

    .p-datatable.p-datatable-sm .p-datatable-tbody > tr > td {
        padding: dt('datatable.body.cell.sm.padding');
    }

    .p-datatable.p-datatable-sm .p-datatable-tfoot > tr > td {
        padding: dt('datatable.footer.cell.sm.padding');
    }

    .p-datatable.p-datatable-sm .p-datatable-footer {
        padding: dt('datatable.footer.sm.padding');
    }

    .p-datatable.p-datatable-lg .p-datatable-header {
        padding: dt('datatable.header.lg.padding');
    }

    .p-datatable.p-datatable-lg .p-datatable-thead > tr > th {
        padding: dt('datatable.header.cell.lg.padding');
    }

    .p-datatable.p-datatable-lg .p-datatable-tbody > tr > td {
        padding: dt('datatable.body.cell.lg.padding');
    }

    .p-datatable.p-datatable-lg .p-datatable-tfoot > tr > td {
        padding: dt('datatable.footer.cell.lg.padding');
    }

    .p-datatable.p-datatable-lg .p-datatable-footer {
        padding: dt('datatable.footer.lg.padding');
    }

    .p-datatable-row-toggle-button {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
        position: relative;
        width: dt('datatable.row.toggle.button.size');
        height: dt('datatable.row.toggle.button.size');
        color: dt('datatable.row.toggle.button.color');
        border: 0 none;
        background: transparent;
        cursor: pointer;
        border-radius: dt('datatable.row.toggle.button.border.radius');
        transition:
            background dt('datatable.transition.duration'),
            color dt('datatable.transition.duration'),
            border-color dt('datatable.transition.duration'),
            outline-color dt('datatable.transition.duration'),
            box-shadow dt('datatable.transition.duration');
        outline-color: transparent;
        user-select: none;
    }

    .p-datatable-row-toggle-button:enabled:hover {
        color: dt('datatable.row.toggle.button.hover.color');
        background: dt('datatable.row.toggle.button.hover.background');
    }

    .p-datatable-tbody > tr.p-datatable-row-selected .p-datatable-row-toggle-button:hover {
        background: dt('datatable.row.toggle.button.selected.hover.background');
        color: dt('datatable.row.toggle.button.selected.hover.color');
    }

    .p-datatable-row-toggle-button:focus-visible {
        box-shadow: dt('datatable.row.toggle.button.focus.ring.shadow');
        outline: dt('datatable.row.toggle.button.focus.ring.width') dt('datatable.row.toggle.button.focus.ring.style') dt('datatable.row.toggle.button.focus.ring.color');
        outline-offset: dt('datatable.row.toggle.button.focus.ring.offset');
    }

    .p-datatable-row-toggle-icon:dir(rtl) {
        transform: rotate(180deg);
    }
`,kGe={root:function(e){var t=e.props;return["p-datatable p-component",{"p-datatable-hoverable":t.rowHover||t.selectionMode,"p-datatable-resizable":t.resizableColumns,"p-datatable-resizable-fit":t.resizableColumns&&t.columnResizeMode==="fit","p-datatable-scrollable":t.scrollable,"p-datatable-flex-scrollable":t.scrollable&&t.scrollHeight==="flex","p-datatable-striped":t.stripedRows,"p-datatable-gridlines":t.showGridlines,"p-datatable-sm":t.size==="small","p-datatable-lg":t.size==="large"}]},mask:"p-datatable-mask p-overlay-mask",loadingIcon:"p-datatable-loading-icon",header:"p-datatable-header",pcPaginator:function(e){var t=e.position;return"p-datatable-paginator-"+t},tableContainer:"p-datatable-table-container",table:function(e){var t=e.props;return["p-datatable-table",{"p-datatable-scrollable-table":t.scrollable,"p-datatable-resizable-table":t.resizableColumns,"p-datatable-resizable-table-fit":t.resizableColumns&&t.columnResizeMode==="fit"}]},thead:"p-datatable-thead",headerCell:function(e){var t=e.instance,n=e.props,i=e.column;return i&&!t.columnProp("hidden")&&(n.rowGroupMode!=="subheader"||n.groupRowsBy!==t.columnProp(i,"field"))?["p-datatable-header-cell",{"p-datatable-frozen-column":t.columnProp("frozen")}]:["p-datatable-header-cell",{"p-datatable-sortable-column":t.columnProp("sortable"),"p-datatable-resizable-column":t.resizableColumns,"p-datatable-column-sorted":t.isColumnSorted(),"p-datatable-frozen-column":t.columnProp("frozen"),"p-datatable-reorderable-column":n.reorderableColumns}]},columnResizer:"p-datatable-column-resizer",columnHeaderContent:"p-datatable-column-header-content",columnTitle:"p-datatable-column-title",columnFooter:"p-datatable-column-footer",sortIcon:"p-datatable-sort-icon",pcSortBadge:"p-datatable-sort-badge",filter:function(e){var t=e.props;return["p-datatable-filter",{"p-datatable-inline-filter":t.display==="row","p-datatable-popover-filter":t.display==="menu"}]},filterElementContainer:"p-datatable-filter-element-container",pcColumnFilterButton:"p-datatable-column-filter-button",pcColumnFilterClearButton:"p-datatable-column-filter-clear-button",filterOverlay:function(e){var t=e.props;return["p-datatable-filter-overlay p-component",{"p-datatable-filter-overlay-popover":t.display==="menu"}]},filterConstraintList:"p-datatable-filter-constraint-list",filterConstraint:function(e){var t=e.instance,n=e.matchMode;return["p-datatable-filter-constraint",{"p-datatable-filter-constraint-selected":n&&t.isRowMatchModeSelected(n.value)}]},filterConstraintSeparator:"p-datatable-filter-constraint-separator",filterOperator:"p-datatable-filter-operator",pcFilterOperatorDropdown:"p-datatable-filter-operator-dropdown",filterRuleList:"p-datatable-filter-rule-list",filterRule:"p-datatable-filter-rule",pcFilterConstraintDropdown:"p-datatable-filter-constraint-dropdown",pcFilterRemoveRuleButton:"p-datatable-filter-remove-rule-button",pcFilterAddRuleButton:"p-datatable-filter-add-rule-button",filterButtonbar:"p-datatable-filter-buttonbar",pcFilterClearButton:"p-datatable-filter-clear-button",pcFilterApplyButton:"p-datatable-filter-apply-button",tbody:function(e){var t=e.props;return t.frozenRow?"p-datatable-tbody p-datatable-frozen-tbody":"p-datatable-tbody"},rowGroupHeader:"p-datatable-row-group-header",rowToggleButton:"p-datatable-row-toggle-button",rowToggleIcon:"p-datatable-row-toggle-icon",row:function(e){var t=e.instance,n=e.props,i=e.index,s=e.columnSelectionMode,a=[];return n.selectionMode&&a.push("p-datatable-selectable-row"),n.selection&&a.push({"p-datatable-row-selected":s?t.isSelected&&t.$parentInstance.$parentInstance.highlightOnSelect:t.isSelected}),n.contextMenuSelection&&a.push({"p-datatable-contextmenu-row-selected":t.isSelectedWithContextMenu}),a.push(i%2===0?"p-row-even":"p-row-odd"),a},rowExpansion:"p-datatable-row-expansion",rowGroupFooter:"p-datatable-row-group-footer",emptyMessage:"p-datatable-empty-message",bodyCell:function(e){var t=e.instance;return[{"p-datatable-frozen-column":t.columnProp("frozen")}]},reorderableRowHandle:"p-datatable-reorderable-row-handle",pcRowEditorInit:"p-datatable-row-editor-init",pcRowEditorSave:"p-datatable-row-editor-save",pcRowEditorCancel:"p-datatable-row-editor-cancel",tfoot:"p-datatable-tfoot",footerCell:function(e){var t=e.instance;return[{"p-datatable-frozen-column":t.columnProp("frozen")}]},virtualScrollerSpacer:"p-datatable-virtualscroller-spacer",footer:"p-datatable-footer",columnResizeIndicator:"p-datatable-column-resize-indicator",rowReorderIndicatorUp:"p-datatable-row-reorder-indicator-up",rowReorderIndicatorDown:"p-datatable-row-reorder-indicator-down"},OGe={tableContainer:{overflow:"auto"},thead:{position:"sticky"},tfoot:{position:"sticky"}},DGe=cn.extend({name:"datatable",style:RGe,classes:kGe,inlineStyles:OGe}),gL={name:"ChevronRightIcon",extends:gi};function LGe(r){return zGe(r)||UGe(r)||FGe(r)||NGe()}function NGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FGe(r,e){if(r){if(typeof r=="string")return JM(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?JM(r,e):void 0}}function UGe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function zGe(r){if(Array.isArray(r))return JM(r)}function JM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function VGe(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),LGe(e[0]||(e[0]=[I.createElementVNode("path",{d:"M4.38708 13C4.28408 13.0005 4.18203 12.9804 4.08691 12.9409C3.99178 12.9014 3.9055 12.8433 3.83313 12.7701C3.68634 12.6231 3.60388 12.4238 3.60388 12.2161C3.60388 12.0084 3.68634 11.8091 3.83313 11.6622L8.50507 6.99022L3.83313 2.31827C3.69467 2.16968 3.61928 1.97313 3.62287 1.77005C3.62645 1.56698 3.70872 1.37322 3.85234 1.22959C3.99596 1.08597 4.18972 1.00371 4.3928 1.00012C4.59588 0.996539 4.79242 1.07192 4.94102 1.21039L10.1669 6.43628C10.3137 6.58325 10.3962 6.78249 10.3962 6.99022C10.3962 7.19795 10.3137 7.39718 10.1669 7.54416L4.94102 12.7701C4.86865 12.8433 4.78237 12.9014 4.68724 12.9409C4.59212 12.9804 4.49007 13.0005 4.38708 13Z",fill:"currentColor"},null,-1)])),16)}gL.render=VGe;var XZ={name:"BarsIcon",extends:gi};function $Ge(r){return WGe(r)||HGe(r)||GGe(r)||jGe()}function jGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GGe(r,e){if(r){if(typeof r=="string")return qM(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?qM(r,e):void 0}}function HGe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function WGe(r){if(Array.isArray(r))return qM(r)}function qM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function KGe(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),$Ge(e[0]||(e[0]=[I.createElementVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M13.3226 3.6129H0.677419C0.497757 3.6129 0.325452 3.54152 0.198411 3.41448C0.0713707 3.28744 0 3.11514 0 2.93548C0 2.75581 0.0713707 2.58351 0.198411 2.45647C0.325452 2.32943 0.497757 2.25806 0.677419 2.25806H13.3226C13.5022 2.25806 13.6745 2.32943 13.8016 2.45647C13.9286 2.58351 14 2.75581 14 2.93548C14 3.11514 13.9286 3.28744 13.8016 3.41448C13.6745 3.54152 13.5022 3.6129 13.3226 3.6129ZM13.3226 7.67741H0.677419C0.497757 7.67741 0.325452 7.60604 0.198411 7.479C0.0713707 7.35196 0 7.17965 0 6.99999C0 6.82033 0.0713707 6.64802 0.198411 6.52098C0.325452 6.39394 0.497757 6.32257 0.677419 6.32257H13.3226C13.5022 6.32257 13.6745 6.39394 13.8016 6.52098C13.9286 6.64802 14 6.82033 14 6.99999C14 7.17965 13.9286 7.35196 13.8016 7.479C13.6745 7.60604 13.5022 7.67741 13.3226 7.67741ZM0.677419 11.7419H13.3226C13.5022 11.7419 13.6745 11.6706 13.8016 11.5435C13.9286 11.4165 14 11.2442 14 11.0645C14 10.8848 13.9286 10.7125 13.8016 10.5855C13.6745 10.4585 13.5022 10.3871 13.3226 10.3871H0.677419C0.497757 10.3871 0.325452 10.4585 0.198411 10.5855C0.0713707 10.7125 0 10.8848 0 11.0645C0 11.2442 0.0713707 11.4165 0.198411 11.5435C0.325452 11.6706 0.497757 11.7419 0.677419 11.7419Z",fill:"currentColor"},null,-1)])),16)}XZ.render=KGe;var JZ={name:"PencilIcon",extends:gi};function XGe(r){return ZGe(r)||YGe(r)||qGe(r)||JGe()}function JGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qGe(r,e){if(r){if(typeof r=="string")return YM(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?YM(r,e):void 0}}function YGe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function ZGe(r){if(Array.isArray(r))return YM(r)}function YM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function QGe(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),XGe(e[0]||(e[0]=[I.createElementVNode("path",{d:"M0.609628 13.959C0.530658 13.9599 0.452305 13.9451 0.379077 13.9156C0.305849 13.8861 0.239191 13.8424 0.18294 13.787C0.118447 13.7234 0.0688234 13.6464 0.0376166 13.5614C0.00640987 13.4765 -0.00560954 13.3857 0.00241768 13.2956L0.25679 10.1501C0.267698 10.0041 0.331934 9.86709 0.437312 9.76516L9.51265 0.705715C10.0183 0.233014 10.6911 -0.0203041 11.3835 0.00127367C12.0714 0.00660201 12.7315 0.27311 13.2298 0.746671C13.7076 1.23651 13.9824 1.88848 13.9992 2.57201C14.0159 3.25554 13.7733 3.92015 13.32 4.4327L4.23648 13.5331C4.13482 13.6342 4.0017 13.6978 3.85903 13.7133L0.667067 14L0.609628 13.959ZM1.43018 10.4696L1.25787 12.714L3.50619 12.5092L12.4502 3.56444C12.6246 3.35841 12.7361 3.10674 12.7714 2.83933C12.8067 2.57193 12.7644 2.30002 12.6495 2.05591C12.5346 1.8118 12.3519 1.60575 12.1231 1.46224C11.8943 1.31873 11.6291 1.2438 11.3589 1.24633C11.1813 1.23508 11.0033 1.25975 10.8355 1.31887C10.6677 1.37798 10.5136 1.47033 10.3824 1.59036L1.43018 10.4696Z",fill:"currentColor"},null,-1)])),16)}JZ.render=QGe;var eHe=`
    .p-badge {
        display: inline-flex;
        border-radius: dt('badge.border.radius');
        align-items: center;
        justify-content: center;
        padding: dt('badge.padding');
        background: dt('badge.primary.background');
        color: dt('badge.primary.color');
        font-size: dt('badge.font.size');
        font-weight: dt('badge.font.weight');
        min-width: dt('badge.min.width');
        height: dt('badge.height');
    }

    .p-badge-dot {
        width: dt('badge.dot.size');
        min-width: dt('badge.dot.size');
        height: dt('badge.dot.size');
        border-radius: 50%;
        padding: 0;
    }

    .p-badge-circle {
        padding: 0;
        border-radius: 50%;
    }

    .p-badge-secondary {
        background: dt('badge.secondary.background');
        color: dt('badge.secondary.color');
    }

    .p-badge-success {
        background: dt('badge.success.background');
        color: dt('badge.success.color');
    }

    .p-badge-info {
        background: dt('badge.info.background');
        color: dt('badge.info.color');
    }

    .p-badge-warn {
        background: dt('badge.warn.background');
        color: dt('badge.warn.color');
    }

    .p-badge-danger {
        background: dt('badge.danger.background');
        color: dt('badge.danger.color');
    }

    .p-badge-contrast {
        background: dt('badge.contrast.background');
        color: dt('badge.contrast.color');
    }

    .p-badge-sm {
        font-size: dt('badge.sm.font.size');
        min-width: dt('badge.sm.min.width');
        height: dt('badge.sm.height');
    }

    .p-badge-lg {
        font-size: dt('badge.lg.font.size');
        min-width: dt('badge.lg.min.width');
        height: dt('badge.lg.height');
    }

    .p-badge-xl {
        font-size: dt('badge.xl.font.size');
        min-width: dt('badge.xl.min.width');
        height: dt('badge.xl.height');
    }
`,tHe={root:function(e){var t=e.props,n=e.instance;return["p-badge p-component",{"p-badge-circle":Xr(t.value)&&String(t.value).length===1,"p-badge-dot":pa(t.value)&&!n.$slots.default,"p-badge-sm":t.size==="small","p-badge-lg":t.size==="large","p-badge-xl":t.size==="xlarge","p-badge-info":t.severity==="info","p-badge-success":t.severity==="success","p-badge-warn":t.severity==="warn","p-badge-danger":t.severity==="danger","p-badge-secondary":t.severity==="secondary","p-badge-contrast":t.severity==="contrast"}]}},rHe=cn.extend({name:"badge",style:eHe,classes:tHe}),nHe={name:"BaseBadge",extends:In,props:{value:{type:[String,Number],default:null},severity:{type:String,default:null},size:{type:String,default:null}},style:rHe,provide:function(){return{$pcBadge:this,$parentInstance:this}}};function vv(r){"@babel/helpers - typeof";return vv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vv(r)}function r$(r,e,t){return(e=iHe(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function iHe(r){var e=sHe(r,"string");return vv(e)=="symbol"?e:e+""}function sHe(r,e){if(vv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(vv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var mL={name:"Badge",extends:nHe,inheritAttrs:!1,computed:{dataP:function(){return wo(r$(r$({circle:this.value!=null&&String(this.value).length===1,empty:this.value==null&&!this.$slots.default},this.severity,this.severity),this.size,this.size))}}},oHe=["data-p"];function aHe(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("span",I.mergeProps({class:r.cx("root"),"data-p":s.dataP},r.ptmi("root")),[I.renderSlot(r.$slots,"default",{},function(){return[I.createTextVNode(I.toDisplayString(r.value),1)]})],16,oHe)}mL.render=aHe;var lHe=`
    .p-button {
        display: inline-flex;
        cursor: pointer;
        user-select: none;
        align-items: center;
        justify-content: center;
        overflow: hidden;
        position: relative;
        color: dt('button.primary.color');
        background: dt('button.primary.background');
        border: 1px solid dt('button.primary.border.color');
        padding: dt('button.padding.y') dt('button.padding.x');
        font-size: 1rem;
        font-family: inherit;
        font-feature-settings: inherit;
        transition:
            background dt('button.transition.duration'),
            color dt('button.transition.duration'),
            border-color dt('button.transition.duration'),
            outline-color dt('button.transition.duration'),
            box-shadow dt('button.transition.duration');
        border-radius: dt('button.border.radius');
        outline-color: transparent;
        gap: dt('button.gap');
    }

    .p-button:disabled {
        cursor: default;
    }

    .p-button-icon-right {
        order: 1;
    }

    .p-button-icon-right:dir(rtl) {
        order: -1;
    }

    .p-button:not(.p-button-vertical) .p-button-icon:not(.p-button-icon-right):dir(rtl) {
        order: 1;
    }

    .p-button-icon-bottom {
        order: 2;
    }

    .p-button-icon-only {
        width: dt('button.icon.only.width');
        padding-inline-start: 0;
        padding-inline-end: 0;
        gap: 0;
    }

    .p-button-icon-only.p-button-rounded {
        border-radius: 50%;
        height: dt('button.icon.only.width');
    }

    .p-button-icon-only .p-button-label {
        visibility: hidden;
        width: 0;
    }

    .p-button-icon-only::after {
        content: "\0A0";
        visibility: hidden;
        width: 0;
    }

    .p-button-sm {
        font-size: dt('button.sm.font.size');
        padding: dt('button.sm.padding.y') dt('button.sm.padding.x');
    }

    .p-button-sm .p-button-icon {
        font-size: dt('button.sm.font.size');
    }

    .p-button-sm.p-button-icon-only {
        width: dt('button.sm.icon.only.width');
    }

    .p-button-sm.p-button-icon-only.p-button-rounded {
        height: dt('button.sm.icon.only.width');
    }

    .p-button-lg {
        font-size: dt('button.lg.font.size');
        padding: dt('button.lg.padding.y') dt('button.lg.padding.x');
    }

    .p-button-lg .p-button-icon {
        font-size: dt('button.lg.font.size');
    }

    .p-button-lg.p-button-icon-only {
        width: dt('button.lg.icon.only.width');
    }

    .p-button-lg.p-button-icon-only.p-button-rounded {
        height: dt('button.lg.icon.only.width');
    }

    .p-button-vertical {
        flex-direction: column;
    }

    .p-button-label {
        font-weight: dt('button.label.font.weight');
    }

    .p-button-fluid {
        width: 100%;
    }

    .p-button-fluid.p-button-icon-only {
        width: dt('button.icon.only.width');
    }

    .p-button:not(:disabled):hover {
        background: dt('button.primary.hover.background');
        border: 1px solid dt('button.primary.hover.border.color');
        color: dt('button.primary.hover.color');
    }

    .p-button:not(:disabled):active {
        background: dt('button.primary.active.background');
        border: 1px solid dt('button.primary.active.border.color');
        color: dt('button.primary.active.color');
    }

    .p-button:focus-visible {
        box-shadow: dt('button.primary.focus.ring.shadow');
        outline: dt('button.focus.ring.width') dt('button.focus.ring.style') dt('button.primary.focus.ring.color');
        outline-offset: dt('button.focus.ring.offset');
    }

    .p-button .p-badge {
        min-width: dt('button.badge.size');
        height: dt('button.badge.size');
        line-height: dt('button.badge.size');
    }

    .p-button-raised {
        box-shadow: dt('button.raised.shadow');
    }

    .p-button-rounded {
        border-radius: dt('button.rounded.border.radius');
    }

    .p-button-secondary {
        background: dt('button.secondary.background');
        border: 1px solid dt('button.secondary.border.color');
        color: dt('button.secondary.color');
    }

    .p-button-secondary:not(:disabled):hover {
        background: dt('button.secondary.hover.background');
        border: 1px solid dt('button.secondary.hover.border.color');
        color: dt('button.secondary.hover.color');
    }

    .p-button-secondary:not(:disabled):active {
        background: dt('button.secondary.active.background');
        border: 1px solid dt('button.secondary.active.border.color');
        color: dt('button.secondary.active.color');
    }

    .p-button-secondary:focus-visible {
        outline-color: dt('button.secondary.focus.ring.color');
        box-shadow: dt('button.secondary.focus.ring.shadow');
    }

    .p-button-success {
        background: dt('button.success.background');
        border: 1px solid dt('button.success.border.color');
        color: dt('button.success.color');
    }

    .p-button-success:not(:disabled):hover {
        background: dt('button.success.hover.background');
        border: 1px solid dt('button.success.hover.border.color');
        color: dt('button.success.hover.color');
    }

    .p-button-success:not(:disabled):active {
        background: dt('button.success.active.background');
        border: 1px solid dt('button.success.active.border.color');
        color: dt('button.success.active.color');
    }

    .p-button-success:focus-visible {
        outline-color: dt('button.success.focus.ring.color');
        box-shadow: dt('button.success.focus.ring.shadow');
    }

    .p-button-info {
        background: dt('button.info.background');
        border: 1px solid dt('button.info.border.color');
        color: dt('button.info.color');
    }

    .p-button-info:not(:disabled):hover {
        background: dt('button.info.hover.background');
        border: 1px solid dt('button.info.hover.border.color');
        color: dt('button.info.hover.color');
    }

    .p-button-info:not(:disabled):active {
        background: dt('button.info.active.background');
        border: 1px solid dt('button.info.active.border.color');
        color: dt('button.info.active.color');
    }

    .p-button-info:focus-visible {
        outline-color: dt('button.info.focus.ring.color');
        box-shadow: dt('button.info.focus.ring.shadow');
    }

    .p-button-warn {
        background: dt('button.warn.background');
        border: 1px solid dt('button.warn.border.color');
        color: dt('button.warn.color');
    }

    .p-button-warn:not(:disabled):hover {
        background: dt('button.warn.hover.background');
        border: 1px solid dt('button.warn.hover.border.color');
        color: dt('button.warn.hover.color');
    }

    .p-button-warn:not(:disabled):active {
        background: dt('button.warn.active.background');
        border: 1px solid dt('button.warn.active.border.color');
        color: dt('button.warn.active.color');
    }

    .p-button-warn:focus-visible {
        outline-color: dt('button.warn.focus.ring.color');
        box-shadow: dt('button.warn.focus.ring.shadow');
    }

    .p-button-help {
        background: dt('button.help.background');
        border: 1px solid dt('button.help.border.color');
        color: dt('button.help.color');
    }

    .p-button-help:not(:disabled):hover {
        background: dt('button.help.hover.background');
        border: 1px solid dt('button.help.hover.border.color');
        color: dt('button.help.hover.color');
    }

    .p-button-help:not(:disabled):active {
        background: dt('button.help.active.background');
        border: 1px solid dt('button.help.active.border.color');
        color: dt('button.help.active.color');
    }

    .p-button-help:focus-visible {
        outline-color: dt('button.help.focus.ring.color');
        box-shadow: dt('button.help.focus.ring.shadow');
    }

    .p-button-danger {
        background: dt('button.danger.background');
        border: 1px solid dt('button.danger.border.color');
        color: dt('button.danger.color');
    }

    .p-button-danger:not(:disabled):hover {
        background: dt('button.danger.hover.background');
        border: 1px solid dt('button.danger.hover.border.color');
        color: dt('button.danger.hover.color');
    }

    .p-button-danger:not(:disabled):active {
        background: dt('button.danger.active.background');
        border: 1px solid dt('button.danger.active.border.color');
        color: dt('button.danger.active.color');
    }

    .p-button-danger:focus-visible {
        outline-color: dt('button.danger.focus.ring.color');
        box-shadow: dt('button.danger.focus.ring.shadow');
    }

    .p-button-contrast {
        background: dt('button.contrast.background');
        border: 1px solid dt('button.contrast.border.color');
        color: dt('button.contrast.color');
    }

    .p-button-contrast:not(:disabled):hover {
        background: dt('button.contrast.hover.background');
        border: 1px solid dt('button.contrast.hover.border.color');
        color: dt('button.contrast.hover.color');
    }

    .p-button-contrast:not(:disabled):active {
        background: dt('button.contrast.active.background');
        border: 1px solid dt('button.contrast.active.border.color');
        color: dt('button.contrast.active.color');
    }

    .p-button-contrast:focus-visible {
        outline-color: dt('button.contrast.focus.ring.color');
        box-shadow: dt('button.contrast.focus.ring.shadow');
    }

    .p-button-outlined {
        background: transparent;
        border-color: dt('button.outlined.primary.border.color');
        color: dt('button.outlined.primary.color');
    }

    .p-button-outlined:not(:disabled):hover {
        background: dt('button.outlined.primary.hover.background');
        border-color: dt('button.outlined.primary.border.color');
        color: dt('button.outlined.primary.color');
    }

    .p-button-outlined:not(:disabled):active {
        background: dt('button.outlined.primary.active.background');
        border-color: dt('button.outlined.primary.border.color');
        color: dt('button.outlined.primary.color');
    }

    .p-button-outlined.p-button-secondary {
        border-color: dt('button.outlined.secondary.border.color');
        color: dt('button.outlined.secondary.color');
    }

    .p-button-outlined.p-button-secondary:not(:disabled):hover {
        background: dt('button.outlined.secondary.hover.background');
        border-color: dt('button.outlined.secondary.border.color');
        color: dt('button.outlined.secondary.color');
    }

    .p-button-outlined.p-button-secondary:not(:disabled):active {
        background: dt('button.outlined.secondary.active.background');
        border-color: dt('button.outlined.secondary.border.color');
        color: dt('button.outlined.secondary.color');
    }

    .p-button-outlined.p-button-success {
        border-color: dt('button.outlined.success.border.color');
        color: dt('button.outlined.success.color');
    }

    .p-button-outlined.p-button-success:not(:disabled):hover {
        background: dt('button.outlined.success.hover.background');
        border-color: dt('button.outlined.success.border.color');
        color: dt('button.outlined.success.color');
    }

    .p-button-outlined.p-button-success:not(:disabled):active {
        background: dt('button.outlined.success.active.background');
        border-color: dt('button.outlined.success.border.color');
        color: dt('button.outlined.success.color');
    }

    .p-button-outlined.p-button-info {
        border-color: dt('button.outlined.info.border.color');
        color: dt('button.outlined.info.color');
    }

    .p-button-outlined.p-button-info:not(:disabled):hover {
        background: dt('button.outlined.info.hover.background');
        border-color: dt('button.outlined.info.border.color');
        color: dt('button.outlined.info.color');
    }

    .p-button-outlined.p-button-info:not(:disabled):active {
        background: dt('button.outlined.info.active.background');
        border-color: dt('button.outlined.info.border.color');
        color: dt('button.outlined.info.color');
    }

    .p-button-outlined.p-button-warn {
        border-color: dt('button.outlined.warn.border.color');
        color: dt('button.outlined.warn.color');
    }

    .p-button-outlined.p-button-warn:not(:disabled):hover {
        background: dt('button.outlined.warn.hover.background');
        border-color: dt('button.outlined.warn.border.color');
        color: dt('button.outlined.warn.color');
    }

    .p-button-outlined.p-button-warn:not(:disabled):active {
        background: dt('button.outlined.warn.active.background');
        border-color: dt('button.outlined.warn.border.color');
        color: dt('button.outlined.warn.color');
    }

    .p-button-outlined.p-button-help {
        border-color: dt('button.outlined.help.border.color');
        color: dt('button.outlined.help.color');
    }

    .p-button-outlined.p-button-help:not(:disabled):hover {
        background: dt('button.outlined.help.hover.background');
        border-color: dt('button.outlined.help.border.color');
        color: dt('button.outlined.help.color');
    }

    .p-button-outlined.p-button-help:not(:disabled):active {
        background: dt('button.outlined.help.active.background');
        border-color: dt('button.outlined.help.border.color');
        color: dt('button.outlined.help.color');
    }

    .p-button-outlined.p-button-danger {
        border-color: dt('button.outlined.danger.border.color');
        color: dt('button.outlined.danger.color');
    }

    .p-button-outlined.p-button-danger:not(:disabled):hover {
        background: dt('button.outlined.danger.hover.background');
        border-color: dt('button.outlined.danger.border.color');
        color: dt('button.outlined.danger.color');
    }

    .p-button-outlined.p-button-danger:not(:disabled):active {
        background: dt('button.outlined.danger.active.background');
        border-color: dt('button.outlined.danger.border.color');
        color: dt('button.outlined.danger.color');
    }

    .p-button-outlined.p-button-contrast {
        border-color: dt('button.outlined.contrast.border.color');
        color: dt('button.outlined.contrast.color');
    }

    .p-button-outlined.p-button-contrast:not(:disabled):hover {
        background: dt('button.outlined.contrast.hover.background');
        border-color: dt('button.outlined.contrast.border.color');
        color: dt('button.outlined.contrast.color');
    }

    .p-button-outlined.p-button-contrast:not(:disabled):active {
        background: dt('button.outlined.contrast.active.background');
        border-color: dt('button.outlined.contrast.border.color');
        color: dt('button.outlined.contrast.color');
    }

    .p-button-outlined.p-button-plain {
        border-color: dt('button.outlined.plain.border.color');
        color: dt('button.outlined.plain.color');
    }

    .p-button-outlined.p-button-plain:not(:disabled):hover {
        background: dt('button.outlined.plain.hover.background');
        border-color: dt('button.outlined.plain.border.color');
        color: dt('button.outlined.plain.color');
    }

    .p-button-outlined.p-button-plain:not(:disabled):active {
        background: dt('button.outlined.plain.active.background');
        border-color: dt('button.outlined.plain.border.color');
        color: dt('button.outlined.plain.color');
    }

    .p-button-text {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.primary.color');
    }

    .p-button-text:not(:disabled):hover {
        background: dt('button.text.primary.hover.background');
        border-color: transparent;
        color: dt('button.text.primary.color');
    }

    .p-button-text:not(:disabled):active {
        background: dt('button.text.primary.active.background');
        border-color: transparent;
        color: dt('button.text.primary.color');
    }

    .p-button-text.p-button-secondary {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.secondary.color');
    }

    .p-button-text.p-button-secondary:not(:disabled):hover {
        background: dt('button.text.secondary.hover.background');
        border-color: transparent;
        color: dt('button.text.secondary.color');
    }

    .p-button-text.p-button-secondary:not(:disabled):active {
        background: dt('button.text.secondary.active.background');
        border-color: transparent;
        color: dt('button.text.secondary.color');
    }

    .p-button-text.p-button-success {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.success.color');
    }

    .p-button-text.p-button-success:not(:disabled):hover {
        background: dt('button.text.success.hover.background');
        border-color: transparent;
        color: dt('button.text.success.color');
    }

    .p-button-text.p-button-success:not(:disabled):active {
        background: dt('button.text.success.active.background');
        border-color: transparent;
        color: dt('button.text.success.color');
    }

    .p-button-text.p-button-info {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.info.color');
    }

    .p-button-text.p-button-info:not(:disabled):hover {
        background: dt('button.text.info.hover.background');
        border-color: transparent;
        color: dt('button.text.info.color');
    }

    .p-button-text.p-button-info:not(:disabled):active {
        background: dt('button.text.info.active.background');
        border-color: transparent;
        color: dt('button.text.info.color');
    }

    .p-button-text.p-button-warn {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.warn.color');
    }

    .p-button-text.p-button-warn:not(:disabled):hover {
        background: dt('button.text.warn.hover.background');
        border-color: transparent;
        color: dt('button.text.warn.color');
    }

    .p-button-text.p-button-warn:not(:disabled):active {
        background: dt('button.text.warn.active.background');
        border-color: transparent;
        color: dt('button.text.warn.color');
    }

    .p-button-text.p-button-help {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.help.color');
    }

    .p-button-text.p-button-help:not(:disabled):hover {
        background: dt('button.text.help.hover.background');
        border-color: transparent;
        color: dt('button.text.help.color');
    }

    .p-button-text.p-button-help:not(:disabled):active {
        background: dt('button.text.help.active.background');
        border-color: transparent;
        color: dt('button.text.help.color');
    }

    .p-button-text.p-button-danger {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.danger.color');
    }

    .p-button-text.p-button-danger:not(:disabled):hover {
        background: dt('button.text.danger.hover.background');
        border-color: transparent;
        color: dt('button.text.danger.color');
    }

    .p-button-text.p-button-danger:not(:disabled):active {
        background: dt('button.text.danger.active.background');
        border-color: transparent;
        color: dt('button.text.danger.color');
    }

    .p-button-text.p-button-contrast {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.contrast.color');
    }

    .p-button-text.p-button-contrast:not(:disabled):hover {
        background: dt('button.text.contrast.hover.background');
        border-color: transparent;
        color: dt('button.text.contrast.color');
    }

    .p-button-text.p-button-contrast:not(:disabled):active {
        background: dt('button.text.contrast.active.background');
        border-color: transparent;
        color: dt('button.text.contrast.color');
    }

    .p-button-text.p-button-plain {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.plain.color');
    }

    .p-button-text.p-button-plain:not(:disabled):hover {
        background: dt('button.text.plain.hover.background');
        border-color: transparent;
        color: dt('button.text.plain.color');
    }

    .p-button-text.p-button-plain:not(:disabled):active {
        background: dt('button.text.plain.active.background');
        border-color: transparent;
        color: dt('button.text.plain.color');
    }

    .p-button-link {
        background: transparent;
        border-color: transparent;
        color: dt('button.link.color');
    }

    .p-button-link:not(:disabled):hover {
        background: transparent;
        border-color: transparent;
        color: dt('button.link.hover.color');
    }

    .p-button-link:not(:disabled):hover .p-button-label {
        text-decoration: underline;
    }

    .p-button-link:not(:disabled):active {
        background: transparent;
        border-color: transparent;
        color: dt('button.link.active.color');
    }
`;function Av(r){"@babel/helpers - typeof";return Av=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Av(r)}function Ic(r,e,t){return(e=cHe(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function cHe(r){var e=uHe(r,"string");return Av(e)=="symbol"?e:e+""}function uHe(r,e){if(Av(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(Av(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var hHe={root:function(e){var t=e.instance,n=e.props;return["p-button p-component",Ic(Ic(Ic(Ic(Ic(Ic(Ic(Ic(Ic({"p-button-icon-only":t.hasIcon&&!n.label&&!n.badge,"p-button-vertical":(n.iconPos==="top"||n.iconPos==="bottom")&&n.label,"p-button-loading":n.loading,"p-button-link":n.link||n.variant==="link"},"p-button-".concat(n.severity),n.severity),"p-button-raised",n.raised),"p-button-rounded",n.rounded),"p-button-text",n.text||n.variant==="text"),"p-button-outlined",n.outlined||n.variant==="outlined"),"p-button-sm",n.size==="small"),"p-button-lg",n.size==="large"),"p-button-plain",n.plain),"p-button-fluid",t.hasFluid)]},loadingIcon:"p-button-loading-icon",icon:function(e){var t=e.props;return["p-button-icon",Ic({},"p-button-icon-".concat(t.iconPos),t.label)]},label:"p-button-label"},dHe=cn.extend({name:"button",style:lHe,classes:hHe}),fHe={name:"BaseButton",extends:In,props:{label:{type:String,default:null},icon:{type:String,default:null},iconPos:{type:String,default:"left"},iconClass:{type:[String,Object],default:null},badge:{type:String,default:null},badgeClass:{type:[String,Object],default:null},badgeSeverity:{type:String,default:"secondary"},loading:{type:Boolean,default:!1},loadingIcon:{type:String,default:void 0},as:{type:[String,Object],default:"BUTTON"},asChild:{type:Boolean,default:!1},link:{type:Boolean,default:!1},severity:{type:String,default:null},raised:{type:Boolean,default:!1},rounded:{type:Boolean,default:!1},text:{type:Boolean,default:!1},outlined:{type:Boolean,default:!1},size:{type:String,default:null},variant:{type:String,default:null},plain:{type:Boolean,default:!1},fluid:{type:Boolean,default:null}},style:dHe,provide:function(){return{$pcButton:this,$parentInstance:this}}};function xv(r){"@babel/helpers - typeof";return xv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xv(r)}function ea(r,e,t){return(e=pHe(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function pHe(r){var e=gHe(r,"string");return xv(e)=="symbol"?e:e+""}function gHe(r,e){if(xv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(xv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var wv={name:"Button",extends:fHe,inheritAttrs:!1,inject:{$pcFluid:{default:null}},methods:{getPTOptions:function(e){var t=e==="root"?this.ptmi:this.ptm;return t(e,{context:{disabled:this.disabled}})}},computed:{disabled:function(){return this.$attrs.disabled||this.$attrs.disabled===""||this.loading},defaultAriaLabel:function(){return this.label?this.label+(this.badge?" "+this.badge:""):this.$attrs.ariaLabel},hasIcon:function(){return this.icon||this.$slots.icon},attrs:function(){return I.mergeProps(this.asAttrs,this.a11yAttrs,this.getPTOptions("root"))},asAttrs:function(){return this.as==="BUTTON"?{type:"button",disabled:this.disabled}:void 0},a11yAttrs:function(){return{"aria-label":this.defaultAriaLabel,"data-pc-name":"button","data-p-disabled":this.disabled,"data-p-severity":this.severity}},hasFluid:function(){return pa(this.fluid)?!!this.$pcFluid:this.fluid},dataP:function(){return wo(ea(ea(ea(ea(ea(ea(ea(ea(ea(ea({},this.size,this.size),"icon-only",this.hasIcon&&!this.label&&!this.badge),"loading",this.loading),"fluid",this.hasFluid),"rounded",this.rounded),"raised",this.raised),"outlined",this.outlined||this.variant==="outlined"),"text",this.text||this.variant==="text"),"link",this.link||this.variant==="link"),"vertical",(this.iconPos==="top"||this.iconPos==="bottom")&&this.label))},dataIconP:function(){return wo(ea(ea({},this.iconPos,this.iconPos),this.size,this.size))},dataLabelP:function(){return wo(ea(ea({},this.size,this.size),"icon-only",this.hasIcon&&!this.label&&!this.badge))}},components:{SpinnerIcon:aA,Badge:mL},directives:{ripple:Pd}},mHe=["data-p"],yHe=["data-p"];function bHe(r,e,t,n,i,s){var a=I.resolveComponent("SpinnerIcon"),o=I.resolveComponent("Badge"),u=I.resolveDirective("ripple");return r.asChild?I.renderSlot(r.$slots,"default",{key:1,class:I.normalizeClass(r.cx("root")),a11yAttrs:s.a11yAttrs}):I.withDirectives((I.openBlock(),I.createBlock(I.resolveDynamicComponent(r.as),I.mergeProps({key:0,class:r.cx("root"),"data-p":s.dataP},s.attrs),{default:I.withCtx(function(){return[I.renderSlot(r.$slots,"default",{},function(){return[r.loading?I.renderSlot(r.$slots,"loadingicon",I.mergeProps({key:0,class:[r.cx("loadingIcon"),r.cx("icon")]},r.ptm("loadingIcon")),function(){return[r.loadingIcon?(I.openBlock(),I.createElementBlock("span",I.mergeProps({key:0,class:[r.cx("loadingIcon"),r.cx("icon"),r.loadingIcon]},r.ptm("loadingIcon")),null,16)):(I.openBlock(),I.createBlock(a,I.mergeProps({key:1,class:[r.cx("loadingIcon"),r.cx("icon")],spin:""},r.ptm("loadingIcon")),null,16,["class"]))]}):I.renderSlot(r.$slots,"icon",I.mergeProps({key:1,class:[r.cx("icon")]},r.ptm("icon")),function(){return[r.icon?(I.openBlock(),I.createElementBlock("span",I.mergeProps({key:0,class:[r.cx("icon"),r.icon,r.iconClass],"data-p":s.dataIconP},r.ptm("icon")),null,16,mHe)):I.createCommentVNode("",!0)]}),r.label?(I.openBlock(),I.createElementBlock("span",I.mergeProps({key:2,class:r.cx("label")},r.ptm("label"),{"data-p":s.dataLabelP}),I.toDisplayString(r.label),17,yHe)):I.createCommentVNode("",!0),r.badge?(I.openBlock(),I.createBlock(o,{key:3,value:r.badge,class:I.normalizeClass(r.badgeClass),severity:r.badgeSeverity,unstyled:r.unstyled,pt:r.ptm("pcBadge")},null,8,["value","class","severity","unstyled","pt"])):I.createCommentVNode("",!0)]})]}),_:3},16,["class","data-p"])),[[u]])}wv.render=bHe;var qZ={name:"MinusIcon",extends:gi};function _He(r){return wHe(r)||xHe(r)||AHe(r)||vHe()}function vHe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AHe(r,e){if(r){if(typeof r=="string")return ZM(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?ZM(r,e):void 0}}function xHe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function wHe(r){if(Array.isArray(r))return ZM(r)}function ZM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function CHe(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),_He(e[0]||(e[0]=[I.createElementVNode("path",{d:"M13.2222 7.77778H0.777778C0.571498 7.77778 0.373667 7.69584 0.227806 7.54998C0.0819442 7.40412 0 7.20629 0 7.00001C0 6.79373 0.0819442 6.5959 0.227806 6.45003C0.373667 6.30417 0.571498 6.22223 0.777778 6.22223H13.2222C13.4285 6.22223 13.6263 6.30417 13.7722 6.45003C13.9181 6.5959 14 6.79373 14 7.00001C14 7.20629 13.9181 7.40412 13.7722 7.54998C13.6263 7.69584 13.4285 7.77778 13.2222 7.77778Z",fill:"currentColor"},null,-1)])),16)}qZ.render=CHe;var THe=`
    .p-checkbox {
        position: relative;
        display: inline-flex;
        user-select: none;
        vertical-align: bottom;
        width: dt('checkbox.width');
        height: dt('checkbox.height');
    }

    .p-checkbox-input {
        cursor: pointer;
        appearance: none;
        position: absolute;
        inset-block-start: 0;
        inset-inline-start: 0;
        width: 100%;
        height: 100%;
        padding: 0;
        margin: 0;
        opacity: 0;
        z-index: 1;
        outline: 0 none;
        border: 1px solid transparent;
        border-radius: dt('checkbox.border.radius');
    }

    .p-checkbox-box {
        display: flex;
        justify-content: center;
        align-items: center;
        border-radius: dt('checkbox.border.radius');
        border: 1px solid dt('checkbox.border.color');
        background: dt('checkbox.background');
        width: dt('checkbox.width');
        height: dt('checkbox.height');
        transition:
            background dt('checkbox.transition.duration'),
            color dt('checkbox.transition.duration'),
            border-color dt('checkbox.transition.duration'),
            box-shadow dt('checkbox.transition.duration'),
            outline-color dt('checkbox.transition.duration');
        outline-color: transparent;
        box-shadow: dt('checkbox.shadow');
    }

    .p-checkbox-icon {
        transition-duration: dt('checkbox.transition.duration');
        color: dt('checkbox.icon.color');
        font-size: dt('checkbox.icon.size');
        width: dt('checkbox.icon.size');
        height: dt('checkbox.icon.size');
    }

    .p-checkbox:not(.p-disabled):has(.p-checkbox-input:hover) .p-checkbox-box {
        border-color: dt('checkbox.hover.border.color');
    }

    .p-checkbox-checked .p-checkbox-box {
        border-color: dt('checkbox.checked.border.color');
        background: dt('checkbox.checked.background');
    }

    .p-checkbox-checked .p-checkbox-icon {
        color: dt('checkbox.icon.checked.color');
    }

    .p-checkbox-checked:not(.p-disabled):has(.p-checkbox-input:hover) .p-checkbox-box {
        background: dt('checkbox.checked.hover.background');
        border-color: dt('checkbox.checked.hover.border.color');
    }

    .p-checkbox-checked:not(.p-disabled):has(.p-checkbox-input:hover) .p-checkbox-icon {
        color: dt('checkbox.icon.checked.hover.color');
    }

    .p-checkbox:not(.p-disabled):has(.p-checkbox-input:focus-visible) .p-checkbox-box {
        border-color: dt('checkbox.focus.border.color');
        box-shadow: dt('checkbox.focus.ring.shadow');
        outline: dt('checkbox.focus.ring.width') dt('checkbox.focus.ring.style') dt('checkbox.focus.ring.color');
        outline-offset: dt('checkbox.focus.ring.offset');
    }

    .p-checkbox-checked:not(.p-disabled):has(.p-checkbox-input:focus-visible) .p-checkbox-box {
        border-color: dt('checkbox.checked.focus.border.color');
    }

    .p-checkbox.p-invalid > .p-checkbox-box {
        border-color: dt('checkbox.invalid.border.color');
    }

    .p-checkbox.p-variant-filled .p-checkbox-box {
        background: dt('checkbox.filled.background');
    }

    .p-checkbox-checked.p-variant-filled .p-checkbox-box {
        background: dt('checkbox.checked.background');
    }

    .p-checkbox-checked.p-variant-filled:not(.p-disabled):has(.p-checkbox-input:hover) .p-checkbox-box {
        background: dt('checkbox.checked.hover.background');
    }

    .p-checkbox.p-disabled {
        opacity: 1;
    }

    .p-checkbox.p-disabled .p-checkbox-box {
        background: dt('checkbox.disabled.background');
        border-color: dt('checkbox.checked.disabled.border.color');
    }

    .p-checkbox.p-disabled .p-checkbox-box .p-checkbox-icon {
        color: dt('checkbox.icon.disabled.color');
    }

    .p-checkbox-sm,
    .p-checkbox-sm .p-checkbox-box {
        width: dt('checkbox.sm.width');
        height: dt('checkbox.sm.height');
    }

    .p-checkbox-sm .p-checkbox-icon {
        font-size: dt('checkbox.icon.sm.size');
        width: dt('checkbox.icon.sm.size');
        height: dt('checkbox.icon.sm.size');
    }

    .p-checkbox-lg,
    .p-checkbox-lg .p-checkbox-box {
        width: dt('checkbox.lg.width');
        height: dt('checkbox.lg.height');
    }

    .p-checkbox-lg .p-checkbox-icon {
        font-size: dt('checkbox.icon.lg.size');
        width: dt('checkbox.icon.lg.size');
        height: dt('checkbox.icon.lg.size');
    }
`,SHe={root:function(e){var t=e.instance,n=e.props;return["p-checkbox p-component",{"p-checkbox-checked":t.checked,"p-disabled":n.disabled,"p-invalid":t.$pcCheckboxGroup?t.$pcCheckboxGroup.$invalid:t.$invalid,"p-variant-filled":t.$variant==="filled","p-checkbox-sm p-inputfield-sm":n.size==="small","p-checkbox-lg p-inputfield-lg":n.size==="large"}]},box:"p-checkbox-box",input:"p-checkbox-input",icon:"p-checkbox-icon"},EHe=cn.extend({name:"checkbox",style:THe,classes:SHe}),IHe={name:"BaseCheckbox",extends:lA,props:{value:null,binary:Boolean,indeterminate:{type:Boolean,default:!1},trueValue:{type:null,default:!0},falseValue:{type:null,default:!1},readonly:{type:Boolean,default:!1},required:{type:Boolean,default:!1},tabindex:{type:Number,default:null},inputId:{type:String,default:null},inputClass:{type:[String,Object],default:null},inputStyle:{type:Object,default:null},ariaLabelledby:{type:String,default:null},ariaLabel:{type:String,default:null}},style:EHe,provide:function(){return{$pcCheckbox:this,$parentInstance:this}}};function Cv(r){"@babel/helpers - typeof";return Cv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cv(r)}function PHe(r,e,t){return(e=BHe(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function BHe(r){var e=MHe(r,"string");return Cv(e)=="symbol"?e:e+""}function MHe(r,e){if(Cv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(Cv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function RHe(r){return LHe(r)||DHe(r)||OHe(r)||kHe()}function kHe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OHe(r,e){if(r){if(typeof r=="string")return QM(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?QM(r,e):void 0}}function DHe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function LHe(r){if(Array.isArray(r))return QM(r)}function QM(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}var yL={name:"Checkbox",extends:IHe,inheritAttrs:!1,emits:["change","focus","blur","update:indeterminate"],inject:{$pcCheckboxGroup:{default:void 0}},data:function(){return{d_indeterminate:this.indeterminate}},watch:{indeterminate:function(e){this.d_indeterminate=e,this.updateIndeterminate()}},mounted:function(){this.updateIndeterminate()},updated:function(){this.updateIndeterminate()},methods:{getPTOptions:function(e){var t=e==="root"?this.ptmi:this.ptm;return t(e,{context:{checked:this.checked,indeterminate:this.d_indeterminate,disabled:this.disabled}})},onChange:function(e){var t=this;if(!this.disabled&&!this.readonly){var n=this.$pcCheckboxGroup?this.$pcCheckboxGroup.d_value:this.d_value,i;this.binary?i=this.d_indeterminate?this.trueValue:this.checked?this.falseValue:this.trueValue:this.checked||this.d_indeterminate?i=n.filter(function(s){return!Ip(s,t.value)}):i=n?[].concat(RHe(n),[this.value]):[this.value],this.d_indeterminate&&(this.d_indeterminate=!1,this.$emit("update:indeterminate",this.d_indeterminate)),this.$pcCheckboxGroup?this.$pcCheckboxGroup.writeValue(i,e):this.writeValue(i,e),this.$emit("change",e)}},onFocus:function(e){this.$emit("focus",e)},onBlur:function(e){var t,n;this.$emit("blur",e),(t=(n=this.formField).onBlur)===null||t===void 0||t.call(n,e)},updateIndeterminate:function(){this.$refs.input&&(this.$refs.input.indeterminate=this.d_indeterminate)}},computed:{groupName:function(){return this.$pcCheckboxGroup?this.$pcCheckboxGroup.groupName:this.$formName},checked:function(){var e=this.$pcCheckboxGroup?this.$pcCheckboxGroup.d_value:this.d_value;return this.d_indeterminate?!1:this.binary?e===this.trueValue:eVe(this.value,e)},dataP:function(){return wo(PHe({invalid:this.$invalid,checked:this.checked,disabled:this.disabled,filled:this.$variant==="filled"},this.size,this.size))}},components:{CheckIcon:Dy,MinusIcon:qZ}},NHe=["data-p-checked","data-p-indeterminate","data-p-disabled","data-p"],FHe=["id","value","name","checked","tabindex","disabled","readonly","required","aria-labelledby","aria-label","aria-invalid"],UHe=["data-p"];function zHe(r,e,t,n,i,s){var a=I.resolveComponent("CheckIcon"),o=I.resolveComponent("MinusIcon");return I.openBlock(),I.createElementBlock("div",I.mergeProps({class:r.cx("root")},s.getPTOptions("root"),{"data-p-checked":s.checked,"data-p-indeterminate":i.d_indeterminate||void 0,"data-p-disabled":r.disabled,"data-p":s.dataP}),[I.createElementVNode("input",I.mergeProps({ref:"input",id:r.inputId,type:"checkbox",class:[r.cx("input"),r.inputClass],style:r.inputStyle,value:r.value,name:s.groupName,checked:s.checked,tabindex:r.tabindex,disabled:r.disabled,readonly:r.readonly,required:r.required,"aria-labelledby":r.ariaLabelledby,"aria-label":r.ariaLabel,"aria-invalid":r.invalid||void 0,onFocus:e[0]||(e[0]=function(){return s.onFocus&&s.onFocus.apply(s,arguments)}),onBlur:e[1]||(e[1]=function(){return s.onBlur&&s.onBlur.apply(s,arguments)}),onChange:e[2]||(e[2]=function(){return s.onChange&&s.onChange.apply(s,arguments)})},s.getPTOptions("input")),null,16,FHe),I.createElementVNode("div",I.mergeProps({class:r.cx("box")},s.getPTOptions("box"),{"data-p":s.dataP}),[I.renderSlot(r.$slots,"icon",{checked:s.checked,indeterminate:i.d_indeterminate,class:I.normalizeClass(r.cx("icon")),dataP:s.dataP},function(){return[s.checked?(I.openBlock(),I.createBlock(a,I.mergeProps({key:0,class:r.cx("icon")},s.getPTOptions("icon"),{"data-p":s.dataP}),null,16,["class","data-p"])):i.d_indeterminate?(I.openBlock(),I.createBlock(o,I.mergeProps({key:1,class:r.cx("icon")},s.getPTOptions("icon"),{"data-p":s.dataP}),null,16,["class","data-p"])):I.createCommentVNode("",!0)]})],16,UHe)],16,NHe)}yL.render=zHe;var VHe=`
    .p-radiobutton {
        position: relative;
        display: inline-flex;
        user-select: none;
        vertical-align: bottom;
        width: dt('radiobutton.width');
        height: dt('radiobutton.height');
    }

    .p-radiobutton-input {
        cursor: pointer;
        appearance: none;
        position: absolute;
        top: 0;
        inset-inline-start: 0;
        width: 100%;
        height: 100%;
        padding: 0;
        margin: 0;
        opacity: 0;
        z-index: 1;
        outline: 0 none;
        border: 1px solid transparent;
        border-radius: 50%;
    }

    .p-radiobutton-box {
        display: flex;
        justify-content: center;
        align-items: center;
        border-radius: 50%;
        border: 1px solid dt('radiobutton.border.color');
        background: dt('radiobutton.background');
        width: dt('radiobutton.width');
        height: dt('radiobutton.height');
        transition:
            background dt('radiobutton.transition.duration'),
            color dt('radiobutton.transition.duration'),
            border-color dt('radiobutton.transition.duration'),
            box-shadow dt('radiobutton.transition.duration'),
            outline-color dt('radiobutton.transition.duration');
        outline-color: transparent;
        box-shadow: dt('radiobutton.shadow');
    }

    .p-radiobutton-icon {
        transition-duration: dt('radiobutton.transition.duration');
        background: transparent;
        font-size: dt('radiobutton.icon.size');
        width: dt('radiobutton.icon.size');
        height: dt('radiobutton.icon.size');
        border-radius: 50%;
        backface-visibility: hidden;
        transform: translateZ(0) scale(0.1);
    }

    .p-radiobutton:not(.p-disabled):has(.p-radiobutton-input:hover) .p-radiobutton-box {
        border-color: dt('radiobutton.hover.border.color');
    }

    .p-radiobutton-checked .p-radiobutton-box {
        border-color: dt('radiobutton.checked.border.color');
        background: dt('radiobutton.checked.background');
    }

    .p-radiobutton-checked .p-radiobutton-box .p-radiobutton-icon {
        background: dt('radiobutton.icon.checked.color');
        transform: translateZ(0) scale(1, 1);
        visibility: visible;
    }

    .p-radiobutton-checked:not(.p-disabled):has(.p-radiobutton-input:hover) .p-radiobutton-box {
        border-color: dt('radiobutton.checked.hover.border.color');
        background: dt('radiobutton.checked.hover.background');
    }

    .p-radiobutton:not(.p-disabled):has(.p-radiobutton-input:hover).p-radiobutton-checked .p-radiobutton-box .p-radiobutton-icon {
        background: dt('radiobutton.icon.checked.hover.color');
    }

    .p-radiobutton:not(.p-disabled):has(.p-radiobutton-input:focus-visible) .p-radiobutton-box {
        border-color: dt('radiobutton.focus.border.color');
        box-shadow: dt('radiobutton.focus.ring.shadow');
        outline: dt('radiobutton.focus.ring.width') dt('radiobutton.focus.ring.style') dt('radiobutton.focus.ring.color');
        outline-offset: dt('radiobutton.focus.ring.offset');
    }

    .p-radiobutton-checked:not(.p-disabled):has(.p-radiobutton-input:focus-visible) .p-radiobutton-box {
        border-color: dt('radiobutton.checked.focus.border.color');
    }

    .p-radiobutton.p-invalid > .p-radiobutton-box {
        border-color: dt('radiobutton.invalid.border.color');
    }

    .p-radiobutton.p-variant-filled .p-radiobutton-box {
        background: dt('radiobutton.filled.background');
    }

    .p-radiobutton.p-variant-filled.p-radiobutton-checked .p-radiobutton-box {
        background: dt('radiobutton.checked.background');
    }

    .p-radiobutton.p-variant-filled:not(.p-disabled):has(.p-radiobutton-input:hover).p-radiobutton-checked .p-radiobutton-box {
        background: dt('radiobutton.checked.hover.background');
    }

    .p-radiobutton.p-disabled {
        opacity: 1;
    }

    .p-radiobutton.p-disabled .p-radiobutton-box {
        background: dt('radiobutton.disabled.background');
        border-color: dt('radiobutton.checked.disabled.border.color');
    }

    .p-radiobutton-checked.p-disabled .p-radiobutton-box .p-radiobutton-icon {
        background: dt('radiobutton.icon.disabled.color');
    }

    .p-radiobutton-sm,
    .p-radiobutton-sm .p-radiobutton-box {
        width: dt('radiobutton.sm.width');
        height: dt('radiobutton.sm.height');
    }

    .p-radiobutton-sm .p-radiobutton-icon {
        font-size: dt('radiobutton.icon.sm.size');
        width: dt('radiobutton.icon.sm.size');
        height: dt('radiobutton.icon.sm.size');
    }

    .p-radiobutton-lg,
    .p-radiobutton-lg .p-radiobutton-box {
        width: dt('radiobutton.lg.width');
        height: dt('radiobutton.lg.height');
    }

    .p-radiobutton-lg .p-radiobutton-icon {
        font-size: dt('radiobutton.icon.lg.size');
        width: dt('radiobutton.icon.lg.size');
        height: dt('radiobutton.icon.lg.size');
    }
`,$He={root:function(e){var t=e.instance,n=e.props;return["p-radiobutton p-component",{"p-radiobutton-checked":t.checked,"p-disabled":n.disabled,"p-invalid":t.$pcRadioButtonGroup?t.$pcRadioButtonGroup.$invalid:t.$invalid,"p-variant-filled":t.$variant==="filled","p-radiobutton-sm p-inputfield-sm":n.size==="small","p-radiobutton-lg p-inputfield-lg":n.size==="large"}]},box:"p-radiobutton-box",input:"p-radiobutton-input",icon:"p-radiobutton-icon"},jHe=cn.extend({name:"radiobutton",style:VHe,classes:$He}),GHe={name:"BaseRadioButton",extends:lA,props:{value:null,binary:Boolean,readonly:{type:Boolean,default:!1},tabindex:{type:Number,default:null},inputId:{type:String,default:null},inputClass:{type:[String,Object],default:null},inputStyle:{type:Object,default:null},ariaLabelledby:{type:String,default:null},ariaLabel:{type:String,default:null}},style:jHe,provide:function(){return{$pcRadioButton:this,$parentInstance:this}}};function Tv(r){"@babel/helpers - typeof";return Tv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tv(r)}function HHe(r,e,t){return(e=WHe(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function WHe(r){var e=KHe(r,"string");return Tv(e)=="symbol"?e:e+""}function KHe(r,e){if(Tv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(Tv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var YZ={name:"RadioButton",extends:GHe,inheritAttrs:!1,emits:["change","focus","blur"],inject:{$pcRadioButtonGroup:{default:void 0}},methods:{getPTOptions:function(e){var t=e==="root"?this.ptmi:this.ptm;return t(e,{context:{checked:this.checked,disabled:this.disabled}})},onChange:function(e){if(!this.disabled&&!this.readonly){var t=this.binary?!this.checked:this.value;this.$pcRadioButtonGroup?this.$pcRadioButtonGroup.writeValue(t,e):this.writeValue(t,e),this.$emit("change",e)}},onFocus:function(e){this.$emit("focus",e)},onBlur:function(e){var t,n;this.$emit("blur",e),(t=(n=this.formField).onBlur)===null||t===void 0||t.call(n,e)}},computed:{groupName:function(){return this.$pcRadioButtonGroup?this.$pcRadioButtonGroup.groupName:this.$formName},checked:function(){var e=this.$pcRadioButtonGroup?this.$pcRadioButtonGroup.d_value:this.d_value;return e!=null&&(this.binary?!!e:Ip(e,this.value))},dataP:function(){return wo(HHe({invalid:this.$invalid,checked:this.checked,disabled:this.disabled,filled:this.$variant==="filled"},this.size,this.size))}}},XHe=["data-p-checked","data-p-disabled","data-p"],JHe=["id","value","name","checked","tabindex","disabled","readonly","aria-labelledby","aria-label","aria-invalid"],qHe=["data-p"],YHe=["data-p"];function ZHe(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("div",I.mergeProps({class:r.cx("root")},s.getPTOptions("root"),{"data-p-checked":s.checked,"data-p-disabled":r.disabled,"data-p":s.dataP}),[I.createElementVNode("input",I.mergeProps({id:r.inputId,type:"radio",class:[r.cx("input"),r.inputClass],style:r.inputStyle,value:r.value,name:s.groupName,checked:s.checked,tabindex:r.tabindex,disabled:r.disabled,readonly:r.readonly,"aria-labelledby":r.ariaLabelledby,"aria-label":r.ariaLabel,"aria-invalid":r.invalid||void 0,onFocus:e[0]||(e[0]=function(){return s.onFocus&&s.onFocus.apply(s,arguments)}),onBlur:e[1]||(e[1]=function(){return s.onBlur&&s.onBlur.apply(s,arguments)}),onChange:e[2]||(e[2]=function(){return s.onChange&&s.onChange.apply(s,arguments)})},s.getPTOptions("input")),null,16,JHe),I.createElementVNode("div",I.mergeProps({class:r.cx("box")},s.getPTOptions("box"),{"data-p":s.dataP}),[I.createElementVNode("div",I.mergeProps({class:r.cx("icon")},s.getPTOptions("icon"),{"data-p":s.dataP}),null,16,YHe)],16,qHe)],16,XHe)}YZ.render=ZHe;var ZZ={name:"FilterIcon",extends:gi};function QHe(r){return nWe(r)||rWe(r)||tWe(r)||eWe()}function eWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tWe(r,e){if(r){if(typeof r=="string")return eR(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?eR(r,e):void 0}}function rWe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function nWe(r){if(Array.isArray(r))return eR(r)}function eR(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function iWe(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),QHe(e[0]||(e[0]=[I.createElementVNode("path",{d:"M8.64708 14H5.35296C5.18981 13.9979 5.03395 13.9321 4.91858 13.8167C4.8032 13.7014 4.73745 13.5455 4.73531 13.3824V7L0.329431 0.98C0.259794 0.889466 0.217389 0.780968 0.20718 0.667208C0.19697 0.553448 0.219379 0.439133 0.271783 0.337647C0.324282 0.236453 0.403423 0.151519 0.500663 0.0920138C0.597903 0.0325088 0.709548 0.000692754 0.823548 0H13.1765C13.2905 0.000692754 13.4021 0.0325088 13.4994 0.0920138C13.5966 0.151519 13.6758 0.236453 13.7283 0.337647C13.7807 0.439133 13.8031 0.553448 13.7929 0.667208C13.7826 0.780968 13.7402 0.889466 13.6706 0.98L9.26472 7V13.3824C9.26259 13.5455 9.19683 13.7014 9.08146 13.8167C8.96609 13.9321 8.81022 13.9979 8.64708 14ZM5.97061 12.7647H8.02943V6.79412C8.02878 6.66289 8.07229 6.53527 8.15296 6.43177L11.9412 1.23529H2.05884L5.86355 6.43177C5.94422 6.53527 5.98773 6.66289 5.98708 6.79412L5.97061 12.7647Z",fill:"currentColor"},null,-1)])),16)}ZZ.render=iWe;var QZ={name:"FilterFillIcon",extends:gi};function sWe(r){return cWe(r)||lWe(r)||aWe(r)||oWe()}function oWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aWe(r,e){if(r){if(typeof r=="string")return tR(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?tR(r,e):void 0}}function lWe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function cWe(r){if(Array.isArray(r))return tR(r)}function tR(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function uWe(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),sWe(e[0]||(e[0]=[I.createElementVNode("path",{d:"M13.7274 0.33847C13.6228 0.130941 13.4095 0 13.1764 0H0.82351C0.590451 0 0.377157 0.130941 0.272568 0.33847C0.167157 0.545999 0.187746 0.795529 0.325275 0.98247L4.73527 6.99588V13.3824C4.73527 13.7233 5.01198 14 5.35292 14H8.64704C8.98798 14 9.26469 13.7233 9.26469 13.3824V6.99588L13.6747 0.98247C13.8122 0.795529 13.8328 0.545999 13.7274 0.33847Z",fill:"currentColor"},null,-1)])),16)}QZ.render=uWe;var eQ={name:"FilterSlashIcon",extends:gi};function hWe(r){return gWe(r)||pWe(r)||fWe(r)||dWe()}function dWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fWe(r,e){if(r){if(typeof r=="string")return rR(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?rR(r,e):void 0}}function pWe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function gWe(r){if(Array.isArray(r))return rR(r)}function rR(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function mWe(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),hWe(e[0]||(e[0]=[I.createElementVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M13.4994 0.0920138C13.5967 0.151519 13.6758 0.236453 13.7283 0.337647C13.7807 0.439133 13.8031 0.553448 13.7929 0.667208C13.7827 0.780968 13.7403 0.889466 13.6707 0.98L11.406 4.06823C11.3099 4.19928 11.1656 4.28679 11.005 4.3115C10.8444 4.33621 10.6805 4.2961 10.5495 4.2C10.4184 4.1039 10.3309 3.95967 10.3062 3.79905C10.2815 3.63843 10.3216 3.47458 10.4177 3.34353L11.9412 1.23529H7.41184C7.24803 1.23529 7.09093 1.17022 6.97509 1.05439C6.85926 0.938558 6.79419 0.781457 6.79419 0.617647C6.79419 0.453837 6.85926 0.296736 6.97509 0.180905C7.09093 0.0650733 7.24803 0 7.41184 0H13.1765C13.2905 0.000692754 13.4022 0.0325088 13.4994 0.0920138ZM4.20008 0.181168H4.24126L13.2013 9.03411C13.3169 9.14992 13.3819 9.3069 13.3819 9.47058C13.3819 9.63426 13.3169 9.79124 13.2013 9.90705C13.1445 9.96517 13.0766 10.0112 13.0016 10.0423C12.9266 10.0735 12.846 10.0891 12.7648 10.0882C12.6836 10.0886 12.6032 10.0728 12.5283 10.0417C12.4533 10.0106 12.3853 9.96479 12.3283 9.90705L9.3142 6.92587L9.26479 6.99999V13.3823C9.26265 13.5455 9.19689 13.7014 9.08152 13.8167C8.96615 13.9321 8.81029 13.9979 8.64714 14H5.35302C5.18987 13.9979 5.03401 13.9321 4.91864 13.8167C4.80327 13.7014 4.73751 13.5455 4.73537 13.3823V6.99999L0.329492 1.02117C0.259855 0.930634 0.21745 0.822137 0.207241 0.708376C0.197031 0.594616 0.21944 0.480301 0.271844 0.378815C0.324343 0.277621 0.403484 0.192687 0.500724 0.133182C0.597964 0.073677 0.709609 0.041861 0.823609 0.0411682H3.86243C3.92448 0.0461551 3.9855 0.060022 4.04361 0.0823446C4.10037 0.10735 4.15311 0.140655 4.20008 0.181168ZM8.02949 6.79411C8.02884 6.66289 8.07235 6.53526 8.15302 6.43176L8.42478 6.05293L3.55773 1.23529H2.0589L5.84714 6.43176C5.92781 6.53526 5.97132 6.66289 5.97067 6.79411V12.7647H8.02949V6.79411Z",fill:"currentColor"},null,-1)])),16)}eQ.render=mWe;var tQ={name:"PlusIcon",extends:gi};function yWe(r){return AWe(r)||vWe(r)||_We(r)||bWe()}function bWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _We(r,e){if(r){if(typeof r=="string")return nR(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?nR(r,e):void 0}}function vWe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function AWe(r){if(Array.isArray(r))return nR(r)}function nR(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function xWe(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),yWe(e[0]||(e[0]=[I.createElementVNode("path",{d:"M7.67742 6.32258V0.677419C7.67742 0.497757 7.60605 0.325452 7.47901 0.198411C7.35197 0.0713707 7.17966 0 7 0C6.82034 0 6.64803 0.0713707 6.52099 0.198411C6.39395 0.325452 6.32258 0.497757 6.32258 0.677419V6.32258H0.677419C0.497757 6.32258 0.325452 6.39395 0.198411 6.52099C0.0713707 6.64803 0 6.82034 0 7C0 7.17966 0.0713707 7.35197 0.198411 7.47901C0.325452 7.60605 0.497757 7.67742 0.677419 7.67742H6.32258V13.3226C6.32492 13.5015 6.39704 13.6725 6.52358 13.799C6.65012 13.9255 6.82106 13.9977 7 14C7.17966 14 7.35197 13.9286 7.47901 13.8016C7.60605 13.6745 7.67742 13.5022 7.67742 13.3226V7.67742H13.3226C13.5022 7.67742 13.6745 7.60605 13.8016 7.47901C13.9286 7.35197 14 7.17966 14 7C13.9977 6.82106 13.9255 6.65012 13.799 6.52358C13.6725 6.39704 13.5015 6.32492 13.3226 6.32258H7.67742Z",fill:"currentColor"},null,-1)])),16)}tQ.render=xWe;var rQ={name:"TrashIcon",extends:gi};function wWe(r){return EWe(r)||SWe(r)||TWe(r)||CWe()}function CWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TWe(r,e){if(r){if(typeof r=="string")return iR(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?iR(r,e):void 0}}function SWe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function EWe(r){if(Array.isArray(r))return iR(r)}function iR(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function IWe(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),wWe(e[0]||(e[0]=[I.createElementVNode("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.44802 13.9955H10.552C10.8056 14.0129 11.06 13.9797 11.3006 13.898C11.5412 13.8163 11.7632 13.6877 11.9537 13.5196C12.1442 13.3515 12.2995 13.1473 12.4104 12.9188C12.5213 12.6903 12.5858 12.442 12.6 12.1884V4.36041H13.4C13.5591 4.36041 13.7117 4.29722 13.8243 4.18476C13.9368 4.07229 14 3.91976 14 3.76071C14 3.60166 13.9368 3.44912 13.8243 3.33666C13.7117 3.22419 13.5591 3.16101 13.4 3.16101H12.0537C12.0203 3.1557 11.9863 3.15299 11.952 3.15299C11.9178 3.15299 11.8838 3.1557 11.8503 3.16101H11.2285C11.2421 3.10893 11.2487 3.05513 11.248 3.00106V1.80966C11.2171 1.30262 10.9871 0.828306 10.608 0.48989C10.229 0.151475 9.73159 -0.0236625 9.22402 0.00257442H4.77602C4.27251 -0.0171866 3.78126 0.160868 3.40746 0.498617C3.03365 0.836366 2.807 1.30697 2.77602 1.80966V3.00106C2.77602 3.0556 2.78346 3.10936 2.79776 3.16101H0.6C0.521207 3.16101 0.443185 3.17652 0.37039 3.20666C0.297595 3.2368 0.231451 3.28097 0.175736 3.33666C0.120021 3.39235 0.0758251 3.45846 0.0456722 3.53121C0.0155194 3.60397 0 3.68196 0 3.76071C0 3.83946 0.0155194 3.91744 0.0456722 3.9902C0.0758251 4.06296 0.120021 4.12907 0.175736 4.18476C0.231451 4.24045 0.297595 4.28462 0.37039 4.31476C0.443185 4.3449 0.521207 4.36041 0.6 4.36041H1.40002V12.1884C1.41426 12.442 1.47871 12.6903 1.58965 12.9188C1.7006 13.1473 1.85582 13.3515 2.04633 13.5196C2.23683 13.6877 2.45882 13.8163 2.69944 13.898C2.94005 13.9797 3.1945 14.0129 3.44802 13.9955ZM2.60002 4.36041H11.304V12.1884C11.304 12.5163 10.952 12.7961 10.504 12.7961H3.40002C2.97602 12.7961 2.60002 12.5163 2.60002 12.1884V4.36041ZM3.95429 3.16101C3.96859 3.10936 3.97602 3.0556 3.97602 3.00106V1.80966C3.97602 1.48183 4.33602 1.20197 4.77602 1.20197H9.24802C9.66403 1.20197 10.048 1.48183 10.048 1.80966V3.00106C10.0473 3.05515 10.054 3.10896 10.0678 3.16101H3.95429ZM5.57571 10.997C5.41731 10.995 5.26597 10.9311 5.15395 10.8191C5.04193 10.7071 4.97808 10.5558 4.97601 10.3973V6.77517C4.97601 6.61612 5.0392 6.46359 5.15166 6.35112C5.26413 6.23866 5.41666 6.17548 5.57571 6.17548C5.73476 6.17548 5.8873 6.23866 5.99976 6.35112C6.11223 6.46359 6.17541 6.61612 6.17541 6.77517V10.3894C6.17647 10.4688 6.16174 10.5476 6.13208 10.6213C6.10241 10.695 6.05841 10.762 6.00261 10.8186C5.94682 10.8751 5.88035 10.92 5.80707 10.9506C5.73378 10.9813 5.65514 10.9971 5.57571 10.997ZM7.99968 10.8214C8.11215 10.9339 8.26468 10.997 8.42373 10.997C8.58351 10.9949 8.73604 10.93 8.84828 10.8163C8.96052 10.7025 9.02345 10.5491 9.02343 10.3894V6.77517C9.02343 6.61612 8.96025 6.46359 8.84778 6.35112C8.73532 6.23866 8.58278 6.17548 8.42373 6.17548C8.26468 6.17548 8.11215 6.23866 7.99968 6.35112C7.88722 6.46359 7.82404 6.61612 7.82404 6.77517V10.3973C7.82404 10.5564 7.88722 10.7089 7.99968 10.8214Z",fill:"currentColor"},null,-1)])),16)}rQ.render=IWe;var PWe=cn.extend({name:"focustrap-directive"}),BWe=Yr.extend({style:PWe});function Sv(r){"@babel/helpers - typeof";return Sv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sv(r)}function n$(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function i$(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?n$(Object(t),!0).forEach(function(n){MWe(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):n$(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function MWe(r,e,t){return(e=RWe(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function RWe(r){var e=kWe(r,"string");return Sv(e)=="symbol"?e:e+""}function kWe(r,e){if(Sv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(Sv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var OWe=BWe.extend("focustrap",{mounted:function(e,t){var n=t.value||{},i=n.disabled;i||(this.createHiddenFocusableElements(e,t),this.bind(e,t),this.autoElementFocus(e,t)),e.setAttribute("data-pd-focustrap",!0),this.$el=e},updated:function(e,t){var n=t.value||{},i=n.disabled;i&&this.unbind(e)},unmounted:function(e){this.unbind(e)},methods:{getComputedSelector:function(e){return':not(.p-hidden-focusable):not([data-p-hidden-focusable="true"])'.concat(e??"")},bind:function(e,t){var n=this,i=t.value||{},s=i.onFocusIn,a=i.onFocusOut;e.$_pfocustrap_mutationobserver=new MutationObserver(function(o){o.forEach(function(u){if(u.type==="childList"&&!e.contains(document.activeElement)){var f=function(y){var A=_V(y)?_V(y,n.getComputedSelector(e.$_pfocustrap_focusableselector))?y:kf(e,n.getComputedSelector(e.$_pfocustrap_focusableselector)):kf(y);return Xr(A)?A:y.nextSibling&&f(y.nextSibling)};oa(f(u.nextSibling))}})}),e.$_pfocustrap_mutationobserver.disconnect(),e.$_pfocustrap_mutationobserver.observe(e,{childList:!0}),e.$_pfocustrap_focusinlistener=function(o){return s&&s(o)},e.$_pfocustrap_focusoutlistener=function(o){return a&&a(o)},e.addEventListener("focusin",e.$_pfocustrap_focusinlistener),e.addEventListener("focusout",e.$_pfocustrap_focusoutlistener)},unbind:function(e){e.$_pfocustrap_mutationobserver&&e.$_pfocustrap_mutationobserver.disconnect(),e.$_pfocustrap_focusinlistener&&e.removeEventListener("focusin",e.$_pfocustrap_focusinlistener)&&(e.$_pfocustrap_focusinlistener=null),e.$_pfocustrap_focusoutlistener&&e.removeEventListener("focusout",e.$_pfocustrap_focusoutlistener)&&(e.$_pfocustrap_focusoutlistener=null)},autoFocus:function(e){this.autoElementFocus(this.$el,{value:i$(i$({},e),{},{autoFocus:!0})})},autoElementFocus:function(e,t){var n=t.value||{},i=n.autoFocusSelector,s=i===void 0?"":i,a=n.firstFocusableSelector,o=a===void 0?"":a,u=n.autoFocus,f=u===void 0?!1:u,g=kf(e,"[autofocus]".concat(this.getComputedSelector(s)));f&&!g&&(g=kf(e,this.getComputedSelector(o))),oa(g)},onFirstHiddenElementFocus:function(e){var t,n=e.currentTarget,i=e.relatedTarget,s=i===n.$_pfocustrap_lasthiddenfocusableelement||!((t=this.$el)!==null&&t!==void 0&&t.contains(i))?kf(n.parentElement,this.getComputedSelector(n.$_pfocustrap_focusableselector)):n.$_pfocustrap_lasthiddenfocusableelement;oa(s)},onLastHiddenElementFocus:function(e){var t,n=e.currentTarget,i=e.relatedTarget,s=i===n.$_pfocustrap_firsthiddenfocusableelement||!((t=this.$el)!==null&&t!==void 0&&t.contains(i))?sZ(n.parentElement,this.getComputedSelector(n.$_pfocustrap_focusableselector)):n.$_pfocustrap_firsthiddenfocusableelement;oa(s)},createHiddenFocusableElements:function(e,t){var n=this,i=t.value||{},s=i.tabIndex,a=s===void 0?0:s,o=i.firstFocusableSelector,u=o===void 0?"":o,f=i.lastFocusableSelector,g=f===void 0?"":f,y=function(k){return iZ("span",{class:"p-hidden-accessible p-hidden-focusable",tabIndex:a,role:"presentation","aria-hidden":!0,"data-p-hidden-accessible":!0,"data-p-hidden-focusable":!0,onFocus:k?.bind(n)})},A=y(this.onFirstHiddenElementFocus),C=y(this.onLastHiddenElementFocus);A.$_pfocustrap_lasthiddenfocusableelement=C,A.$_pfocustrap_focusableselector=u,A.setAttribute("data-pc-section","firstfocusableelement"),C.$_pfocustrap_firsthiddenfocusableelement=A,C.$_pfocustrap_focusableselector=g,C.setAttribute("data-pc-section","lastfocusableelement"),e.prepend(A),e.append(C)}}}),sR={name:"SortAltIcon",extends:gi};function DWe(r){return UWe(r)||FWe(r)||NWe(r)||LWe()}function LWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NWe(r,e){if(r){if(typeof r=="string")return oR(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?oR(r,e):void 0}}function FWe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function UWe(r){if(Array.isArray(r))return oR(r)}function oR(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function zWe(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),DWe(e[0]||(e[0]=[I.createElementVNode("path",{d:"M5.64515 3.61291C5.47353 3.61291 5.30192 3.54968 5.16644 3.4142L3.38708 1.63484L1.60773 3.4142C1.34579 3.67613 0.912244 3.67613 0.650309 3.4142C0.388374 3.15226 0.388374 2.71871 0.650309 2.45678L2.90837 0.198712C3.17031 -0.0632236 3.60386 -0.0632236 3.86579 0.198712L6.12386 2.45678C6.38579 2.71871 6.38579 3.15226 6.12386 3.4142C5.98837 3.54968 5.81676 3.61291 5.64515 3.61291Z",fill:"currentColor"},null,-1),I.createElementVNode("path",{d:"M3.38714 14C3.01681 14 2.70972 13.6929 2.70972 13.3226V0.677419C2.70972 0.307097 3.01681 0 3.38714 0C3.75746 0 4.06456 0.307097 4.06456 0.677419V13.3226C4.06456 13.6929 3.75746 14 3.38714 14Z",fill:"currentColor"},null,-1),I.createElementVNode("path",{d:"M10.6129 14C10.4413 14 10.2697 13.9368 10.1342 13.8013L7.87611 11.5432C7.61418 11.2813 7.61418 10.8477 7.87611 10.5858C8.13805 10.3239 8.5716 10.3239 8.83353 10.5858L10.6129 12.3652L12.3922 10.5858C12.6542 10.3239 13.0877 10.3239 13.3497 10.5858C13.6116 10.8477 13.6116 11.2813 13.3497 11.5432L11.0916 13.8013C10.9561 13.9368 10.7845 14 10.6129 14Z",fill:"currentColor"},null,-1),I.createElementVNode("path",{d:"M10.6129 14C10.2426 14 9.93552 13.6929 9.93552 13.3226V0.677419C9.93552 0.307097 10.2426 0 10.6129 0C10.9833 0 11.2904 0.307097 11.2904 0.677419V13.3226C11.2904 13.6929 10.9832 14 10.6129 14Z",fill:"currentColor"},null,-1)])),16)}sR.render=zWe;var aR={name:"SortAmountDownIcon",extends:gi};function VWe(r){return HWe(r)||GWe(r)||jWe(r)||$We()}function $We(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jWe(r,e){if(r){if(typeof r=="string")return lR(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?lR(r,e):void 0}}function GWe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function HWe(r){if(Array.isArray(r))return lR(r)}function lR(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function WWe(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),VWe(e[0]||(e[0]=[I.createElementVNode("path",{d:"M4.93953 10.5858L3.83759 11.6877V0.677419C3.83759 0.307097 3.53049 0 3.16017 0C2.78985 0 2.48275 0.307097 2.48275 0.677419V11.6877L1.38082 10.5858C1.11888 10.3239 0.685331 10.3239 0.423396 10.5858C0.16146 10.8477 0.16146 11.2813 0.423396 11.5432L2.68146 13.8013C2.74469 13.8645 2.81694 13.9097 2.89823 13.9458C2.97952 13.9819 3.06985 14 3.16017 14C3.25049 14 3.33178 13.9819 3.42211 13.9458C3.5034 13.9097 3.57565 13.8645 3.63888 13.8013L5.89694 11.5432C6.15888 11.2813 6.15888 10.8477 5.89694 10.5858C5.63501 10.3239 5.20146 10.3239 4.93953 10.5858ZM13.0957 0H7.22468C6.85436 0 6.54726 0.307097 6.54726 0.677419C6.54726 1.04774 6.85436 1.35484 7.22468 1.35484H13.0957C13.466 1.35484 13.7731 1.04774 13.7731 0.677419C13.7731 0.307097 13.466 0 13.0957 0ZM7.22468 5.41935H9.48275C9.85307 5.41935 10.1602 5.72645 10.1602 6.09677C10.1602 6.4671 9.85307 6.77419 9.48275 6.77419H7.22468C6.85436 6.77419 6.54726 6.4671 6.54726 6.09677C6.54726 5.72645 6.85436 5.41935 7.22468 5.41935ZM7.6763 8.12903H7.22468C6.85436 8.12903 6.54726 8.43613 6.54726 8.80645C6.54726 9.17677 6.85436 9.48387 7.22468 9.48387H7.6763C8.04662 9.48387 8.35372 9.17677 8.35372 8.80645C8.35372 8.43613 8.04662 8.12903 7.6763 8.12903ZM7.22468 2.70968H11.2892C11.6595 2.70968 11.9666 3.01677 11.9666 3.3871C11.9666 3.75742 11.6595 4.06452 11.2892 4.06452H7.22468C6.85436 4.06452 6.54726 3.75742 6.54726 3.3871C6.54726 3.01677 6.85436 2.70968 7.22468 2.70968Z",fill:"currentColor"},null,-1)])),16)}aR.render=WWe;var cR={name:"SortAmountUpAltIcon",extends:gi};function KWe(r){return YWe(r)||qWe(r)||JWe(r)||XWe()}function XWe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JWe(r,e){if(r){if(typeof r=="string")return uR(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?uR(r,e):void 0}}function qWe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function YWe(r){if(Array.isArray(r))return uR(r)}function uR(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function ZWe(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("svg",I.mergeProps({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.pti()),KWe(e[0]||(e[0]=[I.createElementVNode("path",{d:"M3.63435 0.19871C3.57113 0.135484 3.49887 0.0903226 3.41758 0.0541935C3.255 -0.0180645 3.06532 -0.0180645 2.90274 0.0541935C2.82145 0.0903226 2.74919 0.135484 2.68597 0.19871L0.427901 2.45677C0.165965 2.71871 0.165965 3.15226 0.427901 3.41419C0.689836 3.67613 1.12338 3.67613 1.38532 3.41419L2.48726 2.31226V13.3226C2.48726 13.6929 2.79435 14 3.16467 14C3.535 14 3.84209 13.6929 3.84209 13.3226V2.31226L4.94403 3.41419C5.07951 3.54968 5.25113 3.6129 5.42274 3.6129C5.59435 3.6129 5.76597 3.54968 5.90145 3.41419C6.16338 3.15226 6.16338 2.71871 5.90145 2.45677L3.64338 0.19871H3.63435ZM13.7685 13.3226C13.7685 12.9523 13.4615 12.6452 13.0911 12.6452H7.22016C6.84984 12.6452 6.54274 12.9523 6.54274 13.3226C6.54274 13.6929 6.84984 14 7.22016 14H13.0911C13.4615 14 13.7685 13.6929 13.7685 13.3226ZM7.22016 8.58064C6.84984 8.58064 6.54274 8.27355 6.54274 7.90323C6.54274 7.5329 6.84984 7.22581 7.22016 7.22581H9.47823C9.84855 7.22581 10.1556 7.5329 10.1556 7.90323C10.1556 8.27355 9.84855 8.58064 9.47823 8.58064H7.22016ZM7.22016 5.87097H7.67177C8.0421 5.87097 8.34919 5.56387 8.34919 5.19355C8.34919 4.82323 8.0421 4.51613 7.67177 4.51613H7.22016C6.84984 4.51613 6.54274 4.82323 6.54274 5.19355C6.54274 5.56387 6.84984 5.87097 7.22016 5.87097ZM11.2847 11.2903H7.22016C6.84984 11.2903 6.54274 10.9832 6.54274 10.6129C6.54274 10.2426 6.84984 9.93548 7.22016 9.93548H11.2847C11.655 9.93548 11.9621 10.2426 11.9621 10.6129C11.9621 10.9832 11.655 11.2903 11.2847 11.2903Z",fill:"currentColor"},null,-1)])),16)}cR.render=ZWe;var QWe={name:"BaseDataTable",extends:In,props:{value:{type:Array,default:null},dataKey:{type:[String,Function],default:null},rows:{type:Number,default:0},first:{type:Number,default:0},totalRecords:{type:Number,default:0},paginator:{type:Boolean,default:!1},paginatorPosition:{type:String,default:"bottom"},alwaysShowPaginator:{type:Boolean,default:!0},paginatorTemplate:{type:[Object,String],default:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown"},pageLinkSize:{type:Number,default:5},rowsPerPageOptions:{type:Array,default:null},currentPageReportTemplate:{type:String,default:"({currentPage} of {totalPages})"},lazy:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},loadingIcon:{type:String,default:void 0},sortField:{type:[String,Function],default:null},sortOrder:{type:Number,default:null},defaultSortOrder:{type:Number,default:1},nullSortOrder:{type:Number,default:1},multiSortMeta:{type:Array,default:null},sortMode:{type:String,default:"single"},removableSort:{type:Boolean,default:!1},filters:{type:Object,default:null},filterDisplay:{type:String,default:null},globalFilterFields:{type:Array,default:null},filterLocale:{type:String,default:void 0},selection:{type:[Array,Object],default:null},selectionMode:{type:String,default:null},compareSelectionBy:{type:String,default:"deepEquals"},metaKeySelection:{type:Boolean,default:!1},contextMenu:{type:Boolean,default:!1},contextMenuSelection:{type:Object,default:null},selectAll:{type:Boolean,default:null},rowHover:{type:Boolean,default:!1},csvSeparator:{type:String,default:","},exportFilename:{type:String,default:"download"},exportFunction:{type:Function,default:null},resizableColumns:{type:Boolean,default:!1},columnResizeMode:{type:String,default:"fit"},reorderableColumns:{type:Boolean,default:!1},expandedRows:{type:[Array,Object],default:null},expandedRowIcon:{type:String,default:void 0},collapsedRowIcon:{type:String,default:void 0},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String,Function],default:null},expandableRowGroups:{type:Boolean,default:!1},expandedRowGroups:{type:Array,default:null},stateStorage:{type:String,default:"session"},stateKey:{type:String,default:null},editMode:{type:String,default:null},editingRows:{type:Array,default:null},rowClass:{type:Function,default:null},rowStyle:{type:Function,default:null},scrollable:{type:Boolean,default:!1},virtualScrollerOptions:{type:Object,default:null},scrollHeight:{type:String,default:null},frozenValue:{type:Array,default:null},breakpoint:{type:String,default:"960px"},showHeaders:{type:Boolean,default:!0},showGridlines:{type:Boolean,default:!1},stripedRows:{type:Boolean,default:!1},highlightOnSelect:{type:Boolean,default:!1},size:{type:String,default:null},tableStyle:{type:null,default:null},tableClass:{type:[String,Object],default:null},tableProps:{type:Object,default:null},filterInputProps:{type:null,default:null},filterButtonProps:{type:Object,default:function(){return{filter:{severity:"secondary",text:!0,rounded:!0},inline:{clear:{severity:"secondary",text:!0,rounded:!0}},popover:{addRule:{severity:"info",text:!0,size:"small"},removeRule:{severity:"danger",text:!0,size:"small"},apply:{size:"small"},clear:{outlined:!0,size:"small"}}}}},editButtonProps:{type:Object,default:function(){return{init:{severity:"secondary",text:!0,rounded:!0},save:{severity:"secondary",text:!0,rounded:!0},cancel:{severity:"secondary",text:!0,rounded:!0}}}}},style:DGe,provide:function(){return{$pcDataTable:this,$parentInstance:this}}},nQ={name:"RowCheckbox",hostName:"DataTable",extends:In,emits:["change"],props:{value:null,checked:null,column:null,rowCheckboxIconTemplate:{type:Function,default:null},index:{type:Number,default:null}},methods:{getColumnPT:function(e){var t={props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:this.index,checked:this.checked,disabled:this.$attrs.disabled}};return I.mergeProps(this.ptm("column.".concat(e),{column:t}),this.ptm("column.".concat(e),t),this.ptmo(this.getColumnProp(),e,t))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},onChange:function(e){this.$attrs.disabled||this.$emit("change",{originalEvent:e,data:this.value})}},computed:{checkboxAriaLabel:function(){return this.$primevue.config.locale.aria?this.checked?this.$primevue.config.locale.aria.selectRow:this.$primevue.config.locale.aria.unselectRow:void 0}},components:{CheckIcon:Dy,Checkbox:yL}};function eKe(r,e,t,n,i,s){var a=I.resolveComponent("CheckIcon"),o=I.resolveComponent("Checkbox");return I.openBlock(),I.createBlock(o,{modelValue:t.checked,binary:!0,disabled:r.$attrs.disabled,"aria-label":s.checkboxAriaLabel,onChange:s.onChange,unstyled:r.unstyled,pt:s.getColumnPT("pcRowCheckbox")},{icon:I.withCtx(function(u){return[t.rowCheckboxIconTemplate?(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.rowCheckboxIconTemplate),{key:0,checked:u.checked,class:I.normalizeClass(u.class)},null,8,["checked","class"])):!t.rowCheckboxIconTemplate&&u.checked?(I.openBlock(),I.createBlock(a,I.mergeProps({key:1,class:u.class},s.getColumnPT("pcRowCheckbox.icon")),null,16,["class"])):I.createCommentVNode("",!0)]}),_:1},8,["modelValue","disabled","aria-label","onChange","unstyled","pt"])}nQ.render=eKe;var iQ={name:"RowRadioButton",hostName:"DataTable",extends:In,emits:["change"],props:{value:null,checked:null,name:null,column:null,index:{type:Number,default:null}},methods:{getColumnPT:function(e){var t={props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:this.index,checked:this.checked,disabled:this.$attrs.disabled}};return I.mergeProps(this.ptm("column.".concat(e),{column:t}),this.ptm("column.".concat(e),t),this.ptmo(this.getColumnProp(),e,t))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},onChange:function(e){this.$attrs.disabled||this.$emit("change",{originalEvent:e,data:this.value})}},components:{RadioButton:YZ}};function tKe(r,e,t,n,i,s){var a=I.resolveComponent("RadioButton");return I.openBlock(),I.createBlock(a,{modelValue:t.checked,binary:!0,disabled:r.$attrs.disabled,name:t.name,onChange:s.onChange,unstyled:r.unstyled,pt:s.getColumnPT("pcRowRadiobutton")},null,8,["modelValue","disabled","name","onChange","unstyled","pt"])}iQ.render=tKe;function F0(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var r,e,t=typeof Symbol=="function"?Symbol:{},n=t.iterator||"@@iterator",i=t.toStringTag||"@@toStringTag";function s(C,M,k,D){var V=M&&M.prototype instanceof o?M:o,W=Object.create(V.prototype);return Oa(W,"_invoke",function(z,$,te){var le,_e,se,Y=0,ce=te||[],oe=!1,Me={p:0,n:0,v:r,a:ze,f:ze.bind(r,4),d:function(lt,gt){return le=lt,_e=0,se=r,Me.n=gt,a}};function ze(Ve,lt){for(_e=Ve,se=lt,e=0;!oe&&Y&&!gt&&e<ce.length;e++){var gt,At=ce[e],Tt=Me.p,Ut=At[2];Ve>3?(gt=Ut===lt)&&(se=At[(_e=At[4])?5:(_e=3,3)],At[4]=At[5]=r):At[0]<=Tt&&((gt=Ve<2&&Tt<At[1])?(_e=0,Me.v=lt,Me.n=At[1]):Tt<Ut&&(gt=Ve<3||At[0]>lt||lt>Ut)&&(At[4]=Ve,At[5]=lt,Me.n=Ut,_e=0))}if(gt||Ve>1)return a;throw oe=!0,lt}return function(Ve,lt,gt){if(Y>1)throw TypeError("Generator is already running");for(oe&&lt===1&&ze(lt,gt),_e=lt,se=gt;(e=_e<2?r:se)||!oe;){le||(_e?_e<3?(_e>1&&(Me.n=-1),ze(_e,se)):Me.n=se:Me.v=se);try{if(Y=2,le){if(_e||(Ve="next"),e=le[Ve]){if(!(e=e.call(le,se)))throw TypeError("iterator result is not an object");if(!e.done)return e;se=e.value,_e<2&&(_e=0)}else _e===1&&(e=le.return)&&e.call(le),_e<2&&(se=TypeError("The iterator does not provide a '"+Ve+"' method"),_e=1);le=r}else if((e=(oe=Me.n<0)?se:z.call($,Me))!==a)break}catch(At){le=r,_e=1,se=At}finally{Y=1}}return{value:e,done:oe}}}(C,k,D),!0),W}var a={};function o(){}function u(){}function f(){}e=Object.getPrototypeOf;var g=[][n]?e(e([][n]())):(Oa(e={},n,function(){return this}),e),y=f.prototype=o.prototype=Object.create(g);function A(C){return Object.setPrototypeOf?Object.setPrototypeOf(C,f):(C.__proto__=f,Oa(C,i,"GeneratorFunction")),C.prototype=Object.create(y),C}return u.prototype=f,Oa(y,"constructor",f),Oa(f,"constructor",u),u.displayName="GeneratorFunction",Oa(f,i,"GeneratorFunction"),Oa(y),Oa(y,i,"Generator"),Oa(y,n,function(){return this}),Oa(y,"toString",function(){return"[object Generator]"}),(F0=function(){return{w:s,m:A}})()}function Oa(r,e,t,n){var i=Object.defineProperty;try{i({},"",{})}catch{i=0}Oa=function(a,o,u,f){function g(y,A){Oa(a,y,function(C){return this._invoke(y,A,C)})}o?i?i(a,o,{value:u,enumerable:!f,configurable:!f,writable:!f}):a[o]=u:(g("next",0),g("throw",1),g("return",2))},Oa(r,e,t,n)}function s$(r,e,t,n,i,s,a){try{var o=r[s](a),u=o.value}catch(f){return void t(f)}o.done?e(u):Promise.resolve(u).then(n,i)}function o$(r){return function(){var e=this,t=arguments;return new Promise(function(n,i){var s=r.apply(e,t);function a(u){s$(s,n,i,a,o,"next",u)}function o(u){s$(s,n,i,a,o,"throw",u)}a(void 0)})}}var sQ={name:"BodyCell",hostName:"DataTable",extends:In,emits:["cell-edit-init","cell-edit-complete","cell-edit-cancel","row-edit-init","row-edit-save","row-edit-cancel","row-toggle","radio-change","checkbox-change","editing-meta-change"],props:{rowData:{type:Object,default:null},column:{type:Object,default:null},frozenRow:{type:Boolean,default:!1},rowIndex:{type:Number,default:null},index:{type:Number,default:null},isRowExpanded:{type:Boolean,default:!1},selected:{type:Boolean,default:!1},editing:{type:Boolean,default:!1},editingMeta:{type:Object,default:null},editMode:{type:String,default:null},virtualScrollerContentProps:{type:Object,default:null},ariaControls:{type:String,default:null},name:{type:String,default:null},expandedRowIcon:{type:String,default:null},collapsedRowIcon:{type:String,default:null},editButtonProps:{type:Object,default:null}},documentEditListener:null,selfClick:!1,overlayEventListener:null,editCompleteTimeout:null,data:function(){return{d_editing:this.editing,styleObject:{}}},watch:{editing:function(e){this.d_editing=e},"$data.d_editing":function(e){this.$emit("editing-meta-change",{data:this.rowData,field:this.field||"field_".concat(this.index),index:this.rowIndex,editing:e})}},mounted:function(){this.columnProp("frozen")&&this.updateStickyPosition()},updated:function(){var e=this;this.columnProp("frozen")&&this.updateStickyPosition(),this.d_editing&&(this.editMode==="cell"||this.editMode==="row"&&this.columnProp("rowEditor"))&&setTimeout(function(){var t=kf(e.$el);t&&t.focus()},1)},beforeUnmount:function(){this.overlayEventListener&&(hd.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null)},methods:{columnProp:function(e){return Id(this.column,e)},getColumnPT:function(e){var t,n,i={props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:this.index,size:(t=this.$parentInstance)===null||t===void 0||(t=t.$parentInstance)===null||t===void 0?void 0:t.size,showGridlines:(n=this.$parentInstance)===null||n===void 0||(n=n.$parentInstance)===null||n===void 0?void 0:n.showGridlines}};return I.mergeProps(this.ptm("column.".concat(e),{column:i}),this.ptm("column.".concat(e),i),this.ptmo(this.getColumnProp(),e,i))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},resolveFieldData:function(){return hn(this.rowData,this.field)},toggleRow:function(e){this.$emit("row-toggle",{originalEvent:e,data:this.rowData})},toggleRowWithRadio:function(e,t){this.$emit("radio-change",{originalEvent:e.originalEvent,index:t,data:e.data})},toggleRowWithCheckbox:function(e,t){this.$emit("checkbox-change",{originalEvent:e.originalEvent,index:t,data:e.data})},isEditable:function(){return this.column.children&&this.column.children.editor!=null},bindDocumentEditListener:function(){var e=this;this.documentEditListener||(this.documentEditListener=function(t){e.selfClick=e.$el&&e.$el.contains(t.target),e.editCompleteTimeout&&clearTimeout(e.editCompleteTimeout),e.selfClick||(e.editCompleteTimeout=setTimeout(function(){e.completeEdit(t,"outside")},1))},document.addEventListener("mousedown",this.documentEditListener))},unbindDocumentEditListener:function(){this.documentEditListener&&(document.removeEventListener("mousedown",this.documentEditListener),this.documentEditListener=null,this.selfClick=!1,this.editCompleteTimeout&&(clearTimeout(this.editCompleteTimeout),this.editCompleteTimeout=null))},switchCellToViewMode:function(){this.d_editing=!1,this.unbindDocumentEditListener(),hd.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null},onClick:function(e){var t=this;this.editMode==="cell"&&this.isEditable()&&(this.d_editing||(this.d_editing=!0,this.bindDocumentEditListener(),this.$emit("cell-edit-init",{originalEvent:e,data:this.rowData,field:this.field,index:this.rowIndex}),this.overlayEventListener=function(n){t.selfClick=t.$el&&t.$el.contains(n.target)},hd.on("overlay-click",this.overlayEventListener)))},completeEdit:function(e,t){var n={originalEvent:e,data:this.rowData,newData:this.editingRowData,value:this.rowData[this.field],newValue:this.editingRowData[this.field],field:this.field,index:this.rowIndex,type:t,defaultPrevented:!1,preventDefault:function(){this.defaultPrevented=!0}};this.$emit("cell-edit-complete",n),n.defaultPrevented||this.switchCellToViewMode()},onKeyDown:function(e){if(this.editMode==="cell")switch(e.code){case"Enter":case"NumpadEnter":this.completeEdit(e,"enter");break;case"Escape":this.switchCellToViewMode(),this.$emit("cell-edit-cancel",{originalEvent:e,data:this.rowData,field:this.field,index:this.rowIndex});break;case"Tab":this.completeEdit(e,"tab"),e.shiftKey?this.moveToPreviousCell(e):this.moveToNextCell(e);break}},moveToPreviousCell:function(e){var t=this;return o$(F0().m(function n(){var i,s;return F0().w(function(a){for(;;)switch(a.n){case 0:if(i=t.findCell(e.target),s=t.findPreviousEditableColumn(i),!s){a.n=2;break}return a.n=1,t.$nextTick();case 1:bV(s,"click"),e.preventDefault();case 2:return a.a(2)}},n)}))()},moveToNextCell:function(e){var t=this;return o$(F0().m(function n(){var i,s;return F0().w(function(a){for(;;)switch(a.n){case 0:if(i=t.findCell(e.target),s=t.findNextEditableColumn(i),!s){a.n=2;break}return a.n=1,t.$nextTick();case 1:bV(s,"click"),e.preventDefault();case 2:return a.a(2)}},n)}))()},findCell:function(e){if(e){for(var t=e;t&&!zs(t,"data-p-cell-editing");)t=t.parentElement;return t}else return null},findPreviousEditableColumn:function(e){var t=e.previousElementSibling;if(!t){var n=e.parentElement.previousElementSibling;n&&(t=n.lastElementChild)}return t?zs(t,"data-p-editable-column")?t:this.findPreviousEditableColumn(t):null},findNextEditableColumn:function(e){var t=e.nextElementSibling;if(!t){var n=e.parentElement.nextElementSibling;n&&(t=n.firstElementChild)}return t?zs(t,"data-p-editable-column")?t:this.findNextEditableColumn(t):null},onRowEditInit:function(e){this.$emit("row-edit-init",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},onRowEditSave:function(e){this.$emit("row-edit-save",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},onRowEditCancel:function(e){this.$emit("row-edit-cancel",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},editorInitCallback:function(e){this.$emit("row-edit-init",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},editorSaveCallback:function(e){this.editMode==="row"?this.$emit("row-edit-save",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex}):this.completeEdit(e,"enter")},editorCancelCallback:function(e){this.editMode==="row"?this.$emit("row-edit-cancel",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex}):(this.switchCellToViewMode(),this.$emit("cell-edit-cancel",{originalEvent:e,data:this.rowData,field:this.field,index:this.rowIndex}))},updateStickyPosition:function(){if(this.columnProp("frozen")){var e=this.columnProp("alignFrozen");if(e==="right"){var t=0,n=g2(this.$el,'[data-p-frozen-column="true"]');n&&(t=da(n)+parseFloat(n.style["inset-inline-end"]||0)),this.styleObject.insetInlineEnd=t+"px"}else{var i=0,s=m2(this.$el,'[data-p-frozen-column="true"]');s&&(i=da(s)+parseFloat(s.style["inset-inline-start"]||0)),this.styleObject.insetInlineStart=i+"px"}}},getVirtualScrollerProp:function(e){return this.virtualScrollerContentProps?this.virtualScrollerContentProps[e]:null}},computed:{editingRowData:function(){return this.editingMeta[this.rowIndex]?this.editingMeta[this.rowIndex].data:this.rowData},field:function(){return this.columnProp("field")},containerClass:function(){return[this.columnProp("bodyClass"),this.columnProp("class"),this.cx("bodyCell")]},containerStyle:function(){var e=this.columnProp("bodyStyle"),t=this.columnProp("style");return this.columnProp("frozen")?[t,e,this.styleObject]:[t,e]},loading:function(){return this.getVirtualScrollerProp("loading")},loadingOptions:function(){var e=this.getVirtualScrollerProp("getLoaderOptions");return e&&e(this.rowIndex,{cellIndex:this.index,cellFirst:this.index===0,cellLast:this.index===this.getVirtualScrollerProp("columns").length-1,cellEven:this.index%2===0,cellOdd:this.index%2!==0,column:this.column,field:this.field})},expandButtonAriaLabel:function(){return this.$primevue.config.locale.aria?this.isRowExpanded?this.$primevue.config.locale.aria.expandRow:this.$primevue.config.locale.aria.collapseRow:void 0},initButtonAriaLabel:function(){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.editRow:void 0},saveButtonAriaLabel:function(){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.saveEdit:void 0},cancelButtonAriaLabel:function(){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.cancelEdit:void 0}},components:{DTRadioButton:iQ,DTCheckbox:nQ,Button:wv,ChevronDownIcon:b2,ChevronRightIcon:gL,BarsIcon:XZ,PencilIcon:JZ,CheckIcon:Dy,TimesIcon:_2},directives:{ripple:Pd}};function Ev(r){"@babel/helpers - typeof";return Ev=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ev(r)}function a$(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function Zx(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?a$(Object(t),!0).forEach(function(n){rKe(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):a$(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function rKe(r,e,t){return(e=nKe(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function nKe(r){var e=iKe(r,"string");return Ev(e)=="symbol"?e:e+""}function iKe(r,e){if(Ev(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(Ev(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var sKe=["colspan","rowspan","data-p-selection-column","data-p-editable-column","data-p-cell-editing","data-p-frozen-column"],oKe=["aria-expanded","aria-controls","aria-label"];function aKe(r,e,t,n,i,s){var a=I.resolveComponent("DTRadioButton"),o=I.resolveComponent("DTCheckbox"),u=I.resolveComponent("BarsIcon"),f=I.resolveComponent("ChevronDownIcon"),g=I.resolveComponent("ChevronRightIcon"),y=I.resolveComponent("Button"),A=I.resolveDirective("ripple");return s.loading?(I.openBlock(),I.createElementBlock("td",I.mergeProps({key:0,style:s.containerStyle,class:s.containerClass,role:"cell"},Zx(Zx({},s.getColumnPT("root")),s.getColumnPT("bodyCell"))),[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.column.children.loading),{data:t.rowData,column:t.column,field:s.field,index:t.rowIndex,frozenRow:t.frozenRow,loadingOptions:s.loadingOptions},null,8,["data","column","field","index","frozenRow","loadingOptions"]))],16)):(I.openBlock(),I.createElementBlock("td",I.mergeProps({key:1,style:s.containerStyle,class:s.containerClass,colspan:s.columnProp("colspan"),rowspan:s.columnProp("rowspan"),onClick:e[3]||(e[3]=function(){return s.onClick&&s.onClick.apply(s,arguments)}),onKeydown:e[4]||(e[4]=function(){return s.onKeyDown&&s.onKeyDown.apply(s,arguments)}),role:"cell"},Zx(Zx({},s.getColumnPT("root")),s.getColumnPT("bodyCell")),{"data-p-selection-column":s.columnProp("selectionMode")!=null,"data-p-editable-column":s.isEditable(),"data-p-cell-editing":i.d_editing,"data-p-frozen-column":s.columnProp("frozen")}),[t.column.children&&t.column.children.body&&!i.d_editing?(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.column.children.body),{key:0,data:t.rowData,column:t.column,field:s.field,index:t.rowIndex,frozenRow:t.frozenRow,editorInitCallback:s.editorInitCallback,rowTogglerCallback:s.toggleRow},null,8,["data","column","field","index","frozenRow","editorInitCallback","rowTogglerCallback"])):t.column.children&&t.column.children.editor&&i.d_editing?(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.column.children.editor),{key:1,data:s.editingRowData,column:t.column,field:s.field,index:t.rowIndex,frozenRow:t.frozenRow,editorSaveCallback:s.editorSaveCallback,editorCancelCallback:s.editorCancelCallback},null,8,["data","column","field","index","frozenRow","editorSaveCallback","editorCancelCallback"])):t.column.children&&t.column.children.body&&!t.column.children.editor&&i.d_editing?(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.column.children.body),{key:2,data:s.editingRowData,column:t.column,field:s.field,index:t.rowIndex,frozenRow:t.frozenRow},null,8,["data","column","field","index","frozenRow"])):s.columnProp("selectionMode")?(I.openBlock(),I.createElementBlock(I.Fragment,{key:3},[s.columnProp("selectionMode")==="single"?(I.openBlock(),I.createBlock(a,{key:0,value:t.rowData,name:t.name,checked:t.selected,onChange:e[0]||(e[0]=function(C){return s.toggleRowWithRadio(C,t.rowIndex)}),column:t.column,index:t.index,unstyled:r.unstyled,pt:r.pt},null,8,["value","name","checked","column","index","unstyled","pt"])):s.columnProp("selectionMode")==="multiple"?(I.openBlock(),I.createBlock(o,{key:1,value:t.rowData,checked:t.selected,rowCheckboxIconTemplate:t.column.children&&t.column.children.rowcheckboxicon,"aria-selected":t.selected?!0:void 0,onChange:e[1]||(e[1]=function(C){return s.toggleRowWithCheckbox(C,t.rowIndex)}),column:t.column,index:t.index,unstyled:r.unstyled,pt:r.pt},null,8,["value","checked","rowCheckboxIconTemplate","aria-selected","column","index","unstyled","pt"])):I.createCommentVNode("",!0)],64)):s.columnProp("rowReorder")?(I.openBlock(),I.createElementBlock(I.Fragment,{key:4},[t.column.children&&t.column.children.rowreordericon?(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.column.children.rowreordericon),I.mergeProps({key:0,class:r.cx("reorderableRowHandle")},s.getColumnPT("reorderableRowHandle")),null,16,["class"])):s.columnProp("rowReorderIcon")?(I.openBlock(),I.createElementBlock("i",I.mergeProps({key:1,class:[r.cx("reorderableRowHandle"),s.columnProp("rowReorderIcon")]},s.getColumnPT("reorderableRowHandle")),null,16)):(I.openBlock(),I.createBlock(u,I.mergeProps({key:2,class:r.cx("reorderableRowHandle")},s.getColumnPT("reorderableRowHandle")),null,16,["class"]))],64)):s.columnProp("expander")?I.withDirectives((I.openBlock(),I.createElementBlock("button",I.mergeProps({key:5,class:r.cx("rowToggleButton"),type:"button","aria-expanded":t.isRowExpanded,"aria-controls":t.ariaControls,"aria-label":s.expandButtonAriaLabel,onClick:e[2]||(e[2]=I.withModifiers(function(){return s.toggleRow&&s.toggleRow.apply(s,arguments)},["stop"])),"data-p-selected":"selected"},s.getColumnPT("rowToggleButton"),{"data-pc-group-section":"rowactionbutton"}),[t.column.children&&t.column.children.rowtoggleicon?(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.column.children.rowtoggleicon),{key:0,class:I.normalizeClass(r.cx("rowToggleIcon")),rowExpanded:t.isRowExpanded},null,8,["class","rowExpanded"])):t.column.children&&t.column.children.rowtogglericon?(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.column.children.rowtogglericon),{key:1,class:I.normalizeClass(r.cx("rowToggleIcon")),rowExpanded:t.isRowExpanded},null,8,["class","rowExpanded"])):(I.openBlock(),I.createElementBlock(I.Fragment,{key:2},[t.isRowExpanded&&t.expandedRowIcon?(I.openBlock(),I.createElementBlock("span",{key:0,class:I.normalizeClass([r.cx("rowToggleIcon"),t.expandedRowIcon])},null,2)):t.isRowExpanded&&!t.expandedRowIcon?(I.openBlock(),I.createBlock(f,I.mergeProps({key:1,class:r.cx("rowToggleIcon")},s.getColumnPT("rowToggleIcon")),null,16,["class"])):!t.isRowExpanded&&t.collapsedRowIcon?(I.openBlock(),I.createElementBlock("span",{key:2,class:I.normalizeClass([r.cx("rowToggleIcon"),t.collapsedRowIcon])},null,2)):!t.isRowExpanded&&!t.collapsedRowIcon?(I.openBlock(),I.createBlock(g,I.mergeProps({key:3,class:r.cx("rowToggleIcon")},s.getColumnPT("rowToggleIcon")),null,16,["class"])):I.createCommentVNode("",!0)],64))],16,oKe)),[[A]]):t.editMode==="row"&&s.columnProp("rowEditor")?(I.openBlock(),I.createElementBlock(I.Fragment,{key:6},[i.d_editing?I.createCommentVNode("",!0):(I.openBlock(),I.createBlock(y,I.mergeProps({key:0,class:r.cx("pcRowEditorInit"),"aria-label":s.initButtonAriaLabel,unstyled:r.unstyled,onClick:s.onRowEditInit},t.editButtonProps.init,{pt:s.getColumnPT("pcRowEditorInit"),"data-pc-group-section":"rowactionbutton"}),{icon:I.withCtx(function(C){return[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.column.children&&t.column.children.roweditoriniticon||"PencilIcon"),I.mergeProps({class:C.class},s.getColumnPT("pcRowEditorInit").icon),null,16,["class"]))]}),_:1},16,["class","aria-label","unstyled","onClick","pt"])),i.d_editing?(I.openBlock(),I.createBlock(y,I.mergeProps({key:1,class:r.cx("pcRowEditorSave"),"aria-label":s.saveButtonAriaLabel,unstyled:r.unstyled,onClick:s.onRowEditSave},t.editButtonProps.save,{pt:s.getColumnPT("pcRowEditorSave"),"data-pc-group-section":"rowactionbutton"}),{icon:I.withCtx(function(C){return[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.column.children&&t.column.children.roweditorsaveicon||"CheckIcon"),I.mergeProps({class:C.class},s.getColumnPT("pcRowEditorSave").icon),null,16,["class"]))]}),_:1},16,["class","aria-label","unstyled","onClick","pt"])):I.createCommentVNode("",!0),i.d_editing?(I.openBlock(),I.createBlock(y,I.mergeProps({key:2,class:r.cx("pcRowEditorCancel"),"aria-label":s.cancelButtonAriaLabel,unstyled:r.unstyled,onClick:s.onRowEditCancel},t.editButtonProps.cancel,{pt:s.getColumnPT("pcRowEditorCancel"),"data-pc-group-section":"rowactionbutton"}),{icon:I.withCtx(function(C){return[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.column.children&&t.column.children.roweditorcancelicon||"TimesIcon"),I.mergeProps({class:C.class},s.getColumnPT("pcRowEditorCancel").icon),null,16,["class"]))]}),_:1},16,["class","aria-label","unstyled","onClick","pt"])):I.createCommentVNode("",!0)],64)):(I.openBlock(),I.createElementBlock(I.Fragment,{key:7},[I.createTextVNode(I.toDisplayString(s.resolveFieldData()),1)],64))],16,sKe))}sQ.render=aKe;function Iv(r){"@babel/helpers - typeof";return Iv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Iv(r)}function lKe(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=cKe(r))||e){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(f){throw f},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,a=!0,o=!1;return{s:function(){t=t.call(r)},n:function(){var f=t.next();return a=f.done,f},e:function(f){o=!0,s=f},f:function(){try{a||t.return==null||t.return()}finally{if(o)throw s}}}}function cKe(r,e){if(r){if(typeof r=="string")return l$(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?l$(r,e):void 0}}function l$(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}function c$(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function u$(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?c$(Object(t),!0).forEach(function(n){uKe(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):c$(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function uKe(r,e,t){return(e=hKe(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function hKe(r){var e=dKe(r,"string");return Iv(e)=="symbol"?e:e+""}function dKe(r,e){if(Iv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(Iv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var oQ={name:"BodyRow",hostName:"DataTable",extends:In,emits:["rowgroup-toggle","row-click","row-dblclick","row-rightclick","row-touchend","row-keydown","row-mousedown","row-dragstart","row-dragover","row-dragleave","row-dragend","row-drop","row-toggle","radio-change","checkbox-change","cell-edit-init","cell-edit-complete","cell-edit-cancel","row-edit-init","row-edit-save","row-edit-cancel","editing-meta-change"],props:{rowData:{type:Object,default:null},index:{type:Number,default:0},value:{type:Array,default:null},columns:{type:null,default:null},frozenRow:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String,Function],default:null},expandableRowGroups:{type:Boolean,default:!1},expandedRowGroups:{type:Array,default:null},first:{type:Number,default:0},dataKey:{type:[String,Function],default:null},expandedRowIcon:{type:String,default:null},collapsedRowIcon:{type:String,default:null},expandedRows:{type:[Array,Object],default:null},selection:{type:[Array,Object],default:null},selectionKeys:{type:null,default:null},selectionMode:{type:String,default:null},contextMenu:{type:Boolean,default:!1},contextMenuSelection:{type:Object,default:null},rowClass:{type:null,default:null},rowStyle:{type:null,default:null},rowGroupHeaderStyle:{type:null,default:null},editMode:{type:String,default:null},compareSelectionBy:{type:String,default:"deepEquals"},editingRows:{type:Array,default:null},editingRowKeys:{type:null,default:null},editingMeta:{type:Object,default:null},templates:{type:null,default:null},scrollable:{type:Boolean,default:!1},editButtonProps:{type:Object,default:null},virtualScrollerContentProps:{type:Object,default:null},isVirtualScrollerDisabled:{type:Boolean,default:!1},expandedRowId:{type:String,default:null},nameAttributeSelector:{type:String,default:null}},data:function(){return{d_rowExpanded:!1}},watch:{expandedRows:{deep:!0,immediate:!0,handler:function(e){var t=this;this.d_rowExpanded=this.dataKey?e?.[hn(this.rowData,this.dataKey)]!==void 0:e?.some(function(n){return t.equals(t.rowData,n)})}}},methods:{columnProp:function(e,t){return Id(e,t)},getColumnPT:function(e){var t={parent:{instance:this,props:this.$props,state:this.$data}};return I.mergeProps(this.ptm("column.".concat(e),{column:t}),this.ptm("column.".concat(e),t),this.ptmo(this.columnProp({},"pt"),e,t))},getBodyRowPTOptions:function(e){var t,n=(t=this.$parentInstance)===null||t===void 0?void 0:t.$parentInstance;return this.ptm(e,{context:{index:this.rowIndex,selectable:n?.rowHover||n?.selectionMode,selected:this.isSelected,stripedRows:n?.stripedRows||!1}})},shouldRenderBodyCell:function(e){var t=this.columnProp(e,"hidden");if(this.rowGroupMode&&!t){var n=this.columnProp(e,"field");if(this.rowGroupMode==="subheader")return this.groupRowsBy!==n;if(this.rowGroupMode==="rowspan")if(this.isGrouped(e)){var i=this.value[this.rowIndex-1];if(i){var s=hn(this.value[this.rowIndex],n),a=hn(i,n);return s!==a}else return!0}else return!0}else return!t},calculateRowGroupSize:function(e){if(this.isGrouped(e)){var t=this.rowIndex,n=this.columnProp(e,"field"),i=hn(this.value[t],n),s=i,a=0;for(this.d_rowExpanded&&a++;i===s;){a++;var o=this.value[++t];if(o)s=hn(o,n);else break}return a===1?null:a}else return null},isGrouped:function(e){var t=this.columnProp(e,"field");return this.groupRowsBy&&t?Array.isArray(this.groupRowsBy)?this.groupRowsBy.indexOf(t)>-1:this.groupRowsBy===t:!1},findIndexInSelection:function(e){return this.findIndex(e,this.selection)},findIndex:function(e,t){var n=-1;if(t&&t.length){for(var i=0;i<t.length;i++)if(this.equals(e,t[i])){n=i;break}}return n},equals:function(e,t){return this.compareSelectionBy==="equals"?e===t:Ip(e,t,this.dataKey)},onRowGroupToggle:function(e){this.$emit("rowgroup-toggle",{originalEvent:e,data:this.rowData})},onRowClick:function(e){this.$emit("row-click",{originalEvent:e,data:this.rowData,index:this.rowIndex})},onRowDblClick:function(e){this.$emit("row-dblclick",{originalEvent:e,data:this.rowData,index:this.rowIndex})},onRowRightClick:function(e){this.$emit("row-rightclick",{originalEvent:e,data:this.rowData,index:this.rowIndex})},onRowTouchEnd:function(e){this.$emit("row-touchend",e)},onRowKeyDown:function(e){this.$emit("row-keydown",{originalEvent:e,data:this.rowData,index:this.rowIndex})},onRowMouseDown:function(e){this.$emit("row-mousedown",e)},onRowDragStart:function(e){this.$emit("row-dragstart",{originalEvent:e,index:this.rowIndex})},onRowDragOver:function(e){this.$emit("row-dragover",{originalEvent:e,index:this.rowIndex})},onRowDragLeave:function(e){this.$emit("row-dragleave",e)},onRowDragEnd:function(e){this.$emit("row-dragend",e)},onRowDrop:function(e){this.$emit("row-drop",e)},onRowToggle:function(e){this.d_rowExpanded=!this.d_rowExpanded,this.$emit("row-toggle",u$(u$({},e),{},{expanded:this.d_rowExpanded}))},onRadioChange:function(e){this.$emit("radio-change",e)},onCheckboxChange:function(e){this.$emit("checkbox-change",e)},onCellEditInit:function(e){this.$emit("cell-edit-init",e)},onCellEditComplete:function(e){this.$emit("cell-edit-complete",e)},onCellEditCancel:function(e){this.$emit("cell-edit-cancel",e)},onRowEditInit:function(e){this.$emit("row-edit-init",e)},onRowEditSave:function(e){this.$emit("row-edit-save",e)},onRowEditCancel:function(e){this.$emit("row-edit-cancel",e)},onEditingMetaChange:function(e){this.$emit("editing-meta-change",e)},getVirtualScrollerProp:function(e,t){return t=t||this.virtualScrollerContentProps,t?t[e]:null}},computed:{rowIndex:function(){var e=this.getVirtualScrollerProp("getItemOptions");return e?e(this.index).index:this.index},rowStyles:function(){var e;return(e=this.rowStyle)===null||e===void 0?void 0:e.call(this,this.rowData)},rowClasses:function(){var e=[],t=null;if(this.rowClass){var n=this.rowClass(this.rowData);n&&e.push(n)}if(this.columns){var i=lKe(this.columns),s;try{for(i.s();!(s=i.n()).done;){var a=s.value,o=this.columnProp(a,"selectionMode");if(Xr(o)){t=o;break}}}catch(u){i.e(u)}finally{i.f()}}return[this.cx("row",{rowData:this.rowData,index:this.rowIndex,columnSelectionMode:t}),e]},rowTabindex:function(){return this.selection===null&&(this.selectionMode==="single"||this.selectionMode==="multiple")&&this.rowIndex===0?0:-1},isRowEditing:function(){return this.rowData&&this.editingRows?this.dataKey?this.editingRowKeys?this.editingRowKeys[hn(this.rowData,this.dataKey)]!==void 0:!1:this.findIndex(this.rowData,this.editingRows)>-1:!1},isRowGroupExpanded:function(){if(this.expandableRowGroups&&this.expandedRowGroups){var e=hn(this.rowData,this.groupRowsBy);return this.expandedRowGroups.indexOf(e)>-1}return!1},isSelected:function(){return this.rowData&&this.selection?this.dataKey?this.selectionKeys?this.selectionKeys[hn(this.rowData,this.dataKey)]!==void 0:!1:this.selection instanceof Array?this.findIndexInSelection(this.rowData)>-1:this.equals(this.rowData,this.selection):!1},isSelectedWithContextMenu:function(){return this.rowData&&this.contextMenuSelection?this.equals(this.rowData,this.contextMenuSelection,this.dataKey):!1},shouldRenderRowGroupHeader:function(){var e=hn(this.rowData,this.groupRowsBy),t=this.value[this.rowIndex-1];if(t){var n=hn(t,this.groupRowsBy);return e!==n}else return!0},shouldRenderRowGroupFooter:function(){if(this.expandableRowGroups&&!this.isRowGroupExpanded)return!1;var e=hn(this.rowData,this.groupRowsBy),t=this.value[this.rowIndex+1];if(t){var n=hn(t,this.groupRowsBy);return e!==n}else return!0},columnsLength:function(){var e=this;if(this.columns){var t=0;return this.columns.forEach(function(n){e.columnProp(n,"hidden")&&t++}),this.columns.length-t}return 0}},components:{DTBodyCell:sQ,ChevronDownIcon:b2,ChevronRightIcon:gL}};function Pv(r){"@babel/helpers - typeof";return Pv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pv(r)}function h$(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function Wh(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?h$(Object(t),!0).forEach(function(n){fKe(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):h$(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function fKe(r,e,t){return(e=pKe(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function pKe(r){var e=gKe(r,"string");return Pv(e)=="symbol"?e:e+""}function gKe(r,e){if(Pv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(Pv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var mKe=["colspan"],yKe=["tabindex","aria-selected","data-p-index","data-p-selectable-row","data-p-selected","data-p-selected-contextmenu"],bKe=["id"],_Ke=["colspan"],vKe=["colspan"],AKe=["colspan"];function xKe(r,e,t,n,i,s){var a=I.resolveComponent("ChevronDownIcon"),o=I.resolveComponent("ChevronRightIcon"),u=I.resolveComponent("DTBodyCell");return t.empty?(I.openBlock(),I.createElementBlock("tr",I.mergeProps({key:1,class:r.cx("emptyMessage"),role:"row"},r.ptm("emptyMessage")),[I.createElementVNode("td",I.mergeProps({colspan:s.columnsLength},Wh(Wh({},s.getColumnPT("bodycell")),r.ptm("emptyMessageCell"))),[t.templates.empty?(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.templates.empty),{key:0})):I.createCommentVNode("",!0)],16,AKe)],16)):(I.openBlock(),I.createElementBlock(I.Fragment,{key:0},[t.templates.groupheader&&t.rowGroupMode==="subheader"&&s.shouldRenderRowGroupHeader?(I.openBlock(),I.createElementBlock("tr",I.mergeProps({key:0,class:r.cx("rowGroupHeader"),style:t.rowGroupHeaderStyle,role:"row"},r.ptm("rowGroupHeader")),[I.createElementVNode("td",I.mergeProps({colspan:s.columnsLength-1},Wh(Wh({},s.getColumnPT("bodycell")),r.ptm("rowGroupHeaderCell"))),[t.expandableRowGroups?(I.openBlock(),I.createElementBlock("button",I.mergeProps({key:0,class:r.cx("rowToggleButton"),onClick:e[0]||(e[0]=function(){return s.onRowGroupToggle&&s.onRowGroupToggle.apply(s,arguments)}),type:"button"},r.ptm("rowToggleButton")),[t.templates.rowtoggleicon||t.templates.rowgrouptogglericon?(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.templates.rowtoggleicon||t.templates.rowgrouptogglericon),{key:0,expanded:s.isRowGroupExpanded},null,8,["expanded"])):(I.openBlock(),I.createElementBlock(I.Fragment,{key:1},[s.isRowGroupExpanded&&t.expandedRowIcon?(I.openBlock(),I.createElementBlock("span",I.mergeProps({key:0,class:[r.cx("rowToggleIcon"),t.expandedRowIcon]},r.ptm("rowToggleIcon")),null,16)):s.isRowGroupExpanded&&!t.expandedRowIcon?(I.openBlock(),I.createBlock(a,I.mergeProps({key:1,class:r.cx("rowToggleIcon")},r.ptm("rowToggleIcon")),null,16,["class"])):!s.isRowGroupExpanded&&t.collapsedRowIcon?(I.openBlock(),I.createElementBlock("span",I.mergeProps({key:2,class:[r.cx("rowToggleIcon"),t.collapsedRowIcon]},r.ptm("rowToggleIcon")),null,16)):!s.isRowGroupExpanded&&!t.collapsedRowIcon?(I.openBlock(),I.createBlock(o,I.mergeProps({key:3,class:r.cx("rowToggleIcon")},r.ptm("rowToggleIcon")),null,16,["class"])):I.createCommentVNode("",!0)],64))],16)):I.createCommentVNode("",!0),(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.templates.groupheader),{data:t.rowData,index:s.rowIndex},null,8,["data","index"]))],16,mKe)],16)):I.createCommentVNode("",!0),!t.expandableRowGroups||s.isRowGroupExpanded?(I.openBlock(),I.createElementBlock("tr",I.mergeProps({key:1,class:s.rowClasses,style:s.rowStyles,tabindex:s.rowTabindex,role:"row","aria-selected":t.selectionMode?s.isSelected:null,onClick:e[1]||(e[1]=function(){return s.onRowClick&&s.onRowClick.apply(s,arguments)}),onDblclick:e[2]||(e[2]=function(){return s.onRowDblClick&&s.onRowDblClick.apply(s,arguments)}),onContextmenu:e[3]||(e[3]=function(){return s.onRowRightClick&&s.onRowRightClick.apply(s,arguments)}),onTouchend:e[4]||(e[4]=function(){return s.onRowTouchEnd&&s.onRowTouchEnd.apply(s,arguments)}),onKeydown:e[5]||(e[5]=I.withModifiers(function(){return s.onRowKeyDown&&s.onRowKeyDown.apply(s,arguments)},["self"])),onMousedown:e[6]||(e[6]=function(){return s.onRowMouseDown&&s.onRowMouseDown.apply(s,arguments)}),onDragstart:e[7]||(e[7]=function(){return s.onRowDragStart&&s.onRowDragStart.apply(s,arguments)}),onDragover:e[8]||(e[8]=function(){return s.onRowDragOver&&s.onRowDragOver.apply(s,arguments)}),onDragleave:e[9]||(e[9]=function(){return s.onRowDragLeave&&s.onRowDragLeave.apply(s,arguments)}),onDragend:e[10]||(e[10]=function(){return s.onRowDragEnd&&s.onRowDragEnd.apply(s,arguments)}),onDrop:e[11]||(e[11]=function(){return s.onRowDrop&&s.onRowDrop.apply(s,arguments)})},s.getBodyRowPTOptions("bodyRow"),{"data-p-index":s.rowIndex,"data-p-selectable-row":!!t.selectionMode,"data-p-selected":t.selection&&s.isSelected,"data-p-selected-contextmenu":t.contextMenuSelection&&s.isSelectedWithContextMenu}),[(I.openBlock(!0),I.createElementBlock(I.Fragment,null,I.renderList(t.columns,function(f,g){return I.openBlock(),I.createElementBlock(I.Fragment,null,[s.shouldRenderBodyCell(f)?(I.openBlock(),I.createBlock(u,{key:s.columnProp(f,"columnKey")||s.columnProp(f,"field")||g,rowData:t.rowData,column:f,rowIndex:s.rowIndex,index:g,selected:s.isSelected,frozenRow:t.frozenRow,rowspan:t.rowGroupMode==="rowspan"?s.calculateRowGroupSize(f):null,editMode:t.editMode,editing:t.editMode==="row"&&s.isRowEditing,editingMeta:t.editingMeta,virtualScrollerContentProps:t.virtualScrollerContentProps,ariaControls:t.expandedRowId+"_"+s.rowIndex+"_expansion",name:t.nameAttributeSelector,isRowExpanded:i.d_rowExpanded,expandedRowIcon:t.expandedRowIcon,collapsedRowIcon:t.collapsedRowIcon,editButtonProps:t.editButtonProps,onRadioChange:s.onRadioChange,onCheckboxChange:s.onCheckboxChange,onRowToggle:s.onRowToggle,onCellEditInit:s.onCellEditInit,onCellEditComplete:s.onCellEditComplete,onCellEditCancel:s.onCellEditCancel,onRowEditInit:s.onRowEditInit,onRowEditSave:s.onRowEditSave,onRowEditCancel:s.onRowEditCancel,onEditingMetaChange:s.onEditingMetaChange,unstyled:r.unstyled,pt:r.pt},null,8,["rowData","column","rowIndex","index","selected","frozenRow","rowspan","editMode","editing","editingMeta","virtualScrollerContentProps","ariaControls","name","isRowExpanded","expandedRowIcon","collapsedRowIcon","editButtonProps","onRadioChange","onCheckboxChange","onRowToggle","onCellEditInit","onCellEditComplete","onCellEditCancel","onRowEditInit","onRowEditSave","onRowEditCancel","onEditingMetaChange","unstyled","pt"])):I.createCommentVNode("",!0)],64)}),256))],16,yKe)):I.createCommentVNode("",!0),t.templates.expansion&&t.expandedRows&&i.d_rowExpanded?(I.openBlock(),I.createElementBlock("tr",I.mergeProps({key:2,id:t.expandedRowId+"_"+s.rowIndex+"_expansion",class:r.cx("rowExpansion"),role:"row"},r.ptm("rowExpansion")),[I.createElementVNode("td",I.mergeProps({colspan:s.columnsLength},Wh(Wh({},s.getColumnPT("bodycell")),r.ptm("rowExpansionCell"))),[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.templates.expansion),{data:t.rowData,index:s.rowIndex},null,8,["data","index"]))],16,_Ke)],16,bKe)):I.createCommentVNode("",!0),t.templates.groupfooter&&t.rowGroupMode==="subheader"&&s.shouldRenderRowGroupFooter?(I.openBlock(),I.createElementBlock("tr",I.mergeProps({key:3,class:r.cx("rowGroupFooter"),role:"row"},r.ptm("rowGroupFooter")),[I.createElementVNode("td",I.mergeProps({colspan:s.columnsLength-1},Wh(Wh({},s.getColumnPT("bodycell")),r.ptm("rowGroupFooterCell"))),[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.templates.groupfooter),{data:t.rowData,index:s.rowIndex},null,8,["data","index"]))],16,vKe)],16)):I.createCommentVNode("",!0)],64))}oQ.render=xKe;var aQ={name:"TableBody",hostName:"DataTable",extends:In,emits:["rowgroup-toggle","row-click","row-dblclick","row-rightclick","row-touchend","row-keydown","row-mousedown","row-dragstart","row-dragover","row-dragleave","row-dragend","row-drop","row-toggle","radio-change","checkbox-change","cell-edit-init","cell-edit-complete","cell-edit-cancel","row-edit-init","row-edit-save","row-edit-cancel","editing-meta-change"],props:{value:{type:Array,default:null},columns:{type:null,default:null},frozenRow:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String,Function],default:null},expandableRowGroups:{type:Boolean,default:!1},expandedRowGroups:{type:Array,default:null},first:{type:Number,default:0},dataKey:{type:[String,Function],default:null},expandedRowIcon:{type:String,default:null},collapsedRowIcon:{type:String,default:null},expandedRows:{type:[Array,Object],default:null},selection:{type:[Array,Object],default:null},selectionKeys:{type:null,default:null},selectionMode:{type:String,default:null},rowHover:{type:Boolean,default:!1},contextMenu:{type:Boolean,default:!1},contextMenuSelection:{type:Object,default:null},rowClass:{type:null,default:null},rowStyle:{type:null,default:null},editMode:{type:String,default:null},compareSelectionBy:{type:String,default:"deepEquals"},editingRows:{type:Array,default:null},editingRowKeys:{type:null,default:null},editingMeta:{type:Object,default:null},templates:{type:null,default:null},scrollable:{type:Boolean,default:!1},editButtonProps:{type:Object,default:null},virtualScrollerContentProps:{type:Object,default:null},isVirtualScrollerDisabled:{type:Boolean,default:!1}},data:function(){return{rowGroupHeaderStyleObject:{}}},mounted:function(){this.frozenRow&&this.updateFrozenRowStickyPosition(),this.scrollable&&this.rowGroupMode==="subheader"&&this.updateFrozenRowGroupHeaderStickyPosition()},updated:function(){this.frozenRow&&this.updateFrozenRowStickyPosition(),this.scrollable&&this.rowGroupMode==="subheader"&&this.updateFrozenRowGroupHeaderStickyPosition()},methods:{getRowKey:function(e,t){return this.dataKey?hn(e,this.dataKey):t},updateFrozenRowStickyPosition:function(){this.$el.style.top=AT(this.$el.previousElementSibling)+"px"},updateFrozenRowGroupHeaderStickyPosition:function(){var e=AT(this.$el.previousElementSibling);this.rowGroupHeaderStyleObject.top=e+"px"},getVirtualScrollerProp:function(e,t){return t=t||this.virtualScrollerContentProps,t?t[e]:null},bodyRef:function(e){var t=this.getVirtualScrollerProp("contentRef");t&&t(e)}},computed:{rowGroupHeaderStyle:function(){return this.scrollable?{top:this.rowGroupHeaderStyleObject.top}:null},bodyContentStyle:function(){return this.getVirtualScrollerProp("contentStyle")},ptmTBodyOptions:function(){var e;return{context:{scrollable:(e=this.$parentInstance)===null||e===void 0||(e=e.$parentInstance)===null||e===void 0?void 0:e.scrollable}}},dataP:function(){return wo({hoverable:this.rowHover||this.selectionMode,frozen:this.frozenRow})}},components:{DTBodyRow:oQ}},wKe=["data-p"];function CKe(r,e,t,n,i,s){var a=I.resolveComponent("DTBodyRow");return I.openBlock(),I.createElementBlock("tbody",I.mergeProps({ref:s.bodyRef,class:r.cx("tbody"),role:"rowgroup",style:s.bodyContentStyle,"data-p":s.dataP},r.ptm("tbody",s.ptmTBodyOptions)),[t.empty?(I.openBlock(),I.createBlock(a,{key:1,empty:t.empty,columns:t.columns,templates:t.templates,unstyled:r.unstyled,pt:r.pt},null,8,["empty","columns","templates","unstyled","pt"])):(I.openBlock(!0),I.createElementBlock(I.Fragment,{key:0},I.renderList(t.value,function(o,u){return I.openBlock(),I.createBlock(a,{key:s.getRowKey(o,u),rowData:o,index:u,value:t.value,columns:t.columns,frozenRow:t.frozenRow,empty:t.empty,first:t.first,dataKey:t.dataKey,selection:t.selection,selectionKeys:t.selectionKeys,selectionMode:t.selectionMode,contextMenu:t.contextMenu,contextMenuSelection:t.contextMenuSelection,rowGroupMode:t.rowGroupMode,groupRowsBy:t.groupRowsBy,expandableRowGroups:t.expandableRowGroups,rowClass:t.rowClass,rowStyle:t.rowStyle,editMode:t.editMode,compareSelectionBy:t.compareSelectionBy,scrollable:t.scrollable,expandedRowIcon:t.expandedRowIcon,collapsedRowIcon:t.collapsedRowIcon,expandedRows:t.expandedRows,expandedRowGroups:t.expandedRowGroups,editingRows:t.editingRows,editingRowKeys:t.editingRowKeys,templates:t.templates,editButtonProps:t.editButtonProps,virtualScrollerContentProps:t.virtualScrollerContentProps,isVirtualScrollerDisabled:t.isVirtualScrollerDisabled,editingMeta:t.editingMeta,rowGroupHeaderStyle:s.rowGroupHeaderStyle,expandedRowId:r.$id,nameAttributeSelector:r.$attrSelector,onRowgroupToggle:e[0]||(e[0]=function(f){return r.$emit("rowgroup-toggle",f)}),onRowClick:e[1]||(e[1]=function(f){return r.$emit("row-click",f)}),onRowDblclick:e[2]||(e[2]=function(f){return r.$emit("row-dblclick",f)}),onRowRightclick:e[3]||(e[3]=function(f){return r.$emit("row-rightclick",f)}),onRowTouchend:e[4]||(e[4]=function(f){return r.$emit("row-touchend",f)}),onRowKeydown:e[5]||(e[5]=function(f){return r.$emit("row-keydown",f)}),onRowMousedown:e[6]||(e[6]=function(f){return r.$emit("row-mousedown",f)}),onRowDragstart:e[7]||(e[7]=function(f){return r.$emit("row-dragstart",f)}),onRowDragover:e[8]||(e[8]=function(f){return r.$emit("row-dragover",f)}),onRowDragleave:e[9]||(e[9]=function(f){return r.$emit("row-dragleave",f)}),onRowDragend:e[10]||(e[10]=function(f){return r.$emit("row-dragend",f)}),onRowDrop:e[11]||(e[11]=function(f){return r.$emit("row-drop",f)}),onRowToggle:e[12]||(e[12]=function(f){return r.$emit("row-toggle",f)}),onRadioChange:e[13]||(e[13]=function(f){return r.$emit("radio-change",f)}),onCheckboxChange:e[14]||(e[14]=function(f){return r.$emit("checkbox-change",f)}),onCellEditInit:e[15]||(e[15]=function(f){return r.$emit("cell-edit-init",f)}),onCellEditComplete:e[16]||(e[16]=function(f){return r.$emit("cell-edit-complete",f)}),onCellEditCancel:e[17]||(e[17]=function(f){return r.$emit("cell-edit-cancel",f)}),onRowEditInit:e[18]||(e[18]=function(f){return r.$emit("row-edit-init",f)}),onRowEditSave:e[19]||(e[19]=function(f){return r.$emit("row-edit-save",f)}),onRowEditCancel:e[20]||(e[20]=function(f){return r.$emit("row-edit-cancel",f)}),onEditingMetaChange:e[21]||(e[21]=function(f){return r.$emit("editing-meta-change",f)}),unstyled:r.unstyled,pt:r.pt},null,8,["rowData","index","value","columns","frozenRow","empty","first","dataKey","selection","selectionKeys","selectionMode","contextMenu","contextMenuSelection","rowGroupMode","groupRowsBy","expandableRowGroups","rowClass","rowStyle","editMode","compareSelectionBy","scrollable","expandedRowIcon","collapsedRowIcon","expandedRows","expandedRowGroups","editingRows","editingRowKeys","templates","editButtonProps","virtualScrollerContentProps","isVirtualScrollerDisabled","editingMeta","rowGroupHeaderStyle","expandedRowId","nameAttributeSelector","unstyled","pt"])}),128))],16,wKe)}aQ.render=CKe;var lQ={name:"FooterCell",hostName:"DataTable",extends:In,props:{column:{type:Object,default:null},index:{type:Number,default:null}},data:function(){return{styleObject:{}}},mounted:function(){this.columnProp("frozen")&&this.updateStickyPosition()},updated:function(){this.columnProp("frozen")&&this.updateStickyPosition()},methods:{columnProp:function(e){return Id(this.column,e)},getColumnPT:function(e){var t,n,i={props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:this.index,size:(t=this.$parentInstance)===null||t===void 0||(t=t.$parentInstance)===null||t===void 0?void 0:t.size,showGridlines:((n=this.$parentInstance)===null||n===void 0||(n=n.$parentInstance)===null||n===void 0?void 0:n.showGridlines)||!1}};return I.mergeProps(this.ptm("column.".concat(e),{column:i}),this.ptm("column.".concat(e),i),this.ptmo(this.getColumnProp(),e,i))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},updateStickyPosition:function(){if(this.columnProp("frozen")){var e=this.columnProp("alignFrozen");if(e==="right"){var t=0,n=g2(this.$el,'[data-p-frozen-column="true"]');n&&(t=da(n)+parseFloat(n.style["inset-inline-end"]||0)),this.styleObject.insetInlineEnd=t+"px"}else{var i=0,s=m2(this.$el,'[data-p-frozen-column="true"]');s&&(i=da(s)+parseFloat(s.style["inset-inline-start"]||0)),this.styleObject.insetInlineStart=i+"px"}}}},computed:{containerClass:function(){return[this.columnProp("footerClass"),this.columnProp("class"),this.cx("footerCell")]},containerStyle:function(){var e=this.columnProp("footerStyle"),t=this.columnProp("style");return this.columnProp("frozen")?[t,e,this.styleObject]:[t,e]}}};function Bv(r){"@babel/helpers - typeof";return Bv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bv(r)}function d$(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function f$(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?d$(Object(t),!0).forEach(function(n){TKe(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):d$(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function TKe(r,e,t){return(e=SKe(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function SKe(r){var e=EKe(r,"string");return Bv(e)=="symbol"?e:e+""}function EKe(r,e){if(Bv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(Bv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var IKe=["colspan","rowspan","data-p-frozen-column"];function PKe(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("td",I.mergeProps({style:s.containerStyle,class:s.containerClass,role:"cell",colspan:s.columnProp("colspan"),rowspan:s.columnProp("rowspan")},f$(f$({},s.getColumnPT("root")),s.getColumnPT("footerCell")),{"data-p-frozen-column":s.columnProp("frozen")}),[t.column.children&&t.column.children.footer?(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.column.children.footer),{key:0,column:t.column},null,8,["column"])):I.createCommentVNode("",!0),s.columnProp("footer")?(I.openBlock(),I.createElementBlock("span",I.mergeProps({key:1,class:r.cx("columnFooter")},s.getColumnPT("columnFooter")),I.toDisplayString(s.columnProp("footer")),17)):I.createCommentVNode("",!0)],16,IKe)}lQ.render=PKe;function BKe(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=MKe(r))||e){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(f){throw f},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,a=!0,o=!1;return{s:function(){t=t.call(r)},n:function(){var f=t.next();return a=f.done,f},e:function(f){o=!0,s=f},f:function(){try{a||t.return==null||t.return()}finally{if(o)throw s}}}}function MKe(r,e){if(r){if(typeof r=="string")return p$(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?p$(r,e):void 0}}function p$(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}var cQ={name:"TableFooter",hostName:"DataTable",extends:In,props:{columnGroup:{type:null,default:null},columns:{type:Object,default:null}},provide:function(){return{$rows:this.d_footerRows,$columns:this.d_footerColumns}},data:function(){return{d_footerRows:new by({type:"Row"}),d_footerColumns:new by({type:"Column"})}},beforeUnmount:function(){this.d_footerRows.clear(),this.d_footerColumns.clear()},methods:{columnProp:function(e,t){return Id(e,t)},getColumnGroupPT:function(e){var t={props:this.getColumnGroupProps(),parent:{instance:this,props:this.$props,state:this.$data},context:{type:"footer",scrollable:this.ptmTFootOptions.context.scrollable}};return I.mergeProps(this.ptm("columnGroup.".concat(e),{columnGroup:t}),this.ptm("columnGroup.".concat(e),t),this.ptmo(this.getColumnGroupProps(),e,t))},getColumnGroupProps:function(){return this.columnGroup&&this.columnGroup.props&&this.columnGroup.props.pt?this.columnGroup.props.pt:void 0},getRowPT:function(e,t,n){var i={props:e.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:n}};return I.mergeProps(this.ptm("row.".concat(t),{row:i}),this.ptm("row.".concat(t),i),this.ptmo(this.getRowProp(e),t,i))},getRowProp:function(e){return e.props&&e.props.pt?e.props.pt:void 0},getFooterRows:function(){var e;return(e=this.d_footerRows)===null||e===void 0?void 0:e.get(this.columnGroup,this.columnGroup.children)},getFooterColumns:function(e){var t;return(t=this.d_footerColumns)===null||t===void 0?void 0:t.get(e,e.children)}},computed:{hasFooter:function(){var e=!1;if(this.columnGroup)e=!0;else if(this.columns){var t=BKe(this.columns),n;try{for(t.s();!(n=t.n()).done;){var i=n.value;if(this.columnProp(i,"footer")||i.children&&i.children.footer){e=!0;break}}}catch(s){t.e(s)}finally{t.f()}}return e},ptmTFootOptions:function(){var e;return{context:{scrollable:(e=this.$parentInstance)===null||e===void 0||(e=e.$parentInstance)===null||e===void 0?void 0:e.scrollable}}}},components:{DTFooterCell:lQ}};function Mv(r){"@babel/helpers - typeof";return Mv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mv(r)}function g$(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function Qx(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?g$(Object(t),!0).forEach(function(n){RKe(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):g$(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function RKe(r,e,t){return(e=kKe(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function kKe(r){var e=OKe(r,"string");return Mv(e)=="symbol"?e:e+""}function OKe(r,e){if(Mv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(Mv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var DKe=["data-p-scrollable"];function LKe(r,e,t,n,i,s){var a,o=I.resolveComponent("DTFooterCell");return s.hasFooter?(I.openBlock(),I.createElementBlock("tfoot",I.mergeProps({key:0,class:r.cx("tfoot"),style:r.sx("tfoot"),role:"rowgroup"},t.columnGroup?Qx(Qx({},r.ptm("tfoot",s.ptmTFootOptions)),s.getColumnGroupPT("root")):r.ptm("tfoot",s.ptmTFootOptions),{"data-p-scrollable":(a=r.$parentInstance)===null||a===void 0||(a=a.$parentInstance)===null||a===void 0?void 0:a.scrollable,"data-pc-section":"tfoot"}),[t.columnGroup?(I.openBlock(!0),I.createElementBlock(I.Fragment,{key:1},I.renderList(s.getFooterRows(),function(u,f){return I.openBlock(),I.createElementBlock("tr",I.mergeProps({key:f,role:"row"},{ref_for:!0},Qx(Qx({},r.ptm("footerRow")),s.getRowPT(u,"root",f))),[(I.openBlock(!0),I.createElementBlock(I.Fragment,null,I.renderList(s.getFooterColumns(u),function(g,y){return I.openBlock(),I.createElementBlock(I.Fragment,{key:s.columnProp(g,"columnKey")||s.columnProp(g,"field")||y},[s.columnProp(g,"hidden")?I.createCommentVNode("",!0):(I.openBlock(),I.createBlock(o,{key:0,column:g,index:f,pt:r.pt},null,8,["column","index","pt"]))],64)}),128))],16)}),128)):(I.openBlock(),I.createElementBlock("tr",I.mergeProps({key:0,role:"row"},r.ptm("footerRow")),[(I.openBlock(!0),I.createElementBlock(I.Fragment,null,I.renderList(t.columns,function(u,f){return I.openBlock(),I.createElementBlock(I.Fragment,{key:s.columnProp(u,"columnKey")||s.columnProp(u,"field")||f},[s.columnProp(u,"hidden")?I.createCommentVNode("",!0):(I.openBlock(),I.createBlock(o,{key:0,column:u,pt:r.pt},null,8,["column","pt"]))],64)}),128))],16))],16,DKe)):I.createCommentVNode("",!0)}cQ.render=LKe;function Rv(r){"@babel/helpers - typeof";return Rv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rv(r)}function m$(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function Ef(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?m$(Object(t),!0).forEach(function(n){NKe(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):m$(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function NKe(r,e,t){return(e=FKe(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function FKe(r){var e=UKe(r,"string");return Rv(e)=="symbol"?e:e+""}function UKe(r,e){if(Rv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(Rv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var bL={name:"ColumnFilter",hostName:"DataTable",extends:In,emits:["filter-change","filter-apply","operator-change","matchmode-change","constraint-add","constraint-remove","filter-clear","apply-click"],props:{field:{type:String,default:null},type:{type:String,default:"text"},display:{type:String,default:null},showMenu:{type:Boolean,default:!0},matchMode:{type:String,default:null},showOperator:{type:Boolean,default:!0},showClearButton:{type:Boolean,default:!0},showApplyButton:{type:Boolean,default:!0},showMatchModes:{type:Boolean,default:!0},showAddButton:{type:Boolean,default:!0},matchModeOptions:{type:Array,default:null},maxConstraints:{type:Number,default:2},filterElement:{type:Function,default:null},filterHeaderTemplate:{type:Function,default:null},filterFooterTemplate:{type:Function,default:null},filterClearTemplate:{type:Function,default:null},filterApplyTemplate:{type:Function,default:null},filterIconTemplate:{type:Function,default:null},filterAddIconTemplate:{type:Function,default:null},filterRemoveIconTemplate:{type:Function,default:null},filterClearIconTemplate:{type:Function,default:null},filters:{type:Object,default:null},filtersStore:{type:Object,default:null},filterMenuClass:{type:String,default:null},filterMenuStyle:{type:null,default:null},filterInputProps:{type:null,default:null},filterButtonProps:{type:null,default:null},column:null},data:function(){return{overlayVisible:!1,defaultMatchMode:null,defaultOperator:null}},overlay:null,selfClick:!1,overlayEventListener:null,beforeUnmount:function(){this.overlayEventListener&&(hd.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null),this.overlay&&(Gm.clear(this.overlay),this.onOverlayHide())},mounted:function(){if(this.filters&&this.filters[this.field]){var e=this.filters[this.field];e.operator?(this.defaultMatchMode=e.constraints[0].matchMode,this.defaultOperator=e.operator):this.defaultMatchMode=this.filters[this.field].matchMode}},methods:{getColumnPT:function(e,t){var n=Ef({props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data}},t);return I.mergeProps(this.ptm("column.".concat(e),{column:n}),this.ptm("column.".concat(e),n),this.ptmo(this.getColumnProp(),e,n))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},ptmFilterConstraintOptions:function(e){return{context:{highlighted:e&&this.isRowMatchModeSelected(e.value)}}},clearFilter:function(){var e=Ef({},this.filters);e[this.field].operator?(e[this.field].constraints.splice(1),e[this.field].operator=this.defaultOperator,e[this.field].constraints[0]={value:null,matchMode:this.defaultMatchMode}):(e[this.field].value=null,e[this.field].matchMode=this.defaultMatchMode),this.$emit("filter-clear"),this.$emit("filter-change",e),this.$emit("filter-apply"),this.hide()},applyFilter:function(){this.$emit("apply-click",{field:this.field,constraints:this.filters[this.field]}),this.$emit("filter-apply"),this.hide()},hasFilter:function(){if(this.filtersStore){var e=this.filtersStore[this.field];if(e)return e.operator?!this.isFilterBlank(e.constraints[0].value):!this.isFilterBlank(e.value)}return!1},hasRowFilter:function(){return this.filters[this.field]&&!this.isFilterBlank(this.filters[this.field].value)},isFilterBlank:function(e){return e!=null?typeof e=="string"&&e.trim().length==0||e instanceof Array&&e.length==0:!0},toggleMenu:function(e){this.overlayVisible=!this.overlayVisible,e.preventDefault()},onToggleButtonKeyDown:function(e){switch(e.code){case"Enter":case"NumpadEnter":case"Space":this.toggleMenu(e);break;case"Escape":this.overlayVisible=!1;break}},onRowMatchModeChange:function(e){var t=Ef({},this.filters);t[this.field].matchMode=e,this.$emit("matchmode-change",{field:this.field,matchMode:e}),this.$emit("filter-change",t),this.$emit("filter-apply"),this.hide()},onRowMatchModeKeyDown:function(e){var t=e.target;switch(e.code){case"ArrowDown":var n=this.findNextItem(t);n&&(t.removeAttribute("tabindex"),n.tabIndex="0",n.focus()),e.preventDefault();break;case"ArrowUp":var i=this.findPrevItem(t);i&&(t.removeAttribute("tabindex"),i.tabIndex="0",i.focus()),e.preventDefault();break}},isRowMatchModeSelected:function(e){return this.filters[this.field].matchMode===e},onOperatorChange:function(e){var t=Ef({},this.filters);t[this.field].operator=e,this.$emit("filter-change",t),this.$emit("operator-change",{field:this.field,operator:e}),this.showApplyButton||this.$emit("filter-apply")},onMenuMatchModeChange:function(e,t){var n=Ef({},this.filters);n[this.field].constraints[t].matchMode=e,this.$emit("matchmode-change",{field:this.field,matchMode:e,index:t}),this.showApplyButton||this.$emit("filter-apply")},addConstraint:function(){var e=Ef({},this.filters),t={value:null,matchMode:this.defaultMatchMode};e[this.field].constraints.push(t),this.$emit("constraint-add",{field:this.field,constraint:t}),this.$emit("filter-change",e),this.showApplyButton||this.$emit("filter-apply")},removeConstraint:function(e){var t=Ef({},this.filters),n=t[this.field].constraints.splice(e,1);this.$emit("constraint-remove",{field:this.field,constraint:n}),this.$emit("filter-change",t),this.showApplyButton||this.$emit("filter-apply")},filterCallback:function(){this.$emit("filter-apply")},findNextItem:function(e){var t=e.nextElementSibling;return t?zs(t,"data-pc-section")==="filterconstraintseparator"?this.findNextItem(t):t:e.parentElement.firstElementChild},findPrevItem:function(e){var t=e.previousElementSibling;return t?zs(t,"data-pc-section")==="filterconstraintseparator"?this.findPrevItem(t):t:e.parentElement.lastElementChild},hide:function(){this.overlayVisible=!1,this.showMenuButton&&oa(this.$refs.icon.$el)},onContentClick:function(e){this.selfClick=!0,hd.emit("overlay-click",{originalEvent:e,target:this.overlay})},onContentMouseDown:function(){this.selfClick=!0},onOverlayEnter:function(e){var t=this;this.filterMenuStyle&&_T(this.overlay,this.filterMenuStyle),Gm.set("overlay",e,this.$primevue.config.zIndex.overlay),_T(e,{position:"absolute",top:"0"}),nZ(this.overlay,this.$refs.icon.$el),this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.overlayEventListener=function(n){t.isOutsideClicked(n.target)||(t.selfClick=!0)},hd.on("overlay-click",this.overlayEventListener)},onOverlayAfterEnter:function(){var e;(e=this.overlay)===null||e===void 0||(e=e.$focustrap)===null||e===void 0||e.autoFocus()},onOverlayLeave:function(){this.onOverlayHide()},onOverlayAfterLeave:function(e){Gm.clear(e)},onOverlayHide:function(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.unbindScrollListener(),this.overlay=null,hd.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null},overlayRef:function(e){this.overlay=e},isOutsideClicked:function(e){return!this.isTargetClicked(e)&&this.overlay&&!(this.overlay.isSameNode(e)||this.overlay.contains(e))},isTargetClicked:function(e){return this.$refs.icon&&(this.$refs.icon.$el.isSameNode(e)||this.$refs.icon.$el.contains(e))},bindOutsideClickListener:function(){var e=this;this.outsideClickListener||(this.outsideClickListener=function(t){e.overlayVisible&&!e.selfClick&&e.isOutsideClicked(t.target)&&(e.overlayVisible=!1),e.selfClick=!1},document.addEventListener("click",this.outsideClickListener,!0))},unbindOutsideClickListener:function(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener,!0),this.outsideClickListener=null,this.selfClick=!1)},bindScrollListener:function(){var e=this;this.scrollHandler||(this.scrollHandler=new dZ(this.$refs.icon.$el,function(){e.overlayVisible&&e.hide()})),this.scrollHandler.bindScrollListener()},unbindScrollListener:function(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener:function(){var e=this;this.resizeListener||(this.resizeListener=function(){e.overlayVisible&&!lZ()&&e.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener:function(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)}},computed:{showMenuButton:function(){return this.showMenu&&(this.display==="row"?this.type!=="boolean":!0)},overlayId:function(){return this.$id+"_overlay"},matchModes:function(){var e=this;return this.matchModeOptions||this.$primevue.config.filterMatchModeOptions[this.type].map(function(t){return{label:e.$primevue.config.locale[t],value:t}})},isShowMatchModes:function(){return this.type!=="boolean"&&this.showMatchModes&&this.matchModes},operatorOptions:function(){return[{label:this.$primevue.config.locale.matchAll,value:wT.AND},{label:this.$primevue.config.locale.matchAny,value:wT.OR}]},noFilterLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.noFilter:void 0},isShowOperator:function(){return this.showOperator&&this.filters[this.field].operator},operator:function(){return this.filters[this.field].operator},fieldConstraints:function(){return this.filters[this.field].constraints||[this.filters[this.field]]},showRemoveIcon:function(){return this.fieldConstraints.length>1},removeRuleButtonLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.removeRule:void 0},addRuleButtonLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.addRule:void 0},isShowAddConstraint:function(){return this.showAddButton&&this.filters[this.field].operator&&this.fieldConstraints&&this.fieldConstraints.length<this.maxConstraints},clearButtonLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.clear:void 0},applyButtonLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.apply:void 0},columnFilterButtonAriaLabel:function(){var e;return(e=this.$primevue.config.locale)!==null&&e!==void 0&&e.aria?this.overlayVisible?this.$primevue.config.locale.aria.hideFilterMenu:this.$primevue.config.locale.aria.showFilterMenu:void 0},filterOperatorAriaLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.filterOperator:void 0},filterRuleAriaLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.filterConstraint:void 0},ptmHeaderFilterClearParams:function(){return{context:{hidden:this.hasRowFilter()}}},ptmFilterMenuParams:function(){return{context:{overlayVisible:this.overlayVisible,active:this.hasFilter()}}}},components:{Select:rp,Button:wv,Portal:fL,FilterSlashIcon:eQ,FilterFillIcon:QZ,FilterIcon:ZZ,TrashIcon:rQ,PlusIcon:tQ},directives:{focustrap:OWe}};function kv(r){"@babel/helpers - typeof";return kv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kv(r)}function y$(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function ew(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?y$(Object(t),!0).forEach(function(n){zKe(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):y$(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function zKe(r,e,t){return(e=VKe(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function VKe(r){var e=$Ke(r,"string");return kv(e)=="symbol"?e:e+""}function $Ke(r,e){if(kv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(kv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var jKe=["id","aria-modal"],GKe=["onClick","onKeydown","tabindex"];function HKe(r,e,t,n,i,s){var a=I.resolveComponent("Button"),o=I.resolveComponent("Select"),u=I.resolveComponent("Portal"),f=I.resolveDirective("focustrap");return I.openBlock(),I.createElementBlock("div",I.mergeProps({class:r.cx("filter")},s.getColumnPT("filter")),[t.display==="row"?(I.openBlock(),I.createElementBlock("div",I.mergeProps({key:0,class:r.cx("filterElementContainer")},ew(ew({},t.filterInputProps),s.getColumnPT("filterElementContainer"))),[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.filterElement),{field:t.field,filterModel:t.filters[t.field],filterCallback:s.filterCallback},null,8,["field","filterModel","filterCallback"]))],16)):I.createCommentVNode("",!0),s.showMenuButton?(I.openBlock(),I.createBlock(a,I.mergeProps({key:1,ref:"icon","aria-label":s.columnFilterButtonAriaLabel,"aria-haspopup":"true","aria-expanded":i.overlayVisible,"aria-controls":i.overlayVisible?s.overlayId:void 0,class:r.cx("pcColumnFilterButton"),unstyled:r.unstyled,onClick:e[0]||(e[0]=function(g){return s.toggleMenu(g)}),onKeydown:e[1]||(e[1]=function(g){return s.onToggleButtonKeyDown(g)})},ew(ew({},s.getColumnPT("pcColumnFilterButton",s.ptmFilterMenuParams)),t.filterButtonProps.filter)),{icon:I.withCtx(function(g){return[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.filterIconTemplate||(s.hasFilter()?"FilterFillIcon":"FilterIcon")),I.mergeProps({class:g.class},s.getColumnPT("filterMenuIcon")),null,16,["class"]))]}),_:1},16,["aria-label","aria-expanded","aria-controls","class","unstyled"])):I.createCommentVNode("",!0),I.createVNode(u,null,{default:I.withCtx(function(){return[I.createVNode(I.Transition,I.mergeProps({name:"p-anchored-overlay",onEnter:s.onOverlayEnter,onAfterEnter:s.onOverlayAfterEnter,onLeave:s.onOverlayLeave,onAfterLeave:s.onOverlayAfterLeave},s.getColumnPT("transition")),{default:I.withCtx(function(){return[i.overlayVisible?I.withDirectives((I.openBlock(),I.createElementBlock("div",I.mergeProps({key:0,ref:s.overlayRef,id:s.overlayId,"aria-modal":i.overlayVisible,role:"dialog",class:[r.cx("filterOverlay"),t.filterMenuClass],onKeydown:e[10]||(e[10]=I.withKeys(function(){return s.hide&&s.hide.apply(s,arguments)},["escape"])),onClick:e[11]||(e[11]=function(){return s.onContentClick&&s.onContentClick.apply(s,arguments)}),onMousedown:e[12]||(e[12]=function(){return s.onContentMouseDown&&s.onContentMouseDown.apply(s,arguments)})},s.getColumnPT("filterOverlay")),[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.filterHeaderTemplate),{field:t.field,filterModel:t.filters[t.field],filterCallback:s.filterCallback},null,8,["field","filterModel","filterCallback"])),t.display==="row"?(I.openBlock(),I.createElementBlock("ul",I.mergeProps({key:0,class:r.cx("filterConstraintList")},s.getColumnPT("filterConstraintList")),[(I.openBlock(!0),I.createElementBlock(I.Fragment,null,I.renderList(s.matchModes,function(g,y){return I.openBlock(),I.createElementBlock("li",I.mergeProps({key:g.label,class:r.cx("filterConstraint",{matchMode:g}),onClick:function(C){return s.onRowMatchModeChange(g.value)},onKeydown:[e[2]||(e[2]=function(A){return s.onRowMatchModeKeyDown(A)}),I.withKeys(I.withModifiers(function(A){return s.onRowMatchModeChange(g.value)},["prevent"]),["enter"])],tabindex:y===0?"0":null},{ref_for:!0},s.getColumnPT("filterConstraint",s.ptmFilterConstraintOptions(g))),I.toDisplayString(g.label),17,GKe)}),128)),I.createElementVNode("li",I.mergeProps({class:r.cx("filterConstraintSeparator")},s.getColumnPT("filterConstraintSeparator")),null,16),I.createElementVNode("li",I.mergeProps({class:r.cx("filterConstraint"),onClick:e[3]||(e[3]=function(g){return s.clearFilter()}),onKeydown:[e[4]||(e[4]=function(g){return s.onRowMatchModeKeyDown(g)}),e[5]||(e[5]=I.withKeys(function(g){return r.onRowClearItemClick()},["enter"]))]},s.getColumnPT("filterConstraint")),I.toDisplayString(s.noFilterLabel),17)],16)):(I.openBlock(),I.createElementBlock(I.Fragment,{key:1},[s.isShowOperator?(I.openBlock(),I.createElementBlock("div",I.mergeProps({key:0,class:r.cx("filterOperator")},s.getColumnPT("filterOperator")),[I.createVNode(o,{options:s.operatorOptions,modelValue:s.operator,"aria-label":s.filterOperatorAriaLabel,class:I.normalizeClass(r.cx("pcFilterOperatorDropdown")),optionLabel:"label",optionValue:"value","onUpdate:modelValue":e[6]||(e[6]=function(g){return s.onOperatorChange(g)}),unstyled:r.unstyled,pt:s.getColumnPT("pcFilterOperatorDropdown")},null,8,["options","modelValue","aria-label","class","unstyled","pt"])],16)):I.createCommentVNode("",!0),I.createElementVNode("div",I.mergeProps({class:r.cx("filterRuleList")},s.getColumnPT("filterRuleList")),[(I.openBlock(!0),I.createElementBlock(I.Fragment,null,I.renderList(s.fieldConstraints,function(g,y){return I.openBlock(),I.createElementBlock("div",I.mergeProps({key:y,class:r.cx("filterRule")},{ref_for:!0},s.getColumnPT("filterRule")),[s.isShowMatchModes?(I.openBlock(),I.createBlock(o,{key:0,options:s.matchModes,modelValue:g.matchMode,class:I.normalizeClass(r.cx("pcFilterConstraintDropdown")),optionLabel:"label",optionValue:"value","aria-label":s.filterRuleAriaLabel,"onUpdate:modelValue":function(C){return s.onMenuMatchModeChange(C,y)},unstyled:r.unstyled,pt:s.getColumnPT("pcFilterConstraintDropdown")},null,8,["options","modelValue","class","aria-label","onUpdate:modelValue","unstyled","pt"])):I.createCommentVNode("",!0),t.display==="menu"?(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.filterElement),{key:1,field:t.field,filterModel:g,filterCallback:s.filterCallback,applyFilter:s.applyFilter},null,8,["field","filterModel","filterCallback","applyFilter"])):I.createCommentVNode("",!0),s.showRemoveIcon?(I.openBlock(),I.createElementBlock("div",I.mergeProps({key:2,ref_for:!0},s.getColumnPT("filterRemove")),[I.createVNode(a,I.mergeProps({type:"button",class:r.cx("pcFilterRemoveRuleButton"),onClick:function(C){return s.removeConstraint(y)},label:s.removeRuleButtonLabel,unstyled:r.unstyled},{ref_for:!0},t.filterButtonProps.popover.removeRule,{pt:s.getColumnPT("pcFilterRemoveRuleButton")}),{icon:I.withCtx(function(A){return[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.filterRemoveIconTemplate||"TrashIcon"),I.mergeProps({class:A.class},{ref_for:!0},s.getColumnPT("pcFilterRemoveRuleButton").icon),null,16,["class"]))]}),_:1},16,["class","onClick","label","unstyled","pt"])],16)):I.createCommentVNode("",!0)],16)}),128))],16),s.isShowAddConstraint?(I.openBlock(),I.createElementBlock("div",I.normalizeProps(I.mergeProps({key:1},s.getColumnPT("filterAddButtonContainer"))),[I.createVNode(a,I.mergeProps({type:"button",label:s.addRuleButtonLabel,iconPos:"left",class:r.cx("pcFilterAddRuleButton"),onClick:e[7]||(e[7]=function(g){return s.addConstraint()}),unstyled:r.unstyled},t.filterButtonProps.popover.addRule,{pt:s.getColumnPT("pcFilterAddRuleButton")}),{icon:I.withCtx(function(g){return[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.filterAddIconTemplate||"PlusIcon"),I.mergeProps({class:g.class},s.getColumnPT("pcFilterAddRuleButton").icon),null,16,["class"]))]}),_:1},16,["label","class","unstyled","pt"])],16)):I.createCommentVNode("",!0),I.createElementVNode("div",I.mergeProps({class:r.cx("filterButtonbar")},s.getColumnPT("filterButtonbar")),[!t.filterClearTemplate&&t.showClearButton?(I.openBlock(),I.createBlock(a,I.mergeProps({key:0,type:"button",class:r.cx("pcFilterClearButton"),label:s.clearButtonLabel,onClick:e[8]||(e[8]=function(g){return s.clearFilter()}),unstyled:r.unstyled},t.filterButtonProps.popover.clear,{pt:s.getColumnPT("pcFilterClearButton")}),null,16,["class","label","unstyled","pt"])):(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.filterClearTemplate),{key:1,field:t.field,filterModel:t.filters[t.field],filterCallback:s.clearFilter},null,8,["field","filterModel","filterCallback"])),t.showApplyButton?(I.openBlock(),I.createElementBlock(I.Fragment,{key:2},[t.filterApplyTemplate?(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.filterApplyTemplate),{key:1,field:t.field,filterModel:t.filters[t.field],filterCallback:s.applyFilter},null,8,["field","filterModel","filterCallback"])):(I.openBlock(),I.createBlock(a,I.mergeProps({key:0,type:"button",class:r.cx("pcFilterApplyButton"),label:s.applyButtonLabel,onClick:e[9]||(e[9]=function(g){return s.applyFilter()}),unstyled:r.unstyled},t.filterButtonProps.popover.apply,{pt:s.getColumnPT("pcFilterApplyButton")}),null,16,["class","label","unstyled","pt"]))],64)):I.createCommentVNode("",!0)],16)],64)),(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.filterFooterTemplate),{field:t.field,filterModel:t.filters[t.field],filterCallback:s.filterCallback},null,8,["field","filterModel","filterCallback"]))],16,jKe)),[[f]]):I.createCommentVNode("",!0)]}),_:1},16,["onEnter","onAfterEnter","onLeave","onAfterLeave"])]}),_:1})],16)}bL.render=HKe;var _L={name:"HeaderCheckbox",hostName:"DataTable",extends:In,emits:["change"],props:{checked:null,disabled:null,column:null,headerCheckboxIconTemplate:{type:Function,default:null}},methods:{getColumnPT:function(e){var t={props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data},context:{checked:this.checked,disabled:this.disabled}};return I.mergeProps(this.ptm("column.".concat(e),{column:t}),this.ptm("column.".concat(e),t),this.ptmo(this.getColumnProp(),e,t))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},onChange:function(e){this.$emit("change",{originalEvent:e,checked:!this.checked})}},computed:{headerCheckboxAriaLabel:function(){return this.$primevue.config.locale.aria?this.checked?this.$primevue.config.locale.aria.selectAll:this.$primevue.config.locale.aria.unselectAll:void 0}},components:{CheckIcon:Dy,Checkbox:yL}};function WKe(r,e,t,n,i,s){var a=I.resolveComponent("Checkbox");return I.openBlock(),I.createBlock(a,{modelValue:t.checked,binary:!0,disabled:t.disabled,"aria-label":s.headerCheckboxAriaLabel,onChange:s.onChange,unstyled:r.unstyled,pt:s.getColumnPT("pcHeaderCheckbox")},{icon:I.withCtx(function(o){return[t.headerCheckboxIconTemplate?(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.headerCheckboxIconTemplate),{key:0,checked:o.checked,class:I.normalizeClass(o.class)},null,8,["checked","class"])):I.createCommentVNode("",!0)]}),_:1},8,["modelValue","disabled","aria-label","onChange","unstyled","pt"])}_L.render=WKe;var uQ={name:"FilterHeaderCell",hostName:"DataTable",extends:In,emits:["checkbox-change","filter-change","filter-apply","operator-change","matchmode-change","constraint-add","constraint-remove","apply-click"],props:{column:{type:Object,default:null},index:{type:Number,default:null},allRowsSelected:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},display:{type:String,default:"row"},filters:{type:Object,default:null},filtersStore:{type:Object,default:null},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String,Function],default:null},filterInputProps:{type:null,default:null},filterButtonProps:{type:null,default:null}},data:function(){return{styleObject:{}}},mounted:function(){this.columnProp("frozen")&&this.updateStickyPosition()},updated:function(){this.columnProp("frozen")&&this.updateStickyPosition()},methods:{columnProp:function(e){return Id(this.column,e)},getColumnPT:function(e){if(!this.column)return null;var t={props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:this.index}};return I.mergeProps(this.ptm("column.".concat(e),{column:t}),this.ptm("column.".concat(e),t),this.ptmo(this.getColumnProp(),e,t))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},updateStickyPosition:function(){if(this.columnProp("frozen")){var e=this.columnProp("alignFrozen");if(e==="right"){var t=0,n=g2(this.$el,'[data-p-frozen-column="true"]');n&&(t=da(n)+parseFloat(n.style["inset-inline-end"]||0)),this.styleObject.insetInlineEnd=t+"px"}else{var i=0,s=m2(this.$el,'[data-p-frozen-column="true"]');s&&(i=da(s)+parseFloat(s.style["inset-inline-start"]||0)),this.styleObject.insetInlineStart=i+"px"}}}},computed:{getFilterColumnHeaderClass:function(){return[this.cx("headerCell",{column:this.column}),this.columnProp("filterHeaderClass"),this.columnProp("class")]},getFilterColumnHeaderStyle:function(){return this.columnProp("frozen")?[this.columnProp("filterHeaderStyle"),this.columnProp("style"),this.styleObject]:[this.columnProp("filterHeaderStyle"),this.columnProp("style")]}},components:{DTHeaderCheckbox:_L,DTColumnFilter:bL}};function Ov(r){"@babel/helpers - typeof";return Ov=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ov(r)}function b$(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function _$(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?b$(Object(t),!0).forEach(function(n){KKe(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):b$(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function KKe(r,e,t){return(e=XKe(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function XKe(r){var e=JKe(r,"string");return Ov(e)=="symbol"?e:e+""}function JKe(r,e){if(Ov(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(Ov(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var qKe=["data-p-frozen-column"];function YKe(r,e,t,n,i,s){var a=I.resolveComponent("DTHeaderCheckbox"),o=I.resolveComponent("DTColumnFilter");return!s.columnProp("hidden")&&(t.rowGroupMode!=="subheader"||t.groupRowsBy!==s.columnProp("field"))?(I.openBlock(),I.createElementBlock("th",I.mergeProps({key:0,style:s.getFilterColumnHeaderStyle,class:s.getFilterColumnHeaderClass},_$(_$({},s.getColumnPT("root")),s.getColumnPT("headerCell")),{"data-p-frozen-column":s.columnProp("frozen")}),[s.columnProp("selectionMode")==="multiple"?(I.openBlock(),I.createBlock(a,{key:0,checked:t.allRowsSelected,disabled:t.empty,onChange:e[0]||(e[0]=function(u){return r.$emit("checkbox-change",u)}),column:t.column,unstyled:r.unstyled,pt:r.pt},null,8,["checked","disabled","column","unstyled","pt"])):I.createCommentVNode("",!0),t.column.children&&t.column.children.filter?(I.openBlock(),I.createBlock(o,{key:1,field:s.columnProp("filterField")||s.columnProp("field"),type:s.columnProp("dataType"),display:"row",showMenu:s.columnProp("showFilterMenu"),filterElement:t.column.children&&t.column.children.filter,filterHeaderTemplate:t.column.children&&t.column.children.filterheader,filterFooterTemplate:t.column.children&&t.column.children.filterfooter,filterClearTemplate:t.column.children&&t.column.children.filterclear,filterApplyTemplate:t.column.children&&t.column.children.filterapply,filterIconTemplate:t.column.children&&t.column.children.filtericon,filterAddIconTemplate:t.column.children&&t.column.children.filteraddicon,filterRemoveIconTemplate:t.column.children&&t.column.children.filterremoveicon,filterClearIconTemplate:t.column.children&&t.column.children.filterclearicon,filters:t.filters,filtersStore:t.filtersStore,filterInputProps:t.filterInputProps,filterButtonProps:t.filterButtonProps,onFilterChange:e[1]||(e[1]=function(u){return r.$emit("filter-change",u)}),onFilterApply:e[2]||(e[2]=function(u){return r.$emit("filter-apply")}),filterMenuStyle:s.columnProp("filterMenuStyle"),filterMenuClass:s.columnProp("filterMenuClass"),showOperator:s.columnProp("showFilterOperator"),showClearButton:s.columnProp("showClearButton"),showApplyButton:s.columnProp("showApplyButton"),showMatchModes:s.columnProp("showFilterMatchModes"),showAddButton:s.columnProp("showAddButton"),matchModeOptions:s.columnProp("filterMatchModeOptions"),maxConstraints:s.columnProp("maxConstraints"),onOperatorChange:e[3]||(e[3]=function(u){return r.$emit("operator-change",u)}),onMatchmodeChange:e[4]||(e[4]=function(u){return r.$emit("matchmode-change",u)}),onConstraintAdd:e[5]||(e[5]=function(u){return r.$emit("constraint-add",u)}),onConstraintRemove:e[6]||(e[6]=function(u){return r.$emit("constraint-remove",u)}),onApplyClick:e[7]||(e[7]=function(u){return r.$emit("apply-click",u)}),column:t.column,unstyled:r.unstyled,pt:r.pt},null,8,["field","type","showMenu","filterElement","filterHeaderTemplate","filterFooterTemplate","filterClearTemplate","filterApplyTemplate","filterIconTemplate","filterAddIconTemplate","filterRemoveIconTemplate","filterClearIconTemplate","filters","filtersStore","filterInputProps","filterButtonProps","filterMenuStyle","filterMenuClass","showOperator","showClearButton","showApplyButton","showMatchModes","showAddButton","matchModeOptions","maxConstraints","column","unstyled","pt"])):I.createCommentVNode("",!0)],16,qKe)):I.createCommentVNode("",!0)}uQ.render=YKe;var hQ={name:"HeaderCell",hostName:"DataTable",extends:In,emits:["column-click","column-mousedown","column-dragstart","column-dragover","column-dragleave","column-drop","column-resizestart","checkbox-change","filter-change","filter-apply","operator-change","matchmode-change","constraint-add","constraint-remove","filter-clear","apply-click"],props:{column:{type:Object,default:null},index:{type:Number,default:null},resizableColumns:{type:Boolean,default:!1},groupRowsBy:{type:[Array,String,Function],default:null},sortMode:{type:String,default:"single"},groupRowSortField:{type:[String,Function],default:null},sortField:{type:[String,Function],default:null},sortOrder:{type:Number,default:null},multiSortMeta:{type:Array,default:null},allRowsSelected:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},filterDisplay:{type:String,default:null},filters:{type:Object,default:null},filtersStore:{type:Object,default:null},filterColumn:{type:Boolean,default:!1},reorderableColumns:{type:Boolean,default:!1},filterInputProps:{type:null,default:null},filterButtonProps:{type:null,default:null}},data:function(){return{styleObject:{}}},mounted:function(){this.columnProp("frozen")&&this.updateStickyPosition()},updated:function(){this.columnProp("frozen")&&this.updateStickyPosition()},methods:{columnProp:function(e){return Id(this.column,e)},getColumnPT:function(e){var t,n,i={props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:this.index,sortable:this.columnProp("sortable")===""||this.columnProp("sortable"),sorted:this.isColumnSorted(),resizable:this.resizableColumns,size:(t=this.$parentInstance)===null||t===void 0||(t=t.$parentInstance)===null||t===void 0?void 0:t.size,showGridlines:((n=this.$parentInstance)===null||n===void 0||(n=n.$parentInstance)===null||n===void 0?void 0:n.showGridlines)||!1}};return I.mergeProps(this.ptm("column.".concat(e),{column:i}),this.ptm("column.".concat(e),i),this.ptmo(this.getColumnProp(),e,i))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},onClick:function(e){this.$emit("column-click",{originalEvent:e,column:this.column})},onKeyDown:function(e){(e.code==="Enter"||e.code==="NumpadEnter"||e.code==="Space")&&e.currentTarget.nodeName==="TH"&&zs(e.currentTarget,"data-p-sortable-column")&&(this.$emit("column-click",{originalEvent:e,column:this.column}),e.preventDefault())},onMouseDown:function(e){this.$emit("column-mousedown",{originalEvent:e,column:this.column})},onDragStart:function(e){this.$emit("column-dragstart",{originalEvent:e,column:this.column})},onDragOver:function(e){this.$emit("column-dragover",{originalEvent:e,column:this.column})},onDragLeave:function(e){this.$emit("column-dragleave",{originalEvent:e,column:this.column})},onDrop:function(e){this.$emit("column-drop",{originalEvent:e,column:this.column})},onResizeStart:function(e){this.$emit("column-resizestart",e)},getMultiSortMetaIndex:function(){var e=this;return this.multiSortMeta.findIndex(function(t){return t.field===e.columnProp("field")||t.field===e.columnProp("sortField")})},getBadgeValue:function(){var e=this.getMultiSortMetaIndex();return this.groupRowsBy&&this.groupRowsBy===this.groupRowSortField&&e>-1?e:e+1},isMultiSorted:function(){return this.sortMode==="multiple"&&this.columnProp("sortable")&&this.getMultiSortMetaIndex()>-1},isColumnSorted:function(){return this.sortMode==="single"?this.sortField&&(this.sortField===this.columnProp("field")||this.sortField===this.columnProp("sortField")):this.isMultiSorted()},updateStickyPosition:function(){if(this.columnProp("frozen")){var e=this.columnProp("alignFrozen");if(e==="right"){var t=0,n=g2(this.$el,'[data-p-frozen-column="true"]');n&&(t=da(n)+parseFloat(n.style["inset-inline-end"]||0)),this.styleObject.insetInlineEnd=t+"px"}else{var i=0,s=m2(this.$el,'[data-p-frozen-column="true"]');s&&(i=da(s)+parseFloat(s.style["inset-inline-start"]||0)),this.styleObject.insetInlineStart=i+"px"}var a=this.$el.parentElement.nextElementSibling;if(a){var o=Hw(this.$el);a.children[o]&&(a.children[o].style["inset-inline-start"]=this.styleObject["inset-inline-start"],a.children[o].style["inset-inline-end"]=this.styleObject["inset-inline-end"])}}},onHeaderCheckboxChange:function(e){this.$emit("checkbox-change",e)}},computed:{containerClass:function(){return[this.cx("headerCell"),this.filterColumn?this.columnProp("filterHeaderClass"):this.columnProp("headerClass"),this.columnProp("class")]},containerStyle:function(){var e=this.filterColumn?this.columnProp("filterHeaderStyle"):this.columnProp("headerStyle"),t=this.columnProp("style");return this.columnProp("frozen")?[t,e,this.styleObject]:[t,e]},sortState:function(){var e=!1,t=null;if(this.sortMode==="single")e=this.sortField&&(this.sortField===this.columnProp("field")||this.sortField===this.columnProp("sortField")),t=e?this.sortOrder:0;else if(this.sortMode==="multiple"){var n=this.getMultiSortMetaIndex();n>-1&&(e=!0,t=this.multiSortMeta[n].order)}return{sorted:e,sortOrder:t}},sortableColumnIcon:function(){var e=this.sortState,t=e.sorted,n=e.sortOrder;if(t){if(t&&n>0)return cR;if(t&&n<0)return aR}else return sR;return null},ariaSort:function(){if(this.columnProp("sortable")){var e=this.sortState,t=e.sorted,n=e.sortOrder;return t&&n<0?"descending":t&&n>0?"ascending":"none"}else return null}},components:{Badge:mL,DTHeaderCheckbox:_L,DTColumnFilter:bL,SortAltIcon:sR,SortAmountUpAltIcon:cR,SortAmountDownIcon:aR}};function Dv(r){"@babel/helpers - typeof";return Dv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dv(r)}function v$(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function A$(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?v$(Object(t),!0).forEach(function(n){ZKe(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):v$(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function ZKe(r,e,t){return(e=QKe(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function QKe(r){var e=eXe(r,"string");return Dv(e)=="symbol"?e:e+""}function eXe(r,e){if(Dv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(Dv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var tXe=["tabindex","colspan","rowspan","aria-sort","data-p-sortable-column","data-p-resizable-column","data-p-sorted","data-p-filter-column","data-p-frozen-column","data-p-reorderable-column"];function rXe(r,e,t,n,i,s){var a=I.resolveComponent("Badge"),o=I.resolveComponent("DTHeaderCheckbox"),u=I.resolveComponent("DTColumnFilter");return I.openBlock(),I.createElementBlock("th",I.mergeProps({style:s.containerStyle,class:s.containerClass,tabindex:s.columnProp("sortable")?"0":null,role:"columnheader",colspan:s.columnProp("colspan"),rowspan:s.columnProp("rowspan"),"aria-sort":s.ariaSort,onClick:e[8]||(e[8]=function(){return s.onClick&&s.onClick.apply(s,arguments)}),onKeydown:e[9]||(e[9]=function(){return s.onKeyDown&&s.onKeyDown.apply(s,arguments)}),onMousedown:e[10]||(e[10]=function(){return s.onMouseDown&&s.onMouseDown.apply(s,arguments)}),onDragstart:e[11]||(e[11]=function(){return s.onDragStart&&s.onDragStart.apply(s,arguments)}),onDragover:e[12]||(e[12]=function(){return s.onDragOver&&s.onDragOver.apply(s,arguments)}),onDragleave:e[13]||(e[13]=function(){return s.onDragLeave&&s.onDragLeave.apply(s,arguments)}),onDrop:e[14]||(e[14]=function(){return s.onDrop&&s.onDrop.apply(s,arguments)})},A$(A$({},s.getColumnPT("root")),s.getColumnPT("headerCell")),{"data-p-sortable-column":s.columnProp("sortable"),"data-p-resizable-column":t.resizableColumns,"data-p-sorted":s.isColumnSorted(),"data-p-filter-column":t.filterColumn,"data-p-frozen-column":s.columnProp("frozen"),"data-p-reorderable-column":t.reorderableColumns}),[t.resizableColumns&&!s.columnProp("frozen")?(I.openBlock(),I.createElementBlock("span",I.mergeProps({key:0,class:r.cx("columnResizer"),onMousedown:e[0]||(e[0]=function(){return s.onResizeStart&&s.onResizeStart.apply(s,arguments)})},s.getColumnPT("columnResizer")),null,16)):I.createCommentVNode("",!0),I.createElementVNode("div",I.mergeProps({class:r.cx("columnHeaderContent")},s.getColumnPT("columnHeaderContent")),[t.column.children&&t.column.children.header?(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.column.children.header),{key:0,column:t.column},null,8,["column"])):I.createCommentVNode("",!0),s.columnProp("header")?(I.openBlock(),I.createElementBlock("span",I.mergeProps({key:1,class:r.cx("columnTitle")},s.getColumnPT("columnTitle")),I.toDisplayString(s.columnProp("header")),17)):I.createCommentVNode("",!0),s.columnProp("sortable")?(I.openBlock(),I.createElementBlock("span",I.normalizeProps(I.mergeProps({key:2},s.getColumnPT("sort"))),[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(t.column.children&&t.column.children.sorticon||s.sortableColumnIcon),I.mergeProps({sorted:s.sortState.sorted,sortOrder:s.sortState.sortOrder,class:r.cx("sortIcon")},s.getColumnPT("sorticon")),null,16,["sorted","sortOrder","class"]))],16)):I.createCommentVNode("",!0),s.isMultiSorted()?(I.openBlock(),I.createBlock(a,{key:3,class:I.normalizeClass(r.cx("pcSortBadge")),pt:s.getColumnPT("pcSortBadge"),value:s.getBadgeValue(),size:"small"},null,8,["class","pt","value"])):I.createCommentVNode("",!0),s.columnProp("selectionMode")==="multiple"&&t.filterDisplay!=="row"?(I.openBlock(),I.createBlock(o,{key:4,checked:t.allRowsSelected,onChange:s.onHeaderCheckboxChange,disabled:t.empty,headerCheckboxIconTemplate:t.column.children&&t.column.children.headercheckboxicon,column:t.column,unstyled:r.unstyled,pt:r.pt},null,8,["checked","onChange","disabled","headerCheckboxIconTemplate","column","unstyled","pt"])):I.createCommentVNode("",!0),t.filterDisplay==="menu"&&t.column.children&&t.column.children.filter?(I.openBlock(),I.createBlock(u,{key:5,field:s.columnProp("filterField")||s.columnProp("field"),type:s.columnProp("dataType"),display:"menu",showMenu:s.columnProp("showFilterMenu"),filterElement:t.column.children&&t.column.children.filter,filterHeaderTemplate:t.column.children&&t.column.children.filterheader,filterFooterTemplate:t.column.children&&t.column.children.filterfooter,filterClearTemplate:t.column.children&&t.column.children.filterclear,filterApplyTemplate:t.column.children&&t.column.children.filterapply,filterIconTemplate:t.column.children&&t.column.children.filtericon,filterAddIconTemplate:t.column.children&&t.column.children.filteraddicon,filterRemoveIconTemplate:t.column.children&&t.column.children.filterremoveicon,filterClearIconTemplate:t.column.children&&t.column.children.filterclearicon,filters:t.filters,filtersStore:t.filtersStore,filterInputProps:t.filterInputProps,filterButtonProps:t.filterButtonProps,onFilterChange:e[1]||(e[1]=function(f){return r.$emit("filter-change",f)}),onFilterApply:e[2]||(e[2]=function(f){return r.$emit("filter-apply")}),filterMenuStyle:s.columnProp("filterMenuStyle"),filterMenuClass:s.columnProp("filterMenuClass"),showOperator:s.columnProp("showFilterOperator"),showClearButton:s.columnProp("showClearButton"),showApplyButton:s.columnProp("showApplyButton"),showMatchModes:s.columnProp("showFilterMatchModes"),showAddButton:s.columnProp("showAddButton"),matchModeOptions:s.columnProp("filterMatchModeOptions"),maxConstraints:s.columnProp("maxConstraints"),onOperatorChange:e[3]||(e[3]=function(f){return r.$emit("operator-change",f)}),onMatchmodeChange:e[4]||(e[4]=function(f){return r.$emit("matchmode-change",f)}),onConstraintAdd:e[5]||(e[5]=function(f){return r.$emit("constraint-add",f)}),onConstraintRemove:e[6]||(e[6]=function(f){return r.$emit("constraint-remove",f)}),onApplyClick:e[7]||(e[7]=function(f){return r.$emit("apply-click",f)}),column:t.column,unstyled:r.unstyled,pt:r.pt},null,8,["field","type","showMenu","filterElement","filterHeaderTemplate","filterFooterTemplate","filterClearTemplate","filterApplyTemplate","filterIconTemplate","filterAddIconTemplate","filterRemoveIconTemplate","filterClearIconTemplate","filters","filtersStore","filterInputProps","filterButtonProps","filterMenuStyle","filterMenuClass","showOperator","showClearButton","showApplyButton","showMatchModes","showAddButton","matchModeOptions","maxConstraints","column","unstyled","pt"])):I.createCommentVNode("",!0)],16)],16,tXe)}hQ.render=rXe;var dQ={name:"TableHeader",hostName:"DataTable",extends:In,emits:["column-click","column-mousedown","column-dragstart","column-dragover","column-dragleave","column-drop","column-resizestart","checkbox-change","filter-change","filter-apply","operator-change","matchmode-change","constraint-add","constraint-remove","filter-clear","apply-click"],props:{columnGroup:{type:null,default:null},columns:{type:null,default:null},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String,Function],default:null},resizableColumns:{type:Boolean,default:!1},allRowsSelected:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},sortMode:{type:String,default:"single"},groupRowSortField:{type:[String,Function],default:null},sortField:{type:[String,Function],default:null},sortOrder:{type:Number,default:null},multiSortMeta:{type:Array,default:null},filterDisplay:{type:String,default:null},filters:{type:Object,default:null},filtersStore:{type:Object,default:null},reorderableColumns:{type:Boolean,default:!1},first:{type:Number,default:0},filterInputProps:{type:null,default:null},filterButtonProps:{type:null,default:null}},provide:function(){return{$rows:this.d_headerRows,$columns:this.d_headerColumns}},data:function(){return{d_headerRows:new by({type:"Row"}),d_headerColumns:new by({type:"Column"})}},beforeUnmount:function(){this.d_headerRows.clear(),this.d_headerColumns.clear()},methods:{columnProp:function(e,t){return Id(e,t)},getColumnGroupPT:function(e){var t,n={props:this.getColumnGroupProps(),parent:{instance:this,props:this.$props,state:this.$data},context:{type:"header",scrollable:(t=this.$parentInstance)===null||t===void 0||(t=t.$parentInstance)===null||t===void 0?void 0:t.scrollable}};return I.mergeProps(this.ptm("columnGroup.".concat(e),{columnGroup:n}),this.ptm("columnGroup.".concat(e),n),this.ptmo(this.getColumnGroupProps(),e,n))},getColumnGroupProps:function(){return this.columnGroup&&this.columnGroup.props&&this.columnGroup.props.pt?this.columnGroup.props.pt:void 0},getRowPT:function(e,t,n){var i={props:e.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:n}};return I.mergeProps(this.ptm("row.".concat(t),{row:i}),this.ptm("row.".concat(t),i),this.ptmo(this.getRowProp(e),t,i))},getRowProp:function(e){return e.props&&e.props.pt?e.props.pt:void 0},getColumnPT:function(e,t,n){var i={props:e.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:n}};return I.mergeProps(this.ptm("column.".concat(t),{column:i}),this.ptm("column.".concat(t),i),this.ptmo(this.getColumnProp(e),t,i))},getColumnProp:function(e){return e.props&&e.props.pt?e.props.pt:void 0},getFilterColumnHeaderClass:function(e){return[this.cx("headerCell",{column:e}),this.columnProp(e,"filterHeaderClass"),this.columnProp(e,"class")]},getFilterColumnHeaderStyle:function(e){return[this.columnProp(e,"filterHeaderStyle"),this.columnProp(e,"style")]},getHeaderRows:function(){var e;return(e=this.d_headerRows)===null||e===void 0?void 0:e.get(this.columnGroup,this.columnGroup.children)},getHeaderColumns:function(e){var t;return(t=this.d_headerColumns)===null||t===void 0?void 0:t.get(e,e.children)}},computed:{ptmTHeadOptions:function(){var e;return{context:{scrollable:(e=this.$parentInstance)===null||e===void 0||(e=e.$parentInstance)===null||e===void 0?void 0:e.scrollable}}}},components:{DTHeaderCell:hQ,DTFilterHeaderCell:uQ}};function Lv(r){"@babel/helpers - typeof";return Lv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lv(r)}function x$(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function tw(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?x$(Object(t),!0).forEach(function(n){nXe(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):x$(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function nXe(r,e,t){return(e=iXe(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function iXe(r){var e=sXe(r,"string");return Lv(e)=="symbol"?e:e+""}function sXe(r,e){if(Lv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(Lv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var oXe=["data-p-scrollable"];function aXe(r,e,t,n,i,s){var a,o=I.resolveComponent("DTHeaderCell"),u=I.resolveComponent("DTFilterHeaderCell");return I.openBlock(),I.createElementBlock("thead",I.mergeProps({class:r.cx("thead"),style:r.sx("thead"),role:"rowgroup"},t.columnGroup?tw(tw({},r.ptm("thead",s.ptmTHeadOptions)),s.getColumnGroupPT("root")):r.ptm("thead",s.ptmTHeadOptions),{"data-p-scrollable":(a=r.$parentInstance)===null||a===void 0||(a=a.$parentInstance)===null||a===void 0?void 0:a.scrollable,"data-pc-section":"thead"}),[t.columnGroup?(I.openBlock(!0),I.createElementBlock(I.Fragment,{key:1},I.renderList(s.getHeaderRows(),function(f,g){return I.openBlock(),I.createElementBlock("tr",I.mergeProps({key:g,role:"row"},{ref_for:!0},tw(tw({},r.ptm("headerRow")),s.getRowPT(f,"root",g))),[(I.openBlock(!0),I.createElementBlock(I.Fragment,null,I.renderList(s.getHeaderColumns(f),function(y,A){return I.openBlock(),I.createElementBlock(I.Fragment,{key:s.columnProp(y,"columnKey")||s.columnProp(y,"field")||A},[!s.columnProp(y,"hidden")&&(t.rowGroupMode!=="subheader"||t.groupRowsBy!==s.columnProp(y,"field"))&&typeof y.children!="string"?(I.openBlock(),I.createBlock(o,{key:0,column:y,onColumnClick:e[15]||(e[15]=function(C){return r.$emit("column-click",C)}),onColumnMousedown:e[16]||(e[16]=function(C){return r.$emit("column-mousedown",C)}),groupRowsBy:t.groupRowsBy,groupRowSortField:t.groupRowSortField,sortMode:t.sortMode,sortField:t.sortField,sortOrder:t.sortOrder,multiSortMeta:t.multiSortMeta,allRowsSelected:t.allRowsSelected,empty:t.empty,onCheckboxChange:e[17]||(e[17]=function(C){return r.$emit("checkbox-change",C)}),filters:t.filters,filterDisplay:t.filterDisplay,filtersStore:t.filtersStore,filterInputProps:t.filterInputProps,filterButtonProps:t.filterButtonProps,onFilterChange:e[18]||(e[18]=function(C){return r.$emit("filter-change",C)}),onFilterApply:e[19]||(e[19]=function(C){return r.$emit("filter-apply")}),onOperatorChange:e[20]||(e[20]=function(C){return r.$emit("operator-change",C)}),onMatchmodeChange:e[21]||(e[21]=function(C){return r.$emit("matchmode-change",C)}),onConstraintAdd:e[22]||(e[22]=function(C){return r.$emit("constraint-add",C)}),onConstraintRemove:e[23]||(e[23]=function(C){return r.$emit("constraint-remove",C)}),onApplyClick:e[24]||(e[24]=function(C){return r.$emit("apply-click",C)}),unstyled:r.unstyled,pt:r.pt},null,8,["column","groupRowsBy","groupRowSortField","sortMode","sortField","sortOrder","multiSortMeta","allRowsSelected","empty","filters","filterDisplay","filtersStore","filterInputProps","filterButtonProps","unstyled","pt"])):I.createCommentVNode("",!0)],64)}),128))],16)}),128)):(I.openBlock(),I.createElementBlock("tr",I.mergeProps({key:0,role:"row"},r.ptm("headerRow")),[(I.openBlock(!0),I.createElementBlock(I.Fragment,null,I.renderList(t.columns,function(f,g){return I.openBlock(),I.createElementBlock(I.Fragment,{key:s.columnProp(f,"columnKey")||s.columnProp(f,"field")||g},[!s.columnProp(f,"hidden")&&(t.rowGroupMode!=="subheader"||t.groupRowsBy!==s.columnProp(f,"field"))?(I.openBlock(),I.createBlock(o,{key:0,column:f,index:g,onColumnClick:e[0]||(e[0]=function(y){return r.$emit("column-click",y)}),onColumnMousedown:e[1]||(e[1]=function(y){return r.$emit("column-mousedown",y)}),onColumnDragstart:e[2]||(e[2]=function(y){return r.$emit("column-dragstart",y)}),onColumnDragover:e[3]||(e[3]=function(y){return r.$emit("column-dragover",y)}),onColumnDragleave:e[4]||(e[4]=function(y){return r.$emit("column-dragleave",y)}),onColumnDrop:e[5]||(e[5]=function(y){return r.$emit("column-drop",y)}),groupRowsBy:t.groupRowsBy,groupRowSortField:t.groupRowSortField,reorderableColumns:t.reorderableColumns,resizableColumns:t.resizableColumns,onColumnResizestart:e[6]||(e[6]=function(y){return r.$emit("column-resizestart",y)}),sortMode:t.sortMode,sortField:t.sortField,sortOrder:t.sortOrder,multiSortMeta:t.multiSortMeta,allRowsSelected:t.allRowsSelected,empty:t.empty,onCheckboxChange:e[7]||(e[7]=function(y){return r.$emit("checkbox-change",y)}),filters:t.filters,filterDisplay:t.filterDisplay,filtersStore:t.filtersStore,filterInputProps:t.filterInputProps,filterButtonProps:t.filterButtonProps,first:t.first,onFilterChange:e[8]||(e[8]=function(y){return r.$emit("filter-change",y)}),onFilterApply:e[9]||(e[9]=function(y){return r.$emit("filter-apply")}),onOperatorChange:e[10]||(e[10]=function(y){return r.$emit("operator-change",y)}),onMatchmodeChange:e[11]||(e[11]=function(y){return r.$emit("matchmode-change",y)}),onConstraintAdd:e[12]||(e[12]=function(y){return r.$emit("constraint-add",y)}),onConstraintRemove:e[13]||(e[13]=function(y){return r.$emit("constraint-remove",y)}),onApplyClick:e[14]||(e[14]=function(y){return r.$emit("apply-click",y)}),unstyled:r.unstyled,pt:r.pt},null,8,["column","index","groupRowsBy","groupRowSortField","reorderableColumns","resizableColumns","sortMode","sortField","sortOrder","multiSortMeta","allRowsSelected","empty","filters","filterDisplay","filtersStore","filterInputProps","filterButtonProps","first","unstyled","pt"])):I.createCommentVNode("",!0)],64)}),128))],16)),t.filterDisplay==="row"?(I.openBlock(),I.createElementBlock("tr",I.mergeProps({key:2,role:"row"},r.ptm("headerRow")),[(I.openBlock(!0),I.createElementBlock(I.Fragment,null,I.renderList(t.columns,function(f,g){return I.openBlock(),I.createElementBlock(I.Fragment,{key:s.columnProp(f,"columnKey")||s.columnProp(f,"field")||g},[!s.columnProp(f,"hidden")&&(t.rowGroupMode!=="subheader"||t.groupRowsBy!==s.columnProp(f,"field"))?(I.openBlock(),I.createBlock(u,{key:0,column:f,index:g,allRowsSelected:t.allRowsSelected,empty:t.empty,display:"row",filters:t.filters,filtersStore:t.filtersStore,filterInputProps:t.filterInputProps,filterButtonProps:t.filterButtonProps,onFilterChange:e[25]||(e[25]=function(y){return r.$emit("filter-change",y)}),onFilterApply:e[26]||(e[26]=function(y){return r.$emit("filter-apply")}),onOperatorChange:e[27]||(e[27]=function(y){return r.$emit("operator-change",y)}),onMatchmodeChange:e[28]||(e[28]=function(y){return r.$emit("matchmode-change",y)}),onConstraintAdd:e[29]||(e[29]=function(y){return r.$emit("constraint-add",y)}),onConstraintRemove:e[30]||(e[30]=function(y){return r.$emit("constraint-remove",y)}),onApplyClick:e[31]||(e[31]=function(y){return r.$emit("apply-click",y)}),onCheckboxChange:e[32]||(e[32]=function(y){return r.$emit("checkbox-change",y)}),unstyled:r.unstyled,pt:r.pt},null,8,["column","index","allRowsSelected","empty","filters","filtersStore","filterInputProps","filterButtonProps","unstyled","pt"])):I.createCommentVNode("",!0)],64)}),128))],16)):I.createCommentVNode("",!0)],16,oXe)}dQ.render=aXe;var lXe=["expanded"];function Vc(r){"@babel/helpers - typeof";return Vc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vc(r)}function cXe(r,e){if(r==null)return{};var t,n,i=uXe(r,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(n=0;n<s.length;n++)t=s[n],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(r,t)&&(i[t]=r[t])}return i}function uXe(r,e){if(r==null)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.indexOf(n)!==-1)continue;t[n]=r[n]}return t}function w$(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function ka(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?w$(Object(t),!0).forEach(function(n){Ww(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):w$(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function Ww(r,e,t){return(e=hXe(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function hXe(r){var e=dXe(r,"string");return Vc(e)=="symbol"?e:e+""}function dXe(r,e){if(Vc(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(Vc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function C$(r,e){return gXe(r)||pXe(r,e)||vL(r,e)||fXe()}function fXe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pXe(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n,i,s,a,o=[],u=!0,f=!1;try{if(s=(t=t.call(r)).next,e!==0)for(;!(u=(n=s.call(t)).done)&&(o.push(n.value),o.length!==e);u=!0);}catch(g){f=!0,i=g}finally{try{if(!u&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(f)throw i}}return o}}function gXe(r){if(Array.isArray(r))return r}function m0(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=vL(r))||e){t&&(r=t);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(f){throw f},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,a=!0,o=!1;return{s:function(){t=t.call(r)},n:function(){var f=t.next();return a=f.done,f},e:function(f){o=!0,s=f},f:function(){try{a||t.return==null||t.return()}finally{if(o)throw s}}}}function Ii(r){return bXe(r)||yXe(r)||vL(r)||mXe()}function mXe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vL(r,e){if(r){if(typeof r=="string")return hR(r,e);var t={}.toString.call(r).slice(8,-1);return t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set"?Array.from(r):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?hR(r,e):void 0}}function yXe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function bXe(r){if(Array.isArray(r))return hR(r)}function hR(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=Array(e);t<e;t++)n[t]=r[t];return n}var fQ={name:"DataTable",extends:QWe,inheritAttrs:!1,emits:["value-change","update:first","update:rows","page","update:sortField","update:sortOrder","update:multiSortMeta","sort","filter","row-click","row-dblclick","update:selection","row-select","row-unselect","update:contextMenuSelection","row-contextmenu","row-unselect-all","row-select-all","select-all-change","column-resize-end","column-reorder","row-reorder","update:expandedRows","row-collapse","row-expand","update:expandedRowGroups","rowgroup-collapse","rowgroup-expand","update:filters","state-restore","state-save","cell-edit-init","cell-edit-complete","cell-edit-cancel","update:editingRows","row-edit-init","row-edit-save","row-edit-cancel"],provide:function(){return{$columns:this.d_columns,$columnGroups:this.d_columnGroups}},data:function(){return{d_first:this.first,d_rows:this.rows,d_sortField:this.sortField,d_sortOrder:this.sortOrder,d_nullSortOrder:this.nullSortOrder,d_multiSortMeta:this.multiSortMeta?Ii(this.multiSortMeta):[],d_groupRowsSortMeta:null,d_selectionKeys:null,d_columnOrder:null,d_editingRowKeys:null,d_editingMeta:{},d_filters:this.cloneFilters(this.filters),d_columns:new by({type:"Column"}),d_columnGroups:new by({type:"ColumnGroup"})}},rowTouched:!1,anchorRowIndex:null,rangeRowIndex:null,documentColumnResizeListener:null,documentColumnResizeEndListener:null,lastResizeHelperX:null,resizeColumnElement:null,columnResizing:!1,colReorderIconWidth:null,colReorderIconHeight:null,draggedColumn:null,draggedColumnElement:null,draggedRowIndex:null,droppedRowIndex:null,rowDragging:null,columnWidthsState:null,tableWidthState:null,columnWidthsRestored:!1,watch:{first:function(e){this.d_first=e},rows:function(e){this.d_rows=e},sortField:function(e){this.d_sortField=e},sortOrder:function(e){this.d_sortOrder=e},nullSortOrder:function(e){this.d_nullSortOrder=e},multiSortMeta:function(e){this.d_multiSortMeta=e},selection:{immediate:!0,handler:function(e){this.dataKey&&this.updateSelectionKeys(e)}},editingRows:{immediate:!0,handler:function(e){this.dataKey&&this.updateEditingRowKeys(e)}},filters:{deep:!0,handler:function(e){this.d_filters=this.cloneFilters(e)}}},mounted:function(){this.isStateful()&&(this.restoreState(),this.resizableColumns&&this.restoreColumnWidths()),this.editMode==="row"&&this.dataKey&&!this.d_editingRowKeys&&this.updateEditingRowKeys(this.editingRows)},beforeUnmount:function(){this.unbindColumnResizeEvents(),this.destroyStyleElement(),this.d_columns.clear(),this.d_columnGroups.clear()},updated:function(){this.isStateful()&&this.saveState(),this.editMode==="row"&&this.dataKey&&!this.d_editingRowKeys&&this.updateEditingRowKeys(this.editingRows)},methods:{columnProp:function(e,t){return Id(e,t)},onPage:function(e){var t=this;this.clearEditingMetaData(),this.d_first=e.first,this.d_rows=e.rows;var n=this.createLazyLoadEvent(e);n.pageCount=e.pageCount,n.page=e.page,this.$emit("update:first",this.d_first),this.$emit("update:rows",this.d_rows),this.$emit("page",n),this.$nextTick(function(){t.$emit("value-change",t.processedData)})},onColumnHeaderClick:function(e){var t=this,n=e.originalEvent,i=e.column;if(this.columnProp(i,"sortable")){var s=n.target,a=this.columnProp(i,"sortField")||this.columnProp(i,"field");if(zs(s,"data-p-sortable-column")===!0||zs(s,"data-pc-section")==="columntitle"||zs(s,"data-pc-section")==="columnheadercontent"||zs(s,"data-pc-section")==="sorticon"||zs(s.parentElement,"data-pc-section")==="sorticon"||zs(s.parentElement.parentElement,"data-pc-section")==="sorticon"||s.closest('[data-p-sortable-column="true"]')&&!s.closest('[data-pc-section="columnfilterbutton"]')&&!a3(n.target)){if(Gw(),this.sortMode==="single")this.d_sortField===a?this.removableSort&&this.d_sortOrder*-1===this.defaultSortOrder?(this.d_sortOrder=null,this.d_sortField=null):this.d_sortOrder=this.d_sortOrder*-1:(this.d_sortOrder=this.defaultSortOrder,this.d_sortField=a),this.$emit("update:sortField",this.d_sortField),this.$emit("update:sortOrder",this.d_sortOrder),this.resetPage();else if(this.sortMode==="multiple"){var o=n.metaKey||n.ctrlKey;o||(this.d_multiSortMeta=this.d_multiSortMeta.filter(function(u){return u.field===a})),this.addMultiSortField(a),this.$emit("update:multiSortMeta",this.d_multiSortMeta)}this.$emit("sort",this.createLazyLoadEvent(n)),this.$nextTick(function(){t.$emit("value-change",t.processedData)})}}},sortSingle:function(e){var t=this;if(this.clearEditingMetaData(),this.groupRowsBy&&this.groupRowsBy===this.sortField)return this.d_multiSortMeta=[{field:this.sortField,order:this.sortOrder||this.defaultSortOrder},{field:this.d_sortField,order:this.d_sortOrder}],this.sortMultiple(e);var n=Ii(e),i=new Map,s=m0(n),a;try{for(s.s();!(a=s.n()).done;){var o=a.value;i.set(o,hn(o,this.d_sortField))}}catch(f){s.e(f)}finally{s.f()}var u=wV();return n.sort(function(f,g){var y=i.get(f),A=i.get(g);return TV(y,A,t.d_sortOrder,u,t.d_nullSortOrder)}),n},sortMultiple:function(e){var t=this;if(this.clearEditingMetaData(),this.groupRowsBy&&(this.d_groupRowsSortMeta||this.d_multiSortMeta.length&&this.groupRowsBy===this.d_multiSortMeta[0].field)){var n=this.d_multiSortMeta[0];!this.d_groupRowsSortMeta&&(this.d_groupRowsSortMeta=n),n.field!==this.d_groupRowsSortMeta.field&&(this.d_multiSortMeta=[this.d_groupRowsSortMeta].concat(Ii(this.d_multiSortMeta)))}var i=Ii(e);return i.sort(function(s,a){return t.multisortField(s,a,0)}),i},multisortField:function(e,t,n){var i=hn(e,this.d_multiSortMeta[n].field),s=hn(t,this.d_multiSortMeta[n].field),a=wV();return i===s?this.d_multiSortMeta.length-1>n?this.multisortField(e,t,n+1):0:TV(i,s,this.d_multiSortMeta[n].order,a,this.d_nullSortOrder)},addMultiSortField:function(e){var t=this.d_multiSortMeta.findIndex(function(n){return n.field===e});t>=0?this.removableSort&&this.d_multiSortMeta[t].order*-1===this.defaultSortOrder?this.d_multiSortMeta.splice(t,1):this.d_multiSortMeta[t]={field:e,order:this.d_multiSortMeta[t].order*-1}:this.d_multiSortMeta.push({field:e,order:this.defaultSortOrder}),this.d_multiSortMeta=Ii(this.d_multiSortMeta)},getActiveFilters:function(e){var t=function(a){var o=C$(a,2),u=o[0],f=o[1];if(f.constraints){var g=f.constraints.filter(function(y){return y.value!==null});if(g.length>0)return[u,ka(ka({},f),{},{constraints:g})]}else if(f.value!==null)return[u,f]},n=function(a){return a!==void 0},i=Object.entries(e).map(t).filter(n);return Object.fromEntries(i)},filter:function(e){var t=this;if(e){this.clearEditingMetaData();var n=this.getActiveFilters(this.filters),i;n.global&&(i=this.globalFilterFields||this.columns.map(function($){return t.columnProp($,"filterField")||t.columnProp($,"field")}));for(var s=[],a=0;a<e.length;a++){var o=!0,u=!1,f=!1;for(var g in n)if(Object.prototype.hasOwnProperty.call(n,g)&&g!=="global"){f=!0;var y=g,A=n[y];if(A.operator){var C=m0(A.constraints),M;try{for(C.s();!(M=C.n()).done;){var k=M.value;if(o=this.executeLocalFilter(y,e[a],k),A.operator===wT.OR&&o||A.operator===wT.AND&&!o)break}}catch($){C.e($)}finally{C.f()}}else o=this.executeLocalFilter(y,e[a],A);if(!o)break}if(o&&n.global&&!u&&i)for(var D=0;D<i.length;D++){var V=i[D];if(u=TM.filters[n.global.matchMode||Fs.CONTAINS](hn(e[a],V),n.global.value,this.filterLocale),u)break}var W=void 0;n.global?W=f?f&&o&&u:u:W=f&&o,W&&s.push(e[a])}(s.length===this.value.length||Object.keys(n).length==0)&&(s=e);var z=this.createLazyLoadEvent();return z.filteredValue=s,this.$emit("filter",z),this.$emit("value-change",s),s}},executeLocalFilter:function(e,t,n){var i=n.value,s=n.matchMode||Fs.STARTS_WITH,a=hn(t,e),o=TM.filters[s];return o(a,i,this.filterLocale)},onRowClick:function(e){var t=e.originalEvent,n=this.$refs.bodyRef&&this.$refs.bodyRef.$el,i=cd(n,'tr[data-p-selectable-row="true"][tabindex="0"]');if(!a3(t.target)){if(this.$emit("row-click",e),this.selectionMode){var s=e.data,a=this.d_first+e.index;if(this.isMultipleSelectionMode()&&t.shiftKey&&this.anchorRowIndex!=null)Gw(),this.rangeRowIndex=a,this.selectRange(t);else{var o=this.isSelected(s),u=this.rowTouched?!1:this.metaKeySelection;if(this.anchorRowIndex=a,this.rangeRowIndex=a,u){var f=t.metaKey||t.ctrlKey;if(o&&f){if(this.isSingleSelectionMode())this.$emit("update:selection",null);else{var g=this.findIndexInSelection(s),y=this.selection.filter(function(z,$){return $!=g});this.$emit("update:selection",y)}this.$emit("row-unselect",{originalEvent:t,data:s,index:a,type:"row"})}else{if(this.isSingleSelectionMode())this.$emit("update:selection",s);else if(this.isMultipleSelectionMode()){var A=f?this.selection||[]:[];A=[].concat(Ii(A),[s]),this.$emit("update:selection",A)}this.$emit("row-select",{originalEvent:t,data:s,index:a,type:"row"})}}else if(this.selectionMode==="single")o?(this.$emit("update:selection",null),this.$emit("row-unselect",{originalEvent:t,data:s,index:a,type:"row"})):(this.$emit("update:selection",s),this.$emit("row-select",{originalEvent:t,data:s,index:a,type:"row"}));else if(this.selectionMode==="multiple")if(o){var C=this.findIndexInSelection(s),M=this.selection.filter(function(z,$){return $!=C});this.$emit("update:selection",M),this.$emit("row-unselect",{originalEvent:t,data:s,index:a,type:"row"})}else{var k=this.selection?[].concat(Ii(this.selection),[s]):[s];this.$emit("update:selection",k),this.$emit("row-select",{originalEvent:t,data:s,index:a,type:"row"})}}}if(this.rowTouched=!1,i){var D,V;if(((D=t.target)===null||D===void 0?void 0:D.getAttribute("data-pc-section"))==="rowtoggleicon")return;var W=(V=t.currentTarget)===null||V===void 0?void 0:V.closest('tr[data-p-selectable-row="true"]');i.tabIndex="-1",W&&(W.tabIndex="0")}}},onRowDblClick:function(e){var t=e.originalEvent;a3(t.target)||this.$emit("row-dblclick",e)},onRowRightClick:function(e){this.contextMenu&&(Gw(),e.originalEvent.target.focus()),this.$emit("update:contextMenuSelection",e.data),this.$emit("row-contextmenu",e)},onRowTouchEnd:function(){this.rowTouched=!0},onRowKeyDown:function(e,t){var n=e.originalEvent,i=e.data,s=e.index,a=n.metaKey||n.ctrlKey;if(this.selectionMode){var o=n.target;switch(n.code){case"ArrowDown":this.onArrowDownKey(n,o,s,t);break;case"ArrowUp":this.onArrowUpKey(n,o,s,t);break;case"Home":this.onHomeKey(n,o,s,t);break;case"End":this.onEndKey(n,o,s,t);break;case"Enter":case"NumpadEnter":this.onEnterKey(n,i,s);break;case"Space":this.onSpaceKey(n,i,s,t);break;case"Tab":this.onTabKey(n,s);break;default:if(n.code==="KeyA"&&a&&this.isMultipleSelectionMode()){var u=this.dataToRender(t.rows);this.$emit("update:selection",u)}var f=n.code==="KeyC"&&a;f||n.preventDefault();break}}},onArrowDownKey:function(e,t,n,i){var s=this.findNextSelectableRow(t);if(s&&this.focusRowChange(t,s),e.shiftKey){var a=this.dataToRender(i.rows),o=n+1>=a.length?a.length-1:n+1;this.onRowClick({originalEvent:e,data:a[o],index:o})}e.preventDefault()},onArrowUpKey:function(e,t,n,i){var s=this.findPrevSelectableRow(t);if(s&&this.focusRowChange(t,s),e.shiftKey){var a=this.dataToRender(i.rows),o=n-1<=0?0:n-1;this.onRowClick({originalEvent:e,data:a[o],index:o})}e.preventDefault()},onHomeKey:function(e,t,n,i){var s=this.findFirstSelectableRow();if(s&&this.focusRowChange(t,s),e.ctrlKey&&e.shiftKey){var a=this.dataToRender(i.rows);this.$emit("update:selection",a.slice(0,n+1))}e.preventDefault()},onEndKey:function(e,t,n,i){var s=this.findLastSelectableRow();if(s&&this.focusRowChange(t,s),e.ctrlKey&&e.shiftKey){var a=this.dataToRender(i.rows);this.$emit("update:selection",a.slice(n,a.length))}e.preventDefault()},onEnterKey:function(e,t,n){this.onRowClick({originalEvent:e,data:t,index:n}),e.preventDefault()},onSpaceKey:function(e,t,n,i){if(this.onEnterKey(e,t,n),e.shiftKey&&this.selection!==null){var s=this.dataToRender(i.rows),a;if(this.selection.length>0){var o,u;o=l3(this.selection[0],s),u=l3(this.selection[this.selection.length-1],s),a=n<=o?u:o}else a=l3(this.selection,s);var f=a!==n?s.slice(Math.min(a,n),Math.max(a,n)+1):t;this.$emit("update:selection",f)}},onTabKey:function(e,t){var n=this.$refs.bodyRef&&this.$refs.bodyRef.$el,i=cm(n,'tr[data-p-selectable-row="true"]');if(e.code==="Tab"&&i&&i.length>0){var s=cd(n,'tr[data-p-selected="true"]'),a=cd(n,'tr[data-p-selectable-row="true"][tabindex="0"]');s?(s.tabIndex="0",a&&a!==s&&(a.tabIndex="-1")):(i[0].tabIndex="0",a!==i[0]&&i[t]&&(i[t].tabIndex="-1"))}},findNextSelectableRow:function(e){var t=e.nextElementSibling;return t?zs(t,"data-p-selectable-row")===!0?t:this.findNextSelectableRow(t):null},findPrevSelectableRow:function(e){var t=e.previousElementSibling;return t?zs(t,"data-p-selectable-row")===!0?t:this.findPrevSelectableRow(t):null},findFirstSelectableRow:function(){var e=cd(this.$refs.table,'tr[data-p-selectable-row="true"]');return e},findLastSelectableRow:function(){var e=cm(this.$refs.table,'tr[data-p-selectable-row="true"]');return e?e[e.length-1]:null},focusRowChange:function(e,t){e.tabIndex="-1",t.tabIndex="0",oa(t)},toggleRowWithRadio:function(e){var t=e.data;this.isSelected(t)?(this.$emit("update:selection",null),this.$emit("row-unselect",{originalEvent:e.originalEvent,data:t,index:e.index,type:"radiobutton"})):(this.$emit("update:selection",t),this.$emit("row-select",{originalEvent:e.originalEvent,data:t,index:e.index,type:"radiobutton"}))},toggleRowWithCheckbox:function(e){var t=e.data;if(this.isSelected(t)){var n=this.findIndexInSelection(t),i=this.selection.filter(function(a,o){return o!=n});this.$emit("update:selection",i),this.$emit("row-unselect",{originalEvent:e.originalEvent,data:t,index:e.index,type:"checkbox"})}else{var s=this.selection?Ii(this.selection):[];s=[].concat(Ii(s),[t]),this.$emit("update:selection",s),this.$emit("row-select",{originalEvent:e.originalEvent,data:t,index:e.index,type:"checkbox"})}},toggleRowsWithCheckbox:function(e){if(this.selectAll!==null)this.$emit("select-all-change",e);else{var t=e.originalEvent,n=e.checked,i=[];n?(i=this.frozenValue?[].concat(Ii(this.frozenValue),Ii(this.processedData)):this.processedData,this.$emit("row-select-all",{originalEvent:t,data:i})):this.$emit("row-unselect-all",{originalEvent:t}),this.$emit("update:selection",i)}},isSingleSelectionMode:function(){return this.selectionMode==="single"},isMultipleSelectionMode:function(){return this.selectionMode==="multiple"},isSelected:function(e){return e&&this.selection?this.dataKey?this.d_selectionKeys?this.d_selectionKeys[hn(e,this.dataKey)]!==void 0:!1:this.selection instanceof Array?this.findIndexInSelection(e)>-1:this.equals(e,this.selection):!1},findIndexInSelection:function(e){return this.findIndex(e,this.selection)},findIndex:function(e,t){var n=-1;if(t&&t.length){for(var i=0;i<t.length;i++)if(this.equals(e,t[i])){n=i;break}}return n},updateSelectionKeys:function(e){if(this.d_selectionKeys={},Array.isArray(e)){var t=m0(e),n;try{for(t.s();!(n=t.n()).done;){var i=n.value;this.d_selectionKeys[String(hn(i,this.dataKey))]=1}}catch(s){t.e(s)}finally{t.f()}}else this.d_selectionKeys[String(hn(e,this.dataKey))]=1},updateEditingRowKeys:function(e){if(e&&e.length){this.d_editingRowKeys={};var t=m0(e),n;try{for(t.s();!(n=t.n()).done;){var i=n.value;this.d_editingRowKeys[String(hn(i,this.dataKey))]=1}}catch(s){t.e(s)}finally{t.f()}}else this.d_editingRowKeys=null},equals:function(e,t){return this.compareSelectionBy==="equals"?e===t:Ip(e,t,this.dataKey)},selectRange:function(e){var t,n;this.rangeRowIndex>this.anchorRowIndex?(t=this.anchorRowIndex,n=this.rangeRowIndex):this.rangeRowIndex<this.anchorRowIndex?(t=this.rangeRowIndex,n=this.anchorRowIndex):(t=this.rangeRowIndex,n=this.rangeRowIndex),this.lazy&&this.paginator&&(t-=this.d_first,n-=this.d_first);for(var i=this.processedData,s=[],a=t;a<=n;a++){var o=i[a];s.push(o),this.$emit("row-select",{originalEvent:e,data:o,type:"row"})}this.$emit("update:selection",s)},generateCSV:function(e,t){var n=this,i="\uFEFF";t||(t=this.processedData,e&&e.selectionOnly?t=this.selection||[]:this.frozenValue&&(t=t?[].concat(Ii(this.frozenValue),Ii(t)):this.frozenValue));for(var s=!1,a=0;a<this.columns.length;a++){var o=this.columns[a];this.columnProp(o,"exportable")!==!1&&this.columnProp(o,"field")&&(s?i+=this.csvSeparator:s=!0,i+='"'+(this.columnProp(o,"exportHeader")||this.columnProp(o,"header")||this.columnProp(o,"field"))+'"')}t&&t.forEach(function(y){i+=`
`;for(var A=!1,C=0;C<n.columns.length;C++){var M=n.columns[C];if(n.columnProp(M,"exportable")!==!1&&n.columnProp(M,"field")){A?i+=n.csvSeparator:A=!0;var k=hn(y,n.columnProp(M,"field"));k!=null?n.exportFunction?k=n.exportFunction({data:k,field:n.columnProp(M,"field")}):k=String(k).replace(/"/g,'""'):k="",i+='"'+k+'"'}}});for(var u=!1,f=0;f<this.columns.length;f++){var g=this.columns[f];f===0&&(i+=`
`),this.columnProp(g,"exportable")!==!1&&this.columnProp(g,"exportFooter")&&(u?i+=this.csvSeparator:u=!0,i+='"'+(this.columnProp(g,"exportFooter")||this.columnProp(g,"footer")||this.columnProp(g,"field"))+'"')}return i},exportCSV:function(e,t){var n=this.generateCSV(e,t);Uze(n,this.exportFilename)},resetPage:function(){this.d_first=0,this.$emit("update:first",this.d_first)},onColumnResizeStart:function(e){var t=um(this.$el).left;this.resizeColumnElement=e.target.parentElement,this.columnResizing=!0,this.lastResizeHelperX=e.pageX-t+this.$el.scrollLeft,this.bindColumnResizeEvents()},onColumnResize:function(e){var t=um(this.$el).left;this.$el.setAttribute("data-p-unselectable-text","true"),!this.isUnstyled&&_T(this.$el,{"user-select":"none"}),this.$refs.resizeHelper.style.height=this.$el.offsetHeight+"px",this.$refs.resizeHelper.style.top="0px",this.$refs.resizeHelper.style.left=e.pageX-t+this.$el.scrollLeft+"px",this.$refs.resizeHelper.style.display="block"},onColumnResizeEnd:function(){var e=rZ(this.$el)?this.lastResizeHelperX-this.$refs.resizeHelper.offsetLeft:this.$refs.resizeHelper.offsetLeft-this.lastResizeHelperX,t=this.resizeColumnElement.offsetWidth,n=t+e,i=this.resizeColumnElement.style.minWidth||15;if(t+e>parseInt(i,10)){if(this.columnResizeMode==="fit"){var s=this.resizeColumnElement.nextElementSibling,a=s.offsetWidth-e;n>15&&a>15&&this.resizeTableCells(n,a)}else if(this.columnResizeMode==="expand"){var o=this.$refs.table.offsetWidth+e+"px",u=function(A){A&&(A.style.width=A.style.minWidth=o)};if(this.resizeTableCells(n),u(this.$refs.table),!this.virtualScrollerDisabled){var f=this.$refs.bodyRef&&this.$refs.bodyRef.$el,g=this.$refs.frozenBodyRef&&this.$refs.frozenBodyRef.$el;u(f),u(g)}}this.$emit("column-resize-end",{element:this.resizeColumnElement,delta:e})}this.$refs.resizeHelper.style.display="none",this.resizeColumn=null,this.$el.removeAttribute("data-p-unselectable-text"),!this.isUnstyled&&(this.$el.style["user-select"]=""),this.unbindColumnResizeEvents(),this.isStateful()&&this.saveState()},resizeTableCells:function(e,t){var n=Hw(this.resizeColumnElement),i=[],s=cm(this.$refs.table,'thead[data-pc-section="thead"] > tr > th');s.forEach(function(u){return i.push(da(u))}),this.destroyStyleElement(),this.createStyleElement();var a="",o='[data-pc-name="datatable"]['.concat(this.$attrSelector,'] > [data-pc-section="tablecontainer"] ').concat(this.virtualScrollerDisabled?"":'> [data-pc-name="virtualscroller"]',' > table[data-pc-section="table"]');i.forEach(function(u,f){var g=f===n?e:t&&f===n+1?t:u,y="width: ".concat(g,"px !important; max-width: ").concat(g,"px !important");a+=`
                    `.concat(o,' > thead[data-pc-section="thead"] > tr > th:nth-child(').concat(f+1,`),
                    `).concat(o,' > tbody[data-pc-section="tbody"] > tr > td:nth-child(').concat(f+1,`),
                    `).concat(o,' > tfoot[data-pc-section="tfoot"] > tr > td:nth-child(').concat(f+1,`) {
                        `).concat(y,`
                    }
                `)}),this.styleElement.innerHTML=a},bindColumnResizeEvents:function(){var e=this;this.documentColumnResizeListener||(this.documentColumnResizeListener=function(t){e.columnResizing&&e.onColumnResize(t)},document.addEventListener("mousemove",this.documentColumnResizeListener)),this.documentColumnResizeEndListener||(this.documentColumnResizeEndListener=function(){e.columnResizing&&(e.columnResizing=!1,e.onColumnResizeEnd())},document.addEventListener("mouseup",this.documentColumnResizeEndListener))},unbindColumnResizeEvents:function(){this.documentColumnResizeListener&&(document.removeEventListener("document",this.documentColumnResizeListener),this.documentColumnResizeListener=null),this.documentColumnResizeEndListener&&(document.removeEventListener("document",this.documentColumnResizeEndListener),this.documentColumnResizeEndListener=null)},onColumnHeaderMouseDown:function(e){var t=e.originalEvent,n=e.column;this.reorderableColumns&&this.columnProp(n,"reorderableColumn")!==!1&&(t.target.nodeName==="INPUT"||t.target.nodeName==="TEXTAREA"||zs(t.target,'[data-pc-section="columnresizer"]')?t.currentTarget.draggable=!1:t.currentTarget.draggable=!0)},onColumnHeaderDragStart:function(e){var t=e.originalEvent,n=e.column;if(this.columnResizing){t.preventDefault();return}this.colReorderIconWidth=Hze(this.$refs.reorderIndicatorUp),this.colReorderIconHeight=Gze(this.$refs.reorderIndicatorUp),this.draggedColumn=n,this.draggedColumnElement=this.findParentHeader(t.target),t.dataTransfer.setData("text","b")},onColumnHeaderDragOver:function(e){var t=e.originalEvent,n=e.column,i=this.findParentHeader(t.target);if(this.reorderableColumns&&this.draggedColumnElement&&i&&!this.columnProp(n,"frozen")){t.preventDefault();var s=um(this.$el),a=um(i);if(this.draggedColumnElement!==i){var o=a.left-s.left,u=a.left+i.offsetWidth/2;this.$refs.reorderIndicatorUp.style.top=a.top-s.top-(this.colReorderIconHeight-1)+"px",this.$refs.reorderIndicatorDown.style.top=a.top-s.top+i.offsetHeight+"px",t.pageX>u?(this.$refs.reorderIndicatorUp.style.left=o+i.offsetWidth-Math.ceil(this.colReorderIconWidth/2)+"px",this.$refs.reorderIndicatorDown.style.left=o+i.offsetWidth-Math.ceil(this.colReorderIconWidth/2)+"px",this.dropPosition=1):(this.$refs.reorderIndicatorUp.style.left=o-Math.ceil(this.colReorderIconWidth/2)+"px",this.$refs.reorderIndicatorDown.style.left=o-Math.ceil(this.colReorderIconWidth/2)+"px",this.dropPosition=-1),this.$refs.reorderIndicatorUp.style.display="block",this.$refs.reorderIndicatorDown.style.display="block"}}},onColumnHeaderDragLeave:function(e){var t=e.originalEvent;this.reorderableColumns&&this.draggedColumnElement&&(t.preventDefault(),this.$refs.reorderIndicatorUp.style.display="none",this.$refs.reorderIndicatorDown.style.display="none")},onColumnHeaderDrop:function(e){var t=this,n=e.originalEvent,i=e.column;if(n.preventDefault(),this.draggedColumnElement){var s=Hw(this.draggedColumnElement),a=Hw(this.findParentHeader(n.target)),o=s!==a;if(o&&(a-s===1&&this.dropPosition===-1||a-s===-1&&this.dropPosition===1)&&(o=!1),o){var u=function(V,W){return t.columnProp(V,"columnKey")||t.columnProp(W,"columnKey")?t.columnProp(V,"columnKey")===t.columnProp(W,"columnKey"):t.columnProp(V,"field")===t.columnProp(W,"field")},f=this.columns.findIndex(function(D){return u(D,t.draggedColumn)}),g=this.columns.findIndex(function(D){return u(D,i)}),y=[],A=cm(this.$el,'thead[data-pc-section="thead"] > tr > th');A.forEach(function(D){return y.push(da(D))});var C=y.find(function(D,V){return V===f}),M=y.filter(function(D,V){return V!==f}),k=[].concat(Ii(M.slice(0,g)),[C],Ii(M.slice(g)));this.addColumnWidthStyles(k),g<f&&this.dropPosition===1&&g++,g>f&&this.dropPosition===-1&&g--,CV(this.columns,f,g),this.updateReorderableColumns(),this.$emit("column-reorder",{originalEvent:n,dragIndex:f,dropIndex:g})}this.$refs.reorderIndicatorUp.style.display="none",this.$refs.reorderIndicatorDown.style.display="none",this.draggedColumnElement.draggable=!1,this.draggedColumnElement=null,this.draggedColumn=null,this.dropPosition=null}},findParentHeader:function(e){if(e.nodeName==="TH")return e;for(var t=e.parentElement;t.nodeName!=="TH"&&(t=t.parentElement,!!t););return t},findColumnByKey:function(e,t){if(e&&e.length)for(var n=0;n<e.length;n++){var i=e[n];if(this.columnProp(i,"columnKey")===t||this.columnProp(i,"field")===t)return i}return null},onRowMouseDown:function(e){zs(e.target,"data-pc-section")==="reorderablerowhandle"||zs(e.target.parentElement,"data-pc-section")==="reorderablerowhandle"?e.currentTarget.draggable=!0:e.currentTarget.draggable=!1},onRowDragStart:function(e){var t=e.originalEvent,n=e.index;this.rowDragging=!0,this.draggedRowIndex=n,t.dataTransfer.setData("text","b")},onRowDragOver:function(e){var t=e.originalEvent,n=e.index;if(this.rowDragging&&this.draggedRowIndex!==n){var i=t.currentTarget,s=um(i).top,a=t.pageY,o=s+AT(i)/2,u=i.previousElementSibling;a<o?(i.setAttribute("data-p-datatable-dragpoint-bottom","false"),!this.isUnstyled&&rd(i,"p-datatable-dragpoint-bottom"),this.droppedRowIndex=n,u?(u.setAttribute("data-p-datatable-dragpoint-bottom","true"),!this.isUnstyled&&L0(u,"p-datatable-dragpoint-bottom")):(i.setAttribute("data-p-datatable-dragpoint-top","true"),!this.isUnstyled&&L0(i,"p-datatable-dragpoint-top"))):(u?(u.setAttribute("data-p-datatable-dragpoint-bottom","false"),!this.isUnstyled&&rd(u,"p-datatable-dragpoint-bottom")):(i.setAttribute("data-p-datatable-dragpoint-top","true"),!this.isUnstyled&&L0(i,"p-datatable-dragpoint-top")),this.droppedRowIndex=n+1,i.setAttribute("data-p-datatable-dragpoint-bottom","true"),!this.isUnstyled&&L0(i,"p-datatable-dragpoint-bottom")),t.preventDefault()}},onRowDragLeave:function(e){var t=e.currentTarget,n=t.previousElementSibling;n&&(n.setAttribute("data-p-datatable-dragpoint-bottom","false"),!this.isUnstyled&&rd(n,"p-datatable-dragpoint-bottom")),t.setAttribute("data-p-datatable-dragpoint-bottom","false"),!this.isUnstyled&&rd(t,"p-datatable-dragpoint-bottom"),t.setAttribute("data-p-datatable-dragpoint-top","false"),!this.isUnstyled&&rd(t,"p-datatable-dragpoint-top")},onRowDragEnd:function(e){this.rowDragging=!1,this.draggedRowIndex=null,this.droppedRowIndex=null,e.currentTarget.draggable=!1},onRowDrop:function(e){if(this.droppedRowIndex!=null){var t=this.draggedRowIndex>this.droppedRowIndex?this.droppedRowIndex:this.droppedRowIndex===0?0:this.droppedRowIndex-1,n=Ii(this.processedData);CV(n,this.draggedRowIndex+this.d_first,t+this.d_first),this.$emit("row-reorder",{originalEvent:e,dragIndex:this.draggedRowIndex,dropIndex:t,value:n})}this.onRowDragLeave(e),this.onRowDragEnd(e),e.preventDefault()},toggleRow:function(e){var t=this,n=e.expanded,i=cXe(e,lXe),s=e.data,a;if(this.dataKey){var o=hn(s,this.dataKey);a=this.expandedRows?ka({},this.expandedRows):{},n?a[o]=!0:delete a[o]}else a=this.expandedRows?Ii(this.expandedRows):[],n?a.push(s):a=a.filter(function(u){return!t.equals(s,u)});this.$emit("update:expandedRows",a),n?this.$emit("row-expand",i):this.$emit("row-collapse",i)},toggleRowGroup:function(e){var t=e.originalEvent,n=e.data,i=hn(n,this.groupRowsBy),s=this.expandedRowGroups?Ii(this.expandedRowGroups):[];this.isRowGroupExpanded(n)?(s=s.filter(function(a){return a!==i}),this.$emit("update:expandedRowGroups",s),this.$emit("rowgroup-collapse",{originalEvent:t,data:i})):(s.push(i),this.$emit("update:expandedRowGroups",s),this.$emit("rowgroup-expand",{originalEvent:t,data:i}))},isRowGroupExpanded:function(e){if(this.expandableRowGroups&&this.expandedRowGroups){var t=hn(e,this.groupRowsBy);return this.expandedRowGroups.indexOf(t)>-1}return!1},isStateful:function(){return this.stateKey!=null},getStorage:function(){switch(this.stateStorage){case"local":return window.localStorage;case"session":return window.sessionStorage;default:throw new Error(this.stateStorage+' is not a valid value for the state storage, supported values are "local" and "session".')}},saveState:function(){var e=this.getStorage(),t={};this.paginator&&(t.first=this.d_first,t.rows=this.d_rows),this.d_sortField&&(typeof this.d_sortField!="function"&&(t.sortField=this.d_sortField),t.sortOrder=this.d_sortOrder),this.d_multiSortMeta&&(t.multiSortMeta=this.d_multiSortMeta),this.hasFilters&&(t.filters=this.filters),this.resizableColumns&&this.saveColumnWidths(t),this.reorderableColumns&&(t.columnOrder=this.d_columnOrder),this.expandedRows&&(t.expandedRows=this.expandedRows),this.expandedRowGroups&&(t.expandedRowGroups=this.expandedRowGroups),this.selection&&(t.selection=this.selection,t.selectionKeys=this.d_selectionKeys),Object.keys(t).length&&e.setItem(this.stateKey,JSON.stringify(t)),this.$emit("state-save",t)},restoreState:function(){var e=this.getStorage(),t=e.getItem(this.stateKey),n=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/,i=function(u,f){return typeof f=="string"&&n.test(f)?new Date(f):f},s;try{s=JSON.parse(t,i)}catch{}if(!s||Vc(s)!=="object"){e.removeItem(this.stateKey);return}var a={};this.paginator&&(typeof s.first=="number"&&(this.d_first=s.first,this.$emit("update:first",this.d_first),a.first=this.d_first),typeof s.rows=="number"&&(this.d_rows=s.rows,this.$emit("update:rows",this.d_rows),a.rows=this.d_rows)),typeof s.sortField=="string"&&(this.d_sortField=s.sortField,this.$emit("update:sortField",this.d_sortField),a.sortField=this.d_sortField),typeof s.sortOrder=="number"&&(this.d_sortOrder=s.sortOrder,this.$emit("update:sortOrder",this.d_sortOrder),a.sortOrder=this.d_sortOrder),Array.isArray(s.multiSortMeta)&&(this.d_multiSortMeta=s.multiSortMeta,this.$emit("update:multiSortMeta",this.d_multiSortMeta),a.multiSortMeta=this.d_multiSortMeta),this.hasFilters&&Vc(s.filters)==="object"&&s.filters!==null&&(this.d_filters=this.cloneFilters(s.filters),this.$emit("update:filters",this.d_filters),a.filters=this.d_filters),this.resizableColumns&&(typeof s.columnWidths=="string"&&(this.columnWidthsState=s.columnWidths,a.columnWidths=this.columnWidthsState),typeof s.tableWidth=="string"&&(this.tableWidthState=s.tableWidth,a.tableWidth=this.tableWidthState)),this.reorderableColumns&&Array.isArray(s.columnOrder)&&(this.d_columnOrder=s.columnOrder,a.columnOrder=this.d_columnOrder),Vc(s.expandedRows)==="object"&&s.expandedRows!==null&&(this.$emit("update:expandedRows",s.expandedRows),a.expandedRows=s.expandedRows),Array.isArray(s.expandedRowGroups)&&(this.$emit("update:expandedRowGroups",s.expandedRowGroups),a.expandedRowGroups=s.expandedRowGroups),Vc(s.selection)==="object"&&s.selection!==null&&(Vc(s.selectionKeys)==="object"&&s.selectionKeys!==null&&(this.d_selectionKeys=s.selectionKeys,a.selectionKeys=this.d_selectionKeys),this.$emit("update:selection",s.selection),a.selection=s.selection),this.$emit("state-restore",a)},saveColumnWidths:function(e){var t=[],n=cm(this.$el,'thead[data-pc-section="thead"] > tr > th');n.forEach(function(i){return t.push(da(i))}),e.columnWidths=t.join(","),this.columnResizeMode==="expand"&&(e.tableWidth=da(this.$refs.table)+"px")},addColumnWidthStyles:function(e){this.createStyleElement();var t="",n='[data-pc-name="datatable"]['.concat(this.$attrSelector,'] > [data-pc-section="tablecontainer"] ').concat(this.virtualScrollerDisabled?"":'> [data-pc-name="virtualscroller"]',' > table[data-pc-section="table"]');e.forEach(function(i,s){var a="width: ".concat(i,"px !important; max-width: ").concat(i,"px !important");t+=`
        `.concat(n,' > thead[data-pc-section="thead"] > tr > th:nth-child(').concat(s+1,`),
        `).concat(n,' > tbody[data-pc-section="tbody"] > tr > td:nth-child(').concat(s+1,`),
        `).concat(n,' > tfoot[data-pc-section="tfoot"] > tr > td:nth-child(').concat(s+1,`) {
            `).concat(a,`
        }
    `)}),this.styleElement.innerHTML=t},restoreColumnWidths:function(){if(this.columnWidthsState){var e=this.columnWidthsState.split(",");this.columnResizeMode==="expand"&&this.tableWidthState&&(this.$refs.table.style.width=this.tableWidthState,this.$refs.table.style.minWidth=this.tableWidthState),Xr(e)&&this.addColumnWidthStyles(e)}},onCellEditInit:function(e){this.$emit("cell-edit-init",e)},onCellEditComplete:function(e){this.$emit("cell-edit-complete",e)},onCellEditCancel:function(e){this.$emit("cell-edit-cancel",e)},onRowEditInit:function(e){var t=this.editingRows?Ii(this.editingRows):[];t.push(e.data),this.$emit("update:editingRows",t),this.$emit("row-edit-init",e)},onRowEditSave:function(e){var t=Ii(this.editingRows);t.splice(this.findIndex(e.data,t),1),this.$emit("update:editingRows",t),this.$emit("row-edit-save",e)},onRowEditCancel:function(e){var t=Ii(this.editingRows);t.splice(this.findIndex(e.data,t),1),this.$emit("update:editingRows",t),this.$emit("row-edit-cancel",e)},onEditingMetaChange:function(e){var t=e.data,n=e.field,i=e.index,s=e.editing,a=ka({},this.d_editingMeta),o=a[i];if(s)!o&&(o=a[i]={data:ka({},t),fields:[]}),o.fields.push(n);else if(o){var u=o.fields.filter(function(f){return f!==n});u.length?o.fields=u:delete a[i]}this.d_editingMeta=a},clearEditingMetaData:function(){this.editMode&&(this.d_editingMeta={})},createLazyLoadEvent:function(e){return{originalEvent:e,first:this.d_first,rows:this.d_rows,sortField:this.d_sortField,sortOrder:this.d_sortOrder,multiSortMeta:this.d_multiSortMeta,filters:this.d_filters}},hasGlobalFilter:function(){return this.filters&&Object.prototype.hasOwnProperty.call(this.filters,"global")},onFilterChange:function(e){this.d_filters=e},onFilterApply:function(){this.d_first=0,this.$emit("update:first",this.d_first),this.$emit("update:filters",this.d_filters),this.lazy&&this.$emit("filter",this.createLazyLoadEvent())},cloneFilters:function(e){var t={};return e&&Object.entries(e).forEach(function(n){var i=C$(n,2),s=i[0],a=i[1];t[s]=a.operator?{operator:a.operator,constraints:a.constraints.map(function(o){return ka({},o)})}:ka({},a)}),t},updateReorderableColumns:function(){var e=this,t=[];this.columns.forEach(function(n){return t.push(e.columnProp(n,"columnKey")||e.columnProp(n,"field"))}),this.d_columnOrder=t},createStyleElement:function(){var e;this.styleElement=document.createElement("style"),this.styleElement.type="text/css",uL(this.styleElement,"nonce",(e=this.$primevue)===null||e===void 0||(e=e.config)===null||e===void 0||(e=e.csp)===null||e===void 0?void 0:e.nonce),document.head.appendChild(this.styleElement)},destroyStyleElement:function(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)},dataToRender:function(e){var t=e||this.processedData;if(t&&this.paginator){var n=this.lazy?0:this.d_first;return t.slice(n,n+this.d_rows)}return t},getVirtualScrollerRef:function(){return this.$refs.virtualScroller},hasSpacerStyle:function(e){return Xr(e)}},computed:{columns:function(){var e=this.d_columns.get(this);if(e&&this.reorderableColumns&&this.d_columnOrder){var t=[],n=m0(this.d_columnOrder),i;try{for(n.s();!(i=n.n()).done;){var s=i.value,a=this.findColumnByKey(e,s);a&&!this.columnProp(a,"hidden")&&t.push(a)}}catch(o){n.e(o)}finally{n.f()}return[].concat(t,Ii(e.filter(function(o){return t.indexOf(o)<0})))}return e},columnGroups:function(){return this.d_columnGroups.get(this)},headerColumnGroup:function(){var e,t=this;return(e=this.columnGroups)===null||e===void 0?void 0:e.find(function(n){return t.columnProp(n,"type")==="header"})},footerColumnGroup:function(){var e,t=this;return(e=this.columnGroups)===null||e===void 0?void 0:e.find(function(n){return t.columnProp(n,"type")==="footer"})},hasFilters:function(){return this.filters&&Object.keys(this.filters).length>0&&this.filters.constructor===Object},processedData:function(){var e,t=this.value||[];return!this.lazy&&!((e=this.virtualScrollerOptions)!==null&&e!==void 0&&e.lazy)&&t&&t.length&&(this.hasFilters&&(t=this.filter(t)),this.sorted&&(this.sortMode==="single"?t=this.sortSingle(t):this.sortMode==="multiple"&&(t=this.sortMultiple(t)))),t},totalRecordsLength:function(){if(this.lazy)return this.totalRecords;var e=this.processedData;return e?e.length:0},empty:function(){var e=this.processedData;return!e||e.length===0},paginatorTop:function(){return this.paginator&&(this.paginatorPosition!=="bottom"||this.paginatorPosition==="both")},paginatorBottom:function(){return this.paginator&&(this.paginatorPosition!=="top"||this.paginatorPosition==="both")},sorted:function(){return this.d_sortField||this.d_multiSortMeta&&this.d_multiSortMeta.length>0},allRowsSelected:function(){var e=this;if(this.selectAll!==null)return this.selectAll;var t=this.frozenValue?[].concat(Ii(this.frozenValue),Ii(this.processedData)):this.processedData;return Xr(t)&&this.selection&&Array.isArray(this.selection)&&t.every(function(n){return e.selection.some(function(i){return e.equals(i,n)})})},groupRowSortField:function(){return this.sortMode==="single"?this.sortField:this.d_groupRowsSortMeta?this.d_groupRowsSortMeta.field:null},headerFilterButtonProps:function(){return ka(ka({filter:{severity:"secondary",text:!0,rounded:!0}},this.filterButtonProps),{},{inline:ka({clear:{severity:"secondary",text:!0,rounded:!0}},this.filterButtonProps.inline),popover:ka({addRule:{severity:"info",text:!0,size:"small"},removeRule:{severity:"danger",text:!0,size:"small"},apply:{size:"small"},clear:{outlined:!0,size:"small"}},this.filterButtonProps.popover)})},rowEditButtonProps:function(){return ka(ka({},{init:{severity:"secondary",text:!0,rounded:!0},save:{severity:"secondary",text:!0,rounded:!0},cancel:{severity:"secondary",text:!0,rounded:!0}}),this.editButtonProps)},virtualScrollerDisabled:function(){return pa(this.virtualScrollerOptions)||!this.scrollable},dataP:function(){return wo(Ww(Ww(Ww({scrollable:this.scrollable,"flex-scrollable":this.scrollable&&this.scrollHeight==="flex"},this.size,this.size),"loading",this.loading),"empty",this.empty))}},components:{DTPaginator:KZ,DTTableHeader:dQ,DTTableBody:aQ,DTTableFooter:cQ,DTVirtualScroller:pL,ArrowDownIcon:CZ,ArrowUpIcon:TZ,SpinnerIcon:aA}};function Nv(r){"@babel/helpers - typeof";return Nv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nv(r)}function T$(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function S$(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?T$(Object(t),!0).forEach(function(n){_Xe(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):T$(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function _Xe(r,e,t){return(e=vXe(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function vXe(r){var e=AXe(r,"string");return Nv(e)=="symbol"?e:e+""}function AXe(r,e){if(Nv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(Nv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var xXe=["data-p"],wXe=["data-p"];function CXe(r,e,t,n,i,s){var a=I.resolveComponent("SpinnerIcon"),o=I.resolveComponent("DTPaginator"),u=I.resolveComponent("DTTableHeader"),f=I.resolveComponent("DTTableBody"),g=I.resolveComponent("DTTableFooter"),y=I.resolveComponent("DTVirtualScroller");return I.openBlock(),I.createElementBlock("div",I.mergeProps({class:r.cx("root"),"data-scrollselectors":".p-datatable-wrapper","data-p":s.dataP},r.ptmi("root")),[I.renderSlot(r.$slots,"default"),I.createVNode(I.Transition,{name:"p-overlay-mask"},{default:I.withCtx(function(){return[r.loading?(I.openBlock(),I.createElementBlock("div",I.mergeProps({key:0,class:r.cx("mask")},r.ptm("mask")),[r.$slots.loading?I.renderSlot(r.$slots,"loading",{key:0}):(I.openBlock(),I.createElementBlock(I.Fragment,{key:1},[r.$slots.loadingicon?(I.openBlock(),I.createBlock(I.resolveDynamicComponent(r.$slots.loadingicon),{key:0,class:I.normalizeClass(r.cx("loadingIcon"))},null,8,["class"])):r.loadingIcon?(I.openBlock(),I.createElementBlock("i",I.mergeProps({key:1,class:[r.cx("loadingIcon"),"pi-spin",r.loadingIcon]},r.ptm("loadingIcon")),null,16)):(I.openBlock(),I.createBlock(a,I.mergeProps({key:2,spin:"",class:r.cx("loadingIcon")},r.ptm("loadingIcon")),null,16,["class"]))],64))],16)):I.createCommentVNode("",!0)]}),_:3}),r.$slots.header?(I.openBlock(),I.createElementBlock("div",I.mergeProps({key:0,class:r.cx("header")},r.ptm("header")),[I.renderSlot(r.$slots,"header")],16)):I.createCommentVNode("",!0),s.paginatorTop?(I.openBlock(),I.createBlock(o,{key:1,rows:i.d_rows,first:i.d_first,totalRecords:s.totalRecordsLength,pageLinkSize:r.pageLinkSize,template:r.paginatorTemplate,rowsPerPageOptions:r.rowsPerPageOptions,currentPageReportTemplate:r.currentPageReportTemplate,class:I.normalizeClass(r.cx("pcPaginator",{position:"top"})),onPage:e[0]||(e[0]=function(A){return s.onPage(A)}),alwaysShow:r.alwaysShowPaginator,unstyled:r.unstyled,"data-p-top":!0,pt:r.ptm("pcPaginator")},I.createSlots({_:2},[r.$slots.paginatorcontainer?{name:"container",fn:I.withCtx(function(A){return[I.renderSlot(r.$slots,"paginatorcontainer",{first:A.first,last:A.last,rows:A.rows,page:A.page,pageCount:A.pageCount,pageLinks:A.pageLinks,totalRecords:A.totalRecords,firstPageCallback:A.firstPageCallback,lastPageCallback:A.lastPageCallback,prevPageCallback:A.prevPageCallback,nextPageCallback:A.nextPageCallback,rowChangeCallback:A.rowChangeCallback,changePageCallback:A.changePageCallback})]}),key:"0"}:void 0,r.$slots.paginatorstart?{name:"start",fn:I.withCtx(function(){return[I.renderSlot(r.$slots,"paginatorstart")]}),key:"1"}:void 0,r.$slots.paginatorend?{name:"end",fn:I.withCtx(function(){return[I.renderSlot(r.$slots,"paginatorend")]}),key:"2"}:void 0,r.$slots.paginatorfirstpagelinkicon?{name:"firstpagelinkicon",fn:I.withCtx(function(A){return[I.renderSlot(r.$slots,"paginatorfirstpagelinkicon",{class:I.normalizeClass(A.class)})]}),key:"3"}:void 0,r.$slots.paginatorprevpagelinkicon?{name:"prevpagelinkicon",fn:I.withCtx(function(A){return[I.renderSlot(r.$slots,"paginatorprevpagelinkicon",{class:I.normalizeClass(A.class)})]}),key:"4"}:void 0,r.$slots.paginatornextpagelinkicon?{name:"nextpagelinkicon",fn:I.withCtx(function(A){return[I.renderSlot(r.$slots,"paginatornextpagelinkicon",{class:I.normalizeClass(A.class)})]}),key:"5"}:void 0,r.$slots.paginatorlastpagelinkicon?{name:"lastpagelinkicon",fn:I.withCtx(function(A){return[I.renderSlot(r.$slots,"paginatorlastpagelinkicon",{class:I.normalizeClass(A.class)})]}),key:"6"}:void 0,r.$slots.paginatorjumptopagedropdownicon?{name:"jumptopagedropdownicon",fn:I.withCtx(function(A){return[I.renderSlot(r.$slots,"paginatorjumptopagedropdownicon",{class:I.normalizeClass(A.class)})]}),key:"7"}:void 0,r.$slots.paginatorrowsperpagedropdownicon?{name:"rowsperpagedropdownicon",fn:I.withCtx(function(A){return[I.renderSlot(r.$slots,"paginatorrowsperpagedropdownicon",{class:I.normalizeClass(A.class)})]}),key:"8"}:void 0]),1032,["rows","first","totalRecords","pageLinkSize","template","rowsPerPageOptions","currentPageReportTemplate","class","alwaysShow","unstyled","pt"])):I.createCommentVNode("",!0),I.createElementVNode("div",I.mergeProps({class:r.cx("tableContainer"),style:[r.sx("tableContainer"),{maxHeight:s.virtualScrollerDisabled?r.scrollHeight:""}],"data-p":s.dataP},r.ptm("tableContainer")),[I.createVNode(y,I.mergeProps({ref:"virtualScroller"},r.virtualScrollerOptions,{items:s.processedData,columns:s.columns,style:r.scrollHeight!=="flex"?{height:r.scrollHeight}:void 0,scrollHeight:r.scrollHeight!=="flex"?void 0:"100%",disabled:s.virtualScrollerDisabled,loaderDisabled:"",inline:"",autoSize:"",showSpacer:!1,pt:r.ptm("virtualScroller")}),{content:I.withCtx(function(A){return[I.createElementVNode("table",I.mergeProps({ref:"table",role:"table",class:[r.cx("table"),r.tableClass],style:[r.tableStyle,A.spacerStyle]},S$(S$({},r.tableProps),r.ptm("table"))),[r.showHeaders?(I.openBlock(),I.createBlock(u,{key:0,columnGroup:s.headerColumnGroup,columns:A.columns,rowGroupMode:r.rowGroupMode,groupRowsBy:r.groupRowsBy,groupRowSortField:s.groupRowSortField,reorderableColumns:r.reorderableColumns,resizableColumns:r.resizableColumns,allRowsSelected:s.allRowsSelected,empty:s.empty,sortMode:r.sortMode,sortField:i.d_sortField,sortOrder:i.d_sortOrder,multiSortMeta:i.d_multiSortMeta,filters:i.d_filters,filtersStore:r.filters,filterDisplay:r.filterDisplay,filterButtonProps:s.headerFilterButtonProps,filterInputProps:r.filterInputProps,first:i.d_first,onColumnClick:e[1]||(e[1]=function(C){return s.onColumnHeaderClick(C)}),onColumnMousedown:e[2]||(e[2]=function(C){return s.onColumnHeaderMouseDown(C)}),onFilterChange:s.onFilterChange,onFilterApply:s.onFilterApply,onColumnDragstart:e[3]||(e[3]=function(C){return s.onColumnHeaderDragStart(C)}),onColumnDragover:e[4]||(e[4]=function(C){return s.onColumnHeaderDragOver(C)}),onColumnDragleave:e[5]||(e[5]=function(C){return s.onColumnHeaderDragLeave(C)}),onColumnDrop:e[6]||(e[6]=function(C){return s.onColumnHeaderDrop(C)}),onColumnResizestart:e[7]||(e[7]=function(C){return s.onColumnResizeStart(C)}),onCheckboxChange:e[8]||(e[8]=function(C){return s.toggleRowsWithCheckbox(C)}),unstyled:r.unstyled,pt:r.pt},null,8,["columnGroup","columns","rowGroupMode","groupRowsBy","groupRowSortField","reorderableColumns","resizableColumns","allRowsSelected","empty","sortMode","sortField","sortOrder","multiSortMeta","filters","filtersStore","filterDisplay","filterButtonProps","filterInputProps","first","onFilterChange","onFilterApply","unstyled","pt"])):I.createCommentVNode("",!0),r.frozenValue?(I.openBlock(),I.createBlock(f,{key:1,ref:"frozenBodyRef",value:r.frozenValue,frozenRow:!0,columns:A.columns,first:i.d_first,dataKey:r.dataKey,selection:r.selection,selectionKeys:i.d_selectionKeys,selectionMode:r.selectionMode,rowHover:r.rowHover,contextMenu:r.contextMenu,contextMenuSelection:r.contextMenuSelection,rowGroupMode:r.rowGroupMode,groupRowsBy:r.groupRowsBy,expandableRowGroups:r.expandableRowGroups,rowClass:r.rowClass,rowStyle:r.rowStyle,editMode:r.editMode,compareSelectionBy:r.compareSelectionBy,scrollable:r.scrollable,expandedRowIcon:r.expandedRowIcon,collapsedRowIcon:r.collapsedRowIcon,expandedRows:r.expandedRows,expandedRowGroups:r.expandedRowGroups,editingRows:r.editingRows,editingRowKeys:i.d_editingRowKeys,templates:r.$slots,editButtonProps:s.rowEditButtonProps,isVirtualScrollerDisabled:!0,onRowgroupToggle:s.toggleRowGroup,onRowClick:e[9]||(e[9]=function(C){return s.onRowClick(C)}),onRowDblclick:e[10]||(e[10]=function(C){return s.onRowDblClick(C)}),onRowRightclick:e[11]||(e[11]=function(C){return s.onRowRightClick(C)}),onRowTouchend:s.onRowTouchEnd,onRowKeydown:s.onRowKeyDown,onRowMousedown:s.onRowMouseDown,onRowDragstart:e[12]||(e[12]=function(C){return s.onRowDragStart(C)}),onRowDragover:e[13]||(e[13]=function(C){return s.onRowDragOver(C)}),onRowDragleave:e[14]||(e[14]=function(C){return s.onRowDragLeave(C)}),onRowDragend:e[15]||(e[15]=function(C){return s.onRowDragEnd(C)}),onRowDrop:e[16]||(e[16]=function(C){return s.onRowDrop(C)}),onRowToggle:e[17]||(e[17]=function(C){return s.toggleRow(C)}),onRadioChange:e[18]||(e[18]=function(C){return s.toggleRowWithRadio(C)}),onCheckboxChange:e[19]||(e[19]=function(C){return s.toggleRowWithCheckbox(C)}),onCellEditInit:e[20]||(e[20]=function(C){return s.onCellEditInit(C)}),onCellEditComplete:e[21]||(e[21]=function(C){return s.onCellEditComplete(C)}),onCellEditCancel:e[22]||(e[22]=function(C){return s.onCellEditCancel(C)}),onRowEditInit:e[23]||(e[23]=function(C){return s.onRowEditInit(C)}),onRowEditSave:e[24]||(e[24]=function(C){return s.onRowEditSave(C)}),onRowEditCancel:e[25]||(e[25]=function(C){return s.onRowEditCancel(C)}),editingMeta:i.d_editingMeta,onEditingMetaChange:s.onEditingMetaChange,unstyled:r.unstyled,pt:r.pt},null,8,["value","columns","first","dataKey","selection","selectionKeys","selectionMode","rowHover","contextMenu","contextMenuSelection","rowGroupMode","groupRowsBy","expandableRowGroups","rowClass","rowStyle","editMode","compareSelectionBy","scrollable","expandedRowIcon","collapsedRowIcon","expandedRows","expandedRowGroups","editingRows","editingRowKeys","templates","editButtonProps","onRowgroupToggle","onRowTouchend","onRowKeydown","onRowMousedown","editingMeta","onEditingMetaChange","unstyled","pt"])):I.createCommentVNode("",!0),I.createVNode(f,{ref:"bodyRef",value:s.dataToRender(A.rows),class:I.normalizeClass(A.styleClass),columns:A.columns,empty:s.empty,first:i.d_first,dataKey:r.dataKey,selection:r.selection,selectionKeys:i.d_selectionKeys,selectionMode:r.selectionMode,rowHover:r.rowHover,contextMenu:r.contextMenu,contextMenuSelection:r.contextMenuSelection,rowGroupMode:r.rowGroupMode,groupRowsBy:r.groupRowsBy,expandableRowGroups:r.expandableRowGroups,rowClass:r.rowClass,rowStyle:r.rowStyle,editMode:r.editMode,compareSelectionBy:r.compareSelectionBy,scrollable:r.scrollable,expandedRowIcon:r.expandedRowIcon,collapsedRowIcon:r.collapsedRowIcon,expandedRows:r.expandedRows,expandedRowGroups:r.expandedRowGroups,editingRows:r.editingRows,editingRowKeys:i.d_editingRowKeys,templates:r.$slots,editButtonProps:s.rowEditButtonProps,virtualScrollerContentProps:A,isVirtualScrollerDisabled:s.virtualScrollerDisabled,onRowgroupToggle:s.toggleRowGroup,onRowClick:e[26]||(e[26]=function(C){return s.onRowClick(C)}),onRowDblclick:e[27]||(e[27]=function(C){return s.onRowDblClick(C)}),onRowRightclick:e[28]||(e[28]=function(C){return s.onRowRightClick(C)}),onRowTouchend:s.onRowTouchEnd,onRowKeydown:function(M){return s.onRowKeyDown(M,A)},onRowMousedown:s.onRowMouseDown,onRowDragstart:e[29]||(e[29]=function(C){return s.onRowDragStart(C)}),onRowDragover:e[30]||(e[30]=function(C){return s.onRowDragOver(C)}),onRowDragleave:e[31]||(e[31]=function(C){return s.onRowDragLeave(C)}),onRowDragend:e[32]||(e[32]=function(C){return s.onRowDragEnd(C)}),onRowDrop:e[33]||(e[33]=function(C){return s.onRowDrop(C)}),onRowToggle:e[34]||(e[34]=function(C){return s.toggleRow(C)}),onRadioChange:e[35]||(e[35]=function(C){return s.toggleRowWithRadio(C)}),onCheckboxChange:e[36]||(e[36]=function(C){return s.toggleRowWithCheckbox(C)}),onCellEditInit:e[37]||(e[37]=function(C){return s.onCellEditInit(C)}),onCellEditComplete:e[38]||(e[38]=function(C){return s.onCellEditComplete(C)}),onCellEditCancel:e[39]||(e[39]=function(C){return s.onCellEditCancel(C)}),onRowEditInit:e[40]||(e[40]=function(C){return s.onRowEditInit(C)}),onRowEditSave:e[41]||(e[41]=function(C){return s.onRowEditSave(C)}),onRowEditCancel:e[42]||(e[42]=function(C){return s.onRowEditCancel(C)}),editingMeta:i.d_editingMeta,onEditingMetaChange:s.onEditingMetaChange,unstyled:r.unstyled,pt:r.pt},null,8,["value","class","columns","empty","first","dataKey","selection","selectionKeys","selectionMode","rowHover","contextMenu","contextMenuSelection","rowGroupMode","groupRowsBy","expandableRowGroups","rowClass","rowStyle","editMode","compareSelectionBy","scrollable","expandedRowIcon","collapsedRowIcon","expandedRows","expandedRowGroups","editingRows","editingRowKeys","templates","editButtonProps","virtualScrollerContentProps","isVirtualScrollerDisabled","onRowgroupToggle","onRowTouchend","onRowKeydown","onRowMousedown","editingMeta","onEditingMetaChange","unstyled","pt"]),s.hasSpacerStyle(A.spacerStyle)?(I.openBlock(),I.createElementBlock("tbody",I.mergeProps({key:2,class:r.cx("virtualScrollerSpacer"),style:{height:"calc(".concat(A.spacerStyle.height," - ").concat(A.rows.length*A.itemSize,"px)")}},r.ptm("virtualScrollerSpacer")),null,16)):I.createCommentVNode("",!0),I.createVNode(g,{columnGroup:s.footerColumnGroup,columns:A.columns,pt:r.pt},null,8,["columnGroup","columns","pt"])],16)]}),_:1},16,["items","columns","style","scrollHeight","disabled","pt"])],16,wXe),s.paginatorBottom?(I.openBlock(),I.createBlock(o,{key:2,rows:i.d_rows,first:i.d_first,totalRecords:s.totalRecordsLength,pageLinkSize:r.pageLinkSize,template:r.paginatorTemplate,rowsPerPageOptions:r.rowsPerPageOptions,currentPageReportTemplate:r.currentPageReportTemplate,class:I.normalizeClass(r.cx("pcPaginator",{position:"bottom"})),onPage:e[43]||(e[43]=function(A){return s.onPage(A)}),alwaysShow:r.alwaysShowPaginator,unstyled:r.unstyled,"data-p-bottom":!0,pt:r.ptm("pcPaginator")},I.createSlots({_:2},[r.$slots.paginatorcontainer?{name:"container",fn:I.withCtx(function(A){return[I.renderSlot(r.$slots,"paginatorcontainer",{first:A.first,last:A.last,rows:A.rows,page:A.page,pageCount:A.pageCount,pageLinks:A.pageLinks,totalRecords:A.totalRecords,firstPageCallback:A.firstPageCallback,lastPageCallback:A.lastPageCallback,prevPageCallback:A.prevPageCallback,nextPageCallback:A.nextPageCallback,rowChangeCallback:A.rowChangeCallback,changePageCallback:A.changePageCallback})]}),key:"0"}:void 0,r.$slots.paginatorstart?{name:"start",fn:I.withCtx(function(){return[I.renderSlot(r.$slots,"paginatorstart")]}),key:"1"}:void 0,r.$slots.paginatorend?{name:"end",fn:I.withCtx(function(){return[I.renderSlot(r.$slots,"paginatorend")]}),key:"2"}:void 0,r.$slots.paginatorfirstpagelinkicon?{name:"firstpagelinkicon",fn:I.withCtx(function(A){return[I.renderSlot(r.$slots,"paginatorfirstpagelinkicon",{class:I.normalizeClass(A.class)})]}),key:"3"}:void 0,r.$slots.paginatorprevpagelinkicon?{name:"prevpagelinkicon",fn:I.withCtx(function(A){return[I.renderSlot(r.$slots,"paginatorprevpagelinkicon",{class:I.normalizeClass(A.class)})]}),key:"4"}:void 0,r.$slots.paginatornextpagelinkicon?{name:"nextpagelinkicon",fn:I.withCtx(function(A){return[I.renderSlot(r.$slots,"paginatornextpagelinkicon",{class:I.normalizeClass(A.class)})]}),key:"5"}:void 0,r.$slots.paginatorlastpagelinkicon?{name:"lastpagelinkicon",fn:I.withCtx(function(A){return[I.renderSlot(r.$slots,"paginatorlastpagelinkicon",{class:I.normalizeClass(A.class)})]}),key:"6"}:void 0,r.$slots.paginatorjumptopagedropdownicon?{name:"jumptopagedropdownicon",fn:I.withCtx(function(A){return[I.renderSlot(r.$slots,"paginatorjumptopagedropdownicon",{class:I.normalizeClass(A.class)})]}),key:"7"}:void 0,r.$slots.paginatorrowsperpagedropdownicon?{name:"rowsperpagedropdownicon",fn:I.withCtx(function(A){return[I.renderSlot(r.$slots,"paginatorrowsperpagedropdownicon",{class:I.normalizeClass(A.class)})]}),key:"8"}:void 0]),1032,["rows","first","totalRecords","pageLinkSize","template","rowsPerPageOptions","currentPageReportTemplate","class","alwaysShow","unstyled","pt"])):I.createCommentVNode("",!0),r.$slots.footer?(I.openBlock(),I.createElementBlock("div",I.mergeProps({key:3,class:r.cx("footer")},r.ptm("footer")),[I.renderSlot(r.$slots,"footer")],16)):I.createCommentVNode("",!0),I.createElementVNode("div",I.mergeProps({ref:"resizeHelper",class:r.cx("columnResizeIndicator"),style:{display:"none"}},r.ptm("columnResizeIndicator")),null,16),r.reorderableColumns?(I.openBlock(),I.createElementBlock("span",I.mergeProps({key:4,ref:"reorderIndicatorUp",class:r.cx("rowReorderIndicatorUp"),style:{position:"absolute",display:"none"}},r.ptm("rowReorderIndicatorUp")),[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(r.$slots.rowreorderindicatorupicon||r.$slots.reorderindicatorupicon||"ArrowDownIcon")))],16)):I.createCommentVNode("",!0),r.reorderableColumns?(I.openBlock(),I.createElementBlock("span",I.mergeProps({key:5,ref:"reorderIndicatorDown",class:r.cx("rowReorderIndicatorDown"),style:{position:"absolute",display:"none"}},r.ptm("rowReorderIndicatorDown")),[(I.openBlock(),I.createBlock(I.resolveDynamicComponent(r.$slots.rowreorderindicatordownicon||r.$slots.reorderindicatordownicon||"ArrowUpIcon")))],16)):I.createCommentVNode("",!0)],16,xXe)}fQ.render=CXe;var TXe=cn.extend({name:"column"}),SXe={name:"BaseColumn",extends:In,props:{columnKey:{type:null,default:null},field:{type:[String,Function],default:null},sortField:{type:[String,Function],default:null},filterField:{type:[String,Function],default:null},dataType:{type:String,default:"text"},sortable:{type:Boolean,default:!1},header:{type:null,default:null},footer:{type:null,default:null},style:{type:null,default:null},class:{type:String,default:null},headerStyle:{type:null,default:null},headerClass:{type:String,default:null},bodyStyle:{type:null,default:null},bodyClass:{type:String,default:null},footerStyle:{type:null,default:null},footerClass:{type:String,default:null},showFilterMenu:{type:Boolean,default:!0},showFilterOperator:{type:Boolean,default:!0},showClearButton:{type:Boolean,default:!1},showApplyButton:{type:Boolean,default:!0},showFilterMatchModes:{type:Boolean,default:!0},showAddButton:{type:Boolean,default:!0},filterMatchModeOptions:{type:Array,default:null},maxConstraints:{type:Number,default:2},excludeGlobalFilter:{type:Boolean,default:!1},filterHeaderClass:{type:String,default:null},filterHeaderStyle:{type:null,default:null},filterMenuClass:{type:String,default:null},filterMenuStyle:{type:null,default:null},selectionMode:{type:String,default:null},expander:{type:Boolean,default:!1},colspan:{type:Number,default:null},rowspan:{type:Number,default:null},rowReorder:{type:Boolean,default:!1},rowReorderIcon:{type:String,default:void 0},reorderableColumn:{type:Boolean,default:!0},rowEditor:{type:Boolean,default:!1},frozen:{type:Boolean,default:!1},alignFrozen:{type:String,default:"left"},exportable:{type:Boolean,default:!0},exportHeader:{type:String,default:null},exportFooter:{type:String,default:null},filterMatchMode:{type:String,default:null},hidden:{type:Boolean,default:!1}},style:TXe,provide:function(){return{$pcColumn:this,$parentInstance:this}}},ta={name:"Column",extends:SXe,inheritAttrs:!1,inject:["$columns"],mounted:function(){var e;(e=this.$columns)===null||e===void 0||e.add(this.$)},unmounted:function(){var e;(e=this.$columns)===null||e===void 0||e.delete(this.$)},render:function(){return null}},EXe=`
    .p-tag {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: dt('tag.primary.background');
        color: dt('tag.primary.color');
        font-size: dt('tag.font.size');
        font-weight: dt('tag.font.weight');
        padding: dt('tag.padding');
        border-radius: dt('tag.border.radius');
        gap: dt('tag.gap');
    }

    .p-tag-icon {
        font-size: dt('tag.icon.size');
        width: dt('tag.icon.size');
        height: dt('tag.icon.size');
    }

    .p-tag-rounded {
        border-radius: dt('tag.rounded.border.radius');
    }

    .p-tag-success {
        background: dt('tag.success.background');
        color: dt('tag.success.color');
    }

    .p-tag-info {
        background: dt('tag.info.background');
        color: dt('tag.info.color');
    }

    .p-tag-warn {
        background: dt('tag.warn.background');
        color: dt('tag.warn.color');
    }

    .p-tag-danger {
        background: dt('tag.danger.background');
        color: dt('tag.danger.color');
    }

    .p-tag-secondary {
        background: dt('tag.secondary.background');
        color: dt('tag.secondary.color');
    }

    .p-tag-contrast {
        background: dt('tag.contrast.background');
        color: dt('tag.contrast.color');
    }
`,IXe={root:function(e){var t=e.props;return["p-tag p-component",{"p-tag-info":t.severity==="info","p-tag-success":t.severity==="success","p-tag-warn":t.severity==="warn","p-tag-danger":t.severity==="danger","p-tag-secondary":t.severity==="secondary","p-tag-contrast":t.severity==="contrast","p-tag-rounded":t.rounded}]},icon:"p-tag-icon",label:"p-tag-label"},PXe=cn.extend({name:"tag",style:EXe,classes:IXe}),BXe={name:"BaseTag",extends:In,props:{value:null,severity:null,rounded:Boolean,icon:String},style:PXe,provide:function(){return{$pcTag:this,$parentInstance:this}}};function Fv(r){"@babel/helpers - typeof";return Fv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fv(r)}function MXe(r,e,t){return(e=RXe(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function RXe(r){var e=kXe(r,"string");return Fv(e)=="symbol"?e:e+""}function kXe(r,e){if(Fv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(Fv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var Kw={name:"Tag",extends:BXe,inheritAttrs:!1,computed:{dataP:function(){return wo(MXe({rounded:this.rounded},this.severity,this.severity))}}},OXe=["data-p"];function DXe(r,e,t,n,i,s){return I.openBlock(),I.createElementBlock("span",I.mergeProps({class:r.cx("root"),"data-p":s.dataP},r.ptmi("root")),[r.$slots.icon?(I.openBlock(),I.createBlock(I.resolveDynamicComponent(r.$slots.icon),I.mergeProps({key:0,class:r.cx("icon")},r.ptm("icon")),null,16,["class"])):r.icon?(I.openBlock(),I.createElementBlock("span",I.mergeProps({key:1,class:[r.cx("icon"),r.icon]},r.ptm("icon")),null,16)):I.createCommentVNode("",!0),r.value!=null||r.$slots.default?I.renderSlot(r.$slots,"default",{key:2},function(){return[I.createElementVNode("span",I.mergeProps({class:r.cx("label")},r.ptm("label")),I.toDisplayString(r.value),17)]}):I.createCommentVNode("",!0)],16,OXe)}Kw.render=DXe;const AL={__name:"OutageReport",__ssrInlineRender:!0,props:{reports:{type:Array,required:!0}},setup(r){const e=r,t=[{label:"Unprocessed",value:"unprocessed"},{label:"Processed (Outage)",value:"processed_as_part_of_outage"},{label:"Processed (Isolated)",value:"processed_as_isolated"},{label:"Archived",value:"archived"}],n=bT();Oze();const i=I.shallowRef([...e.reports]),s=I.ref(),a=I.ref([]),o=I.ref([]),u=()=>{s.value.exportCSV({selectionOnly:o.value.length>0})};mV("report_created",({report:k})=>{i.value=[k,...i.value]}),mV("report_deleted",({id:k})=>{i.value=i.value.filter(D=>D.id!==k)});const f=k=>{const{data:D,newData:V}=k;n.pushEvent("validate",{outage_report:{status:V.status}})},g=k=>{const{newData:D}=k;n.pushEvent("save",{id:D.id,outage_report:{status:D.status}})},y=I.computed(()=>i.value.map(k=>({...k,display_date:new Date(k.created_at).toLocaleString("en-PH",{dateStyle:"medium",timeStyle:"short"}),display_status:k.status.toString(),display_coords:k.location?`${k.location.coordinates[1].toFixed(4)}, ${k.location.coordinates[0].toFixed(4)}`:"N/A",short_id:`${k.public_id.split("-")[0]}...`}))),A=I.ref({global:{value:null,matchMode:"contains"}}),C=["description","public_id","display_status","display_date","display_coords"],M=k=>({unprocessed:"danger",investigating:"warn",resolved:"success"})[k]||"info";return(k,D,V,W)=>{D(`<div${Nue(I.mergeProps({class:"card shadow-sm h-full flex flex-col"},W))}>`),D(Fo(I.unref(fQ),{filters:A.value,"onUpdate:filters":z=>A.value=z,selection:o.value,"onUpdate:selection":z=>o.value=z,editingRows:a.value,"onUpdate:editingRows":z=>a.value=z,value:y.value,globalFilterFields:C,dataKey:"id",ref_key:"dt",ref:s,editMode:"row",onRowEditSave:g,onRowEditChange:f,scrollable:"",scrollHeight:"flex",virtualScrollerOptions:{itemSize:50},selectionMode:"multiple",stripedRows:"",removableSort:"",sortMode:"multiple",resizableColumns:"",showGridLines:"",rowHover:"",class:"flex-1 cursor-pointer text-sm"},{header:I.withCtx((z,$,te,le)=>{if($)$(`<div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 px-4 py-3"${le}><div${le}><h2 class="text-xl font-bold"${le}>Outage Report Logs</h2><div class="text-xs font-medium opacity-60"${le}>${W4(y.value.length)} Reports Loaded | ${W4(o.value.length)} Selected </div></div><div class="flex items-center gap-3"${le}><span class="relative"${le}><i class="pi pi-search absolute left-3 top-1/2 -translate-y-1/2 opacity-50"${le}></i>`),$(Fo(I.unref(mv),{modelValue:A.value.global.value,"onUpdate:modelValue":_e=>A.value.global.value=_e,placeholder:"Global Search...",class:"pl-10 h-9 w-64 md:w-80"},null,te,le)),$("</span>"),$(Fo(I.unref(wv),{label:"Export CSV",onClick:u,size:"small",disabled:y.value.length===0||o.value.length===0},null,te,le)),$("</div></div>");else return[I.createVNode("div",{class:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 px-4 py-3"},[I.createVNode("div",null,[I.createVNode("h2",{class:"text-xl font-bold"},"Outage Report Logs"),I.createVNode("div",{class:"text-xs font-medium opacity-60"},I.toDisplayString(y.value.length)+" Reports Loaded | "+I.toDisplayString(o.value.length)+" Selected ",1)]),I.createVNode("div",{class:"flex items-center gap-3"},[I.createVNode("span",{class:"relative"},[I.createVNode("i",{class:"pi pi-search absolute left-3 top-1/2 -translate-y-1/2 opacity-50"}),I.createVNode(I.unref(mv),{modelValue:A.value.global.value,"onUpdate:modelValue":_e=>A.value.global.value=_e,placeholder:"Global Search...",class:"pl-10 h-9 w-64 md:w-80"},null,8,["modelValue","onUpdate:modelValue"])]),I.createVNode(I.unref(wv),{label:"Export CSV",onClick:u,size:"small",disabled:y.value.length===0||o.value.length===0},null,8,["disabled"])])])]}),empty:I.withCtx((z,$,te,le)=>{if($)$(`<div class="p-10 text-center opacity-50"${le}>No reports match your query.</div>`);else return[I.createVNode("div",{class:"p-10 text-center opacity-50"},"No reports match your query.")]}),default:I.withCtx((z,$,te,le)=>{if($)$(Fo(I.unref(ta),{selectionMode:"multiple",headerStyle:"width: 3rem"},null,te,le)),$(Fo(I.unref(ta),{field:"short_id",header:"ID",class:"font-mono text-xs",style:{width:"10%",height:"50px"}},null,te,le)),$(Fo(I.unref(ta),{field:"description",header:"Description",style:{width:"40%",height:"50px"}},null,te,le)),$(Fo(I.unref(ta),{field:"display_status",header:"Status",sortable:"",style:{width:"10%",height:"50px"}},{body:I.withCtx(({data:_e},se,Y,ce)=>{if(se)se(Fo(I.unref(Kw),{value:_e.status,severity:M(_e.status)},null,Y,ce));else return[I.createVNode(I.unref(Kw),{value:_e.status,severity:M(_e.status)},null,8,["value","severity"])]}),editor:I.withCtx(({data:_e,field:se},Y,ce,oe)=>{if(Y)Y(Fo(I.unref(rp),{modelValue:_e[se],"onUpdate:modelValue":Me=>_e[se]=Me,options:t,optionLabel:"label",optionValue:"value",placeholder:"Select Status",fluid:"",autofocus:""},null,ce,oe));else return[I.createVNode(I.unref(rp),{modelValue:_e[se],"onUpdate:modelValue":Me=>_e[se]=Me,options:t,optionLabel:"label",optionValue:"value",placeholder:"Select Status",fluid:"",autofocus:""},null,8,["modelValue","onUpdate:modelValue"])]}),_:1},te,le)),$(Fo(I.unref(ta),{field:"display_coords",header:"Coordinates",style:{width:"20%",height:"50px"}},null,te,le)),$(Fo(I.unref(ta),{field:"display_date",header:"Time",sortable:"",style:{width:"20%",height:"50px"}},null,te,le)),$(Fo(I.unref(ta),{rowEditor:!0,headerStyle:"width: 7rem",bodyStyle:"text-align:center"},null,te,le));else return[I.createVNode(I.unref(ta),{selectionMode:"multiple",headerStyle:"width: 3rem"}),I.createVNode(I.unref(ta),{field:"short_id",header:"ID",class:"font-mono text-xs",style:{width:"10%",height:"50px"}}),I.createVNode(I.unref(ta),{field:"description",header:"Description",style:{width:"40%",height:"50px"}}),I.createVNode(I.unref(ta),{field:"display_status",header:"Status",sortable:"",style:{width:"10%",height:"50px"}},{body:I.withCtx(({data:_e})=>[I.createVNode(I.unref(Kw),{value:_e.status,severity:M(_e.status)},null,8,["value","severity"])]),editor:I.withCtx(({data:_e,field:se})=>[I.createVNode(I.unref(rp),{modelValue:_e[se],"onUpdate:modelValue":Y=>_e[se]=Y,options:t,optionLabel:"label",optionValue:"value",placeholder:"Select Status",fluid:"",autofocus:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),I.createVNode(I.unref(ta),{field:"display_coords",header:"Coordinates",style:{width:"20%",height:"50px"}}),I.createVNode(I.unref(ta),{field:"display_date",header:"Time",sortable:"",style:{width:"20%",height:"50px"}}),I.createVNode(I.unref(ta),{rowEditor:!0,headerStyle:"width: 7rem",bodyStyle:"text-align:center"})]}),_:1},V)),D("</div>")}}},E$=AL.setup;AL.setup=(r,e)=>{const t=I.useSSRContext();return(t.modules||(t.modules=new Set)).add("vue/OutageReport.vue"),E$?E$(r,e):void 0};const LXe=Object.freeze(Object.defineProperty({__proto__:null,default:AL},Symbol.toStringTag,{value:"Module"}));function Uv(r){"@babel/helpers - typeof";return Uv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uv(r)}function I$(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function rw(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?I$(Object(t),!0).forEach(function(n){NXe(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):I$(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function NXe(r,e,t){return(e=FXe(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function FXe(r){var e=UXe(r,"string");return Uv(e)=="symbol"?e:e+""}function UXe(r,e){if(Uv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(Uv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var zXe={ripple:!1,inputStyle:null,inputVariant:null,locale:{startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",completed:"Completed",pending:"Pending",fileSizeTypes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],chooseYear:"Choose Year",chooseMonth:"Choose Month",chooseDate:"Choose Date",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",prevHour:"Previous Hour",nextHour:"Next Hour",prevMinute:"Previous Minute",nextMinute:"Next Minute",prevSecond:"Previous Second",nextSecond:"Next Second",am:"am",pm:"pm",today:"Today",weekHeader:"Wk",firstDayOfWeek:0,showMonthAfterYear:!1,dateFormat:"mm/dd/yy",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyFilterMessage:"No results found",searchMessage:"{0} results are available",selectionMessage:"{0} items selected",emptySelectionMessage:"No selected item",emptySearchMessage:"No results found",fileChosenMessage:"{0} files",noFileChosenMessage:"No file chosen",emptyMessage:"No available options",aria:{trueLabel:"True",falseLabel:"False",nullLabel:"Not Selected",star:"1 star",stars:"{star} stars",selectAll:"All items selected",unselectAll:"All items unselected",close:"Close",previous:"Previous",next:"Next",navigation:"Navigation",scrollTop:"Scroll Top",moveTop:"Move Top",moveUp:"Move Up",moveDown:"Move Down",moveBottom:"Move Bottom",moveToTarget:"Move to Target",moveToSource:"Move to Source",moveAllToTarget:"Move All to Target",moveAllToSource:"Move All to Source",pageLabel:"Page {page}",firstPageLabel:"First Page",lastPageLabel:"Last Page",nextPageLabel:"Next Page",prevPageLabel:"Previous Page",rowsPerPageLabel:"Rows per page",jumpToPageDropdownLabel:"Jump to Page Dropdown",jumpToPageInputLabel:"Jump to Page Input",selectRow:"Row Selected",unselectRow:"Row Unselected",expandRow:"Row Expanded",collapseRow:"Row Collapsed",showFilterMenu:"Show Filter Menu",hideFilterMenu:"Hide Filter Menu",filterOperator:"Filter Operator",filterConstraint:"Filter Constraint",editRow:"Row Edit",saveEdit:"Save Edit",cancelEdit:"Cancel Edit",listView:"List View",gridView:"Grid View",slide:"Slide",slideNumber:"{slideNumber}",zoomImage:"Zoom Image",zoomIn:"Zoom In",zoomOut:"Zoom Out",rotateRight:"Rotate Right",rotateLeft:"Rotate Left",listLabel:"Option List"}},filterMatchModeOptions:{text:[Fs.STARTS_WITH,Fs.CONTAINS,Fs.NOT_CONTAINS,Fs.ENDS_WITH,Fs.EQUALS,Fs.NOT_EQUALS],numeric:[Fs.EQUALS,Fs.NOT_EQUALS,Fs.LESS_THAN,Fs.LESS_THAN_OR_EQUAL_TO,Fs.GREATER_THAN,Fs.GREATER_THAN_OR_EQUAL_TO],date:[Fs.DATE_IS,Fs.DATE_IS_NOT,Fs.DATE_BEFORE,Fs.DATE_AFTER]},zIndex:{modal:1100,overlay:1e3,menu:1e3,tooltip:1100},theme:void 0,unstyled:!1,pt:void 0,ptOptions:{mergeSections:!0,mergeProps:!1},csp:{nonce:void 0}},VXe=Symbol();function $Xe(r,e){var t={config:I.reactive(e)};return r.config.globalProperties.$primevue=t,r.provide(VXe,t),jXe(),GXe(r,t),t}var Em=[];function jXe(){eo.clear(),Em.forEach(function(r){return r?.()}),Em=[]}function GXe(r,e){var t=I.ref(!1),n=function(){var f;if(((f=e.config)===null||f===void 0?void 0:f.theme)!=="none"&&!ei.isStyleNameLoaded("common")){var g,y,A=((g=cn.getCommonTheme)===null||g===void 0?void 0:g.call(cn))||{},C=A.primitive,M=A.semantic,k=A.global,D=A.style,V={nonce:(y=e.config)===null||y===void 0||(y=y.csp)===null||y===void 0?void 0:y.nonce};cn.load(C?.css,rw({name:"primitive-variables"},V)),cn.load(M?.css,rw({name:"semantic-variables"},V)),cn.load(k?.css,rw({name:"global-variables"},V)),cn.loadStyle(rw({name:"global-style"},V),D),ei.setLoadedStyleName("common")}};eo.on("theme:change",function(u){t.value||(r.config.globalProperties.$primevue.config.theme=u,t.value=!0)});var i=I.watch(e.config,function(u,f){ud.emit("config:change",{newValue:u,oldValue:f})},{immediate:!0,deep:!0}),s=I.watch(function(){return e.config.ripple},function(u,f){ud.emit("config:ripple:change",{newValue:u,oldValue:f})},{immediate:!0,deep:!0}),a=I.watch(function(){return e.config.theme},function(u,f){t.value||ei.setTheme(u),e.config.unstyled||n(),t.value=!1,ud.emit("config:theme:change",{newValue:u,oldValue:f})},{immediate:!0,deep:!1}),o=I.watch(function(){return e.config.unstyled},function(u,f){!u&&e.config.theme&&n(),ud.emit("config:unstyled:change",{newValue:u,oldValue:f})},{immediate:!0,deep:!0});Em.push(i),Em.push(s),Em.push(a),Em.push(o)}var HXe={install:function(e,t){var n=iVe(zXe,t);$Xe(e,n)}},WXe={transitionDuration:"{transition.duration}"},KXe={borderWidth:"0 0 1px 0",borderColor:"{content.border.color}"},XXe={color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{text.color}",activeHoverColor:"{text.color}",padding:"1.125rem",fontWeight:"600",borderRadius:"0",borderWidth:"0",borderColor:"{content.border.color}",background:"{content.background}",hoverBackground:"{content.background}",activeBackground:"{content.background}",activeHoverBackground:"{content.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},toggleIcon:{color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{text.color}",activeHoverColor:"{text.color}"},first:{topBorderRadius:"{content.border.radius}",borderWidth:"0"},last:{bottomBorderRadius:"{content.border.radius}",activeBottomBorderRadius:"0"}},JXe={borderWidth:"0",borderColor:"{content.border.color}",background:"{content.background}",color:"{text.color}",padding:"0 1.125rem 1.125rem 1.125rem"},qXe={root:WXe,panel:KXe,header:XXe,content:JXe},YXe={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}"},ZXe={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},QXe={padding:"{list.padding}",gap:"{list.gap}"},eJe={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},tJe={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},rJe={width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"},borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},nJe={borderRadius:"{border.radius.sm}"},iJe={padding:"{list.option.padding}"},sJe={light:{chip:{focusBackground:"{surface.200}",focusColor:"{surface.800}"},dropdown:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}"}},dark:{chip:{focusBackground:"{surface.700}",focusColor:"{surface.0}"},dropdown:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}"}}},oJe={root:YXe,overlay:ZXe,list:QXe,option:eJe,optionGroup:tJe,dropdown:rJe,chip:nJe,emptyMessage:iJe,colorScheme:sJe},aJe={width:"2rem",height:"2rem",fontSize:"1rem",background:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"},lJe={size:"1rem"},cJe={borderColor:"{content.background}",offset:"-0.75rem"},uJe={width:"3rem",height:"3rem",fontSize:"1.5rem",icon:{size:"1.5rem"},group:{offset:"-1rem"}},hJe={width:"4rem",height:"4rem",fontSize:"2rem",icon:{size:"2rem"},group:{offset:"-1.5rem"}},dJe={root:aJe,icon:lJe,group:cJe,lg:uJe,xl:hJe},fJe={borderRadius:"{border.radius.md}",padding:"0 0.5rem",fontSize:"0.75rem",fontWeight:"700",minWidth:"1.5rem",height:"1.5rem"},pJe={size:"0.5rem"},gJe={fontSize:"0.625rem",minWidth:"1.25rem",height:"1.25rem"},mJe={fontSize:"0.875rem",minWidth:"1.75rem",height:"1.75rem"},yJe={fontSize:"1rem",minWidth:"2rem",height:"2rem"},bJe={light:{primary:{background:"{primary.color}",color:"{primary.contrast.color}"},secondary:{background:"{surface.100}",color:"{surface.600}"},success:{background:"{green.500}",color:"{surface.0}"},info:{background:"{sky.500}",color:"{surface.0}"},warn:{background:"{orange.500}",color:"{surface.0}"},danger:{background:"{red.500}",color:"{surface.0}"},contrast:{background:"{surface.950}",color:"{surface.0}"}},dark:{primary:{background:"{primary.color}",color:"{primary.contrast.color}"},secondary:{background:"{surface.800}",color:"{surface.300}"},success:{background:"{green.400}",color:"{green.950}"},info:{background:"{sky.400}",color:"{sky.950}"},warn:{background:"{orange.400}",color:"{orange.950}"},danger:{background:"{red.400}",color:"{red.950}"},contrast:{background:"{surface.0}",color:"{surface.950}"}}},_Je={root:fJe,dot:pJe,sm:gJe,lg:mJe,xl:yJe,colorScheme:bJe},vJe={borderRadius:{none:"0",xs:"2px",sm:"4px",md:"6px",lg:"8px",xl:"12px"},emerald:{50:"#ecfdf5",100:"#d1fae5",200:"#a7f3d0",300:"#6ee7b7",400:"#34d399",500:"#10b981",600:"#059669",700:"#047857",800:"#065f46",900:"#064e3b",950:"#022c22"},green:{50:"#f0fdf4",100:"#dcfce7",200:"#bbf7d0",300:"#86efac",400:"#4ade80",500:"#22c55e",600:"#16a34a",700:"#15803d",800:"#166534",900:"#14532d",950:"#052e16"},lime:{50:"#f7fee7",100:"#ecfccb",200:"#d9f99d",300:"#bef264",400:"#a3e635",500:"#84cc16",600:"#65a30d",700:"#4d7c0f",800:"#3f6212",900:"#365314",950:"#1a2e05"},red:{50:"#fef2f2",100:"#fee2e2",200:"#fecaca",300:"#fca5a5",400:"#f87171",500:"#ef4444",600:"#dc2626",700:"#b91c1c",800:"#991b1b",900:"#7f1d1d",950:"#450a0a"},orange:{50:"#fff7ed",100:"#ffedd5",200:"#fed7aa",300:"#fdba74",400:"#fb923c",500:"#f97316",600:"#ea580c",700:"#c2410c",800:"#9a3412",900:"#7c2d12",950:"#431407"},amber:{50:"#fffbeb",100:"#fef3c7",200:"#fde68a",300:"#fcd34d",400:"#fbbf24",500:"#f59e0b",600:"#d97706",700:"#b45309",800:"#92400e",900:"#78350f",950:"#451a03"},yellow:{50:"#fefce8",100:"#fef9c3",200:"#fef08a",300:"#fde047",400:"#facc15",500:"#eab308",600:"#ca8a04",700:"#a16207",800:"#854d0e",900:"#713f12",950:"#422006"},teal:{50:"#f0fdfa",100:"#ccfbf1",200:"#99f6e4",300:"#5eead4",400:"#2dd4bf",500:"#14b8a6",600:"#0d9488",700:"#0f766e",800:"#115e59",900:"#134e4a",950:"#042f2e"},cyan:{50:"#ecfeff",100:"#cffafe",200:"#a5f3fc",300:"#67e8f9",400:"#22d3ee",500:"#06b6d4",600:"#0891b2",700:"#0e7490",800:"#155e75",900:"#164e63",950:"#083344"},sky:{50:"#f0f9ff",100:"#e0f2fe",200:"#bae6fd",300:"#7dd3fc",400:"#38bdf8",500:"#0ea5e9",600:"#0284c7",700:"#0369a1",800:"#075985",900:"#0c4a6e",950:"#082f49"},blue:{50:"#eff6ff",100:"#dbeafe",200:"#bfdbfe",300:"#93c5fd",400:"#60a5fa",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8",800:"#1e40af",900:"#1e3a8a",950:"#172554"},indigo:{50:"#eef2ff",100:"#e0e7ff",200:"#c7d2fe",300:"#a5b4fc",400:"#818cf8",500:"#6366f1",600:"#4f46e5",700:"#4338ca",800:"#3730a3",900:"#312e81",950:"#1e1b4b"},violet:{50:"#f5f3ff",100:"#ede9fe",200:"#ddd6fe",300:"#c4b5fd",400:"#a78bfa",500:"#8b5cf6",600:"#7c3aed",700:"#6d28d9",800:"#5b21b6",900:"#4c1d95",950:"#2e1065"},purple:{50:"#faf5ff",100:"#f3e8ff",200:"#e9d5ff",300:"#d8b4fe",400:"#c084fc",500:"#a855f7",600:"#9333ea",700:"#7e22ce",800:"#6b21a8",900:"#581c87",950:"#3b0764"},fuchsia:{50:"#fdf4ff",100:"#fae8ff",200:"#f5d0fe",300:"#f0abfc",400:"#e879f9",500:"#d946ef",600:"#c026d3",700:"#a21caf",800:"#86198f",900:"#701a75",950:"#4a044e"},pink:{50:"#fdf2f8",100:"#fce7f3",200:"#fbcfe8",300:"#f9a8d4",400:"#f472b6",500:"#ec4899",600:"#db2777",700:"#be185d",800:"#9d174d",900:"#831843",950:"#500724"},rose:{50:"#fff1f2",100:"#ffe4e6",200:"#fecdd3",300:"#fda4af",400:"#fb7185",500:"#f43f5e",600:"#e11d48",700:"#be123c",800:"#9f1239",900:"#881337",950:"#4c0519"},slate:{50:"#f8fafc",100:"#f1f5f9",200:"#e2e8f0",300:"#cbd5e1",400:"#94a3b8",500:"#64748b",600:"#475569",700:"#334155",800:"#1e293b",900:"#0f172a",950:"#020617"},gray:{50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",300:"#d1d5db",400:"#9ca3af",500:"#6b7280",600:"#4b5563",700:"#374151",800:"#1f2937",900:"#111827",950:"#030712"},zinc:{50:"#fafafa",100:"#f4f4f5",200:"#e4e4e7",300:"#d4d4d8",400:"#a1a1aa",500:"#71717a",600:"#52525b",700:"#3f3f46",800:"#27272a",900:"#18181b",950:"#09090b"},neutral:{50:"#fafafa",100:"#f5f5f5",200:"#e5e5e5",300:"#d4d4d4",400:"#a3a3a3",500:"#737373",600:"#525252",700:"#404040",800:"#262626",900:"#171717",950:"#0a0a0a"},stone:{50:"#fafaf9",100:"#f5f5f4",200:"#e7e5e4",300:"#d6d3d1",400:"#a8a29e",500:"#78716c",600:"#57534e",700:"#44403c",800:"#292524",900:"#1c1917",950:"#0c0a09"}},AJe={transitionDuration:"0.2s",focusRing:{width:"1px",style:"solid",color:"{primary.color}",offset:"2px",shadow:"none"},disabledOpacity:"0.6",iconSize:"1rem",anchorGutter:"2px",primary:{50:"{emerald.50}",100:"{emerald.100}",200:"{emerald.200}",300:"{emerald.300}",400:"{emerald.400}",500:"{emerald.500}",600:"{emerald.600}",700:"{emerald.700}",800:"{emerald.800}",900:"{emerald.900}",950:"{emerald.950}"},formField:{paddingX:"0.75rem",paddingY:"0.5rem",sm:{fontSize:"0.875rem",paddingX:"0.625rem",paddingY:"0.375rem"},lg:{fontSize:"1.125rem",paddingX:"0.875rem",paddingY:"0.625rem"},borderRadius:"{border.radius.md}",focusRing:{width:"0",style:"none",color:"transparent",offset:"0",shadow:"none"},transitionDuration:"{transition.duration}"},list:{padding:"0.25rem 0.25rem",gap:"2px",header:{padding:"0.5rem 1rem 0.25rem 1rem"},option:{padding:"0.5rem 0.75rem",borderRadius:"{border.radius.sm}"},optionGroup:{padding:"0.5rem 0.75rem",fontWeight:"600"}},content:{borderRadius:"{border.radius.md}"},mask:{transitionDuration:"0.3s"},navigation:{list:{padding:"0.25rem 0.25rem",gap:"2px"},item:{padding:"0.5rem 0.75rem",borderRadius:"{border.radius.sm}",gap:"0.5rem"},submenuLabel:{padding:"0.5rem 0.75rem",fontWeight:"600"},submenuIcon:{size:"0.875rem"}},overlay:{select:{borderRadius:"{border.radius.md}",shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"},popover:{borderRadius:"{border.radius.md}",padding:"0.75rem",shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"},modal:{borderRadius:"{border.radius.xl}",padding:"1.25rem",shadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1)"},navigation:{shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"}},colorScheme:{light:{surface:{0:"#ffffff",50:"{slate.50}",100:"{slate.100}",200:"{slate.200}",300:"{slate.300}",400:"{slate.400}",500:"{slate.500}",600:"{slate.600}",700:"{slate.700}",800:"{slate.800}",900:"{slate.900}",950:"{slate.950}"},primary:{color:"{primary.500}",contrastColor:"#ffffff",hoverColor:"{primary.600}",activeColor:"{primary.700}"},highlight:{background:"{primary.50}",focusBackground:"{primary.100}",color:"{primary.700}",focusColor:"{primary.800}"},mask:{background:"rgba(0,0,0,0.4)",color:"{surface.200}"},formField:{background:"{surface.0}",disabledBackground:"{surface.200}",filledBackground:"{surface.50}",filledHoverBackground:"{surface.50}",filledFocusBackground:"{surface.50}",borderColor:"{surface.300}",hoverBorderColor:"{surface.400}",focusBorderColor:"{primary.color}",invalidBorderColor:"{red.400}",color:"{surface.700}",disabledColor:"{surface.500}",placeholderColor:"{surface.500}",invalidPlaceholderColor:"{red.600}",floatLabelColor:"{surface.500}",floatLabelFocusColor:"{primary.600}",floatLabelActiveColor:"{surface.500}",floatLabelInvalidColor:"{form.field.invalid.placeholder.color}",iconColor:"{surface.400}",shadow:"0 0 #0000, 0 0 #0000, 0 1px 2px 0 rgba(18, 18, 23, 0.05)"},text:{color:"{surface.700}",hoverColor:"{surface.800}",mutedColor:"{surface.500}",hoverMutedColor:"{surface.600}"},content:{background:"{surface.0}",hoverBackground:"{surface.100}",borderColor:"{surface.200}",color:"{text.color}",hoverColor:"{text.hover.color}"},overlay:{select:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"},popover:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"},modal:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"}},list:{option:{focusBackground:"{surface.100}",selectedBackground:"{highlight.background}",selectedFocusBackground:"{highlight.focus.background}",color:"{text.color}",focusColor:"{text.hover.color}",selectedColor:"{highlight.color}",selectedFocusColor:"{highlight.focus.color}",icon:{color:"{surface.400}",focusColor:"{surface.500}"}},optionGroup:{background:"transparent",color:"{text.muted.color}"}},navigation:{item:{focusBackground:"{surface.100}",activeBackground:"{surface.100}",color:"{text.color}",focusColor:"{text.hover.color}",activeColor:"{text.hover.color}",icon:{color:"{surface.400}",focusColor:"{surface.500}",activeColor:"{surface.500}"}},submenuLabel:{background:"transparent",color:"{text.muted.color}"},submenuIcon:{color:"{surface.400}",focusColor:"{surface.500}",activeColor:"{surface.500}"}}},dark:{surface:{0:"#ffffff",50:"{zinc.50}",100:"{zinc.100}",200:"{zinc.200}",300:"{zinc.300}",400:"{zinc.400}",500:"{zinc.500}",600:"{zinc.600}",700:"{zinc.700}",800:"{zinc.800}",900:"{zinc.900}",950:"{zinc.950}"},primary:{color:"{primary.400}",contrastColor:"{surface.900}",hoverColor:"{primary.300}",activeColor:"{primary.200}"},highlight:{background:"color-mix(in srgb, {primary.400}, transparent 84%)",focusBackground:"color-mix(in srgb, {primary.400}, transparent 76%)",color:"rgba(255,255,255,.87)",focusColor:"rgba(255,255,255,.87)"},mask:{background:"rgba(0,0,0,0.6)",color:"{surface.200}"},formField:{background:"{surface.950}",disabledBackground:"{surface.700}",filledBackground:"{surface.800}",filledHoverBackground:"{surface.800}",filledFocusBackground:"{surface.800}",borderColor:"{surface.600}",hoverBorderColor:"{surface.500}",focusBorderColor:"{primary.color}",invalidBorderColor:"{red.300}",color:"{surface.0}",disabledColor:"{surface.400}",placeholderColor:"{surface.400}",invalidPlaceholderColor:"{red.400}",floatLabelColor:"{surface.400}",floatLabelFocusColor:"{primary.color}",floatLabelActiveColor:"{surface.400}",floatLabelInvalidColor:"{form.field.invalid.placeholder.color}",iconColor:"{surface.400}",shadow:"0 0 #0000, 0 0 #0000, 0 1px 2px 0 rgba(18, 18, 23, 0.05)"},text:{color:"{surface.0}",hoverColor:"{surface.0}",mutedColor:"{surface.400}",hoverMutedColor:"{surface.300}"},content:{background:"{surface.900}",hoverBackground:"{surface.800}",borderColor:"{surface.700}",color:"{text.color}",hoverColor:"{text.hover.color}"},overlay:{select:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"},popover:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"},modal:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"}},list:{option:{focusBackground:"{surface.800}",selectedBackground:"{highlight.background}",selectedFocusBackground:"{highlight.focus.background}",color:"{text.color}",focusColor:"{text.hover.color}",selectedColor:"{highlight.color}",selectedFocusColor:"{highlight.focus.color}",icon:{color:"{surface.500}",focusColor:"{surface.400}"}},optionGroup:{background:"transparent",color:"{text.muted.color}"}},navigation:{item:{focusBackground:"{surface.800}",activeBackground:"{surface.800}",color:"{text.color}",focusColor:"{text.hover.color}",activeColor:"{text.hover.color}",icon:{color:"{surface.500}",focusColor:"{surface.400}",activeColor:"{surface.400}"}},submenuLabel:{background:"transparent",color:"{text.muted.color}"},submenuIcon:{color:"{surface.500}",focusColor:"{surface.400}",activeColor:"{surface.400}"}}}}},xJe={primitive:vJe,semantic:AJe},wJe={borderRadius:"{content.border.radius}"},CJe={root:wJe},TJe={padding:"1rem",background:"{content.background}",gap:"0.5rem",transitionDuration:"{transition.duration}"},SJe={color:"{text.muted.color}",hoverColor:"{text.color}",borderRadius:"{content.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",hoverColor:"{navigation.item.icon.focus.color}"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},EJe={color:"{navigation.item.icon.color}"},IJe={root:TJe,item:SJe,separator:EJe},PJe={borderRadius:"{form.field.border.radius}",roundedBorderRadius:"2rem",gap:"0.5rem",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",iconOnlyWidth:"2.5rem",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}",iconOnlyWidth:"2rem"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}",iconOnlyWidth:"3rem"},label:{fontWeight:"500"},raisedShadow:"0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"},badgeSize:"1rem",transitionDuration:"{form.field.transition.duration}"},BJe={light:{root:{primary:{background:"{primary.color}",hoverBackground:"{primary.hover.color}",activeBackground:"{primary.active.color}",borderColor:"{primary.color}",hoverBorderColor:"{primary.hover.color}",activeBorderColor:"{primary.active.color}",color:"{primary.contrast.color}",hoverColor:"{primary.contrast.color}",activeColor:"{primary.contrast.color}",focusRing:{color:"{primary.color}",shadow:"none"}},secondary:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",borderColor:"{surface.100}",hoverBorderColor:"{surface.200}",activeBorderColor:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}",focusRing:{color:"{surface.600}",shadow:"none"}},info:{background:"{sky.500}",hoverBackground:"{sky.600}",activeBackground:"{sky.700}",borderColor:"{sky.500}",hoverBorderColor:"{sky.600}",activeBorderColor:"{sky.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{sky.500}",shadow:"none"}},success:{background:"{green.500}",hoverBackground:"{green.600}",activeBackground:"{green.700}",borderColor:"{green.500}",hoverBorderColor:"{green.600}",activeBorderColor:"{green.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{green.500}",shadow:"none"}},warn:{background:"{orange.500}",hoverBackground:"{orange.600}",activeBackground:"{orange.700}",borderColor:"{orange.500}",hoverBorderColor:"{orange.600}",activeBorderColor:"{orange.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{orange.500}",shadow:"none"}},help:{background:"{purple.500}",hoverBackground:"{purple.600}",activeBackground:"{purple.700}",borderColor:"{purple.500}",hoverBorderColor:"{purple.600}",activeBorderColor:"{purple.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{purple.500}",shadow:"none"}},danger:{background:"{red.500}",hoverBackground:"{red.600}",activeBackground:"{red.700}",borderColor:"{red.500}",hoverBorderColor:"{red.600}",activeBorderColor:"{red.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{red.500}",shadow:"none"}},contrast:{background:"{surface.950}",hoverBackground:"{surface.900}",activeBackground:"{surface.800}",borderColor:"{surface.950}",hoverBorderColor:"{surface.900}",activeBorderColor:"{surface.800}",color:"{surface.0}",hoverColor:"{surface.0}",activeColor:"{surface.0}",focusRing:{color:"{surface.950}",shadow:"none"}}},outlined:{primary:{hoverBackground:"{primary.50}",activeBackground:"{primary.100}",borderColor:"{primary.200}",color:"{primary.color}"},secondary:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.200}",color:"{surface.500}"},success:{hoverBackground:"{green.50}",activeBackground:"{green.100}",borderColor:"{green.200}",color:"{green.500}"},info:{hoverBackground:"{sky.50}",activeBackground:"{sky.100}",borderColor:"{sky.200}",color:"{sky.500}"},warn:{hoverBackground:"{orange.50}",activeBackground:"{orange.100}",borderColor:"{orange.200}",color:"{orange.500}"},help:{hoverBackground:"{purple.50}",activeBackground:"{purple.100}",borderColor:"{purple.200}",color:"{purple.500}"},danger:{hoverBackground:"{red.50}",activeBackground:"{red.100}",borderColor:"{red.200}",color:"{red.500}"},contrast:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.700}",color:"{surface.950}"},plain:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.200}",color:"{surface.700}"}},text:{primary:{hoverBackground:"{primary.50}",activeBackground:"{primary.100}",color:"{primary.color}"},secondary:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.500}"},success:{hoverBackground:"{green.50}",activeBackground:"{green.100}",color:"{green.500}"},info:{hoverBackground:"{sky.50}",activeBackground:"{sky.100}",color:"{sky.500}"},warn:{hoverBackground:"{orange.50}",activeBackground:"{orange.100}",color:"{orange.500}"},help:{hoverBackground:"{purple.50}",activeBackground:"{purple.100}",color:"{purple.500}"},danger:{hoverBackground:"{red.50}",activeBackground:"{red.100}",color:"{red.500}"},contrast:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.950}"},plain:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.700}"}},link:{color:"{primary.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"}},dark:{root:{primary:{background:"{primary.color}",hoverBackground:"{primary.hover.color}",activeBackground:"{primary.active.color}",borderColor:"{primary.color}",hoverBorderColor:"{primary.hover.color}",activeBorderColor:"{primary.active.color}",color:"{primary.contrast.color}",hoverColor:"{primary.contrast.color}",activeColor:"{primary.contrast.color}",focusRing:{color:"{primary.color}",shadow:"none"}},secondary:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",borderColor:"{surface.800}",hoverBorderColor:"{surface.700}",activeBorderColor:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}",focusRing:{color:"{surface.300}",shadow:"none"}},info:{background:"{sky.400}",hoverBackground:"{sky.300}",activeBackground:"{sky.200}",borderColor:"{sky.400}",hoverBorderColor:"{sky.300}",activeBorderColor:"{sky.200}",color:"{sky.950}",hoverColor:"{sky.950}",activeColor:"{sky.950}",focusRing:{color:"{sky.400}",shadow:"none"}},success:{background:"{green.400}",hoverBackground:"{green.300}",activeBackground:"{green.200}",borderColor:"{green.400}",hoverBorderColor:"{green.300}",activeBorderColor:"{green.200}",color:"{green.950}",hoverColor:"{green.950}",activeColor:"{green.950}",focusRing:{color:"{green.400}",shadow:"none"}},warn:{background:"{orange.400}",hoverBackground:"{orange.300}",activeBackground:"{orange.200}",borderColor:"{orange.400}",hoverBorderColor:"{orange.300}",activeBorderColor:"{orange.200}",color:"{orange.950}",hoverColor:"{orange.950}",activeColor:"{orange.950}",focusRing:{color:"{orange.400}",shadow:"none"}},help:{background:"{purple.400}",hoverBackground:"{purple.300}",activeBackground:"{purple.200}",borderColor:"{purple.400}",hoverBorderColor:"{purple.300}",activeBorderColor:"{purple.200}",color:"{purple.950}",hoverColor:"{purple.950}",activeColor:"{purple.950}",focusRing:{color:"{purple.400}",shadow:"none"}},danger:{background:"{red.400}",hoverBackground:"{red.300}",activeBackground:"{red.200}",borderColor:"{red.400}",hoverBorderColor:"{red.300}",activeBorderColor:"{red.200}",color:"{red.950}",hoverColor:"{red.950}",activeColor:"{red.950}",focusRing:{color:"{red.400}",shadow:"none"}},contrast:{background:"{surface.0}",hoverBackground:"{surface.100}",activeBackground:"{surface.200}",borderColor:"{surface.0}",hoverBorderColor:"{surface.100}",activeBorderColor:"{surface.200}",color:"{surface.950}",hoverColor:"{surface.950}",activeColor:"{surface.950}",focusRing:{color:"{surface.0}",shadow:"none"}}},outlined:{primary:{hoverBackground:"color-mix(in srgb, {primary.color}, transparent 96%)",activeBackground:"color-mix(in srgb, {primary.color}, transparent 84%)",borderColor:"{primary.700}",color:"{primary.color}"},secondary:{hoverBackground:"rgba(255,255,255,0.04)",activeBackground:"rgba(255,255,255,0.16)",borderColor:"{surface.700}",color:"{surface.400}"},success:{hoverBackground:"color-mix(in srgb, {green.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {green.400}, transparent 84%)",borderColor:"{green.700}",color:"{green.400}"},info:{hoverBackground:"color-mix(in srgb, {sky.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {sky.400}, transparent 84%)",borderColor:"{sky.700}",color:"{sky.400}"},warn:{hoverBackground:"color-mix(in srgb, {orange.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {orange.400}, transparent 84%)",borderColor:"{orange.700}",color:"{orange.400}"},help:{hoverBackground:"color-mix(in srgb, {purple.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {purple.400}, transparent 84%)",borderColor:"{purple.700}",color:"{purple.400}"},danger:{hoverBackground:"color-mix(in srgb, {red.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {red.400}, transparent 84%)",borderColor:"{red.700}",color:"{red.400}"},contrast:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{surface.500}",color:"{surface.0}"},plain:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{surface.600}",color:"{surface.0}"}},text:{primary:{hoverBackground:"color-mix(in srgb, {primary.color}, transparent 96%)",activeBackground:"color-mix(in srgb, {primary.color}, transparent 84%)",color:"{primary.color}"},secondary:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.400}"},success:{hoverBackground:"color-mix(in srgb, {green.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {green.400}, transparent 84%)",color:"{green.400}"},info:{hoverBackground:"color-mix(in srgb, {sky.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {sky.400}, transparent 84%)",color:"{sky.400}"},warn:{hoverBackground:"color-mix(in srgb, {orange.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {orange.400}, transparent 84%)",color:"{orange.400}"},help:{hoverBackground:"color-mix(in srgb, {purple.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {purple.400}, transparent 84%)",color:"{purple.400}"},danger:{hoverBackground:"color-mix(in srgb, {red.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {red.400}, transparent 84%)",color:"{red.400}"},contrast:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.0}"},plain:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.0}"}},link:{color:"{primary.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"}}},MJe={root:PJe,colorScheme:BJe},RJe={background:"{content.background}",borderRadius:"{border.radius.xl}",color:"{content.color}",shadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1)"},kJe={padding:"1.25rem",gap:"0.5rem"},OJe={gap:"0.5rem"},DJe={fontSize:"1.25rem",fontWeight:"500"},LJe={color:"{text.muted.color}"},NJe={root:RJe,body:kJe,caption:OJe,title:DJe,subtitle:LJe},FJe={transitionDuration:"{transition.duration}"},UJe={gap:"0.25rem"},zJe={padding:"1rem",gap:"0.5rem"},VJe={width:"2rem",height:"0.5rem",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},$Je={light:{indicator:{background:"{surface.200}",hoverBackground:"{surface.300}",activeBackground:"{primary.color}"}},dark:{indicator:{background:"{surface.700}",hoverBackground:"{surface.600}",activeBackground:"{primary.color}"}}},jJe={root:FJe,content:UJe,indicatorList:zJe,indicator:VJe,colorScheme:$Je},GJe={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},HJe={width:"2.5rem",color:"{form.field.icon.color}"},WJe={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},KJe={padding:"{list.padding}",gap:"{list.gap}",mobileIndent:"1rem"},XJe={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}",icon:{color:"{list.option.icon.color}",focusColor:"{list.option.icon.focus.color}",size:"0.875rem"}},JJe={color:"{form.field.icon.color}"},qJe={root:GJe,dropdown:HJe,overlay:WJe,list:KJe,option:XJe,clearIcon:JJe},YJe={borderRadius:"{border.radius.sm}",width:"1.25rem",height:"1.25rem",background:"{form.field.background}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.border.color}",checkedBorderColor:"{primary.color}",checkedHoverBorderColor:"{primary.hover.color}",checkedFocusBorderColor:"{primary.color}",checkedDisabledBorderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{width:"1rem",height:"1rem"},lg:{width:"1.5rem",height:"1.5rem"}},ZJe={size:"0.875rem",color:"{form.field.color}",checkedColor:"{primary.contrast.color}",checkedHoverColor:"{primary.contrast.color}",disabledColor:"{form.field.disabled.color}",sm:{size:"0.75rem"},lg:{size:"1rem"}},QJe={root:YJe,icon:ZJe},eqe={borderRadius:"16px",paddingX:"0.75rem",paddingY:"0.5rem",gap:"0.5rem",transitionDuration:"{transition.duration}"},tqe={width:"2rem",height:"2rem"},rqe={size:"1rem"},nqe={size:"1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"}},iqe={light:{root:{background:"{surface.100}",color:"{surface.800}"},icon:{color:"{surface.800}"},removeIcon:{color:"{surface.800}"}},dark:{root:{background:"{surface.800}",color:"{surface.0}"},icon:{color:"{surface.0}"},removeIcon:{color:"{surface.0}"}}},sqe={root:eqe,image:tqe,icon:rqe,removeIcon:nqe,colorScheme:iqe},oqe={transitionDuration:"{transition.duration}"},aqe={width:"1.5rem",height:"1.5rem",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},lqe={shadow:"{overlay.popover.shadow}",borderRadius:"{overlay.popover.borderRadius}"},cqe={light:{panel:{background:"{surface.800}",borderColor:"{surface.900}"},handle:{color:"{surface.0}"}},dark:{panel:{background:"{surface.900}",borderColor:"{surface.700}"},handle:{color:"{surface.0}"}}},uqe={root:oqe,preview:aqe,panel:lqe,colorScheme:cqe},hqe={size:"2rem",color:"{overlay.modal.color}"},dqe={gap:"1rem"},fqe={icon:hqe,content:dqe},pqe={background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",color:"{overlay.popover.color}",borderRadius:"{overlay.popover.border.radius}",shadow:"{overlay.popover.shadow}",gutter:"10px",arrowOffset:"1.25rem"},gqe={padding:"{overlay.popover.padding}",gap:"1rem"},mqe={size:"1.5rem",color:"{overlay.popover.color}"},yqe={gap:"0.5rem",padding:"0 {overlay.popover.padding} {overlay.popover.padding} {overlay.popover.padding}"},bqe={root:pqe,content:gqe,icon:mqe,footer:yqe},_qe={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},vqe={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},Aqe={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},xqe={mobileIndent:"1rem"},wqe={size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},Cqe={borderColor:"{content.border.color}"},Tqe={root:_qe,list:vqe,item:Aqe,submenu:xqe,submenuIcon:wqe,separator:Cqe},Sqe={transitionDuration:"{transition.duration}"},Eqe={background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},Iqe={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{datatable.border.color}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",gap:"0.5rem",padding:"0.75rem 1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},Pqe={fontWeight:"600"},Bqe={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},Mqe={borderColor:"{datatable.border.color}",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},Rqe={background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},kqe={fontWeight:"600"},Oqe={background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},Dqe={color:"{primary.color}"},Lqe={width:"0.5rem"},Nqe={width:"1px",color:"{primary.color}"},Fqe={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",size:"0.875rem"},Uqe={size:"2rem"},zqe={hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",selectedHoverColor:"{primary.color}",size:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Vqe={inlineGap:"0.5rem",overlaySelect:{background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},overlayPopover:{background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",borderRadius:"{overlay.popover.border.radius}",color:"{overlay.popover.color}",shadow:"{overlay.popover.shadow}",padding:"{overlay.popover.padding}",gap:"0.5rem"},rule:{borderColor:"{content.border.color}"},constraintList:{padding:"{list.padding}",gap:"{list.gap}"},constraint:{focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",separator:{borderColor:"{content.border.color}"},padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"}},$qe={borderColor:"{datatable.border.color}",borderWidth:"0 0 1px 0"},jqe={borderColor:"{datatable.border.color}",borderWidth:"0 0 1px 0"},Gqe={light:{root:{borderColor:"{content.border.color}"},row:{stripedBackground:"{surface.50}"},bodyCell:{selectedBorderColor:"{primary.100}"}},dark:{root:{borderColor:"{surface.800}"},row:{stripedBackground:"{surface.950}"},bodyCell:{selectedBorderColor:"{primary.900}"}}},Hqe=`
    .p-datatable-mask.p-overlay-mask {
        --px-mask-background: light-dark(rgba(255,255,255,0.5),rgba(0,0,0,0.3));
    }
`,Wqe={root:Sqe,header:Eqe,headerCell:Iqe,columnTitle:Pqe,row:Bqe,bodyCell:Mqe,footerCell:Rqe,columnFooter:kqe,footer:Oqe,dropPoint:Dqe,columnResizer:Lqe,resizeIndicator:Nqe,sortIcon:Fqe,loadingIcon:Uqe,rowToggleButton:zqe,filter:Vqe,paginatorTop:$qe,paginatorBottom:jqe,colorScheme:Gqe,css:Hqe},Kqe={borderColor:"transparent",borderWidth:"0",borderRadius:"0",padding:"0"},Xqe={background:"{content.background}",color:"{content.color}",borderColor:"{content.border.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",borderRadius:"0"},Jqe={background:"{content.background}",color:"{content.color}",borderColor:"transparent",borderWidth:"0",padding:"0",borderRadius:"0"},qqe={background:"{content.background}",color:"{content.color}",borderColor:"{content.border.color}",borderWidth:"1px 0 0 0",padding:"0.75rem 1rem",borderRadius:"0"},Yqe={borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},Zqe={borderColor:"{content.border.color}",borderWidth:"1px 0 0 0"},Qqe={root:Kqe,header:Xqe,content:Jqe,footer:qqe,paginatorTop:Yqe,paginatorBottom:Zqe},eYe={transitionDuration:"{transition.duration}"},tYe={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.popover.shadow}",padding:"{overlay.popover.padding}"},rYe={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",padding:"0 0 0.5rem 0"},nYe={gap:"0.5rem",fontWeight:"500"},iYe={width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"},borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},sYe={color:"{form.field.icon.color}"},oYe={hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}"},aYe={hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}"},lYe={borderColor:"{content.border.color}",gap:"{overlay.popover.padding}"},cYe={margin:"0.5rem 0 0 0"},uYe={padding:"0.25rem",fontWeight:"500",color:"{content.color}"},hYe={hoverBackground:"{content.hover.background}",selectedBackground:"{primary.color}",rangeSelectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{primary.contrast.color}",rangeSelectedColor:"{highlight.color}",width:"2rem",height:"2rem",borderRadius:"50%",padding:"0.25rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},dYe={margin:"0.5rem 0 0 0"},fYe={padding:"0.375rem",borderRadius:"{content.border.radius}"},pYe={margin:"0.5rem 0 0 0"},gYe={padding:"0.375rem",borderRadius:"{content.border.radius}"},mYe={padding:"0.5rem 0 0 0",borderColor:"{content.border.color}"},yYe={padding:"0.5rem 0 0 0",borderColor:"{content.border.color}",gap:"0.5rem",buttonGap:"0.25rem"},bYe={light:{dropdown:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}"},today:{background:"{surface.200}",color:"{surface.900}"}},dark:{dropdown:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}"},today:{background:"{surface.700}",color:"{surface.0}"}}},_Ye={root:eYe,panel:tYe,header:rYe,title:nYe,dropdown:iYe,inputIcon:sYe,selectMonth:oYe,selectYear:aYe,group:lYe,dayView:cYe,weekDay:uYe,date:hYe,monthView:dYe,month:fYe,yearView:pYe,year:gYe,buttonbar:mYe,timePicker:yYe,colorScheme:bYe},vYe={background:"{overlay.modal.background}",borderColor:"{overlay.modal.border.color}",color:"{overlay.modal.color}",borderRadius:"{overlay.modal.border.radius}",shadow:"{overlay.modal.shadow}"},AYe={padding:"{overlay.modal.padding}",gap:"0.5rem"},xYe={fontSize:"1.25rem",fontWeight:"600"},wYe={padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}"},CYe={padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}",gap:"0.5rem"},TYe={root:vYe,header:AYe,title:xYe,content:wYe,footer:CYe},SYe={borderColor:"{content.border.color}"},EYe={background:"{content.background}",color:"{text.color}"},IYe={margin:"1rem 0",padding:"0 1rem",content:{padding:"0 0.5rem"}},PYe={margin:"0 1rem",padding:"0.5rem 0",content:{padding:"0.5rem 0"}},BYe={root:SYe,content:EYe,horizontal:IYe,vertical:PYe},MYe={background:"rgba(255, 255, 255, 0.1)",borderColor:"rgba(255, 255, 255, 0.2)",padding:"0.5rem",borderRadius:"{border.radius.xl}"},RYe={borderRadius:"{content.border.radius}",padding:"0.5rem",size:"3rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},kYe={root:MYe,item:RYe},OYe={background:"{overlay.modal.background}",borderColor:"{overlay.modal.border.color}",color:"{overlay.modal.color}",shadow:"{overlay.modal.shadow}"},DYe={padding:"{overlay.modal.padding}"},LYe={fontSize:"1.5rem",fontWeight:"600"},NYe={padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}"},FYe={padding:"{overlay.modal.padding}"},UYe={root:OYe,header:DYe,title:LYe,content:NYe,footer:FYe},zYe={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}"},VYe={color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},$Ye={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}",padding:"{list.padding}"},jYe={focusBackground:"{list.option.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},GYe={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"},HYe={toolbar:zYe,toolbarItem:VYe,overlay:$Ye,overlayOption:jYe,content:GYe},WYe={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",padding:"0 1.125rem 1.125rem 1.125rem",transitionDuration:"{transition.duration}"},KYe={background:"{content.background}",hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",borderRadius:"{content.border.radius}",borderWidth:"1px",borderColor:"transparent",padding:"0.5rem 0.75rem",gap:"0.5rem",fontWeight:"600",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},XYe={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}"},JYe={padding:"0"},qYe={root:WYe,legend:KYe,toggleIcon:XYe,content:JYe},YYe={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",transitionDuration:"{transition.duration}"},ZYe={background:"transparent",color:"{text.color}",padding:"1.125rem",borderColor:"unset",borderWidth:"0",borderRadius:"0",gap:"0.5rem"},QYe={highlightBorderColor:"{primary.color}",padding:"0 1.125rem 1.125rem 1.125rem",gap:"1rem"},eZe={padding:"1rem",gap:"1rem",borderColor:"{content.border.color}",info:{gap:"0.5rem"}},tZe={gap:"0.5rem"},rZe={height:"0.25rem"},nZe={gap:"0.5rem"},iZe={root:YYe,header:ZYe,content:QYe,file:eZe,fileList:tZe,progressbar:rZe,basic:nZe},sZe={color:"{form.field.float.label.color}",focusColor:"{form.field.float.label.focus.color}",activeColor:"{form.field.float.label.active.color}",invalidColor:"{form.field.float.label.invalid.color}",transitionDuration:"0.2s",positionX:"{form.field.padding.x}",positionY:"{form.field.padding.y}",fontWeight:"500",active:{fontSize:"0.75rem",fontWeight:"400"}},oZe={active:{top:"-1.25rem"}},aZe={input:{paddingTop:"1.5rem",paddingBottom:"{form.field.padding.y}"},active:{top:"{form.field.padding.y}"}},lZe={borderRadius:"{border.radius.xs}",active:{background:"{form.field.background}",padding:"0 0.125rem"}},cZe={root:sZe,over:oZe,in:aZe,on:lZe},uZe={borderWidth:"1px",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",transitionDuration:"{transition.duration}"},hZe={background:"rgba(255, 255, 255, 0.1)",hoverBackground:"rgba(255, 255, 255, 0.2)",color:"{surface.100}",hoverColor:"{surface.0}",size:"3rem",gutter:"0.5rem",prev:{borderRadius:"50%"},next:{borderRadius:"50%"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},dZe={size:"1.5rem"},fZe={background:"{content.background}",padding:"1rem 0.25rem"},pZe={size:"2rem",borderRadius:"{content.border.radius}",gutter:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},gZe={size:"1rem"},mZe={background:"rgba(0, 0, 0, 0.5)",color:"{surface.100}",padding:"1rem"},yZe={gap:"0.5rem",padding:"1rem"},bZe={width:"1rem",height:"1rem",activeBackground:"{primary.color}",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},_Ze={background:"rgba(0, 0, 0, 0.5)"},vZe={background:"rgba(255, 255, 255, 0.4)",hoverBackground:"rgba(255, 255, 255, 0.6)",activeBackground:"rgba(255, 255, 255, 0.9)"},AZe={size:"3rem",gutter:"0.5rem",background:"rgba(255, 255, 255, 0.1)",hoverBackground:"rgba(255, 255, 255, 0.2)",color:"{surface.50}",hoverColor:"{surface.0}",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},xZe={size:"1.5rem"},wZe={light:{thumbnailNavButton:{hoverBackground:"{surface.100}",color:"{surface.600}",hoverColor:"{surface.700}"},indicatorButton:{background:"{surface.200}",hoverBackground:"{surface.300}"}},dark:{thumbnailNavButton:{hoverBackground:"{surface.700}",color:"{surface.400}",hoverColor:"{surface.0}"},indicatorButton:{background:"{surface.700}",hoverBackground:"{surface.600}"}}},CZe={root:uZe,navButton:hZe,navIcon:dZe,thumbnailsContent:fZe,thumbnailNavButton:pZe,thumbnailNavButtonIcon:gZe,caption:mZe,indicatorList:yZe,indicatorButton:bZe,insetIndicatorList:_Ze,insetIndicatorButton:vZe,closeButton:AZe,closeButtonIcon:xZe,colorScheme:wZe},TZe={color:"{form.field.icon.color}"},SZe={icon:TZe},EZe={color:"{form.field.float.label.color}",focusColor:"{form.field.float.label.focus.color}",invalidColor:"{form.field.float.label.invalid.color}",transitionDuration:"0.2s",positionX:"{form.field.padding.x}",top:"{form.field.padding.y}",fontSize:"0.75rem",fontWeight:"400"},IZe={paddingTop:"1.5rem",paddingBottom:"{form.field.padding.y}"},PZe={root:EZe,input:IZe},BZe={transitionDuration:"{transition.duration}"},MZe={icon:{size:"1.5rem"},mask:{background:"{mask.background}",color:"{mask.color}"}},RZe={position:{left:"auto",right:"1rem",top:"1rem",bottom:"auto"},blur:"8px",background:"rgba(255,255,255,0.1)",borderColor:"rgba(255,255,255,0.2)",borderWidth:"1px",borderRadius:"30px",padding:".5rem",gap:"0.5rem"},kZe={hoverBackground:"rgba(255,255,255,0.1)",color:"{surface.50}",hoverColor:"{surface.0}",size:"3rem",iconSize:"1.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},OZe={root:BZe,preview:MZe,toolbar:RZe,action:kZe},DZe={size:"15px",hoverSize:"30px",background:"rgba(255,255,255,0.3)",hoverBackground:"rgba(255,255,255,0.3)",borderColor:"unset",hoverBorderColor:"unset",borderWidth:"0",borderRadius:"50%",transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"rgba(255,255,255,0.3)",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},LZe={handle:DZe},NZe={padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{content.border.radius}",gap:"0.5rem"},FZe={fontWeight:"500"},UZe={size:"1rem"},zZe={light:{info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)"},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)"},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)"},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)"},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)"},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)"}},dark:{info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)"},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)"},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)"},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)"},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)"},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)"}}},VZe={root:NZe,text:FZe,icon:UZe,colorScheme:zZe},$Ze={padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{transition.duration}"},jZe={hoverBackground:"{content.hover.background}",hoverColor:"{content.hover.color}"},GZe={root:$Ze,display:jZe},HZe={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}"},WZe={borderRadius:"{border.radius.sm}"},KZe={light:{chip:{focusBackground:"{surface.200}",color:"{surface.800}"}},dark:{chip:{focusBackground:"{surface.700}",color:"{surface.0}"}}},XZe={root:HZe,chip:WZe,colorScheme:KZe},JZe={background:"{form.field.background}",borderColor:"{form.field.border.color}",color:"{form.field.icon.color}",borderRadius:"{form.field.border.radius}",padding:"0.5rem",minWidth:"2.5rem"},qZe={addon:JZe},YZe={transitionDuration:"{transition.duration}"},ZZe={width:"2.5rem",borderRadius:"{form.field.border.radius}",verticalPadding:"{form.field.padding.y}"},QZe={light:{button:{background:"transparent",hoverBackground:"{surface.100}",activeBackground:"{surface.200}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",color:"{surface.400}",hoverColor:"{surface.500}",activeColor:"{surface.600}"}},dark:{button:{background:"transparent",hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",color:"{surface.400}",hoverColor:"{surface.300}",activeColor:"{surface.200}"}}},eQe={root:YZe,button:ZZe,colorScheme:QZe},tQe={gap:"0.5rem"},rQe={width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"}},nQe={root:tQe,input:rQe},iQe={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},sQe={root:iQe},oQe={transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},aQe={background:"{primary.color}"},lQe={background:"{content.border.color}"},cQe={color:"{text.muted.color}"},uQe={root:oQe,value:aQe,range:lQe,text:cQe},hQe={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",borderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",shadow:"{form.field.shadow}",borderRadius:"{form.field.border.radius}",transitionDuration:"{form.field.transition.duration}"},dQe={padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},fQe={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},pQe={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},gQe={color:"{list.option.color}",gutterStart:"-0.375rem",gutterEnd:"0.375rem"},mQe={padding:"{list.option.padding}"},yQe={light:{option:{stripedBackground:"{surface.50}"}},dark:{option:{stripedBackground:"{surface.900}"}}},bQe={root:hQe,list:dQe,option:fQe,optionGroup:pQe,checkmark:gQe,emptyMessage:mQe,colorScheme:yQe},_Qe={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",verticalOrientation:{padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},horizontalOrientation:{padding:"0.5rem 0.75rem",gap:"0.5rem"},transitionDuration:"{transition.duration}"},vQe={borderRadius:"{content.border.radius}",padding:"{navigation.item.padding}"},AQe={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},xQe={padding:"0",background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",shadow:"{overlay.navigation.shadow}",gap:"0.5rem"},wQe={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},CQe={padding:"{navigation.submenu.label.padding}",fontWeight:"{navigation.submenu.label.font.weight}",background:"{navigation.submenu.label.background}",color:"{navigation.submenu.label.color}"},TQe={size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},SQe={borderColor:"{content.border.color}"},EQe={borderRadius:"50%",size:"1.75rem",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",hoverBackground:"{content.hover.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},IQe={root:_Qe,baseItem:vQe,item:AQe,overlay:xQe,submenu:wQe,submenuLabel:CQe,submenuIcon:TQe,separator:SQe,mobileButton:EQe},PQe={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},BQe={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},MQe={focusBackground:"{navigation.item.focus.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}"}},RQe={padding:"{navigation.submenu.label.padding}",fontWeight:"{navigation.submenu.label.font.weight}",background:"{navigation.submenu.label.background}",color:"{navigation.submenu.label.color}"},kQe={borderColor:"{content.border.color}"},OQe={root:PQe,list:BQe,item:MQe,submenuLabel:RQe,separator:kQe},DQe={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",padding:"0.5rem 0.75rem",transitionDuration:"{transition.duration}"},LQe={borderRadius:"{content.border.radius}",padding:"{navigation.item.padding}"},NQe={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},FQe={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}",background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",mobileIndent:"1rem",icon:{size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"}},UQe={borderColor:"{content.border.color}"},zQe={borderRadius:"50%",size:"1.75rem",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",hoverBackground:"{content.hover.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},VQe={root:DQe,baseItem:LQe,item:NQe,submenu:FQe,separator:UQe,mobileButton:zQe},$Qe={borderRadius:"{content.border.radius}",borderWidth:"1px",transitionDuration:"{transition.duration}"},jQe={padding:"0.5rem 0.75rem",gap:"0.5rem",sm:{padding:"0.375rem 0.625rem"},lg:{padding:"0.625rem 0.875rem"}},GQe={fontSize:"1rem",fontWeight:"500",sm:{fontSize:"0.875rem"},lg:{fontSize:"1.125rem"}},HQe={size:"1.125rem",sm:{size:"1rem"},lg:{size:"1.25rem"}},WQe={width:"1.75rem",height:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"}},KQe={size:"1rem",sm:{size:"0.875rem"},lg:{size:"1.125rem"}},XQe={root:{borderWidth:"1px"}},JQe={content:{padding:"0"}},qQe={light:{info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"{blue.100}",focusRing:{color:"{blue.600}",shadow:"none"}},outlined:{color:"{blue.600}",borderColor:"{blue.600}"},simple:{color:"{blue.600}"}},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"{green.100}",focusRing:{color:"{green.600}",shadow:"none"}},outlined:{color:"{green.600}",borderColor:"{green.600}"},simple:{color:"{green.600}"}},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"{yellow.100}",focusRing:{color:"{yellow.600}",shadow:"none"}},outlined:{color:"{yellow.600}",borderColor:"{yellow.600}"},simple:{color:"{yellow.600}"}},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"{red.100}",focusRing:{color:"{red.600}",shadow:"none"}},outlined:{color:"{red.600}",borderColor:"{red.600}"},simple:{color:"{red.600}"}},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.200}",focusRing:{color:"{surface.600}",shadow:"none"}},outlined:{color:"{surface.500}",borderColor:"{surface.500}"},simple:{color:"{surface.500}"}},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.800}",focusRing:{color:"{surface.50}",shadow:"none"}},outlined:{color:"{surface.950}",borderColor:"{surface.950}"},simple:{color:"{surface.950}"}}},dark:{info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{blue.500}",shadow:"none"}},outlined:{color:"{blue.500}",borderColor:"{blue.500}"},simple:{color:"{blue.500}"}},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{green.500}",shadow:"none"}},outlined:{color:"{green.500}",borderColor:"{green.500}"},simple:{color:"{green.500}"}},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{yellow.500}",shadow:"none"}},outlined:{color:"{yellow.500}",borderColor:"{yellow.500}"},simple:{color:"{yellow.500}"}},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{red.500}",shadow:"none"}},outlined:{color:"{red.500}",borderColor:"{red.500}"},simple:{color:"{red.500}"}},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.700}",focusRing:{color:"{surface.300}",shadow:"none"}},outlined:{color:"{surface.400}",borderColor:"{surface.400}"},simple:{color:"{surface.400}"}},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.100}",focusRing:{color:"{surface.950}",shadow:"none"}},outlined:{color:"{surface.0}",borderColor:"{surface.0}"},simple:{color:"{surface.0}"}}}},YQe={root:$Qe,content:jQe,text:GQe,icon:HQe,closeButton:WQe,closeIcon:KQe,outlined:XQe,simple:JQe,colorScheme:qQe},ZQe={borderRadius:"{content.border.radius}",gap:"1rem"},QQe={background:"{content.border.color}",size:"0.5rem"},eet={gap:"0.5rem"},tet={size:"0.5rem"},ret={size:"1rem"},net={verticalGap:"0.5rem",horizontalGap:"1rem"},iet={root:ZQe,meters:QQe,label:eet,labelMarker:tet,labelIcon:ret,labelList:net},set={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},oet={width:"2.5rem",color:"{form.field.icon.color}"},aet={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},cet={padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},uet={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}",gap:"0.5rem"},het={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},det={color:"{form.field.icon.color}"},fet={borderRadius:"{border.radius.sm}"},pet={padding:"{list.option.padding}"},get={root:set,dropdown:oet,overlay:aet,list:cet,option:uet,optionGroup:het,chip:fet,clearIcon:det,emptyMessage:pet},met={gap:"1.125rem"},yet={gap:"0.5rem"},bet={root:met,controls:yet},_et={gutter:"0.75rem",transitionDuration:"{transition.duration}"},vet={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{content.border.color}",color:"{content.color}",selectedColor:"{highlight.color}",hoverColor:"{content.hover.color}",padding:"0.75rem 1rem",toggleablePadding:"0.75rem 1rem 1.25rem 1rem",borderRadius:"{content.border.radius}"},Aet={background:"{content.background}",hoverBackground:"{content.hover.background}",borderColor:"{content.border.color}",color:"{text.muted.color}",hoverColor:"{text.color}",size:"1.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},xet={color:"{content.border.color}",borderRadius:"{content.border.radius}",height:"24px"},wet={root:_et,node:vet,nodeToggleButton:Aet,connector:xet},Cet={outline:{width:"2px",color:"{content.background}"}},Tet={root:Cet},Eet={padding:"0.5rem 1rem",gap:"0.25rem",borderRadius:"{content.border.radius}",background:"{content.background}",color:"{content.color}",transitionDuration:"{transition.duration}"},Iet={background:"transparent",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedColor:"{highlight.color}",width:"2.5rem",height:"2.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Pet={color:"{text.muted.color}"},Bet={maxWidth:"2.5rem"},Met={root:Eet,navButton:Iet,currentPageReport:Pet,jumpToPageInput:Bet},Ret={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"},ket={background:"transparent",color:"{text.color}",padding:"1.125rem",borderColor:"{content.border.color}",borderWidth:"0",borderRadius:"0"},Oet={padding:"0.375rem 1.125rem"},Det={fontWeight:"600"},Let={padding:"0 1.125rem 1.125rem 1.125rem"},Net={padding:"0 1.125rem 1.125rem 1.125rem"},Fet={root:Ret,header:ket,toggleableHeader:Oet,title:Det,content:Let,footer:Net},Uet={gap:"0.5rem",transitionDuration:"{transition.duration}"},zet={background:"{content.background}",borderColor:"{content.border.color}",borderWidth:"1px",color:"{content.color}",padding:"0.25rem 0.25rem",borderRadius:"{content.border.radius}",first:{borderWidth:"1px",topBorderRadius:"{content.border.radius}"},last:{borderWidth:"1px",bottomBorderRadius:"{content.border.radius}"}},Vet={focusBackground:"{navigation.item.focus.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",gap:"0.5rem",padding:"{navigation.item.padding}",borderRadius:"{content.border.radius}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}"}},$et={indent:"1rem"},jet={color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}"},Get={root:Uet,panel:zet,item:Vet,submenu:$et,submenuIcon:jet},Het={background:"{content.border.color}",borderRadius:"{content.border.radius}",height:".75rem"},Wet={color:"{form.field.icon.color}"},Ket={background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",borderRadius:"{overlay.popover.border.radius}",color:"{overlay.popover.color}",padding:"{overlay.popover.padding}",shadow:"{overlay.popover.shadow}"},Xet={gap:"0.5rem"},Jet={light:{strength:{weakBackground:"{red.500}",mediumBackground:"{amber.500}",strongBackground:"{green.500}"}},dark:{strength:{weakBackground:"{red.400}",mediumBackground:"{amber.400}",strongBackground:"{green.400}"}}},qet={meter:Het,icon:Wet,overlay:Ket,content:Xet,colorScheme:Jet},Yet={gap:"1.125rem"},Zet={gap:"0.5rem"},Qet={root:Yet,controls:Zet},ett={background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",color:"{overlay.popover.color}",borderRadius:"{overlay.popover.border.radius}",shadow:"{overlay.popover.shadow}",gutter:"10px",arrowOffset:"1.25rem"},ttt={padding:"{overlay.popover.padding}"},rtt={root:ett,content:ttt},ntt={background:"{content.border.color}",borderRadius:"{content.border.radius}",height:"1.25rem"},itt={background:"{primary.color}"},stt={color:"{primary.contrast.color}",fontSize:"0.75rem",fontWeight:"600"},ott={root:ntt,value:itt,label:stt},att={light:{root:{colorOne:"{red.500}",colorTwo:"{blue.500}",colorThree:"{green.500}",colorFour:"{yellow.500}"}},dark:{root:{colorOne:"{red.400}",colorTwo:"{blue.400}",colorThree:"{green.400}",colorFour:"{yellow.400}"}}},ltt={colorScheme:att},ctt={width:"1.25rem",height:"1.25rem",background:"{form.field.background}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.border.color}",checkedBorderColor:"{primary.color}",checkedHoverBorderColor:"{primary.hover.color}",checkedFocusBorderColor:"{primary.color}",checkedDisabledBorderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{width:"1rem",height:"1rem"},lg:{width:"1.5rem",height:"1.5rem"}},utt={size:"0.75rem",checkedColor:"{primary.contrast.color}",checkedHoverColor:"{primary.contrast.color}",disabledColor:"{form.field.disabled.color}",sm:{size:"0.5rem"},lg:{size:"1rem"}},htt={root:ctt,icon:utt},dtt={gap:"0.25rem",transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},ftt={size:"1rem",color:"{text.muted.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"},ptt={root:dtt,icon:ftt},gtt={light:{root:{background:"rgba(0,0,0,0.1)"}},dark:{root:{background:"rgba(255,255,255,0.3)"}}},mtt={colorScheme:gtt},ytt={transitionDuration:"{transition.duration}"},btt={size:"9px",borderRadius:"{border.radius.sm}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},_tt={light:{bar:{background:"{surface.100}"}},dark:{bar:{background:"{surface.800}"}}},vtt={root:ytt,bar:btt,colorScheme:_tt},Att={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},xtt={width:"2.5rem",color:"{form.field.icon.color}"},wtt={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},Ctt={padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},Ttt={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},Stt={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},Ett={color:"{form.field.icon.color}"},Itt={color:"{list.option.color}",gutterStart:"-0.375rem",gutterEnd:"0.375rem"},Ptt={padding:"{list.option.padding}"},Btt={root:Att,dropdown:xtt,overlay:wtt,list:Ctt,option:Ttt,optionGroup:Stt,clearIcon:Ett,checkmark:Itt,emptyMessage:Ptt},Mtt={borderRadius:"{form.field.border.radius}"},Rtt={light:{root:{invalidBorderColor:"{form.field.invalid.border.color}"}},dark:{root:{invalidBorderColor:"{form.field.invalid.border.color}"}}},ktt={root:Mtt,colorScheme:Rtt},Ott={borderRadius:"{content.border.radius}"},Dtt={light:{root:{background:"{surface.200}",animationBackground:"rgba(255,255,255,0.4)"}},dark:{root:{background:"rgba(255, 255, 255, 0.06)",animationBackground:"rgba(255, 255, 255, 0.04)"}}},Ltt={root:Ott,colorScheme:Dtt},Ntt={transitionDuration:"{transition.duration}"},Ftt={background:"{content.border.color}",borderRadius:"{content.border.radius}",size:"3px"},Utt={background:"{primary.color}"},ztt={width:"20px",height:"20px",borderRadius:"50%",background:"{content.border.color}",hoverBackground:"{content.border.color}",content:{borderRadius:"50%",hoverBackground:"{content.background}",width:"16px",height:"16px",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.08), 0px 1px 1px 0px rgba(0, 0, 0, 0.14)"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Vtt={light:{handle:{content:{background:"{surface.0}"}}},dark:{handle:{content:{background:"{surface.950}"}}}},$tt={root:Ntt,track:Ftt,range:Utt,handle:ztt,colorScheme:Vtt},jtt={gap:"0.5rem",transitionDuration:"{transition.duration}"},Gtt={root:jtt},Htt={borderRadius:"{form.field.border.radius}",roundedBorderRadius:"2rem",raisedShadow:"0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)"},Wtt={root:Htt},Ktt={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",transitionDuration:"{transition.duration}"},Xtt={background:"{content.border.color}"},Jtt={size:"24px",background:"transparent",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},qtt={root:Ktt,gutter:Xtt,handle:Jtt},Ytt={transitionDuration:"{transition.duration}"},Ztt={background:"{content.border.color}",activeBackground:"{primary.color}",margin:"0 0 0 1.625rem",size:"2px"},Qtt={padding:"0.5rem",gap:"1rem"},ert={padding:"0",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},gap:"0.5rem"},trt={color:"{text.muted.color}",activeColor:"{primary.color}",fontWeight:"500"},rrt={background:"{content.background}",activeBackground:"{content.background}",borderColor:"{content.border.color}",activeBorderColor:"{content.border.color}",color:"{text.muted.color}",activeColor:"{primary.color}",size:"2rem",fontSize:"1.143rem",fontWeight:"500",borderRadius:"50%",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"},nrt={padding:"0.875rem 0.5rem 1.125rem 0.5rem"},irt={background:"{content.background}",color:"{content.color}",padding:"0",indent:"1rem"},srt={root:Ytt,separator:Ztt,step:Qtt,stepHeader:ert,stepTitle:trt,stepNumber:rrt,steppanels:nrt,steppanel:irt},ort={transitionDuration:"{transition.duration}"},art={background:"{content.border.color}"},lrt={borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},gap:"0.5rem"},crt={color:"{text.muted.color}",activeColor:"{primary.color}",fontWeight:"500"},urt={background:"{content.background}",activeBackground:"{content.background}",borderColor:"{content.border.color}",activeBorderColor:"{content.border.color}",color:"{text.muted.color}",activeColor:"{primary.color}",size:"2rem",fontSize:"1.143rem",fontWeight:"500",borderRadius:"50%",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"},hrt={root:ort,separator:art,itemLink:lrt,itemLabel:crt,itemNumber:urt},drt={transitionDuration:"{transition.duration}"},frt={borderWidth:"0 0 1px 0",background:"{content.background}",borderColor:"{content.border.color}"},prt={background:"transparent",hoverBackground:"transparent",activeBackground:"transparent",borderWidth:"0 0 1px 0",borderColor:"{content.border.color}",hoverBorderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}",padding:"1rem 1.125rem",fontWeight:"600",margin:"0 0 -1px 0",gap:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},grt={color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},mrt={height:"1px",bottom:"-1px",background:"{primary.color}"},yrt={root:drt,tablist:frt,item:prt,itemIcon:grt,activeBar:mrt},brt={transitionDuration:"{transition.duration}"},_rt={borderWidth:"0 0 1px 0",background:"{content.background}",borderColor:"{content.border.color}"},vrt={background:"transparent",hoverBackground:"transparent",activeBackground:"transparent",borderWidth:"0 0 1px 0",borderColor:"{content.border.color}",hoverBorderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}",padding:"1rem 1.125rem",fontWeight:"600",margin:"0 0 -1px 0",gap:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},Art={background:"{content.background}",color:"{content.color}",padding:"0.875rem 1.125rem 1.125rem 1.125rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"inset {focus.ring.shadow}"}},xrt={background:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",width:"2.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},wrt={height:"1px",bottom:"-1px",background:"{primary.color}"},Crt={light:{navButton:{shadow:"0px 0px 10px 50px rgba(255, 255, 255, 0.6)"}},dark:{navButton:{shadow:"0px 0px 10px 50px color-mix(in srgb, {content.background}, transparent 50%)"}}},Trt={root:brt,tablist:_rt,tab:vrt,tabpanel:Art,navButton:xrt,activeBar:wrt,colorScheme:Crt},Srt={transitionDuration:"{transition.duration}"},Ert={background:"{content.background}",borderColor:"{content.border.color}"},Irt={borderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},Prt={background:"{content.background}",color:"{content.color}"},Brt={background:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}"},Mrt={light:{navButton:{shadow:"0px 0px 10px 50px rgba(255, 255, 255, 0.6)"}},dark:{navButton:{shadow:"0px 0px 10px 50px color-mix(in srgb, {content.background}, transparent 50%)"}}},Rrt={root:Srt,tabList:Ert,tab:Irt,tabPanel:Prt,navButton:Brt,colorScheme:Mrt},krt={fontSize:"0.875rem",fontWeight:"700",padding:"0.25rem 0.5rem",gap:"0.25rem",borderRadius:"{content.border.radius}",roundedBorderRadius:"{border.radius.xl}"},Ort={size:"0.75rem"},Drt={light:{primary:{background:"{primary.100}",color:"{primary.700}"},secondary:{background:"{surface.100}",color:"{surface.600}"},success:{background:"{green.100}",color:"{green.700}"},info:{background:"{sky.100}",color:"{sky.700}"},warn:{background:"{orange.100}",color:"{orange.700}"},danger:{background:"{red.100}",color:"{red.700}"},contrast:{background:"{surface.950}",color:"{surface.0}"}},dark:{primary:{background:"color-mix(in srgb, {primary.500}, transparent 84%)",color:"{primary.300}"},secondary:{background:"{surface.800}",color:"{surface.300}"},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",color:"{green.300}"},info:{background:"color-mix(in srgb, {sky.500}, transparent 84%)",color:"{sky.300}"},warn:{background:"color-mix(in srgb, {orange.500}, transparent 84%)",color:"{orange.300}"},danger:{background:"color-mix(in srgb, {red.500}, transparent 84%)",color:"{red.300}"},contrast:{background:"{surface.0}",color:"{surface.950}"}}},Lrt={root:krt,icon:Ort,colorScheme:Drt},Nrt={background:"{form.field.background}",borderColor:"{form.field.border.color}",color:"{form.field.color}",height:"18rem",padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{form.field.border.radius}"},Frt={gap:"0.25rem"},Urt={margin:"2px 0"},zrt={root:Nrt,prompt:Frt,commandResponse:Urt},Vrt={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},$rt={root:Vrt},jrt={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},Grt={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},Hrt={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},Wrt={mobileIndent:"1rem"},Krt={size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},Xrt={borderColor:"{content.border.color}"},Jrt={root:jrt,list:Grt,item:Hrt,submenu:Wrt,submenuIcon:Krt,separator:Xrt},qrt={minHeight:"5rem"},Yrt={eventContent:{padding:"1rem 0"}},Zrt={eventContent:{padding:"0 1rem"}},Qrt={size:"1.125rem",borderRadius:"50%",borderWidth:"2px",background:"{content.background}",borderColor:"{content.border.color}",content:{borderRadius:"50%",size:"0.375rem",background:"{primary.color}",insetShadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"}},ent={color:"{content.border.color}",size:"2px"},tnt={event:qrt,horizontal:Yrt,vertical:Zrt,eventMarker:Qrt,eventConnector:ent},rnt={width:"25rem",borderRadius:"{content.border.radius}",borderWidth:"1px",transitionDuration:"{transition.duration}"},nnt={size:"1.125rem"},int={padding:"{overlay.popover.padding}",gap:"0.5rem"},snt={gap:"0.5rem"},ont={fontWeight:"500",fontSize:"1rem"},ant={fontWeight:"500",fontSize:"0.875rem"},lnt={width:"1.75rem",height:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"}},cnt={size:"1rem"},unt={light:{root:{blur:"1.5px"},info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"{blue.100}",focusRing:{color:"{blue.600}",shadow:"none"}}},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"{green.100}",focusRing:{color:"{green.600}",shadow:"none"}}},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"{yellow.100}",focusRing:{color:"{yellow.600}",shadow:"none"}}},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"{red.100}",focusRing:{color:"{red.600}",shadow:"none"}}},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.200}",focusRing:{color:"{surface.600}",shadow:"none"}}},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.800}",focusRing:{color:"{surface.50}",shadow:"none"}}}},dark:{root:{blur:"10px"},info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{blue.500}",shadow:"none"}}},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{green.500}",shadow:"none"}}},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{yellow.500}",shadow:"none"}}},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{red.500}",shadow:"none"}}},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.700}",focusRing:{color:"{surface.300}",shadow:"none"}}},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",detailColor:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.100}",focusRing:{color:"{surface.950}",shadow:"none"}}}}},hnt={root:rnt,icon:nnt,content:int,text:snt,summary:ont,detail:ant,closeButton:lnt,closeIcon:cnt,colorScheme:unt},dnt={padding:"0.25rem",borderRadius:"{content.border.radius}",gap:"0.5rem",fontWeight:"500",disabledBackground:"{form.field.disabled.background}",disabledBorderColor:"{form.field.disabled.background}",disabledColor:"{form.field.disabled.color}",invalidBorderColor:"{form.field.invalid.border.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",padding:"0.25rem"},lg:{fontSize:"{form.field.lg.font.size}",padding:"0.25rem"}},fnt={disabledColor:"{form.field.disabled.color}"},pnt={padding:"0.25rem 0.75rem",borderRadius:"{content.border.radius}",checkedShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.02), 0px 1px 2px 0px rgba(0, 0, 0, 0.04)",sm:{padding:"0.25rem 0.75rem"},lg:{padding:"0.25rem 0.75rem"}},gnt={light:{root:{background:"{surface.100}",checkedBackground:"{surface.100}",hoverBackground:"{surface.100}",borderColor:"{surface.100}",color:"{surface.500}",hoverColor:"{surface.700}",checkedColor:"{surface.900}",checkedBorderColor:"{surface.100}"},content:{checkedBackground:"{surface.0}"},icon:{color:"{surface.500}",hoverColor:"{surface.700}",checkedColor:"{surface.900}"}},dark:{root:{background:"{surface.950}",checkedBackground:"{surface.950}",hoverBackground:"{surface.950}",borderColor:"{surface.950}",color:"{surface.400}",hoverColor:"{surface.300}",checkedColor:"{surface.0}",checkedBorderColor:"{surface.950}"},content:{checkedBackground:"{surface.800}"},icon:{color:"{surface.400}",hoverColor:"{surface.300}",checkedColor:"{surface.0}"}}},mnt={root:dnt,icon:fnt,content:pnt,colorScheme:gnt},ynt={width:"2.5rem",height:"1.5rem",borderRadius:"30px",gap:"0.25rem",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},borderWidth:"1px",borderColor:"transparent",hoverBorderColor:"transparent",checkedBorderColor:"transparent",checkedHoverBorderColor:"transparent",invalidBorderColor:"{form.field.invalid.border.color}",transitionDuration:"{form.field.transition.duration}",slideDuration:"0.2s"},bnt={borderRadius:"50%",size:"1rem"},_nt={light:{root:{background:"{surface.300}",disabledBackground:"{form.field.disabled.background}",hoverBackground:"{surface.400}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}"},handle:{background:"{surface.0}",disabledBackground:"{form.field.disabled.color}",hoverBackground:"{surface.0}",checkedBackground:"{surface.0}",checkedHoverBackground:"{surface.0}",color:"{text.muted.color}",hoverColor:"{text.color}",checkedColor:"{primary.color}",checkedHoverColor:"{primary.hover.color}"}},dark:{root:{background:"{surface.700}",disabledBackground:"{surface.600}",hoverBackground:"{surface.600}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}"},handle:{background:"{surface.400}",disabledBackground:"{surface.900}",hoverBackground:"{surface.300}",checkedBackground:"{surface.900}",checkedHoverBackground:"{surface.900}",color:"{surface.900}",hoverColor:"{surface.800}",checkedColor:"{primary.color}",checkedHoverColor:"{primary.hover.color}"}}},vnt={root:ynt,handle:bnt,colorScheme:_nt},Ant={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",padding:"0.75rem"},xnt={root:Ant},wnt={maxWidth:"12.5rem",gutter:"0.25rem",shadow:"{overlay.popover.shadow}",padding:"0.5rem 0.75rem",borderRadius:"{overlay.popover.border.radius}"},Cnt={light:{root:{background:"{surface.700}",color:"{surface.0}"}},dark:{root:{background:"{surface.700}",color:"{surface.0}"}}},Tnt={root:wnt,colorScheme:Cnt},Snt={background:"{content.background}",color:"{content.color}",padding:"1rem",gap:"2px",indent:"1rem",transitionDuration:"{transition.duration}"},Ent={padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{text.color}",hoverColor:"{text.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},gap:"0.25rem"},Int={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedColor:"{highlight.color}"},Pnt={borderRadius:"50%",size:"1.75rem",hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedHoverColor:"{primary.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Bnt={size:"2rem"},Mnt={margin:"0 0 0.5rem 0"},Rnt=`
    .p-tree-mask.p-overlay-mask {
        --px-mask-background: light-dark(rgba(255,255,255,0.5),rgba(0,0,0,0.3));
    }
`,knt={root:Snt,node:Ent,nodeIcon:Int,nodeToggleButton:Pnt,loadingIcon:Bnt,filter:Mnt,css:Rnt},Ont={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},Dnt={width:"2.5rem",color:"{form.field.icon.color}"},Lnt={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},Nnt={padding:"{list.padding}"},Fnt={padding:"{list.option.padding}"},Unt={borderRadius:"{border.radius.sm}"},znt={color:"{form.field.icon.color}"},Vnt={root:Ont,dropdown:Dnt,overlay:Lnt,tree:Nnt,emptyMessage:Fnt,chip:Unt,clearIcon:znt},$nt={transitionDuration:"{transition.duration}"},jnt={background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem"},Gnt={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{treetable.border.color}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",gap:"0.5rem",padding:"0.75rem 1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},Hnt={fontWeight:"600"},Wnt={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},Knt={borderColor:"{treetable.border.color}",padding:"0.75rem 1rem",gap:"0.5rem"},Xnt={background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",padding:"0.75rem 1rem"},Jnt={fontWeight:"600"},qnt={background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem"},Ynt={width:"0.5rem"},Znt={width:"1px",color:"{primary.color}"},Qnt={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",size:"0.875rem"},eit={size:"2rem"},tit={hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",selectedHoverColor:"{primary.color}",size:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},rit={borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},nit={borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},iit={light:{root:{borderColor:"{content.border.color}"},bodyCell:{selectedBorderColor:"{primary.100}"}},dark:{root:{borderColor:"{surface.800}"},bodyCell:{selectedBorderColor:"{primary.900}"}}},sit=`
    .p-treetable-mask.p-overlay-mask {
        --px-mask-background: light-dark(rgba(255,255,255,0.5),rgba(0,0,0,0.3));
    }
`,oit={root:$nt,header:jnt,headerCell:Gnt,columnTitle:Hnt,row:Wnt,bodyCell:Knt,footerCell:Xnt,columnFooter:Jnt,footer:qnt,columnResizer:Ynt,resizeIndicator:Znt,sortIcon:Qnt,loadingIcon:eit,nodeToggleButton:tit,paginatorTop:rit,paginatorBottom:nit,colorScheme:iit,css:sit},ait={mask:{background:"{content.background}",color:"{text.muted.color}"},icon:{size:"2rem"}},lit={loader:ait};function zv(r){"@babel/helpers - typeof";return zv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zv(r)}function P$(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function B$(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?P$(Object(t),!0).forEach(function(n){cit(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):P$(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function cit(r,e,t){return(e=uit(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function uit(r){var e=hit(r,"string");return zv(e)=="symbol"?e:e+""}function hit(r,e){if(zv(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(zv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}var dit=B$(B$({},xJe),{},{components:{accordion:qXe,autocomplete:oJe,avatar:dJe,badge:_Je,blockui:CJe,breadcrumb:IJe,button:MJe,datepicker:_Ye,card:NJe,carousel:jJe,cascadeselect:qJe,checkbox:QJe,chip:sqe,colorpicker:uqe,confirmdialog:fqe,confirmpopup:bqe,contextmenu:Tqe,dataview:Qqe,datatable:Wqe,dialog:TYe,divider:BYe,dock:kYe,drawer:UYe,editor:HYe,fieldset:qYe,fileupload:iZe,iftalabel:PZe,floatlabel:cZe,galleria:CZe,iconfield:SZe,image:OZe,imagecompare:LZe,inlinemessage:VZe,inplace:GZe,inputchips:XZe,inputgroup:qZe,inputnumber:eQe,inputotp:nQe,inputtext:sQe,knob:uQe,listbox:bQe,megamenu:IQe,menu:OQe,menubar:VQe,message:YQe,metergroup:iet,multiselect:get,orderlist:bet,organizationchart:wet,overlaybadge:Tet,popover:rtt,paginator:Met,password:qet,panel:Fet,panelmenu:Get,picklist:Qet,progressbar:ott,progressspinner:ltt,radiobutton:htt,rating:ptt,ripple:mtt,scrollpanel:vtt,select:Btt,selectbutton:ktt,skeleton:Ltt,slider:$tt,speeddial:Gtt,splitter:qtt,splitbutton:Wtt,stepper:srt,steps:hrt,tabmenu:yrt,tabs:Trt,tabview:Rrt,textarea:$rt,tieredmenu:Jrt,tag:Lrt,terminal:zrt,timeline:tnt,togglebutton:mnt,toggleswitch:vnt,tree:knt,treeselect:Vnt,treetable:oit,toast:hnt,toolbar:xnt,tooltip:Tnt,virtualscroller:lit}});const fit=QY({resolve:r=>{const e={...Object.assign({"./BeaconMap.vue":Pze,"./OutageReport.vue":LXe}),...Object.assign({})};return Lze(e,r)},setup:({createApp:r,component:e,props:t,slots:n,plugin:i,el:s})=>{const a=r({render:()=>I.h(e,t,n)});return a.use(i),a.use(HXe,{theme:{preset:dit,options:{darkModeSelector:'[data-theme="dark"]'}}}),a.mount(s),a}}),pit={el:{},liveSocket:{socket:{connectionState:()=>"closed"}},pushEvent:()=>Promise.resolve(0),pushEventTo:()=>Promise.resolve([]),handleEvent:()=>({event:"",callback:()=>{}}),removeHandleEvent:()=>{},upload:()=>{},uploadTo:()=>{},vue:{props:{},slots:{},app:{}}},git=(r,e={})=>{const{resolve:t,setup:n}=Mze(r);return async(i,s,a)=>{const o=await t(i),u=Dze(a,C=>()=>I.h("div",{innerHTML:C})),f=n({createApp:I.createSSRApp,component:o,props:s,slots:u,plugin:{install:C=>{C.mount=(...M)=>{},C.provide("_live_vue",Object.assign({},pit))}},el:{},ssr:!0});if(!f)throw new Error("Setup function did not return a Vue app!");const g={},y=await Lue(f,g);return yit(g.modules,e)+"<!-- preload -->"+y}},mit=r=>{try{const e=$te.readFileSync(jte(r),"utf-8");return JSON.parse(e)}catch{return{}}};function yit(r,e){let t="";const n=new Set;return r.forEach(i=>{const s=e[i];s&&s.forEach(a=>{if(!n.has(a)){n.add(a);const o=Gte(a);if(e[o])for(const u of e[o])t+=M$(u),n.add(u);t+=M$(a)}})}),t}function M$(r){return r.endsWith(".js")?`<link rel="modulepreload" crossorigin href="${r}">`:r.endsWith(".css")?`<link rel="stylesheet" href="${r}">`:r.endsWith(".woff")?` <link rel="preload" href="${r}" as="font" type="font/woff" crossorigin>`:r.endsWith(".woff2")?` <link rel="preload" href="${r}" as="font" type="font/woff2" crossorigin>`:r.endsWith(".gif")?` <link rel="preload" href="${r}" as="image" type="image/gif">`:r.endsWith(".jpg")||r.endsWith(".jpeg")?` <link rel="preload" href="${r}" as="image" type="image/jpeg">`:r.endsWith(".png")?` <link rel="preload" href="${r}" as="image" type="image/png">`:""}const bit=mit("../priv/vue/.vite/ssr-manifest.json"),mot=git(fit,bit);export{mot as render};
